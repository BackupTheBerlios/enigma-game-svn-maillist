<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1101 - in trunk: data doc/reference
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2008-April/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1101%20-%20in%20trunk%3A%20data%20doc/reference&In-Reply-To=%3C200804120934.m3C9YLkD031918%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000533.html">
   <LINK REL="Next"  HREF="000535.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1101 - in trunk: data doc/reference</H1>
    <B>ral at BerliOS</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1101%20-%20in%20trunk%3A%20data%20doc/reference&In-Reply-To=%3C200804120934.m3C9YLkD031918%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1101 - in trunk: data doc/reference">ral at mail.berlios.de
       </A><BR>
    <I>Sat Apr 12 11:34:21 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000533.html">[Enigma-game-svn] r1100 - team_levelpacks/team_test_new_api
</A></li>
        <LI>Next message: <A HREF="000535.html">[Enigma-game-svn] r1102 - in trunk: doc/reference etc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#534">[ date ]</a>
              <a href="thread.html#534">[ thread ]</a>
              <a href="subject.html#534">[ subject ]</a>
              <a href="author.html#534">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ral
Date: 2008-04-12 11:34:19 +0200 (Sat, 12 Apr 2008)
New Revision: 1101

Added:
   trunk/doc/reference/ConceptLuaAPI2.txt
Modified:
   trunk/data/api1init.lua
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: new API 
- fix r1090: problems with API 1 and puzzles
- new API documentation: 
  refman entries for many objects
  API concept draft as text file


Modified: trunk/data/api1init.lua
===================================================================
--- trunk/data/api1init.lua	2008-04-12 09:04:17 UTC (rev 1100)
+++ trunk/data/api1init.lua	2008-04-12 09:34:19 UTC (rev 1101)
@@ -254,7 +254,7 @@
              _key = &quot;oxydcolor&quot;
 	 end
      end
-     if key == &quot;connections&quot; then
+     if key == &quot;connections&quot; and _obj_name ~= &quot;st-puzzle&quot; then
          if val == 1 then _val = &quot;&quot;
          elseif  val == 2  then _val = &quot;w&quot;
          elseif  val == 3  then _val = &quot;s&quot;
@@ -369,7 +369,7 @@
      if key == &quot;whiteball&quot; then
         if val == 1 then val = 1 else val = 0 end
      end
-     if key == &quot;connections&quot; then
+     if key == &quot;connections&quot; and _obj_name ~= &quot;st-puzzle&quot; then
          if val == &quot;&quot; then val = 1
          elseif  val == &quot;w&quot;    then val = 2
          elseif  val == &quot;s&quot;    then val = 3

Added: trunk/doc/reference/ConceptLuaAPI2.txt
===================================================================
--- trunk/doc/reference/ConceptLuaAPI2.txt	2008-04-12 09:04:17 UTC (rev 1100)
+++ trunk/doc/reference/ConceptLuaAPI2.txt	2008-04-12 09:34:19 UTC (rev 1101)
@@ -0,0 +1,607 @@
+Concept Lua API 2         (Draft 0.6)
+=================
+
+
+C1 - Object Based Syntax   (coded - besides lines starting with a &quot;.&quot;)
+------------------------
+
+The new API provides successor functions for all basic functions of the
+old API with simplified names and arguments. (As the naming of the
+successor functions is not yet fixed just a few examples are listed. This
+set of functions will be completed to ensure that all previous styles of
+level programming are supported in the API as well).
+
+The following example based description explains the idea of the
+new object based syntax additions:
+
+Namespace &quot;en&quot;
+
+  Any system object or function is addressable as &quot;sysname&quot; and &quot;en.sysname&quot; 
+
+Special value types:
+
+  position      - a position within the world that can be described by an
+                  x and y coordinate
+  object        - an Enimga object like a stone, item, floor, rubberband,...
+  world         - a singleton type for the world that contains all objects
+  namedobjects  - a singleton type for the repository of all named objects
+  group         - a list of objects
+  tile          - a description of objects at a common grid position (floor,
+                  item, stone, actor)
+  tiles         - a singleton type for the repository of all tile instances
+
+Special objects given at init:
+
+  wo   world with map and global attributes of type &lt;world&gt;
+  no   named object repository of type &lt;namedobjects&gt; 
+  ti   tile template repository of type &lt;tiles&gt;
+
+Let &quot;obj&quot; be an example object reference of a stone/item/floor (type &lt;object&gt;).
+
+Grid Positions are table/objects:
+
+  pos = po(7, 3)            -- a function &quot;po()&quot;
+  pos = po({7, 3})
+  pos = obj                 -- every object is a valid position
+  pos = po(12.3, 3.7)       -- position within a grid (for an actor) 
+
+Position constants
+  {7,3}     -- a valid position for all arguments and operations (see caveats)
+
+Access to x, y coordinates:
+
+  x, y = pos.x, pos.y
+  x, y = pos[&quot;x&quot;], pos[&quot;y&quot;]
+  x, y = pos:xy()
+  x, y = obj.x, obj.y
+  x, y = obj:xy()
+
+Position calculation
+
+  pos = obj + {2,7}
+  dpos = obj1 - obj2
+  dpos2 = 2 * dpos
+
+Center positions for set actors
+
+  pos_centered1 = pos + {0.5, 0.5}
+  pos_centered2 = #pos
+  pos_centered3 = #obj
+
+Round a position to a grid
+
+  grid_pos = pos:grid()
+
+Position comparison
+
+  pos_centered1 == pos_centered2
+
+Setting a single attribute of objects including global attributes of world:
+
+  obj[&quot;attr_name&quot;] = value
+  wo[&quot;Brittleness&quot;] = 7
+
+
+Setting multiple attributes at once:
+
+  obj:set({attr_name1=value1, attr_name2=value2})
+
+Requesting attributes of objects including global attributes of world:
+
+  value = obj[&quot;attr_name&quot;]
+  value = wo[&quot;Brittleness&quot;]
+
+  if wo[&quot;IsDifficult&quot;] then ... end
+
+Reset an attribute to its default - &quot;delete&quot;:
+
+  obj[&quot;attr_name&quot;] = nil
+
+Creating a new object:
+
+  wo[pos] = {&quot;st_chess&quot;, color = 0, name=&quot;Atrax&quot;}   -- on edge of grid pos
+  wo[#pos] = {&quot;ac_bug&quot;}              -- actor centered on grid pos
+  wo[pos] = {&quot;#ac_bug&quot;}              -- actor centered on grid pos
+  wo[pos] = {&quot;ac_bug&quot;, 0.3, 0.7}     -- actor with offsets to pos
+  wo[my_floor] = {&quot;it_wand&quot;}         -- set an wand on top of a given foor
+
+Naming an object:
+
+  no[&quot;Atrax&quot;] = obj
+
+Consecutive naming of objects (building object groups)
+
+  wo[pos] = {&quot;st_chess&quot;, color = 0, name=&quot;Atrax#&quot;}
+
+  For each call of the line above the new object will be named with a unique
+  number appended after the &quot;#&quot; giving &quot;Atrax#1&quot;, &quot;Atrax#2&quot;, &quot;Atrax#3&quot;, ...
+
+Requesting an object:
+
+  obj = it(pos)
+  obj = it(x, y)
+  obj = st(pos)
+  obj = wo:it(pos)
+  my_item = it(my_floor)    -- get the item that is on top of the given floor
+  
+  obj = no[&quot;Atrax&quot;]
+
+Killing an object:
+
+  obj:kill()
+  wo[pos] = {&quot;it_nil&quot;}
+
+Comparing objects
+
+  obj1 == obj2
+
+Existance of an object
+
+  obj:exists()
+  -obj                -- unary minus operator on object
+  if -obj then ...
+
+Messages:
+
+  my_boulder:message(&quot;direction&quot;, WEST)
+  my_boulder:direction(EAST)
+  my_door:open()
+
+Classification of objects:
+
+  obj:is(&quot;st_chess&quot;)
+  obj:is(&quot;st&quot;)
+  obj:is(&quot;st_chess_black&quot;)
+
+Group of objects:
+
+  group = no[&quot;Atrax#*&quot;]            -- a group of all matching objects
+                                   --   wildcards &quot;*&quot;,&quot;?&quot; allowed
+  group = grp(obj1, obj2, obj3)
+  group = grp({obj1, obj2, obj3})  -- a group of objects set up in a table
+
+Many operations can be applied to groups
+
+  floor_group[friction] = 3.2      -- set attribute on all floors in the group
+  door_group:message(&quot;open&quot;)
+  door_group:open()
+  stone_group:kill()
+  wo[floor_group] = {&quot;it-coin2&quot;}   -- add some money on all floor positions
+  
+  wo[pos] = {&quot;st_switch&quot;, target=door_group, action=&quot;open&quot;}
+  wo[pos] = {&quot;st_switch&quot;, target=&quot;door#*&quot;, action=&quot;close&quot;}
+
+Group operations
+
+  doors_lasers = doorgrp + lasergrp       -- join of two groups
+  lasergrp     = doors_lasers - doorgrp   -- difference of two groups
+  common_doors = doorgrp1 * doorgrp2      -- intersection of two groups
+
+For loops over a group
+
+  for i = 1, #mygroup do obj = mygroup[i] ... end
+  for obj in mygroup do ... end
+
+Setting and connecting two vortices:
+
+ wo[{3,4}] = {&quot;it_vortex&quot;, name=&quot;vortex1&quot;, destination=&quot;vortex3&quot;}
+ wo[{8,6}] = {&quot;it_vortex&quot;, name=&quot;vortex2&quot;, destination=&quot;vortex1&quot;}
+ wo[{8,6}] = {&quot;it_vortex&quot;, name=&quot;vortex3&quot;, destination={&quot;vortex1&quot;,&quot;vortex2&quot;}}
+
+
+Tiles:
+
+  ti[&quot;  &quot;] = {&quot;fl_sand&quot;}
+  ti[&quot; w&quot;] = ti[&quot;  &quot;] .. {&quot;it_wand&quot;}
+  ti[&quot;  &quot;] = {&quot;fl_abyss&quot;}   -- redefinition causes error to avoid common
+                            --   mistakes
+
+  wo[{3,4}] = ti[&quot; w&quot;]
+  wo[{5,6}] = ti[&quot;  &quot;] .. {&quot;st_chess&quot;}
+
+  width, height = wo(ti, &quot;  &quot;, { -- second arg: default tile key that 
+  &quot;########&quot;,                    --   defines the base, too - this example
+  &quot;##   w##&quot;,                    --   is 2 chars per tile/grid 
+  &quot;########&quot;
+  })
+
+Note: Tiles kann be used after the initialization as well:
+
+function my_callback(value, sender)
+    wo[sender] = ti[&quot; w&quot;]
+end
+
+
+
+
+C2 - Object reference validity and usability   (done)
+--------------------------------------------
+
+Objects existance and validity can be checked at via the &quot;obj:exists()&quot;
+method or the operator &quot;-obj&quot;. Not existing objects are still of type
+object (not nil like in old API!). These &quot;null&quot; objects are not equal
+concerning the Lua &quot;==&quot; comparison to any object, even themself.
+
+Write access, kill of and messages to &quot;null&quot; objects are silently ignored.
+World set objects to &quot;null&quot; object position is ignored, too. This allows
+loops and group usage even with &quot;null&quot; targets without problems.
+
+All read operations that return object specific values which are not
+usable for group operations and can just be used with a single object
+as target will throw an error if this object is a &quot;null&quot; object. The
+application will no longer crash. Just a backtrace will be shown like
+on other level exceptions.
+
+
+C3 - Booleans and Nil   (mainly done)
+---------------------
+
+All boolean type attributes and values in the new API are Lua 5.0++
+booleans with values &quot;true&quot; and &quot;false&quot;. The engine internal value
+representation takes boolean as another explicit type. Type mismatches
+on transfer of boolean values from or to Lua will no longer occur.
+
+Some attributes and values of the old API that did take values 0 and 1
+may change to other types than boolean due to other API concepts.
+
+Setting an attribute value to &quot;nil&quot; causes the value to be deleted.
+Any further access returns the default value for the attribute.
+
+C4 - Multitarget and Multiaction (coded)
+--------------------------------
+
+The target-action paradigm is extended to a multitarget and multiaction
+messaging system that is even configurable on the senders state. 
+
+Every object can take objects, groups of objects or namestrings (including
+wildcards) as target:
+
+  {&quot;st_switch&quot;, target=my_laser, action=&quot;on_off&quot;}
+
+  {&quot;st_switch&quot;, target=no[&quot;my_doors#*&quot;], action=&quot;open_close&quot;}
+  {&quot;st_switch&quot;, target=&quot;my_doors#*&quot;, action=&quot;open_close&quot;}
+
+Note the subtle difference between the last two expressions: The first one
+evaluates the wildcarded string immediatley and builds a fixed group of the
+current objects that fit the name pattern. The second string is stored as
+given and will be evaluated at the moment the action is performed. This is
+what you need in tile definitions, as the desired target do not exist at the
+moment of the tile definition.
+
+Multiple targets can be declared and each target can take a different action:
+
+  {&quot;st_switch&quot;, target={my_laser, &quot;my_door#*&quot;, &quot;my_function&quot;},
+                action={&quot;on_off&quot;, &quot;open_close&quot;, &quot;callback&quot;}}
+
+The default action for all functions is &quot;callback&quot;, which can thus be
+omitted:
+
+  {&quot;st_switch&quot;, target=&quot;my_function&quot;}
+
+The default action for all objects is &quot;toggle&quot;, which can thus be
+omitted:
+
+  {&quot;st_switch&quot;, target=&quot;my_laser&quot;}
+
+Every callback takes the arguments (state_value, sender) where 
+&quot;state_value&quot; is an integer value that represents the internal state
+of the sender object. For switch like objects the state will be 0 for
+&quot;off&quot; and 1 for &quot;on&quot;. Other objects like fourswitch etc. will count the
+their states from 0, 1, 2,...
+
+For special cases, especially for editor based levels, the author can
+specify different target/action behaviour based on the value of the
+sender objects state. For each state the following special targets and
+actions preceed the default target and actions given above:
+
+  {&quot;st_switch&quot;, target_0=&quot;my_door&quot;, action_0=&quot;close&quot;,
+                target_1=&quot;my_laser&quot;, action_1=&quot;off&quot;}
+
+
+The multitarget feature is the successor of the old signal feature. In
+contrast to signals that were bound to tile positions like &quot;stone on
+grid {15, 4}&quot; the multitarget addresses objects themselves. The action
+will find its target even when the user swaps it to another grid postion.
+
+
+C5 - Renaming (partially done)
+-------------
+
+The necessary API changes gives the unique opportunity to simplify
+many old names and to make them consistence. None of names used above
+is fixed. It is up to the level authors to agree on a naming scheme.
+
+Note that valid Lua names start with letter or underscore and consist
+just of these plus numbers.
+
+Just the following rules and conditions need to be observed:
+
+- Short 2 or 3 letter names for the namespace and the special objects
+- System attribute and message names have to be valid Lua names not
+  starting with underscore
+- User attributes start with an underscore
+- System attribute and method names are disjoint
+- Identical system attributes or methods have identical behaviour for
+  all objects
+- User names for objects do not start with &quot;$&quot;,&quot;#&quot; or &quot;%&quot;, do not contain a character
+  out of &quot;,;&quot; and do not end with &quot;#&quot;
+- Object Classnames should use a common scheme of underscore/hyphen
+  usage: Either underscore only, or first hyphen and all other 
+  underscore,... (st_chess_black, st-chess_black, ...)
+
+  Decision of Draft 0.60: all object names will uses exclusivly underscore! 
+
+
+C6 - Global Variables   (coded)
+---------------------
+
+Global variables are handled as attributes of the special world object
+&quot;wo&quot;. Write access on variables will be checked and can cause actions
+if necessary. A write to a read only variable like &quot;IsDifficult&quot; will be
+silently ignored.
+
+
+C7 - Critical functions
+-----------------------
+
+All critical functions will be abolished to ensure that new levels
+will be suited for upcoming features. For the very few existing levels
+of the distribution that depend on such features exceptions will be
+hardcoded that will keep these levels to conflict with the new features.
+
+
+C8 - Oxyd   (coded)
+---------
+
+The color attribute is an integer value (0, 1, ..., 7).
+
+Oxyds can be set like any other stones. If no color attribute is
+specified pairs of oxyds with the same color will be set.
+
+To guarantee fair distributions and levels that are solvable the
+author can declare minimum and maximum conditions and groups of
+oxyds like:
+
+wo:shuffleOxyd({grp1, max=0}, {grp1, grp2, min=2}, 
+    {grp1, grp3, min=1, max=1})
+
+As a shortcut groups of oxyds can be declared to be positioned either
+circular or linear. This declaration expands to all rules necessary to
+avoid any neighbour oxyd pairs.
+
+wo:shuffleOxyd({grp(ox1, ox2, ox3, ox4, ox5, ox6), circular=true},
+    {grp2, linear=true})
+
+C9 - Rubberband
+---------------
+
+Rubberband is an object that can be referenced and checked for existance.
+
+
+C10 - Name inheritance   (partially done)
+----------------------
+
+Items like it_seed, it_rubberband that change into stone or rubberband
+objects on activation will inherit their name to the successor stone
+object.
+
+C11 - Checkerboard Floor   (coded)
+------------------------
+
+Every floor takes an attribute &quot;checkerboard&quot;. If set to an integer value
+0 the floor will only be placed on grids with x+y being even, if set
+to 1 the floor will be placed only on grids with x+y being uneven.
+
+ti[&quot;x&quot;] = ti({&quot;fl_rough_red&quot;, checkerboard=0}) + 
+         {&quot;fl_rough_blue&quot;, checkerboard=1}
+
+generates an arbitrary shaped checkboardfloor on areas with tile &quot;x&quot;
+on the world map.
+
+C12 - Puzzle
+------------
+
+Puzzles can be autoconfigured and shuffled by the engine. Besides the
+single puzzle stones a dummy stone named &quot;st_puzzle_auto&quot; can be set.
+All adjacent &quot;st_puzzle_auto&quot; and &quot;st_puzzle_hollow&quot; of the same color
+will be configured to a puzzle with maximum number of connections:
+
+ti[&quot;#&quot;] = {&quot;st_puzzle_auto&quot;}
+ti[&quot;*&quot;] = {&quot;st_puzzle_hollow&quot;}
+
+wo{ti,&quot; &quot;,{
+&quot;  # &quot;,
+&quot;##*#&quot;,
+&quot;### &quot;,
+&quot; #  &quot;}
+
+results in a puzzle:
+
+   |
+ /T+-
+ \+/
+  |
+
+with the upper &quot;+&quot; being a hollow cross.
+
+If any of the involved puzzle stones has an attribute &quot;shuffle&quot; set
+to &quot;true&quot; the complete puzzle will shuffled. If the value of any
+puzzle stone is an integer it will be taken as the number of permutations
+to be applied. The maximum number of all values will be taken.
+
+Shuffle occurs by permutation of rows and columns that a marble can
+reverse. By default it is assumed that the user can permute rows and
+columns on every side which is not blocked by a stone that is not hollow.
+
+In case the puzzle is only accessable from one side the author can add
+attributes &quot;permute_v&quot; and &quot;permute_h&quot; with boolean values to every
+puzzle stone that does not follow the standard rule.
+
+As hollow puzzle stones will never be permuted to the border of a puzzle
+the author can ensure that every shuffle results in a solvable puzzle.
+
+
+
+Appendix
+========
+
+
+Index/member interpretation and operations of new types:
+--------------------------------------------------------
+
+value = number|string|boolean|object|nil    add  |group|position ?
+
+Enigmaobject:
+  x, y       - grid position access
+
+  exists()
+  is()           - (string)        - test kind
+  kind()         - ()              - get most specific kind
+  kill()         - ()              - kill object
+  message()      - (string [, value]) - send message with an optional value
+  set()          - (table)         - set multiple attributes given in a table
+                                     as key, value pairs
+  xy()
+
+  attribute name       - set/get attribute
+
+  other String not prefixed by &quot;_&quot;   - message
+
+  valid Operations:
+    +            - (object|position|table) + (object|position|table)
+    -            - (object|position|table) - (object|position|table)
+    #            - #object         -- center
+    - (unary)    - -object         -- existance
+    ==           - object == object
+    
+
+Position:
+
+  x, y,          - grid position access
+  
+  grid()               - returns a position aligned to the grid
+  xy()                 - returns x, y
+  
+  valid Operations:
+    +            - (object|position|table) + (object|position|table)
+    -            - (object|position|table) - (object|position|table)
+    *            - (number|position) * (number|position)
+    /            - position / number
+    #            - # position
+    ==           - position == position
+.   ..           - position .. position
+
+Namedobject:
+
+  $String              - reserved for future usage
+  String               - named object access - returns nil if not existing
+                       - name must not include wildcard chars *,?
+  String*?             - get named group with wildcards *,?
+
+Worldobject:
+  [object|position|table|group] = table|tile - write access to world grid
+  [string]             - global world attribute read/write access
+  
+  ()             - (ti|function, string, table) -- initialization &quot;wo(,,)&quot;
+  
+
+  fl()           - (position|table|obj|(num,num)) - get floor at position
+  it()           - (position|table|obj|(num,num))      - get item at position
+  st()           - (position|table|obj|(num,num))      - get stone at position
+  
+  
+  init()         - (ti|function, string, table) -- method synonym for () 
+
+
+Group:
+  1, 2, 3,...          - positve integer as sequence index like table read access
+  String               - on write: set attrib on members
+                       - on access: call method or send message on object
+
+  valid Operations:
+    +                  - join of groups
+    *                  - intersection of groups
+    -                  - difference of groups
+    #                  - length, inherited from table
+
+Tile:
+  
+  valid Operations:
+   ..                   - concat tiles
+   ti(table)            - new tile
+
+
+Tiles:
+  String               - table like read access with string  as index
+                       - write only on not yet existing indices - no overwrite
+		         assign (table|tile)
+
+
+Global Functions  (to be defined)
+----------------
+
+  po(table|[num,num]|obj)
+  fl(position|table|obj|(num,num))
+  it(position|table|obj|(num,num))
+  st(position|table|obj|(num,num))
+
+
+Lua Caveats:
+============
+
+It is a basic LUA feature that the user has no real control about the used
+variable types. This causes overall trouble:
+
+a = &quot;3&quot;
+b = &quot;7&quot;
+c = 4
+b - a == c          -- is true as    7 - 3 == 4
+c + a == b          -- is false as   4 + 3 == 7  but 7 ~= &quot;7&quot;
+
+A similar LUA problem may hit authors in the usage of position constants.
+Expressions like {7,3} may be used anywhere as position arguments as they are
+autoconverted into positions. But care must be taken with direct calculations
+and variable assignments of constant positions:
+
+table = {7, 3}      -- this variable is a simple table with two numbers at
+                    -- the indices 1 and 2 but it is not a position
+wo[table] = obj     -- o.k. as the table gets now converted as an argument
+pos = #table        -- is not a centerd position but a number with value 2
+                    -- as it the length operation of a table
+pos = table + {1,2} -- error as two tables cannot be added like positions
+pos = obj + table   -- o.k. as obj is a position that forces an autoconvert
+                    -- of the table
+
+
+Another similar Lua caveat exists in the position comparison. Even though
+you can use objects as position standins anywhere else the Lua comparison of
+variables priorises the type comparison to the value comparison:
+
+pos = po(3, 5)
+wo[pos] = {&quot;st-switch&quot;}
+obj = st(pos)
+pos == obj          -- false as the types differ
+pos == po(obj)      -- true as types and values are equal
+
+
+
+Lua index syntax - different treatment of numbers, names and strings:
+
+1, 2                        -- are valid Lua numbers
+x, y, otto2, _myX           -- are valid Lua names
+&quot;$secret&quot;, &quot;1&quot;, &quot;fl-abyss&quot;  -- are just Lua strings
+
+x = 7
+pos = po(3, 5)
+pos[&quot;x&quot;]          -- valid table like access to x coordinate
+pos[x]            -- error as pos[7] is accessed
+pos.x             -- valid member access that is equivalent to pos[&quot;x&quot;]
+obj[&quot;state&quot;]      -- valid access to attribute &quot;state&quot;
+obj[state]        -- error as global variable &quot;state&quot; is first evaluated (nil)
+obj.state         -- valid access to attribute &quot;state&quot;
+tab[1]            -- valid table access to first entry
+tab[&quot;1&quot;]          -- table access to entry at key &quot;1&quot; which is not the first
+                  --   table entry but likley nil.
+tab.1             -- error - Lua needs a valid Lua-name as member
+
+


Property changes on: trunk/doc/reference/ConceptLuaAPI2.txt
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2008-04-12 09:04:17 UTC (rev 1100)
+++ trunk/doc/reference/enigma-ref.texi	2008-04-12 09:34:19 UTC (rev 1101)
@@ -3044,7 +3044,7 @@
 You can generate an initially open door by setting its attributes. But how
 can a switch stone open a door when it is hit by a marble? It simply sends
 a message @samp{open} to the door. Another switch may send a message
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at samp</A>{on} to a laser or @samp{ignite} to a @ref{it_dynamite}. On explosion
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{on} to a laser or @samp{ignite} to an @ref{it_dynamite}. On explosion
 the dynamite will in turn send automatically @samp{ignite} messages to the
 neighbour grid positions.
 
@@ -3176,7 +3176,9 @@
 @samp{0} representing @samp{WEST}.
 
 In most cases it is sufficient to perform a state independent common action
-like @ref{toggle}. But sometimes you may want to perform state specific actions.
+like @ref{toggle}. Even two stated objects can be easily sychronized by the
+standard action @ref{signal}. But sometimes you may want to perform very state
+specific actions. Let us look how this can be done.
 
 E.g. a @ref{st_fourswitch} that switches two @ref{st_laser} beaming in 3 states
 but one of them being switched off while in @samp{EAST} state and the other being
@@ -3212,7 +3214,7 @@
 the first trigger should switch the laser on, an object pressing the second
 trigger should switch it off. But a trigger is two stated and performs one
 action on being pressed and another on being released. Thus we want to block
-the actions an trigger release events:
+the actions on trigger release events:
 
 @example
 @{it_trigger, name=&quot;on_trigger&quot;,  target=&quot;laser#1&quot;, action_1=&quot;on&quot;, action_0=&quot;nop&quot;@}
@@ -3337,6 +3339,8 @@
 @node Lua API
 @chapter Lua API
 
+Read API Concept Draft
+
 @c ===================  Commons  =======================
 @node Common Attributes and Messages
 @chapter Common Attributes and Messages
@@ -3349,6 +3353,7 @@
 @menu
 * Common Attributes:: 
 * Common Messages::   
+* Global Attributes::
 @end menu
 
 @node Common Attributes
@@ -3425,7 +3430,31 @@
 @node destination
 @subsection destination
 
+An attribute that describes one or several destinations. It is used by objects
+like @ref{it_vortex} and @ref{it_wormhole} to describe their teleporting
+destination.
 
+Note that this attribute is only supported if it is listed in the individual
+description.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Type:} @ @ tokens or a single position
+Just a single position for a first destination is allowed. Use tokens to
+define multiple destination.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Values:} @ @ @xref{Object Attributes}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+destination = po(3.0, 4.7)
+destination = &quot;myFloor&quot;
+destination = myObject
+destination = @{&quot;vortex2&quot;,&quot;vortex3&quot;,&quot;vortex4&quot;@}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+Note that objects like @samp{it_wormhole} that have just a single destination
+do take the first token object.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Default:} @ @ @code{nil}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Access:} @ @ read/write
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Support:} @ @ by teleporting objects
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @node Common Messages
 @section Common Messages
 
@@ -3460,6 +3489,76 @@
 @node close
 @subsection close
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Global Attributes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at section</A> Global Attributes
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at menu</A>
+* MagnetRange:: 
+* MagnetStrength:: 
+* WormholeRange:: 
+* WormholeStrength:: 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> menu
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> MagnetRange
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> MagnetRange
+
+A global default distance up to which magnets apply forces to actors. This
+global value is only used if no object specific value is set. 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Type:} @ @ number
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Values:} @ @ positive float number or zero
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Default:} @ @ @code{10.0}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Access:} @ @ read/write
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Support:} @ @ @ref{it_magnet}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> MagnetStrength
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> MagnetStrength
+
+A global scalar default factor for magnet forces. Positive numbers are 
+attracting forces where as negative numbers are repelling forces. This global 
+value is only used if no object specific value is set. 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Type:} @ @ number
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Values:} @ @ float number
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Default:} @ @ @code{30.0}
+Positve number are attracting, negative numbers are repelling.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Access:} @ @ read/write
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Support:} @ @ @ref{it_magnet}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> WormholeRange
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> WormholeRange
+
+A global default distance up to which wormholes apply forces to actors. This
+global value is only used if no object specific value is set. 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Type:} @ @ number
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Values:} @ @ positive float number or zero
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Default:} @ @ @code{10.0}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Access:} @ @ read/write
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Support:} @ @ @ref{it_wormhole}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> WormholeStrength
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> WormholeStrength
+
+A global scalar default factor for wormhole forces. Positive numbers are 
+attracting forces where as negative numbers are repelling forces. This global 
+value is only used if no object specific value is set. 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Type:} @ @ number
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Values:} @ @ float number
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Default:} @ @ @code{30.0}
+Positve number are attracting, negative numbers are repelling.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Access:} @ @ read/write
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Support:} @ @ @ref{it_wormhole}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ===================  Floors  =======================
 
 @node Floor Objects
@@ -3478,13 +3577,19 @@
 
 @menu
 * it_blocker::         Shrinked Blocker Stone
+* it_brush::           
+* it_coin::            Enigma's currency
 * it_extralife::
+* it_floppy::          
 * it_hammer::
+* it_key::             
 * it_magnet::
 * it_sword::
 * it_trigger::         Floor Switch for Actors and Stones
-* it_umbrella::
-* it_wormhole::
+* it_umbrella::        Death Protection Item
+* it_vortex::          Teleport of Marbels
+* it_wormhole::        Teleport of Actors
+* it_wrench::          
 @end menu
 
 
@@ -3568,6 +3673,66 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Brush Item -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_brush
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_brush
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_brush
+
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Coin Item -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_coin
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_coin
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_coin
+
+A coin activates an @ref{st_coinslot} when inserted by hitting the stone with
+the coin as first item in the players inventory. The time interval of activity 
+of the coinslot depends on the coin type that is represented by its 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{state}. Small, medium and large coin variants do exist.
+
+When hit by a moving stone the coin type changes from small to medium and
+from medium to large.
+
+A laser beam transforms a small coin into an @ref{it_umbrella}, a medium coin
+into an @ref{it_hammer} and a large coin into an @ref{it_extralife}.
+
+A coin that comes into existence on an illuminated grid position will not
+transform due to already existing laser beams. But it will transform on the first
+additional beam and on laser beams that are switched off and on again.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{0}, @code{1}, @code{2}; @ @ @i{access}: @code{read only} @ @ @xref{state}
+Represents the coin type with 0 being a small coin, 1 being a medium coin and
+2 being a large coin.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_coin}
+A small coin.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_coin_s}
+A small coin.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_coin_m}
+A medium coin.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_coin_l}
+A large coin.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Extralife Item -------------------- 
 @node it_extralife
 @subsection it_extralife
@@ -3596,6 +3761,22 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Floppy Item -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_floppy
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_floppy
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_floppy
+
+A floppy activates an @ref{st_floppy} when inserted by hitting the stone with
+the floppy as first item in the players inventory.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Hammer Item -------------------- 
 @node it_hammer
 @subsection it_hammer
@@ -3628,11 +3809,83 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Key Item -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_key
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_key
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_key
+
+A key activates an @ref{st_key} when inserted by hitting the stone with
+the key as first item in the players inventory.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{code}, @ @ @i{values}: number; @ @ @i{default}: @code{1}
+The code of a key must match that of an @ref{st_key} to unlock it.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Magnet Item -------------------- 
 @node it_magnet
 @subsection it_magnet
 @obindex it_magnet
 
+Attracts or repells actors in its @samp{range} with a force proportional to the
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{strength} and the inverse of the squared distance. A magnet can be 
+switched @samp{ON} and @samp{OFF}.
+
+Note that no forces are applied to actors at a distance smaller than 0.05 grids
+to avoid extraordinary large forces.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF} @ @ @xref{state}
+The current magnet state - @samp{ON} for an active magnet, @samp{OFF} for an
+inactive magnet.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{range} @ @ @i{values}: float number greater equal 0; @ @ @i{default}: @code{10.0} @ @ @xref{MagnetRange}
+The distance up to which the magnet applies forces to actors.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{strength} @ @ @i{values}: float number; @ @ @i{default}: @code{+30.0} @ @ @xref{MagnetStrength}
+A scalar factor for magnet forces. Positive numbers are attracting forces
+where as negative numbers are repelling forces.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{signal} @ @ @xref{signal}
+A signal of value 1 switches the magnet on, a value of 0 switches the magnet off.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{toggle} @ @ @xref{toggle}
+A toggle causes a change in the magnet activity state.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{on} @ @ @xref{on}
+Switches the magnet on.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{off} @ @ @xref{off}
+Switches the magnet off.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:}
+none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_magnet}
+A magnet in state @samp{OFF}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_magnet_on}
+A magnet in state @samp{ON}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_magnet_off}
+A magnet in state @samp{OFF}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Sword Item -------------------- 
 @node it_sword
 @subsection it_sword
@@ -3668,7 +3921,7 @@
 @subsection it_trigger
 @obindex it_trigger
 
-The trigger item is a switch on top of the floor that reacts on actors and
+The trigger item is a switch on top of a floor that reacts on actors and
 stones on top of it that may press it. It performs actions when it is initially
 pressed and again when it releases after the last object left it. A pressed 
 trigger is in state @samp{ON} and will send an action value of @samp{true}, a 
@@ -3751,17 +4004,182 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Vortex Item -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_vortex
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_vortex
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_vortex
+
+Teleports marbles to a given @samp{destination}. Unlike @ref{it_wormhole} it
+does not teleport other actors.
+
+In the simplest case, a vortex is connected to a single destination given by
+an object or a position. If the destination is not blocked by a stone the
+marble will be teleported to the destination.
+
+If there multiple destination addresses are given, the marble will be teleported
+to the single destinations in sequence. Blocked destinations are indicated by
+sparkles. Finally the marble exists on the first unblocked destination. If no
+unblocked destination exists the marble exists on the starting vortex. A level
+author can write nice puzzle which require the user to block destinations to
+reach the final destination of a vortex.
+
+Vortices can be open or closed. Of course a marble can enter just an open
+vortex. Closed vortices at the destination are opened automatically. By default
+such vortices remain open. By usage of the attribute @samp{autoclose} you can
+configure a vortex to close after a marble has been emitted.
+
+Marbles are emitted by vortices in a jumping fashion. The user can accelerate
+the marble for a short period and the marble may jump out of a vortex into a
+desired direction.
+
+Vortex teleportation take a short amount of time and the involved vortices are
+blocked for other teleporting request during this process. Thus it is no problem
+to set up destinations of vortices that build a cycle.
+
+Rubberbands bound to teleported actors are cut by default. The attribute
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{scissor} allows you to control the cutting behaviour.
+
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{OPEN}, @code{CLOSED}; @ @ @i{default}: @code{OPEN} @ @ @xref{state}
+The visual state of a vortex. An @samp{OPEN} vortex may still be busy due
+to ongoing teleportations and may not accept a marble.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{destination}, @ @ @i{values}: tokens or position; @ @ @i{default}: @code{nil} @ @ @xref{destination}
+The destination of the teleport given by an object or a position.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{autoclose}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
+Flag that indicates whether the vortex should be closed after a teleport.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{scissor}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}
+Rubberband cutting behaviour on teleporting.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{signal} @ @ @xref{signal}
+Opens the vortex on value @samp{1}, and closes the vortex on value @samp{0}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{toggle} @ @ @xref{toggle}
+Opens a closed vortex and closes an open vortex if possible.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{open} @ @ @xref{open}
+Try to open a vortex.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{close} @ @ @xref{close}
+Try to close a vortex.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:}
+none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Wormhole Item -------------------- 
 @node it_wormhole
 @subsection it_wormhole
 @obindex it_wormhole
 
+Teleports actors of any kind to a given @samp{destination}. Unlike 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{it_vortex} every wormhole has a unique destination. But of course the
+destination may be another wormhole which instantly teleports the actor again.
+Infinite circle of wormholes conneted by destinations are forbidden.
+
+A wormhole can attract or repell actors in its @samp{range} with a force
+proportional to the @samp{strength} and the inverse of the squared distance.
+The force can be switched @samp{ON} and @samp{OFF} and is represented by its
+external @samp{state}. Note that no forces are applied to actors at a distance
+smaller than 0.05 grids to avoid extraordinary large forces.
+
+Rubberbands bound to teleported actors are cut by default. The attribute
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{scissor} allows you to control the cutting behaviour.
+
+After teleporting an actor, the wormhole's teleporting ability may be switched
+off for a short latency period given by @samp{interval}. A letancy separates
+actors travelling through a wormhole and avoids overlapping actors at the
+destination.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF} @ @ @xref{state}
+The current force state - @samp{ON} for an force applying wormholes, @samp{OFF}
+for force neutral wormholes.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{destination}, @ @ @i{values}: tokens or position; @ @ @i{default}: @code{nil} @ @ @xref{destination}
+The destination of the teleport given by an object or a position.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{range} @ @ @i{values}: float number greater equal 0; @ @ @i{default}: @code{10.0} @ @ @xref{WormholeRange}
+The distance up to which the wormhole applies forces to actors.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{strength} @ @ @i{values}: float number; @ @ @i{default}: @code{+30.0} @ @ @xref{WormholeStrength}
+A scalar factor for the wormhole force. Positive numbers are attracting forces
+where as negative numbers are repelling forces.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{scissor}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}
+Rubberband cutting behaviour on teleporting.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{interval} @ @ @i{values}: float number greater equal 0; @ @ @i{default}: @code{0.0}
+The letancy time after a teleport during which no further teleports take place.
+
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{signal} @ @ @xref{signal}
+A signal of value 1 switches the wormhole force on, a value of 0 switches the
+wormhole force off.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{toggle} @ @ @xref{toggle}
+A toggle causes a change in the wormhle force activity state.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{on} @ @ @xref{on}
+Switches the wormhole on.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{off} @ @ @xref{off}
+Switches the wormhole off.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:}
+none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_wormhole}
+A wormhole in state @samp{OFF}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_wormhole_on}
+A wormhole in state @samp{ON}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{it_wormhole_off}
+A wormhole in state @samp{OFF}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Wrench Item -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_wrench
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_wrench
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_wrench
+
+A wrench wielded as first item in the players inventory causes some objects
+to react on actor hits. An @ref{st_rotator} changes its turning direction.
+An green @ref{st_turnstile} rotates backwards when hit. An @ref{st_window}
+face pushed with an wrench will swap to the opposite side of the stone if
+possible.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ===================  Stones  =======================
 @node Stone Objects
 @chapter Stone Objects
 
 @menu
-* Simple Stones:: 
+* Simple Stones::
+* Cluster Stones::
 * Transparent Stones::
 * Breakable Stones::
 * Special Stones::
@@ -3771,6 +4189,169 @@
 @node Simple Stones
 @section Simple Stones
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Cluster Stones
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at section</A> Cluster Stones
+
+A cluster stone is a passive wall stone like a simple stone. But several
+cluster stones adjacent to each other can visually build a cluster and look
+like a single big stone with a one common outer face.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at menu</A>
+* Cluster Features::   Common Attributes and Features
+* st_bluesand::        big sand stone look
+* st_brick::           brick wall look
+* st_panel::           wooden panel look
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> menu
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Cluster Features -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Cluster Features
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Cluster Features
+
+For each cluster stone there exist 16 different variations that represent all
+needed combinations of inner and outer faces to build arbitrary shaped big
+blocks. 
+
+There exist two methods of describing a special variation. You can either give
+the inner faces, the @samp{connections}, those sides that should be adjacent to
+other stones of the same cluster. Or you can give the outer faces, the 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{faces}, that build the common outer face of the resulting big block.
+
+As it is a tedious work to set up larger blocks by their single stones with
+appropriate faces you can rely on an automatical clustering feature. Just
+set the @samp{cluster} attribute of all single stones of a big block to the
+same number and the faces will be set up automatically to form a large block.
+
+You can build a screen of arbitrary big blocks and it is proven that there will
+be never be the need of more than 4 different cluster numbers (the &quot;4 color 
+theorem&quot;). But for convenience you are free to use additional cluster numbers
+as you like. Note that the autoclustering is quite dynamic. A single cluster
+stone with fitting cluster number that is swapped at the side of an existing
+block with the same cluster number will melt and join the block like seen in
+&quot;Terminator 2&quot;.
+
+We recommend making use of the autoclustering feature by setting the 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{cluster} attribute and using the @samp{faces} attribute where necessary.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{connections} attribute and explicit naming of variations by suffices 
+are depreceated, but will continue to be supported.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{connections}, @ @ @i{values}: string; @ @ @i{default}: @code{nil}
+Describes the inner faces of stone. The string is a substring of @code{&quot;nesw&quot;}
+listing the inner faces. The sequence of the sides, north, east, south, west,
+is guaranteed on read access but arbitrary on write access.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{faces} @ @ @i{values}: string; @ @ @i{default}: @code{nil}
+Describes the outer faces of stone. The string is a substring of @code{&quot;nesw&quot;}
+listing the outer faces. The sequence of the sides, north, east, south, west,
+is guaranteed on read access but arbitrary on write access.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{cluster} @ @ @i{values}: number; @ @ @i{default}: @code{nil}
+If set to a number all adjacent cluster stones of the same base type with
+the identical cluster number will build a big block. This attribute superceeds
+any explicit given face description.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Bluesand Stone -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_bluesand
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_bluesand
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_bluesand
+
+A standard cluster stone with the @ref{Cluster Features}. It is recommended
+to use @samp{st_bluesand} with the attributes @samp{cluster} and @samp{faces}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand}: connections = @code{&quot;&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_w}: connections = @code{&quot;w&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_s}: connections = @code{&quot;s&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_sw}: connections = @code{&quot;sw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_e}: connections = @code{&quot;e&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_ew}: connections = @code{&quot;ew&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_es}: connections = @code{&quot;es&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_esw}: connections = @code{&quot;esw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_n}: connections = @code{&quot;n&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_nw}: connections = @code{&quot;nw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_ns}: connections = @code{&quot;ns&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_nsw}: connections = @code{&quot;nsw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_ne}: connections = @code{&quot;ne&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_new}: connections = @code{&quot;new&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_nes}: connections = @code{&quot;nes&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_bluesand_nesw}: connections = @code{&quot;nesw&quot;}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Brick Stone -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_brick
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_brick
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_brick
+
+A standard cluster stone with the @ref{Cluster Features}. It is recommended
+to use @samp{st_brick} with the attributes @samp{cluster} and @samp{faces}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick}: connections = @code{&quot;&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_w}: connections = @code{&quot;w&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_s}: connections = @code{&quot;s&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_sw}: connections = @code{&quot;sw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_e}: connections = @code{&quot;e&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_ew}: connections = @code{&quot;ew&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_es}: connections = @code{&quot;es&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_esw}: connections = @code{&quot;esw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_n}: connections = @code{&quot;n&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_nw}: connections = @code{&quot;nw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_ns}: connections = @code{&quot;ns&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_nsw}: connections = @code{&quot;nsw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_ne}: connections = @code{&quot;ne&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_new}: connections = @code{&quot;new&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_nes}: connections = @code{&quot;nes&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_brick_nesw}: connections = @code{&quot;nesw&quot;}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Panel Stone -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_panel
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_panel
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_panel
+
+A standard cluster stone with the @ref{Cluster Features}. It is recommended
+to use @samp{st_panel} with the attributes @samp{cluster} and @samp{faces}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel}: connections = @code{&quot;&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_w}: connections = @code{&quot;w&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_s}: connections = @code{&quot;s&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_sw}: connections = @code{&quot;sw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_e}: connections = @code{&quot;e&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_ew}: connections = @code{&quot;ew&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_es}: connections = @code{&quot;es&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_esw}: connections = @code{&quot;esw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_n}: connections = @code{&quot;n&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_nw}: connections = @code{&quot;nw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_ns}: connections = @code{&quot;ns&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_nsw}: connections = @code{&quot;nsw&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_ne}: connections = @code{&quot;ne&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_new}: connections = @code{&quot;new&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_nes}: connections = @code{&quot;nes&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_panel_nesw}: connections = @code{&quot;nesw&quot;}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
+
 @node Transparent Stones
 @section Transparent Stones
 @node Breakable Stones
@@ -3781,9 +4362,15 @@
 @menu
 * st_blocker::         Shrinkable Blocker
 * st_boulder::         Moving Arrow Boulder
+* st_coinslot::        Coin Driven Switch
+* st_floppy::          Floppy Driven Switch
 * st_fourswitch::      Four Direction Switch
+* st_key::             Key Driven Switch
 * st_laser::           Lightemitting Laser
+* st_laserflop::       Lightsensitive Monoflop
 * st_laserswitch::     Lightsensitive Switch
+* st_monoflop::        Monoflop Switch
+* st_oxyd::            Game Target Stone
 * st_polarswitch::     Transparency Switch for Light Beams
 * st_switch::          Classical on/off Switch
 * st_timer::           Animated Timer
@@ -3935,6 +4522,97 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Coinslot Stone -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_coinslot
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_coinslot
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_coinslot
+
+A switch that is activated by insertion of an @ref{it_coin}. Just actors
+assigned to a player can insert coins out of their item inventory by hitting
+the coinslot with the coin being the first item. Depending on the coin type the
+coinslot remains in state @samp{ON} for a given @samp{interval} before switching
+back to state @samp{OFF}. Multiple inserted coins do prolong the activity 
+interval.
+
+Standard not @samp{instant} coinslots do activate after the insertion process
+of the coin. No additional coins can be inserted while another coin is being
+inserted. This prevents unintended multiple coin insertions. On the other hand
+the player has to insert additional coins early enough to prolong the active
+state without temporaryly switching back to @samp{OFF} state. If the first
+interval runs off while the next coin did not yet finish its insertion the
+coinslot will first switch @samp{OFF} and switch @samp{ON} when the next coin
+is completly inserted.
+
+Coinslots configured as @samp{instant} do activy immediatly when the actor
+hits the stone. On every actor hit a coin is inserted independent of the last
+insertion.
+
+The @samp{state} of a coinslot can be requested but it can not be set, neither
+by attribute nor by messages.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}: @i{access}: @code{read only}  @ @ @xref{state}
+Current activity state of the coinslot.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{instant} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
+A default coinslot switches to active state after insertion of a coin and allows
+the insertion of just one coin at a time.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{interval_s} @ @ @i{values}: positive number; @ @ @i{default}: @code{3.0}
+Number of additional active seconds on insertion of a small @ref{it_coin}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{interval_m} @ @ @i{values}: positive number; @ @ @i{default}: @code{6.0}
+Number of additional active seconds on insertion of a medium @ref{it_coin}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{interval_l} @ @ @i{values}: positive number; @ @ @i{default}: @code{12.0}
+Number of additional active seconds on insertion of a large @ref{it_coin}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:} @ @ @xref{target}, @ @ @xref{action}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_coinslot}: instant = @code{false}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_coinslot_instant}: instant = @code{true}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Floppy Stone -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_floppy
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_floppy
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_floppy
+
+A switch that is activated by insertion of an @ref{it_floppy}. Just actors
+assigned to a player can insert a floppy out of their item inventory by hitting
+the floppy switch with a floppy being the first item. 
+
+On a second hit the switch is deactivated and the inserted floppy is returned
+to the players inventory.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}: @ @ @xref{state}
+Current activity state of the floppy stone.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{signal} @ @ @xref{signal}
+Switches on at value @samp{1}, and off at values @samp{0}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{on} @ @ @xref{on}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{off} @ @ @xref{off}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:} @ @ @xref{target}, @ @ @xref{action}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Fourswitch Stone -------------------- 
 @node st_fourswitch
 @subsection st_fourswitch
@@ -3992,6 +4670,41 @@
 and off alternative sources by a fourswitch.
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Key Stone -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_key
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_key
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_key
+
+A switch that is activated by insertion of an @ref{it_key}. Just actors
+assigned to a player can insert a key out of their item inventory by hitting
+the key switch with a key being the first item. Just keys with a matching
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{code} are accepted.
+
+On a second hit the switch is deactivated and the inserted key is returned
+to the players inventory.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}: @ @ @xref{state}
+Current activity state of the key stone.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{code}, @ @ @i{values}: number; @ @ @i{default}: @code{1}:
+The code that is required to activy this switch.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{signal} @ @ @xref{signal}
+Switches on at value @samp{1}, and off at values @samp{0}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{on} @ @ @xref{on}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{off} @ @ @xref{off}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:} @ @ @xref{target}, @ @ @xref{action}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
 @c ----------------- Laser Stone -------------------- 
 @node st_laser
 @subsection st_laser
@@ -4057,6 +4770,53 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Laserflop Stone -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_laserflop
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_laserflop
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_laserflop
+
+A switch that is triggered by actor hits and laser light. It switches instantly 
+to state @samp{ON} and when it is no longer illuminated it switches back to
+state @samp{OFF} after a given @samp{interval}. Repeatitive actor hits and 
+continuing laser light will prolong the @samp{ON} state untill a trailing 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{interval} after the last hit has been expired. A similar object without
+light sensitiveness is the @ref{st_monoflop}.
+
+The single state cycle, called monoflop, can be initiated by @samp{on} and
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{signal} messages. But an activated monoflop cannot be stopped by
+messages or state setting.
+
+At initialization a laserflop that is exposed to laser light will start in state
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{ON} without sending actions due to the @ref{Snapshot Principle}.
+
+A laserflop that is moved or swapped in or out of a laser beam will act on
+the light change with proper actions.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}; @ @ @xref{state}
+Represents the activity state. The state of a new object can be set, but an
+active monoflop cannot be set to state @samp{OFF}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{interval} @ @ @i{values}: positive number; @ @ @i{default}: @code{1.8}
+Number of seconds to return to state @samp{OFF} after the last hit.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{signal} @ @ @xref{signal}
+Switches on at value @samp{1}. A values of @samp{0} is ignored.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{on} @ @ @xref{on}
+Switch the monoflop on like on an actor hit.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:} @ @ @xref{target}, @ @ @xref{action}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Laserswitch Stone -------------------- 
 @node st_laserswitch
 @subsection st_laserswitch
@@ -4088,6 +4848,158 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Monoflop Stone -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_monoflop
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_monoflop
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_monoflop
+
+A switch that is triggered by actor hits. It switches instantly to
+state @samp{ON} and after a given @samp{interval} back to state @samp{OFF}.
+Repeatitive actor hits will prolong the @samp{ON} state untill a trailing 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{interval} after the last hit has been expired. A switch similar to
+the monoflop is the @ref{st_laserflop}, which is additionally light sensitive.
+
+The single state cycle, called monoflop, can be initiated by @samp{on} and
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{signal} messages. But an activated monoflop cannot be stopped by
+messages or state setting.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}; @ @ @xref{state}
+Represents the activity state. The state of a new object can be set, but an
+active monoflop cannot be set to state @samp{OFF}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{interval} @ @ @i{values}: positive number; @ @ @i{default}: @code{1.8}
+Number of seconds to return to state @samp{OFF} after the last hit.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{signal} @ @ @xref{signal}
+Switches on at value @samp{1}. A values of @samp{0} is ignored.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{on} @ @ @xref{on}
+Switch the monoflop on like on an actor hit.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:} @ @ @xref{target}, @ @ @xref{action}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Oxyd Stone -------------------- 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_oxyd
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_oxyd
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_oxyd
+
+The main target stones of the game. Opening all regular oxyd stones is the
+standard goal of the existing @ref{Ending Conditions}. Regular oxyds stones show
+a color spot when opening. Pairs of same colored stones have to be opened in
+sequence, otherwise the first one closes again.
+
+Even though most levels make use of just a single pair of each color, there
+is no limit on a single color. If you like you can define 3 blue pairs of oxyds
+together with 2 yellow pairs. You do this by setting explicit @samp{color}
+attributes to the oxyds.
+
+For standard levels the @samp{color} can be set to its default @samp{OXYD_AUTO}.
+This causes an automatic coloring by pairs of colors in the standard color
+sequence.
+
+There is no limit on the number of used oxyd pairs. But as just 8 colors do exist
+the colors will repeat from the 9th pair giving the user the possibility to
+build arbitrary couples within a single color. Uneven number of regular colored
+oxyds are not allowed.
+
+Usually oxyds are shuffled by a @samp{wo:shuffleOxyd()} statement after setting
+of all oxyds. All @samp{CLOSED} oxyds that are not explicitly excluded by the
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{noshuffle} attribute take place in shuffling. But you can define
+arbitrary rules to limit and influence the shuffling process to guarantee
+solvabitlity and fairness (@pxref{Oxyd Shuffling Rules}).
+
+Oxyds are opened either by an actor hit, an additional laser beam, an
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{st_boulder} triggering or a message call. A single opened oxyd is in the
+state @samp{OPEN}. If a matching second oxyd is opened both switch to the state
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{OXYDPAIR}. Note that this state can be requested, but it can not be set
+directly.
+
+Single opened oxyds close on not matching partner oxyds being opened and on 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{close} messages and state setting operations. But oxyds being part of
+an opened pair will not be closed this way.
+
+All oxyds including pairs will close on the @samp{closeall} messages that is
+issued by @ref{st_fart} and oxyds colored @samp{OXYD_FART} on actor hits.
+
+Closed oxyds can have different looks. Their visual representation is defined
+by their @samp{flavor}. For each flavor exists an identical looking simple
+stone: @ref{st_likeoxyd_a}, @ref{st_likeoxyd_b}, @ref{st_likeoxyd_c},
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{st_likeoxyd_d}. If you like an identical looking pseudo stone that takes
+part in the oxyd shuffling you can use an oxyd of color @samp{OXYD_FAKE}.
+
+During the game oxyds can be reshuffled. Just those oxyds that are still closed
+will take part in the new shuffle process. @ref{Oxyd Shuffling Rules} will be
+still guranteed for these partial in game reshuffles. It can be initiated either
+by a @samp{shuffle} message that is send to any of the oxyd objects, or by
+usage of an oxyd of color @samp{OXYD_BOLD}. If such a special oxyd is opened,
+e.g. by an actor hit, it shuffles all remaining oxyds including itself.
+
+At initialization an oxyd that is exposed to laser light will start in state
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{CLOSED}. As it is the gaming target it is a certain exception to the
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{Snapshot Principle}.
+
+An oxyd that is swapped in or out of a laser beam will act on the light change
+with proper actions.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{CLOSED}, @code{OPEN}, @code{OXYDPAIR}; @ @ @i{default}: @code{CLOSED} @ @ @xref{state}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{flavor}, @ @ @i{values}: @code{&quot;a&quot;}, @code{&quot;b&quot;}, @code{&quot;c&quot;}, @code{&quot;d&quot;}; @ @ @i{default}: @code{&quot;b&quot;}
+The flavor only affects the visual representation of the stone. Mainly the 
+closed state and the way of opening differ in the following way:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @code{&quot;a&quot;} bronze, pyramid like stone that opens like a flower
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @code{&quot;b&quot;} black, flat stone that opens by a fade animation
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @code{&quot;c&quot;} blue, flat stone that opens by a concentric animation
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @code{&quot;d&quot;} dark blue, pyramid like stone that opens like a flower
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{color}, @ @ @i{values}: @code{OXYD_AUTO}, @code{OXYD_FAKE}, @code{OXYD_FART}, @code{OXYD_BOLD}, @code{OXYD_BLUE}, @code{OXYD_RED}, @code{OXYD_GREEN}, @code{OXYD_YELLOW}, @code{OXYD_CYAN}, @code{OXYD_PURPLE}, @code{OXYD_WHITE}, @code{OXYD_BLACK}, ; @ @ @i{default}: @code{OXYD_AUTO}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{noshuffle} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{static} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
+Static oxyds are neither swappable nor pullable.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{signal} @ @ @xref{signal}
+Try open at value @samp{1}, and close at values @samp{0}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{open} @ @ @xref{open}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{close} @ @ @xref{close}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{closeall}
+Closes all opened oxyds if send to any object instance.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{shuffle}
+Reshuffles all closed oxyds if send to any object instance.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:} @ @ @xref{target}, @ @ @xref{action}
+Values 0, 1.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_oxyd}: flavor = @code{&quot;b&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_oxyd_a}: flavor = @code{&quot;a&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_oxyd_b}: flavor = @code{&quot;b&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_oxyd_c}: flavor = @code{&quot;c&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_oxyd_d}: flavor = @code{&quot;d&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Polarswitch Stone -------------------- 
 @node st_polarswitch
 @subsection st_polarswitch
@@ -4240,12 +5152,25 @@
 @node Actor Objects
 @chapter Actor Objects
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ===================  Other Objects  =======================
+
 @node Other Objects
 @chapter Other Objects
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ===================  Advanced Features  =======================
+
 @node Advanced Features
 @chapter Advanced Features
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at menu</A> 
+* Oxyd Shuffling Rules::       
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> menu
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Oxyd Shuffling Rules
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at section</A> Oxyd Shuffling Rules
+
+Read API Concept Draft
+
 @node Old API - Objects
 @chapter Old API - Objects
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000533.html">[Enigma-game-svn] r1100 - team_levelpacks/team_test_new_api
</A></li>
	<LI>Next message: <A HREF="000535.html">[Enigma-game-svn] r1102 - in trunk: doc/reference etc
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#534">[ date ]</a>
              <a href="thread.html#534">[ thread ]</a>
              <a href="subject.html#534">[ subject ]</a>
              <a href="author.html#534">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
