<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1109 - in trunk: . data/gfx data/gfx/flags25x15	src src/gui
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2008-April/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1109%20-%20in%20trunk%3A%20.%20data/gfx%20data/gfx/flags25x15%0A%09src%20src/gui&In-Reply-To=%3C200804202114.m3KLErGG009547%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000541.html">
   <LINK REL="Next"  HREF="000543.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1109 - in trunk: . data/gfx data/gfx/flags25x15	src src/gui</H1>
    <B>andreasl at BerliOS</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1109%20-%20in%20trunk%3A%20.%20data/gfx%20data/gfx/flags25x15%0A%09src%20src/gui&In-Reply-To=%3C200804202114.m3KLErGG009547%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1109 - in trunk: . data/gfx data/gfx/flags25x15	src src/gui">andreasl at mail.berlios.de
       </A><BR>
    <I>Sun Apr 20 23:14:53 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000541.html">[Enigma-game-svn] r1108 - homepage/input
</A></li>
        <LI>Next message: <A HREF="000543.html">[Enigma-game-svn] r1110 - trunk/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#542">[ date ]</a>
              <a href="thread.html#542">[ thread ]</a>
              <a href="subject.html#542">[ subject ]</a>
              <a href="author.html#542">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: andreasl
Date: 2008-04-20 23:14:52 +0200 (Sun, 20 Apr 2008)
New Revision: 1109

Added:
   trunk/data/gfx/flags25x15/
   trunk/data/gfx/flags25x15/Makefile.am
   trunk/data/gfx/flags25x15/de.png
   trunk/data/gfx/flags25x15/es.png
   trunk/data/gfx/flags25x15/fi.png
   trunk/data/gfx/flags25x15/flags.txt
   trunk/data/gfx/flags25x15/fr.png
   trunk/data/gfx/flags25x15/gb.png
   trunk/data/gfx/flags25x15/hu.png
   trunk/data/gfx/flags25x15/it.png
   trunk/data/gfx/flags25x15/nl.png
   trunk/data/gfx/flags25x15/pt.png
   trunk/data/gfx/flags25x15/ru.png
   trunk/data/gfx/flags25x15/se.png
Modified:
   trunk/configure.ac
   trunk/data/gfx/Makefile.am
   trunk/src/gui/MainMenu.cc
   trunk/src/gui/MainMenu.hh
   trunk/src/gui/OptionsMenu.cc
   trunk/src/nls.hh
Log:
Restructuring options menu part 1:
 - Added language buttons to main menu.
Note:
 - No language buttons in main menu for 320x240,
   the button in the options menu must suffice.
 - Please feedback about the position and the
   general look-and-feel. I prepared variations
   with the buttons horizontal at the bottom
   and vertical at the right edge (see
   outcommented BuildHList/BuildVList in
   MainMenu.cc -&gt; MainMenu::build_menu()).
Todo:
 - The &quot;default language&quot;-button currently uses
   the par-symbol. Needs something else or to
   be removed completely.
 - Please add data/gfx/flags25x15-directory
   to Win/Mac-distributions where neccessary
   (or tell me how to do it/where to add it).


Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2008-04-20 19:16:52 UTC (rev 1108)
+++ trunk/configure.ac	2008-04-20 21:14:52 UTC (rev 1109)
@@ -353,6 +353,7 @@
 AC_CONFIG_FILES([Makefile m4/Makefile  intl/Makefile 
            data/Makefile
            data/gfx/Makefile
+           data/gfx/flags25x15/Makefile
            data/gfx16/Makefile
            data/gfx32/Makefile
            data/gfx40/Makefile

Modified: trunk/data/gfx/Makefile.am
===================================================================
--- trunk/data/gfx/Makefile.am	2008-04-20 19:16:52 UTC (rev 1108)
+++ trunk/data/gfx/Makefile.am	2008-04-20 21:14:52 UTC (rev 1109)
@@ -1,3 +1,6 @@
+SUBDIRS = flags25x15
+
 pkgdatadir = $(datadir)/@PACKAGE@/gfx
 pkgdata_DATA = $(wildcard $(srcdir)/*.png $(srcdir)/*.jpg)
+
 EXTRA_DIST = $(pkgdata_DATA)


Property changes on: trunk/data/gfx/flags25x15
___________________________________________________________________
Name: svn:ignore
   + Makefile
Makefile.in


Added: trunk/data/gfx/flags25x15/Makefile.am
===================================================================
--- trunk/data/gfx/flags25x15/Makefile.am	2008-04-20 19:16:52 UTC (rev 1108)
+++ trunk/data/gfx/flags25x15/Makefile.am	2008-04-20 21:14:52 UTC (rev 1109)
@@ -0,0 +1,3 @@
+pkgdatadir = $(datadir)/@PACKAGE@/flags25x15
+pkgdata_DATA = $(wildcard $(srcdir)/*.png $(srcdir)/*.jpg $(srcdir)/*.txt)
+EXTRA_DIST = $(pkgdata_DATA)

Added: trunk/data/gfx/flags25x15/de.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/de.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/es.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/es.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/fi.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/fi.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/flags.txt
===================================================================
--- trunk/data/gfx/flags25x15/flags.txt	2008-04-20 19:16:52 UTC (rev 1108)
+++ trunk/data/gfx/flags25x15/flags.txt	2008-04-20 21:14:52 UTC (rev 1109)
@@ -0,0 +1,2 @@
+Flag images found at <A HREF="http://www.hahn-hotel.com/flags/">http://www.hahn-hotel.com/flags/</A>
+&quot;All sets provided by us are free to use to anyone, for commercial or non-commercial websites.&quot;

Added: trunk/data/gfx/flags25x15/fr.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/fr.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/gb.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/gb.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/hu.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/hu.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/it.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/it.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/nl.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/nl.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/pt.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/pt.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/ru.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/ru.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx/flags25x15/se.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx/flags25x15/se.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/gui/MainMenu.cc
===================================================================
--- trunk/src/gui/MainMenu.cc	2008-04-20 19:16:52 UTC (rev 1108)
+++ trunk/src/gui/MainMenu.cc	2008-04-20 21:14:52 UTC (rev 1109)
@@ -223,6 +223,16 @@
         options     = b.add(new StaticTextButton(N_(&quot;Options&quot;), this));
         credits     = b.add(new StaticTextButton(N_(&quot;Credits&quot;), this));
         quit        = b.add(new StaticTextButton(N_(&quot;Quit&quot;), this));
+        int ly = vminfo-&gt;width - 5 - 35*NUMENTRIES(nls::languages);
+        //BuildHList l(this, Rect(ly, (vminfo-&gt;height) - 30, 30, 20), 5);
+        BuildHList l(this, Rect(ly, 10, 30, 20), 5);
+        //BuildVList l(this, Rect(vminfo-&gt;width - 45, 15, 30, 20), 5);
+        language.clear();
+        if(!vshrink)
+            for (size_t i=0; i&lt;NUMENTRIES(nls::languages); ++i)
+                language.push_back(l.add(
+                    new ImageButton(nls::languages[i].flagimage,
+                                    nls::languages[i].flagimage, this)));
     }
     
     void MainMenu::draw_background(ecl::GC &amp;gc) 
@@ -264,14 +274,11 @@
         if (w == m_startgame) {            
             LevelPackMenu m;
             m.manageLevelMenu();
-            invalidate_all();
         } else if (w == m_levelpack) {
             LevelPackMenu m;
             m.manage();
-            invalidate_all();
         } else if (w == credits) {
             displayInfo(credit_text, 6);
-            invalidate_all();
         } else if (w == options) {
             ShowOptionsMenu(0);
     
@@ -283,6 +290,12 @@
     #endif
         } else if (w == quit) {
             Menu::quit();
+        } else if (language.size() &gt; 0) {
+            for (size_t i=0; i&lt;NUMENTRIES(nls::languages); ++i)
+                if (w == language[i]) {
+                    options::SetOption (&quot;Language&quot;, nls::languages[i].localename);
+                    app.setLanguage(nls::languages[i].localename);
+                }
         } else
             return;
         invalidate_all();

Modified: trunk/src/gui/MainMenu.hh
===================================================================
--- trunk/src/gui/MainMenu.hh	2008-04-20 19:16:52 UTC (rev 1108)
+++ trunk/src/gui/MainMenu.hh	2008-04-20 21:14:52 UTC (rev 1109)
@@ -21,6 +21,8 @@
 
 #include &quot;gui/Menu.hh&quot;
 
+#include &lt;vector&gt;
+
 namespace enigma { namespace gui {
 /* -------------------- MainMenu -------------------- */
 
@@ -52,6 +54,7 @@
         Widget *credits;
         Widget *quit;
         Widget *lpack;
+        std::vector &lt;Widget*&gt; language;
     };
 
 /* -------------------- NetworkMenu -------------------- */

Modified: trunk/src/gui/OptionsMenu.cc
===================================================================
--- trunk/src/gui/OptionsMenu.cc	2008-04-20 19:16:52 UTC (rev 1108)
+++ trunk/src/gui/OptionsMenu.cc	2008-04-20 21:14:52 UTC (rev 1109)
@@ -246,34 +246,14 @@
     
     /* -------------------- LanguageButton -------------------- */
     
-    struct Language {
-        const char *name;
-        const char *localename;
-    };
-    
-    Language languages[] = {
-        { &quot;default&quot;,                &quot;&quot; },
-        { &quot;Deutsch&quot;,                &quot;de_DE&quot; },
-        { &quot;English&quot;,                &quot;en_EN&quot; },
-        { &quot;Espa&#241;ol&quot;,         &quot;es_ES&quot; },
-        { &quot;Fran&#231;ais&quot;,        &quot;fr_FR&quot; },
-        { &quot;Italiano&quot;,               &quot;it_IT&quot; },
-        { &quot;Nederlands&quot;,             &quot;nl_NL&quot; },
-        { &quot;Svenska&quot;,             &quot;sv_SE&quot; },
-        { &quot;&#1056;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;&quot;,             &quot;ru_RU&quot; },
-        { &quot;Magyar&quot;,             &quot;hu_HU&quot; },
-        { &quot;Portugu&#234;s&quot;,             &quot;pt_BR&quot; },
-        { &quot;Suomi&quot;,             &quot;fi_FI&quot; },
-    };
-    
     int LanguageButton::get_value() const
     {
         string localename; //  = ecl::DefaultMessageLocale ();
         options::GetOption (&quot;Language&quot;, localename);
     
         int lang = 0;                  // unknown language
-        for (size_t i=0; i&lt;NUMENTRIES(languages); ++i) {
-            if (localename == languages[i].localename)
+        for (size_t i=0; i&lt;NUMENTRIES(nls::languages); ++i) {
+            if (localename == nls::languages[i].localename)
                 lang = int(i);
         }
         return lang;
@@ -281,11 +261,11 @@
     
     void LanguageButton::set_value(int value)
     {
-        options::SetOption (&quot;Language&quot;, languages[value].localename);
+        options::SetOption (&quot;Language&quot;, nls::languages[value].localename);
         
-        if ( not inInit) {
+        if (not inInit) {
             // change language only on user action
-            app.setLanguage(languages[value].localename);
+            app.setLanguage(nls::languages[value].localename);
             myListener-&gt;on_action(this);
         }
     }
@@ -295,11 +275,11 @@
         if (value == -1)
             return _(&quot;unknown&quot;);
         else
-            return languages[value].name;
+            return nls::languages[value].name;
     }
     
     LanguageButton::LanguageButton (ActionListener *al)
-    : ValueButton(0, NUMENTRIES(languages)-1), myListener(al)
+    : ValueButton(0, NUMENTRIES(nls::languages)-1), myListener(al)
     {
         inInit = true;
         init();

Modified: trunk/src/nls.hh
===================================================================
--- trunk/src/nls.hh	2008-04-20 19:16:52 UTC (rev 1108)
+++ trunk/src/nls.hh	2008-04-20 21:14:52 UTC (rev 1109)
@@ -17,6 +17,27 @@
 namespace nls
 {
     void SetMessageLocale (const std::string &amp;language);
+
+    struct Language {
+        const char *name;
+        const char *localename;
+        const char *flagimage;
+    };
+    
+    const Language languages[] = {
+        { &quot;default&quot;,    &quot;&quot;,      &quot;par&quot; },
+        { &quot;Deutsch&quot;,    &quot;de_DE&quot;, &quot;flags25x15/de&quot; },
+        { &quot;English&quot;,    &quot;en_EN&quot;, &quot;flags25x15/gb&quot; },
+        { &quot;Espa&#241;ol&quot;,    &quot;es_ES&quot;, &quot;flags25x15/es&quot; },
+        { &quot;Fran&#231;ais&quot;,   &quot;fr_FR&quot;, &quot;flags25x15/fr&quot; },
+        { &quot;Italiano&quot;,   &quot;it_IT&quot;, &quot;flags25x15/it&quot; },
+        { &quot;Nederlands&quot;, &quot;nl_NL&quot;, &quot;flags25x15/nl&quot; },
+        { &quot;Svenska&quot;,    &quot;sv_SE&quot;, &quot;flags25x15/se&quot; },
+        { &quot;&#1056;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;&quot;,    &quot;ru_RU&quot;, &quot;flags25x15/ru&quot; },
+        { &quot;Magyar&quot;,     &quot;hu_HU&quot;, &quot;flags25x15/hu&quot; },
+        { &quot;Portugu&#234;s&quot;,  &quot;pt_BR&quot;, &quot;flags25x15/pt&quot; },
+        { &quot;Suomi&quot;,      &quot;fi_FI&quot;, &quot;flags25x15/fi&quot; },
+    };
 }
 
 #endif


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000541.html">[Enigma-game-svn] r1108 - homepage/input
</A></li>
	<LI>Next message: <A HREF="000543.html">[Enigma-game-svn] r1110 - trunk/src
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#542">[ date ]</a>
              <a href="thread.html#542">[ thread ]</a>
              <a href="subject.html#542">[ subject ]</a>
              <a href="author.html#542">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
