<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1195 - trunk/src
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2008-June/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1195%20-%20trunk/src&In-Reply-To=%3C200806252211.m5PMBdZT021362%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000628.html">
   <LINK REL="Next"  HREF="000630.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1195 - trunk/src</H1>
    <B>andreasl at mail.berlios.de</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1195%20-%20trunk/src&In-Reply-To=%3C200806252211.m5PMBdZT021362%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1195 - trunk/src">andreasl at mail.berlios.de
       </A><BR>
    <I>Thu Jun 26 00:11:39 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000628.html">[Enigma-game-svn] r1194 - in trunk/src: . stones
</A></li>
        <LI>Next message: <A HREF="000630.html">[Enigma-game-svn] Revision 1196
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#629">[ date ]</a>
              <a href="thread.html#629">[ thread ]</a>
              <a href="subject.html#629">[ subject ]</a>
              <a href="author.html#629">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: andreasl
Date: 2008-06-26 00:11:35 +0200 (Thu, 26 Jun 2008)
New Revision: 1195

Modified:
   trunk/src/MusicManager.cc
   trunk/src/MusicManager.hh
   trunk/src/SoundEffectManager.cc
   trunk/src/SoundEffectManager.hh
   trunk/src/SoundEngine.cc
   trunk/src/SoundEngine.hh
Log:
Trunk:
 - Removing &quot;using namespace std&quot; and &quot;... OxydLib&quot;
   from SoundEngine, SoundEffectManager and MusicManager,
   qualifying namespaces.


Modified: trunk/src/MusicManager.cc
===================================================================
--- trunk/src/MusicManager.cc	2008-06-25 20:44:48 UTC (rev 1194)
+++ trunk/src/MusicManager.cc	2008-06-25 22:11:35 UTC (rev 1195)
@@ -29,7 +29,6 @@
 #include &lt;string&gt;
 #include &lt;cassert&gt;
 
-using namespace std;
 using namespace enigma;
 using namespace sound;
 
@@ -72,7 +71,7 @@
     MusicManager::instance()-&gt;init();
 }
 
-void sound::DefineMusicSingle(string title, string filename) {
+void sound::DefineMusicSingle(std::string title, std::string filename) {
     // TODO: include play_till, replay_from, volume etc
     if(filename == &quot;&quot;) {
         Log &lt;&lt; &quot;Warning: Tried to define music single '&quot; &lt;&lt; title
@@ -93,7 +92,7 @@
 
 int sound::GetOptionMenuMusic()
 {
-    string music_queue = app.state-&gt;getString(&quot;MenuMusicQueue&quot;);
+    std::string music_queue = app.state-&gt;getString(&quot;MenuMusicQueue&quot;);
     int pos = MusicManager::instance()-&gt;getMusicQueueButtonPosition(music_queue);
     assert(pos &gt;= 0);
     return pos;
@@ -101,12 +100,12 @@
 
 void sound::SetOptionMenuMusic(int value)
 {
-    string music_queue = MusicManager::instance()-&gt;getMusicQueueByPosition(value);
+    std::string music_queue = MusicManager::instance()-&gt;getMusicQueueByPosition(value);
     app.state-&gt;setProperty(&quot;MenuMusicQueue&quot;, music_queue);
     MusicManager::instance()-&gt;setActiveMusicQueue(music_queue);
 }
 
-string sound::GetOptionMenuMusicText(int value)
+std::string sound::GetOptionMenuMusicText(int value)
 {
     return MusicManager::instance()-&gt;getMusicQueueByPosition(value);
 }
@@ -185,19 +184,19 @@
     tick(-1);
 }
 
-bool MusicManager::defineMusicSingle(string title, string filename)
+bool MusicManager::defineMusicSingle(std::string title, std::string filename)
 {
     music_singles[title] = MusicSingle(title, filename);
     Log &lt;&lt; &quot;Added music single '&quot; &lt;&lt; title &lt;&lt; &quot;'.\n&quot;;
     return true;
 }
 
-bool MusicManager::playMusicSingle(string title)
+bool MusicManager::playMusicSingle(std::string title)
 {
     return music_singles[title].start();
 }
 
-bool MusicManager::setActiveMusicQueue(string music_queue_title)
+bool MusicManager::setActiveMusicQueue(std::string music_queue_title)
 {
     if (music_queue_title == &quot;&quot;) {
         Log &lt;&lt; &quot;Warning: Tried to choose empty music queue title as menu music queue.\n&quot;;
@@ -223,7 +222,7 @@
     }
 }
 
-string MusicManager::getMusicQueueByPosition(int button_position)
+std::string MusicManager::getMusicQueueByPosition(int button_position)
 {
     for (MusicQueueRepository::iterator i = music_queues.begin();
              i != music_queues.end(); ++i)
@@ -242,7 +241,7 @@
     return count;
 }
 
-string MusicManager::getCurrentMusicTitle() {
+std::string MusicManager::getCurrentMusicTitle() {
     if(sound::IsMusicPlaying() &amp;&amp; (active_music_queue != &quot;&quot;))
         return music_queues[active_music_queue].getCurrentMusicTitle();
     else
@@ -285,7 +284,7 @@
 
 /* -------------------- Music Queue -------------------- */
 
-string MusicQueue::getCurrentMusicTitle()
+std::string MusicQueue::getCurrentMusicTitle()
 {
     if(current_position_in_queue == -1)
         return &quot;&quot;;
@@ -293,7 +292,7 @@
         return single_title[current_position_in_queue];
 }
 
-void MusicQueue::appendSingle(string title)
+void MusicQueue::appendSingle(std::string title)
 {
     single_title.push_back(title);
 }
@@ -317,7 +316,7 @@
         current_position_in_queue++;
         if(current_position_in_queue &gt;= single_title.size())
             current_position_in_queue = 0;
-        string single = single_title[current_position_in_queue];
+        std::string single = single_title[current_position_in_queue];
         Log &lt;&lt; &quot;Play next in queue &quot; &lt;&lt; title &lt;&lt; &quot;: &quot; &lt;&lt; single &lt;&lt; &quot;.\n&quot;;
         return MusicManager::instance()-&gt;playMusicSingle(single);
     }

Modified: trunk/src/MusicManager.hh
===================================================================
--- trunk/src/MusicManager.hh	2008-06-25 20:44:48 UTC (rev 1194)
+++ trunk/src/MusicManager.hh	2008-06-25 22:11:35 UTC (rev 1195)
@@ -26,14 +26,12 @@
 #include &lt;vector&gt;
 #include &lt;map&gt;
 
-using namespace std;
-
 namespace sound
 {
 
 /* -------------------- Interface Functions -------------------- */
 
-    void DefineMusicSingle(string title, string filename);
+    void DefineMusicSingle(std::string title, std::string filename);
 
     bool StartMenuMusic();
     bool StartLevelMusic();
@@ -45,7 +43,7 @@
     int GetOptionMenuMusicCount();
     int GetOptionMenuMusic();
     void SetOptionMenuMusic(int value);
-    string GetOptionMenuMusicText(int value);
+    std::string GetOptionMenuMusicText(int value);
 
 /* -------------------- Music and MusicQueue -------------------- */
 
@@ -57,13 +55,13 @@
 
     class MusicSingle {
     public:
-        MusicSingle(string title_, string filename_, Uint32 length_,
+        MusicSingle(std::string title_, std::string filename_, Uint32 length_,
                     Uint32 loop_start_, Uint32 loop_end_, bool allows_loop_)
         : title(title_), filename(filename_), length(length_),
           loop_start(loop_start_), loop_end(loop_end_),
           allows_loop(allows_loop_), start_time() {}
 
-        MusicSingle(string title_, string filename_)
+        MusicSingle(std::string title_, std::string filename_)
         : title(title_), filename(filename_), length(0),
           loop_start(0), loop_end(0), allows_loop(false), start_time() {}
 
@@ -75,8 +73,8 @@
         bool maybeLoopBack();
 
     private:
-        string title;
-        string filename;
+        std::string title;
+        std::string filename;
         Uint32 length;      // in milliseconds
         Uint32 loop_start;  // where the loop starts
         Uint32 loop_end;    // where the loop should end (but continues playing until next tick)
@@ -86,7 +84,7 @@
 
     class MusicQueue {
     public:
-        MusicQueue(string title_, int button_position_)
+        MusicQueue(std::string title_, int button_position_)
         : title(title_), button_position(button_position_),
           current_position_in_queue(-1), single_title() {}
 
@@ -97,20 +95,20 @@
         bool start();
         bool next();
         void leave();
-        string getCurrentMusicTitle();
+        std::string getCurrentMusicTitle();
         int getButtonPosition() { return button_position; }
         void setButtonPosition(int pos) { button_position = pos; }
-        void appendSingle(string title);
+        void appendSingle(std::string title);
 
     private:
         int current_position_in_queue;
-        string title;
+        std::string title;
         int button_position;
-        vector&lt;string&gt; single_title;
+        std::vector&lt;std::string&gt; single_title;
     };
 
-    typedef map&lt;string, MusicSingle&gt; MusicSingleRepository;
-    typedef map&lt;string, MusicQueue&gt; MusicQueueRepository;
+    typedef std::map&lt;std::string, MusicSingle&gt; MusicSingleRepository;
+    typedef std::map&lt;std::string, MusicQueue&gt; MusicQueueRepository;
 
     /*! MusicContext is a nominal condition to change the
       music during the next tick.
@@ -133,15 +131,15 @@
         void setMusicContext(MusicContext context) { music_context = context; }
         MusicContext getMusicContext() { return music_context; }
 
-        bool defineMusicSingle(string title, string filename);
-        bool playMusicSingle(string title);
-        string getCurrentMusicTitle();
+        bool defineMusicSingle(std::string title, std::string filename);
+        bool playMusicSingle(std::string title);
+        std::string getCurrentMusicTitle();
                 
-        bool setActiveMusicQueue(string music_queue_title);
-        string getActiveMusicQueueTitle() { return active_music_queue; }
-        string getMusicQueueByPosition(int button_position);
+        bool setActiveMusicQueue(std::string music_queue_title);
+        std::string getActiveMusicQueueTitle() { return active_music_queue; }
+        std::string getMusicQueueByPosition(int button_position);
         int getMenuMusicQueueCount();
-        int getMusicQueueButtonPosition(string music_queue_title) {
+        int getMusicQueueButtonPosition(std::string music_queue_title) {
             return music_queues[music_queue_title].getButtonPosition();
         }
 
@@ -152,7 +150,7 @@
         static MusicManager *theSingleton;
         MusicSingleRepository    music_singles;
         MusicQueueRepository     music_queues;
-        string                   active_music_queue;
+        std::string              active_music_queue;
         MusicContext             music_context;
     };
     

Modified: trunk/src/SoundEffectManager.cc
===================================================================
--- trunk/src/SoundEffectManager.cc	2008-06-25 20:44:48 UTC (rev 1194)
+++ trunk/src/SoundEffectManager.cc	2008-06-25 22:11:35 UTC (rev 1195)
@@ -30,15 +30,13 @@
 #include &lt;cassert&gt;
 #include &lt;memory&gt;
 
-using namespace std;
 using namespace enigma;
 using namespace sound;
-using namespace OxydLib;
 
 
 /* -------------------- Interface Functions -------------------- */
 
-string sound::GetOxydSoundSet(OxydVersion oxyd_ver)
+std::string sound::GetOxydSoundSet(OxydLib::OxydVersion oxyd_ver)
 {
     return SoundEffectManager::instance()-&gt;getOxydSoundSet(oxyd_ver);
 }
@@ -47,12 +45,12 @@
     SoundEffectManager::instance()-&gt;initSoundSets();
 }
 
-void sound::SetActiveSoundSet(string soundset_name)
+void sound::SetActiveSoundSet(std::string soundset_name)
 {
     SoundEffectManager::instance()-&gt;setActiveSoundSet(soundset_name);
 }
 
-void sound::SetDefaultSoundSet(string soundset_name)
+void sound::SetDefaultSoundSet(std::string soundset_name)
 {
     SoundEffectManager::instance()-&gt;setDefaultSoundSet(soundset_name);
     if(app.state-&gt;getString(&quot;SoundSetName&quot;) == &quot;Default&quot;)
@@ -61,10 +59,10 @@
 
 /*! The following function is an interface to add sound events to Enigma.
   It is accessed via sound-defaults.lua and user sound definitions. */
-void sound::DefineSoundEffect(string soundset_key, string name, string filename,
+void sound::DefineSoundEffect(std::string soundset_key, std::string name, std::string filename,
                               double volume, bool loop, bool global, int priority,
                               double damp_max, double damp_inc, double damp_mult,
-                              double damp_min, double damp_tick, string silence_string) {
+                              double damp_min, double damp_tick, std::string silence_string) {
     if(soundset_key == &quot;&quot;) {
         Log &lt;&lt; &quot;Warning: Tried to define sound event '&quot; &lt;&lt; name
             &lt;&lt; &quot;' without sound set key. Skipped.\n&quot;;
@@ -76,18 +74,18 @@
 }
 
 
-bool sound::EmitSoundEvent (const string &amp;eventname, const ecl::V2 &amp;pos,
+bool sound::EmitSoundEvent (const std::string &amp;eventname, const ecl::V2 &amp;pos,
                             double volume, bool force_global)
 {
     return SoundEffectManager::instance()-&gt;emitSoundEvent(eventname, pos, volume, force_global);
 }
 
-bool sound::EmitSoundEventGlobal (const string &amp;eventname, double volume)
+bool sound::EmitSoundEventGlobal (const std::string &amp;eventname, double volume)
 {
     return SoundEffectManager::instance()-&gt;emitSoundEvent(eventname, ecl::V2(), volume, true);
 }
 
-void sound::WriteSilenceString (const string &amp;eventname)
+void sound::WriteSilenceString (const std::string &amp;eventname)
 {
     SoundEffectManager::instance()-&gt;writeSilenceString(eventname);
 }
@@ -104,7 +102,7 @@
 
 int sound::GetOptionSoundSet()
 {
-    string soundSet = app.state-&gt;getString(&quot;SoundSetName&quot;);
+    std::string soundSet = app.state-&gt;getString(&quot;SoundSetName&quot;);
     if (soundSet == &quot;Default&quot;)
         return 0;
     int pos = SoundEffectManager::instance()-&gt;getSoundSetButtonPosition(soundSet);
@@ -122,7 +120,7 @@
         options::SetOption(&quot;SoundSet&quot;, SoundEffectManager::instance()-&gt;convertToOldSoundSetNumber(&quot;Default&quot;));
         SetActiveSoundSet(SoundEffectManager::instance()-&gt;getDefaultSoundSet());
     } else {
-        string newSet = SoundEffectManager::instance()-&gt;getSoundSetByPosition(value);
+        std::string newSet = SoundEffectManager::instance()-&gt;getSoundSetByPosition(value);
         assert(newSet != &quot;&quot;);
         if (app.state-&gt;getString(&quot;SoundSetName&quot;) == newSet)
             return;
@@ -132,11 +130,11 @@
     }
 }
 
-string sound::GetOptionSoundSetText(int value)
+std::string sound::GetOptionSoundSetText(int value)
 {
     if(value == 0)
         return N_(&quot;Default&quot;);
-    string soundset_name = SoundEffectManager::instance()-&gt;getSoundSetByPosition(value);
+    std::string soundset_name = SoundEffectManager::instance()-&gt;getSoundSetByPosition(value);
     if(soundset_name == &quot;&quot;)
         return &quot;INVALID&quot;;
     return soundset_name;
@@ -152,7 +150,7 @@
 {}
 
 double SoundEvent::effectiveVolume(double dist) {
-    double reduced_dist = max(0.0, dist - fullvol_range);
+    double reduced_dist = std::max(0.0, dist - fullvol_range);
     return (1 - reduced_dist / range) * volume;
 }
 
@@ -166,7 +164,7 @@
            old center regions, and its volume is set to the maximum
            of the two volumes. */
         double dist = ecl::length(position - se.position);
-        volume = max(volume, se.volume);
+        volume = std::max(volume, se.volume);
         fullvol_range += dist/2;
         position = (number_events * position + se.number_events * se.position)
                        / (number_events + se.number_events);
@@ -199,7 +197,7 @@
 /*! This function defines how to put soundset_key and eventname together to
   create an eventkey. */
 
-string SoundEffectManager::effectKey(string effect_name, string soundset_name)
+std::string SoundEffectManager::effectKey(std::string effect_name, std::string soundset_name)
 {
     if (soundset_name == &quot;&quot;)
         return getActiveSoundSetKey() + &quot;#&quot; + effect_name;
@@ -210,7 +208,7 @@
 /*! This function searches the known sound sets for a sound set with given
   oxyd version, and returns the sound set name (or empty string if none). */
 
-string SoundEffectManager::getOxydSoundSet(OxydVersion oxyd_ver)
+std::string SoundEffectManager::getOxydSoundSet(OxydLib::OxydVersion oxyd_ver)
 {
     for (SoundSetRepository::iterator i = sound_sets.begin();
              i != sound_sets.end(); ++i)
@@ -225,7 +223,7 @@
   if user wants to switch to &lt;= 1.00 again; so here are the conversion
   functions. Any user sound set is mapped to 0 (&quot;Default&quot;).  */
 
-int SoundEffectManager::convertToOldSoundSetNumber(string soundset_name)
+int SoundEffectManager::convertToOldSoundSetNumber(std::string soundset_name)
 {
     if(soundset_name == &quot;Default&quot;)  return 0;
     if(soundset_name == &quot;Enigma&quot;)   return 1;
@@ -235,11 +233,11 @@
     return 0;
 }
 
-string SoundEffectManager::convertFromOldSoundSetNumber(int soundset_number)
+std::string SoundEffectManager::convertFromOldSoundSetNumber(int soundset_number)
 {
     if(soundset_number == 0)  return &quot;Default&quot;;
     if(soundset_number == 1)  return &quot;Enigma&quot;;
-    return getOxydSoundSet((OxydVersion) (soundset_number - 2));
+    return getOxydSoundSet((OxydLib::OxydVersion) (soundset_number - 2));
 }
 
 /* -------------------- Sound set handling -------------------- */
@@ -249,7 +247,7 @@
   oxyd sound set is mentioned, but the corresponding oxyd version
   wasn't found. */
 
-bool SoundEffectManager::defineSoundSet(string soundset_name, string soundset_key,
+bool SoundEffectManager::defineSoundSet(std::string soundset_name, std::string soundset_key,
                                  int button_position)
 {
     sound_sets[soundset_name] = SoundSet(soundset_key, button_position);
@@ -258,12 +256,12 @@
     return true;
 }
 
-bool SoundEffectManager::defineSoundSetOxyd(string soundset_name, string soundset_key,
-                                     OxydVersion oxyd_ver, int button_position)
+bool SoundEffectManager::defineSoundSetOxyd(std::string soundset_name, std::string soundset_key,
+                                     OxydLib::OxydVersion oxyd_ver, int button_position)
 {
     if(oxyd::FoundOxyd(oxyd_ver)) {
         sound_sets[soundset_name] =
-            SoundSet(soundset_key, button_position, (OxydVersion) oxyd_ver);
+            SoundSet(soundset_key, button_position, (OxydLib::OxydVersion) oxyd_ver);
         Log &lt;&lt; &quot;Added sound set '&quot; &lt;&lt; soundset_name &lt;&lt; &quot;' (key '&quot; &lt;&lt; soundset_key
             &lt;&lt; &quot;') on position &quot; &lt;&lt; button_position &lt;&lt; &quot;.\n&quot;;
         return true;
@@ -291,15 +289,15 @@
     assert(sound_sets.empty());
     assert(defineSoundSet (&quot;Enigma&quot;,   &quot;Enigma&quot;,  1));
     int pos = 2; // position in options menu button
-    if (defineSoundSetOxyd (&quot;Oxyd&quot;,     &quot;Oxyd*&quot;,   OxydVersion_Oxyd1,          pos))  pos++;
-    if (defineSoundSetOxyd (&quot;Magnum&quot;,   &quot;Magnum*&quot;, OxydVersion_OxydMagnum,     pos))  pos++;
-    if (defineSoundSetOxyd (&quot;Mag.Gold&quot;, &quot;Magnum*&quot;, OxydVersion_OxydMagnumGold, pos))  pos++;
-    if (defineSoundSetOxyd (&quot;Per.Oxyd&quot;, &quot;Oxyd*&quot;,   OxydVersion_PerOxyd,        pos))  pos++;
-    if (defineSoundSetOxyd (&quot;Extra&quot;,    &quot;Oxyd*&quot;,   OxydVersion_OxydExtra,      pos))  pos++;
+    if (defineSoundSetOxyd (&quot;Oxyd&quot;,     &quot;Oxyd*&quot;,   OxydLib::OxydVersion_Oxyd1,          pos))  pos++;
+    if (defineSoundSetOxyd (&quot;Magnum&quot;,   &quot;Magnum*&quot;, OxydLib::OxydVersion_OxydMagnum,     pos))  pos++;
+    if (defineSoundSetOxyd (&quot;Mag.Gold&quot;, &quot;Magnum*&quot;, OxydLib::OxydVersion_OxydMagnumGold, pos))  pos++;
+    if (defineSoundSetOxyd (&quot;Per.Oxyd&quot;, &quot;Oxyd*&quot;,   OxydLib::OxydVersion_PerOxyd,        pos))  pos++;
+    if (defineSoundSetOxyd (&quot;Extra&quot;,    &quot;Oxyd*&quot;,   OxydLib::OxydVersion_OxydExtra,      pos))  pos++;
     // Define user sound sets, as given by sound_effects
     for (SoundEffectRepository::iterator i = sound_effects.begin();
          i != sound_effects.end(); ++i) {
-        string soundset_key = (*i).second.getSoundSetKey();
+        std::string soundset_key = (*i).second.getSoundSetKey();
         bool found = false;
         // ignore Oxyd* and Magnum* sound effects, if no 
         if ((soundset_key != &quot;Oxyd*&quot;) &amp;&amp; (soundset_key != &quot;Magnum*&quot;)) {
@@ -315,7 +313,7 @@
     setSoundSetCount(pos - 1);
     setDefaultSoundSet(&quot;Enigma&quot;);
     // Extract sound set names and keys from options; activate!
-    string soundset_name = app.state-&gt;getString(&quot;SoundSetName&quot;);
+    std::string soundset_name = app.state-&gt;getString(&quot;SoundSetName&quot;);
     if (soundset_name == &quot;&quot;) { // just switched from 1.00 to higher
         soundset_name = convertFromOldSoundSetNumber(options::GetInt(&quot;SoundSet&quot;));
         app.state-&gt;setProperty(&quot;SoundSetName&quot;, soundset_name);
@@ -340,9 +338,9 @@
     }
 }
 
-void SoundEffectManager::setActiveSoundSet(string soundset_name)
+void SoundEffectManager::setActiveSoundSet(std::string soundset_name)
 {
-    string soundset_key = sound_sets[soundset_name].getSoundSetKey();
+    std::string soundset_key = sound_sets[soundset_name].getSoundSetKey();
     if (soundset_key == getActiveSoundSetKey())
         return;
     if (soundset_key == &quot;Default&quot;) {
@@ -369,14 +367,14 @@
 {
     SoundEffectRepository::iterator i = sound_effects.begin(), 
         end = sound_effects.end();
-    string prefix = getActiveSoundSetKey() + &quot;#&quot;;
+    std::string prefix = getActiveSoundSetKey() + &quot;#&quot;;
     for (; i != end; ++i) {
         if (i-&gt;first.compare(0, prefix.size(), prefix) == 0)
             CacheSound(i-&gt;second);
     }
 }
 
-string SoundEffectManager::getSoundSetByPosition(int button_position)
+std::string SoundEffectManager::getSoundSetByPosition(int button_position)
 {
     for (SoundSetRepository::iterator i = sound_sets.begin();
              i != sound_sets.end(); ++i)
@@ -405,12 +403,12 @@
         return PlaySound (filename, pos, volume * vol, priority);
 }
 
-bool SoundEffectManager::emitSoundEvent (const string &amp;eventname, const ecl::V2 &amp;pos,
+bool SoundEffectManager::emitSoundEvent (const std::string &amp;eventname, const ecl::V2 &amp;pos,
                             double volume, bool force_global)
 {
     if((volume == 0) || sound::IsSoundMute())
         return false;
-    string effectkey = effectKey(eventname);
+    std::string effectkey = effectKey(eventname);
     SoundEffectRepository::iterator i = sound_effects.find(effectkey);
     if (i == sound_effects.end()) {
         Log &lt;&lt; &quot;Undefined sound event &quot; &lt;&lt; effectkey &lt;&lt; &quot; @ &quot; 
@@ -421,12 +419,12 @@
     }
 }
 
-void SoundEffectManager::writeSilenceString (const string &amp;eventname)
+void SoundEffectManager::writeSilenceString (const std::string &amp;eventname)
 {
-    string effectkey = effectKey(eventname);
+    std::string effectkey = effectKey(eventname);
     SoundEffectRepository::iterator i = sound_effects.find(effectkey);
     if (i != sound_effects.end()) {
-        string silence_string = (*i).second.getSilenceString();
+        std::string silence_string = (*i).second.getSilenceString();
         if (silence_string != &quot;&quot;)
             client::Msg_ShowText (silence_string, true);
     }
@@ -437,7 +435,7 @@
 /*! These methods are connected to the sound damping mechanism, designed
   to reduce the noise created by some objects like st_lightpassenger. */
 
-SoundDamping::SoundDamping(string effect_name_, const void *origin_)
+SoundDamping::SoundDamping(std::string effect_name_, const void *origin_)
 : effect_name(effect_name_), origin(origin_)
 {
     damp = SoundEffectManager::instance()-&gt;getDampingData(effect_name_);

Modified: trunk/src/SoundEffectManager.hh
===================================================================
--- trunk/src/SoundEffectManager.hh	2008-06-25 20:44:48 UTC (rev 1194)
+++ trunk/src/SoundEffectManager.hh	2008-06-25 22:11:35 UTC (rev 1195)
@@ -27,8 +27,6 @@
 #include &lt;vector&gt;
 #include &lt;map&gt;
 
-using namespace std;
-
 /** ----------- Survey of the formal data structure -----------
  *
  *  The wav-files are not to be accessed directly. There are several layers
@@ -136,9 +134,9 @@
 {
 /* -------------------- Data types -------------------- */
 
-    typedef string SoundName;
+    typedef std::string SoundName;
 
-    typedef vector &lt;unsigned char&gt; ByteVec;
+    typedef std::vector &lt;unsigned char&gt; ByteVec;
 
     struct SoundData {
         ByteVec  buf;
@@ -153,33 +151,33 @@
     void DefineSound (const SoundName &amp;, const SoundData &amp;);
     
     /*! Helper function for oxyd.cc */
-    string GetOxydSoundSet(OxydLib::OxydVersion oxyd_ver);
+    std::string GetOxydSoundSet(OxydLib::OxydVersion oxyd_ver);
 
     /*! Sound set handling */
     void InitSoundSets();
-    void SetActiveSoundSet(string soundset_name);
-    void SetDefaultSoundSet(string soundset_name);
+    void SetActiveSoundSet(std::string soundset_name);
+    void SetDefaultSoundSet(std::string soundset_name);
 
     /*! Define a new sound event. */
-    void DefineSoundEffect(string soundset_key, string name, string filename,
+    void DefineSoundEffect(std::string soundset_key, std::string name, std::string filename,
                            double volume, bool loop, bool global, int priority,
                            double damp_max, double damp_inc, double damp_mult,
-                           double damp_min, double damp_tick, string silence_string);
+                           double damp_min, double damp_tick, std::string silence_string);
 
     /*! Trigger a sound event.  Return whether the event was handled. */
-    bool EmitSoundEvent (const string &amp;eventname,
+    bool EmitSoundEvent (const std::string &amp;eventname,
                          const ecl::V2 &amp;pos = ecl::V2 (), 
                          double volume = 1.0, bool force_global = false);
-    bool EmitSoundEventGlobal (const string &amp;eventname, double volume = 1.0);
+    bool EmitSoundEventGlobal (const std::string &amp;eventname, double volume = 1.0);
 
     /*! Send the silence string of a sound effect to command line. */
-    void WriteSilenceString (const string &amp;eventname);
+    void WriteSilenceString (const std::string &amp;eventname);
 
     /*! Helper functions for options menu */
     int GetOptionSoundSetCount();
     int GetOptionSoundSet();
     void SetOptionSoundSet(int value);
-    string GetOptionSoundSetText(int value);
+    std::string GetOptionSoundSetText(int value);
 
 /* -------------------- SoundDampingList ---------------- */
 
@@ -196,14 +194,14 @@
 
     class SoundDamping {
     private:
-        string effect_name;
+        std::string effect_name;
         const void *origin;
         float factor;
         DampingData damp;
 
     public:
-        SoundDamping(string effect_name_, const void *origin_);
-        bool is_equal(string name2, const void *origin2) {
+        SoundDamping(std::string effect_name_, const void *origin_);
+        bool is_equal(std::string name2, const void *origin2) {
             return (origin2 == origin) &amp;&amp; (effect_name == name2);
         }
         float get_volume(float def_volume);
@@ -246,10 +244,10 @@
 
     class SoundEffect {
     public:
-        SoundEffect(string name_, string soundset_key_, string filename_,
+        SoundEffect(std::string name_, std::string soundset_key_, std::string filename_,
                        double volume_, bool loop_, bool global_, int priority_,
                        double damp_max_, double damp_inc_, double damp_mult_,
-                       double damp_min_, double damp_tick_, string silence_string_)
+                       double damp_min_, double damp_tick_, std::string silence_string_)
         : name(name_), soundset_key(soundset_key_), filename(filename_), volume(volume_),
           loop(loop_), global(global_), priority(priority_),
           silence_string(silence_string_) {
@@ -270,18 +268,18 @@
             damp.tick =  0.9;
         }
 
-        void setFilename(string filename_) { filename = filename_; }
-        string getFilename() const { return filename; }
+        void setFilename(std::string filename_) { filename = filename_; }
+        std::string getFilename() const { return filename; }
         bool play(const ecl::V2 &amp;pos = ecl::V2(), double vol = 1.0, bool glob = false);
         DampingData getDampingData() { return damp; }
-        string getSoundSetKey() { return soundset_key; }
-        string getSilenceString() { return silence_string; }
+        std::string getSoundSetKey() { return soundset_key; }
+        std::string getSilenceString() { return silence_string; }
 
     private:
-        string name;
-        string filename;
-        string soundset_key;
-        string silence_string;
+        std::string name;
+        std::string filename;
+        std::string soundset_key;
+        std::string silence_string;
         double volume;
         bool loop;
         bool global;
@@ -291,11 +289,11 @@
 
     class SoundSet {
     public:
-        SoundSet(string soundset_key_, int button_position_, OxydLib::OxydVersion oxyd_ver_)
+        SoundSet(std::string soundset_key_, int button_position_, OxydLib::OxydVersion oxyd_ver_)
         : soundset_key(soundset_key_), is_oxyd(true), oxyd_ver(oxyd_ver_),
           button_position(button_position_) {}
 
-        SoundSet(string soundset_key_, int button_position_)
+        SoundSet(std::string soundset_key_, int button_position_)
         : soundset_key(soundset_key_), is_oxyd(false),
           oxyd_ver(OxydLib::OxydVersion_Invalid), button_position(button_position_) {}
 
@@ -306,19 +304,19 @@
         bool activate();
         OxydLib::OxydVersion getOxydVersion() { return oxyd_ver; }
         bool isOxyd() { return is_oxyd; }
-        string getSoundSetKey() { return soundset_key; }
+        std::string getSoundSetKey() { return soundset_key; }
         int getButtonPosition() { return button_position; }
         void setButtonPosition(int pos) { button_position = pos; }
 
     private:
-        string soundset_key;
+        std::string soundset_key;
         bool is_oxyd;
         OxydLib::OxydVersion oxyd_ver;
         int button_position;
     };
     
-    typedef map&lt;string, SoundEffect&gt; SoundEffectRepository;
-    typedef map&lt;string, SoundSet&gt; SoundSetRepository;
+    typedef std::map&lt;std::string, SoundEffect&gt; SoundEffectRepository;
+    typedef std::map&lt;std::string, SoundSet&gt; SoundSetRepository;
 
 
 /* -------------------- SoundEffectManager -------------------- */
@@ -330,38 +328,38 @@
 
         // ---------- Sound effect repository and sound sets ----------
 
-        void setActiveSoundSetKey(string soundset_key) {active_sound_set_key=soundset_key;}
-        string getActiveSoundSetKey() { return active_sound_set_key; }
-        void setDefaultSoundSet(string soundset_name) {default_sound_set=soundset_name;}
-        string getDefaultSoundSet() { return default_sound_set; }
-        string effectKey(string effect_name, string soundset_name = &quot;&quot;);
-        DampingData getDampingData(string effect_name) {
+        void setActiveSoundSetKey(std::string soundset_key) {active_sound_set_key=soundset_key;}
+        std::string getActiveSoundSetKey() { return active_sound_set_key; }
+        void setDefaultSoundSet(std::string soundset_name) {default_sound_set=soundset_name;}
+        std::string getDefaultSoundSet() { return default_sound_set; }
+        std::string effectKey(std::string effect_name, std::string soundset_name = &quot;&quot;);
+        DampingData getDampingData(std::string effect_name) {
             return sound_effects[effectKey(effect_name)].getDampingData(); }
-        void defineSoundEffect(string soundset_key, string name, SoundEffect se) {
+        void defineSoundEffect(std::string soundset_key, std::string name, SoundEffect se) {
             sound_effects[effectKey(name, soundset_key)] = se;
         }
-        bool emitSoundEvent (const string &amp;eventname, const ecl::V2 &amp;pos = ecl::V2 (), 
+        bool emitSoundEvent (const std::string &amp;eventname, const ecl::V2 &amp;pos = ecl::V2 (), 
                              double volume = 1.0, bool force_global = false);
-        void writeSilenceString (const string &amp;eventname);
+        void writeSilenceString (const std::string &amp;eventname);
         void initSoundSets();
-        bool defineSoundSet(string soundset_name, string soundset_key, int button_position);
-        bool defineSoundSetOxyd(string soundset_name, string soundset_key,
+        bool defineSoundSet(std::string soundset_name, std::string soundset_key, int button_position);
+        bool defineSoundSetOxyd(std::string soundset_name, std::string soundset_key,
                                 OxydLib::OxydVersion oxyd_ver, int button_position);
-        string getOxydSoundSet(OxydLib::OxydVersion oxyd_ver);
+        std::string getOxydSoundSet(OxydLib::OxydVersion oxyd_ver);
 
-        int convertToOldSoundSetNumber(string soundset_name);
-        string convertFromOldSoundSetNumber(int soundset_number);
+        int convertToOldSoundSetNumber(std::string soundset_name);
+        std::string convertFromOldSoundSetNumber(int soundset_number);
 
-        void setActiveSoundSet(string soundset_name);
+        void setActiveSoundSet(std::string soundset_name);
         void preloadSoundEffects();
 
         void setSoundSetCount(int count) { sound_set_count = count; }
         int getSoundSetCount() { return sound_set_count; }
         
-        int getSoundSetButtonPosition(string soundset_name) {
+        int getSoundSetButtonPosition(std::string soundset_name) {
             return sound_sets[soundset_name].getButtonPosition();
         }
-        string getSoundSetByPosition(int button_position);
+        std::string getSoundSetByPosition(int button_position);
         
     protected:
         SoundEffectManager();
@@ -370,8 +368,8 @@
         static SoundEffectManager *theSingleton;
         SoundSetRepository         sound_sets;
         SoundEffectRepository      sound_effects;
-        string                     active_sound_set_key;
-        string                     default_sound_set;
+        std::string                active_sound_set_key;
+        std::string                default_sound_set;
         int                        sound_set_count;
     };
 }

Modified: trunk/src/SoundEngine.cc
===================================================================
--- trunk/src/SoundEngine.cc	2008-06-25 20:44:48 UTC (rev 1194)
+++ trunk/src/SoundEngine.cc	2008-06-25 22:11:35 UTC (rev 1195)
@@ -28,15 +28,14 @@
 #include &lt;string&gt;
 #include &lt;cassert&gt;
 
-using namespace std;
-using namespace sound;
 using namespace enigma;
+using namespace sound;
 
 
 /* -------------------- Local variables -------------------- */
 namespace
 {
-    auto_ptr&lt;SoundEngine&gt; sound_engine;
+    std::auto_ptr&lt;SoundEngine&gt; sound_engine;
 
     bool sound_enabled      = true;
     bool music_enabled      = true;
@@ -168,12 +167,12 @@
     sound_engine-&gt;fadeout_music();
 }
 
-bool sound::PlayMusic (const string &amp;name, double position) 
+bool sound::PlayMusic (const std::string &amp;name, double position) 
 {
     if(sound::IsMusicMute() || name==&quot;&quot;)
         return false;
     
-    string fname;
+    std::string fname;
     return app.resourceFS-&gt;findFile (name, fname) &amp;&amp; sound_engine-&gt;play_music(fname, position);
 }
 
@@ -317,7 +316,7 @@
     m_current_music = 0;
 }
 
-bool SoundEngine_SDL::play_music (const string &amp;filename, double position) 
+bool SoundEngine_SDL::play_music (const std::string &amp;filename, double position) 
 {
     if (Mix_Music *music = Mix_LoadMUS(filename.c_str())) {
         if (m_current_music)
@@ -390,19 +389,19 @@
     return -1;
 }
 
-Mix_Chunk *SoundEngine_SDL::cache_sound(const string &amp;name)
+Mix_Chunk *SoundEngine_SDL::cache_sound(const std::string &amp;name)
 {
     ecl::Dict&lt;Mix_Chunk*&gt;::iterator i=wav_cache.find(name);
     if (i == wav_cache.end()) {
         Mix_Chunk *ch = 0;
-        string filename;
+        std::string filename;
         if (app.resourceFS-&gt;findFile(&quot;soundsets/&quot; + name + &quot;.wav&quot;, filename))
              ch = Mix_LoadWAV(filename.c_str());
         if (ch != 0)
             wav_cache.insert(name, ch);
         else
             enigma::Log &lt;&lt; &quot;Couldn't load sample '&quot; &lt;&lt; name &lt;&lt; &quot;': &quot;
-                        &lt;&lt; Mix_GetError() &lt;&lt; endl;
+                        &lt;&lt; Mix_GetError() &lt;&lt; std::endl;
         return ch;
     } else
         return i-&gt;second;
@@ -410,7 +409,7 @@
 
 void SoundEngine_SDL::cache_sound(const SoundEffect &amp;s) 
 {
-    string filename = s.getFilename();
+    std::string filename = s.getFilename();
     if (filename != &quot;&quot;)
         cache_sound(filename);
 }

Modified: trunk/src/SoundEngine.hh
===================================================================
--- trunk/src/SoundEngine.hh	2008-06-25 20:44:48 UTC (rev 1194)
+++ trunk/src/SoundEngine.hh	2008-06-25 22:11:35 UTC (rev 1195)
@@ -31,8 +31,6 @@
 #include &lt;string&gt;
 #include &lt;vector&gt;
 
-using namespace std;
-
 namespace sound
 {
 
@@ -46,7 +44,7 @@
     void DisableSound();
     void EnableSound();
     void DisableMusic();
-    bool PlayMusic(const string &amp;name, double position = 0.0);
+    bool PlayMusic(const std::string &amp;name, double position = 0.0);
     void FadeoutMusic();
 
     /*! Stop any music currently playing. */
@@ -89,7 +87,7 @@
 
         // ---------- Music ----------
 
-        virtual bool play_music(const string &amp;filename, double position) = 0;
+        virtual bool play_music(const std::string &amp;filename, double position) = 0;
         virtual void stop_music() = 0;
         virtual void fadeout_music() = 0;
         virtual bool is_music_playing() = 0;
@@ -113,7 +111,7 @@
         bool is_initialized() const { return true; }
         void set_sound_volume(double /*soundvol*/) {}
         void set_music_volume(double /*musicvol*/) {}
-        bool play_music (const string &amp;/*filename*/, double /*position*/) { return false; }
+        bool play_music (const std::string &amp;/*filename*/, double /*position*/) { return false; }
         void stop_music() {}
         void fadeout_music() {}
         bool is_music_playing() { return false; }
@@ -136,7 +134,7 @@
         bool is_initialized() const { return m_initialized; }
         void set_sound_volume(double soundvol);
         void set_music_volume(double musicvol);
-        bool play_music (const string &amp;filename, double position);
+        bool play_music (const std::string &amp;filename, double position);
         void stop_music();
         void fadeout_music();
         bool is_music_playing();
@@ -158,7 +156,7 @@
 
     private:
         // ---------- Private methods ----------
-        Mix_Chunk *cache_sound(const string &amp;name);
+        Mix_Chunk *cache_sound(const std::string &amp;name);
 
         void update_channel (int channel);
         int already_playing (const SoundEvent &amp;s);
@@ -176,7 +174,7 @@
         Uint16     m_format;
         int        m_channels;
         ecl::Dict&lt;Mix_Chunk*&gt; wav_cache;
-        vector&lt;SoundEvent&gt; m_channelinfo;
+        std::vector&lt;SoundEvent&gt; m_channelinfo;
         ecl::V2      m_listenerpos;
         SDL_mutex  *m_mutex;
         static SoundEngine_SDL *m_instance;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000628.html">[Enigma-game-svn] r1194 - in trunk/src: . stones
</A></li>
	<LI>Next message: <A HREF="000630.html">[Enigma-game-svn] Revision 1196
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#629">[ date ]</a>
              <a href="thread.html#629">[ thread ]</a>
              <a href="subject.html#629">[ subject ]</a>
              <a href="author.html#629">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
