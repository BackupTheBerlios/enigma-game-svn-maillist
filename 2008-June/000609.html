<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1175 - in trunk: doc/reference src/stones
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2008-June/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1175%20-%20in%20trunk%3A%20doc/reference%20src/stones&In-Reply-To=%3C200806140001.m5E01kbN027322%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000608.html">
   <LINK REL="Next"  HREF="000610.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1175 - in trunk: doc/reference src/stones</H1>
    <B>ral at mail.berlios.de</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1175%20-%20in%20trunk%3A%20doc/reference%20src/stones&In-Reply-To=%3C200806140001.m5E01kbN027322%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1175 - in trunk: doc/reference src/stones">ral at mail.berlios.de
       </A><BR>
    <I>Sat Jun 14 02:01:46 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000608.html">[Enigma-game-svn] r1174 - team_levelpacks/team_test_new_api
</A></li>
        <LI>Next message: <A HREF="000610.html">[Enigma-game-svn] r1176 - feature_branches/hp_lotm/input/lotm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#609">[ date ]</a>
              <a href="thread.html#609">[ thread ]</a>
              <a href="subject.html#609">[ subject ]</a>
              <a href="author.html#609">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ral
Date: 2008-06-14 02:01:24 +0200 (Sat, 14 Jun 2008)
New Revision: 1175

Modified:
   trunk/doc/reference/enigma-ref.texi
   trunk/src/stones/ClusterStone.cc
   trunk/src/stones/ClusterStone.hh
Log:
Trunk 1.1: new API reengineering
- refman fix typos
- fix r1164 Clusterstone add get_kind for backward compatibility


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2008-06-13 23:56:43 UTC (rev 1174)
+++ trunk/doc/reference/enigma-ref.texi	2008-06-14 00:01:24 UTC (rev 1175)
@@ -4958,7 +4958,7 @@
 same number and the faces will be set up automatically to form a large block.
 
 You can build a screen of arbitrary big blocks and it is proven that there will
-be never be the need of more than 4 different cluster numbers (the &quot;4 color 
+never be the need of more than 4 different cluster numbers (the &quot;4 color 
 theorem&quot;). But for convenience you are free to use additional cluster numbers
 as you like. Note that the autoclustering is quite dynamic. A single cluster
 stone with fitting cluster number that is swapped at the side of an existing
@@ -4967,8 +4967,8 @@
 
 We recommend making use of the autoclustering feature by setting the 
 @samp{cluster} attribute and using the @samp{faces} attribute where necessary.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at samp</A>{connections} attribute and explicit naming of variations by suffices 
-are depreceated, but will continue to be supported.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{connections} attribute and explicit naming of variations by a suffix 
+are deprecated, but will continue to be supported.
 
 @table @asis
 @item @b{Attributes:}
@@ -4986,8 +4986,8 @@
 
 @item @b{cluster} @ @ @i{values}: number; @ @ @i{default}: @code{nil}
 If set to a number all adjacent cluster stones of the same base type with
-the identical cluster number will build a big block. This attribute superceeds
-any explicit given face description.
+the identical cluster number will build a big block. This attribute superceds
+any explicitly given face description.
 
 @end table
 @end table
@@ -5138,8 +5138,8 @@
 
 An actorimpulse stone can be configured by the @samp{invisible} attribute to
 be hidden while being idle. While pulsing any actorimpulse is visible. An
-invisible actorimpulse can be made permanent visible by hitting it with a
-revealed @ref{it_brush} in the players inventory. The level author can configure
+invisible actorimpulse can be made permanently visible by hitting it with a
+revealed @ref{it_brush} in the player's inventory. The level author can configure
 @ref{it_glasses} by addition of @samp{SPOT_ACTORIMPULSE} to show otherwise
 invisible actorimpulse stones. With the global attribute @ref{ExtralifeGlasses}
 even glasses generated by laser lighting an @ref{it_extralife} can be configured
@@ -5154,12 +5154,12 @@
 @table @asis
 @item @b{invisible} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
 An invisible actorimpulse stone is totally transparent. But the user will
-notice it, as actors will bounce with addtional impulses.
+notice it, as actors will bounce with additional impulses.
 @item @b{strength} @ @ @i{values}: float number; @ @ @i{default}: @code{+200.0} @ @ @xref{ActorimpulseStrength}
 A scalar factor for the impulse force. Positive numbers are attracting forces
 where as negative numbers are repelling forces.
 @item @b{hit_factor} @ @ @i{values}: float number; @ @ @i{default}: @code{nil} @ @ @xref{hit_*}
-A @samp{hit_factor} overrrides a given @samp{strength} attribute.
+A @samp{hit_factor} overrides a given @samp{strength} attribute.
 @item @b{hit_distortion_xx} @ @ @i{values}: float number; @ @ @i{default}: @code{+1.0} @ @ @xref{hit_*}
 @item @b{hit_distortion_xy} @ @ @i{values}: float number; @ @ @i{default}: @code{0.0} @ @ @xref{hit_*}
 @item @b{hit_distortion_yx} @ @ @i{values}: float number; @ @ @i{default}: @code{0.0} @ @ @xref{hit_*}
@@ -5198,7 +5198,7 @@
 will open and close a given blocker multiple times.
 
 Note that the blocker is the only door object that allows a stone to be pushed
-through. Just bloulders cause the growing. Any other stone keeps the open state.
+through. Just boulders cause the growing. Any other stone keeps the open state.
 
 Be aware that the @ref{it_brake} destroys an @ref{it_blocker}.
 
@@ -5209,11 +5209,11 @@
 @item @b{state}, @ @ @i{values}: @code{OPEN}, @code{CLOSED}; @ @ @i{default}: @code{CLOSED} @ @ @xref{state}
 The stone represents the closed state and will always return state @samp{CLOSED}.
 But you can set its state what is equivalent to sending an open message in case
-of value @samp{OPEN} and an close message in case of value @samp{CLOSED}..
+of value @samp{OPEN} and a close message in case of value @samp{CLOSED}.
 
 @atindex autoclose
 @item @b{autoclose} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
-This attribute is irrelevant to the blocker stone itself. But is is transfered
+This attribute is irrelevant to the blocker stone itself. But it is transferred
 to the @ref{it_blocker} when the blocker opens.
 
 @end table
@@ -5225,15 +5225,15 @@
 A signal of value 1 sends an open message, a signal of value 0 sends a close
 message.
 @item @b{toggle} @ @ @xref{toggle}
-A toggle causes an open unless the the blocker stone is in the shrinking process.
+A toggle causes an open unless the blocker stone is in the shrinking process.
 In this case it causes a close message.
 @item @b{open} @ @ @xref{open}
 Starts an opening by shrinking the blocker. Note that during the shrinking
 process the blocker still reports to be closed. The shrinking process can
 be reverted by a close message.
 @item @b{close} @ @ @xref{close}
-A close message take only effect on blocker stone that is in the shrinking
-process. The shrinking is stopped immediatly and reverted to grow the blocker
+A close message takes only effect on a blocker stone that is in the shrinking
+process. The shrinking is stopped immediately and reverted to grow the blocker
 again to full size.
 @end table
 
@@ -5260,12 +5260,12 @@
 @obindex st_boulder
 
 This solid stone moves into the direction shown by the arrow on its picture.
-A marble blocking its way is shattered. When a stone blocks its way, it triggers
-it by a sequence of two internal messages. Some stones give way like 
+A marble blocking its way is shattered. When a stone blocks its way, the boulder
+triggers it by a sequence of two internal messages. Some stones give way like 
 @ref{st_blocker}, others change their state like @ref{st_oxyd}, 
 @ref{st_stoneimpulse}, @ref{st_fart}, @ref{st_mirror}, @ref{st_fourswitch},
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at ref</A>{st_volcano}. A third category switches temporary in another state on the
-first message sent when the boulder reaches a grid and switch back on the
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{st_volcano}. A third category switches temporarily into another state on the
+first message sent when the boulder reaches a grid and switches back on the
 second message sent when the boulder gives up like @ref{st_[black/white]},
 @ref{st_plain}, @ref{st_lightpassenger}.
 
@@ -5278,7 +5278,7 @@
 
 @ref{it_magicwand} and lasers reverse its direction. An @ref{st_actorimpulse}
 reverts the direction if the boulder hits it frontally. An @ref{st_rotator}
-changes its direction according to the rotators direction. An 
+changes its direction according to the rotator's direction. An 
 @ref{st_stoneimpulse} pushes a boulder away.
 
 @table @asis
@@ -5346,7 +5346,7 @@
 coinslot will first switch @samp{OFF} and switch @samp{ON} when the next coin
 is completly inserted.
 
-Coinslots configured as @samp{instant} do activy immediatly when the actor
+Coinslots configured as @samp{instant} do activate immediatly when the actor
 hits the stone. On every actor hit a coin is inserted independent of the last
 insertion.
 
@@ -5357,7 +5357,7 @@
 @item @b{Attributes:}
 
 @table @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}: @i{access}: @code{read only}  @ @ @xref{state}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}; @i{access}: @code{read only}  @ @ @xref{state}
 Current activity state of the coinslot.
 @item @b{instant} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
 A default coinslot switches to active state after insertion of a coin and allows
@@ -5459,7 +5459,7 @@
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 Performs an action on each turn. If just a pair of global @samp{target/action}
 attributes are given, the action message is sent to the target with a 
-direction value of the new orientation. This values suits any message of the
+direction value of the new orientation. This value suits any message of the
 target that expects a direction value, and the @ref{signal} message, that 
 translates the direction to a 1 for @samp{NORTH}, @samp{SOUTH} and a 0 for 
 @samp{EAST}, @samp{WEST}.
@@ -5484,16 +5484,16 @@
 @samp{code} are accepted.
 
 On a second hit the switch is deactivated and the inserted key is returned
-to the players inventory.
+to the player's inventory.
 
 @table @asis
 @item @b{Attributes:}
 
 @table @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}: @ @ @xref{state}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}; @ @ @xref{state}
 Current activity state of the key stone.
 @item @b{code}, @ @ @i{values}: number; @ @ @i{default}: @code{1}:
-The code that is required to activy this switch.
+The code that is required to activate this switch.
 @end table
 
 @item @b{Messages:}
@@ -5518,7 +5518,7 @@
 the activity of the laser and can be set initially to @samp{ON}. A laser is
 orientated to one direction in which the light will be emitted.
 
-Lasers have a latency that protect them from infinit fast switching cycles. This
+Lasers have a latency that protect them from infinite fast switching cycles. This
 allows you to toggle a laser with an @ref{st_laserswitch} that is illuminated
 by the laser itself. During the latency period pending switch requests will be
 registered but will be executed with a certain small delay. Note that several
@@ -5601,7 +5601,7 @@
 @table @asis
 @item @b{state}, @ @ @i{values}: @code{ON}, @code{OFF}; @ @ @i{default}: @code{OFF}; @ @ @xref{state}
 Represents the activity state. The state of a new object can be set, but an
-active monoflop cannot be set to state @samp{OFF}.
+active laserflop cannot be set to state @samp{OFF}.
 @item @b{interval} @ @ @i{values}: positive number; @ @ @i{default}: @code{1.8}
 Number of seconds to return to state @samp{OFF} after the last hit.
 
@@ -5611,9 +5611,9 @@
 
 @table @asis
 @item @b{signal} @ @ @xref{signal}
-Switches on at value @samp{1}. A values of @samp{0} is ignored.
+Switches on at value @samp{1}. A value of @samp{0} is ignored.
 @item @b{on} @ @ @xref{on}
-Switch the monoflop on like on an actor hit.
+Switches the laserflop on like on an actor hit.
 @end table
 
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
@@ -5629,7 +5629,7 @@
 state @samp{ON} when a laser beam hits the stone from any direction. It switches
 instantly back to state @samp{OFF} when it is no longer illuminated.
 
-There is no way to set set the state of this stone manually. But the state
+There is no way to set the state of this stone manually. But the state
 can nevertheless be read. At initialization a laserswitch that is exposed to
 laser light will start in state @samp{ON} without sending actions due to the
 @ref{Snapshot Principle}.
@@ -5676,7 +5676,7 @@
 The speed of the light passenger can be changed with the
 @samp{interval}-attribute (default 50 ms, which is quite fast) and may
 include the floor friction and local gradient via
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at samp</A>{friction} and @code{gradient}. The resulting interval results as
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{friction} and @samp{gradient}. The resulting interval results as
 
 @example
 interval  =  base * (1 + stone_friction * floor_friction) / (1 + stone_gradient * floor_gradient)
@@ -5697,8 +5697,8 @@
 @ref{it_brush} in the inventory. Such a touch with a brush does wipe out a
 cross beneath the lightpassenger, too.
 
-An @ref{st_boulder} hitting a lightpassenger toggles its state for a short
-period.
+An @ref{st_boulder} hitting a lightpassenger toggles the lightpassenger's state
+for a short period.
 
 When an active @samp{st_lightpassenger} is trapped between exactly two
 opposing light beams or light beams from all four directions, it
@@ -5748,7 +5748,7 @@
 
 A switch that is triggered by actor hits. It switches instantly to
 state @samp{ON} and after a given @samp{interval} back to state @samp{OFF}.
-Repeatitive actor hits will prolong the @samp{ON} state untill a trailing 
+Repetitive actor hits will prolong the @samp{ON} state until a trailing 
 @samp{interval} after the last hit has been expired. A switch similar to
 the monoflop is the @ref{st_laserflop}, which is additionally light sensitive.
 
@@ -5800,14 +5800,14 @@
 This causes an automatic coloring by pairs of colors in the standard color
 sequence.
 
-There is no limit on the number of used oxyd pairs. There exists 12 different
+There is no limit on the number of used oxyd pairs. There exist 12 different
 regular colors for oxyds. But per default just the first 8 colors will be
 assigned to @samp{OXYD_AUTO} colored oxyds. The colors will repeat from the
 9th pair giving the user the possibility to build arbitrary couples within a
 single color. With the world attribute @ref{MaxOxydColor} you can lower or
 increase this limit. By setting this attribute to @samp{OXYD_GREEN} you can
 enforce the engine to assign just the first three colors. Be careful in usage
-of more than 8 colors as levels can get incredible difficult. Uneven number of
+of more than 8 colors as levels can get incredibly difficult. Uneven number of
 regular colored oxyds are not allowed.
 
 Usually oxyds are shuffled by a @samp{wo:shuffleOxyd()} statement after setting
@@ -6071,7 +6071,7 @@
 cannot pass and other stones cannot be moved onto the same grid position.
 @item @b{interval} @ @ @i{values}: positive number; @ @ @i{default}: @code{1.0}
 Number of seconds until the first and between subsequent events. The interval
-must be larger equal 0.01 seconds for looping timers.
+must be larger or equal 0.01 seconds for looping timers.
 @item @b{loop} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}
 A looping timer will send periodic events.
 @end table
@@ -6097,10 +6097,10 @@
 @subsection st_window
 @obindex st_window
 
-A stone made up just of glass window faces. All combination of window faces with
+A stone made up just of glass window faces. All combinations of window faces with
 at least one face are possible. There exist two versions of windows, normal
-blue colored glass and green colored saftey glass, that is nearly undistructable.
-Saftey glass is seleted by setting the attribute @samp{secure} to @samp{true}.
+blue colored glass and green colored safety glass, that is nearly undistructable.
+Safety glass is seleted by setting the attribute @samp{secure} to @samp{true}.
 Every glass face can be weakened by @samp{scratches} which are visible in the
 shadows.
 
@@ -6108,7 +6108,7 @@
 
 Slowly moving actors will bounce from window faces on any side. They can freely
 move within the inner part of the window stone. Invisible actors can even pass
-the normal blue window faces, but not the green saftey glass faces.
+the normal blue window faces, but not the green safety glass faces.
 
 Fast moving actors can blast normal blue window faces into smithereens. But too
 strong hits will cause marbles to shatter themselves. An actor can lower the
@@ -6117,7 +6117,7 @@
 safty glass windows will never break on actor attacks.
 
 Bomb explosions can shatter window faces, too. Normal blue window faces adjacent
-to a bomb explosion will break. Green saftey glass faces will break only if 
+to a bomb explosion will break. Green safety glass faces will break only if 
 prior weakened by an @ref{it_ring} scratch.
 
 Window faces can be rearranged by actors with a revealed @ref{it_wrench}.
@@ -6143,7 +6143,7 @@
 @code{&quot;nesw&quot;} listing the faces. The sequence of the sides, north, east, south,
 west, is guaranteed on read access but arbitrary on write access.
 @item @b{secure} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
-Green saftey glass is secure, whereas normal blue is not.
+Green safety glass is secure, whereas normal blue is not.
 @item @b{scatches} @ @ @i{values}: string; @ @ @i{default}: @code{&quot;&quot;}
 Describes the scratched window faces of the stone. The string is a substring of 
 @code{&quot;nesw&quot;} listing the affected faces. The sequence of the sides, north, east,
@@ -6154,7 +6154,7 @@
 
 @table @asis
 @item @b{inner_pull}, @ @ @i{value type}: direction
-Try to tear the opposite window face into the given direction.
+Tries to tear the opposite window face into the given direction.
 @end table
 
 @item @b{Variants:}
@@ -10981,7 +10981,7 @@
 to group actors of different kinds into an essential group via this id. The
 engine keeps this id even if actors are transformed into other kinds.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @b{whiteball}, @b{blackball} @i{depreceated}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{whiteball}, @b{blackball} @i{deprecated}
 @code{TRUE} or @code{FALSE}. Used by color-sensitive stones
 (black/white switches for example) to determine whether the actor is
 the black or the white marble.  These attributes may disappear in

Modified: trunk/src/stones/ClusterStone.cc
===================================================================
--- trunk/src/stones/ClusterStone.cc	2008-06-13 23:56:43 UTC (rev 1174)
+++ trunk/src/stones/ClusterStone.cc	2008-06-14 00:01:24 UTC (rev 1175)
@@ -30,6 +30,10 @@
         return getAttr(&quot;$class&quot;).to_string();
     }
     
+    const char *ClusterStone::get_kind() const {
+        return getClass().c_str();
+    }
+    
     void ClusterStone::setAttr(const string&amp; key, const Value &amp;val) {
         if (key == &quot;connections&quot; || key == &quot;faces&quot; || key == &quot;cluster&quot;) {
             Stone::setAttr(key, val);

Modified: trunk/src/stones/ClusterStone.hh
===================================================================
--- trunk/src/stones/ClusterStone.hh	2008-06-13 23:56:43 UTC (rev 1174)
+++ trunk/src/stones/ClusterStone.hh	2008-06-14 00:01:24 UTC (rev 1175)
@@ -35,6 +35,7 @@
         
         // Object interface
         virtual std::string getClass() const;
+        virtual const char *get_kind() const;  // for backward compatibility
         virtual void setAttr(const string&amp; key, const Value &amp;val);
         virtual Value message(const Message &amp;m);
         


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000608.html">[Enigma-game-svn] r1174 - team_levelpacks/team_test_new_api
</A></li>
	<LI>Next message: <A HREF="000610.html">[Enigma-game-svn] r1176 - feature_branches/hp_lotm/input/lotm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#609">[ date ]</a>
              <a href="thread.html#609">[ thread ]</a>
              <a href="subject.html#609">[ subject ]</a>
              <a href="author.html#609">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
