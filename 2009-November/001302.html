<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1874 - in trunk: data/gfx/flags25x15 po src/gui
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2009-November/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1874%20-%20in%20trunk%3A%20data/gfx/flags25x15%20po%20src/gui&In-Reply-To=%3C200911232225.nANMP6W5015396%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001301.html">
   <LINK REL="Next"  HREF="001303.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1874 - in trunk: data/gfx/flags25x15 po src/gui</H1>
    <B>ral at BerliOS</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1874%20-%20in%20trunk%3A%20data/gfx/flags25x15%20po%20src/gui&In-Reply-To=%3C200911232225.nANMP6W5015396%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1874 - in trunk: data/gfx/flags25x15 po src/gui">ral at mail.berlios.de
       </A><BR>
    <I>Mon Nov 23 23:25:06 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001301.html">[Enigma-game-svn] r1873 - trunk/po
</A></li>
        <LI>Next message: <A HREF="001303.html">[Enigma-game-svn]  r1872 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1302">[ date ]</a>
              <a href="thread.html#1302">[ thread ]</a>
              <a href="subject.html#1302">[ subject ]</a>
              <a href="author.html#1302">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ral
Date: 2009-11-23 23:25:05 +0100 (Mon, 23 Nov 2009)
New Revision: 1874

Modified:
   trunk/data/gfx/flags25x15/pl-shaded.png
   trunk/po/fi.po
   trunk/po/pl.po
   trunk/src/gui/MainMenu.cc
   trunk/src/gui/MainMenu.hh
   trunk/src/gui/widgets.cc
   trunk/src/gui/widgets.hh
Log:
Trunk 1.1: 
- adjusted language flag user paradigm:
  - the selected language flag is highlighted
  - the mouse over flag is highlighted
  - other flags are shaded
  - flag highlighting reflects options menu changes and default selection
- shade Polish flag
- remove old Finnish translation of Aztec Temple


Modified: trunk/data/gfx/flags25x15/pl-shaded.png
===================================================================
(Binary files differ)

Modified: trunk/po/fi.po
===================================================================
--- trunk/po/fi.po	2009-11-23 17:46:46 UTC (rev 1873)
+++ trunk/po/fi.po	2009-11-23 22:25:05 UTC (rev 1874)
@@ -5176,11 +5176,6 @@
 &quot;to be a relic of the ancient Aztec empire. But the temple is in surprisingly &quot;
 &quot;good condition ...&quot;
 msgstr &quot;&quot;
-&quot;Tervetuloa Mexicoon! Kahdeksan tuntia sitten, koneesi saapui \&quot;Coatlicuen\&quot; &quot;
-&quot;lentokent&#228;lle, mik&#228; on pieni kyl&#228; tutkimattoman viidakkomaaston ymp&#228;r&#246;im&#228;n&#228;. &quot;
-&quot;Nyt huomaat itsesi vaikuttavan temppelin edess&#228;, mik&#228; n&#228;ytt&#228;&#228; olevan &quot;
-&quot;antiikkisten Asteekkien aikojen relikti. Mutta temppeli on yll&#228;tt&#228;v&#228;n &quot;
-&quot;hyv&#228;ss&#228; kunnossa ...&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5193,19 +5188,12 @@
 &quot;relic a fortress\&quot;, you think, \&quot;this cannot be legal, for Goshers received &quot;
 &quot;funding from the UK Government. I'll try to call him to account!\&quot;&quot;
 msgstr &quot;&quot;
-&quot;J&#228;ttim&#228;isten ovien vieress&#228; n&#228;et kroomatun kyltin: \&quot;Restaurointi J. J. &quot;
-&quot;Jumalisten toimesta, Vuonna 1998 jKr\&quot;. Ja pienemm&#228;ss&#228; kyltiss&#228; alapuolella &quot;
-&quot;lukee: \&quot;J. J. Jumalisten omaisuutta. L&#228;pikulku kielletty!\&quot;. Nyt huomaat &quot;
-&quot;koirankopit, jotka on rakennettu temppelin etupuolen my&#246;t&#228;. \&quot;Jumaliste teki &quot;
-&quot;t&#228;m&#228;n reliktin linnoitukseksi\&quot;, ajattelet, \&quot;t&#228;m&#228; ei voi olla laillista, &quot;
-&quot;Jumalisten saamansa Suomen Hallituksen ylennyst&#228; varten. Yrit&#228;n saada h&#228;net  &quot;
-&quot;tunnustamaan!\&quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4652
 msgid &quot;This guard doesn&#8217;t notice me.&quot;
-msgstr &quot;T&#228;m&#228; vartija ei huomaa minua.&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5213,8 +5201,6 @@
 msgid &quot;&quot;
 &quot;This lake was obviously made by Goshers. I think the correct way is south.&quot;
 msgstr &quot;&quot;
-&quot;T&#228;m&#228; j&#228;rvi on ilmiselv&#228;sti Jumalisten tekosia. Luulenpa ett&#228; oikea tie on &quot;
-&quot;etel&#228;puolella.&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5223,20 +5209,18 @@
 &quot;There's an inscription on the old wall, saying in spanish: \&quot;Careful! What &quot;
 &quot;you touch could be the last thing you touch!\&quot;&quot;
 msgstr &quot;&quot;
-&quot;Vanhassa sein&#228;ss&#228; on inskriptio, espanjaksi: \&quot;Varo! Se mihin kosket, voi &quot;
-&quot;olla se viimeinen mihin kosket!\&quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4655
 msgid &quot;Chrome sign: \&quot;Control of the beast&#8217;s cage.\&quot;&quot;
-msgstr &quot;Kroomattu kyltti: \&quot;Pedon ohjauksen h&#228;kki.\&quot;&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4656
 msgid &quot;Oooh, this slope is steep! Try not to touch the skull!&quot;
-msgstr &quot;Huh, t&#228;m&#228; rinne on jyrkk&#228;! &#196;l&#228; yrit&#228; koskea p&#228;&#228;kalloon!&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5246,9 +5230,6 @@
 &quot;its purpose ... Ah, there's another chrome sign. Goshers seems to favour &quot;
 &quot;chrome signs. It says: \&quot;Natives&#8217; prison\&quot;.&quot;
 msgstr &quot;&quot;
-&quot;Tuo rakennus n&#228;ytt&#228;&#228; vankilalta. Katsotaan jos voin p&#228;&#228;tell&#228; sen &quot;
-&quot;tarkoituksen... Ah, tuossa on toinen kroomattu kyltti. Jumalistella n&#228;ytt&#228;&#228; &quot;
-&quot;olevan suosio kroomatuille kyltille. Siin&#228; lukee: \&quot;Paikallisten vankila\&quot;.&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5257,9 +5238,6 @@
 &quot;Getting beyond the prison building was a really good idea. But now you have &quot;
 &quot;to cross this lake. Be thrifty with those boxes!&quot;
 msgstr &quot;&quot;
-&quot;P&#228;&#228;seminen vankilarakennuksen toiselle puolelle oli todella hyv&#228; idea. Mutta &quot;
-&quot;nyt sinun t&#228;ytyy ylitt&#228;&#228; t&#228;m&#228; j&#228;rvi. Ole taloudellinen noiden laatikoiden &quot;
-&quot;kanssa!&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5271,11 +5249,6 @@
 &quot;of the Aztecs. It might be helpful to be accompanied by someone, who knows &quot;
 &quot;the secrets of the jungle and this temple ...&quot;
 msgstr &quot;&quot;
-&quot;Nyt, katsoaakseen vankilan kalteri-ikkunan l&#228;pi, tunnistat paikallisen &quot;
-&quot;naisen vangittuna sinne. Ilmiselv&#228;sti Jumaliste lukitsi kaikki paikalliset &quot;
-&quot;ketk&#228; h&#228;iritsiv&#228;t h&#228;nen \&quot;ty&#246;t&#228;&#228;n\&quot;; yritt&#228;&#228;kseen p&#228;&#228;st&#228; temppeliin ja &quot;
-&quot;tullaakseen rikkaaksi Asteekkien aarteilla. Voi olla hy&#246;dyllist&#228; olla jonkun &quot;
-&quot;kanssa, kuka tiet&#228;&#228; viidakon ja t&#228;m&#228;n temppelin salaisuudet ...&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5286,11 +5259,6 @@
 &quot;and free my people. And even if this is not the case, it's better to be free &quot;
 &quot;than imprisoned. I think I should thank him.&quot;
 msgstr &quot;&quot;
-&quot;Sen j&#228;lkeen, kun tuo valkoinen mies vapautti minut vankilasta, h&#228;n ei &quot;
-&quot;todellakaan voi olla niin paha kuin t&#228;m&#228; Jumaliste on. Ehk&#228; h&#228;n haluaa &quot;
-&quot;pys&#228;ytt&#228;&#228; Jumalisten mestaruuden ja vapauttaa ihmiseni. Jopa jos t&#228;m&#228; ei ole &quot;
-&quot;se asia, on parempi olla vapaa kuin vangittu. Luulenpa ett&#228; minun pit&#228;isi &quot;
-&quot;kiitt&#228;&#228; h&#228;nt&#228;.&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5300,10 +5268,6 @@
 &quot;Xila!\&quot;, you tell him in broken English. After he introduced himself as &quot;
 &quot;well, both of you begin to work out a plan against the evil G. G. Goshers.&quot;
 msgstr &quot;&quot;
-&quot;Tapaat englantilaisen seikkailijan vankilan edess&#228;. \&quot;Terve, olen Xila!\&quot;, &quot;
-&quot;kerrot h&#228;nelle murskautuneella englannilla. Sen j&#228;lkeen kun h&#228;nkin &quot;
-&quot;puolestaan esitteli itsens&#228;, te molemmat aloititte tekem&#228;&#228;n suunnitelmaa &quot;
-&quot;pahaa J. J. Jumalistea vastaan.&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5312,44 +5276,42 @@
 &quot;This is a really hard puzzle. The English man will have to help me, if this &quot;
 &quot;enigma is to be solved.&quot;
 msgstr &quot;&quot;
-&quot;T&#228;m&#228; on eritt&#228;in vaikea arvoitus. Englantilaisen miehen t&#228;ytyy auttaa minua, &quot;
-&quot;jos t&#228;m&#228;n arvoituksen on tarkoitus tulla ratkaistuksi.&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4663
 msgid &quot;You wonder what this switch could trigger.&quot;
-msgstr &quot;Ihmettelet, mit&#228; t&#228;m&#228; kytkin laukaisisi.&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4664
 msgid &quot;Xila knows how to drain the lake!&quot;
-msgstr &quot;Xila tiet&#228;&#228; kuinka tyhjennet&#228;&#228;n j&#228;rvi!&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4665
 msgid &quot;You were lucky to find this hole. It prevents you from drowning.&quot;
-msgstr &quot;Olit onnekas l&#246;yt&#228;&#228;ksesi t&#228;m&#228;n onkalon. Se est&#228;&#228; sinua hukkumasta.&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4666
 msgid &quot;This glass stone must fulfill a purpose ...&quot;
-msgstr &quot;T&#228;m&#228;n lasisen kiven t&#228;ytyy t&#228;ytt&#228;&#228; jonkin merkityksen ...&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4667
 msgid &quot;It's funny that such a temple should have a side entrance.&quot;
-msgstr &quot;On hassua ett&#228; t&#228;ll&#228;isella temppelill&#228; on sis&#228;&#228;nk&#228;ynti sivussa.&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4668
 msgid &quot;Be careful! There are sensors in the walls.&quot;
-msgstr &quot;Ole varovainen! Seiniss&#228; on sensoreita.&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5360,18 +5322,12 @@
 &quot;very dangerous. Without a sword you'll never be able to enter. Be careful. &quot;
 &quot;There are not only knights, but also thieves.&quot;
 msgstr &quot;&quot;
-&quot;Vanhan temppelin j&#228;ttim&#228;isten ovien avautumisen j&#228;lkeen, n&#228;et, ett&#228; &quot;
-&quot;sis&#228;&#228;nk&#228;ynti&#228; suojaa 11 keih&#228;&#228;ll&#228; aseistautunutta ritaria. N&#228;m&#228; vartijat &quot;
-&quot;ovat eritt&#228;in vaarallisia. Ilman miekkaa et koskaan kykene menem&#228;&#228;n sis&#228;&#228;n. &quot;
-&quot;Ole varovainen. He eiv&#228;t ole ainostaan ritareita mutta my&#246;s varkaita.&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4670
 msgid &quot;\&quot;Congratulations. You just managed to enter this old Aztec Temple.\&quot;&quot;
 msgstr &quot;&quot;
-&quot;\&quot;Onneksi olkoon. Onnistuit juuri saapumaan t&#228;h&#228;n vanhaan Asteekkien &quot;
-&quot;Temppeliin.\&quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5380,8 +5336,6 @@
 &quot;\&quot;You've been smarter than I expected. But you'll never enter the treasure &quot;
 &quot;room nor escape from here!\&quot;&quot;
 msgstr &quot;&quot;
-&quot;\&quot;Olet ollut viisaampi kuin luulinkaan. Mutta et koskaan p&#228;&#228;se aarrehuoneen &quot;
-&quot;luokse tai edes pakenemaan t&#228;&#228;lt&#228;!\&quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5390,14 +5344,12 @@
 &quot;\&quot;I, Goshers, will certainly be able to rid myself of one of my archenemies &quot;
 &quot;by just killing you!\&quot;&quot;
 msgstr &quot;&quot;
-&quot;\&quot;Min&#228;, Jumaliste, on varmasti kykenev&#228; hankkiutumaan eroon yhdest&#228; minun &quot;
-&quot;p&#228;&#228;vihollisistani, vain tappamalla sinut!\&quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
 #: po/level_i18n.cc:4673
 msgid &quot;\&quot;Run for your life!\&quot;&quot;
-msgstr &quot;\&quot;Juokse henkesi edest&#228;!\&quot;&quot;
+msgstr &quot;&quot;
 
 #  level: &quot;The Aztec Temple&quot;
 #  author: &quot;Dominik Lehmann&quot; email &quot;&quot;
@@ -5408,10 +5360,6 @@
 &quot;ended the evil career of Gerald Gregory Goshers. Congratulations on the &quot;
 &quot;success of your expedition!&quot;
 msgstr &quot;&quot;
-&quot;Xila ja sin&#228; saavuitte juuri vanhan Asteekkien Temppelin Timanttihuoneeseen. &quot;
-&quot;Viem&#228;ll&#228; Jumalisten takaisin Suomeen ja ilmiantaakseen h&#228;net poliisille, &quot;
-&quot;olet lopettanut Jaska Jorma Jumalisten pahan uransa. Onneksi olkoon &quot;
-&quot;onnistuneesta tutkimusretkest&#228;si!&quot;
 
 #  level: &quot;Meditation Disturbance&quot;
 #  author: &quot;Ronald Lamprecht&quot; email &quot;<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">ral at users.berlios.de</A>&quot;

Modified: trunk/po/pl.po
===================================================================
--- trunk/po/pl.po	2009-11-23 17:46:46 UTC (rev 1873)
+++ trunk/po/pl.po	2009-11-23 22:25:05 UTC (rev 1874)
@@ -1,4 +1,4 @@
-# Polnish translation for Enigma.
+# Polish translation for Enigma.
 # Copyright (C) 20009 Erik
 # This file is distributed under the same license as the PACKAGE package.
 # Erik Jan Kuipers &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">erik.kuipers at uj.edu.pl</A>&gt;, 2009

Modified: trunk/src/gui/MainMenu.cc
===================================================================
--- trunk/src/gui/MainMenu.cc	2009-11-23 17:46:46 UTC (rev 1873)
+++ trunk/src/gui/MainMenu.cc	2009-11-23 22:25:05 UTC (rev 1874)
@@ -377,15 +377,18 @@
         //BuildHList l(this, Rect(ly, (vminfo-&gt;height) - 30, 30, 20), 5);
         BuildHList l(this, Rect(ly, 10, 30, 20), 5);
         //BuildVList l(this, Rect(vminfo-&gt;width - 45, 15, 30, 20), 5);
-        language.clear();
-        if(!vshrink)
+        if(!vshrink) {
+            std::string curname = ecl::SysMessageLocaleName();
+            curname = curname.substr(0, curname.find('.'));
             for (size_t i=1; i&lt;NUMENTRIES(nls::languages); ++i) {
                 BorderlessImageButton *but = new BorderlessImageButton(
                     nls::languages[i].flagimage + string(&quot;-shaded&quot;),
                     nls::languages[i].flagimage,
-                    nls::languages[i].flagimage, this);
-                language.push_back(l.add(but));
+                    nls::languages[i].flagimage, curname == nls::languages[i].localename, this);
+                l.add(but);
+                flags.push_back(but);
             }
+        }
     }
     
     void MainMenu::draw_background(ecl::GC &amp;gc) 
@@ -451,14 +454,19 @@
     #endif
         } else if (w == quit) {
             Menu::quit();
-        } else if (language.size() &gt; 0) {
+        } else if (flags.size() &gt; 0) {
             for (size_t i=1; i&lt;NUMENTRIES(nls::languages); ++i)
-                if (w == language[i-1]) {
+                if (w == flags[i-1]) {
                     options::SetOption (&quot;Language&quot;, nls::languages[i].localename);
                     app.setLanguage(nls::languages[i].localename);
                 }
         } else
             return;
+        // need to update flags
+        std::string curname = ecl::SysMessageLocaleName();
+        curname = curname.substr(0, curname.find('.'));
+        for (int i = 0; i &lt; flags.size(); i++)
+            flags[i]-&gt;setState(curname == nls::languages[i+1].localename);
         invalidate_all();
     }
     

Modified: trunk/src/gui/MainMenu.hh
===================================================================
--- trunk/src/gui/MainMenu.hh	2009-11-23 17:46:46 UTC (rev 1873)
+++ trunk/src/gui/MainMenu.hh	2009-11-23 22:25:05 UTC (rev 1874)
@@ -21,7 +21,9 @@
 #define GUI_MAINMENU_HH_INCLUDED
 
 #include &quot;gui/Menu.hh&quot;
+#include &quot;gui/widgets.hh&quot;
 
+#include &lt;list&gt;
 #include &lt;vector&gt;
 
 namespace enigma { namespace gui {
@@ -54,7 +56,7 @@
         Widget *help;
         Widget *quit;
         Widget *lpack;
-        std::vector &lt;Widget*&gt; language;
+        std::vector&lt;BorderlessImageButton*&gt; flags;
     };
 
 /* -------------------- MainHelpMenu -------------------- */

Modified: trunk/src/gui/widgets.cc
===================================================================
--- trunk/src/gui/widgets.cc	2009-11-23 17:46:46 UTC (rev 1873)
+++ trunk/src/gui/widgets.cc	2009-11-23 22:25:05 UTC (rev 1874)
@@ -948,8 +948,8 @@
 /* -------------------- BorderlessImageButton -------------------- */
 
 BorderlessImageButton::BorderlessImageButton(const string &amp;unselected,
-    const string &amp;selected, const string &amp;mouseover, ActionListener *al)
-: fname_sel(selected), fname_unsel(unselected), fname_mouse(mouseover)
+    const string &amp;selected, const string &amp;mouseover, bool isSelected, ActionListener *al)
+: fname_sel(selected), fname_unsel(unselected), fname_mouse(mouseover), state (isSelected)
 {
     set_listener(al);
 }
@@ -962,7 +962,7 @@
 }
 
 void BorderlessImageButton::draw(ecl::GC &amp;gc, const ecl::Rect &amp;r) {
-    string &amp;fname = m_activep ? fname_mouse : (is_pressed() ? fname_sel : fname_unsel);
+    string &amp;fname = m_activep ? fname_mouse : (state ? fname_sel : fname_unsel);
 
     if (Surface *s = enigma::GetImage(fname.c_str())) {
         int w=s-&gt;width();
@@ -973,3 +973,11 @@
     }
 }
 
+void BorderlessImageButton::setState(bool isSelected) {
+    state = isSelected;
+    invalidate();
+}
+
+bool BorderlessImageButton::getState() const {
+    return state;
+}

Modified: trunk/src/gui/widgets.hh
===================================================================
--- trunk/src/gui/widgets.hh	2009-11-23 17:46:46 UTC (rev 1873)
+++ trunk/src/gui/widgets.hh	2009-11-23 22:25:05 UTC (rev 1874)
@@ -473,13 +473,17 @@
         BorderlessImageButton(const std::string &amp;unselected,
                               const std::string &amp;selected,
                               const std::string &amp;mouseover,
+                              bool isSelected =false,
                               ActionListener    *al = 0);
         void set_images(const std::string &amp;unselected, const std::string &amp;selected,
                         const std::string &amp;mouseover);
+        void setState(bool isSelected);
+        bool getState() const;
         // Widget interface.
         virtual void draw(ecl::GC &amp;gc, const ecl::Rect &amp;r);
     private:
         std::string fname_sel, fname_unsel, fname_mouse;
+        bool state;
     };
 
 }} // namespace enigma::gui


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001301.html">[Enigma-game-svn] r1873 - trunk/po
</A></li>
	<LI>Next message: <A HREF="001303.html">[Enigma-game-svn]  r1872 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1302">[ date ]</a>
              <a href="thread.html#1302">[ thread ]</a>
              <a href="subject.html#1302">[ subject ]</a>
              <a href="author.html#1302">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
