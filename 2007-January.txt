From ral at mail.berlios.de  Mon Jan  1 21:36:56 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Mon, 1 Jan 2007 21:36:56 +0100
Subject: [Enigma-game-svn] r560 - trunk/src
Message-ID: <200701012036.l01Kauo0014146@sheep.berlios.de>

Author: ral
Date: 2007-01-01 21:36:55 +0100 (Mon, 01 Jan 2007)
New Revision: 560

Modified:
   trunk/src/display.cc
   trunk/src/display.hh
   trunk/src/main.cc
   trunk/src/stones.hh
   trunk/src/world.cc
   trunk/src/world.hh
   trunk/src/world_internal.hh
Log:
developer support:
- new commandline option "--showfps"
- fix crashes on level border transitions with switched off collision handling


Modified: trunk/src/display.cc
===================================================================
--- trunk/src/display.cc	2006-12-31 21:44:41 UTC (rev 559)
+++ trunk/src/display.cc	2007-01-01 20:36:55 UTC (rev 560)
@@ -2023,7 +2023,9 @@
 
 /* -------------------- Global functions -------------------- */
 
-void display::Init() {
+void display::Init(bool show_fps) {
+    if (show_fps)        // keep ShowFPS on false for screen resolution changes
+        ShowFPS = true;  
     InitModels();
 
     const video::VMInfo *vminfo = video::GetInfo();

Modified: trunk/src/display.hh
===================================================================
--- trunk/src/display.hh	2006-12-31 21:44:41 UTC (rev 559)
+++ trunk/src/display.hh	2007-01-01 20:36:55 UTC (rev 560)
@@ -230,7 +230,7 @@
     void ToggleFlag(DisplayFlags flag);
 
 
-    void Init();
+    void Init(bool show_fps = false);
     void Shutdown();
 
     void            NewWorld (int w, int h);

Modified: trunk/src/main.cc
===================================================================
--- trunk/src/main.cc	2006-12-31 21:44:41 UTC (rev 559)
+++ trunk/src/main.cc	2007-01-01 20:36:55 UTC (rev 560)
@@ -136,7 +136,7 @@
 
         // Variables.
         bool nosound, nomusic, show_help, show_version, do_log, do_assert, force_window;
-        bool dumpinfo, makepreview;
+        bool dumpinfo, makepreview, show_fps;
         string gamename;
         string datapath;
         string preffilename;
@@ -162,7 +162,7 @@
 AP::AP() : ArgParser (app.args.begin(), app.args.end())
 {
     nosound  = nomusic = show_help = show_version = do_log = do_assert = force_window = false;
-    dumpinfo = makepreview = false;
+    dumpinfo = makepreview = show_fps = false;
     gamename = "";
     datapath = "";
     preffilename = PREFFILENAME;
@@ -177,6 +177,7 @@
     def (&do_assert,            "assert");
     def (&dumpinfo,             "dumpinfo");
     def (&makepreview,          "makepreview");
+    def (&show_fps,             "showfps");
     def (&force_window,         "window", 'w');
     def (OPT_GAME,              "game", true);
     def (OPT_DATA,              "data", 'd', true);
@@ -333,7 +334,7 @@
     }
 
     // ----- Load models
-    display::Init();
+    display::Init(ap.show_fps);
 
     // initialize application state
     state = StateManager::instance();

Modified: trunk/src/stones.hh
===================================================================
--- trunk/src/stones.hh	2006-12-31 21:44:41 UTC (rev 559)
+++ trunk/src/stones.hh	2007-01-01 20:36:55 UTC (rev 560)
@@ -30,6 +30,7 @@
         st_FIRST = 0,
         st_none = 0,
 
+        st_borderstone,
         st_black1,
         st_black2,
         st_black3,

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2006-12-31 21:44:41 UTC (rev 559)
+++ trunk/src/world.cc	2007-01-01 20:36:55 UTC (rev 560)
@@ -789,6 +789,7 @@
         c.ignore   = false;
         c.actor    = a;
         c.stonepos = p;
+        c.stoneid  = stone->get_traits().id;
         c.response = stone->collision_response(c);
         c.sound    = stone->collision_sound();
     }
@@ -876,7 +877,7 @@
     ActorInfo &ai          = *a->get_actorinfo();
     double     restitution = 1.0; //0.85;
 
-    if (server::NoCollisions)
+    if (server::NoCollisions && (sc.stoneid != st_borderstone))
         return;
 
     Contact contact (sc.contact_point, sc.normal);

Modified: trunk/src/world.hh
===================================================================
--- trunk/src/world.hh	2006-12-31 21:44:41 UTC (rev 559)
+++ trunk/src/world.hh	2007-01-01 20:36:55 UTC (rev 560)
@@ -81,6 +81,7 @@
         // Variables.
         Actor           *actor;
         GridPos         stonepos;
+        StoneID         stoneid;
         StoneResponse   response;
 
         V2      contact_point;  // Where do the shapes meet? (world coordinates)

Modified: trunk/src/world_internal.hh
===================================================================
--- trunk/src/world_internal.hh	2006-12-31 21:44:41 UTC (rev 559)
+++ trunk/src/world_internal.hh	2007-01-01 20:36:55 UTC (rev 560)
@@ -223,6 +223,12 @@
             BorderStone() : Stone("borderstone") {}
             Stone *clone() { return this; }
             void dispose() {}
+            virtual const StoneTraits &get_traits() const {
+                static StoneTraits border_traits = {
+                        "INVALID", st_borderstone, stf_none, material_stone, 1.0
+                };
+                return border_traits;
+            }
         };
 
         BorderStone borderstone;



From andreasl at mail.berlios.de  Tue Jan  2 14:57:50 2007
From: andreasl at mail.berlios.de (andreasl at BerliOS)
Date: Tue, 2 Jan 2007 14:57:50 +0100
Subject: [Enigma-game-svn] r561 - in branches/1.0: data/levels/enigma_iii src
Message-ID: <200701021357.l02DvoNH013975@sheep.berlios.de>

Author: andreasl
Date: 2007-01-02 14:57:49 +0100 (Tue, 02 Jan 2007)
New Revision: 561

Modified:
   branches/1.0/data/levels/enigma_iii/duffy92_1.xml
   branches/1.0/src/items.cc
Log:
Mini-fixed wormhole-destruction bug:
 - it-wormhole throws an error on attempts to kill a busy wormhole
 - Adapted duffy92 ("Map It Out")


Modified: branches/1.0/data/levels/enigma_iii/duffy92_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_iii/duffy92_1.xml	2007-01-01 20:36:55 UTC (rev 560)
+++ branches/1.0/data/levels/enigma_iii/duffy92_1.xml	2007-01-02 13:57:49 UTC (rev 561)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Map It Out" el:subtitle="" el:id="duffy92"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="2" el:status="released"/>
       <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2004 Jacob Scott</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -16,7 +16,11 @@
       <el:score el:easy="-" el:difficult="-"/>
     </el:info>
     <el:luamain><![CDATA[
-rooms_wide=5
+
+-- Streamlined code and added a sixth room to avoid problems
+-- with the wormhole recursion detection -- Andreas  Jan'06
+
+rooms_wide=6
 rooms_high=1
 
 levelw=1+(19*rooms_wide)
@@ -27,61 +31,72 @@
 
 fill_floor("fl-normal", 0,0,levelw,levelh)
 
+function set_wormhole(x,y,tx,ty)
+    enigma.KillItem(x, y)
+    set_item("it-wormhole", x, y, {strength=0,targetx=tx,targety=ty})
+end
+
 function renderLine( line, pattern)
     for i=1, strlen(pattern) do
         local c = strsub( pattern, i, i)
         if c =="#" then
             set_stone("st-rock6", i-1, line)
         elseif c == "o" then
-           set_stone("st-oxyd", i-1, line,{color="0"})
+            set_stone("st-oxyd", i-1, line,{color="0"})
         elseif c == "*" then
             set_stone( "st-brownie", i-1, line)
-                elseif c == "!" then
+        elseif c == "!" then
             abyss(i-1,line)
         elseif c == "~" then
-           set_floor("fl-water",i-1,line)
+            set_floor("fl-water",i-1,line)
         elseif c=="z" then
-           set_actor("ac-blackball",i-.5,line+.5,{name="b1",player=0})
-           set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="funcc6"})
+            set_actor("ac-blackball",i-.5,line+.5,{name="b1",player=0})
+            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="maintrigger"})
+        elseif c=="Z" then
+            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="maintrigger"})
+        elseif c=="c" then
+            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="calculate_position"})
         elseif c=="y" then
-           set_actor("ac-whiteball", i-1,line+.5, {player=1})
+            set_actor("ac-whiteball", i-1,line+.5, {player=1})
         elseif c == "g" then
             draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
         elseif c=="+" then
             set_stone( "st-wood", i-1, line)
         elseif c=="=" then
-           set_floor("fl-space",i-1,line)
+            set_floor("fl-space",i-1,line)
         elseif c=="A" then
-            set_item("it-wormhole", i-1, line, {strength=0,targetx="10.5",targety="6.5"})
+            set_wormhole(i-1, line, 105.5, 6.5)
+        elseif c=="B" then
+            set_wormhole(i-1, line, 10.5, 6.5)
         elseif c=="a" then
-           set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="funcc5"})
+            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="set_direc",direc=0})
         elseif c=="u" then
-           set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="funcc1"})
+            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="set_direc",direc=1})
         elseif c=="r" then
-           set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="funcc2"})
+            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="set_direc",direc=2})
         elseif c=="d" then
-           set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="funcc3"})
+            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="set_direc",direc=3})
         elseif c=="l" then
-           set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="funcc4"})
+            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="set_direc",direc=4})
         elseif c==" " then
-           set_item("it-trigger",i-1,line,{invisible=1})
-         end
+            set_item("it-trigger",i-1,line,{invisible=1})
+        end
     end    
 end
 
-renderLine(00,"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
-renderLine(01,"!!!!!!!!!###!!!!!!!!!!!!!!!!#o#!!!!!!!!!!!!!!!!###!!!!!!!!!!!!!!!!###!!!!!!!!!!!!!!!!#o#!!!!!!!!")
-renderLine(02,"!!!!!!!!!#A#!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!#A#!!!!!!!!!!!!!!!!#A#!!!!!!!!!!!!!!!!# #!!!!!!!!")
-renderLine(03,"!!!!!!!!!#u#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#a#!!!!!!!!")
-renderLine(04,"!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!")
-renderLine(05,"!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!")
-renderLine(06,"!!!!!#Al aza rA#!!!!!!!!# a aaa a #!!!!!!!!# a aaa a #!!!!!!!!# a aaa a #!!!!!!!!# a aaa a #!!!!")
-renderLine(07,"!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!")
-renderLine(08,"!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!")
-renderLine(09,"!!!!!!!!!#d#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#a#!!!!!!!!")
-renderLine(10,"!!!!!!!!!#A#!!!!!!!!!!!!!!!!#A#!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!#A#!!!!!!!!")
-renderLine(11,"!!!!!!!!!###!!!!!!!!!!!!!!!!###!!!!!!!!!!!!!!!!#o#!!!!!!!!!!!!!!!!#o#!!!!!!!!!!!!!!!!###!!!!!!!!")
-renderLine(12,"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
+renderLine(00,"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
+renderLine(01,"!!!!!!!!!###!!!!!!!!!!!!!!!!#o#!!!!!!!!!!!!!!!!###!!!!!!!!!!!!!!!!###!!!!!!!!!!!!!!!!#o#!!!!!!!!!!!!!!!!###!!!!!!!!")
+renderLine(02,"!!!!!!!!!#A#!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!#A#!!!!!!!!!!!!!!!!#A#!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!#B#!!!!!!!!")
+renderLine(03,"!!!!!!!!!#u#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#u#!!!!!!!!!!!!!!!!#u#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#u#!!!!!!!!")
+renderLine(04,"!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!")
+renderLine(05,"!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!")
+renderLine(06,"!!!!!#Al aza rA#!!!!!!!!# a aca a #!!!!!!!!# a aca a #!!!!!!!!# a aca a #!!!!!!!!# a aca a #!!!!!!!!#Bl aZa rB#!!!!")
+renderLine(07,"!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!!!!!#####a#####!!!!")
+renderLine(08,"!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!")
+renderLine(09,"!!!!!!!!!#d#!!!!!!!!!!!!!!!!#d#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#a#!!!!!!!!!!!!!!!!#d#!!!!!!!!!!!!!!!!#d#!!!!!!!!")
+renderLine(10,"!!!!!!!!!#A#!!!!!!!!!!!!!!!!#A#!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!# #!!!!!!!!!!!!!!!!#A#!!!!!!!!!!!!!!!!#B#!!!!!!!!")
+renderLine(11,"!!!!!!!!!###!!!!!!!!!!!!!!!!###!!!!!!!!!!!!!!!!#o#!!!!!!!!!!!!!!!!#o#!!!!!!!!!!!!!!!!###!!!!!!!!!!!!!!!!###!!!!!!!!")
+renderLine(12,"!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!")
 
  line1= {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1}
  line2= {1,O,1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,1,0,1,1,0,0,0,1,0,1,1,0,1,O,1}
@@ -167,96 +182,46 @@
 width=39
 
 function getval(j,i)
-   return tab[width * (i - 1) + j]
-   end
-
---function setval(j,i, val2)
---   tab[width * (i-1) + j] = val2
---end   
-
-function funcc1()
-direc=1
+    return tab[width * (i - 1) + j]
 end
 
-function funcc2()
-direc=2
+function set_direc(onoff, sender)
+    direc = enigma.GetAttrib(sender, "direc")
 end
 
-function funcc3()
-direc=3
+function calculate_position()
+    if direc==1 then
+        y=y-1
+    elseif direc==2 then
+        x=x+1
+    elseif direc==3 then
+        y=y+1
+    elseif direc==4 then
+        x=x-1
+    end
+    direc=0
 end
 
-function funcc4()
-direc=4
+function maintrigger(onoff, sender)
+    if direc ~= 0 then
+        local dx, dy = enigma.GetPos(sender)
+        dx = dx - 10
+        calculate_position()
+        enigma.KillItem(10 + dx,2)
+        enigma.KillItem(14 + dx,6)
+        enigma.KillItem(10 + dx,10)
+        enigma.KillItem( 6 + dx,6)
+        if getval(x,y-1)==0 then  set_wormhole(10 + dx,  2, 105.5 - dx, 6.5)  end
+        if getval(x+1,y)==0 then  set_wormhole(14 + dx,  6, 105.5 - dx, 6.5)  end
+        if getval(x,y+1)==0 then  set_wormhole(10 + dx, 10, 105.5 - dx, 6.5)  end
+        if getval(x-1,y)==0 then  set_wormhole( 6 + dx,  6, 105.5 - dx, 6.5)  end
+        if x== 2 and y== 3 then  set_wormhole(10 + dx,  2, 29.5, 6.5)  end
+        if x==38 and y==32 then  set_wormhole(10 + dx, 10, 48.5, 6.5)  end
+        if x== 2 and y==32 then  set_wormhole(10 + dx, 10, 67.5, 6.5)  end
+        if x==38 and y== 3 then  set_wormhole(10 + dx,  2, 86.5, 6.5)  end
+    end
 end
 
-function funcc5()
-direc=0
-end
-
-function funcc6()
-if direc==1 then
-y=y-1
-elseif direc==2 then
-x=x+1
-elseif direc==3 then
-y=y+1
-elseif direc==4 then
-x=x-1
-end
-direc=0
-
---value=getval(x,y-1)
-
---set_stone("st-greenbrown",value,1)
-
-   enigma.KillItem(10,2)
-   enigma.KillItem(14,6)
-   enigma.KillItem(10,10)
-   enigma.KillItem(6,6)
-
-if getval(x,y-1)==0 then
-set_item("it-wormhole", 10, 2, {strength=0,targetx="10.5",targety="6.5"})
-else
-end
-
-if getval(x+1,y)==0 then
-set_item("it-wormhole", 14, 6, {strength=0,targetx="10.5",targety="6.5"})
-else
-end
-
-if getval(x,y+1)==0 then
-set_item("it-wormhole", 10, 10, {strength=0,targetx="10.5",targety="6.5"})
-else
-end
-
-if getval(x-1,y)==0 then
-set_item("it-wormhole", 6, 6, {strength=0,targetx="10.5",targety="6.5"})
-else
-end
-
-if x==2 and y==3 then
-   enigma.KillItem(10,2)
-set_item("it-wormhole", 10, 2, {strength=0,targetx="29.5",targety="6.5"})
-end
-
-if x==38 and y==32 then
-   enigma.KillItem(10,10)
-set_item("it-wormhole",10,10, {strength=0,targetx="48.5",targety="6.5"})
-end
-
-if x==2 and y==32 then
-   enigma.KillItem(10,10)
-set_item("it-wormhole",10,10, {strength=0,targetx="67.5",targety="6.5"})
-end
-
-if x==38 and y==3 then
-   enigma.KillItem(10,2)
-set_item("it-wormhole",10,2, {strength=0,targetx="86.5",targety="6.5"})
-end
-
-end
-
 oxyd_shuffle()
     ]]></el:luamain>
     <el:i18n>

Modified: branches/1.0/src/items.cc
===================================================================
--- branches/1.0/src/items.cc	2007-01-01 20:36:55 UTC (rev 560)
+++ branches/1.0/src/items.cc	2007-01-02 13:57:49 UTC (rev 561)
@@ -1695,6 +1695,7 @@
 
     protected:
         virtual ~WormHole() {
+            ASSERT(!justWarping, XLevelRuntime, "Tried to kill a busy wormhole. Please use another way.");
             GameTimer.remove_alarm (this);
         }
     private:



From ral at mail.berlios.de  Wed Jan  3 23:11:55 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Wed, 3 Jan 2007 23:11:55 +0100
Subject: [Enigma-game-svn] r563 - in branches/1.0/src: gui lev
Message-ID: <200701032211.l03MBtcP022959@sheep.berlios.de>

Author: ral
Date: 2007-01-03 23:11:55 +0100 (Wed, 03 Jan 2007)
New Revision: 563

Modified:
   branches/1.0/src/gui/OptionsMenu.cc
   branches/1.0/src/lev/ScoreManager.cc
   branches/1.0/src/lev/ScoreManager.hh
Log:
Fixes:
- ensure save of enigma.score after Username and Userpath changes
- limit 0.92 scores to SCORE_MAX that fit into a XML short


Modified: branches/1.0/src/gui/OptionsMenu.cc
===================================================================
--- branches/1.0/src/gui/OptionsMenu.cc	2007-01-03 21:04:23 UTC (rev 562)
+++ branches/1.0/src/gui/OptionsMenu.cc	2007-01-03 22:11:55 UTC (rev 563)
@@ -20,6 +20,7 @@
 #include "gui/OptionsMenu.hh"
 #include "ecl.hh"
 #include "enigma.hh"
+#include "lev/ScoreManager.hh"
 #include "LocalToXML.hh"
 #include "main.hh"
 #include "nls.hh"
@@ -364,8 +365,6 @@
         leftlabels.add (new Label(N_("Video mode: "), HALIGN_RIGHT));
         leftlabels.add (new Label(N_("Gamma correction: "), HALIGN_RIGHT));
         leftlabels.add (new Label(N_("Mouse speed: "), HALIGN_RIGHT));
-//        leftlabels.add (new Label(N_("Skip solved levels: "), HALIGN_RIGHT));
-//        leftlabels.add (new Label(N_("Time hunt: "), HALIGN_RIGHT));
     
         language = new LanguageButton(this);
         left.add (language);
@@ -373,8 +372,6 @@
         left.add (new VideoModeButton);
         left.add (new GammaButton);
         left.add (new MouseSpeedButton);
-//        left.add (new SkipSolvedButton);
-//        left.add (new TimeHuntButton);
     
         rightlabels.add (new Label(N_("Sound volume: "), HALIGN_RIGHT));
         rightlabels.add (new Label(N_("Sound set: "), HALIGN_RIGHT));
@@ -429,8 +426,14 @@
 //    }
     
     void OptionsMenu::quit() {
+        std::string tfUserPathLocal = XMLtoLocal(Utf8ToXML(userPathTF->getText().c_str()).x_str()).c_str(); 
+        if ((app.state->getString("UserName") != userNameTF->getText())
+                || (app.userPath != tfUserPathLocal)) {
+            // ensure that enigma.score is saved with new Username or to new location
+            lev::ScoreManager::instance()->markModified();
+        }
         app.state->setProperty("UserName", userNameTF->getText());
-        app.setUserPath(XMLtoLocal(Utf8ToXML(userPathTF->getText().c_str()).x_str()).c_str());
+        app.setUserPath(tfUserPathLocal.c_str());
         app.setUserImagePath(XMLtoLocal(Utf8ToXML(userImagePathTF->getText().c_str()).x_str()).c_str());
         Menu::quit();
     }

Modified: branches/1.0/src/lev/ScoreManager.cc
===================================================================
--- branches/1.0/src/lev/ScoreManager.cc	2007-01-03 21:04:23 UTC (rev 562)
+++ branches/1.0/src/lev/ScoreManager.cc	2007-01-03 22:11:55 UTC (rev 563)
@@ -265,6 +265,10 @@
             shutdown();
     }
 
+    void ScoreManager::markModified() {
+        isModified = true;
+    }
+    
     void ScoreManager::finishUserId(unsigned id3) {
         unsigned i1, i2, i3, i4; 
         std::istringstream s1(userId.substr(0, 4));
@@ -887,6 +891,12 @@
                     bool solvedEasy = (levelstat.finished & DIFFICULTY_EASY) &&
                             easyScore != SCORE_UNSOLVED;
                     
+                    // limit scores to 99*60+59 - they need to fit in a short for XML
+                    if (diffScore > SCORE_MAX)
+                        diffScore = SCORE_MAX;
+                    if (easyScore > SCORE_MAX)
+                        easyScore = SCORE_MAX;
+                    
                     std::map<std::string,  DOMElement *>::iterator itx;
                     // do we have to update a score entry for a higher version ?
                     itx = curLevelScores.find(*it);

Modified: branches/1.0/src/lev/ScoreManager.hh
===================================================================
--- branches/1.0/src/lev/ScoreManager.hh	2007-01-03 21:04:23 UTC (rev 562)
+++ branches/1.0/src/lev/ScoreManager.hh	2007-01-03 22:11:55 UTC (rev 563)
@@ -51,6 +51,7 @@
     public:
         static ScoreManager *instance();
         ~ScoreManager();
+        void markModified();
         virtual bool save();
         void shutdown();
 



From ral at mail.berlios.de  Wed Jan  3 23:17:14 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Wed, 3 Jan 2007 23:17:14 +0100
Subject: [Enigma-game-svn] r564 - trunk/src
Message-ID: <200701032217.l03MHEBZ024142@sheep.berlios.de>

Author: ral
Date: 2007-01-03 23:17:13 +0100 (Wed, 03 Jan 2007)
New Revision: 564

Modified:
   trunk/src/display.cc
Log:
Performance tuning V:
- speedup sprite display by 25% via coalescing grids
- prepare next tuning step by drawing sprites vertically from left to right
Note:
- sprite shadows draw is not yet optimized
- in total the draw speeds up about 10%


Modified: trunk/src/display.cc
===================================================================
--- trunk/src/display.cc	2007-01-03 22:11:55 UTC (rev 563)
+++ trunk/src/display.cc	2007-01-03 22:17:13 UTC (rev 564)
@@ -616,17 +616,23 @@
 
     int x2 = wa.x+wa.w;
     int y2 = wa.y+wa.h;
+    int y2m1 = y2 - 1;
 
     clip(gc, get_area());
-    int xpos0, ypos;
-    world_to_screen (V2(wa.x, wa.y), &xpos0, &ypos);
+    int xpos, ypos0;
+    world_to_screen (V2(wa.x, wa.y), &xpos, &ypos0);
 
     l->prepare_draw (wa);
-    for (int y=wa.y; y<y2; y++, ypos += m_tileh) {
-        int xpos = xpos0;
-        for (int x=wa.x; x<x2; x++, xpos += m_tilew) {
+    for (int x=wa.x; x<x2; x++, xpos += m_tilew) {
+        int ypos = ypos0;
+        for (int y=wa.y; y<y2; y++, ypos += m_tileh) {
             if (m_redrawp(x,y) == 1)
-                l->draw (gc, WorldArea(x,y,1,1), xpos, ypos);
+                if (y<y2m1 && m_redrawp(x,y+1) == 1) {
+                    l->draw (gc, WorldArea(x,y,1,2), xpos, ypos);
+                    y++;
+                    ypos += m_tileh;
+                } else
+                    l->draw (gc, WorldArea(x,y,1,1), xpos, ypos);
         }
     }
     l->draw_onepass (gc);



From R.Lamprecht at T-Online.de  Wed Jan  3 23:23:23 2007
From: R.Lamprecht at T-Online.de (Ronald Lamprecht)
Date: Wed, 03 Jan 2007 23:23:23 +0100
Subject: [Enigma-game-svn] r562 - branches/1.0/data
Message-ID: <459C2CDB.8020306@T-Online.de>

As the patch is too large the commit message as a short manual notification:

- monthly ratings.xml update

Ronald



From ral at mail.berlios.de  Thu Jan  4 22:05:51 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Thu, 4 Jan 2007 22:05:51 +0100
Subject: [Enigma-game-svn] r565 - in branches/1.0/src: . lev
Message-ID: <200701042105.l04L5pDq024878@sheep.berlios.de>

Author: ral
Date: 2007-01-04 22:05:50 +0100 (Thu, 04 Jan 2007)
New Revision: 565

Modified:
   branches/1.0/src/lev/Proxy.cc
   branches/1.0/src/server.cc
   branches/1.0/src/server.hh
Log:
Fixes:
- set engine compatibility on first load of a level correctly to values besides
  "enigma" ("Prepare your Defense" bug)


Modified: branches/1.0/src/lev/Proxy.cc
===================================================================
--- branches/1.0/src/lev/Proxy.cc	2007-01-03 22:17:13 UTC (rev 564)
+++ branches/1.0/src/lev/Proxy.cc	2007-01-04 21:05:50 UTC (rev 565)
@@ -25,6 +25,7 @@
 #include "main.hh"
 #include "nls.hh"
 #include "oxyd_internal.hh"
+#include "server.hh"
 #include "utilXML.hh"
 #include "Utf8ToXML.hh"
 #include "XMLtoUtf8.hh"
@@ -613,6 +614,7 @@
         if (getEnigmaCompatibility() > ENIGMACOMPATIBITLITY)
             throw XLevelLoading(ecl::strf("Level is incompatible: %s requires Enigma %.2f or above", 
                     absLevelPath.c_str(), getEnigmaCompatibility()));
+        server::SetCompatibility(this);
         processDependencies();
         loadLuaCode();
     }

Modified: branches/1.0/src/server.cc
===================================================================
--- branches/1.0/src/server.cc	2007-01-03 22:17:13 UTC (rev 564)
+++ branches/1.0/src/server.cc	2007-01-04 21:05:50 UTC (rev 565)
@@ -118,19 +118,11 @@
     server::PrepareLevel();
 
     try {
-        // first set default compatibility mode
-        // (may be overidden by load_level (from Lua))
-        server::GameCompatibility = levelProxy->getEngineCompatibility();
-        if (server::GameCompatibility == GAMET_UNKNOWN)
-            // use default Comopatibility
-            // server::GameCompatibility = GAMET_ENIGMA;
-            throw XLevelLoading("unknown engine compatibility");
-        
         // clear inventory before level load and give us 2 extralives
         player::NewGame(isRestart);
 
-        levelProxy->loadLevel();
-//            server::CurrentLevel = static_cast<unsigned> (ilevel);
+        levelProxy->loadLevel();  // sets the compatibility mode
+
         game::ResetGameTimer();
 
         world::InitWorld();
@@ -563,6 +555,11 @@
     GameCompatibility = type;
 }
 
+void server::SetCompatibility(lev::Proxy *levelProxy) {
+    server::GameCompatibility = levelProxy->getEngineCompatibility();
+    if (server::GameCompatibility == GAMET_UNKNOWN)
+        throw XLevelLoading("unknown engine compatibility");
+}
 
 enigma::Difficulty server::GetDifficulty()
 {

Modified: branches/1.0/src/server.hh
===================================================================
--- branches/1.0/src/server.hh	2007-01-03 22:17:13 UTC (rev 564)
+++ branches/1.0/src/server.hh	2007-01-04 21:05:50 UTC (rev 565)
@@ -128,7 +128,8 @@
     void FinishLevel();
 
     void SetCompatibility(const char *version); // set compatibility (from lua)
-
+    void SetCompatibility(lev::Proxy *levelProxy); // set compatibility from xml
+    
     enigma::Difficulty GetDifficulty();
 
     // move counter



From ral at mail.berlios.de  Fri Jan  5 00:11:04 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Fri, 5 Jan 2007 00:11:04 +0100
Subject: [Enigma-game-svn] r566 - trunk/src
Message-ID: <200701042311.l04NB4n4012633@sheep.berlios.de>

Author: ral
Date: 2007-01-05 00:11:03 +0100 (Fri, 05 Jan 2007)
New Revision: 566

Modified:
   trunk/src/d_engine.hh
   trunk/src/display.cc
Log:
Performance tuning VI:
- speedup sprite display by a factor of 4 - 7 by keeping them partially sorted
Note:
- sprite shadow draw is even more improved
- the n^2 dependency is substituted by a worst case n^(3/2) algorithm 
- wolf among 186 sheep is playable on a 2.6 GHz Pentium with 25 - 60 fps
  (we started with 1 - 2 fps)
- this patch is not yet cleaned up - the sprites are drawn in a unstable order,
  jumping marbles may switch from frame to frame in stack sequence


Modified: trunk/src/d_engine.hh
===================================================================
--- trunk/src/d_engine.hh	2007-01-04 21:05:50 UTC (rev 565)
+++ trunk/src/d_engine.hh	2007-01-04 23:11:03 UTC (rev 566)
@@ -198,11 +198,15 @@
         SpriteLayer  layer;
         bool         visible;
         bool         mayNeedRedraw;
+        Sprite *     above[3];
+        Sprite *     beneath[3];
 
         Sprite (const V2 & p, SpriteLayer l, Model *m)
         : model(m), pos(p), layer(l), visible(true), mayNeedRedraw(false)
         {
             screenpos[0] = screenpos[1] = 0;
+            above[0] = above[1] = above[2] = NULL;
+            beneath[0] = beneath[1] = beneath[2] = NULL;
         }
         ~Sprite() { delete model; }
     };
@@ -225,8 +229,8 @@
         void move_sprite (SpriteId, const ecl::V2& newpos);
         void replace_sprite (SpriteId id, Model *m);
 
-        void redraw_sprite_region (SpriteId id);
-        void draw_sprites (bool shades, ecl::GC &gc);
+        void redraw_sprite_region (SpriteId id, bool is_add);
+        void draw_sprites (bool shades, ecl::GC &gc, const WorldArea &a);
 
         Model *get_model (SpriteId id) { return sprites[id]->model; }
 
@@ -236,6 +240,7 @@
 
         static const SpriteId MAGIC_SPRITEID = 1000000;
         SpriteList sprites;
+        SpriteList bottomSprites; // bottom sprite for each x
 
     private:
         // ModelLayer interface

Modified: trunk/src/display.cc
===================================================================
--- trunk/src/display.cc	2007-01-04 21:05:50 UTC (rev 565)
+++ trunk/src/display.cc	2007-01-04 23:11:03 UTC (rev 566)
@@ -878,6 +878,8 @@
     ModelLayer::new_world (w,h);
     delete_sequence (sprites.begin(), sprites.end());
     sprites.clear();
+    Sprite *dummy = NULL;
+    bottomSprites.assign(w, dummy);
     numsprites = 0;
 }
 
@@ -890,13 +892,13 @@
 
     if (newx != sprite->screenpos[0] || newy != sprite->screenpos[1] ||
             sprite->mayNeedRedraw ) {
-        redraw_sprite_region(id); // make sure old sprite is removed
+        redraw_sprite_region(id, false); // make sure old sprite is removed
         sprite->pos = newpos;
         sprite->screenpos[0] = newx;
         sprite->screenpos[1] = newy;
         if (Anim2d* anim = dynamic_cast<Anim2d*>(sprite->model))
             anim->move (newx, newy);
-        redraw_sprite_region(id); // draw new sprite
+        redraw_sprite_region(id, true); // draw new sprite
     }
 }
 
@@ -923,7 +925,7 @@
     get_engine()->world_to_video (sprite->pos, &sprite->screenpos[0], &sprite->screenpos[1]);
     if (Model *m = sprite->model)
         m->expose (this, sprite->screenpos[0], sprite->screenpos[1]);
-    redraw_sprite_region(id);
+    redraw_sprite_region(id, true);
     numsprites += 1;
     return id;
 }
@@ -931,20 +933,20 @@
 void DL_Sprites::replace_sprite (SpriteId id, Model *m) {
     Sprite *sprite = sprites[id];
     if (Model *old = sprite->model) {
-        redraw_sprite_region(id);
+        redraw_sprite_region(id, false);
         old->remove (this);
         delete old;
     }
     sprite->model = m;
     if (m) {
         m->expose (this, sprite->screenpos[0], sprite->screenpos[1]);
-        redraw_sprite_region(id);
+        redraw_sprite_region(id, true);
     }
 }
 
 void DL_Sprites::kill_sprite (SpriteId id) {
     if (Sprite *sprite = sprites[id]) {
-        redraw_sprite_region(id);
+        redraw_sprite_region(id, false);
         if (Model *m = sprite->model) {
             m->remove (this);
         }
@@ -958,22 +960,28 @@
 {
     DisplayEngine *engine = get_engine();
     clip (gc, intersect (engine->get_area(), engine->world_to_screen(a)));
-    draw_sprites (false, gc);
+    draw_sprites (false, gc, a);
 }
 
 
-void DL_Sprites::draw_sprites (bool drawshadowp, GC &gc) {
+void DL_Sprites::draw_sprites (bool drawshadowp, GC &gc, const WorldArea &a) {
     SpriteList &sl = sprites;
 
-    for (unsigned i=0, sl_size=sl.size() ; i<sl_size; ++i) {
-        Sprite *s = sl[i];
-        if (s && s->model && s->visible) {
-            int sx, sy;
-            get_engine()->world_to_screen(s->pos, &sx, &sy);
-            if (drawshadowp)
-                s->model->draw_shadow(gc, sx, sy);
-            else
-                s->model->draw(gc, sx, sy);
+//    for (unsigned i=0, sl_size=sl.size() ; i<sl_size; ++i) {
+//        Sprite *s = sl[i];
+    int gx = a.x;
+    for (int i = 0; i < a.w; i++, gx++) {
+        int m = gx%3;
+        Sprite *s = bottomSprites[gx];
+        for ( ; s != NULL; s = s->above[m]) {
+            if (s && s->model && s->visible) {
+                int sx, sy;
+                get_engine()->world_to_screen(s->pos, &sx, &sy);
+                if (drawshadowp)
+                    s->model->draw_shadow(gc, sx, sy);
+                else
+                    s->model->draw(gc, sx, sy);
+            }
         }
     }
 }
@@ -983,7 +991,7 @@
 //     draw_sprites (false, gc);
 }
 
-void DL_Sprites::redraw_sprite_region (SpriteId id) 
+void DL_Sprites::redraw_sprite_region (SpriteId id, bool is_add) 
 {
     Sprite *s = sprites[id];
     if (s && s->model) {
@@ -994,6 +1002,33 @@
         DisplayEngine *e = get_engine();
         e->video_to_world (r, redrawr);
         e->mark_redraw_area (redrawr);
+        
+        int x = redrawr.x;
+        for (int i = 0; i < redrawr.w; i++, x++) {
+            if (x >= 0 && x < e->get_width()) {
+                int m = x%3;
+                if (is_add) {
+                    if (bottomSprites[x] != NULL)
+                        bottomSprites[x]->beneath[m] = s;
+                    s->above[m] = bottomSprites[x];
+                    s->beneath[m] = NULL;
+                    bottomSprites[x] = s;
+                } else {  // remove
+                    if (bottomSprites[x] == s) {
+                        bottomSprites[x] = s->above[m];
+                        if (s->above[m] != NULL)
+                            s->above[m]->beneath[m] = NULL;
+                    } else {
+                        if (s->above[m] != NULL) {
+                            s->above[m]->beneath[m] = s->beneath[m];
+                        }
+                        if (s->beneath[m] != NULL) {
+                            s->beneath[m]->above[m] = s->above[m];
+                        }
+                    }
+                }           
+            }
+        }
     }
 }
 
@@ -1522,14 +1557,20 @@
                 set_color (gc2, 255, 255, 255);
                 box (gc2, buffer->size());
             }
-            for (unsigned i=0; i<m_sprites->sprites.size(); ++i) {
-                if (Sprite *sp = m_sprites->sprites[i]) {
+            
+//            for (unsigned i=0; i<m_sprites->sprites.size(); ++i) {
+//                if (Sprite *sp = m_sprites->sprites[i]) {
+//                    
+            int m = x%3;
+            Sprite *sp = m_sprites->bottomSprites[x];
+            for ( ; sp != NULL; sp = sp->above[m]) {
+                            
                     if (sp->visible && sp->model) {
                         int sx = round_nearest<int>(sp->pos[0]*tilew) - x*tilew;
                         int sy = round_nearest<int>(sp->pos[1]*tileh) - y*tileh;
                         sp->model->draw_shadow(gc2, sx, sy);
                     }
-                }
+//                }
             }
             blit(gc, xpos, ypos, buffer);
         }



From raoul at mail.berlios.de  Sat Jan  6 17:42:02 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 6 Jan 2007 17:42:02 +0100
Subject: [Enigma-game-svn] r567 - in branches/1.0/data/levels: enigma_cross
	enigma_i enigma_iii enigma_iv enigma_tutorial enigma_v enigma_vi
Message-ID: <200701061642.l06Gg2gC004552@sheep.berlios.de>

Author: raoul
Date: 2007-01-06 17:42:00 +0100 (Sat, 06 Jan 2007)
New Revision: 567

Added:
   branches/1.0/data/levels/enigma_i/martin88_2.xml
   branches/1.0/data/levels/enigma_iii/duffy20_2.xml
   branches/1.0/data/levels/enigma_iv/duffy73_2.xml
   branches/1.0/data/levels/enigma_v/just05_2.xml
Removed:
   branches/1.0/data/levels/enigma_i/martin88_1.xml
   branches/1.0/data/levels/enigma_iii/duffy20_1.xml
   branches/1.0/data/levels/enigma_iv/duffy73_1.xml
   branches/1.0/data/levels/enigma_v/just05_1.xml
Modified:
   branches/1.0/data/levels/enigma_cross/enigma0_92_1.xml
   branches/1.0/data/levels/enigma_cross/enigma0_92_2.xml
   branches/1.0/data/levels/enigma_cross/newlevels.xml
   branches/1.0/data/levels/enigma_i/index.xml
   branches/1.0/data/levels/enigma_i/raoul04_1.xml
   branches/1.0/data/levels/enigma_i/siegfried35_1.xml
   branches/1.0/data/levels/enigma_iii/index.xml
   branches/1.0/data/levels/enigma_iii/luc09_1.xml
   branches/1.0/data/levels/enigma_iv/index.xml
   branches/1.0/data/levels/enigma_tutorial/index.xml
   branches/1.0/data/levels/enigma_v/index.xml
   branches/1.0/data/levels/enigma_v/qq02_1.xml
   branches/1.0/data/levels/enigma_vi/index.xml
   branches/1.0/data/levels/enigma_vi/malla03_1.xml
   branches/1.0/data/levels/enigma_vi/raoul20_1.xml
Log:
-> Many smaller levelbugfixes


Modified: branches/1.0/data/levels/enigma_cross/enigma0_92_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_cross/enigma0_92_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_cross/enigma0_92_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -80,11 +80,11 @@
     <level _seq="72" _title="A Narrow Path" _xpath="enigma_i/martin66_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin66" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="73" _title="MetaPuzzle" _xpath="enigma_iv/ant03_1" author="Petr Machata" ctrl="force" easy="false" id="ant03" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="74" _title="Space Tubes" _xpath="enigma_i/duffy13_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy13" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="75" _title="The Cage" _xpath="enigma_v/qq02_1" author="Andrzej Szombierski" ctrl="force" easy="false" id="qq2" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="75" _title="The Cage" _xpath="enigma_v/qq02_1" author="Andrzej Szombierski" ctrl="force" easy="false" id="qq2" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="76" _title="Sentinels" _xpath="enigma_ii/siegfried23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8d" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="77" _title="The Tomb" _xpath="enigma_iv/ant04_1" author="Petr Machata" ctrl="force" easy="false" id="ant04" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="78" _title="Desert Ruins" _xpath="enigma_i/nat32_1" author="Nat Pryce" ctrl="force" easy="false" id="natmaze1" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="79" _title="- Meditation -" _xpath="enigma_i/siegfried35_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation14" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="79" _title="- Meditation -" _xpath="enigma_i/siegfried35_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation14" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="80" _title="Black Lava" _xpath="enigma_i/ant12_1" author="Petr Machata" ctrl="force" easy="false" id="ant12" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="81" _title="Flood Gates" _xpath="enigma_iv/nat08_1" author="Nat Pryce" ctrl="force" easy="false" id="nat8" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="82" _title="Balancing Act" _xpath="enigma_i/nat09_1" author="Nat Pryce" ctrl="force" easy="false" id="nat9" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_cross/enigma0_92_2.xml
===================================================================
--- branches/1.0/data/levels/enigma_cross/enigma0_92_2.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_cross/enigma0_92_2.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -69,11 +69,11 @@
     <level _seq="61" _title="Island of Safety" _xpath="enigma_v/duffy27_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy27" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="62" _title="TNT Shortage?" _xpath="enigma_iv/siegfried74_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried74" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="63" _title="Tunnels" _xpath="enigma_iv/martin82_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin82" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="64" _title="Growing The Doors" _xpath="enigma_i/martin88_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin88" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="64" _title="Growing The Doors" _xpath="enigma_i/martin88_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin88" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="65" _title="Doors Galore" _xpath="enigma_iv/raywick01_1" author="Ray Wick" ctrl="force" easy="false" id="RayWick001" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="66" _title="Time is Money" _xpath="enigma_i/nat11_2" author="Nat Pryce" ctrl="force" easy="false" id="nat11" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="67" _title="What's the Problem?" _xpath="enigma_iv/ss14_1" author="Sven Siggelkow" ctrl="force" easy="true" id="ss14" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="68" _title="Family Business" _xpath="enigma_iii/duffy20_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy20" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="68" _title="Family Business" _xpath="enigma_iii/duffy20_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy20" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="69" _title="Stay There!" _xpath="enigma_iv/ralf05_2" author="Ralf Westram" ctrl="force" easy="false" id="ralf05" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="70" _title="Block the Way" _xpath="enigma_iv/raywick03_1" author="Ray Wick" ctrl="force" easy="false" id="RayWick003" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="71" _title=".c.R.e.A.z.Y.w.O.r.L.d." _xpath="enigma_iv/martin100_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin100" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -153,7 +153,7 @@
     <level _seq="145" _title="Build Up and Tear Down" _xpath="enigma_v/duffy70_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy70" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="146" _title="Don't Be Greedy" _xpath="enigma_v/duffy71_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy71" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="147" _title="Where Am I?" _xpath="enigma_iv/duffy72_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy72" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="148" _title="Bizarro World" _xpath="enigma_iv/duffy73_1" author="Jacob Scott" ctrl="force" easy="true" id="duffy73" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="148" _title="Bizarro World" _xpath="enigma_iv/duffy73_2" author="Jacob Scott" ctrl="force" easy="true" id="duffy73" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="149" _title="Solvable?" _xpath="enigma_v/barry01_2" author="Barry &amp; Lori Mead" ctrl="force" easy="false" id="barry01" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="150" _title="Where is it?" _xpath="enigma_iv/barry02_1" author="Barry &amp; Lori Mead" ctrl="force" easy="false" id="barry02" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="151" _title="Tool Time" _xpath="enigma_ii/barry03_1" author="Barry &amp; Lori Mead" ctrl="force" easy="false" id="barry03" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_cross/newlevels.xml
===================================================================
--- branches/1.0/data/levels/enigma_cross/newlevels.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_cross/newlevels.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -29,7 +29,7 @@
     <level _seq="21" _title="Formentera!" _xpath="enigma_i/luc06_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc06" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="22" _title="Floppy Floors" _xpath="enigma_i/andreas24_1" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas24" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="23" _title="Balance" _xpath="enigma_i/erich01_1" author="Erich Schubert" ctrl="force" easy="false" id="balance" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="24" _title="- Meditation -" _xpath="enigma_i/raoul04_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul04" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="24" _title="- Meditation -" _xpath="enigma_i/raoul04_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul04" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="25" _title="Enignimm" _xpath="enigma_ii/alain02_1" author="Alain Busser" ctrl="force" easy="false" id="alain02" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="26" _title="One Way Ticket" _xpath="enigma_ii/luc25_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc25" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="27" _title="- Meditation -" _xpath="enigma_ii/andreas17_1" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas17" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -54,7 +54,7 @@
     <level _seq="46" _title="Shifting Shoals" _xpath="enigma_ii/nat28_1" author="Nat Pryce" ctrl="force" easy="false" id="nat28" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="47" _title="Dirt Clod" _xpath="enigma_ii/xerxes02_1" author="Xerxes M. Dynatos" ctrl="force" easy="false" id="xerxes02" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="48" _title="Friend or Foe?" _xpath="enigma_ii/andreas05_1" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas05" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="49" _title="Teamplay Doors" _xpath="enigma_iii/luc09_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc09" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="49" _title="Teamplay Doors" _xpath="enigma_iii/luc09_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc09" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="50" _title="Deadend" _xpath="enigma_iii/daniel07_1" author="Daniel Heck" ctrl="force" easy="false" id="deadend" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="51" _title="Coloured Doors" _xpath="enigma_iii/luc03_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc03" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="52" _title="deja-vu" _xpath="enigma_iii/illmind09_1" author="illmind" ctrl="force" easy="false" id="illmind09" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -124,7 +124,7 @@
     <level _seq="116" _title="Venice I" _xpath="enigma_v/raoul16_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul16" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="117" _title="No way out?" _xpath="enigma_v/just08_1" author="JuSt" ctrl="force" easy="false" id="just08" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="118" _title="Venice II" _xpath="enigma_v/raoul17_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul17" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="119" _title="Walking around" _xpath="enigma_v/just05_1" author="JuSt" ctrl="force" easy="false" id="just05" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="119" _title="Walking around" _xpath="enigma_v/just05_2" author="JuSt" ctrl="force" easy="false" id="just05" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="120" _title="Trigger Happy" _xpath="enigma_v/xerxes03_1" author="Xerxes M. Dynatos" ctrl="force" easy="false" id="xerxes03" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="121" _title="Gods of Enigma" _xpath="enigma_v/mp01_1" author="moonpearl" ctrl="force" easy="false" id="mp01" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="122" _title="Gods of Enigma II" _xpath="enigma_v/mp02_1" author="moonpearl" ctrl="force" easy="false" id="mp02" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -176,7 +176,7 @@
     <level _seq="168" _title="Pool with a pole" _xpath="enigma_vi/alain28_1" author="Alain Busser" ctrl="force" easy="false" id="alain28" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="169" _title="Jump into Meditation" _xpath="enigma_vi/ral07_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060525ral009" rel="1" rev="42" score="1" target="time" unit="duration"/>
     <level _seq="170" _title="- Meditation -" _xpath="enigma_vi/raoul18_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul18" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="171" _title="Step gently!" _xpath="enigma_vi/malla03_1" author="Manuel K?nig" ctrl="force" easy="false" id="malla03" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="171" _title="Step gently!" _xpath="enigma_vi/malla03_1" author="Manuel K?nig" ctrl="force" easy="false" id="malla03" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="172" _title="Houdini" _xpath="enigma_vi/ral11_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060816ral719" rel="1" rev="45" score="1" target="time" unit="duration"/>
     <level _seq="173" _title="Persecution Mania" _xpath="enigma_vi/ral12_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060911ral294" rel="1" rev="34" score="1" target="time" unit="duration"/>
     <level _seq="174" _title="The Aztec Temple" _xpath="enigma_vi/zogga01_1" author="Dominik Lehmann" ctrl="force" easy="true" id="zogga01" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_i/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_i/index.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_i/index.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -65,7 +65,7 @@
     <level _seq="57" _title="Light Switches" _xpath="./martin08_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin08" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="58" _title="Islands" _xpath="./duffy10_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy10" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="59" _title="Simon Says" _xpath="./nat12_1" author="Nat Pryce" ctrl="force" easy="false" id="nat12" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="60" _title="- Meditation -" _xpath="./siegfried35_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation14" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="60" _title="- Meditation -" _xpath="./siegfried35_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation14" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="61" _title="Feel Your Way" _xpath="./siegfried06_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level3a" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="62" _title="Good Luck!" _xpath="./siegfried08_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level3d" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="63" _title="Tubes" _xpath="./siegfried09_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level3e" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -95,11 +95,11 @@
     <level _seq="87" _title="Space Tubes" _xpath="./duffy13_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy13" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="88" _title="Balance" _xpath="./erich01_1" author="Erich Schubert" ctrl="force" easy="false" id="balance" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="89" _title="More Space Tubes" _xpath="./duffy33_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy33" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="90" _title="- Meditation -" _xpath="./raoul04_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul04" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="90" _title="- Meditation -" _xpath="./raoul04_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul04" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="91" _title="Civil Engineer" _xpath="./duffy122_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy122" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="92" _title="Security Guards" _xpath="./duffy108_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy108" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="93" _title="Time is Money" _xpath="./nat11_2" author="Nat Pryce" ctrl="force" easy="false" id="nat11" rel="2" rev="0" score="2" target="time" unit="duration"/>
-    <level _seq="94" _title="Growing The Doors" _xpath="./martin88_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin88" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="94" _title="Growing The Doors" _xpath="./martin88_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin88" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="95" _title="Impulsive" _xpath="./ant13_1" author="Petr Machata" ctrl="force" easy="false" id="ant13" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="96" _title="Jump!" _xpath="./duffy07_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy7" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="97" _title="Hit the Right One" _xpath="./martin77_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin77" rel="1" rev="0" score="1" target="time" unit="duration"/>

Deleted: branches/1.0/data/levels/enigma_i/martin88_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_i/martin88_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_i/martin88_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -1,114 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Growing The Doors" el:subtitle="" el:id="martin88"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Martin Hawlisch" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Martin Hawlisch</el:copyright>
-      <el:license el:type="GPL version 2" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-levelw = 20
-levelh = 13
-
-create_world(levelw, levelh)
-fill_floor("fl-rough")
-
-oxyd_default_flavor = "b"
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-      local c = strsub( pattern, i, i)
-      if c =="#" then
-         set_stone("st-door_b",i-1,line,{type="v"})
-      elseif c == "~" then
-         set_stone("st-door_b",i-1,line,{type="v"})
-      elseif c == "O" then
-         oxyd( i-1, line)
-      elseif c == "+" then
-         set_stone("st-shogun-s",i-1,line)
-      elseif c == " " then
-         set_floor("fl-sand", i-1, line)
-      end
-    end
-end
-
-set_stone("st-door_b", 1,7, {type="v", name="door1"})
-set_stone("st-door_b", 6,9, {type="v", name="door2"})
-set_stone("st-door_b",14,7, {type="v", name="door3"})
-set_stone("st-door_b",11,4, {type="v", name="door4"})
-
-set_stone("st-door_b", 8,2, {type="v", name="floor8"})
-set_stone("st-door_b", 8,3, {type="v", name="floor11"})
-set_stone("st-door_b", 8,4, {type="v", name="floor15"})
-set_stone("st-door_b", 8,5, {type="v", name="floor5"})
-set_stone("st-door_b", 8,6, {type="v", name="floor10"})
-set_stone("st-door_b", 8,7, {type="v", name="floor14"})
-set_stone("st-door_b", 9,7, {type="v", name="floor3"})
-set_stone("st-door_b",10,7, {type="v", name="floor9"})
-set_stone("st-door_b",10,6, {type="v", name="floor13"})
-set_stone("st-door_b",10,5, {type="v", name="floor16"})
-set_stone("st-door_b",10,4, {type="v", name="floor7"})
-set_stone("st-door_b",10,3, {type="v", name="floor12"})
-set_stone("st-door_b", 9,10, {type="v", name="floor1"})
-set_stone("st-door_b", 8,10, {type="v", name="floor2"})
-set_stone("st-door_b", 7,10, {type="v", name="floor4"})
-set_stone("st-door_b", 7, 9, {type="v", name="floor6"})
-
-shogundot1( 2, 2, {target="door1", action="openclose"})
-shogundot1( 2, 1, {target="floor1", action="openclose"})
-shogundot1( 4, 1, {target="floor2", action="openclose"})
-shogundot1( 5, 1, {target="floor3", action="openclose"})
-shogundot1( 5, 2, {target="floor4", action="openclose"})
-
-shogundot1( 1,11, {target="floor5", action="openclose"})
-shogundot1( 2,11, {target="floor6", action="openclose"})
-shogundot1( 3,11, {target="door2", action="openclose"})
-shogundot1( 4,11, {target="floor7", action="openclose"})
-
-shogundot1(16,10, {target="floor8", action="openclose"})
-shogundot1(16,11, {target="floor9", action="openclose"})
-shogundot1(17,11, {target="floor10", action="openclose"})
-shogundot1(18,11, {target="door3", action="openclose"})
-shogundot1(18,10, {target="floor11", action="openclose"})
-
-shogundot1(14,3, {target="floor12", action="openclose"})
-shogundot1(14,4, {target="floor13", action="openclose"})
-shogundot1(15,3, {target="floor14", action="openclose"})
-shogundot1(15,4, {target="floor15", action="openclose"})
-shogundot1(16,3, {target="door4", action="openclose"})
-shogundot1(16,4, {target="floor16", action="openclose"})
-
-renderLine( 0, "~######~~~~~~~#####~")
-renderLine( 1, "~#----#~O~~####---##")
-renderLine( 2, "~#--+-#O O~#-+-+---#")
-renderLine( 3, "###--+## ~~#-#-+-#-#")
-renderLine( 4, "#-+--+-# ~  -#-+-#-#")
-renderLine( 5, "#-#+##-# ~ #---+-+-#")
-renderLine( 6, "#------# O ##---####")
-renderLine( 7, "# ######   ### #####")
-renderLine( 8, "#-----#~~~##-------#")
-renderLine( 9, "##+-+-  ~~#---#+#+-#")
-renderLine(10, "#--++##    -++---+-#")
-renderLine(11, "#----#~~~~#--###---#")
-renderLine(12, "##############~#####")
-
-oxyd_shuffle()
-
-set_actor("ac-blackball", 4.5, 6.5)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: branches/1.0/data/levels/enigma_i/martin88_2.xml (from rev 565, branches/1.0/data/levels/enigma_i/martin88_1.xml)
===================================================================
--- branches/1.0/data/levels/enigma_i/martin88_1.xml	2007-01-04 21:05:50 UTC (rev 565)
+++ branches/1.0/data/levels/enigma_i/martin88_2.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -0,0 +1,112 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Growing The Doors" el:subtitle="" el:id="martin88"/>
+      <el:version el:score="2" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Martin Hawlisch" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Martin Hawlisch</el:copyright>
+      <el:license el:type="GPL version 2" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+levelw = 20
+levelh = 13
+
+create_world(levelw, levelh)
+fill_floor("fl-rough")
+
+oxyd_default_flavor = "b"
+
+function renderLine( line, pattern)
+    for i=1, strlen(pattern) do
+      local c = strsub( pattern, i, i)
+      if c =="#" then
+         set_stone("st-plain",i-1,line)
+      elseif c == "O" then
+         oxyd( i-1, line)
+      elseif c == "+" then
+         set_stone("st-shogun-s",i-1,line)
+      elseif c == " " then
+         set_floor("fl-sand", i-1, line)
+      end
+    end
+end
+
+set_stone("st-door_b", 1,7, {type="v", name="door1"})
+set_stone("st-door_b", 6,9, {type="v", name="door2"})
+set_stone("st-door_b",14,7, {type="v", name="door3"})
+set_stone("st-door_b",11,4, {type="v", name="door4"})
+
+set_stone("st-door_b", 8,2, {type="v", name="floor8"})
+set_stone("st-door_b", 8,3, {type="v", name="floor11"})
+set_stone("st-door_b", 8,4, {type="v", name="floor15"})
+set_stone("st-door_b", 8,5, {type="v", name="floor5"})
+set_stone("st-door_b", 8,6, {type="v", name="floor10"})
+set_stone("st-door_b", 8,7, {type="v", name="floor14"})
+set_stone("st-door_b", 9,7, {type="v", name="floor3"})
+set_stone("st-door_b",10,7, {type="v", name="floor9"})
+set_stone("st-door_b",10,6, {type="v", name="floor13"})
+set_stone("st-door_b",10,5, {type="v", name="floor16"})
+set_stone("st-door_b",10,4, {type="v", name="floor7"})
+set_stone("st-door_b",10,10, {type="v", name="floor12"})
+set_stone("st-door_b", 9,10, {type="v", name="floor1"})
+set_stone("st-door_b", 8,10, {type="v", name="floor2"})
+set_stone("st-door_b", 7,10, {type="v", name="floor4"})
+set_stone("st-door_b", 7, 9, {type="v", name="floor6"})
+
+set_item("it-shogun-s", 2, 2, {target="door1", action="openclose"})
+set_item("it-shogun-s", 2, 1, {target="floor1", action="openclose"})
+set_item("it-shogun-s", 4, 1, {target="floor7", action="openclose"})
+set_item("it-shogun-s", 5, 1, {target="floor3", action="openclose"})
+set_item("it-shogun-s", 5, 2, {target="floor4", action="openclose"})
+
+set_item("it-shogun-s", 1,11, {target="floor2", action="openclose"})
+set_item("it-shogun-s", 2,11, {target="floor6", action="openclose"})
+set_item("it-shogun-s", 3,11, {target="door2", action="openclose"})
+set_item("it-shogun-s", 4,11, {target="floor12", action="openclose"})
+
+set_item("it-shogun-s",16,10, {target="floor8", action="openclose"})
+set_item("it-shogun-s",16,11, {target="floor9", action="openclose"})
+set_item("it-shogun-s",17,11, {target="floor10", action="openclose"})
+set_item("it-shogun-s",18,11, {target="door3", action="openclose"})
+set_item("it-shogun-s",18,10, {target="floor11", action="openclose"})
+
+set_item("it-shogun-s",14,3, {target="floor5", action="openclose"})
+set_item("it-shogun-s",14,4, {target="floor13", action="openclose"})
+set_item("it-shogun-s",15,3, {target="floor14", action="openclose"})
+set_item("it-shogun-s",15,4, {target="floor15", action="openclose"})
+set_item("it-shogun-s",16,3, {target="door4", action="openclose"})
+set_item("it-shogun-s",16,4, {target="floor16", action="openclose"})
+
+renderLine( 0, "####################")
+renderLine( 1, "##----##O######---##")
+renderLine( 2, "##--+-#O O##-+-+---#")
+renderLine( 3, "###--+## ###-#-+-#-#")
+renderLine( 4, "#-+--+-# #  -#-+-#-#")
+renderLine( 5, "#-#+##-# # #---+-+-#")
+renderLine( 6, "#------# O ##---####")
+renderLine( 7, "# ######   ### #####")
+renderLine( 8, "#-----######-------#")
+renderLine( 9, "##+-+-  ###---#+#+-#")
+renderLine(10, "#--++##    -++---+-#")
+renderLine(11, "#----######--###---#")
+renderLine(12, "####################")
+
+oxyd_shuffle()
+
+set_actor("ac-blackball", 4.5, 6.5)
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: branches/1.0/data/levels/enigma_i/raoul04_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_i/raoul04_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_i/raoul04_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="- Meditation -" el:subtitle="" el:id="raoul04"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="raoul at users.berlios.de" el:homepage=""/>
       <el:copyright>Copyright ? 2005 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -85,10 +85,10 @@
 set_item("it-hollow", 17, 2);
 set_item("it-hollow", 17, 10);
 
-set_actor("ac-whiteball-small", 10,2.5, {player=0})
-set_actor("ac-whiteball-small", 10,10.5, {player=0})
-set_actor("ac-whiteball-small", 2.5,6.5, {player=0})
-set_actor("ac-whiteball-small", 17.5,6.5, {player=0})
+set_actor("ac-whiteball-small", 10,2.5, {player=0, essential=1})
+set_actor("ac-whiteball-small", 10,10.5, {player=0, essential=1})
+set_actor("ac-whiteball-small", 2.5,6.5, {player=0, essential=1})
+set_actor("ac-whiteball-small", 17.5,6.5, {player=0, essential=1})
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Modified: branches/1.0/data/levels/enigma_i/siegfried35_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_i/siegfried35_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_i/siegfried35_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="- Meditation -" el:subtitle="" el:id="meditation14"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Siegfried Fennig" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2002 Siegfried Fennig</el:copyright>
       <el:license el:type="Donated to Enigma under the projects license" el:open="true"/>
@@ -16,50 +16,44 @@
       <el:score el:easy="-" el:difficult="-"/>
     </el:info>
     <el:luamain><![CDATA[
-levelw = 59
-levelh = 38
+levelw = 20
+levelh = 13
 
 create_world(levelw, levelh)
-fill_floor("fl-abyss", 0,0, levelw,levelh)
-fill_floor("fl-space",19,12, 20,13)
-fill_floor("fl-inverse",24,15, 10,7)
-fill_floor("fl-inverse",21,18, 3,1)
-fill_floor("fl-inverse",34,18, 3,1)
+fill_floor("fl-space",0,0, 20,13)
+fill_floor("fl-inverse",5,3, 10,7)
+fill_floor("fl-inverse",2,6, 3,1)
+fill_floor("fl-inverse",15,6, 3,1)
 
-fill_floor("fl-inverse",22,16, 1,1)
-fill_floor("fl-inverse",22,20, 1,1)
-fill_floor("fl-inverse",35,16, 1,1)
-fill_floor("fl-inverse",35,20, 1,1)
+fill_floor("fl-inverse",3,4, 1,1)
+fill_floor("fl-inverse",3,8, 1,1)
+fill_floor("fl-inverse",16,4, 1,1)
+fill_floor("fl-inverse",16,8, 1,1)
 
-draw_floor("fl-gradient", {21,14}, {1,0},16, {type=1})
-draw_floor("fl-gradient", {20,15}, {0,1}, 7, {type=3})
-draw_floor("fl-gradient", {21,22}, {1,0},16, {type=2})
-draw_floor("fl-gradient", {37,15}, {0,1}, 7, {type=4})
-draw_floor("fl-gradient", {20,14}, {1,0}, 1, {type=5})
-draw_floor("fl-gradient", {37,14}, {1,0}, 1, {type=6})
-draw_floor("fl-gradient", {20,22}, {1,0}, 1, {type=7})
-draw_floor("fl-gradient", {37,22}, {1,0}, 1, {type=8})
+draw_floor("fl-gradient", {2,2}, {1,0},16, {type=1})
+draw_floor("fl-gradient", {1,3}, {0,1}, 7, {type=3})
+draw_floor("fl-gradient", {2,10}, {1,0},16, {type=2})
+draw_floor("fl-gradient", {18,3}, {0,1}, 7, {type=4})
+draw_floor("fl-gradient", {1,2}, {1,0}, 1, {type=5})
+draw_floor("fl-gradient", {18,2}, {1,0}, 1, {type=6})
+draw_floor("fl-gradient", {1,10}, {1,0}, 1, {type=7})
+draw_floor("fl-gradient", {18,10}, {1,0}, 1, {type=8})
 
-draw_stones("st-invisible", {18,11}, {1,0},22)
-draw_stones("st-invisible", {18,25}, {1,0},22)
-draw_stones("st-invisible", {18,12}, {0,1},13)
-draw_stones("st-invisible", {39,12}, {0,1},13)
+set_item("it-hollow", 3,4)
+set_item("it-hollow", 3,8)
+set_item("it-hollow", 16,4)
+set_item("it-hollow", 16,8)
 
-set_item("it-hollow", 22,16)
-set_item("it-hollow", 22,20)
-set_item("it-hollow", 35,16)
-set_item("it-hollow", 35,20)
+shogundot3 (16,1)
+shogundot2 (2,3)
+shogundot1 (0,7)
+shogundot1 (15,8)
+shogundot3 (4,11)
 
-shogundot3 (35,13)
-shogundot2 (21,15)
-shogundot1 (19,19)
-shogundot1 (34,20)
-shogundot3 (23,23)
-
-set_actor("ac-whiteball-small", 28,   18.5, {player=0, mouseforce=1})
-set_actor("ac-whiteball-small", 28.5, 18.5, {player=0, mouseforce=1})
-set_actor("ac-whiteball-small", 29,   18.5, {player=0, mouseforce=1})
-set_actor("ac-whiteball-small", 29.5, 18.5, {player=0, mouseforce=1})
+set_actor("ac-whiteball-small", 9,   6.5, {player=0, mouseforce=1})
+set_actor("ac-whiteball-small", 9.5, 6.5, {player=0, mouseforce=1})
+set_actor("ac-whiteball-small", 10,   6.5, {player=0, mouseforce=1})
+set_actor("ac-whiteball-small", 10.5, 6.5, {player=0, mouseforce=1})
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Deleted: branches/1.0/data/levels/enigma_iii/duffy20_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_iii/duffy20_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_iii/duffy20_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -1,113 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Family Business" el:subtitle="" el:id="duffy20"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-levelw=25
-levelh=30
-
-create_world( levelw, levelh)
-
-fill_floor("fl-metal", 0,0,levelw,levelh)
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-        if c =="#" then
-            set_stone( "st-greenbrown", i-1, line)
-        elseif c == "o" then
-            oxyd( i-1, line)
-        elseif c == "!" then
-            abyss(i-1,line)
-            --            fill_floor("fl-water", i-1,line, 1,1)
-        elseif c=="+" then
-            set_stone( "st-wood", i-1, line)
-        elseif c=="g" then
-            draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
-        elseif c=="l" then
-            oneway(i-1,line, enigma.WEST)
-        elseif c=="u" then
-            oneway(i-1,line, enigma.NORTH)
-        elseif c=="r" then
-            oneway(i-1,line, enigma.EAST)
-        elseif c=="d" then
-            oneway(i-1,line, enigma.SOUTH)
-        elseif c=="h" then
-            set_item("it-tinyhollow", i-1, line)
-        elseif c=="H" then
-            set_item("it-hollow", i-1, line)
-        elseif c=="J" then
-            set_item("it-hill", i-1, line)
-        elseif c=="j" then
-            set_item("it-tinyhill", i-1, line)
-        elseif c == "1" then --ur
-            set_floor("fl-gradient",  i-1,  line, {type=11})
-        elseif c == "3" then --dl
-            set_floor("fl-gradient",  i-1,  line, {type=9})
-        elseif c == "7" then --dr
-            set_floor("fl-gradient",  i-1,  line, {type=12})
-        elseif c == "9" then --ul
-            set_floor("fl-gradient",  i-1,  line, {type=10})
-        end
-    end    
-end
-
--- Floor:  " "
--- Border: "#"
--- Oxyd:   "o"
-
-renderLine(00,"####################")
-renderLine(01,"#o                o#")
-renderLine(02,"# J              J #")
-renderLine(03,"#  ##############  #")
-renderLine(04,"#  #H   o  o   H#  #")
-renderLine(05,"#  #            #  #")
-renderLine(06,"#  #  o  31  o  #  #")
-renderLine(07,"#  #     97     #  #")
-renderLine(08,"#  #            #  #")
-renderLine(09,"#  #   ######   #  #")
-renderLine(10,"#  #   #h  h#   #  #")
-renderLine(11,"#JJ#   # oo #   #JJ#")
-renderLine(12,"#JJ#   # jj #   #JJ#")
-renderLine(13,"#JJ#   # oo #   #JJ#")
-renderLine(14,"#  #   #h  h#   #  #")
-renderLine(15,"#  #   ######   #  #")
-renderLine(16,"#  #            #  #")
-renderLine(17,"#  #     31     #  #")
-renderLine(18,"#  #  o  97  o  #  #")
-renderLine(19,"#  #            #  #")
-renderLine(20,"#  #H   o  o   H#  #")
-renderLine(21,"#  ##############  #")
-renderLine(22,"# J              J #")
-renderLine(23,"#o                o#")
-renderLine(24,"####################")
-
-oxyd_shuffle()
-
-local actor1=set_actor("ac-blackball", 10,2)
-local actor2=set_actor("ac-whiteball", 10,5)
-local actor3=set_actor("ac-whiteball-small", 10,10.5,{player=1,mouseforce=0})
-
-AddRubberBand(actor1, actor2, 8,0)
-AddRubberBand(actor2, actor3, 8,0)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: branches/1.0/data/levels/enigma_iii/duffy20_2.xml (from rev 565, branches/1.0/data/levels/enigma_iii/duffy20_1.xml)
===================================================================
--- branches/1.0/data/levels/enigma_iii/duffy20_1.xml	2007-01-04 21:05:50 UTC (rev 565)
+++ branches/1.0/data/levels/enigma_iii/duffy20_2.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -0,0 +1,113 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Family Business" el:subtitle="" el:id="duffy20"/>
+      <el:version el:score="2" el:release="2" el:revision="0" el:status="released"/>
+      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+levelw=25
+levelh=30
+
+create_world( levelw, levelh)
+
+fill_floor("fl-metal", 0,0,levelw,levelh)
+
+function renderLine( line, pattern)
+    for i=1, strlen(pattern) do
+        local c = strsub( pattern, i, i)
+        if c =="#" then
+            set_stone( "st-greenbrown", i-1, line)
+        elseif c == "o" then
+            oxyd( i-1, line)
+        elseif c == "!" then
+            abyss(i-1,line)
+            --            fill_floor("fl-water", i-1,line, 1,1)
+        elseif c=="+" then
+            set_stone( "st-wood", i-1, line)
+        elseif c=="g" then
+            draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
+        elseif c=="l" then
+            oneway(i-1,line, enigma.WEST)
+        elseif c=="u" then
+            oneway(i-1,line, enigma.NORTH)
+        elseif c=="r" then
+            oneway(i-1,line, enigma.EAST)
+        elseif c=="d" then
+            oneway(i-1,line, enigma.SOUTH)
+        elseif c=="h" then
+            set_item("it-tinyhollow", i-1, line, {essential=1})
+        elseif c=="H" then
+            set_item("it-hollow", i-1, line, {essential=1})
+        elseif c=="J" then
+            set_item("it-hill", i-1, line)
+        elseif c=="j" then
+            set_item("it-tinyhill", i-1, line)
+        elseif c == "1" then --ur
+            set_floor("fl-gradient",  i-1,  line, {type=11})
+        elseif c == "3" then --dl
+            set_floor("fl-gradient",  i-1,  line, {type=9})
+        elseif c == "7" then --dr
+            set_floor("fl-gradient",  i-1,  line, {type=12})
+        elseif c == "9" then --ul
+            set_floor("fl-gradient",  i-1,  line, {type=10})
+        end
+    end    
+end
+
+-- Floor:  " "
+-- Border: "#"
+-- Oxyd:   "o"
+
+renderLine(00,"####################")
+renderLine(01,"#o                o#")
+renderLine(02,"# J              J #")
+renderLine(03,"#  ##############  #")
+renderLine(04,"#  #H   o  o   H#  #")
+renderLine(05,"#  #            #  #")
+renderLine(06,"#  #  o  31  o  #  #")
+renderLine(07,"#  #     97     #  #")
+renderLine(08,"#  #            #  #")
+renderLine(09,"#  #   ######   #  #")
+renderLine(10,"#  #   #h  h#   #  #")
+renderLine(11,"#JJ#   # oo #   #JJ#")
+renderLine(12,"#JJ#   # jj #   #JJ#")
+renderLine(13,"#JJ#   # oo #   #JJ#")
+renderLine(14,"#  #   #h  h#   #  #")
+renderLine(15,"#  #   ######   #  #")
+renderLine(16,"#  #            #  #")
+renderLine(17,"#  #     31     #  #")
+renderLine(18,"#  #  o  97  o  #  #")
+renderLine(19,"#  #            #  #")
+renderLine(20,"#  #H   o  o   H#  #")
+renderLine(21,"#  ##############  #")
+renderLine(22,"# J              J #")
+renderLine(23,"#o                o#")
+renderLine(24,"####################")
+
+oxyd_shuffle()
+
+local actor1=set_actor("ac-blackball", 10,2)
+local actor2=set_actor("ac-whiteball", 10,5)
+local actor3=set_actor("ac-whiteball-small", 10,10.5,{player=1,mouseforce=0})
+
+AddRubberBand(actor1, actor2, 8,0)
+AddRubberBand(actor2, actor3, 8,0)
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: branches/1.0/data/levels/enigma_iii/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_iii/index.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_iii/index.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -8,13 +8,13 @@
   <levels>
     <level _seq="1" _title="Welcome" _xpath="./welcometopack3_1" author="Raoul Bourquin" ctrl="force" easy="true" id="welcometopack3" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="2" _title="Bridge Builders" _xpath="./wb04_1" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb4" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="3" _title="Teamplay Doors" _xpath="./luc09_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc09" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="4" _title="Map It Out" _xpath="./duffy92_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy92" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="3" _title="Teamplay Doors" _xpath="./luc09_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc09" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="4" _title="Map It Out" _xpath="./duffy92_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy92" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="5" _title="Checkerboard" _xpath="./duffy08_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy8" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="6" _title="Everhungry" _xpath="./ant32_1" author="Petr Machata" ctrl="force" easy="false" id="ant32" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="7" _title="Deadend" _xpath="./daniel07_1" author="Daniel Heck" ctrl="force" easy="false" id="deadend" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Coloured Doors" _xpath="./luc03_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc03" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="9" _title="Family Business" _xpath="./duffy20_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy20" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="9" _title="Family Business" _xpath="./duffy20_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy20" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="10" _title="Seven Friends" _xpath="./ss16_2" author="Sven Siggelkow" ctrl="force" easy="false" id="ss16" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="11" _title="Blocks and Water" _xpath="./duffy99_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy99" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="12" _title="deja-vu" _xpath="./illmind09_1" author="illmind" ctrl="force" easy="false" id="illmind09" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_iii/luc09_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_iii/luc09_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_iii/luc09_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Teamplay Doors" el:subtitle="" el:id="luc09"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
       <el:copyright>Copyright ? 2005 Lukas Sch?ller</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -75,8 +75,6 @@
   --TriggerC()
 end
 
-multiplayer_mode()
-
 cells={}
 cells[" "]=cell{floor="fl-himalaya"}
 cells["#"]=cell{stone="st-plain"}
@@ -126,6 +124,7 @@
 map_cell_meaning("q", cell{item={"it-trigger", {action="openclose", target="doorq"}}})
 map_cell_meaning("r", cell{item={"it-trigger", {action="openclose", target="doorr"}}})
 map_cell_meaning("s", cell{item={"it-trigger", {action="openclose", target="doors"}}})
+
 level = {
   "#############################",
   "#  E    f######    M N #   0#",
@@ -141,13 +140,21 @@
   "#  Za#   ######   #x r s   0#",
   "#############################"
 }
+
 set_default_parent(cells[" "])
+
 create_world_by_map(level)
+display.SetFollowMode(display.FOLLOW_SCROLLING)
+enigma.ConserveLevel=FALSE
+
 oxyd_default_flavor = "a"
 oxyd_shuffle()
 SendMessage(enigma.GetNamedObject("doorz"), "open")
-display.SetFollowMode(display.FOLLOW_SCROLLING)
-enigma.ConserveLevel=FALSE
+
+set_actor("ac-blackball",1.5,5.5,{player=0, essential=1})
+set_actor("ac-whiteball",1.5,7.5,{player=1, essential=1})
+set_item("it-yinyang",1,5)
+set_item("it-yinyang",1,7)
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Deleted: branches/1.0/data/levels/enigma_iv/duffy73_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_iv/duffy73_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_iv/duffy73_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -1,541 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Bizarro World" el:subtitle="" el:id="duffy73"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="true" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-levelw=180
-levelh=90
-
-create_world( levelw, levelh)
-
-enigma.SlopeForce=-20
-
-if not difficult then
-    enigma.ElectricForce=-15
-else
-    enigma.ElectricForce=-20
-end
-
-fill_floor("fl-abyss", 0,0,levelw,levelh)
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-        if c =="#" then
-            set_stone( "st-death", i-1, line)
-        elseif c =="v" then
-            set_stone( "st-greenbrown_move", i-1, line)
-            set_floor("fl-leaves",i-1,line)
-        elseif c =="%" then
-            set_stone( "st-greenbrown", i-1, line)
-        elseif c =="k" then
-            if difficult==false then
-                --            set_stone( "st-greenbrown", i-1, line)
-            else
-                set_stone( "st-greenbrown", i-1, line)
-            end
-        elseif c =="p" then
-            set_floor("fl-leaves",i-1,line)
-            if difficult==false then
-                set_item("it-flagblack",i-1,line)
-            else
-                --            set_item("it-flagblack",i-1,line)
-            end
-        elseif c =="Q" then
-            set_stone( "st-greenbrown", i-1, line)
-            set_floor("fl-hay",i-1,line)
-        elseif c =="&" then
-            set_stone( "st-greenbrown", i-1, line)
-            set_floor("fl-bluegreen",i-1,line)
-            set_item("it-abyss",i-1,line)
-        elseif c =="^" then
-            set_stone( "st-death", i-1, line)
-            set_floor("fl-bluegreen",i-1,line)
-            set_item("it-abyss",i-1,line)
-        elseif c =="$" then
-            set_stone( "st-death", i-1, line)
-            set_floor("fl-leaves",i-1,line)
-        elseif c =="K" then
-            set_stone( "st-greenbrown", i-1, line)
-            set_floor("fl-inverse",i-1,line)
-        elseif c =="P" then
-            set_stone( "st-greenbrown", i-1, line)
-            set_floor("fl-leaves",i-1,line)
-        elseif c =="U" then
-            set_item("it-umbrella",i-1,line)
-            set_floor("fl-inverse",i-1,line)
-        elseif c == "o" then
-            oxyd( i-1, line)
-            set_floor("fl-leaves",i-1,line)
-        elseif c == "*" then
-            set_stone( "st-brownie", i-1, line)
-        elseif c == "!" then
-            abyss(i-1,line)
-        elseif c == "~" then
-            set_floor("fl-water",i-1,line)
-        elseif c=="z" then
-            set_actor("ac-blackball", i-.5,line+.5)
-            set_floor("fl-leaves",i-1,line)
-        elseif c=="y" then
-            set_actor("ac-whiteball", i-1,line+.5, {mouseforce=0})
-            set_floor("fl-leaves",i-1,line)
-        elseif c=="l" then
-            set_floor("fl-leaves",i-1,line)
-        elseif c == "g" then
-            draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
-            set_floor("fl-leaves",i-1,line)
-        elseif c=="+" then
-            set_stone( "st-wood", i-1, line)
-        elseif c=="=" then
-            set_floor("fl-space",i-1,line)
-        elseif c=="j" then
-            set_floor("fl-ice",i-1,line)
-        elseif c=="i" then
-            set_floor("fl-inverse",i-1,line)
-        elseif c=="s" then
-            set_floor("fl-swamp",i-1,line)
-        elseif c=="x" then
-            set_floor("fl-bluegreen",i-1,line)
-            set_item("it-abyss",i-1,line)
-        elseif c=="@" then
-            set_floor("fl-abyss_fake",i-1,line)
-        elseif c=="c" then
-            if difficult==false then
-                set_floor("fl-abyss_fake",i-1,line)
-            else
-                set_floor("fl-bluegreen",i-1,line)
-                set_item("it-abyss",i-1,line)
-            end
-        elseif c=="G" then
-            if difficult==false then
-                set_stone( "st-greenbrown", i-1, line)
-            else
-                set_stone( "st-death", i-1, line)
-            end
-        elseif c=="S" then
-            set_floor("fl-leaves",i-1,line)
-            set_item("it-spring1",i-1,line)
-        elseif c=="F" then
-            set_floor("fl-leaves",i-1,line)
-            set_item("it-flagblack",i-1,line)
-        elseif c=="O" then
-            set_floor("fl-leaves",i-1,line)
-            set_item("it-extralife",i-1,line)
-        elseif c =="T" then
-            set_stone( "st-thief", i-1, line)
-            set_floor("fl-space",i-1,line)
-        elseif c == "d" then --1-d
-            set_floor("fl-gradient",  i-1,  line, {type=1})
-        elseif c == "u" then --2-u
-            set_floor("fl-gradient",  i-1,  line, {type=2})
-        elseif c == "r" then --3-r
-            set_floor("fl-gradient",  i-1,  line, {type=3})
-        elseif c == "e" then --4-l
-            set_floor("fl-gradient",  i-1,  line, {type=4})
-        elseif c == "1" then --ur
-            set_floor("fl-gradient",  i-1,  line, {type=11})
-        elseif c == "3" then --dl
-            set_floor("fl-gradient",  i-1,  line, {type=9})
-        elseif c == "7" then --dr
-            set_floor("fl-gradient",  i-1,  line, {type=12})
-        elseif c == "9" then --ul
-            set_floor("fl-gradient",  i-1,  line, {type=10})
-        elseif c =="h" then
-            set_floor("fl-hay",i-1,line)
-        elseif c =="A" then
-            set_floor("fl-hay",i-1,line)
-        elseif c =="B" then
-            set_floor("fl-hay",i-1,line)
-            set_stone("st-invisible",i-1,line)
-        elseif c =="a" then
-            set_floor("fl-hay",i-1,line)
-            set_stone("st-greenbrown_hole",i-1,line)
-        elseif c =="b" then
-            set_floor("fl-hay",i-1,line)
-            set_stone("st-greenbrown",i-1,line)
-        elseif c =="I" then
-            set_stone("st-invisible",i-1,line)
-        elseif c=="M" then
-            set_actor("ac-rotor", i-.5,line+.5, {player=1, mouseforce=0, range=4, force=-5})
-            set_floor("fl-leaves",i-1,line)
-        elseif c=="N" then
-            set_actor("ac-top", i-.5,line+.5, {player=1, mouseforce=0, range=8, force=20})
-            set_floor("fl-inverse",i-1,line)
-        elseif c=="R" then
-            set_stone("st-oneway-e", i-1,line)
-            set_floor("fl-leaves",i-1,line)
-        elseif c=="J" then
-            set_stone("st-break_acwhite",i-1,line)
-        elseif c=="D" then
-            dynamite(i-1,line)
-        elseif c=="t" then
-            hammer(i-1,line)
-        elseif c=="H" then
-            set_stone("st-stone_break",i-1,line)
-        elseif c=="f" then
-            set_stone("st-actorimpulse_invisible",i-1,line)
-        elseif c == "q" then
-            yy1( "black",  i-1, line)
-            set_floor("fl-leaves",i-1,line)
-        elseif c == "w" then
-            yy1( "white",  i-1, line)
-            set_floor("fl-leaves",i-1,line)
-        elseif c=="V" then
-            set_floor("fl-bridge", 80,42, {name="bridgea1",type="xx"})
-            set_floor("fl-abyss_fake",i-1,line)
-            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="funcc2"})
-        elseif c=="W" then
-            set_floor("fl-bridge", 84,42, {name="bridgeb0",type="xx"})
-            set_item("it-abyss",i-1,line)
-        elseif c=="C" then
-            set_floor("fl-leaves",i-1,line)
-            set_stone("st-switch",i-1,line,{name="switch5",action="callback",target="funcc1"})
-        elseif c=="?" then
-            set_floor("fl-leaves",i-1,line)
-            set_stone("st-chargeplus",i-1,line)
-        elseif c=="/" then
-            set_floor("fl-leaves",i-1,line)
-            set_stone("st-chargeminus",i-1,line)
-        elseif c==":" then
-            set_floor("fl-hay",i-1,line)
-            set_stone("st-chargezero",i-1,line)
-        elseif c==";" then
-            --           set_floor("fl-bridge", i-1,line, {name="bridge1",type=xx})
-            set_floor("fl-leaves",i-1,line)
-            set_stone("st-invisible",i-1,line)
-        elseif c=="2" then
-            set_floor("fl-leaves",i-1,line)
-            set_stone("st-switch",i-1,line,{action="callback",target="funcc3",name="switch1"})
-        elseif c=="4" then
-            set_floor("fl-leaves",i-1,line)
-            set_stone("st-switch",i-1,line,{action="callback",target="funcc4",name="switch2"})
-        elseif c=="5" then
-            set_floor("fl-leaves",i-1,line)
-            set_stone("st-switch",i-1,line,{action="callback",target="funcc5",name="switch3"})
-        elseif c=="6" then
-            set_floor("fl-leaves",i-1,line)
-            set_stone("st-switch",i-1,line,{action="callback",target="funcc6",name="switch4"})
-        elseif c == "m" then
-            set_floor("fl-leaves",i-1,line)
-            document(i-1,line,"text1")
-        end
-    end    
-end
-
-function yy1( color, x, y)
-        stone = format( "st-%s4", color)
-        set_stone( stone, x, y)
-end
-
-renderLine(00,"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII")
-renderLine(01,"I         f               f                     f          f        f      f                 f        f              f           f                      f              f  I")
-renderLine(02,"I   f                                                                                                                                                                     I")
-renderLine(03,"I      t      f                                                                                                      f                                                    I")
-renderLine(04,"I                           f         f          f                f        f       f     f              f                          f            f                         I")
-renderLine(05,"I         f                                               f                                                                                                  f      f     I")
-renderLine(06,"If               f                                                                               f                f                                                       I")
-renderLine(07,"I                          f                                                     f                                            f                    D                      I")
-renderLine(08,"I                                      f              f         f     f                                                                        f       f                  I")
-renderLine(09,"I                                                                                                             f                      f                          f         I")
-renderLine(10,"I   f                                                                                                                  f                                                  I")
-renderLine(11,"I                    f                                  D      f               f               f      f                                   f                              fI")
-renderLine(12,"I           f                f          f       f                                                                   f                            f                        I")
-renderLine(13,"If                                                                                     f                                              f                                   I")
-renderLine(14,"I                                                                                                          f                   f                                          I")
-renderLine(15,"I                                f      f                    f            f                                       f                   f            f       f         f    I")
-renderLine(16,"I                                                   f                                                 f                                                                   I")
-renderLine(17,"I     f         f        f                                                         f      f                                                                      f        I")
-renderLine(18,"I                                                                       f                                           f        f                                            I")
-renderLine(19,"I                                 f           f                                                                  D                        f           f               f   I")
-renderLine(20,"I                                                       f        f                                   f                                                                    I")
-renderLine(21,"I    f        f              f                                              f                             f                                    f               f          I")
-renderLine(22,"I                                       f                                                      f                     f             f                                      I")
-renderLine(23,"I                                                                                     f                                                                                  fI")
-renderLine(24,"I                                                          f                                                                               f                              I")
-renderLine(25,"I           f        f                  f         f                f                                       f                                             f                I")
-renderLine(26,"If  f                                                                        f                       f                    f                                       f       I")
-renderLine(27,"I                                             f                                                                                     f           f                         I")
-renderLine(28,"I                                f                                                             f           f           f                                             f    I")
-renderLine(29,"I             f              f                           f         f                f                                              f                                      I")
-renderLine(30,"I    D                                                                                                                                                                    I")
-renderLine(31,"I       f                                                              f                        f       f                                              f       f          I")
-renderLine(32,"I                                      f    f        f                       f          f                                          f                                      I")
-renderLine(33,"I                 f                                                                                               f                           f                      f   fI")
-renderLine(34,"I                                                                                                                         f                                               I")
-renderLine(35,"I     f                 f           f               f             f        f          f           f         f                    f                       f                I")
-renderLine(36,"IIIIIIIIIIIIIIIIIIIIIIIIIIIII%%%%%%%%%%%%%%%%%%%#########%%%%%%%%%%%%%%%%%%%%PPPPPPPPPPPPPPPPPPPQQQQQQQQQQQQ#########################                                     I")
-renderLine(37,"I     f     f       f     f  HJJJJJJJJv        %         % lrrrrreeeeeejj   %FllPlllP~~~~~~~~~~PbAaAAaBaBbablllsss%llllRiiiiiiiiiNUUU              f                      I")
-renderLine(38,"I                            HJJJJJJJJv llllll % llp   #   l            l   %lllPlllP~2wwllww4~PbBBBbaBBBbAAlllsss%ggllRiiiiiiiiiiUUU                           f      f  I")
-renderLine(39,"I                            HJJJJJJJJv lzllSl   lll   ##% leeeerrrrll 3d1  %lllPlllP~wwwllwww~PbAaAaaAaBAAblllsssvlgllRiiiiiiiiiiUUU    f                                I")
-renderLine(40,"I                        f   HJJJJJJJJv llllll %         %           l rie  %lllPlllP~wwwllwww~PbabAbBBaBbablllsssvlgllRiiiiiiiiiiUUU                                     I")
-renderLine(41,"If     f                     HJJJJJJJJv        &xxxxxx^^^%TTTT  7uuuu9 9u7  %lllPlllP~llllllll~P:aBBbbbaBAAblllsssvlgllRiiiiiiiiiiUUU            f                        I")
-renderLine(42,"I               f            %%%%%%%%%%%%%%%%%%&xx@@@x^@@l===T  e7uu9r  l  lqlClVlllWlll?ly/ll;qAABaaAbABaBblllsss%ggllRiiiiiiiiiiUUU                       f             I")
-renderLine(43,"I                               f     #x@@cx@@@cxx@@@x^@@%TT=T  ee79rr llxll%lllPlllP~llllllll~P:bBabAaabaBblllsss%$$$$$iiiiiiiiiiUUU                                     I")
-renderLine(44,"I         f                         f #x@@cx@@@cxx@@@x^cc%===T  ee13rr lxxlx%lllPlllP~wwwllwww~PbAAABBBBBAAbxxxx^m%oooP$iiiiiiiiiiUUU                              f     fI")
-renderLine(45,"If                          f         #xxxxxxxx^^^^^^^^xx%=TTT  e1dd3r llxlx%lllPlllP~wwwllwww~PbBabbaAabbaaxxxx^l$lllo$iiiiiiiiiiUUU   f       f        f                I")
-renderLine(46,"I                                    f#x@@xx@@@xx@@@cxx@@%llllll1dddd3 lxxlx%lllPlllP~5wwllww6~PbAAAAaBAAAABxxxx^M$lllo$iiiiiiiiiiUUU                                     I")
-renderLine(47,"I                                     #x@@xxcccxx@@@cxx@@%llll         llllx%OllPlllP~~~~~~~~~~PbBbaBbbabBabxxxx^qqlllo$iiiiiiiiiNUUU                                     I")
-renderLine(48,"I                 f                  f##GG###############%%%%%%%%%%%%%%%%%%%%PPPPPPPPPPPPPPPPPPPQQQQQQQQQQQQ#########################                            f        I")
-renderLine(49,"I                        f                   f            f         f             f            f             f         f        f                  f                   f  I")
-renderLine(50,"If     f                              f                                                                                                                                   I")
-renderLine(51,"I               D                                                                                                                            f             f              I")
-renderLine(52,"I                                            f                             f                          f                                                          f       fI")
-renderLine(53,"I                                 f                                f                 f                        f        f            f                                     I")
-renderLine(54,"I                     f                                 f                                     f                                                                           I")
-renderLine(55,"If                                                                                                                                                 f                      I")
-renderLine(56,"I                                                                         f                            f                                                                  I")
-renderLine(57,"I                                                             f                                                                 f       f                         f       I")
-renderLine(58,"If                        f                 f                                                                     f                              f         f              I")
-renderLine(59,"I        f                         f                                                                                        f                                             I")
-renderLine(60,"I                                                     f         f          f                     f                                                                       fI")
-renderLine(61,"I                                                                                     f                                                                                   I")
-renderLine(62,"I               f                                                                                                                    f                        f      f    I")
-renderLine(63,"I                                             f                                                         f          f                                  D                   I")
-renderLine(64,"I                           f                                f           f                                                                                                I")
-renderLine(65,"I  f                                                              D                           f                                            f        f                     I")
-renderLine(66,"I                f                   f            f                                                                       f         f                          f         fI")
-renderLine(67,"I                                                                             f                                                                                           I")
-renderLine(68,"If       f                                                            f                 f                      f                                                   f      I")
-renderLine(69,"I                                                                                                    f                                                 f                  I")
-renderLine(70,"I                                                           f                                                                f            f                               I")
-renderLine(71,"I   f        f       f                    f      f                                                                                                              f         I")
-renderLine(72,"I                            f                                            f        f                               f                                                      I")
-renderLine(73,"I                                                                                                                                         f        f      f           f   I")
-renderLine(74,"I                                                      f       f                                 f        f                                                              fI")
-renderLine(75,"If                                      f                                                f                                    f                                           I")
-renderLine(76,"I                            f                                            f                                                                                               I")
-renderLine(77,"I          f       f                                                                                                                                  f           f       I")
-renderLine(78,"I                                                      f         f                                 f          f                        f                               f  I")
-renderLine(79,"I  f                                                                         f                                      f                        f              f             I")
-renderLine(80,"I    D                           f          f                                              f                                      f                                      fI")
-renderLine(81,"I                                                                                                       f                                            f                    I")
-renderLine(82,"If                                                                                                                                                           f            I")
-renderLine(83,"I    f     f             f            f              f            f            f       f            f                f          f               f                    f    I")
-renderLine(84,"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII")
-
-
-bridgenumber=1
-bridgenumber2=1
-
-ttt=0
-
-bridge1gone=1
-bridge2gone=0
-bridge1done=0
-bridge2done=0
-
-function timer_callback()
-    if bridge1gone==1 and bridge1done==0 then
-        if ttt==10 then
-            set_floor("fl-abyss_fake",80,42)
-            --set_floor("fl-leaves",80,42)
-            ttt=-1
-            bridge1done=1
-        end
-        ttt=ttt+1
-    end
-    if bridge2gone==1 and bridge2done==0 then
-        if ttt==10 then
-            set_floor("fl-abyss_fake",84,42)
-            --set_floor("fl-leaves",84,42)
-            ttt=-1
-            ttt=-1
-            bridge2done=1
-        end
-        ttt=ttt+1
-    end
-end
-
-funcc1ready=1
-
-ttt2=0
-
-function timer_callback2()
-    ttt2=ttt2+1
-    if ttt2>15 and funcc1ready==0 then
-        SendMessage("switch5","on")
-        funcc1ready=1
-    else
-    end
-end
-
-f1=0
-function funcc1()
-    if funcc1ready==1 then
-        ttt2=0
-        funcc1ready=0
-        if f1==0 then
-            f1=1
-
-            enigma.KillItem(80,42)
-            set_floor("fl-bridge", 80,42, {name="bridgea"..bridgenumber,type="xx"})
-            bridgeaa=enigma.GetNamedObject("bridgea"..bridgenumber)
-            SendMessage(bridgeaa,"close")
-            bridgenumber=bridgenumber+1
-            set_item("it-abyss",80,42)
-            bridge1gone=0
-            bridge1done=0
-
-            enigma.KillItem(84,42)
-            SendMessage(bridgebb,"openclose")
-            --set_floor("fl-abyss_fake",84,42)
-            set_item("it-trigger",84,42,{invisible=1,action="callback",target="funcc2"})
-            bridge2gone=1
-
-        elseif f1==1 then
-            f1=0
-
-            enigma.KillItem(80,42)
-            SendMessage(bridgeaa,"open")
-            --set_floor("fl-abyss_fake",80,42)
-            set_item("it-trigger",80,42,{invisible=1,action="callback",target="funcc2"})
-
-            bridge1gone=1
-
-            enigma.KillItem(84,42)
-            set_floor("fl-bridge", 84,42, {name="bridgeb"..bridgenumber2,type="xx"})
-            bridgebb=enigma.GetNamedObject("bridgeb"..bridgenumber2)
-            SendMessage(bridgebb,"openclose")
-            bridgenumber2=bridgenumber2+1
-            bridge2gone=0
-            bridge2done=0
-
-            set_item("it-abyss",84,42)
-
-
-            set_item("it-abyss",84,42)
-
-        end
-    end
-end
-
-f11=0
-function funcc11()
-    if f11==0 then
-        f11=1
-
-        enigma.KillItem(80,42)
-        set_floor("fl-wood",80,42)
-        set_item("it-abyss",80,42)
-
-        enigma.KillItem(84,42)
-        set_floor("fl-abyss_fake",84,42)
-        set_item("it-trigger",84,42,{invisible=1,action="callback",target="funcc2"})
-
-    elseif f11==1 then
-        f1=0
-
-        enigma.KillItem(80,42)
-        set_floor("fl-abyss_fake",80,42)
-        set_item("it-trigger",80,42,{invisible=1,action="callback",target="funcc2"})
-
-        enigma.KillItem(84,42)
-        set_floor("fl-wood",84,42)
-        set_item("it-abyss",84,42)
-
-    end
-end
-
-function funcc2()
-end
-
-ff3=0
-function funcc3()
-    if ff3==0 then
-        ff3=1
-    elseif ff3==1 then
-        ff3=0
-    end
-    funcc7()
-end
-
-ff4=0
-function funcc4()
-    if ff4==0 then
-        ff4=1
-    elseif ff4==1 then
-        ff4=0
-    end
-    funcc7()
-end
-
-ff5=0
-function funcc5()
-    if ff5==0 then
-        ff5=1
-    elseif ff5==1 then
-        ff5=0
-    end
-    funcc7()
-end
-
-ff6=0
-function funcc6()
-    if ff6==0 then
-        ff6=1
-    elseif ff6==1 then
-        ff6=0
-    end
-    funcc7()
-end
-
-ff7=0
-function funcc7()
-    if ff3==1 and ff4==1 and ff5==1 and ff6==1 then
-        if ff7==0 then
-            ff7=1
-            --   SendMessage(bridge1,"close")
-            set_stone("st-greenbrown_hole",94,42)
-        end
-    else
-        if ff7==1 then
-            ff7=0
-            --      SendMessage(bridge1,"open")
-            set_stone("st-invisible",94,42)
-        end
-    end
-end
-
-set_stone( "st-timer", 179, 0,
-           {target="timer_callback", action="callback",
-            name="timer", interval=0.1} )
-set_stone( "st-timer", 179, 1,
-           {target="timer_callback2", action="callback",
-            name="timer2", interval=0.1} )
-
-oxyd_shuffle()
-
---bridge1=enigma.GetNamedObject("bridge1")
-
-bridgebb=enigma.GetNamedObject("bridgeb0")
-SendMessage(bridgebb,"close")
-
-SendMessage("switch1","on")
-SendMessage("switch2","on")
-SendMessage("switch3","on")
-SendMessage("switch4","on")
-SendMessage("switch5","on")
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-      <el:string el:key="text1">
-        <el:english el:translate="true" el:comment="read from the right">.moor txen eht ot teg ot syaw owt era erehT</el:english>
-      </el:string> 
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: branches/1.0/data/levels/enigma_iv/duffy73_2.xml (from rev 550, branches/1.0/data/levels/enigma_iv/duffy73_1.xml)
===================================================================
--- branches/1.0/data/levels/enigma_iv/duffy73_1.xml	2006-12-27 12:34:42 UTC (rev 550)
+++ branches/1.0/data/levels/enigma_iv/duffy73_2.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -0,0 +1,541 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Bizarro World" el:subtitle="" el:id="duffy73"/>
+      <el:version el:score="2" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+      </el:compatibility>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+levelw=180
+levelh=90
+
+create_world( levelw, levelh)
+
+enigma.SlopeForce=-20
+
+if not difficult then
+    enigma.ElectricForce=-15
+else
+    enigma.ElectricForce=-20
+end
+
+fill_floor("fl-abyss", 0,0,levelw,levelh)
+
+function renderLine( line, pattern)
+    for i=1, strlen(pattern) do
+        local c = strsub( pattern, i, i)
+        if c =="#" then
+            set_stone( "st-death", i-1, line)
+        elseif c =="v" then
+            set_stone( "st-greenbrown_move", i-1, line)
+            set_floor("fl-leaves",i-1,line)
+        elseif c =="%" then
+            set_stone( "st-greenbrown", i-1, line)
+        elseif c =="k" then
+            if difficult==false then
+                --            set_stone( "st-greenbrown", i-1, line)
+            else
+                set_stone( "st-greenbrown", i-1, line)
+            end
+        elseif c =="p" then
+            set_floor("fl-leaves",i-1,line)
+            if difficult==false then
+                set_item("it-flagblack",i-1,line)
+            else
+                --            set_item("it-flagblack",i-1,line)
+            end
+        elseif c =="Q" then
+            set_stone( "st-greenbrown", i-1, line)
+            set_floor("fl-hay",i-1,line)
+        elseif c =="&" then
+            set_stone( "st-greenbrown", i-1, line)
+            set_floor("fl-bluegreen",i-1,line)
+            set_item("it-abyss",i-1,line)
+        elseif c =="^" then
+            set_stone( "st-death", i-1, line)
+            set_floor("fl-bluegreen",i-1,line)
+            set_item("it-abyss",i-1,line)
+        elseif c =="$" then
+            set_stone( "st-death", i-1, line)
+            set_floor("fl-leaves",i-1,line)
+        elseif c =="K" then
+            set_stone( "st-greenbrown", i-1, line)
+            set_floor("fl-inverse",i-1,line)
+        elseif c =="P" then
+            set_stone( "st-greenbrown", i-1, line)
+            set_floor("fl-leaves",i-1,line)
+        elseif c =="U" then
+            set_item("it-umbrella",i-1,line)
+            set_floor("fl-inverse",i-1,line)
+        elseif c == "o" then
+            oxyd( i-1, line)
+            set_floor("fl-leaves",i-1,line)
+        elseif c == "*" then
+            set_stone( "st-brownie", i-1, line)
+        elseif c == "!" then
+            abyss(i-1,line)
+        elseif c == "~" then
+            set_floor("fl-water",i-1,line)
+        elseif c=="z" then
+            set_actor("ac-blackball", i-.5,line+.5)
+            set_floor("fl-leaves",i-1,line)
+        elseif c=="y" then
+            set_actor("ac-whiteball", i-1,line+.5, {mouseforce=0})
+            set_floor("fl-leaves",i-1,line)
+        elseif c=="l" then
+            set_floor("fl-leaves",i-1,line)
+        elseif c == "g" then
+            draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
+            set_floor("fl-leaves",i-1,line)
+        elseif c=="+" then
+            set_stone( "st-wood", i-1, line)
+        elseif c=="=" then
+            set_floor("fl-space",i-1,line)
+        elseif c=="j" then
+            set_floor("fl-ice",i-1,line)
+        elseif c=="i" then
+            set_floor("fl-inverse",i-1,line)
+        elseif c=="s" then
+            set_floor("fl-swamp",i-1,line)
+        elseif c=="x" then
+            set_floor("fl-bluegreen",i-1,line)
+            set_item("it-abyss",i-1,line)
+        elseif c=="@" then
+            set_floor("fl-abyss_fake",i-1,line)
+        elseif c=="c" then
+            if difficult==false then
+                set_floor("fl-abyss_fake",i-1,line)
+            else
+                set_floor("fl-bluegreen",i-1,line)
+                set_item("it-abyss",i-1,line)
+            end
+        elseif c=="G" then
+            if difficult==false then
+                set_stone( "st-greenbrown", i-1, line)
+            else
+                set_stone( "st-death", i-1, line)
+            end
+        elseif c=="S" then
+            set_floor("fl-leaves",i-1,line)
+            set_item("it-spring1",i-1,line)
+        elseif c=="F" then
+            set_floor("fl-leaves",i-1,line)
+            set_item("it-flagblack",i-1,line)
+        elseif c=="O" then
+            set_floor("fl-leaves",i-1,line)
+            set_item("it-extralife",i-1,line)
+        elseif c =="T" then
+            set_stone( "st-thief", i-1, line)
+            set_floor("fl-space",i-1,line)
+        elseif c == "d" then --1-d
+            set_floor("fl-gradient",  i-1,  line, {type=1})
+        elseif c == "u" then --2-u
+            set_floor("fl-gradient",  i-1,  line, {type=2})
+        elseif c == "r" then --3-r
+            set_floor("fl-gradient",  i-1,  line, {type=3})
+        elseif c == "e" then --4-l
+            set_floor("fl-gradient",  i-1,  line, {type=4})
+        elseif c == "1" then --ur
+            set_floor("fl-gradient",  i-1,  line, {type=11})
+        elseif c == "3" then --dl
+            set_floor("fl-gradient",  i-1,  line, {type=9})
+        elseif c == "7" then --dr
+            set_floor("fl-gradient",  i-1,  line, {type=12})
+        elseif c == "9" then --ul
+            set_floor("fl-gradient",  i-1,  line, {type=10})
+        elseif c =="h" then
+            set_floor("fl-hay",i-1,line)
+        elseif c =="A" then
+            set_floor("fl-hay",i-1,line)
+        elseif c =="B" then
+            set_floor("fl-hay",i-1,line)
+            set_stone("st-invisible",i-1,line)
+        elseif c =="a" then
+            set_floor("fl-hay",i-1,line)
+            set_stone("st-greenbrown_hole",i-1,line)
+        elseif c =="b" then
+            set_floor("fl-hay",i-1,line)
+            set_stone("st-greenbrown",i-1,line)
+        elseif c =="I" then
+            set_stone("st-invisible",i-1,line)
+        elseif c=="M" then
+            set_actor("ac-rotor", i-.5,line+.5, {player=1, mouseforce=0, range=4, force=-5})
+            set_floor("fl-leaves",i-1,line)
+        elseif c=="N" then
+            set_actor("ac-top", i-.5,line+.5, {player=1, mouseforce=0, range=8, force=20})
+            set_floor("fl-inverse",i-1,line)
+        elseif c=="R" then
+            set_stone("st-oneway-e", i-1,line)
+            set_floor("fl-leaves",i-1,line)
+        elseif c=="J" then
+            set_stone("st-break_acwhite",i-1,line)
+        elseif c=="D" then
+            dynamite(i-1,line)
+        elseif c=="t" then
+            hammer(i-1,line)
+        elseif c=="H" then
+            set_stone("st-stone_break",i-1,line)
+        elseif c=="f" then
+            set_stone("st-actorimpulse_invisible",i-1,line)
+        elseif c == "q" then
+            yy1( "black",  i-1, line)
+            set_floor("fl-leaves",i-1,line)
+        elseif c == "w" then
+            yy1( "white",  i-1, line)
+            set_floor("fl-leaves",i-1,line)
+        elseif c=="V" then
+            set_floor("fl-bridge", 80,42, {name="bridgea1",type="xx"})
+            set_floor("fl-abyss_fake",i-1,line)
+            set_item("it-trigger",i-1,line,{invisible=1,action="callback",target="funcc2"})
+        elseif c=="W" then
+            set_floor("fl-bridge", 84,42, {name="bridgeb0",type="xx"})
+            set_item("it-abyss",i-1,line)
+        elseif c=="C" then
+            set_floor("fl-leaves",i-1,line)
+            set_stone("st-switch",i-1,line,{name="switch5",action="callback",target="funcc1"})
+        elseif c=="?" then
+            set_floor("fl-leaves",i-1,line)
+            set_stone("st-chargeplus",i-1,line)
+        elseif c=="/" then
+            set_floor("fl-leaves",i-1,line)
+            set_stone("st-chargeminus",i-1,line)
+        elseif c==":" then
+            set_floor("fl-hay",i-1,line)
+            set_stone("st-chargezero",i-1,line)
+        elseif c==";" then
+            --           set_floor("fl-bridge", i-1,line, {name="bridge1",type=xx})
+            set_floor("fl-leaves",i-1,line)
+            set_stone("st-invisible",i-1,line)
+        elseif c=="2" then
+            set_floor("fl-leaves",i-1,line)
+            set_stone("st-switch",i-1,line,{action="callback",target="funcc3",name="switch1"})
+        elseif c=="4" then
+            set_floor("fl-leaves",i-1,line)
+            set_stone("st-switch",i-1,line,{action="callback",target="funcc4",name="switch2"})
+        elseif c=="5" then
+            set_floor("fl-leaves",i-1,line)
+            set_stone("st-switch",i-1,line,{action="callback",target="funcc5",name="switch3"})
+        elseif c=="6" then
+            set_floor("fl-leaves",i-1,line)
+            set_stone("st-switch",i-1,line,{action="callback",target="funcc6",name="switch4"})
+        elseif c == "m" then
+            set_floor("fl-leaves",i-1,line)
+            document(i-1,line,"text1")
+        end
+    end    
+end
+
+function yy1( color, x, y)
+        stone = format( "st-%s4", color)
+        set_stone( stone, x, y)
+end
+
+renderLine(00,"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII")
+renderLine(01,"I         f               f                     f          f        f      f                 f        f              f           f                      f              f  I")
+renderLine(02,"I   f                                                                                                                                                                     I")
+renderLine(03,"I      t      f                                                                                                      f                                                    I")
+renderLine(04,"I                           f         f          f                f        f       f     f              f                          f            f                         I")
+renderLine(05,"I         f                                               f                                                                                                  f      f     I")
+renderLine(06,"If               f                                                                               f                f                                                       I")
+renderLine(07,"I                          f                                                     f                                            f                    D                      I")
+renderLine(08,"I                                      f              f         f     f                                                                        f       f                  I")
+renderLine(09,"I                                                                                                             f                      f                          f         I")
+renderLine(10,"I   f                                                                                                                  f                                                  I")
+renderLine(11,"I                    f                                  D      f               f               f      f                                   f                              fI")
+renderLine(12,"I           f                f          f       f                                                                   f                            f                        I")
+renderLine(13,"If                                                                                     f                                              f                                   I")
+renderLine(14,"I                                                                                                          f                   f                                          I")
+renderLine(15,"I                                f      f                    f            f                                       f                   f            f       f         f    I")
+renderLine(16,"I                                                   f                                                 f                                                                   I")
+renderLine(17,"I     f         f        f                                                         f      f                                                                      f        I")
+renderLine(18,"I                                                                       f                                           f        f                                            I")
+renderLine(19,"I                                 f           f                                                                  D                        f           f               f   I")
+renderLine(20,"I                                                       f        f                                   f                                                                    I")
+renderLine(21,"I    f        f              f                                              f                             f                                    f               f          I")
+renderLine(22,"I                                       f                                                      f                     f             f                                      I")
+renderLine(23,"I                                                                                     f                                                                                  fI")
+renderLine(24,"I                                                          f                                                                               f                              I")
+renderLine(25,"I           f        f                  f         f                f                                       f                                             f                I")
+renderLine(26,"If  f                                                                        f                       f                    f                                       f       I")
+renderLine(27,"I                                             f                                                                                     f           f                         I")
+renderLine(28,"I                                f                                                             f           f           f                                             f    I")
+renderLine(29,"I             f              f                           f         f                f                                              f                                      I")
+renderLine(30,"I    D                                                                                                                                                                    I")
+renderLine(31,"I       f                                                              f                        f       f                                              f       f          I")
+renderLine(32,"I                                      f    f        f                       f          f                                          f                                      I")
+renderLine(33,"I                 f                                                                                               f                           f                      f   fI")
+renderLine(34,"I                                                                                                                         f                                               I")
+renderLine(35,"I     f                 f           f               f             f        f          f           f         f                    f                       f                I")
+renderLine(36,"IIIIIIIIIIIIIIIIIIIIIIIIIIIII%%%%%%%%%%%%%%%%%%%#########%%%%%%%%%%%%%%%%%%%%PPPPPPPPPPPPPPPPPPPQQQQQQQQQQQQ#########################                                     I")
+renderLine(37,"I     f     f       f     f  HJJJJJJJJv        %         % lrrrrreeeeeejj   %FllPlllP~~~~~~~~~~PbAaAAaBaBbablllsss%llllRiiiiiiiiiNUUU              f                      I")
+renderLine(38,"I                            HJJJJJJJJv llllll % llp   #   l            l   %lllPlllP~2wwllww4~PbBBBbaBBBbAAlllsss%ggllRiiiiiiiiiiUUU                           f      f  I")
+renderLine(39,"I                            HJJJJJJJJv lzllSl   lll   ##% leeeerrrrll 3d1  %lllPlllP~wwwllwww~PbAaAaaAaBAAblllsssvlgllRiiiiiiiiiiUUU    f                                I")
+renderLine(40,"I                        f   HJJJJJJJJv llllll %         %           l rie  %lllPlllP~wwwllwww~PbabAbBBaBbablllsssvlgllRiiiiiiiiiiUUU                                     I")
+renderLine(41,"If     f                     HJJJJJJJJv        &xxxxxx^^^%TTTT  7uuuu9 9u7  %lllPlllP~llllllll~P:aBBbbbaBAAblllsssvlgllRiiiiiiiiiiUUU            f                        I")
+renderLine(42,"I               f            %%%%%%%%%%%%%%%%%%&xx@@@x^@@l===T  e7uu9r  l  lRlClVlllWlll?ly/ll;qAABaaAbABaBblllsss%ggllRiiiiiiiiiiUUU                       f             I")
+renderLine(43,"I                               f     #x@@cx@@@cxx@@@x^@@%TT=T  ee79rr llxll%lllPlllP~llllllll~P:bBabAaabaBblllsss%$$$$$iiiiiiiiiiUUU                                     I")
+renderLine(44,"I         f                         f #x@@cx@@@cxx@@@x^cc%===T  ee13rr lxxlx%lllPlllP~wwwllwww~PbAAABBBBBAAbxxxx^m%oooP$iiiiiiiiiiUUU                              f     fI")
+renderLine(45,"If                          f         #xxxxxxxx^^^^^^^^xx%=TTT  e1dd3r llxlx%lllPlllP~wwwllwww~PbBabbaAabbaaxxxx^l$lllo$iiiiiiiiiiUUU   f       f        f                I")
+renderLine(46,"I                                    f#x@@xx@@@xx@@@cxx@@%llllll1dddd3 lxxlx%lllPlllP~5wwllww6~PbAAAAaBAAAABxxxx^M$lllo$iiiiiiiiiiUUU                                     I")
+renderLine(47,"I                                     #x@@xxcccxx@@@cxx@@%llll         llllx%OllPlllP~~~~~~~~~~PbBbaBbbabBabxxxx^qqlllo$iiiiiiiiiNUUU                                     I")
+renderLine(48,"I                 f                  f##GG###############%%%%%%%%%%%%%%%%%%%%PPPPPPPPPPPPPPPPPPPQQQQQQQQQQQQ#########################                            f        I")
+renderLine(49,"I                        f                   f            f         f             f            f             f         f        f                  f                   f  I")
+renderLine(50,"If     f                              f                                                                                                                                   I")
+renderLine(51,"I               D                                                                                                                            f             f              I")
+renderLine(52,"I                                            f                             f                          f                                                          f       fI")
+renderLine(53,"I                                 f                                f                 f                        f        f            f                                     I")
+renderLine(54,"I                     f                                 f                                     f                                                                           I")
+renderLine(55,"If                                                                                                                                                 f                      I")
+renderLine(56,"I                                                                         f                            f                                                                  I")
+renderLine(57,"I                                                             f                                                                 f       f                         f       I")
+renderLine(58,"If                        f                 f                                                                     f                              f         f              I")
+renderLine(59,"I        f                         f                                                                                        f                                             I")
+renderLine(60,"I                                                     f         f          f                     f                                                                       fI")
+renderLine(61,"I                                                                                     f                                                                                   I")
+renderLine(62,"I               f                                                                                                                    f                        f      f    I")
+renderLine(63,"I                                             f                                                         f          f                                  D                   I")
+renderLine(64,"I                           f                                f           f                                                                                                I")
+renderLine(65,"I  f                                                              D                           f                                            f        f                     I")
+renderLine(66,"I                f                   f            f                                                                       f         f                          f         fI")
+renderLine(67,"I                                                                             f                                                                                           I")
+renderLine(68,"If       f                                                            f                 f                      f                                                   f      I")
+renderLine(69,"I                                                                                                    f                                                 f                  I")
+renderLine(70,"I                                                           f                                                                f            f                               I")
+renderLine(71,"I   f        f       f                    f      f                                                                                                              f         I")
+renderLine(72,"I                            f                                            f        f                               f                                                      I")
+renderLine(73,"I                                                                                                                                         f        f      f           f   I")
+renderLine(74,"I                                                      f       f                                 f        f                                                              fI")
+renderLine(75,"If                                      f                                                f                                    f                                           I")
+renderLine(76,"I                            f                                            f                                                                                               I")
+renderLine(77,"I          f       f                                                                                                                                  f           f       I")
+renderLine(78,"I                                                      f         f                                 f          f                        f                               f  I")
+renderLine(79,"I  f                                                                         f                                      f                        f              f             I")
+renderLine(80,"I    D                           f          f                                              f                                      f                                      fI")
+renderLine(81,"I                                                                                                       f                                            f                    I")
+renderLine(82,"If                                                                                                                                                           f            I")
+renderLine(83,"I    f     f             f            f              f            f            f       f            f                f          f               f                    f    I")
+renderLine(84,"IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII")
+
+
+bridgenumber=1
+bridgenumber2=1
+
+ttt=0
+
+bridge1gone=1
+bridge2gone=0
+bridge1done=0
+bridge2done=0
+
+function timer_callback()
+    if bridge1gone==1 and bridge1done==0 then
+        if ttt==10 then
+            set_floor("fl-abyss_fake",80,42)
+            --set_floor("fl-leaves",80,42)
+            ttt=-1
+            bridge1done=1
+        end
+        ttt=ttt+1
+    end
+    if bridge2gone==1 and bridge2done==0 then
+        if ttt==10 then
+            set_floor("fl-abyss_fake",84,42)
+            --set_floor("fl-leaves",84,42)
+            ttt=-1
+            ttt=-1
+            bridge2done=1
+        end
+        ttt=ttt+1
+    end
+end
+
+funcc1ready=1
+
+ttt2=0
+
+function timer_callback2()
+    ttt2=ttt2+1
+    if ttt2>15 and funcc1ready==0 then
+        SendMessage("switch5","on")
+        funcc1ready=1
+    else
+    end
+end
+
+f1=0
+function funcc1()
+    if funcc1ready==1 then
+        ttt2=0
+        funcc1ready=0
+        if f1==0 then
+            f1=1
+
+            enigma.KillItem(80,42)
+            set_floor("fl-bridge", 80,42, {name="bridgea"..bridgenumber,type="xx"})
+            bridgeaa=enigma.GetNamedObject("bridgea"..bridgenumber)
+            SendMessage(bridgeaa,"close")
+            bridgenumber=bridgenumber+1
+            set_item("it-abyss",80,42)
+            bridge1gone=0
+            bridge1done=0
+
+            enigma.KillItem(84,42)
+            SendMessage(bridgebb,"openclose")
+            --set_floor("fl-abyss_fake",84,42)
+            set_item("it-trigger",84,42,{invisible=1,action="callback",target="funcc2"})
+            bridge2gone=1
+
+        elseif f1==1 then
+            f1=0
+
+            enigma.KillItem(80,42)
+            SendMessage(bridgeaa,"open")
+            --set_floor("fl-abyss_fake",80,42)
+            set_item("it-trigger",80,42,{invisible=1,action="callback",target="funcc2"})
+
+            bridge1gone=1
+
+            enigma.KillItem(84,42)
+            set_floor("fl-bridge", 84,42, {name="bridgeb"..bridgenumber2,type="xx"})
+            bridgebb=enigma.GetNamedObject("bridgeb"..bridgenumber2)
+            SendMessage(bridgebb,"openclose")
+            bridgenumber2=bridgenumber2+1
+            bridge2gone=0
+            bridge2done=0
+
+            set_item("it-abyss",84,42)
+
+
+            set_item("it-abyss",84,42)
+
+        end
+    end
+end
+
+f11=0
+function funcc11()
+    if f11==0 then
+        f11=1
+
+        enigma.KillItem(80,42)
+        set_floor("fl-wood",80,42)
+        set_item("it-abyss",80,42)
+
+        enigma.KillItem(84,42)
+        set_floor("fl-abyss_fake",84,42)
+        set_item("it-trigger",84,42,{invisible=1,action="callback",target="funcc2"})
+
+    elseif f11==1 then
+        f1=0
+
+        enigma.KillItem(80,42)
+        set_floor("fl-abyss_fake",80,42)
+        set_item("it-trigger",80,42,{invisible=1,action="callback",target="funcc2"})
+
+        enigma.KillItem(84,42)
+        set_floor("fl-wood",84,42)
+        set_item("it-abyss",84,42)
+
+    end
+end
+
+function funcc2()
+end
+
+ff3=0
+function funcc3()
+    if ff3==0 then
+        ff3=1
+    elseif ff3==1 then
+        ff3=0
+    end
+    funcc7()
+end
+
+ff4=0
+function funcc4()
+    if ff4==0 then
+        ff4=1
+    elseif ff4==1 then
+        ff4=0
+    end
+    funcc7()
+end
+
+ff5=0
+function funcc5()
+    if ff5==0 then
+        ff5=1
+    elseif ff5==1 then
+        ff5=0
+    end
+    funcc7()
+end
+
+ff6=0
+function funcc6()
+    if ff6==0 then
+        ff6=1
+    elseif ff6==1 then
+        ff6=0
+    end
+    funcc7()
+end
+
+ff7=0
+function funcc7()
+    if ff3==1 and ff4==1 and ff5==1 and ff6==1 then
+        if ff7==0 then
+            ff7=1
+            --   SendMessage(bridge1,"close")
+            set_stone("st-greenbrown_hole",94,42)
+        end
+    else
+        if ff7==1 then
+            ff7=0
+            --      SendMessage(bridge1,"open")
+            set_stone("st-invisible",94,42)
+        end
+    end
+end
+
+set_stone( "st-timer", 179, 0,
+           {target="timer_callback", action="callback",
+            name="timer", interval=0.1} )
+set_stone( "st-timer", 179, 1,
+           {target="timer_callback2", action="callback",
+            name="timer2", interval=0.1} )
+
+oxyd_shuffle()
+
+--bridge1=enigma.GetNamedObject("bridge1")
+
+bridgebb=enigma.GetNamedObject("bridgeb0")
+SendMessage(bridgebb,"close")
+
+--SendMessage("switch1","on")
+--SendMessage("switch2","on")
+--SendMessage("switch3","on")
+--SendMessage("switch4","on")
+SendMessage("switch5","on")
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true" el:comment="read from the right">.moor txen eht ot teg ot syaw owt era erehT</el:english>
+      </el:string> 
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: branches/1.0/data/levels/enigma_iv/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_iv/index.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_iv/index.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -103,7 +103,7 @@
     <level _seq="95" _title="MetaPuzzle" _xpath="./ant03_1" author="Petr Machata" ctrl="force" easy="false" id="ant03" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="96" _title=".c.R.e.A.z.Y.w.O.r.L.d." _xpath="./martin100_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin100" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="97" _title="Over the Lake" _xpath="./siegfried27_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level9d" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="98" _title="Bizarro World" _xpath="./duffy73_1" author="Jacob Scott" ctrl="force" easy="true" id="duffy73" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="98" _title="Bizarro World" _xpath="./duffy73_2" author="Jacob Scott" ctrl="force" easy="true" id="duffy73" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="99" _title="Little Puzzles" _xpath="./wb11_1" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb11" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="100" _title="Big Adventures" _xpath="./wb12_1" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb12" rel="1" rev="0" score="1" target="time" unit="duration"/>
   </levels>

Modified: branches/1.0/data/levels/enigma_tutorial/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_tutorial/index.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_tutorial/index.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -55,7 +55,7 @@
     <level _seq="47" _title="Laser Spiral" _xpath="enigma_ii/duffy03_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy3" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="48" _title="Brittle Floor!" _xpath="enigma_iii/martin91_1" author="Martin Hawlisch" ctrl="force" easy="true" id="martin91" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="49" _title="Inverted Laser Spiral" _xpath="enigma_ii/duffy42_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy42" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="50" _title="- Meditation -" _xpath="enigma_i/siegfried35_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation14" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="50" _title="- Meditation -" _xpath="enigma_i/siegfried35_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation14" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="51" _title="Laser Games" _xpath="enigma_iv/mp03_1" author="moonpearl" ctrl="force" easy="false" id="mp03" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="52" _title="Items" _xpath="./a_tut05" author="Andreas Lochmann" ctrl="force" easy="false" id="a_tut05" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="53" _title="Flying" _xpath="enigma_i/luc07_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc07" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_v/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/index.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_v/index.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -31,7 +31,7 @@
     <level _seq="23" _title="Print 23" _xpath="./richi07_1" author="Richi B?tzer" ctrl="force" easy="false" id="richi07" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="24" _title="Space Pirates" _xpath="./siegfried19_2" author="Siegfried Fennig" ctrl="force" easy="false" id="level6a" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="25" _title="Laser Crossing" _xpath="./luc24_1" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc24" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="26" _title="The Cage" _xpath="./qq02_1" author="Andrzej Szombierski" ctrl="force" easy="false" id="qq2" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="26" _title="The Cage" _xpath="./qq02_1" author="Andrzej Szombierski" ctrl="force" easy="false" id="qq2" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="27" _title="Listen Carefully" _xpath="./duffy81_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy81" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="28" _title="Take Turns" _xpath="./duffy50_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy50" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="29" _title="The Carousel" _xpath="./luc30_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc30" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -69,7 +69,7 @@
     <level _seq="61" _title="Venice I" _xpath="./raoul16_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul16" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="62" _title="No way out?" _xpath="./just08_1" author="JuSt" ctrl="force" easy="false" id="just08" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="63" _title="Venice II" _xpath="./raoul17_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul17" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="64" _title="Walking around" _xpath="./just05_1" author="JuSt" ctrl="force" easy="false" id="just05" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="64" _title="Walking around" _xpath="./just05_2" author="JuSt" ctrl="force" easy="false" id="just05" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="65" _title="Elaborate" _xpath="./duffy126_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy126" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="66" _title="Trigger Happy" _xpath="./xerxes03_1" author="Xerxes M. Dynatos" ctrl="force" easy="false" id="xerxes03" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="67" _title="Gods of Enigma" _xpath="./mp01_1" author="moonpearl" ctrl="force" easy="false" id="mp01" rel="1" rev="0" score="1" target="time" unit="duration"/>

Deleted: branches/1.0/data/levels/enigma_v/just05_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/just05_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_v/just05_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -1,156 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Walking around" el:subtitle="" el:id="just05"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="JuSt" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? JuSt</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- !!BBE105!! Do not delete this line
-
-function file_oxyd(x,y,f)
-    oxyd_default_flavor=f
-    oxyd(x,y)
-end
-levelh=13
-levelw=20
-enigma.FlatForce=30
-enigma.SlopeForce=30
-enigma.ElectricForce=30
-cells={}
-items={}
-actors={}
-stones={}
-actors[" "]=cell{}
-stones[" "]=cell{}
-cells[" "]=cell{}
-items[" "]=cell{}
-cells["!"]=cell{floor="fl-concrete"}
-stones["!"]=cell{stone="st-rock7"}
-cells["#"]=cell{floor="fl-normal"}
-stones["#"]=cell{parent={{file_oxyd,"c"}}}
-stones["$"]=cell{stone="st-glass"}
-items["!"]=cell{item="it-blackbomb"}
-items["#"]=cell{item="it-trigger"}
-stones["%"]=cell{stone="st-stoneimpulse"}
-stones["&"]=cell{stone="st-mirror-3<tm"}
-stones["'"]=cell{stone="st-grate1"}
-stones["("]=cell{stone="st-shogun-sml"}
-stones[")"]=cell{stone="st-door-v"}
-stones["*"]=cell{stone="st-mirror-3<"}
-items["$"]=cell{item="it-shogun-l"}
-stones["+"]=cell{stone="st-oneway-s"}
-stones[","]=cell{stone="st-stoneimpulse-hollow"}
-stones["-"]=cell{stone="st-laser-n"}
-stones["."]=cell{stone="st-mirror-p-"}
-stones["/"]=cell{stone="st-mirror-p/"}
-stones["0"]=cell{stone="st-oneway-w"}
-cells["$"]=cell{floor="fl-abyss"}
-stones["1"]=cell{stone="st-wood"}
-stones["2"]=cell{stone="st-oneway-n"}
-function ac_blackball(x,y)
-n=""
-p=0
-f=0
- if (x==10) and (y==6) then
-  n="ac10x6"
-  p=0
-  mf=1
- end
-set_actor("ac-blackball",x+0.5,y+0.5,{player=p,name=n,mouseforce=mf})
-end
-actors["!"]=cell{parent={{ac_blackball}}}
-items["%"]=cell{item="it-seed"}
-stones["3"]=cell{stone="st-turnstile-w"}
-stones["4"]=cell{stone="st-oneway-e"}
-stones["5"]=cell{stone="st-turnstile"}
-stones["6"]=cell{stone="st-turnstile-s"}
-stones["7"]=cell{stone="st-turnstile-e"}
-stones["8"]=cell{stone="st-puzzle2-ns"}
-stones["9"]=cell{stone="st-puzzle2-ne"}
-stones[":"]=cell{stone="st-puzzle2-s"}
-stones[";"]=cell{stone="st-puzzle2-n"}
-stones["<"]=cell{stone="st-puzzle2-ew"}
-stones["="]=cell{stone="st-turnstile-n"}
-stones[">"]=cell{stone="st-puzzle2-sw"}
-level={"!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!$!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!"}
-   acmap={"                    ",
-          "                    ",
-          "                    ",
-          "                    ",
-          "                    ",
-          "                    ",
-          "          !         ",
-          "                    ",
-          "                    ",
-          "                    ",
-          "                    ",
-          "                    ",
-          "                    "}
-  itmap={"                    ",
-         "  !!!!  !           ",
-         " !!     !           ",
-         " !!     !           ",
-         " #!         !       ",
-         "                    ",
-         "                    ",
-         "          %         ",
-         "   $              ! ",
-         "                    ",
-         "                    ",
-         "                    ",
-         "                    "}
- stmap={"!!!!!!!!!!!!!!!!!!!!",
-        "!#$   '.   !   8''#!",
-        "!$$*   '   !   9'''!",
-        "! & & '' !2! ! :8<<!",
-        "!     '/ ! 4 !  ;  !",
-        "!!!!!!-! !2!!!    >!",
-        "!%%%%  0 0 4 4     !",
-        "!%' %  !!!+! !!!!!!!",
-        "!%( %      ! 57  = !",
-        "!%%%%  !1!+! 6  357!",
-        "!!!    !,!35  57 6 !",
-        "!#)+!!!!,!    6   #!",
-        "!!%,,,,,,!!!!!!!!!!!"}
-create_world_by_map(level)
-draw_map(0,0,stmap,stones)
-draw_map(0,0,itmap,items)
-draw_map(0,0,acmap,actors)
-SetAttrib(enigma.GetItem(1,4),"invisible",FALSE)
-SetAttrib(enigma.GetStone(6,5),"init",FALSE)
-Signal ("it(1 4)","st(6 5)")
-Signal ("it(3 8)","st(2 11)")
-oxyd_shuffle()
-display.SetFollowMode(display.FOLLOW_SCROLLING)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: branches/1.0/data/levels/enigma_v/just05_2.xml (from rev 565, branches/1.0/data/levels/enigma_v/just05_1.xml)
===================================================================
--- branches/1.0/data/levels/enigma_v/just05_1.xml	2007-01-04 21:05:50 UTC (rev 565)
+++ branches/1.0/data/levels/enigma_v/just05_2.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -0,0 +1,141 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Walking around" el:subtitle="" el:id="just05"/>
+      <el:version el:score="2" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="JuSt" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? JuSt</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- !!BBE105!! Do not delete this line
+
+function file_oxyd(x,y,f)
+    oxyd_default_flavor=f
+    oxyd(x,y)
+end
+
+levelh=13
+levelw=20
+
+enigma.FlatForce=30
+enigma.SlopeForce=30
+enigma.ElectricForce=30
+
+cells={}
+items={}
+stones={}
+
+stones[" "]=cell{}
+cells[" "]=cell{}
+items[" "]=cell{}
+
+cells["!"]=cell{floor="fl-concrete"}
+stones["!"]=cell{stone="st-rock7"}
+cells["#"]=cell{floor="fl-normal"}
+stones["#"]=cell{parent={{file_oxyd,"c"}}}
+stones["$"]=cell{stone="st-glass"}
+items["!"]=cell{item="it-blackbomb"}
+items["#"]=cell{item="it-trigger"}
+stones["%"]=cell{stone="st-stoneimpulse"}
+stones["&"]=cell{stone="st-mirror-3<tm"}
+stones["'"]=cell{stone="st-grate1"}
+stones["("]=cell{stone="st-shogun-sml"}
+stones[")"]=cell{stone="st-door-v"}
+stones["*"]=cell{stone="st-mirror-3<"}
+items["$"]=cell{item="it-shogun-l"}
+stones["+"]=cell{stone="st-oneway-s"}
+stones[","]=cell{stone="st-stoneimpulse-hollow"}
+stones["-"]=cell{stone="st-laser-n"}
+stones["."]=cell{stone="st-mirror-p-"}
+stones["/"]=cell{stone="st-mirror-p/"}
+stones["0"]=cell{stone="st-oneway-w"}
+cells["$"]=cell{floor="fl-abyss"}
+stones["1"]=cell{stone="st-wood"}
+stones["2"]=cell{stone="st-oneway-n"}
+items["%"]=cell{item="it-seed"}
+stones["3"]=cell{stone="st-turnstile-w"}
+stones["4"]=cell{stone="st-oneway-e"}
+stones["5"]=cell{stone="st-turnstile"}
+stones["6"]=cell{stone="st-turnstile-s"}
+stones["7"]=cell{stone="st-turnstile-e"}
+stones["8"]=cell{stone="st-puzzle2-ns"}
+stones["9"]=cell{stone="st-puzzle2-ne"}
+stones[":"]=cell{stone="st-puzzle2-s"}
+stones[";"]=cell{stone="st-puzzle2-n"}
+stones["<"]=cell{stone="st-puzzle2-ew"}
+stones["="]=cell{stone="st-turnstile-n"}
+stones[">"]=cell{stone="st-puzzle2-sw"}
+
+level={"!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!$!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!"}
+itmap={"                    ",
+       "  !!!!  !           ",
+       " !!     !           ",
+       " !!     !           ",
+       " #!         !       ",
+       "                    ",
+       "                    ",
+       "          %         ",
+       "   $              ! ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    "}
+stmap={"!!!!!!!!!!!!!!!!!!!!",
+       "!#$   '.   !   8''#!",
+       "!$$*   '   !   9'''!",
+       "! & & '' !2! ! :8<<!",
+       "!     '/ ! 4 !  ;  !",
+       "!!!!!!-! !2!!!    >!",
+       "!%%%%  0 0 4 4     !",
+       "!%' %  !!!+! !!!!!!!",
+       "!%( %      ! 57  = !",
+       "!%%%%  !1!+! 6  357!",
+       "!!!    !,!35  57 6 !",
+       "!#)+!!!!,!    6   #!",
+       "!!%,,,,,,!!!!!!!!!!!"}
+create_world_by_map(level)
+draw_map(0,0,stmap,stones)
+draw_map(0,0,itmap,items)
+
+enigma.ConserveLevel=FALSE
+display.SetFollowMode(display.FOLLOW_SCROLLING)
+
+set_actor("ac-blackball",10.5,6.5,{player=0})
+
+SetAttrib(enigma.GetItem(1,4),"invisible",FALSE)
+SetAttrib(enigma.GetStone(6,5),"init",FALSE)
+
+Signal ("it(1 4)","st(6 5)")
+Signal ("it(3 8)","st(2 11)")
+
+oxyd_shuffle()
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: branches/1.0/data/levels/enigma_v/qq02_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/qq02_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_v/qq02_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="The Cage" el:subtitle="" el:id="qq2"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Andrzej Szombierski" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? Andrzej Szombierski</el:copyright>
       <el:license el:type="see Lua code below" el:open="true"/>
@@ -157,6 +157,7 @@
 -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
 
 create_world( strlen(level[1]), getn(level) )
+enigma.ConserveLevel=FALSE
 fill_floor("fl-leaves")
     
 for y,line in pairs(level) do

Modified: branches/1.0/data/levels/enigma_vi/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/index.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_vi/index.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -20,7 +20,7 @@
     <level _seq="12" _title="Oxydmoron" _xpath="./raoul14_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul14" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="13" _title="Rhapsody on Cracks" _xpath="./ral06_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060510ral008" rel="1" rev="42" score="1" target="time" unit="duration"/>
     <level _seq="14" _title="ZigZag" _xpath="./ralf06_1" author="Ralf Westram" ctrl="force" easy="true" id="ralf06" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="15" _title="Step gently!" _xpath="./malla03_1" author="Manuel K?nig" ctrl="force" easy="false" id="malla03" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="15" _title="Step gently!" _xpath="./malla03_1" author="Manuel K?nig" ctrl="force" easy="false" id="malla03" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="16" _title="Just Stay Calm" _xpath="./duffy116_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy116" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="17" _title="Bomb raider" _xpath="./alain27_1" author="Alain Busser" ctrl="force" easy="true" id="alain27" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="18" _title="Evil" _xpath="./spaceman04_1" author="Spaceman" ctrl="force" easy="false" id="spaceman4" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_vi/malla03_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/malla03_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_vi/malla03_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Step gently!" el:subtitle="" el:id="malla03"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Manuel K?nig" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2006 Manuel K?nig</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -42,8 +42,8 @@
 set_item("it-yinyang", 14, 6)
 set_item("it-yinyang", 4, 6)
 
-set_actor("ac-blackball", 4.5, 6.5, {player=0})
-wb = set_actor("ac-whiteball", 14.5,6.5, {player=1}) 
+set_actor("ac-blackball", 4.5, 6.5, {player=0, essential=1})
+wb = set_actor("ac-whiteball", 14.5,6.5, {player=1, essential=1}) 
 swb = set_actor("ac-whiteball-small", 15.5, 6.5, {controllers=0})
 
 AddRubberBand(wb, swb, 50, 0.2)

Modified: branches/1.0/data/levels/enigma_vi/raoul20_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/raoul20_1.xml	2007-01-04 23:11:03 UTC (rev 566)
+++ branches/1.0/data/levels/enigma_vi/raoul20_1.xml	2007-01-06 16:42:00 UTC (rev 567)
@@ -14,13 +14,13 @@
       <el:comments>
         <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
       </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
+      <el:score el:easy="-" el:difficult="1:16"/>
     </el:info>
     <el:luamain><![CDATA[
-
 levelh=13
 levelw=20
 enigma.FrictionFactor=2.5
+
 oxydlist = {}
 oxydnumber = 0
 triggernumber = 0
@@ -32,6 +32,7 @@
 stones[" "]=cell{}
 cells[" "]=cell{}
 items[" "]=cell{}
+
 function file_oxyd(x,y,f)
     oxyd_default_flavor=f
     oxydnumber = oxydnumber + 1
@@ -42,6 +43,7 @@
     set_stone("st-oxyd", x, y, {flavor=f, color=tostring(colournumber),
              name="myoxyd"..tostring(oxydnumber)})
 end
+
 function set_trigger(x,y)
     -- Assume the stones had been set before the items - then oxydnumber
     -- holds the total number of oxyds!
@@ -54,6 +56,7 @@
     set_item("it-trigger", x, y, 
         {action="trigger", target="myoxyd"..tostring(triggernumber), invisible=TRUE})
 end
+
 stones["n"]=cell{stone="st-laser-n"}
 stones["e"]=cell{stone="st-laser-e"}
 stones["s"]=cell{stone="st-laser-s"}
@@ -64,7 +67,6 @@
 items["h"]=cell{item="it-abyss"}
 items["t"]=cell{parent={{set_trigger}}}
 cells[" "]=cell{floor="fl-abyss"}
---cells["-"]=cell{floor="fl-black"}
 cells["-"]=cell{floor="fl-abyss_fake"}
 cells["+"]=cell{floor="fl-white"}
 level={"                    ",
@@ -126,9 +128,12 @@
 draw_map(0,0,stmap,stones)
 draw_map(0,0,itmap,items)
 --oxyd_shuffle()
+
 set_actor("ac-whiteball",4.5,6.5,{player=0,controllers=1})
+
 --LASERRING COUNTERCLOCKWISE:
 set_stone("st-switch_white", 1, 1, {action = "callback", target = "ring1"})
+
 function ring1()
   SendMessage(enigma.GetStone(8,0), "onoff")
   SendMessage(enigma.GetStone(19,1), "onoff")
@@ -143,11 +148,8 @@
   SendMessage(enigma.GetStone(8,12), "onoff")
   SendMessage(enigma.GetStone(19,11), "onoff")
 end
+
 --TRIGGER TO OPEN THE OXYD STONES:
---tkoords={{11,5},{12,4},{14,4},{15,5},{15,7},{14,8},{12,8},{11,7}}
---for i = 1, 8 do
---    set_item("it-trigger", tkoords[i][1], tkoords[i][2],{action = "callback", target = "oxon", invisible=TRUE, mynr = i})
---end
 --activate the oxyds:
 function oxon(trigger,sender)
     local t = enigma.GetAttrib(sender, "mynr")
@@ -164,6 +166,7 @@
     local ob=enigma.GetStone(koords[1],koords[2])
     SendMessage (ob, 'trigger')
 end
+
 --TRIGGERFELD TO ACTIVATE THE LASER 
 for i = 1, 5 do
     for j = 1, 5 do
@@ -175,6 +178,7 @@
        end
     end
 end
+
 function laserron(onoff,sender)
   local x,y = enigma.GetPos(sender)
   --local x = enigma.GetAttrib(sender, "myx")



From ral at mail.berlios.de  Tue Jan  9 23:04:54 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Tue, 9 Jan 2007 23:04:54 +0100
Subject: [Enigma-game-svn] r568 - in trunk: data src
Message-ID: <200701092204.l09M4sjk000181@sheep.berlios.de>

Author: ral
Date: 2007-01-09 23:04:53 +0100 (Tue, 09 Jan 2007)
New Revision: 568

Modified:
   trunk/data/models-2d.lua
   trunk/data/models.lua
   trunk/src/actors.cc
   trunk/src/stones_complex.cc
Log:
Performance tuning VII a:
- speedup sprite display by adjusting padding info for some actors
Cleanup:
- use Lua 5 booleans and functions in model*
Note:
- proper padding of actors can speedup display by a factor of 2-3


Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2007-01-06 16:42:00 UTC (rev 567)
+++ trunk/data/models-2d.lua	2007-01-09 22:04:53 UTC (rev 568)
@@ -15,7 +15,6 @@
 -- with this program; if not, write to the Free Software Foundation, Inc.,
 -- 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
 --
--- $Id: models-2d.lua,v 1.124 2004/05/27 20:30:47 dheck Exp $
 ------------------------------------------------------------------------
 
 -- This file defines the models used in Enigma.
@@ -25,7 +24,6 @@
 def_image("dummy")
 def_image("invisible")
 
-TRUE, FALSE = 1, 0
 
 function SpriteImages(spriteimg, n, offsetfactor, padding)
     local factor = offsetfactor or 0.5
@@ -52,14 +50,14 @@
     local nframes = getn(images)
     for i=1,getn(images) do
         def_shmodel(name..i, images[i], shadows[mod (i, getn(shadows))] )
-        tinsert(frames, name..i)
+        table.insert(frames, name..i)
     end
     def_anim (name, buildframes(frames, framelen), loop)
 end
 
 function Sprite(descr)
     local imgfile = descr.imgfile or descr.name
-    local loop    = descr.loop or FALSE
+    local loop    = descr.loop or false
     local img     = SpriteImages(imgfile, descr.nimages, 0.5, descr.padding)
     def_anim(descr.name, buildframes(img, descr.framelen), loop)
 end
@@ -79,9 +77,9 @@
     frames={}
     for i=1,9 do
         def_shmodel("ac-top"..i, img[i], "sh-top")
-        tinsert(frames, "ac-top"..i)
+        table.insert(frames, "ac-top"..i)
     end
-    def_anim("ac-top", buildframes(frames, 25), TRUE)
+    def_anim("ac-top", buildframes(frames, 25), true)
 end
 
 -----------
@@ -94,9 +92,9 @@
     frames={}
     for i=1,9 do
         def_shmodel("ac-rotor"..i, fg[i], bg[i])
-        tinsert(frames, "ac-rotor"..i)
+        table.insert(frames, "ac-rotor"..i)
     end
-    def_anim("ac-rotor", buildframes(frames, 30), TRUE)
+    def_anim("ac-rotor", buildframes(frames, 30), true)
 end
 
 -----------
@@ -115,20 +113,20 @@
     local fg,img
 
     -- Normal
-    SpriteImage ("sh-whiteball-small", 0.4, 0.3)
-    SpriteImage ("fg-whiteball-small", 0.5, 0.3) 
+    SpriteImage ("sh-whiteball-small", 0.4, 0.41)
+    SpriteImage ("fg-whiteball-small", 0.5, 0.43) 
     def_shmodel("ac-whiteball-small", "fg-whiteball-small", "sh-whiteball-small")
     def_alias ("ac-whiteball-small-shine", "ac-whiteball-small")
 
     -- Falling
-    img=SpriteImages ("ac-whiteball-small-fall", 5)
-    tinsert(img, "invisible")
+    img=SpriteImages ("ac-whiteball-small-fall", 5, 0.5, 0.43)
+    table.insert(img, "invisible")
     def_anim("ac-whiteball-small-fall", composeframes(img,{70,65,60,55,50,30}))
     def_alias("ac-whiteball-small-fallen", "invisible")
 
     -- Appearing / disappearing
     def_anim("ac-whiteball-small-appear", reverseframes(buildframes(img, 25)))
-    def_anim("ac-whiteball-small-disappear", buildframes(img, 25))
+    def_anim("ac-whiteball-small-disappear", buildframes(img, 35))
 
     -- Shattering
     img=SpriteImages ("ac-whiteball-small-shatter", 5)
@@ -154,7 +152,7 @@
     frames   = {}
     for i=1,4 do
         def_shmodel("sb-jump"..i, namelist[i], shadows[i])
-        tinsert(frames, "sb-jump"..i)
+        table.insert(frames, "sb-jump"..i)
     end
     def_anim("ac-whiteball-small-jump", pingpong(buildframes(frames, 70)))
 end
@@ -195,8 +193,8 @@
     local img,f,sh
 
     -- Normal
-    sh = SpriteImage("sh-blackball", 0.4, 0.2)
-    img = SpriteImages("fg-blackball", 2, 0.5, 0.25)
+    sh = SpriteImage("sh-blackball", 0.4, 0.29)
+    img = SpriteImages("fg-blackball", 2, 0.5, 0.34)
     def_shmodel("ac-blackball", "fg-blackball1", "sh-blackball")
     def_shmodel("ac-blackball-shine", "fg-blackball2", "sh-blackball")
 
@@ -208,7 +206,7 @@
 
     -- Appearing / disappearing
     def_anim("ac-blackball-appear", reverseframes(buildframes(img, 25)))
-    def_anim("ac-blackball-disappear", buildframes(img, 25))
+    def_anim("ac-blackball-disappear", buildframes(img, 35))
 
     def_alias("ac-blackball-shattered", "ac-blackball-shatter5")
 end
@@ -224,7 +222,7 @@
 
     -- Normal
     def_alias("sh-whiteball", "sh-blackball")
-    img=SpriteImage ("fg-whiteball")
+    img=SpriteImage ("fg-whiteball", 0.5, 0.34)
 --    def_image("fg-wb", {filename="ac-whiteball", xoff=-9, yoff=-9})
     def_shmodel("ac-whiteball", "fg-whiteball", "sh-whiteball")
     def_alias("ac-whiteball-shine", "ac-whiteball")
@@ -237,7 +235,7 @@
 
     -- Appearing / disappearing
     def_anim("ac-whiteball-appear", reverseframes(buildframes(img, 25)))
-    def_anim("ac-whiteball-disappear", buildframes(img, 25))
+    def_anim("ac-whiteball-disappear", buildframes(img, 35))
 
     -- Shattering
 
@@ -251,7 +249,7 @@
     frames   = {}
     for i=1,4 do
         def_shmodel("bb-jump"..i, namelist[i], shadows[i])
-        tinsert(frames, "bb-jump"..i)
+        table.insert(frames, "bb-jump"..i)
     end
     def_anim("ac-blackball-jump", pingpong(buildframes(frames, 70)))
 
@@ -259,7 +257,7 @@
     frames   = {}
     for i=1,4 do
         def_shmodel("wb-jump"..i, namelist[i], shadows[i])
-        tinsert(frames, "wb-jump"..i)
+        table.insert(frames, "wb-jump"..i)
     end
     def_anim("ac-whiteball-jump", pingpong(buildframes(frames, 70)))
 end
@@ -461,13 +459,13 @@
 do
     local models={"it-puller-n", "it-puller-e", "it-puller-s", "it-puller-w"}
     local frames=buildframes(models, 100)
-    def_anim("it-puller-active", repeatanim(frames, 4), FALSE)
+    def_anim("it-puller-active", repeatanim(frames, 4), false)
 end
 
 do
     local n=def_subimages("it-coffee", {h=4})
     local f=buildframes(n,150)
-    def_anim("it-coffee", f, TRUE)
+    def_anim("it-coffee", f, true)
 end
 
 -- Some more Items
@@ -553,7 +551,7 @@
 -- Wormhole --
 do
     local f = buildframes(def_subimages("it-wormhole", {h=2}), 100)
-    def_anim("it-wormhole", f, TRUE)
+    def_anim("it-wormhole", f, true)
     def_alias("it-wormhole-off", "it-wormhole1")
 end
 
@@ -775,7 +773,7 @@
       def_roundstone("st-blocker", n[1])
       frames={}
       for i=4,2,-1 do
-         tinsert(frames, "st-blocker"..i)
+         table.insert(frames, "st-blocker"..i)
       end
       def_anim("blocker-growing-fg", buildframes(frames, 60))
       def_anim("blocker-growing-bg", buildframes(sh, 60))
@@ -791,10 +789,10 @@
 -- Rotator stones
 do
     local n=def_subimages("st-rotator-left", {h=8})
-    def_anim("st-rotator-left-anim", buildframes(n, 70), FALSE)
+    def_anim("st-rotator-left-anim", buildframes(n, 70), false)
     def_roundstone("st-rotator-left", "st-rotator-left-anim")
     n=def_subimages("st-rotator-right", {h=8})
-    def_anim("st-rotator-right-anim", buildframes(n, 70), FALSE)
+    def_anim("st-rotator-right-anim", buildframes(n, 70), false)
     def_roundstone("st-rotator-right", "st-rotator-right-anim")
 end
 
@@ -994,7 +992,7 @@
 
         -- compose these images into an animation
         frames = pingpong(buildframes(names, 100))
-        def_anim(n.."-anim", frames, TRUE)
+        def_anim(n.."-anim", frames, true)
 
         -- and finally add a shadow to make the model complete
         def_shmodel(n, n.."-anim", shadow[flavor])
@@ -1119,10 +1117,10 @@
    namelist = def_subimages("st-stoneimpulse", {h=4})
    def_roundstone("st-stoneimpulse", namelist[1])
    frames={}
-   for i=1,4 do tinsert(frames, namelist[i]) end
+   for i=1,4 do table.insert(frames, namelist[i]) end
    def_anim("stoneimpulse-anim1", buildframes(frames, 55))
    def_roundstone("st-stoneimpulse-anim1", "stoneimpulse-anim1")
-   tinsert(frames, namelist[4]) -- add 1 frame to make closing anim longer!
+   table.insert(frames, namelist[4]) -- add 1 frame to make closing anim longer!
    def_anim("stoneimpulse-anim2", reverseframes(buildframes(frames, 55)))
    def_roundstone("st-stoneimpulse-anim2", "stoneimpulse-anim2")
 end
@@ -1131,10 +1129,10 @@
    namelist = def_subimages("st-stoneimpulse-hollow", {h=4})
    def_shmodel("st-stoneimpulse-hollow", namelist[1], "sh-floating")
    frames={}
-   for i=1,4 do tinsert(frames, namelist[i]) end
+   for i=1,4 do table.insert(frames, namelist[i]) end
    def_anim("stoneimpulse-hollow-anim1", buildframes(frames, 55))
    def_shmodel("st-stoneimpulse-hollow-anim1", "stoneimpulse-hollow-anim1", "sh-floating")
-   tinsert(frames, namelist[4]) -- add 1 frame to make closing anim longer!
+   table.insert(frames, namelist[4]) -- add 1 frame to make closing anim longer!
    def_anim("stoneimpulse-hollow-anim2", reverseframes(buildframes(frames, 55)))
    def_shmodel("st-stoneimpulse-hollow-anim2", "stoneimpulse-hollow-anim2", "sh-floating")
 end
@@ -1556,12 +1554,12 @@
     function def_bolder(orient, start)
        local animname="st-bolder"..orient.."a"
        local frames={img[start], img[start+1], img[start+2]}
-       def_anim(animname, buildframes(frames, 120), FALSE)
+       def_anim(animname, buildframes(frames, 120), false)
        def_shmodel("st-bolder-"..orient, animname, "sh-round")
 
        animname="st-bolder-"..orient.."-fall-anim"
        frames={imgfall[start],imgfall[start+1],imgfall[start+2]}
-       def_anim(animname, buildframes(frames, 120), FALSE)
+       def_anim(animname, buildframes(frames, 120), false)
     end
 
     def_bolder("n",1)
@@ -1608,14 +1606,14 @@
     def_shmodel("st-lightpassenger", img[1], "sh-glass")
     def_alias("st-lightpassenger_off", "st-glass2")
     local frames={img[2], img[3], img[4], img[5], img[6], img[7]}
-    def_anim("st-lightpassenger-blink1", pingpong(buildframes(frames, 75)), TRUE)
+    def_anim("st-lightpassenger-blink1", pingpong(buildframes(frames, 75)), true)
     def_shmodel("st-lightpassenger-blink", "st-lightpassenger-blink1", "sh-glass")
     img = def_subimages("st-lightpassenger-break-v", {h=7})
-    def_anim("st-lightpassenger-break-v", buildframes(img, 50), FALSE)
+    def_anim("st-lightpassenger-break-v", buildframes(img, 50), false)
     img = def_subimages("st-lightpassenger-break-h", {h=7})
-    def_anim("st-lightpassenger-break-h", buildframes(img, 50), FALSE)
+    def_anim("st-lightpassenger-break-h", buildframes(img, 50), false)
     img = def_subimages("st-lightpassenger-break-hv", {h=7})
-    def_anim("st-lightpassenger-break-hv", buildframes(img, 50), FALSE)
+    def_anim("st-lightpassenger-break-hv", buildframes(img, 50), false)
 end
 
 -------------
@@ -1641,13 +1639,13 @@
     name     = "halo",
     nimages  = 2,
     framelen = 30,
-    loop     = TRUE
+    loop     = true
 }
 Sprite{
     name     = "halo-blink",
     nimages  = 2,
     framelen = 30,
-    loop     = TRUE
+    loop     = true
 }
 
 -- Halo for small balls --
@@ -1655,13 +1653,13 @@
     name     = "halo-small",
     nimages  = 2,
     framelen = 30,
-    loop     = TRUE
+    loop     = true
 }
 Sprite{
     name     = "halo-small-blink",
     nimages  = 2,
     framelen = 30,
-    loop     = TRUE
+    loop     = true
 }
 
 Progress(100, "Loading Oxyd levels")

Modified: trunk/data/models.lua
===================================================================
--- trunk/data/models.lua	2007-01-06 16:42:00 UTC (rev 567)
+++ trunk/data/models.lua	2007-01-09 22:04:53 UTC (rev 568)
@@ -15,7 +15,6 @@
 -- with this program; if not, write to the Free Software Foundation, Inc.,
 -- 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
 --
--- $Id: models.lua,v 1.11 2004/05/27 20:30:44 dheck Exp $
 ------------------------------------------------------------------------
 
 -- This file contains common routines for defining new Enigma models.
@@ -106,7 +105,7 @@
             r.y = r.y + padding
             r.w = r.w - 2*padding
             r.h = r.h - 2*padding
-            tinsert(imagelist, modelname..cnt)
+            table.insert(imagelist, modelname..cnt)
             err = display.DefineSubImage(modelname..cnt, name, xoff+padding,yoff+padding, r)
             if err ~= 0 then
                 error ("Could not define "..modelname..cnt..": error loading "..name)
@@ -231,7 +230,7 @@
 function framenames(prefix, first, last)
     local fn = {}
     for i=first,last do
-	tinsert(fn, prefix .. format("_%04d", i))
+	table.insert(fn, prefix .. format("_%04d", i))
     end
     return fn
 end
@@ -272,7 +271,7 @@
     for i=1,getn(framelist),blocksize do
 	for j=1,cnt do
 	    for k=i,i+blocksize-1 do
-		tinsert(a,framelist[k])
+		table.insert(a,framelist[k])
 	    end
 	end
     end
@@ -286,7 +285,7 @@
 function reverseframes(framelist)
     local a={}
     for i=getn(framelist),1,-1 do
-	tinsert(a, framelist[i])
+	table.insert(a, framelist[i])
     end
     return a
 end
@@ -297,7 +296,7 @@
 
 function def_anim_images(name, frames, opt)
     opt = opt or {}
-    local loopbool = opt.loop and (opt.loop == 1 or opt.loop == true) or false
+    local loopbool = opt.loop and true or false
     display.DefineAnim(name, loopbool)
     for i=1,getn(frames) do
 	local frame=frames[i]
@@ -311,7 +310,7 @@
 -- Define an animation from a list of models.
 
 function def_anim(name, frames, loop)
-    local loopbool = loop and (loop == 1 or loop == true) or false
+    local loopbool = loop and true or false
     display.DefineAnim(name,loopbool)
     for i=1,getn(frames) do
 	local frame = frames[i]

Modified: trunk/src/actors.cc
===================================================================
--- trunk/src/actors.cc	2007-01-06 16:42:00 UTC (rev 567)
+++ trunk/src/actors.cc	2007-01-09 22:04:53 UTC (rev 568)
@@ -23,6 +23,7 @@
 #include "sound.hh"
 #include "server.hh"
 #include "world.hh"
+//#include "main.hh"
 
 #include <iostream>
 #include <set>

Modified: trunk/src/stones_complex.cc
===================================================================
--- trunk/src/stones_complex.cc	2007-01-06 16:42:00 UTC (rev 567)
+++ trunk/src/stones_complex.cc	2007-01-09 22:04:53 UTC (rev 568)
@@ -24,6 +24,7 @@
 #include "player.hh"
 #include "Inventory.hh"
 #include "stones_internal.hh"
+//#include "main.hh"
 
 #include "ecl_util.hh"
 
@@ -2272,7 +2273,7 @@
         break;
 
     case OPEN:
-	if (oldstate == CLOSED) {
+    	if (oldstate == CLOSED) {
             sound_event("oxydopen");
             sound_event("oxydopened");
             set_anim(modelname+"-opening");
@@ -2282,8 +2283,7 @@
         /* If this was the last closed oxyd stone, finish the
            level */
         if (find_if(instances.begin(),instances.end(),not_open)
-            ==instances.end())
-        {
+                == instances.end()) {
             server::FinishLevel();
         }
         break;
@@ -2306,7 +2306,7 @@
         sound_event("oxydclose");
         if (oldstate == OPENING)
             get_model()->reverse();
-	else if (oldstate == BLINKING || oldstate == OPEN) {
+    	else if (oldstate == BLINKING || oldstate == OPEN) {
             set_anim(modelname + "-closing");
         }
         break;



From ral at mail.berlios.de  Thu Jan 11 00:04:08 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Thu, 11 Jan 2007 00:04:08 +0100
Subject: [Enigma-game-svn] r569 - in trunk: data src
Message-ID: <200701102304.l0AN48db025881@sheep.berlios.de>

Author: ral
Date: 2007-01-11 00:04:06 +0100 (Thu, 11 Jan 2007)
New Revision: 569

Modified:
   trunk/data/models-2d.lua
   trunk/src/d_models.cc
   trunk/src/d_models.hh
Log:
Performance tuning VII b:
- cache fixed extensions of shadow models and animations
Fix:
- some accidentially modified timings in r568
Note:
- the caching fixes problems with small whiteball disappearing animation caused
  by varying extensions within the animation, revealed by r566


Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2007-01-09 22:04:53 UTC (rev 568)
+++ trunk/data/models-2d.lua	2007-01-10 23:04:06 UTC (rev 569)
@@ -126,7 +126,7 @@
 
     -- Appearing / disappearing
     def_anim("ac-whiteball-small-appear", reverseframes(buildframes(img, 25)))
-    def_anim("ac-whiteball-small-disappear", buildframes(img, 35))
+    def_anim("ac-whiteball-small-disappear", buildframes(img, 25))
 
     -- Shattering
     img=SpriteImages ("ac-whiteball-small-shatter", 5)
@@ -194,7 +194,7 @@
 
     -- Normal
     sh = SpriteImage("sh-blackball", 0.4, 0.29)
-    img = SpriteImages("fg-blackball", 2, 0.5, 0.34)
+    img = SpriteImages("fg-blackball", 2, 0.5, 0.32)
     def_shmodel("ac-blackball", "fg-blackball1", "sh-blackball")
     def_shmodel("ac-blackball-shine", "fg-blackball2", "sh-blackball")
 
@@ -206,7 +206,7 @@
 
     -- Appearing / disappearing
     def_anim("ac-blackball-appear", reverseframes(buildframes(img, 25)))
-    def_anim("ac-blackball-disappear", buildframes(img, 35))
+    def_anim("ac-blackball-disappear", buildframes(img, 25))
 
     def_alias("ac-blackball-shattered", "ac-blackball-shatter5")
 end
@@ -222,7 +222,7 @@
 
     -- Normal
     def_alias("sh-whiteball", "sh-blackball")
-    img=SpriteImage ("fg-whiteball", 0.5, 0.34)
+    img=SpriteImage ("fg-whiteball", 0.5, 0.32)
 --    def_image("fg-wb", {filename="ac-whiteball", xoff=-9, yoff=-9})
     def_shmodel("ac-whiteball", "fg-whiteball", "sh-whiteball")
     def_alias("ac-whiteball-shine", "ac-whiteball")
@@ -235,7 +235,7 @@
 
     -- Appearing / disappearing
     def_anim("ac-whiteball-appear", reverseframes(buildframes(img, 25)))
-    def_anim("ac-whiteball-disappear", buildframes(img, 35))
+    def_anim("ac-whiteball-disappear", buildframes(img, 25))
 
     -- Shattering
 

Modified: trunk/src/d_models.cc
===================================================================
--- trunk/src/d_models.cc	2007-01-09 22:04:53 UTC (rev 568)
+++ trunk/src/d_models.cc	2007-01-10 23:04:06 UTC (rev 569)
@@ -423,6 +423,10 @@
 
 ShadowModel::ShadowModel (Model *m, Model *sh) {
     model=m; shade=sh;
+    ecl::Rect r1, r2;
+    model->get_extension (r1);
+    shade->get_extension (r2);
+    extension = boundingbox (r1, r2);
 }
 
 ShadowModel::~ShadowModel() { 
@@ -469,10 +473,7 @@
 }
 
 void ShadowModel::get_extension (ecl::Rect &r) {
-    ecl::Rect r1, r2;
-    model->get_extension (r1);
-    shade->get_extension (r2);
-    r = boundingbox (r1, r2);
+    r = extension;
 }
 
 /* -------------------- RandomModel -------------------- */
@@ -499,13 +500,13 @@
 : rep(new AnimRep(loop)) 
 {}
 
-Anim2d::Anim2d (AnimRep *r) 
+Anim2d::Anim2d (AnimRep *r, ecl::Rect &ext_r) 
 : rep(r), curframe(0), frametime(0), 
   finishedp (false), 
   changedp (false), 
   reversep (false),
   videox (0), videoy (0),
-  callback(0)
+  callback(0), extension(ext_r)
 {
     rep->refcount++;
     frametime = 0; // enigma::DoubleRand (0, 0.02);
@@ -522,6 +523,12 @@
 
 void Anim2d::add_frame(Model *m, double duration) {
     rep->frames.push_back(new AnimFrame(m, duration));
+    
+    // cache the bounding extension of all frames to ensure that it is constant
+    ecl::Rect r1, r2;
+    m->get_extension (r1);
+    r2 = extension;
+    extension = boundingbox (r1, r2);
 }
 
 void Anim2d::draw(ecl::GC &gc, int x, int y) 
@@ -567,8 +574,7 @@
 }
 
 void Anim2d::get_extension (ecl::Rect &r) {
-    AnimFrame *f =rep->frames[curframe];
-    f->model->get_extension (r);
+    r = extension;
 }
 
 void Anim2d::tick (double dtime) 

Modified: trunk/src/d_models.hh
===================================================================
--- trunk/src/d_models.hh	2007-01-09 22:04:53 UTC (rev 568)
+++ trunk/src/d_models.hh	2007-01-10 23:04:06 UTC (rev 569)
@@ -33,14 +33,14 @@
 /* -------------------- Image -------------------- */
 
     struct Image {
-	// Variables.
-	ecl::Surface *surface;
-	ecl::Rect     rect;      // location of image inside surface
-	int          refcount;  // reference count, initialized to 1
+        // Variables.
+        ecl::Surface *surface;
+        ecl::Rect     rect;      // location of image inside surface
+        int          refcount;  // reference count, initialized to 1
 
         // Constructors.
-	Image(ecl::Surface *sfc);
-	Image(ecl::Surface *sfc, const ecl::Rect &r);
+        Image(ecl::Surface *sfc);
+        Image(ecl::Surface *sfc, const ecl::Rect &r);
     };
 
     void incref (Image *i);
@@ -50,18 +50,18 @@
 /* -------------------- ImageModel -------------------- */
 
     class ImageModel : public Model {
-	Image* image;
-	int xoff, yoff;         // relative origin of the image
+        Image* image;
+        int xoff, yoff;         // relative origin of the image
     public:
         // Constructors
-	ImageModel (Image *i, int xo, int yo);
-	ImageModel (Surface *s, int xo, int yo);
-	ImageModel (Surface *s, const ecl::Rect &r, int xo, int yo);
-	~ImageModel();
+        ImageModel (Image *i, int xo, int yo);
+        ImageModel (Surface *s, int xo, int yo);
+        ImageModel (Surface *s, const ecl::Rect &r, int xo, int yo);
+        ~ImageModel();
 	
         // Model interface
         void   draw(ecl::GC &gc, int x, int y);
-	Model *clone();
+        Model *clone();
         void   get_extension (ecl::Rect &r);
         Image *get_image() { return image; }
     };
@@ -77,8 +77,8 @@
         void expose (ModelLayer *ml, int vx, int vy);
         void remove (ModelLayer *ml);
 
-	void set_callback(ModelCallback *cb);
-	void reverse();
+        void set_callback(ModelCallback *cb);
+        void reverse();
         void restart();
         void draw (ecl::GC &gc, int x, int y);
         void draw_shadow (ecl::GC &gc, int x, int y);
@@ -89,6 +89,7 @@
 
     private:
         Model *model, *shade;
+        ecl::Rect extension;  // bounding extesion of model and shade
     };
 
 /* -------------------- CompositeModel -------------------- */
@@ -115,7 +116,7 @@
         }
 
         // Model interface
-	Model *get_shadow() const { return bg->get_shadow(); }
+        Model *get_shadow() const { return bg->get_shadow(); }
         virtual void expose (ModelLayer *ml, int vx, int vy) {
             fg->expose (ml, vx, vy);
 //            bg->expose (ml, vx, vy);
@@ -203,7 +204,7 @@
         /* ---------- Model interface ---------- */
         void draw(ecl::GC &gc, int x, int y);
         void draw_shadow(ecl::GC &gc, int x, int y);
-        Model *clone() { return new Anim2d(rep); }
+        Model *clone() { return new Anim2d(rep, extension); }
         void reverse() { reversep = !reversep; }
         void restart ();
 
@@ -218,7 +219,7 @@
         void get_extension (ecl::Rect &r);
 
     private:
-        Anim2d(AnimRep *r);
+        Anim2d(AnimRep *r, ecl::Rect &ext_r);
 
         /* ---------- Variables ---------- */
         AnimRep *rep;
@@ -229,6 +230,7 @@
         bool    reversep;       // Play the animation in reverse direction
 
         int videox, videoy;     // Video coordinates of sprite
+        ecl::Rect extension;    // bounding extension of all frames
         ModelCallback *callback;
     };
 



From raoul at mail.berlios.de  Thu Jan 11 15:42:27 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Thu, 11 Jan 2007 15:42:27 +0100
Subject: [Enigma-game-svn] r570 - in branches/1.0/data/levels: enigma_oxyd
	enigma_oxydmagnum enigma_peroxyd
Message-ID: <200701111442.l0BEgR7F018276@sheep.berlios.de>

Author: raoul
Date: 2007-01-11 15:42:26 +0100 (Thu, 11 Jan 2007)
New Revision: 570

Added:
   branches/1.0/data/levels/enigma_oxyd/oxyd11_1.xml
   branches/1.0/data/levels/enigma_oxyd/oxyd15_1.xml
   branches/1.0/data/levels/enigma_oxyd/oxyd17_1.xml
   branches/1.0/data/levels/enigma_oxyd/oxyd28_1.xml
   branches/1.0/data/levels/enigma_oxyd/oxyd31_1.xml
   branches/1.0/data/levels/enigma_oxyd/oxyd79_1.xml
   branches/1.0/data/levels/enigma_oxyd/oxyd95_1.xml
   branches/1.0/data/levels/enigma_oxydmagnum/oxm13_1.xml
   branches/1.0/data/levels/enigma_peroxyd/peroxyd28_1.xml
   branches/1.0/data/levels/enigma_peroxyd/peroxyd29_1.xml
Modified:
   branches/1.0/data/levels/enigma_oxyd/index.xml
   branches/1.0/data/levels/enigma_oxyd/oxyd93_1.xml
   branches/1.0/data/levels/enigma_oxydmagnum/index.xml
   branches/1.0/data/levels/enigma_peroxyd/index.xml
Log:
-> 10 new Deja-Vu level by Ulf Stegemann


Modified: branches/1.0/data/levels/enigma_oxyd/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/index.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxyd/index.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -15,44 +15,51 @@
     <level _seq="7" _title="Linear Accelerator" _xpath="./oxyd08_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin36" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Demolition Squad" _xpath="./oxyd09_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried75" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="9" _title="- Meditation -" _xpath="./oxyd10_1" author="Daniel Heck" ctrl="force" easy="false" id="daniel1" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="10" _title="On the Flip Side" _xpath="./oxyd13_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin10" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="11" _title="Look Alike" _xpath="./oxyd16_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin61" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="12" _title="More Speed" _xpath="./oxyd18_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin63" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="13" _title="Oxyd 20" _xpath="./oxyd20_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd20" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="14" _title="Bad Punball" _xpath="./oxyd22_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin59" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="15" _title="Twin Rooms" _xpath="./oxyd23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried71" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="16" _title="Proper Order" _xpath="./oxyd26_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried79" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="17" _title="- Meditation -" _xpath="./oxyd30_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation9" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="18" _title="Tunnel System" _xpath="./oxyd33_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried98" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="19" _title="Oxyd 37" _xpath="./oxyd37_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20060629ulf005" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="20" _title="The Amazing Maze" _xpath="./oxyd38_1" author="Sven Siggelkow" ctrl="force" easy="true" id="ss_ox38" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="21" _title="Take a Break" _xpath="./oxyd39_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried72" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="22" _title="Jump Pads" _xpath="./oxyd51_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried88" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="23" _title="Moonwalking" _xpath="./oxyd52_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20060629ulf006" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="24" _title="Scrooge" _xpath="./oxyd53_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried100" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="25" _title="Soaring High" _xpath="./oxyd54_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried101" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="26" _title="Oxyd 70" _xpath="./oxyd70_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd70" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="27" _title="Oxyd 77" _xpath="./oxyd77_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd77" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="28" _title="Oxyd 90" _xpath="./oxyd90_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd90" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="29" _title="So Many Doors" _xpath="./oxyd93_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level9b" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="30" _title="Oxyd Link 1" _xpath="./oxydlink01_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p1" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="31" _title="Land of the Doors" _xpath="./oxydlink02_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin65" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="32" _title="Oxyd Link 3" _xpath="./oxydlink03_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p3" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="33" _title="Black or White" _xpath="./oxydlink05_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin42" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="34" _title="Advance Planning" _xpath="./oxydlink14_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried76" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="35" _title="Airlock" _xpath="./oxydlink17_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8b" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="36" _title="OxydLink 23" _xpath="./oxydlink23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried104" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="37" _title="Preferences" _xpath="./oxydlink28_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10d" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="38" _title="Letter Bomb" _xpath="./oxydlink31_1" author="Siegfried Fennig" ctrl="force" easy="false" id="oxydlink31" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="39" _title="Oxyd Link 33" _xpath="./oxydlink33_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p33" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="40" _title="Mirror III" _xpath="./oxydlink41_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried80" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="41" _title="My Way, Your Way" _xpath="./oxydlink46_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10e" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="42" _title="Center Court" _xpath="./oxydlink61_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level11c" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="43" _title="Parcours" _xpath="./oxydlink65_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8a" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="44" _title="Oxyd Link 68" _xpath="./oxydlink68_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p68" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="45" _title="Slide Show" _xpath="./oxydlink72_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8c" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="46" _title="Oxyd Link 87" _xpath="./oxydlink87_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p87" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="47" _title="OxydLink 95" _xpath="./oxydlink95_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried103" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="10" _title="Oxyd 11" _xpath="./oxyd11_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20061221ulf009" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="11" _title="On the Flip Side" _xpath="./oxyd13_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin10" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="12" _title="Oxyd 15" _xpath="./oxyd15_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20061221ulf010" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="13" _title="Look Alike" _xpath="./oxyd16_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin61" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="14" _title="Oxyd 17" _xpath="./oxyd17_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20061221ulf011" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="15" _title="More Speed" _xpath="./oxyd18_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin63" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="16" _title="Oxyd 20" _xpath="./oxyd20_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd20" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="17" _title="Bad Punball" _xpath="./oxyd22_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin59" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="18" _title="Twin Rooms" _xpath="./oxyd23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried71" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="19" _title="Proper Order" _xpath="./oxyd26_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried79" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="20" _title="Oxyd 28" _xpath="./oxyd28_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20070104ulf017" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="21" _title="- Meditation -" _xpath="./oxyd30_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation9" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="22" _title="Oxyd 31" _xpath="./oxyd31_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20061222ulf012" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="23" _title="Tunnel System" _xpath="./oxyd33_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried98" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="24" _title="Oxyd 37" _xpath="./oxyd37_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20060629ulf005" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="25" _title="The Amazing Maze" _xpath="./oxyd38_1" author="Sven Siggelkow" ctrl="force" easy="true" id="ss_ox38" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="26" _title="Take a Break" _xpath="./oxyd39_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried72" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="27" _title="Jump Pads" _xpath="./oxyd51_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried88" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="28" _title="Moonwalking" _xpath="./oxyd52_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20060629ulf006" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="29" _title="Scrooge" _xpath="./oxyd53_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried100" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="30" _title="Soaring High" _xpath="./oxyd54_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried101" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="31" _title="Oxyd 70" _xpath="./oxyd70_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd70" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="32" _title="Oxyd 77" _xpath="./oxyd77_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd77" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="33" _title="Oxyd 79" _xpath="./oxyd79_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20070103ulf015" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="34" _title="Oxyd 90" _xpath="./oxyd90_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd90" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="35" _title="So Many Doors" _xpath="./oxyd93_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level9b" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="36" _title="Oxyd 95" _xpath="./oxyd95_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20070103ulf014" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="37" _title="Oxyd Link 1" _xpath="./oxydlink01_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p1" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="38" _title="Land of the Doors" _xpath="./oxydlink02_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin65" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="39" _title="Oxyd Link 3" _xpath="./oxydlink03_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p3" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="40" _title="Black or White" _xpath="./oxydlink05_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin42" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="41" _title="Advance Planning" _xpath="./oxydlink14_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried76" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="42" _title="Airlock" _xpath="./oxydlink17_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8b" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="43" _title="OxydLink 23" _xpath="./oxydlink23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried104" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="44" _title="Preferences" _xpath="./oxydlink28_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10d" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="45" _title="Letter Bomb" _xpath="./oxydlink31_1" author="Siegfried Fennig" ctrl="force" easy="false" id="oxydlink31" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="46" _title="Oxyd Link 33" _xpath="./oxydlink33_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p33" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="47" _title="Mirror III" _xpath="./oxydlink41_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried80" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="48" _title="My Way, Your Way" _xpath="./oxydlink46_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10e" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="49" _title="Center Court" _xpath="./oxydlink61_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level11c" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="50" _title="Parcours" _xpath="./oxydlink65_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8a" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="51" _title="Oxyd Link 68" _xpath="./oxydlink68_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p68" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="52" _title="Slide Show" _xpath="./oxydlink72_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8c" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="53" _title="Oxyd Link 87" _xpath="./oxydlink87_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p87" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="54" _title="OxydLink 95" _xpath="./oxydlink95_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried103" rel="1" rev="0" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Added: branches/1.0/data/levels/enigma_oxyd/oxyd11_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxyd11_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxyd/oxyd11_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,94 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Oxyd 11"
+        el:subtitle="Oxyd 11"
+        el:id="20061221ulf009"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+        <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="01:00" el:difficult="01:00"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells[" "]=cell{floor="fl-metal"}
+cells["d"]=cell{floor="fl-metal",stone={"st-door-h",{name="mydoor"}}}
+cells["X"]=cell{floor="fl-metal",item={"it-sensor",{action="open",target="mydoor"}}}
+cells["x"]=cell{floor="fl-abyss"}
+cells["#"]=cell{stone="st-metal"}
+cells["A"]=cell{stone="st-plain_move"}
+cells["G"]=cell{stone="st-grate1"}
+cells["J"]=cell{item="it-spring1"}
+cells["F"]=cell{item="it-flagblack"}
+cells["B"]=cell{item="it-extralife"}
+cells["u"]=cell{item="it-crack1"}
+cells["v"]=cell{item="it-crack2"}
+cells["w"]=cell{item="it-crack3"}
+cells["j"]=cell{item={"it-document",{text="text1"}}}
+
+-- LANDSCAPE MAP --
+level = {
+   "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
+   "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
+   "#######################################",
+   "#                  #    xxx   u       #",
+   "#                  #    xxx           #",
+   "#              v   #    xx B xxxx    u#",
+   "#        vxvxvvxv  #   xxx  vx0x   u u#",
+   "#      xvvvxxxxvv  #  xxx  wvxxx  uxvv#",
+   "#xxxvvx vxxxxxv    G  xxxF vxxx   vvxv#",
+   "#  vxvxvxxxxv      #xwxxxxxxxwx  vxvxx#",
+   "#   xxxxvxv        #xxxxxxwxx   uxvxxx#",
+   "#0   xxv x         #xxxxxxxx  juvvxvxx#",
+   "##################G#########d##########",
+   "#wwwwwvuu        AA#        X         #",
+   "#wwwvu       AAAAxx#                  #",
+   "#AAu    AAAAAxxxxxx#                  #",
+   "#xxA   AxxxAxxxxxxx#                  #",
+   "#xxxAAAAxxxxxxxxxxx#        J   O     #",
+   "#uxxxxAAxxxxxxxvvv #                  #",
+   "#wuuxxxxxxxxx uv   #                  #",
+   "#     xxxx uu      #                  #",
+   "#0       x        0#                  #",
+   "#######################################",
+   "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
+   "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "a"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd_shuffle()
+display.SetFollowMode(display.FOLLOW_SCREEN)
+
+-- PUZZLE --
+shuffle_method="permutation"
+puzzle({{1,1,1},{1,0,1},{1,1,1}},27,16,"red","yes")
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="false">Hey, Jumping Jack!!</el:english>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_oxyd/oxyd11_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/enigma_oxyd/oxyd15_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxyd15_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxyd/oxyd15_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,73 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Oxyd 15"
+        el:subtitle="Oxyd 15"
+        el:id="20061221ulf010"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="00:39" el:difficult="00:39"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells[" "]=cell{floor="fl-ice"}
+cells["x"]=cell{floor="fl-abyss"}
+cells["#"]=cell{stone="st-plain_move"}
+cells["H"]=cell{stone="st-plain"}
+cells["d"]=cell{item={"it-document",{text="text1"}}}
+cells["P"]=cell{stone="st-plain_move",item="it-pin"}
+cells["."]=cell{item={"it-crack0"}}
+
+-- LANDSCAPE MAP --
+level = {
+   "xxxxxxxxxxxxxxxxxxxx",
+   "0xxxxxxxxxxxxxxxxxx0",
+   "x                  x",
+   "x  ##############  x",
+   "x  #     d      #  x",
+   "x. #    H HH    #  x",
+   "x  #    H  H    #  x",
+   "x  #    HH H    # .x",
+   "x  #            #  x",
+   "x  P#############  x",
+   "x                  x",
+   "0xxxxxxxxxxxxxxxxxx0",
+   "xxxxxxxxxxxxxxxxxxxx"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "a"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd_shuffle()
+
+-- ACTOR --
+set_actor("ac-blackball",10,6.5)
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english>It's easier with spikes!</el:english>
+        <el:translation el:lang="de">Mit Spikes geht's besser!</el:translation>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_oxyd/oxyd15_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/enigma_oxyd/oxyd17_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxyd17_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxyd/oxyd17_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,82 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Oxyd 17"
+        el:subtitle="Oxyd 17"
+        el:id="20061221ulf011"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="00:40" el:difficult="00:40"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells[" "]=cell{floor="fl-normal"}
+cells["x"]=cell{floor="fl-abyss"}
+cells["s"]=cell{floor="fl-space"}
+cells["#"]=cell{stone="st-bluegray"}
+cells["D"]=cell{stone="st-thief"}
+cells["k"]=cell{stone="st-glass1"}
+cells["m"]=cell{stone="st-mail-e"}
+cells["M"]=cell{stone="st-mail-s"}
+cells["w"]=cell{stone="st-oneway_black-e"}
+cells["I"]=cell{stone={"st-coinslot",{action="openclose",target="door1"}}}
+cells["i"]=cell{stone={"st-coinslot",{action="openclose",target="door2"}}}
+cells["T"]=cell{stone={"st-door-v",{name="door1"}}}
+cells["t"]=cell{stone={"st-door-v",{name="door2"}}}
+cells["d"]=cell{item={"it-document",{text="text1"}}}
+cells["c"]=cell{item="it-coin4"}
+cells["2"]=cell{item="it-pipe-h"}
+cells["3"]=cell{item="it-pipe-sw"}
+cells["4"]=cell{item="it-pipe-wn"}
+cells["5"]=cell{item="it-pipe-v"}
+
+-- LANDSCAPE MAP --
+level = {
+   "xxxxxxxxxxxxxxxxxxxx",
+   "#DDDDDDDDDDDDDDD####",
+   "#  Dsssssssssssw  c0",
+   "# cDsDDDDDDDDDDD   #",
+   "#3 DsD     k       I",
+   "#          T   M   0",
+   "0   O   md kkkkkkkk#",
+   "#          t       0",
+   "#52DsD 2 2 k       i",
+   "#42DsDDDDDDDDDDD   #",
+   "#  Dsssssssssssw   #",
+   "#DDDDDDDDDDDDDDD####",
+   "xxxxxxxxxxxxxxxxxxxx"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "a"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd_shuffle()
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english>Nothing but thieves!! Try the mailbox.</el:english>
+        <el:translation el:lang="de">Alles Diebe!! Probiere es lieber mal mit dem Briefkasten.</el:translation>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_oxyd/oxyd17_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/enigma_oxyd/oxyd28_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxyd28_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxyd/oxyd28_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,73 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Oxyd 28"
+        el:subtitle="Oxyd 28"
+        el:id="20070104ulf017"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="02:12" el:difficult="02:12"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells[" "]=cell{floor="fl-water"}
+cells["x"]=cell{floor="fl-abyss"}
+cells["+"]=cell{floor="fl-wood"}
+cells["X"]=cell{stone="st-wood"}
+cells["D"]=cell{stone="st-plain_move",item={"it-document",{text="text1"}}}
+cells["M"]=cell{stone="st-plain_move"}
+cells["N"]=cell{floor="fl-water",stone="st-plain_move"}
+cells["#"]=cell{floor="fl-water",stone="st-invisible"}
+cells["3"]=cell{floor="fl-water",stone="st-glass1"}
+
+-- LANDSCAPE MAP --
+level = {
+   "xxxxxxxxxxxxxxxxxxxx",
+   "####################",
+   "#          3  +++++#",
+   "# 0N 3  3     XXXX+#",
+   "# 0    3  3   +++++#",
+   "# 0N+         XXXX+#",
+   "# 0++3        D+O++#",
+   "# 0+  M+  3   XXXX+#",
+   "#30   ++  3  3+++++#",
+   "#  33 3      3XXXX+#",
+   "#       3 3  3+++++#",
+   "####################",
+   "xxxxxxxxxxxxxxxxxxxx"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+set_default_parent(cells["+"])
+oxyd_default_flavor = "a"
+create_world_by_map(level)
+oxyd_shuffle()
+enigma.WaterSinkSpeed = 600
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english>For heaven's sake ... don't drown!</el:english>
+        <el:translation el:lang="de">Blo? nicht absaufen!</el:translation>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_oxyd/oxyd28_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/enigma_oxyd/oxyd31_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxyd31_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxyd/oxyd31_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,76 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Oxyd 31"
+        el:subtitle="Oxyd 31"
+        el:id="20061222ulf012"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="00:25" el:difficult="00:25"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells[" "]=cell{floor="fl-rock"}
+cells["x"]=cell{floor="fl-abyss"}
+cells["#"]=cell{stone="st-brick"}
+cells["e"]=cell{stone="st-oneway_black-e"}
+cells["w"]=cell{stone="st-oneway_black-w"}
+cells["c"]=cell{item="it-coffee"}
+cells["d"]=cell{item={"it-document",{text="text1"}}}
+cells["b"]=cell{item="it-extralife"}
+cells["r"]=cell{actor={"ac-rotor",{range=100,force=45}}}
+
+-- LANDSCAPE MAP --
+level = {
+   "xxxxxxxxxxxxxxxxxxxx",
+   "##0##############0##",
+   "#       ec e       #",
+   "# r     ####       #",
+   "0                  0",
+   "#                  #",
+   "#                  #",
+   "#                  #",
+   "0                  0",
+   "#       ####       #",
+   "#       wdbw       #",
+   "##0##############0##",
+   "xxxxxxxxxxxxxxxxxxxx"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "d"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd_shuffle()
+
+-- ACTOR --
+set_actor("ac-blackball",10,6.5)
+set_actor("ac-rotor",17.5,10,{range=100,force=45})
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english>Rotaryrotaryrot...</el:english>
+        <el:translation el:lang="de">Rodilirot..rodilirot...</el:translation>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_oxyd/oxyd31_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/enigma_oxyd/oxyd79_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxyd79_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxyd/oxyd79_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,72 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Oxyd 79"
+        el:subtitle="Oxyd 79"
+        el:id="20070103ulf015"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="00:24" el:difficult="00:24"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells["-"]=cell{floor="fl-abyss"}
+cells[" "]=cell{floor="fl-space"}
+cells["x"]=cell{floor="fl-metal"}
+cells["#"]=cell{stone="st-white1"}
+cells["e"]=cell{floor="fl-metal",item="it-extralife"}
+cells["r"]=cell{actor={"ac-rotor",{range=100,force=3}}}
+cells["O"]=cell{floor="fl-metal",actor="ac-blackball"}
+
+-- LANDSCAPE MAP --
+level = {
+   "--------------------",
+   "####################",
+   "#       xxx        #",
+   "#  xxx  xxx   xxx  #",
+   "#  xxx  xxe   xxx  #",
+   "#  xxx        xxx  #",
+   "#r                 #",
+   "# xxx   xOx        #",
+   "# xxx   xxx  xxx   #",
+   "# xxx   xxx  xxx   #",
+   "#            xxx   #",
+   "####################",
+   "--------------------"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "a"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd(4,4)
+oxyd(3,8)
+oxyd(9,3)
+oxyd(15,4)
+oxyd(9,8)
+oxyd(14,9)
+oxyd_shuffle()
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_oxyd/oxyd79_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/1.0/data/levels/enigma_oxyd/oxyd93_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxyd93_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxyd/oxyd93_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -5,8 +5,8 @@
       <el:identity el:title="So Many Doors" el:subtitle="Oxyd 93" el:id="level9b"/>
       <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
       <el:author  el:name="Siegfried Fennig" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2006 Siegfried Fennig</el:copyright>
-      <el:license el:type="see Lua code below" el:open="true"/>
+      <el:copyright>Copyright ? 2003 Siegfried Fennig</el:copyright>
+      <el:license el:type="GPL version 2" el:open="true"/>
       <el:compatibility el:enigma="0.92" el:engine="oxyd1">
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
@@ -16,12 +16,6 @@
       <el:score el:easy="-" el:difficult="-"/>
     </el:info>
     <el:luamain><![CDATA[
---
--- A level for Enigma
---
--- Copyright (c) 2003 Siegfried Fennig
--- Licensed under the GPL version 2.
-
 levelw = 20
 levelh = 25
 
@@ -101,18 +95,6 @@
 set_attrib(laser( 9,12, TRUE, NORTH), "name", "laser1")
 
 set_actor("ac-blackball",9.5,6.5)
-
-
-
-
-
-
-
-
-
-
-
-
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Added: branches/1.0/data/levels/enigma_oxyd/oxyd95_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxyd95_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxyd/oxyd95_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,70 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Oxyd 95"
+        el:subtitle="Oxyd 95"
+        el:id="20070103ulf014"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="00:28" el:difficult="00:28"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells[" "]=cell{floor="fl-abyss"}
+cells["x"]=cell{floor="fl-metal"}
+cells["#"]=cell{stone="st-likeoxydd"}
+cells["s"]=cell{floor="fl-metal",stone="st-oneway_black-s"}
+cells["w"]=cell{floor="fl-metal",stone="st-oneway_black-w"}
+cells["c"]=cell{floor="fl-metal",item="it-coffee"}
+cells["."]=cell{floor="fl-metal",item="it-crack0"}
+
+-- LANDSCAPE MAP --
+level = {
+   "                    ",
+   "####################",
+   "#cxxxxxxx   xxxxxxx#",
+   "#x   x0 xxxxx x   x#",
+   "#x   x   x0 x x   x#",
+   "#x 0 x   x  x . 0 x#",
+   "#x   xxxxx  . x   x#",
+   "#x      0xxxxxx   x#",
+   "#x  xxxxxx  0   xwx#",
+   "#xxxx           x s#",
+   "#   xxxxxxxxxxxxcxx#",
+   "####################",
+   "                    "
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "d"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd_shuffle()
+
+-- ACTOR --
+set_actor("ac-rotor",10,6.5,{range=100,force=8})
+set_actor("ac-blackball",10,10.5)
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_oxyd/oxyd95_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/1.0/data/levels/enigma_oxydmagnum/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxydmagnum/index.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxydmagnum/index.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -14,26 +14,27 @@
     <level _seq="6" _title="- Meditation -" _xpath="./oxm10_1" author="Petr Machata" ctrl="force" easy="false" id="oxm010" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="7" _title="Marbles &amp; Mountains" _xpath="./oxm11_1" author="Petr Machata" ctrl="force" easy="false" id="oxm011" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Laser Room" _xpath="./oxm12_1" author="Petr Machata" ctrl="force" easy="false" id="oxm012" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="9" _title="Black or White" _xpath="./oxm14_1" author="Martin Hawlisch" ctrl="force" easy="false" id="oxm14" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="10" _title="Pull Me!" _xpath="./oxm16_1" author="Petr Machata" ctrl="force" easy="false" id="oxm016" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="11" _title="- Meditation -" _xpath="./oxm20_1" author="Petr Machata" ctrl="force" easy="false" id="oxm020" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="12" _title="Laser Room II" _xpath="./oxm21_1" author="Petr Machata" ctrl="force" easy="false" id="oxm021" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="13" _title="Black Holes" _xpath="./oxm23_1" author="Petr Machata" ctrl="force" easy="false" id="oxm023" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="14" _title="Hover Doors" _xpath="./oxm27_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried81" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="15" _title="Land of Impulses" _xpath="./oxm28_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried89" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="16" _title="Follow the Light" _xpath="./oxm33_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin49" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="17" _title="Tilt" _xpath="./oxm37_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin51" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="18" _title="Oxyd Magnum 40" _xpath="./oxm40_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxydmagnum40" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="19" _title="Light and Doors" _xpath="./oxm58_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried91" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="20" _title="Sensor Fields" _xpath="./oxm78_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried84" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="21" _title="Puller Mailing" _xpath="./oxm82_1" author="anonymous" ctrl="force" easy="false" id="magnum82" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="22" _title="Turnstiles" _xpath="./oxm84_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried82" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="23" _title="Hall of Mirrors" _xpath="./oxm96_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried96" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="24" _title="Letter Bomb" _xpath="./oxm99_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried97" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="25" _title="Magnum 100" _xpath="./oxm100_1" author="Sven Siggelkow" ctrl="force" easy="true" id="ss_mag100" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="26" _title="Oxyd Magnum Gold 17" _xpath="./oxmg17_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxydmagnumgold17" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="27" _title="Oxyd Magnum Gold 18" _xpath="./oxmg18_1" author="Edward" ctrl="force" easy="false" id="oxydmagnumgold18" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="28" _title="Oxyd Magnum Gold 19" _xpath="./oxmg19_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxydmagnumgold19" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="9" _title="Oxyd Magnum 13" _xpath="./oxm13_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20070105ulf018" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="10" _title="Black or White" _xpath="./oxm14_1" author="Martin Hawlisch" ctrl="force" easy="false" id="oxm14" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="11" _title="Pull Me!" _xpath="./oxm16_1" author="Petr Machata" ctrl="force" easy="false" id="oxm016" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="12" _title="- Meditation -" _xpath="./oxm20_1" author="Petr Machata" ctrl="force" easy="false" id="oxm020" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="13" _title="Laser Room II" _xpath="./oxm21_1" author="Petr Machata" ctrl="force" easy="false" id="oxm021" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="14" _title="Black Holes" _xpath="./oxm23_1" author="Petr Machata" ctrl="force" easy="false" id="oxm023" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="15" _title="Hover Doors" _xpath="./oxm27_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried81" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="16" _title="Land of Impulses" _xpath="./oxm28_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried89" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="17" _title="Follow the Light" _xpath="./oxm33_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin49" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="18" _title="Tilt" _xpath="./oxm37_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin51" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="19" _title="Oxyd Magnum 40" _xpath="./oxm40_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxydmagnum40" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="20" _title="Light and Doors" _xpath="./oxm58_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried91" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="21" _title="Sensor Fields" _xpath="./oxm78_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried84" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="22" _title="Puller Mailing" _xpath="./oxm82_1" author="anonymous" ctrl="force" easy="false" id="magnum82" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="23" _title="Turnstiles" _xpath="./oxm84_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried82" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="24" _title="Hall of Mirrors" _xpath="./oxm96_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried96" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="25" _title="Letter Bomb" _xpath="./oxm99_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried97" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="26" _title="Magnum 100" _xpath="./oxm100_1" author="Sven Siggelkow" ctrl="force" easy="true" id="ss_mag100" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="27" _title="Oxyd Magnum Gold 17" _xpath="./oxmg17_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxydmagnumgold17" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="28" _title="Oxyd Magnum Gold 18" _xpath="./oxmg18_1" author="Edward" ctrl="force" easy="false" id="oxydmagnumgold18" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="29" _title="Oxyd Magnum Gold 19" _xpath="./oxmg19_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxydmagnumgold19" rel="1" rev="0" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Added: branches/1.0/data/levels/enigma_oxydmagnum/oxm13_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxydmagnum/oxm13_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_oxydmagnum/oxm13_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,73 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Oxyd Magnum 13"
+        el:subtitle="Oxyd Magnum 13"
+        el:id="20070105ulf018"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="00:51" el:difficult="00:51"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells[" "]=cell{floor="fl-wood"}
+cells["x"]=cell{floor="fl-abyss"}
+cells["b"]=cell{floor={"fl-bridge-open",{name="bridge1"}}}
+cells["#"]=cell{stone="st-rock4"}
+cells["X"]=cell{stone="st-plain_move"}
+cells["W"]=cell{stone="st-wood"}
+cells["S"]=cell{stone="st-puzzle2-s"}
+cells["N"]=cell{stone="st-puzzle2-n"}
+cells["I"]=cell{stone="st-stoneimpulse"}
+cells["t"]=cell{item={"it-trigger",{action="openclose",target="bridge1"}}}
+
+-- LANDSCAPE MAP --
+level = {
+   "xxxxxxxxxxxxxxxxxxxx",
+   "####################",
+   "#  #0#   ## S      #",
+   "#  #S#             #",
+   "I    # N#S # # ## ##",
+   "I #  # XII # # #   #",
+   "# ## # ## O  #     #",
+   "# #  # S# # N###   #",
+   "#         I  #tx  ##",
+   "#   ##### ####N#bW #",
+   "# #          #0#   #",
+   "####################",
+   "xxxxxxxxxxxxxxxxxxxx"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "a"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd_shuffle()
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english>It's easier with spikes!</el:english>
+        <el:translation el:lang="de">Mit Spikes geht's besser!</el:translation>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_oxydmagnum/oxm13_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/1.0/data/levels/enigma_peroxyd/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/index.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_peroxyd/index.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -24,42 +24,44 @@
     <level _seq="16" _title="Physics 101" _xpath="./peroxyd21_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin50" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="17" _title="On the Beach" _xpath="./peroxyd24_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin16" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="18" _title="Per.Oxyd 27" _xpath="./peroxyd27_1" author="Ulf Stegemann" ctrl="force" easy="true" id="20060629ulf008" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="19" _title="- Meditation - " _xpath="./peroxyd30_1" author="Raoul Bourquin" ctrl="force" easy="true" id="peroxyd30" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="20" _title="- Meditation -" _xpath="./peroxyd40_1" author="Daniel Heck" ctrl="force" easy="false" id="daniel4" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="21" _title="Push and Pull" _xpath="./peroxyd44_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level1b" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="22" _title="Find The Way Out" _xpath="./peroxyd46_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level2c" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="23" _title="Hidden Treasure" _xpath="./peroxyd49_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level6f" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="24" _title="- Meditation -" _xpath="./peroxyd50_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried73" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="25" _title="Precision" _xpath="./peroxyd53_2" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried93" rel="2" rev="1" score="2" target="time" unit="duration"/>
-    <level _seq="26" _title="Cliffhanger" _xpath="./peroxyd54_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10f" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="27" _title="Per.Oxyd 55" _xpath="./peroxyd55_2" author="Sven Siggelkow" ctrl="force" easy="false" id="ss_pox55" rel="2" rev="0" score="2" target="time" unit="duration"/>
-    <level _seq="28" _title="Roadblock" _xpath="./peroxyd58_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7b" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="29" _title="Per.Oxyd 62" _xpath="./peroxyd62_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd62" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="30" _title="Serious Patching" _xpath="./peroxyd73_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8f" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="31" _title="One Single Try" _xpath="./peroxyd75_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried78" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="32" _title="Plumbing" _xpath="./peroxyd79_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7e" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="33" _title="- Meditation -" _xpath="./peroxyd80_1" author="Daniel Heck" ctrl="force" easy="false" id="daniel5" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="34" _title="Break the Circle" _xpath="./peroxyd82_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried102" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="35" _title="Per.Oxyd 88" _xpath="./peroxyd88_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd88" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="36" _title="No Safety Net" _xpath="./peroxyd96_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried90" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="37" _title="Pipe Dreams" _xpath="./peroxyd99_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level1e" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="38" _title="It Takes Two" _xpath="./peroxydlink01_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin43" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="39" _title="Oops, Sorry!" _xpath="./peroxydlink02_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7f" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="40" _title="Good Company" _xpath="./peroxydlink03_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10a" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="41" _title="Per.Oxyd Link 6" _xpath="./peroxydlink06_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p6" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="42" _title="Per.Oxyd Link 13" _xpath="./peroxydlink13_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p13" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="43" _title="Monolith" _xpath="./peroxydlink22_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10c" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="44" _title="Let Me Out!" _xpath="./peroxydlink44_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried92" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="45" _title="Crisscross" _xpath="./peroxydlink45_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin62" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="46" _title="Stay Open" _xpath="./peroxydlink48_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried94" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="47" _title="Everything Changes" _xpath="./peroxydlink56_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7d" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="48" _title="- Meditation -" _xpath="./peroxydlink60_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation17" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="49" _title="Per.Oxyd Link 61" _xpath="./peroxydlink61_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p61" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="50" _title="Per.Oxyd Link 64" _xpath="./peroxydlink64_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p64" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="51" _title="No Trespassing" _xpath="./peroxydlink65_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7c" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="52" _title="Gardening Work" _xpath="./peroxydlink71_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried83" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="53" _title="Not That Way" _xpath="./peroxydlink76_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried86" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="54" _title="Snugly Packed II" _xpath="./peroxydlink77_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried87" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="19" _title="Per.Oxyd 28" _xpath="./peroxyd28_1" author="Ulf Stegemann" ctrl="force" easy="true" id="20070104ulf016" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="20" _title="Per.Oxyd 29" _xpath="./peroxyd29_1" author="Ulf Stegemann" ctrl="force" easy="true" id="20061222ulf013" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="21" _title="- Meditation - " _xpath="./peroxyd30_1" author="Raoul Bourquin" ctrl="force" easy="true" id="peroxyd30" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="22" _title="- Meditation -" _xpath="./peroxyd40_1" author="Daniel Heck" ctrl="force" easy="false" id="daniel4" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="23" _title="Push and Pull" _xpath="./peroxyd44_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level1b" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="24" _title="Find The Way Out" _xpath="./peroxyd46_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level2c" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="25" _title="Hidden Treasure" _xpath="./peroxyd49_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level6f" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="26" _title="- Meditation -" _xpath="./peroxyd50_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried73" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="27" _title="Precision" _xpath="./peroxyd53_2" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried93" rel="2" rev="1" score="2" target="time" unit="duration"/>
+    <level _seq="28" _title="Cliffhanger" _xpath="./peroxyd54_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10f" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="29" _title="Per.Oxyd 55" _xpath="./peroxyd55_2" author="Sven Siggelkow" ctrl="force" easy="false" id="ss_pox55" rel="2" rev="0" score="2" target="time" unit="duration"/>
+    <level _seq="30" _title="Roadblock" _xpath="./peroxyd58_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7b" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="31" _title="Per.Oxyd 62" _xpath="./peroxyd62_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd62" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="32" _title="Serious Patching" _xpath="./peroxyd73_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8f" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="33" _title="One Single Try" _xpath="./peroxyd75_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried78" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="34" _title="Plumbing" _xpath="./peroxyd79_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7e" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="35" _title="- Meditation -" _xpath="./peroxyd80_1" author="Daniel Heck" ctrl="force" easy="false" id="daniel5" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="36" _title="Break the Circle" _xpath="./peroxyd82_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried102" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="37" _title="Per.Oxyd 88" _xpath="./peroxyd88_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd88" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="38" _title="No Safety Net" _xpath="./peroxyd96_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried90" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="39" _title="Pipe Dreams" _xpath="./peroxyd99_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level1e" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="40" _title="It Takes Two" _xpath="./peroxydlink01_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin43" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="41" _title="Oops, Sorry!" _xpath="./peroxydlink02_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7f" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="42" _title="Good Company" _xpath="./peroxydlink03_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10a" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="43" _title="Per.Oxyd Link 6" _xpath="./peroxydlink06_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p6" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="44" _title="Per.Oxyd Link 13" _xpath="./peroxydlink13_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p13" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="45" _title="Monolith" _xpath="./peroxydlink22_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10c" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="46" _title="Let Me Out!" _xpath="./peroxydlink44_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried92" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="47" _title="Crisscross" _xpath="./peroxydlink45_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin62" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="48" _title="Stay Open" _xpath="./peroxydlink48_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried94" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="49" _title="Everything Changes" _xpath="./peroxydlink56_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7d" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="50" _title="- Meditation -" _xpath="./peroxydlink60_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation17" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="51" _title="Per.Oxyd Link 61" _xpath="./peroxydlink61_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p61" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="52" _title="Per.Oxyd Link 64" _xpath="./peroxydlink64_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p64" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="53" _title="No Trespassing" _xpath="./peroxydlink65_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7c" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="54" _title="Gardening Work" _xpath="./peroxydlink71_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried83" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="55" _title="Not That Way" _xpath="./peroxydlink76_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried86" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="56" _title="Snugly Packed II" _xpath="./peroxydlink77_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried87" rel="1" rev="0" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Added: branches/1.0/data/levels/enigma_peroxyd/peroxyd28_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/peroxyd28_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_peroxyd/peroxyd28_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,111 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Per.Oxyd 28"
+        el:subtitle="Per.Oxyd 28"
+        el:id="20070104ulf016"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="true" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="01:19" el:difficult="01:19"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells[" "]=cell{floor="fl-rough"}
+cells["x"]=cell{floor="fl-abyss"}
+-- cells["#"]=cell{floor="fl-rough"}
+cells["#"]=cell{stone="st-rock1"}
+cells["X"]=cell{stone="st-plain_break"}
+cells["1"]=cell{stone="st-bolder-s"}
+cells["2"]=cell{stone="st-bolder-w"}
+cells["B"]=cell{stone="st-bombs"}
+
+-- LANDSCAPE MAP --
+level = {
+   "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
+   "##########################################################",
+   "########   ##   ####  1#XX###########XX1# ################",
+   "######## # ## # ####  B#XX###########XXB# ################",
+   "######## # ## # ####  B#XX###########XXB# ################",
+   "######## # ## # ####  B#XX###########XXB# ################",
+   "0O       #    #    X  B#XX     X222  XXB# XXXXXXXXXXXXX2 0",
+   "######## ############# #XX########### # # ################",
+   "######## #           # #XX########### # # ################",
+   "######## #           # #XX########### # # ################",
+   "#######              #    ########### #   ################",
+   "##########################################################",
+   "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "a"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd_shuffle()
+display.SetFollowMode(display.FOLLOW_SCROLLING)
+
+-- ITEMS --
+set_item("it-bag",10,8)
+set_item("it-seed",11,8)
+set_item("it-surprise",12,8)
+set_item("it-flagwhite",13,8)
+set_item("it-key",14,8)
+set_item("it-odometer",15,8)
+set_item("it-coin1",16,8)
+set_item("it-coin1",17,8)
+set_item("it-document",18,8,{text="text1"})
+set_item("it-hammer",19,8)
+set_item("it-dynamite",20,8)
+
+set_item("it-magnet",10,9,{on=FALSE})
+set_item("it-pin",11,9)
+set_item("it-spade",12,9)
+set_item("it-flagblack",13,9)
+set_item("it-key",14,9)
+set_item("it-coin2",15,9)
+set_item("it-coin2",16,9)
+set_item("it-coin1",17,9)
+set_item("it-cherry",18,9)
+set_item("it-coffee",19,9)
+set_item("it-dynamite",20,9)
+
+set_item("it-pipe-ne",7,10)
+set_item("it-pipe-ne",9,10)
+set_item("it-pipe-sw",10,10)
+set_item("it-pipe-ne",11,10)
+set_item("it-pipe-sw",12,10)
+set_item("it-pipe-sw",13,10)
+set_item("it-floppy",14,10)
+set_item("it-coin2",15,10)
+set_item("it-umbrella",16,10)
+set_item("it-coin1",17,10)
+set_item("it-cherry",18,10)
+set_item("it-cherry",19,10)
+set_item("it-dynamite",20,10)
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english>Umbreallas protect you against oncomming boulder!</el:english>
+        <el:translation el:lang="de">Selbstmordversuch mit Schirm.</el:translation>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_peroxyd/peroxyd28_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/enigma_peroxyd/peroxyd29_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/peroxyd29_1.xml	2007-01-10 23:04:06 UTC (rev 569)
+++ branches/1.0/data/levels/enigma_peroxyd/peroxyd29_1.xml	2007-01-11 14:42:26 UTC (rev 570)
@@ -0,0 +1,73 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Per.Oxyd 29"
+        el:subtitle="Per.Oxyd 29"
+        el:id="20061222ulf013"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="true" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="00:20" el:difficult="00:24"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- CELLS --
+cells={}
+cells[" "]=cell{floor="fl-white"}
+cells["x"]=cell{floor="fl-abyss"}
+cells["#"]=cell{stone="st-stone2"}
+if (not difficult) then -- easy
+  cells["r"]=cell{actor={"ac-top",{range=100,force=7}}}
+else
+  cells["r"]=cell{actor={"ac-top",{range=100,force=11}}}
+end
+-- LANDSCAPE MAP --
+level = {
+   "xxxxxxxxxxxxxxxxxxxx",
+   "####################",
+   "#                  #",
+   "# # 0 # ######## 0 #",
+   "# # # #    #     # #",
+   "# # # ## # 0 ### # #",
+   "#   # #  #r    # # #",
+   "# ### 0 ## ### 0 # #",
+   "# #      #   #   # #",
+   "# 0 #### ### ### # #",
+   "#        O         #",
+   "####################",
+   "xxxxxxxxxxxxxxxxxxxx"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "a"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd_shuffle()
+
+-- ACTOR --
+if (not difficult) then -- easy
+  set_actor("ac-top",3.5,6,{range=100,force=7})
+else
+  set_actor("ac-top",3.5,6,{range=100,force=11})
+end
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_peroxyd/peroxyd29_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native



From raoul at mail.berlios.de  Thu Jan 11 18:38:10 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Thu, 11 Jan 2007 18:38:10 +0100
Subject: [Enigma-game-svn] r571 - in branches/1.0/data/levels: enigma_cross
	enigma_vi
Message-ID: <200701111738.l0BHcAcL021145@sheep.berlios.de>

Author: raoul
Date: 2007-01-11 18:38:02 +0100 (Thu, 11 Jan 2007)
New Revision: 571

Added:
   branches/1.0/data/levels/enigma_vi/luc32_1.xml
   branches/1.0/data/levels/enigma_vi/luc33_1.xml
Modified:
   branches/1.0/data/levels/enigma_cross/newlevels_1.0.1.xml
   branches/1.0/data/levels/enigma_vi/index.xml
Log:
-> Two new levels by Lukas Sch?\195?\188ller


Modified: branches/1.0/data/levels/enigma_cross/newlevels_1.0.1.xml
===================================================================
--- branches/1.0/data/levels/enigma_cross/newlevels_1.0.1.xml	2007-01-11 14:42:26 UTC (rev 570)
+++ branches/1.0/data/levels/enigma_cross/newlevels_1.0.1.xml	2007-01-11 17:38:02 UTC (rev 571)
@@ -9,6 +9,8 @@
     <level _seq="1" _title="Walk the line" _xpath="enigma_vi/erich02_1" author="Erich Schubert" ctrl="force" easy="true" id="erich02" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="2" _title="Knights &amp; Boxes" _xpath="enigma_vi/johannes01_1" author="Johannes Laire" ctrl="force" easy="false" id="20061201johannes313" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="3" _title="Knight's Journey" _xpath="enigma_vi/johannes02_1" author="Johannes Laire" ctrl="force" easy="false" id="20061210johannes313" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="4" _title="Blitz Chess" _xpath="enigma_vi/luc32_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc322006" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="5" _title="River of Challenges" _xpath="enigma_vi/luc33_1" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc332006" rel="1" rev="3" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: branches/1.0/data/levels/enigma_vi/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/index.xml	2007-01-11 14:42:26 UTC (rev 570)
+++ branches/1.0/data/levels/enigma_vi/index.xml	2007-01-11 17:38:02 UTC (rev 571)
@@ -72,6 +72,8 @@
     <level _seq="64" _title="Walk the line" _xpath="./erich02_1" author="Erich Schubert" ctrl="force" easy="true" id="erich02" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="65" _title="Knights &amp; Boxes" _xpath="./johannes01_1" author="Johannes Laire" ctrl="force" easy="false" id="20061201johannes313" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="66" _title="Knight's Journey" _xpath="./johannes02_1" author="Johannes Laire" ctrl="force" easy="false" id="20061210johannes313" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="67" _title="Blitz Chess" _xpath="./luc32_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc322006" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="68" _title="River of Challenges" _xpath="./luc33_1" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc332006" rel="1" rev="3" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Added: branches/1.0/data/levels/enigma_vi/luc32_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/luc32_1.xml	2007-01-11 14:42:26 UTC (rev 570)
+++ branches/1.0/data/levels/enigma_vi/luc32_1.xml	2007-01-11 17:38:02 UTC (rev 571)
@@ -0,0 +1,92 @@
+?<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Blitz Chess" el:subtitle="Move fast!" el:id="luc322006"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
+      <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
+      <el:copyright>Copyright ? 2006 Lukas Sch?ller</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+CreateWorld(20,13)
+fill_floor("fl-wood")
+
+function writeLine( line, cells)
+  for i=1, strlen(cells) do
+    local c = strsub(cells,i,i)
+    if(c ==".") then
+      set_floor("fl-abyss",i-1,line)
+    elseif(c =="#") then
+      set_stone("st-greenbrown",i-1,line)
+    elseif(c =="x") then
+      set_item("it-trigger",i-1,line)
+    elseif(c =="o") then
+      set_stone("st-switch",i-1,line)
+    elseif(c =="e") then
+      set_stone("st-laser-e",i-1,line)
+    elseif(c =="n") then
+      set_stone("st-laser-n",i-1,line)
+    elseif(c =="b") then
+      set_floor("fl-bridge",i-1,line,{type="x"})
+    elseif(c =="l") then
+      set_stone("st-lightpassenger",i-1,line,{interval=0.001})
+    elseif(c =="/") then
+      set_stone("st-mirror-p\\",i-1,line)
+    elseif(c =="<") then
+      set_stone("st-mirror-3>",i-1,line)
+    elseif(c =="k") then
+      set_stone("st-chess_black",i-1,line)
+    elseif(c =="s") then
+      set_floor("fl-swamp",i-1,line)
+    elseif(c =="t") then
+      set_floor("fl-thief",i-1,line)
+    elseif(c =="w") then
+      set_item("it-wormhole",i-1,line,{targetx=8.5,targety=6.5,range=0.5})
+    elseif(c =="O") then
+      oxyd(i-1,line)
+    elseif(c =="0") then
+      set_actor("ac-blackball",i-0.5,line+0.5,{player="0"})
+    end
+  end
+end
+
+writeLine(00,"......#.............")
+writeLine(01,".O....x.....   .ttt.")
+writeLine(02,".<....  b    / .t.t.")
+writeLine(03,".O.x..  .....  .t.t.")
+writeLine(04,"... .. ..k  . ..t.t.")
+writeLine(05,".el    s. . ./..w.t.")
+writeLine(06,".....  .    ......t.")
+writeLine(07,"......  .. ..   ..t.")
+writeLine(08,".       ..    . ..t.")
+writeLine(09,". ....n   ..... ..t.")
+writeLine(10,". .   ...       ..t.")
+writeLine(11,".   .  o..........0.")
+writeLine(12,"....................")
+
+SetAttrib(enigma.GetStone(1,5),"init",FALSE)
+SetAttrib(enigma.GetStone(6,9),"init",FALSE)
+
+Signal ("st(7 11)","st(1 5)")
+Signal ("it(3 3)","st(6 9)")
+Signal ("it(6 1)","fl(8 2)")
+
+oxyd_shuffle()
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="true"/>
+        <el:translation el:lang="de">Blitzschach</el:translation>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="true"/>
+        <el:translation el:lang="de">Ziehe schnell!</el:translation>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_vi/luc32_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/enigma_vi/luc33_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/luc33_1.xml	2007-01-11 14:42:26 UTC (rev 570)
+++ branches/1.0/data/levels/enigma_vi/luc33_1.xml	2007-01-11 17:38:02 UTC (rev 571)
@@ -0,0 +1,304 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="River of Challenges" el:subtitle="At the Riverside" el:id="luc332006"/>
+      <el:version el:score="1" el:release="1" el:revision="3" el:status="released"/>
+      <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
+      <el:copyright>Copyright ? 2006 Lukas Sch?ller</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+      </el:compatibility>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:credits el:showinfo="true" el:showstart="false">
+          Thanks to Raoul, Ronald and Andreas for testing and making small impovements
+        </el:credits>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+CreateWorld(39,37)
+oxyd_default_flavor="c"
+
+if difficult then
+  cvalue=13
+else
+  cvalue=15
+end
+
+l=1
+function toggle_laser()
+  if(l==0) then
+    l=1
+  else
+    l=0
+    SendMessage("thelaser","onoff",nil)
+  end
+end
+
+function writeFloors(line,cells)
+  for i=1, strlen(cells) do
+    local c = strsub(cells,i,i)
+    if(c==" ") then
+      set_floor("fl-leaves",i-1,line)
+    elseif(c=="-") then
+      set_floor("fl-leavesb",i-1,line)
+    elseif(c=="~") then
+      set_floor("fl-water",i-1,line)
+    elseif(c=="$") then
+      if difficult then
+        set_floor("fl-water",i-1,line)
+      else
+        set_floor("fl-leaves",i-1,line)
+      end
+    elseif(c=="x") then
+      set_floor("fl-abyss",i-1,line)
+    elseif(c==".") then
+      set_floor("fl-sand",i-1,line)
+    elseif(c=="+") then
+      set_floor("fl-wood",i-1,line)
+    elseif(c==":") then
+      set_floor("fl-dunes",i-1,line)
+    elseif(c=="#") then
+      set_floor("fl-rock",i-1,line)
+    elseif(c=="b") then
+      set_floor("fl-bridge",i-1,line,{type="x"})
+    elseif(c=="j") then
+      set_floor("fl-springboard",i-1,line)
+    end
+  end
+end
+
+writeFloors(00,"                ..~~~~~~~..            ")
+writeFloors(01,"                ...~~~~~~..          - ")
+writeFloors(02,"                 ..~~~~~~...       ~ - ")
+writeFloors(03,"                 ..~~~~~~~...      ~ - ")
+writeFloors(04,"                 ..~~~~~~~~..    ~~~ ~ ")
+writeFloors(05,"                 ..~~~~~~~~..     -~~~ ")
+writeFloors(06,"                 ..~~~~~~~~...      -- ")
+writeFloors(07,"                 ..~~~~~~~~~..         ")
+writeFloors(08,"                  .~~~~~~~~~.          ")
+writeFloors(09,"                   ~~~~~~~~~           ")
+writeFloors(10,"               ::::+++b++bb++::::::::::")
+writeFloors(11,"               :    ~~~~~~~~~          ")
+writeFloors(12,"       ############ ~~~~~~~~~          ")
+writeFloors(13," ----- ############  ~~~~~~~~~         ")
+writeFloors(14," - # - ############   ~~~~~~~~         ")
+writeFloors(15," - :   ############  :++++~~~~         ")
+writeFloors(16," - ::::############::: ~~++++++        ")
+writeFloors(17," -    :############    ~~~~~~~         ")
+writeFloors(18," - ::::############  ~~~+++++~~        ")
+writeFloors(19," - :   ############  ~+++~~~++++       ")
+writeFloors(20," - :   ##b######### ~~+~~~~~~~~        ")
+writeFloors(21," - :   ############  ~+~++++++++       ")
+writeFloors(22," - ::::~~~::    :    ~+++~~~~~~        ")
+writeFloors(23," -     ~~  ::   :    ~~~~~+++++::::::::")
+writeFloors(24," #         :::  :   ~~~~+++~+~~~  -----")
+writeFloors(25," --------- :::  :::    ~~~~~+~~~   ----")
+writeFloors(26,"#########- :::  ##:::::++++++~~~    ---")
+writeFloors(27,"#########- ::  ###     ~~~~~~~~~     --")
+writeFloors(28,"#########- :    #      ~~~~~~~~~.    --")
+writeFloors(29,"#########:::    -      ~~~~~~~~~~.   --")
+writeFloors(30,"#########- :#---         ~~~~~~~~..    ")
+writeFloors(31,"#########- : ---         ~~~~~~~~~..   ")
+writeFloors(32,"#########  : ---~         ~~~~~~~~..   ")
+writeFloors(33,"   $~  $~  :#  ~~~        ~~~~~~~~..   ")
+writeFloors(34,"   $~  $~       ~         xxx++xxx...  ")
+writeFloors(35,"   $~  $~                 ~~~~~~~~~..  ")
+writeFloors(36,"                           ~~~~~~~~..  ")
+
+function writeStones(line,cells)
+  for i=1, strlen(cells) do
+    local c = strsub(cells,i,i)
+    if(c=="#") then
+      set_stone("st-camouflage",i-1,line)
+    elseif(c=="?") then
+      set_stone("st-invisible",i-1,line)
+    elseif(c=="+") then
+      set_stone("st-rock1",i-1,line)
+    elseif(c=="*") then
+      set_stone("st-wood_001",i-1,line)
+    elseif(c==".") then
+      set_stone("st-stoneimpulse",i-1,line)
+    elseif(c=="-") then
+      set_stone("st-brownie",i-1,line)
+    elseif(c=="s") then
+      set_stone("st-swap",i-1,line)
+    elseif(c=="1") then
+      set_stone("st-puzzle-ew",i-1,line)
+    elseif(c=="2") then
+      set_stone("st-puzzle-e",i-1,line)
+    elseif(c=="3") then
+      set_stone("st-puzzle-nw",i-1,line)
+    elseif(c=="4") then
+      set_stone("st-puzzle-s",i-1,line)
+    elseif(c=="5") then
+      set_stone("st-puzzle-ns",i-1,line)
+    elseif(c=="6") then
+      set_stone("st-puzzle-w",i-1,line)
+    elseif(c=="e") then
+      set_stone("st-laser-e",i-1,line,{init="false",name="thelaser"})
+    elseif(c=="x") then
+      set_stone("st-stone_break",i-1,line)
+    elseif(c=="$") then
+      if not difficult then
+        set_stone("st-stone_break",i-1,line)
+      end
+    elseif(c=="/") then
+      set_stone("st-mirror-p\\",i-1,line)
+    elseif(c=="&") then
+      set_stone("st-bolder-e",i-1,line)
+    elseif(c=="X") then
+      set_stone("st-grate1",i-1,line)
+    elseif(c=="|") then
+      set_stone("st-door-v",i-1,line)
+    elseif(c=="v") then
+      set_stone("st-oneway_black-s",i-1,line)
+    elseif(c=="<") then
+      set_stone("st-oneway_black-w",i-1,line)
+    elseif(c==">") then
+      set_stone("st-oneway_black-e",i-1,line)
+    elseif(c=="^") then
+      set_stone("st-oneway_black-n",i-1,line)
+    elseif(c=="k") then
+      set_stone("st-knight",i-1,line)
+    elseif(c=="A") then
+      set_stone("st-floppy",i-1,line)
+    elseif(c=="B") then
+      set_stone("st-key_a",i-1,line)
+    elseif(c=="C") then
+      set_stone("st-switch",i-1,line)
+    elseif(c=="D") then
+      set_stone("st-coinslot",i-1,line)
+    elseif(c=="o") then
+      oxyd(i-1,line)
+    end
+  end
+end
+
+writeStones(00,"##################???????########..##o#")
+writeStones(01,"########     ######                 # #")
+writeStones(02,"#         ##   ####             #   # #")
+writeStones(03,"#     ##       ####             ### # #")
+writeStones(04,"# 121 #    #   #                    # #")
+writeStones(05,"#     #    #  ## #               #    #")
+writeStones(06,"o 315 ######                     ###  #")
+writeStones(07,"#     ###      # #            s    ####")
+writeStones(08,"# 141      ## ##                      #")
+writeStones(09,"#      ##  ## #### *********          #")
+writeStones(10,"#      #  ### #                       #")
+writeStones(11,"########      # ####*********#        #")
+writeStones(12,"#######+++++..+ +++#         ##########")
+writeStones(13,"#     #+o ++-+   B+#e$$$$$xxxxxxxxxxx/#")
+writeStones(14,"# #v# #+  +A      +###        #######x#")
+writeStones(15,"# # ###+  ++++    +##         #     #x#")
+writeStones(16,"# #    <              #         ### #x#")
+writeStones(17,"# #### + +        +####       ##### #x#")
+writeStones(18,"# #    + +        +##          #### #x#")
+writeStones(19,"# # ###+ ++++++   +##               #x#")
+writeStones(20,"# # ###+     C+  o+#           ######x#")
+writeStones(21,"# # ###+++++++++ ++##               #x#")
+writeStones(22,"# D         #### ####          #### #x#")
+writeStones(23,"# #####  ##  ### ####      X         &#")
+writeStones(24,"#^##########  ## ###       +v+  #######")
+writeStones(25,"#         ### ##   ####    +          o")
+writeStones(26,"+++++++++ ##  ## +         <          #")
+writeStones(27,"+ox+    + #  ##+^+### #    +          #")
+writeStones(28,"+xx+    + # #### #### #               #")
+writeStones(29,"+  k    xxx #### #### #               #")
+writeStones(30,"+xx+    + # #  | ###  ###             #")
+writeStones(31,"+ox+    + # # ##  ## 6 ##             #")
+writeStones(32,"+++++++++## ####   # 1 ###            #")
+writeStones(33,"C           >      #  2 ##********    #")
+writeStones(34,"#           ##     # 1 2 6            #")
+writeStones(35,"#           ###   ##     #*********   o")
+writeStones(36,"###########################????????####")
+
+function writeItems(line,cells)
+  for i=1, strlen(cells) do
+    local c = strsub(cells,i,i)
+    if(c=="x") then
+      set_item("it-crack3",i-1,line)
+    elseif(c=="j") then
+      set_item("it-springboard",i-1,line)
+    elseif(c=="o") then
+      set_item("it-coin1",i-1,line)
+    elseif(c=="O") then
+      set_item("it-coin4",i-1,line,{value=15.5})
+    elseif(c=="f") then
+      set_item("it-floppy",i-1,line)
+    elseif(c=="k") then
+      set_item("it-key_a",i-1,line)
+    elseif(c=="e") then
+      set_item("it-extralife",i-1,line)
+    elseif(c=="*") then
+      set_item("it-wormhole",i-1,line,{targetx="9.5",targety="25.5",range="0.5"})
+    elseif(c=="d") then
+      set_item("it-dynamite",i-1,line)
+    end
+  end
+end
+
+writeItems(00,"                                       ")
+writeItems(01,"        xx                             ")
+writeItems(02,"                                       ")
+writeItems(03,"                                       ")
+writeItems(04,"                                       ")
+writeItems(05,"                                       ")
+writeItems(06,"                                       ")
+writeItems(07,"           x                           ")
+writeItems(08,"                                       ")
+writeItems(09,"                                       ")
+writeItems(10,"                                       ")
+writeItems(11,"                                       ")
+writeItems(12,"                                       ")
+writeItems(13,"                                       ")
+writeItems(14,"     e          o                      ")
+writeItems(15,"                                       ")
+writeItems(16,"                                       ")
+writeItems(17,"                                       ")
+writeItems(18,"                                       ")
+writeItems(19,"                                       ")
+writeItems(20,"                                       ")
+writeItems(21,"                                       ")
+writeItems(22,"      j                                ")
+writeItems(23,"                                       ")
+writeItems(24,"                        e O            ")
+writeItems(25,"                                       ")
+writeItems(26,"                            f          ")
+writeItems(27,"                                       ")
+writeItems(28,"                                       ")
+writeItems(29,"      k                                ")
+writeItems(30,"             d                         ")
+writeItems(31,"             *                         ")
+writeItems(32,"                                       ")
+writeItems(33,"                                       ")
+if difficult then
+  writeItems(34,"  j  j   j                             ")
+else
+  writeItems(34,"   j j   j                             ")
+end
+writeItems(35,"                                       ")
+writeItems(36,"                                       ")
+
+set_item("it-trigger",20,16,{action="on",target="thelaser"})
+set_item("it-trigger",36,23,{action="callback",target="toggle_laser"})
+
+Signal("st(11 14)","fl(22 10)")
+Signal("st(17 13)","fl(25 10)")
+Signal("st(13 20)","fl(26 10)")
+Signal("st(0 33)","fl(9 20)")
+Signal("st(2 22)","st(15 30)")
+
+oxyd_shuffle()
+
+set_actor("ac-blackball",1.5,6.5,{player=0})
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>



From raoul at mail.berlios.de  Thu Jan 11 20:12:32 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Thu, 11 Jan 2007 20:12:32 +0100
Subject: [Enigma-game-svn] r572 - branches/1.0/doc/manual
Message-ID: <200701111912.l0BJCWM9023551@sheep.berlios.de>

Author: raoul
Date: 2007-01-11 20:12:30 +0100 (Thu, 11 Jan 2007)
New Revision: 572

Modified:
   branches/1.0/doc/manual/enigma_fr.texi
Log:
-> Added french manual for version 1.00


Modified: branches/1.0/doc/manual/enigma_fr.texi
===================================================================
--- branches/1.0/doc/manual/enigma_fr.texi	2007-01-11 17:38:02 UTC (rev 571)
+++ branches/1.0/doc/manual/enigma_fr.texi	2007-01-11 19:12:30 UTC (rev 572)
@@ -2,27 +2,24 @@
 @afourpaper
 
 @c @include{version.texi}
- at set VERSION 0.92
+ at set VERSION 1.00
 
 @copying
-Copyright @copyright{} 2003, 2004, 2005 Daniel Heck
+Copyright @copyright{} 2003, 2004, 2005, 2006 Daniel Heck and other contributors
 
-Copying and distribution of this file, with or without modification,
-are permitted in any medium without royalty provided the copyright
-notice and this notice are preserved.
+La copie et la distribution de ce fichier, avec ou sans modification,
+sont autoris@'es sans royalty @`a condition que la notice de copyright
+et la pr@'esente notice soient pr@'eserv@'ees.
 @end copying
 
 @setfilename enigma.info
 @settitle Enigma Manual
 @titlepage
- at image{images/logo}
- at center @titlefont{Enigma Manual}
- at center pour version @value{VERSION}
+ at center @image{images/logo}
+ at center @titlefont{Manuel Enigma}
+ at center for version @value{VERSION}
 @sp 2
- at center Copyright @copyright{} 2003, 2004, 2005 Daniel Heck (@email{dheck@@gmx.de})
- at c @title Enigma Manuel
- at c @subtitle pour version 1.0
- at c @author Daniel Heck (@email{dheck@@gmx.de})
+ at center Copyright @copyright{} 2003, 2004, 2005, 2006 Daniel Heck (@email{dheck@@gmx.de})
 @page
 @vskip 0pt plus 1filll
 @insertcopying
@@ -37,408 +34,469 @@
 Ce manuel d@'ecrit comment installer Enigma et y jouer.  Il correspond
 @`a Enigma version @value{VERSION}.
 
-Copyright @copyright{} 2003, 2004, 2005 Daniel Heck
+Copyright @copyright{} 2003, 2004, 2005, 2006 Daniel Heck and other contributors
 
-Copier et distribuer ce fichier, avec ou sans modification,
-sont permis par tout moyen sans droit d'auteur @`a condition 
-que la notice sur le droit d'auteur et cette notice soient pr@'eserv@'ees.
+La copie et la distribution de ce fichier, avec ou sans modification,
+sont autoris@'es sans royalty @`a condition que la notice de copyright
+et la pr@'esente notice soient pr@'eserv@'ees.
 @c @insertcopying
 @end ifnottex
 
 @menu
-* Introduction::                Comment commencer avec Enigma
-* Le jeu::                      Comment jouer @`a Enigma
-* Objets du jeu::               Description de certains objets du jeu
-* Triche::                      Astuces pour certains niveaux difficiles
-* Cr@'edits::                     Cr@'edits et `Thank You's
+* Introduction::                Comment commencer
+* Le jeu::                    Comment jouer @`a Enigma
+* Quelques objets du jeu::           Description de quelques objets du jeu
+* Expertise::             Options @'elabor@'es et administration
+* Triche::                    Astuces pour certains niveaux difficiles
+* Cr@'edits::                     Cr@'edits et 'Saints-Clouds
 
- at detailmenu
- --- The Detailed Node Listing ---
-
-Introduction
-
-* A propos::                    Certains faits sur Enigma
-* Installation::                Obtenir et installer Enigma
-* Distribuer Enigma::           Partagez-le avec vos amis!
-
-Le jeu
-
-* Comment commencer::           Naviguer dans les menus et d@'emarrer une partie
-* R@`egles du jeu::               Comment jouer @`a Enigma
-* Contr@^oles::                   Raccourcis clavier et souris
-
-Comment commencer
-
-* Le menu des niveaux::         Choisir un niveau
-* Options de jeu::              Adapter Enigma @`a vos pr@'ef@'erences
-
-R@`egles du jeu
-
-* Paysages normaux::           
-* Paysages @`a deux joueurs::       
-* Paysages de m@'editation::       
-
-Objets du jeu
-
-* Outils::                       
-* Pierres::                      
-
-Outils
-
-* Explosifs::                   Dynamite et bombes
-* Parapluies::                   
-* Drapeaux::                    Le point de retour
-
-Pierres  
-
-* Pierres mortelles::               
-* Pierres d'@'echange::                 
-* Miroirs::                     
-* Pierres magiques::                
-* Pierres Shogun::               
-* Pierres @'electriques::             
-* Pierres de puzzle::               
-* Pierres postales::                 
-
-Triche
-
-* Tutoriel::                    Promenade dans 'advanced tutorial'
-* Indices::                     Indices pour plusieurs niveaux
-
-Cr@'edits
-
-* D@'eveloppeurs principaux::             
-* Special Thanks::              
-* Contributeurs::                
-* Logiciels utilis@'es::           
-
- at end detailmenu
 @end menu
 
 @node Introduction, Le jeu, Haut, Haut
 @chapter Introduction
 
 @menu
-* A propos::                    Certains faits sur Enigma
-* Installation::                Obtenir et installer Enigma
-* Distribuer Enigma::           Partagez-le avec vos amis!
+* A propos::                       Certains faits sur Enigma
+* Installation::                Se procurer et installer Enigma
+* Distribuer Enigma::         Donnez des copies @`a vos amis !
 @end menu
 
 
 @node A propos, Installation, Introduction, Introduction
 @section A propos d'Enigma
 
-Dans les ann@'ees 1990 (peu apr@`es l'@'epoque de N@'eanderthal), l'un des jeux sur ordinateur les plus
-intrigants qui soient s'appelait 'Oxyd'; il a @'et@'e diffus@'e sur Atari ST puis sur de nombreuses autres
-plates-formes par une firme r@'epondant au doux nom de 'Dongleware'. Malgr@'e de nombreuses
-recherches arch@'eologiques men@'ees conjointement par Lara Croft, Sydney Fox et Indiana Jones, on
-n'a jamais prouv@'e l'existence d'un 'Oxyd 2'; n@'eanmoins il y a eu successivement Per.Oxyd, Oxyd
-Magnum puis Oxyd Extra. En 2002 Dongleware a abandonn@'e ses activit@'es dans le secteur du jeu et
-le jeu Oxyd.
-Enigma est un clone d'Oxyd (quelques diff@'erences mais globalement c'est le m@^eme principe). M@^eme
-si vous n'avez jamais eu la chance de jouer @`a Oxyd, vous adorerez Enigma si vous aimez r@'efl@'echir et
-si vous @^etes habile avec le mulot.
-Enigma se t@'el@'echarge sur @uref{www.nongnu.org/enigma} et c'est sur ce site qu'on trouve les nouveaut@'es le
-concernant. Ce jeu est libre, ce qui signifie que non seulement vous avez le droit de le copier et de
-le distribuer, mais vous y @^etes m@^eme encourag@'e ! (voir la section 1.4 pour plus de d@'etails)
+Enigma n'est pas vraiment un jeu d'esprit.  Enigma est en r@'ealit@'e une
+immense collection de jeux d'esprit, et chacun de ses 550 uniques niveaux
+d@'efie l'intelligence, la dext@'erit@'e et la volont@'e des joueurs de
+mani@`ere in@'edite.  Enigma est facile @`a apprendre, ludique et parfois
+difficile.  On peut y jouer @`a tout @^age.  Il contient des centaines de
+niveaux. Et comme si ce n'@'etait pas assez, il est gratuit. Si vous aimez les
+jeux d'esprit et que vous avez le geste s@^ur, Enigma vous occupera pendant des
+heures.
 
+L'object du jeu est de trouver et d@'evoiler des paires de pierres
+ at samp{Oxydes} de m@^eme couleur. Simple? Oui. Facile? Certes non!  Des pi@`eges
+cach@'es, d'immenses labyrinthes, des rayons laser, et surtout des @'enigmes @`a
+s'arracher les cheveux bloqueront le chemin qui vous m@`ene aux Oxydes.
+Les objets du jeu (il y en a des centaines), agissent de mani@`ere inattendue, et
+comme la plupart ob@'eissent aux lois de la physique (du moins la physique un peu
+sp@'eciale d'Enigma), les contr@^oler avec la souris n'est pas toujours ais@'e
+ at enddots{}
 
+A l'origine, le projet Enigma a @'et@'e fond@'e pour perp@'etuer l'esprit des jeux de la
+s@'erie des 'Oxyd , lorsque leur @'editeur a d@'ecid@'e en 2002 de quitter le monde du
+jeu. Les amateurs d'Oxyd trouveront @`a Enigma un air familier. Mais au cours des
+ans, Enigma a phagocyt@'e des id@'ees d'innombrables autres jeux, en leur donnant
+son propre style.
+ at c Avez-vous d@'ej@`a jou@'e @`a Sokoban
+ at c en poussant des cavaliers ?
+ at c R@'eminiscez-vous quelques niveaux seuls, ou
+ at c comme Sokoban en paquets de nombreux niveaux.
+
+Enigma existe pour Windows, Mac OS X, et la plupart des Linux et autres Unix
+modernes. Il a @'et@'e traduit en plusieurs langues. M@^eme ce manuel est
+disponible en plusieurs langues (@emph{et cette phrase est autor@'ef@'erentielle; enfin la
+phrase pr@'ec@'edente; quoique la pr@'esente phrase aussi}).
+
+Sur @uref{http://www.nongnu.org/enigma, homepage}, vous trouverez des copies
+d'@'ecran, des t@'el@'echargements, des news, et la version la plus r@'ecente de ce
+manuel: @uref{http://www.nongnu.org/enigma/manual, manual}.
+On peut joindre les d@'eveloppeurs par email @`a @email{enigma-devel@@nongnu.org}.
+
+Enigma est un logiciel libre: vous @^etes encourag@'es @`a le copier et en faire
+cadeau autour de vous (@ref{Distribuer Enigma}).  Enigma est d@'evelopp@'e
+par un petit groupe de volontaires, qui y consacrent leurs loisirs.
+Si vous aimez ce jeu n'h@'esitez pas @`a envoyer un email. C'est probablement la
+seule r@'ecompense qu'auront ses cr@'eateurs.
+
+
 @node Installation, Distribuer Enigma, A propos, Introduction
 @section Installation
 
-La derni@`ere version du jeu se t@'el@'echarge sur @uref{www.nongnu.org/enigma/downloads} et le protocole
-d'installation diff@`ere selon la plate-forme:
+La derni@`ere version d'Enigma peut @^etre t@'el@'echarg@'ee @`a
+ at uref{http://www.nongnu.org/enigma/download.html, Download
+Page}. On y trouve des packages pour les syst@`emes d'exploitation suivants:
 
 @table @strong
 @item Windows
-Le jeu est fourni sous la forme d'un ex@'ecutable, qu'il suffit @dots{} d'@'ex@'ecuter !
+Il suffit d'ex@'ecuter apr@`es t@'el@'echargement, le fichier @file{.exe} .
 
 @item Unix
-Il existe des ex@'ecutables binaires pour SuSe, Debian et RedHat; pour les autres, l'usage est de
-le compiler @`a partir du source. (des d@'ependances sont n@'ecessaires, elles sont list@'ees sur le site)
+Des binaires existent pour des Linux comme SUSE,
+Redhat, ou Debian. Pour les autres, il faudra compiler le source.
 
 @item Mac OS X
-L'installation n'est pas n@'ecessaire, il suffit d'ex@'ecuter le fichier 
- at file{.dmg} ou le fichier @file{.tar.gz}.
+Pas d'installation n@'ecessaire pour la version OS X , il faut juste ex@'ecuter le
+fichier @file{.dmg} ou @file{.tar.gz} .
 
 @end table
 
-En cas de probl@`emes d'installations, des conseils sont disponibles sur 
-enigma-devel@@nongnu.org (dans la langue de Shakespeare toutefois).
-Si Enigma ne fonctionne pas sur votre ordinateur, n'h@'esitez pas @`a 
-demander de l'aide sur la liste (@email{enigma-devel@@nongnu.org}).
+La page 'download contient en g@'en@'eral des informations plus d@'etaill@'ees ou plus
+r@'ecentes . Si Enigma ne fonctionnait pas sur votre ordinateur, ne vous g@^enez
+pas pour demander @`a la liste postale d'Enigma
+(@email{enigma-devel@@nongnu.org}).
 
- at c @node Emulating Oxyd, Distribuer Enigma, Installation, Introduction
- at c @section Emulating Oxyd
+ at node Distribuer Enigma,  , Installation, Introduction
+ at section Distribuer Enigma
 
- at c Comme mentionn@'e dans l'introduction, Enigma descend d'Oxyd; pour autant la compatibilit@'e n'est
- at c pas assur@'ee @`a 100%. Notamment il manque plusieurs objets d'Oxyd, et le jeu en r@'eseau n'est pour
- at c l'instant pas du tout impl@'ement@'e. Ce qui marche:
- at c Les effets sonores d'Oxyd sont importables;
- at c La plupart des paysages d'Oxyd sont importables dans Enigma, de la mani@`ere suivante: Enigma
- at c cherche automatiquement @`a importer les paysages qu'il cherche par d@'efaut dans les dossiers
- at c suivants:
+Enigma est un logiciel libre plac@'e sous la licence
+GNU General Public License (GPL).  Cette licence accompagne toutes les versions
+d'Enigma (ou bien dans @file{COPYING} ou alors dans
+ at file{COPYING.txt}).  Si tout ce que vous voulez est @emph{jouer @`a} Enigma, vous
+n'aurez pas besoin de lire ce texte l@'egal r@'edig@'e en anglais. En substance, il
+dit ceci: Jouez @`a Enigma tant que vous voulez, et n'oubliez pas de le
+distribuer autour de vous !
 
- at c @table @strong
- at c @item Windows
- at c le dossier 'data' cr@'e@'e @`a l'installation d'Enigma; typiquement c'est C:\Program
- at c Files\Enigma\data
+Si vous d@'esirez modifer Enigma ou contribuer @`a son d@'eveloppement futur,
+ @emph{lisez} la license, au moins une fois dans votre vie.
+La GPL assure que Enigma restera un logiciel libre dans le futur.
+En particulier, si vous modifiez Enigma ou distribuez une version modifi@'ee,
+vous ne devez emp@^echer quiconque d'utiliser, modifier, et distribuer
+Enigma et ses deriv@'es.
 
- at c @item Unix / OS X
- at c Il y a deux emplacements possibles, l'un au niveau du syst@`eme (typiquement
- at c '/usr/local/share/enigma'), l'autre au niveau de l'utilisateur courant (un fichier appel@'e '".enigma'
- at c dans le r@'epertoire 'home').
+Les deux paragraphes pr@'ec@'edents ne remplacent pas la vraie license,
+mais la r@'esument.  Si vous avez des doutes, consultez la
+GPL ou demandez.
 
- at c Tout ce qu'il reste @`a faire est de copier les fichiers suivants dans le r@'epertoire 'data' (en n'oubliant
- at c pas que sous Unix la casse doit @^etre respect@'ee):
-
- at c @multitable {Oxyd magnum gold} {@file{oxyd1ibm.dat}}
- at c @item @strong{Game}	@tab @strong{Data file}
- at c @item Per.Oxyd		@tab @file{peroxyd.dat}
- at c @item Oxyd 1		@tab @file{oxyd1ibm.dat}
- at c @item Oxyd extra	@tab @file{oxydex.dat}
- at c @item Oxyd magnum	@tab @file{oxydmibm.dat}
- at c @item Oxyd magnum gold	@tab @file{oxydmgg.dat}
- at c @end multitable
-
- at c Per.Oxyd et Oxyd 1 sont 'dongleware' (un r@'egime proche du shareware) et peuvent @^etre
- at c t@'el@'echarg@'es sur le net (essayez de soumettre @`a votre moteur de recherche favori, les mots 'oxyd' et
- at c 'abandonware'). Par contre les autres fichiers sont toujours commerciaux et il n'est autoris@'e de les
- at c utiliser que si on poss@`ede une copie acquise l@'egalement. Pour des questions de droit d'auteur, il n'est
- at c pas question d'inclure aucun des fichiers mentionn@'es ci-dessus, dans Enigma; inutile de le demander
- at c donc @enddots{}
-
- at node Distribuer Enigma,  , Installation, Introduction
- at section Distribuer Enigma
-
-Enigma est couvert par la licence GPL (Gnu Public licence) de GNU (ce qui signifie que le nom de
-son site Internet est tr@`es g@"delien @enddots{}); le texte de cette licence est fourni avec la distribution Enigma:
-Si tout ce que vous voulez faire d'Enigma est y jouer (apr@`es tout il est fait pour @,{c}a ! ): Vous ne
-voudrez probablement pas lire ladite licence; dans ce cas elle stipule que vous avez le droit de jouer
-@`a Enigma, d'y faire jouer vos amis, de le leur distribuer, de le promouvoir !
-Si vous voulez contribuer par exemple en @'ecrivant vos propres niveaux (c'est encore le plus fun ! ) il
-faut vraiment lire ladite licence ne serait-ce qu'une fois; en r@'esum@'e elle est h@'er@'editaire ce qui vous
-oblige @`a l'appliquer @`a vos modifications, et vous interdit par exemple de leur attibuer un caract@`ere
-commercial.
-
- at node Le jeu, Objets du jeu, Introduction, Haut
+ at node Le jeu, Quelques objets du jeu, Introduction, Haut
 @chapter Le jeu
 
 @menu
-* Comment commencer::            Naviguer dans les menus et d@'emarrer une partie
-* R@`egles du jeu::                Comment jouer @`a Enigma
-* Contr@^oles::                    Raccourcis clavier et souris
+* Pour commencer::             Naviguer dans les menus et commencer un jeu
+* R@`egles du jeu::           Comment jouer @`a Enigma
+* Contr@^oles::                   Commandes clavier et souris
 @end menu
 
 
- at node Comment commencer, R@`egles du jeu, Le jeu, Le jeu
- at section Comment commencer
+ at node Pour commencer, R@`egles du jeu, Le jeu, Le jeu
+ at section Pour commencer
 
-Au lancement du jeu, appara@^it le menu principal @`a partir duquel on peut commencer @`a jouer (plut@^ot
-facile), quitter le jeu (ceci peut n@'ecessiter une d@'esintoxication @enddots{}) ou r@'egler des options de jeu. Les
-paragraphes suivants expliquent une partie des r@'eglages; le reste se trouve normalement @`a l'usage.
+Apr@`es avoir lanc@'e Enigma, vous voyez le menu principal, avec lequel vous pouvez
+commencer un nouveau jeu, r@'egler quelques options, ou quitter le jeu. Les
+sections suivantes couvrent rapidement le menu des niveaux et le menu des
+options; tout le reste devrait @^etre auto-explicatoire. Pour beaucoup de menus,
+il y a une aide en ligne, qu'on trouve en pressant la touche @key{F1} .
 
 @menu
-* Le menu des niveaux::           Choisir un niveau
-* Options de jeu::                Adapter Enigma @`a vos pr@'ef@'erences
+* Le menu des niveaux::              Choisir le prochain niveau
+* Le menu des paquets de niveaux::         Choisir un paquet de niveaux
+* Options de jeu::                Adaptez Enigma @`a vos go@^uts
+* L'inspecteur des niveaux::         Informations d@'etaill@'ees sur un niveau
 @end menu
 
 
- at node Le menu des niveaux, Options de jeu, Comment commencer, Comment commencer
+ at node Le menu des niveaux, Options de jeu, Pour commencer, Pour commencer
 @subsection Le menu des niveaux
 
-En cliquant sur 'nouveau jeu' on voit l'@'ecran des paysages qui ressemble @`a ceci:
+En cliquant sur ``Commencer partie'' dans le menu principal, on d@'ecouvre le
+menu des niveaux, qui ressemble @`a ceci:
 
 @image{images/levelmenu,,7cm}
 
-On y voit, en haut, des informations sur le niveau s@'electionn@'e et le chapitre courant, puis au milieu
-de l'@'ecran, des repr@'esentations des niveaux disponibles, et en bas des boutons. Pour jouer un des
-niveaux, il suffit de cliquer sur le dessin du paysage tel qu'on le voit @`a l'@'ecran, ou d'appuyer sur
-'Entr@'ee' d@`es qu'il est s@'electionn@'e; les ascenseurs @`a droite permettent de faire d@'efiler les paysages
-du chapitre courant.
-Les m@'edailles d'argent repr@'esentent les paysages d@'ej@`a r@'esolus en mode 'Facile', les m@'edailles d'or
-repr@'esentent les paysages r@'esolus en mode 'Normal'. Pour aller directement au prochain paysage
-non r@'esolu, un appui sur 'F5' ou un clic sur le bouton repr@'esentant 2 m@'edailles fait l'affaire.
-Si jamais les m@'edailles sont accompagn@'ees d'un autre symbole, cela signifie que le niveau a @'et@'e
-modifi@'e depuis la derni@`ere fois qu'on y a jou@'e. Les touches suivantes pr@'esentent un int@'er@^et dans cet
-@'ecran:
+Cet @'ecran est divis@'e en trois parties: Celle du haut contient des informations
+@`a propos du niveau et du paquet de niveaux courants, celle du milieu montre une
+vue a@'erienne des niveaux actuellement disponibles, et celle du bas est une
+rang@'ee de boutons (comme mon visage ).
+
+On peut se d@'eplacer dans la liste des niveaux en utilisant les boutons en forme
+de fl@`eches sur la droite, ou bien en utilisant les fl@`eches du clavier. Pour
+commencer un nouveau jeu, il suffit de cliquer sur son image, ou de faire
+ @key{Entr@'ee}.
+
+Enigma a deux r@'eglages de difficult@'e : ``facile'' et ``normal.''  Pour
+alterner entre les deux, il faut utiliser le bouton avec des m@'edailles en bas:
+ Lorsque la m@'edaille est en argent et accompagn@'ee d'une plume, le r@'eglage est
+ sur ``facile'', et  quand elle est en or, le mode de jeu est plus difficile.
+
+Les niveaux ne poss@`edent pas tous un mode ``facile''; ceux qui en ont un sont
+rep@'er@'es par une plume ou une m@'edaille d'argent selon qu'ils ont d@'ej@`a @'et@'e
+r@'esolus ou non.
+
+La touche @key{F5} ou le clic sur le bouton
+ at key{>>|} qui est en bas, permettent d'aller au niveau suivant. Le sens du mot
+``suivant'' dans la phrase pr@'ec@'edente d@'epend du mode s@'electionn@'e avec le bouton
+le plus @`a gauche de la rang@'ee du bas:
+
+ at itemize @bullet
+ at item
+Une sph@`ere noire signifie ``vraiment le prochain''. On va au niveau qui suit,
+que celui-ci soit r@'esolu ou non.
+
+ at item
+ at c TODO: ``ready for awarding? also: use verb instead of -ing
+Les m@'edailles signifient ``Prochain niveau non r@'esolu''; c'est en effet @`a
+celui-l@`a que l'on se rend en cliquant sur le bouton @key{>>|} .
+
+ at item
+La sph@`ere noire en vitesse supraluminique est pour le mode ``par'' (acronyme
+pour ``professional average rating''). La performance professionnelle moyenne
+devrait @^etre @`a port@'ee d'un joueur dou@'e, et les niveaux pour lesquels v@^otre
+propre score est en-dessous du PAR sont marqu@'es par cette boule noire @`a grande
+vitesse. Dans ce mode le clic sur @key{>>|}  vous fait aller au prochain niveau
+pour lequel votre score est inf@'erieur ou @'egal au PAR de ce niveau.
+
+ at item
+La plan@`ete bleue repr@'esente la chasse au record du monde. Si votre propre score
+est le meilleur de la plan@`ete, le niveau est marqu@'e par ce symbole. Et si vous
+s@'electionnez ce mode, le niveau courant sera jou@'e et rejou@'e jusqu'@`a ce que vous
+ayez battu ledit record du monde.
+
+ at c Certes il est difficile de battre un record du monde. Mais on peut
+ at c utiliser ce mode pour s'entra@^iner @`a un niveau particulier.
+ at end itemize
+
+Il se peut qu'un niveau soit aussi marqu@'e par un triangle rouge surmont@'e d'un
+point d'exclamation (en haut @`a gauche). Cela arrive lorsque le niveau a @'et@'e
+modifi@'e apr@`es que vous l'avez r@'esolu. Vous le verrez probablement apr@`es une
+mise @`a niveau d'Enigma.
+
+On peut naviguer dans le menu des niveaux avec les touches suivantes:
+
 @table @kbd
- at item @key{ESC}
-Retour au menu principal
+ at item @key{Echap}
+Retourne au menu pr@'ec@'edent
 
 @item @key{F1}
-Ade en ligne
+Affiche l'aide en ligne
 
 @item @key{F5}
-Aller au prochain niveau non r@'esolu
+Saute au prochain niveau, comme le fait le bouton @key{>>|}
 
- at item Arrows
-S@'election d'un paysage
+ at item fl@`eches
+Change le niveau s@'electionn@'e
 
- at item @key{RET}
-Jouer le niveau s@'electionn@'e
+ at item @key{Entr@'ee}
+Joue le niveau s@'electionn@'e
 
- at item @key{Space}
-Aller au chapitre suivant
+ at item @key{Espace}
+Va au prochain paquet de niveaux
 
 @item @key{Backspace}
-Aller au chapitre pr@'ec@'edent
+Va au paquet de niveaux pr@'ec@'edent
 
 @end table
 
- at c Au d@'epart, seuls 10 niveaux de chaque chapitre sont jouables.
- at c Les autres niveaux sont `cadenass@'es', comme indiqu@'e par le verrou
- at c visible sur l'image.  On peut jouer aux niveaux d@'everouill@'es
- at c dans n'importe quel ordre, et chaque fois qu'on en a fini un, un
- at c des niveaux verrouill@'es se d@'everouille.
+ at node Le menu des paquets de niveaux, Options de jeu, Le menu des niveaux, Pour commencer
+ at subsection Le menu des paquets de niveaux
 
-Enigma est fourni avec de nombreux niveaux. Vraiment nombreux.  Pour 
-s''y retouver, on les a regroup@'es en ``chapitres'':
+Enigma contient tellement de niveaux qu'ils ont @'et@'e organis@'es en ``paquets de
+niveaux''; et comme chaque version d'Enigma a vu na@^itre de nouveaux niveaux,
+on a organis@'e les paquets de niveaux en ``groupes''. Cette organisation est
+plus simple @`a l'usage qu'@`a la description.
 
+Pour s@'electionner un paquet de niveaux, il faut cliquer sur  ``Pack de niveaux''
+qui est dans le menu principal et dans le menu des niveaux.
+
+Ce menu montre les groupes dans la colonne de gauche et les paquets de niveaux
+du groupe courant dans la colonne de droite. Les groupes actuellement fournis
+avec Enigma sont les suivants:
+
 @itemize @bullet
- at item Tutorial
- at item Enigma
- at item Enigma 2
- at item Oxyds
- at item Esprit
- at item Sokoban
+ at item @b{Enigma} - niveaux qui n'ont @'et@'e @'ecrits que pour Enigma
+ at item @b{D@'ej@`a-vu} - que vous pourriez avoir d@'ej@`a vu avant
+ at item @b{Sokoban}
+ at item @b{Facets} - tris sp@'eciaux @`a partir des niveaux pr@'ec@'edents
+ at item @b{User} - niveaux et paquets personnels comme par exemple l'historique
+et les paquets faits par l'utilisateur.
+ at item @b{Development} - patrons et niveaux pas finis par l'@'equipe d'Enigma
+ at item @b{All Packs} - La totale
 @end itemize
 
-Pour se d@'eplacer dans les chapitres, utilisez les touches @key{Space}
-et @key{Backspace} , ou le bouton ``Level Pack''.
+Un clic sur le bouton gauche s@'electionne un paquet de niveaux.
 
- at node Options de jeu,  , Le menu des niveaux, Comment commencer
+Pour des descriptions plus d@'etaill@'ees sur les paquets de niveaux voyez
+ at ref{Paquets utilisateur}.
+
+ at node Options de jeu, L'inspecteur des niveaux, Le menu des paquets de niveaux, Pour commencer
 @subsection Options de jeu
 
-Les options du jeu permettent de personnaliser le comportement d'Enigma:
+Le menus des options vous permet d'adapter Enigma @`a vos pr@'ef@'erences.
 
+ at table @strong
+ at item Langue
+Choisir la langue pour les menus et si possible pour les documents qui sont
+dans le niveau.
 
- at table @strong
 @item Plein Ecran
-Alterne entre les modes plein @'ecran et fen@^etr@'e; Alt-Entr@'ee fait pareil
+Alterne entre les modes plein @'ecran et fen@^etre.
+ at kbd{Alt- at key{Entr@'ee}} a le m@^eme effet, m@^eme en dehors du menu des options.
+ at emph{Note:} Sur certains syst@`emes il faut retourner au menu principal pour
+pouvoir retourner au mode plein @'ecran.
 
- at item Mode Video
-Le mode vid@'eo changera lors du retour @`a l'@'ecran principal
+ at item Mode vid@'eo
+Ce bouton permet de changer le mode vid@'eo utilis@'e par Enigma; il ne prend effet
+que lorsque l'on retourne au menu principal.
 
- at item Vitesse de la souris
-Permet de r@'egler la fa@,{c}on dont les mouvements de la souris influencent ceux de la
-boule sur l'@'ecran (la masse de la boule); pendant le jeu on peut varier la masse de
-la boule avec les fl@`eches gauche et droite.
+ at item Correction gamma
+Si n@'ecessaire, permet de r@'egler la luminosit@'e de l'@'ecran.
 
- at item Sauter les niveaux r@'esolus
-A la fin d'un niveau, Enigma passe automatiquement au suivant, ou au suivant
-non r@'esolu, selon l'@'etat de ce bouton.
+ at item Vitesse souris
+D@'etermine @`a quelle vitesse la boule acc@'el@`ere quand on bouge la souris.
+Les fl@`eches gauche et droite permettent de changer la vitesse de la souris
+durant le jeu.
 
- at item Chasse au temps
-Si ce bouton est appuy@'e, le niveau recommence tout seul si on atteint le meilleur
-temps enregistr@'e.
+ at item Volume sonore
+R@`egle le volume des effets sonores durant le jeu.
 
- at item Volume bruitages
-Permet de r@'egler le volume des effets sonores du jeu.
+ at item Jeu de sons
+Ce bouton vous permet de choisir le jeu d'effets sonores qu'Enigma va utiliser
+pendant le jeu.  Si vous utilisez Enigma avec les fichiers de donn@'ee d'Oxyd,
+cette option vous permet d'utiliser les sons d'Oxyd dans tout le jeu.
 
- at item Bruits
-Permet de choisir entre les effets d'Oxyd et ceux d'Enigma.
-
 @item Volume musique
-R@`egle le volume de la musique de fond.
+Le volume de la musique de fond qui passe dans les menus.
 
- at c @item Musique pendant le jeu
- at c Enigma peut jouer des musiques pendant le jeu.  Ou pas, selon l'@'etat de ce bouton.
+ at c @item Musique dans le jeu
+ at c Enigma peut jouer de la musique pendant le jeu.  Ou pas. Selon.
 
- at item Stereo
-Permet de choisir entre les modes st@'er@'eo et le mode mono.
+ at item St@'er@'eo
+Alterne entre la st@'er@'eo ``normale'' , la st@'er@'eo``invers@'ee'' , et la mono (non,
+pas la monitrice, la monophonie).
+
+ at item Mise @`a jour records
+Si mis sur @samp{Auto} Enigma essayera r@'eguli@`erement de charger des scores ce
+qui mettra @`a jour les donn@'ees de score, records du monde, PAR etc.
+ at xref{Homologuer les scores}.
+
+ at item Nom utilisateur
+Entrez votre nom ou alias qui sera attach@'e @`a enigma.score si vous le mettez @`a
+jour. @xref{Homologuer les scores}.
+
+ at item Chemin utilisateur
+L@`a o@`u Enigma enregistre toutes vos donn@'ees utilisateur. Voir le manuel de
+r@'ef@'erence pour plus de d@'etail.
+
+ at item Chemin images
+L@`a o@`u Enigma enregistre toutes vos images. Voir le manuel de
+r@'ef@'erence pour plus de d@'etail.
+
 @end table
 
+ at node L'inspecteur des niveaux, ,Options de jeu, Pour commencer
+ at subsection L'inspecteur des niveaux
 
- at node R@`egles du jeu, Contr@^oles, Comment commencer, Le jeu
+Pour lire des informations sur le niveau courant vous pouvez utiliser
+l'inspecteur des niveaux. Pour cela il faut cliquer-droit ou faire control-clic
+sur l'image du niveau dans le menu des niveaux.
+
+Vous pouvez comparer vos scores au record du monde, au par, au score de l'auteur.
+Il y a m@^eme des statistiques sur combien de joueurs ont r@'esolu ce niveau.
+
+Vous pouvez aussi entrer une petite annotation sur le niveau, et le noter.
+
+Sur certains syst@`emes, cette annotation ne peut @^etre entr@'ee qu'avec des codes
+ASCII.
+
+La note traduit votre impression personnelle sur le niveau. @samp{-} veut dire
+pas d'opinion. 0 - tr@`es mauvais, 5 - moyen, 10 - le meilleur des meilleurs. La
+note sera exp@'edi@'ee avec vos scores (@ref{Homologuer les scores}).
+
+Enfin l'inspecteur des niveaux permet de voir les captures d'@'ecran prises durant
+le jeu (@ref{Contr@^oles}).
+
+ at node R@`egles du jeu, Contr@^oles, Pour commencer, Le jeu
 @section R@`egles du jeu
 
 @menu
-* Paysages normaux::           
-* Paysages @`a deux joueurs::       
-* Paysages de m@'editation::       
+* Paysages normaux::
+* Paysages @`a deux joueurs::
+* Paysages de m@'editation::
 @end menu
 
 
 @node Paysages normaux, Paysages @`a deux joueurs, R@`egles du jeu, R@`egles du jeu
 @subsection Paysages normaux
 
-L'id@'ee de base est assez simple: Vous commandez une boule noire qui doit effleurer dans le bon
-ordre des pierres magiques appel@'ees 'oxydes', et qui ressemblent @`a ceci:
+L'id@'ee de base d'Enigma est simple: Dans la plupart des niveaux vous contr@^olez
+une boule de billard noire (@emph{ou plut@^ot  une sph@`ere, vu sa fragilit@'e et le
+bruit qu'elle fait en se brisant}) qui doit trouver et ``ouvrir'' des paires de
+pierres appel@'ees @emph{Oxydes}.  Les oxydes ferm@'ees ressemblent @`a ceci
+(il y a quatre variantes pour l'aspect, mais le comportement est le m@^eme):
 
 @image{images/st-oxyds,,0.7cm}
 
-(leur aspect peut varier d'un niveau @`a l'autre).
-Chaque fois qu'on touche une oxyde, elle s'ouvre momentan@'ement, r@'ev@'elant une couleur cach@'ee. Ici
-le point d'interrogation montre que l'oxyde est ouverte; il s'agit d'une oxyde bleue:
+Quand vous touchez une oxyde avec la boule noire, elle s'ouvre et r@'ev@`ele un motif
+color@'e.  Chaque niveau comprend deux oxydes de chaque couleur.  Vous devez toucher
+successivement deux oxydes de la m@^eme couleur pour les ouvrir d@'efinitivement -- si
+elles ne sont pas de la m@^eme couleur, la premi@`ere se referme . Vous avez r@'eussi
+un niveau lorsque vous avez ouvert toutes les paires d'oxydes qu'il contient .
+L'image suivante montre une paire d'oxydes vertes d@'ej@`a ouvertes. Le point
+d'interrogation @`a l'int@'erieur de l'oxyde bleue montre que l'autre oxyde bleue
+est toujours cach@'ee quelque part.
 
 @image{images/intro-oxyd,,3cm}
 
-Si on touche une oxyde d'une autre couleur, la pr@'ecedente se referme. Si on touche une oxyde de la
-m@^eme couleur, les deux restent d@'efinitivement ouvertes (du moins jusqu'@`a ce qu'une pierre p@'eteuse
-fasse son naus@'eabond office ! @enddots{}); ci-dessus les deux oxydes vertes sont d@'efinitivement ouvertes.
-Si on ne peut pas toucher directement une oxyde, on peut utiliser le rayon d'un laser pour ce faire,
-mais les lasers d@'etruisent les boules noires !
+ at emph{Au fait: Si ce n'est d@'ej@`a fait, le moment est appropri@'e pour d@'emarrer
+Enigma et essayer quelques niveaux!}
 
- at emph{Au fait: Si vous n'avez pas encore essay@'e de jouer @`a quelques paysages d'Enigma, le moment est
-appropri@'e @enddots{}!}
+Il suffit de passer par-dessus un objet pour le ramasser. L'inventaire en bas de
+l'@'ecran montre la liste des outils dont vous disposez. Au d@'ebut d'un nouveau jeu
+vous n'avez que deux vies suppl@'ementaires. L'image suivante montre un inventaire
+contenant une pelle, un morceau de papier, deux b@^atons de dynamite, vos deux vies
+suppl@'ementaires, et un parapluie:
 
-Pour ramasser un outil, il suffit de rouler dessus avec la boule noire (elle est tr@`es l@'eg@`ere et d'ailleurs
-fragile); en bas de l'@'ecran de jeu on voit l'inventaire des outils actuellement en possession de la
-boule noire; l'exemple ci-dessous montre un inventaire o@`u on a une pelle, un document, deux b@^atons
-de dynamite, deux vies et un parapluie:
-
 @image{images/intro-inventory,,1cm}
 
-Au d@'ebut du jeu, on poss@`ede deux vies suppl@'ementaires (au cas o@`u il arriverait quelque chose @`a cette
-si d@'elicate sph@`ere d'@'eb@`ene). Attention: l'inventaire n'est pas infini !
-Un clic sur le bouton gauche permet de d@'eposer, ou d'utiliser selon le cas, l'outil le plus @`a gauche:
-Par exemple le b@^aton de dynamite est d@'epos@'e m@`eche allum@'ee, et un ressort fait bondir la boule. Si on
-veut utiliser un autre outil que celui qui est @`a gauche, un clic droit r@'earrange les outils dans
-l'inventaire. Si pour une raison ou une autre, on souhaite ne pas ramasser un outil en passant dessus
-(on ne sait jamais, @,{c}a peut @^etre utile dans certains niveaux), il suffit de laisser le bouton gauche
-cliqu@'e en passant dessus.
-Certaines pierres sont mobiles (en les poussant assez fort avec la boule noire). Les plus utiles d'entre
-elles sont certainement les cubes de bois, qui permettent de construire des ponts au-dessus de zones
-interdites aux boules noires, comme les ab@^imes ou, ici, l'eau (la boule noire ne sait pas nager):
+L'objet le plus @`a gauche de l'inventaire peut @^etre actionn@'e en cliquant avec le
+bouton gauche: Il sera d@'epos@'e sur le sol ou accomplira une certaine action. Par
+exemple, la dynamite prend feu quand on la d@'epose, et les ressorts vont propulser
+la boule noire. Un clic avec le bouton droit ou le bouton central de la souris
+r@'earrange les objets de l'inventaire.
 
+Si, pour une quelconque raison, vous ne d@'esirez pas prendre un objet, passez
+dessus tout en laissant appuy@'e le bouton gauche de la souris. Cela peut servir en certaines
+occasions.
+
+Beaucoup de pierres peuvent @^etre boug@'ees en les poussant suffisamment fort. La
+plus utile des pierres mobiles est certainement celle qui est en bois, et qui
+peut servir @`a construire des ponts au-dessus de l'eau et de l'ab@^ime. Cette image
+montre comment on peut construire un pont en empilant des blocs de bois dans
+l'eau:
+
 @image{images/intro-plank,,4cm}
 
-On y voit la boule noire qui se construit un petit pont de bois, en jetant des cubes de bois dans
-l'@'el@'ement liquide.
-Certains objets peuvent se transformer, en les @'eclairant avec un laser ou en les @'ecrasant avec des
-pierres mobiles; et certaines pierres ont un comportement diff@'erent si on les actionne avec un des
-outils de l'inventaire: L'exemple le plus connu est la baguette magique.
-Certains objets sont d@'ecrits au chapitre 3.
+Certains objets peuvent se transformer, en les @'eclairant avec un laser ou en
+les @'ecrasant avec des pierres mobiles; et certaines pierres ont un comportement
+diff@'erent si on les actionne avec un des outils de l'inventaire: L'exemple le
+plus connu est la baguette magique.
 
+Surtout ne vous laissez pas d@'ecourager par l'apparente complexit@'e du jeu -- le
+comportement de la plupart des objets devient @'evident au moment ad@'equat. Certains
+des objets les plus @'etranges sont d@'ecrits au  @ref{Quelques objets du jeu}.
+
 @node Paysages @`a deux joueurs, Paysages de m@'editation, Paysages normaux, R@`egles du jeu
 @subsection Paysages @`a deux joueurs
 
-H@'elas non: Ce n'est pas un jeu en r@'eseau; il n'y a d'ailleurs pas de niveaux avec vraiment deux
-joueurs, mais des niveaux @`a un joueur peuvent comporter deux boules pilotables par ledit joueur: La
-d@'ej@`a connue boule noire, et une autre qui est blanche; un tel niveau se reconna@^it @`a la pr@'esence d'un
-objet en forme de 'yin-yang' dans l'inventaire; cet objet permet de choisir laquelle des deux
-boules on souhaite piloter:
+H@'elas non: Ce n'est pas un jeu en r@'eseau; il n'y a d'ailleurs pas de niveaux
+avec vraiment deux joueurs, mais des niveaux @`a un joueur peuvent comporter
+deux boules pilotables par ledit joueur: La d@'ej@`a connue boule noire, et une
+autre qui est blanche; un tel niveau se reconna@^it @`a la pr@'esence d'un objet
+en forme de 'yin-yang' dans l'inventaire; cet objet permet de choisir laquelle
+des deux boules on souhaite piloter:
 
 @image{images/intro-twoplayer,,7cm}
 
-
 @node Paysages de m@'editation,  , Paysages @`a deux joueurs, R@`egles du jeu
 @subsection Paysages de m@'editation
 
-Certains niveaux sont tr@`es particuliers en ce qu'ils n'ont ni boule noire, ni oxydes: Ce sont les
-niveaux 'meditation'. Ils comprennent de petites boules blanches, @`a caser dans des creux:
+Dans les niveaux dits de m@'editation v@^otre r@^ole est tr@`es diff@'erent: Au lieu de
+chercher des oxydes qui se correspondent, vous devez placer des petites boules
+blanches dans des creux du sol. Le niveau est termin@'e d@`es que chaque petite boule
+blanche @emph{s'est immobilis@'ee} dans son petit nid douillet.
 
 @image{images/intro-meditation,,3cm}
 
-d@`es que chaque boule blanche s'est immobilis@'ee dans son propre creux, le niveau est fini. Le nom
-de m@'editation vient de ce que souvent, pour les r@'eussir, ces niveaux requi@`erent calme et lenteur @enddots{}
+Ceci dit, toutes les boules blanches sont actionn@'ees par la souris et un
+mouvement brusque de celle-ci peut faire sortir certaines d'entre elles de leur
+trou. Pour r@'eussir un niveau de m@'editation, il faut un geste assur@'e et beaucoup
+de patience (d'o@`u le nom de m@'editation donn@'e @`a ces niveaux !).
 
 @node Contr@^oles,  , R@`egles du jeu, Le jeu
 @section Contr@^oles
 
-Voici une liste des contr@^oles actifs en phase de jeu (pas besoin de les apprendre par coeur, cette liste
-est disponible par un appui sur la touche F1):
+Voici une liste des contr@^oles actifs en phase de jeu (pas besoin de les
+apprendre par coeur, cette liste est disponible par un appui sur la touche
+ at key{F1} .):
 
 @table @kbd
 @item clic gauche
@@ -482,12 +540,20 @@
 Retour @`a l'@'ecran des niveaux
 @end table
 
- at node Objets du jeu, Triche, Le jeu, Haut
- at chapter Objets du jeu
+ at node Quelques objets du jeu, Expertise, Le jeu, Haut
+ at chapter Quelques objets du jeu
 
+Il y a des dizaines d'objets diff@'erents dans le jeu Enigma. Ici seuls quelques-uns
+sont d@'ecrits. Si vous d@'ebutez en Enigma, c'est une bonne id@'ee de commencer par
+les niveaux du package ``tutorial'': Au d@'emarrage du jeu, cliquer sur
+``Pack de niveaux'', puis sur le bouton ``Enigma'' en haut @`a gauche, puis
+``Tutoriel'' @`a droite. En les jouant dans l'ordre, ``Oxyd Stones 1'' etc. le
+tutoriel vous montrera les objets et id@'ees les plus importants du jeu, et certains
+des niveaux les plus faciles d'Enigma.
+
 @menu
-* Outils::                       
-* Pierres::                      
+* Outils::
+* Pierres::
 @end menu
 
 @c @node Objets sp@'eciaux,,,
@@ -496,28 +562,28 @@
 @c @node Pr@'edateurs,,,
 @c @subsection Pr@'edateurs
 
- at node Outils, Pierres, Objets du jeu, Objets du jeu
+ at node Outils, Pierres, Quelques objets du jeu, Quelques objets du jeu
 @section Outils
 
 @menu
-* Explosifs::                   Dynamite et bombes
-* Parapluies::                   
-* Drapeaux::                    Le point de retour
+* Explosifs::                  Dynamite et bombes
+* Parapluies::
+* Drapeaux::                      Placer le point de r@'esurrection
 @end menu
 
 @node Explosifs, Parapluies, Outils, Outils
 @subsection Explosifs
-
 Il y a trois sortes d'explosifs, que voici du moins dangereux au plus redoutable:
 
 @image{images/it-explosives,,0.7cm}
 
-Le b@^aton de dynamite ne d@'etruit que les objets les plus fragiles; son utilit@'e est essentiellement de
-mettre le feu aux bombes.
-La bombe noire (la plus courante) est suffisamment puissante pour cr@'eer un crat@`ere et d@'etuire les
-pierres avoisinantes.
-La bombe blanche est thermonucl@'eaire: Elle a la puissance de 5 bombes noires, et peut donc
-d@'etruire la boule noire m@^eme si elle n'est pas tr@`es pr@`es: Il y int@'er@^et @`a s'@'eloigner tr@`es vite si elle est
+Le b@^aton de dynamite ne d@'etruit que les objets les plus fragiles; son utilit@'e
+est essentiellement de mettre le feu aux bombes, mais elle peut aussi servir @`a
+faire fondre des morceaux de glace . La bombe noire (la plus courante)
+est suffisamment puissante pour cr@'eer un crat@`ere et d@'etuire les pierres
+avoisinantes. La bombe blanche est thermonucl@'eaire: Elle a la puissance de 5
+bombes noires, et peut donc d@'etruire la boule noire m@^eme si elle n'est pas
+tr@`es pr@`es: Il y int@'er@^et @`a s'@'eloigner tr@`es vite si elle est
 allum@'ee !
 
 @node Parapluies, Drapeaux, Explosifs, Outils
@@ -525,19 +591,21 @@
 
 @image{images/it-umbrella,,0.7cm}
 
-Une fois actionn@'e, le parapluie conf@`ere @`a la boule noire, l'immunit@'e, mais pendant 10 secondes
-seulement. Son effet est annonc@'e par un halo blanc autour de la boule noire, constant pendant 7
-secondes, puis clignotant pendant les 3 derni@`eres secondes: Ce clignotement signifie donc qu'on est
-en fin d'immunit@'e.
+Une fois actionn@'e, le parapluie conf@`ere @`a la boule noire, l'immunit@'e,
+mais pendant 10 secondes seulement. Son effet est annonc@'e par un halo blanc
+autour de la boule noire, constant pendant 7 secondes, puis clignotant pendant
+les 3 derni@`eres secondes: Ce clignotement signifie donc qu'on est en fin
+d'immunit@'e.
 
 @node Drapeaux,  , Parapluies, Outils
 @subsection Drapeaux
 
 @image{images/it-flags,,0.7cm}
 
-Les drapeaux permettent de g@'erer le karma des boules: Normalement si un boule qui a encore des
-vies en r@'eserve meurt, elle ressuscite au point de d@'epart du niveau; si on a pr@'ealablement d@'epos@'e un
-drapeau quelque part, ce n'est plus le cas: La boule r@'eappara@^it @`a l'endroit du drapeau. La couleur du
+Les drapeaux permettent de g@'erer le karma des boules: Normalement si une boule
+qui a encore des vies en r@'eserve meurt, elle ressuscite au point de d@'epart
+du niveau; si on a pr@'ealablement d@'epos@'e un drapeau quelque part, ce n'est
+plus le cas: La boule r@'eappara@^it @`a l'endroit du drapeau. La couleur du
 drapeau est conforme @`a celle de la boule sur laquelle il agit.
 
 @c @node T@'el@'eporteurs, Elastiques, Drapeaux, Outils
@@ -546,18 +614,18 @@
 @c @node Elastiques,  , T@'el@'eporteurs, Outils
 @c @subsection Elastiques
 
- at node Pierres,  , Outils, Objets du jeu
- at section Pierres  
+ at node Pierres,  , Outils, Quelques objets du jeu
+ at section Pierres
 
 @menu
-* Pierres mortelles::               
-* Pierres d'@'echange::                 
-* Miroirs::                     
-* Pierres magiques::                
-* Pierres Shogun::               
-* Pierres @'electriques::             
-* Pierres de puzzle::               
-* Pierres postales::                 
+* Pierres mortelles::
+* Pierres d'@'echange::
+* Miroirs::
+* Pierres @`a sens unique::
+* Pierres Shogun::
+* Eboulis::
+* Pi@`eces de puzzle::
+* Bo@^ites postales::
 @end menu
 
 @node Pierres mortelles, Pierres d'@'echange, Pierres, Pierres
@@ -565,97 +633,122 @@
 
 @image{images/st-lethal,,0.7cm}
 
-Il y a deux sortes de t@^etes de mort: Celle qui est repr@'esent@'ee ci-dessus, et une variante que seules les
-boules noires porteuses de lunettes peuvent voir. Au moindre contact, elles tuent les boules.
-Le chevalier noir est @'egalement mortel pour les boules d@'esarm@'ees.
-Il y a des tueurs mobiles: Les 'tops' (toupies) et les 'rotors' (croix tournantes); ils sont attir@'es
-par leur victime, laquelle a de pr@'ef@'erence une forme sph@'erique et une couleur noire @enddots{}
+Il y a deux sortes de @emph{t@^etes de mort}: Celle qui est repr@'esent@'ee ci-dessus,
+et une variante que seules les boules noires porteuses de lunettes peuvent voir.
+Au moindre contact, elles tuent les boules.
 
+Le @emph{chevalier noir} est @'egalement mortel pour les boules d@'esarm@'ees.
+Il y a des tueurs mobiles: Les 'tops' (toupies) et les 'rotors' (croix
+tournantes); ils sont attir@'es par leur victime, laquelle a de pr@'ef@'erence
+une forme sph@'erique et une couleur noire @enddots{}
+
 @node Pierres d'@'echange, Miroirs, Pierres mortelles, Pierres
 @subsection Pierres d'@'echange
 
 @image{images/st-swap,,0.7cm}
 
-En espace ext@'erieur, une pierre d'@'echange est immobile. Mais si on la pousse vers une pierre
-adjacente, elle @'echange sa position avec celle de sa voisine, elle est donc utile pour 'faire bouger'
-des pierres immobiles. Mais elle-m@^eme ne peut @^etre boug@'ee que gr@^ace @`a des pierres 'normales'.
+En espace ext@'erieur, une pierre d'@'echange est immobile. Mais si on la pousse
+vers une pierre adjacente, elle @'echange sa position avec celle de sa voisine,
+elle est donc utile pour 'faire bouger' des pierres immobiles. Mais elle-m@^eme
+ne peut @^etre boug@'ee que gr@^ace @`a un @'echange avec des pierres 'normales'.
 
 @c @node Lasers, Miroirs, Pierres d'@'echange, Pierres
 @c @subsection Lasers
 
 @c Both interesting and da
 
- at node Miroirs, Pierres magiques, Pierres d'@'echange, Pierres
+ at node Miroirs, Pierres @`a sens unique, Pierres d'@'echange, Pierres
 @subsection Miroirs
 
 @image{images/st-mirrors,,0.7cm}
 
-Les mirroirs (@`a droite sur la photo) r@'efl@'echissent les rayons laser, soit en arri@`ere s'ils sont
-perpendiculaires @`a ceux-ci, soit @`a angle droit s'ils font un angle de 45? par rapport @`a ceux-ci. Les
-prismes (@`a gauche) sont plus complexes: Chaque face agit comme un miroir, mais si le rayon tombe
-sur l'angle droit du prisme, il se divise en deux.
-Les prismes et miroirs peuvent @^etre soit semi-transparents (aux extr@'emit@'es de la photo; dans ce cas,
-le rayon est divis@'e en deux, une partie qui est r@'efl@'echie et une partie qui est transmise) soit opaques
-(au milieu de la photo). Ils peuvent @^etre soit mobiles (en les poussant fort avec la boule noire) soit
-immobiles. Mais dans les deux cas on peut les orienter en les touchant avec la boule.
-La manipulation des prismes et miroirs est dangereuse pour les boules noires si elle est men@'ee pr@`es
+Les miroirs (@`a droite sur la photo) r@'efl@'echissent les rayons laser, soit
+en arri@`ere s'ils sont perpendiculaires @`a ceux-ci, soit @`a angle droit s'ils
+font un angle de 45 degr@'es par rapport @`a ceux-ci. Les prismes (@`a gauche) sont
+plus complexes: Chaque face agit comme un miroir, mais si le rayon tombe sur
+l'angle droit du prisme, il se divise en deux. Les prismes et miroirs peuvent
+@^etre soit semi-transparents (aux extr@'emit@'es de la photo; dans ce cas, le
+rayon est divis@'e en deux, une partie qui est r@'efl@'echie et une partie qui
+est transmise) soit opaques (au milieu de la photo). Ils peuvent @^etre soit
+mobiles (en les poussant fort avec la boule noire) soit immobiles. Mais dans les
+deux cas on peut les orienter en les touchant avec la boule. La manipulation des
+prismes et miroirs est dangereuse pour les boules noires si elle est men@'ee pr@`es
 d'un laser allum@'e @enddots{}
 
- at node Pierres magiques, Pierres Shogun, Miroirs, Pierres
- at subsection Pierres magiques
+ at node Pierres @`a sens unique, Pierres Shogun, Miroirs, Pierres
+ at subsection Pierres @`a sens unique
 
+ at image{images/st-oneway,,0.7cm}
 
+On ne peut les traverser que dans un seul sens. Des labyrinthes entiers peuvent
+@^etre construits avec des pierres @`a sens unique, mais le plus souvent ils servent
+@`a vous obliger @`a finir une partie du niveau avant d'attaquer la suivante.
 
-Les pierres 'magiques' sont un reliquat d'Oxyd et n'ont aucun effet dans Enigma; elles
-apparaissent lors de l'importation d'un niveau d'Oxyd et sont cens@'ees dispar@^itre au toucher
+Une pierre @`a sens unique vous bloque vraiment? Peut-@^etre une baguette magique
+vous servira-t-elle @enddots{}
 
- at node Pierres Shogun, Pierres @'electriques, Pierres magiques, Pierres
+ at node Pierres Shogun, Eboulis, Pierres @`a sens unique, Pierres
 @subsection Pierres Shogun
 
 @image{images/st-shogun,,0.7cm}
 
-Certains niveaux ont des cercles bleus par terre; ceux-ci actionnent quelque chose (ouverture de
-porte, allumage de lasers etc.) s'ils sont recouverts par des pierres shogun. Il y a trois sortes de
-pierres shogun: La plus petite (@`a gauche sur le portrait de famille) actionne les petits cercles bleus.
-Pour les cercles de taille moyenne, il faut r@'ealiser l'empilement que l'on voit au milieu de la photo,
-en pla@,{c}ant @emph{d'abord} un shogun de taille moyenne, puis un petit shogun par-dessus. De fa@,{c}on
-g@'en@'erale, on ne peut empiler un shogun que sur shogun plus grand que lui, ou sur un sol nu.
-Pour les plus grands cercles bleus, il faut r@'ealiser l'empilement de droite en amenant d'abord un
-grand shogun, puis en le recouvrant par un shogun moyen, et enfin en recouvrant le tout par un
-petit.
+Certains niveaux ont des cercles bleus par terre; ceux-ci actionnent quelque chose
+(ouverture de porte, allumage de lasers etc.) s'ils sont recouverts par des pierres
+ at emph{shogun}. Il y a trois sortes de pierres shogun: La plus petite (@`a gauche sur le
+portrait de famille) actionne les petits cercles bleus. Pour les cercles de taille
+moyenne, il faut r@'ealiser l'empilement que l'on voit au milieu de la photo, en
+pla@,{c}ant @emph{d'abord} un shogun de taille moyenne, puis un petit shogun par-dessus.
+De fa@,{c}on g@'en@'erale, on ne peut empiler un shogun que sur shogun plus grand que
+lui, ou sur un sol nu. Pour les plus grands cercles bleus, il faut r@'ealiser
+l'empilement de droite en amenant d'abord un grand shogun, puis en le recouvrant
+par un shogun moyen, et enfin en recouvrant le tout par un petit.
 
- at node Pierres @'electriques, Pierres de puzzle, Pierres Shogun, Pierres
- at subsection Pierres @'electriques
+ at node Eboulis, Pi@`eces de puzzle, Pierres Shogun, Pierres
+ at subsection Eboulis
 
-Le contact avec une pierre charg@'ee @'electrostatiquement, charge un objet, qui porte alors une charge
-@'electrique de m@^eme signe que ladite pierre, et est alors repouss@'ee par tous les objets ayant cette
-charge, et attir@'e par les objets ayant une charge de signe contraire, du moins @`a courte distance.
-Une pierre magn@'etique attire tous les objets.
-Une pierre @`a @'elastique attache un @'elastique @`a la boule qui la touche, et tenter de s'en @'eloigner tend
-l'@'elastique, ce qui rend l'@'eloignement difficile. Le contact avec une pierre @`a ciseaux coupe
-l'@'elastique.
+ at image{images/st-bolder,,0.7cm}
 
- at node Pierres de puzzle, Pierres postales, Pierres @'electriques, Pierres
- at subsection Pierres de puzzle
+Les @'eboulis ne bougent que dans une direction, indiqu@'ee par la fl@`eche qui est
+peinte dessus. Ils ne s'arr@^etent que lorsqu'ils heurtent une autre pierre. Ils
+peuvent barrer v@^otre chemin et vous devrez trouver un moyen de vous en
+d@'ebarrasser. Mais vous, n'embarrassez pas leur chemin, ou ils vous d@'etruiraient.
 
-Les puzzles bleus peuvent @^etre assembl@'es, et lorsque l'assemblage est complet (plus de liaison libre),
-l'assemblage complet peut bouger, ce qui permet de lib@'erer un chemin, ou de construire des ponts.
-Le contact d'un assemblage de puzzles avec une baguette magique d@'etruit l'assemblage s'il est
-complet, et permute la position des puzzles sinon.
-Les puzzles orange ont le m@^eme comportement sauf qu'il n'y a pas besoin de baguette magique: Il
-suffit de toucher l'assemblage avec la boule noire.
+Mais ils peuvent aussi @^etre utiles: Ils ouvrent des oxydes quand ils les heurtent.
+Et vous pouvez les rediriger de plusieurs mani@`eres @enddots{}
 
- at node Pierres postales,  , Pierres de puzzle, Pierres
- at subsection Pierres postales
+ at node Pi@`eces de puzzle, Bo@^ites postales, Eboulis, Pierres
+ at subsection Pi@`eces de puzzle
 
+Les pi@`eces de puzzle peuvent @^etre assembl@'ees pour faire un puzzle complet. Elles
+ont des sortes de prises sur leurs c@^ot@'es pour les assembler. Une fois l'assemblage
+termin@'e, on peut le pousser d'un bloc comme des pierres uniques, ce qui permet
+par exemple de construire des ponts en pr@'efabriqu@'e au-dessus de l'eau ou de
+l'ab@^ime.
+
+Lorsqu'on les touche avec une baguette magique, leur comportement est diff@'erent:
+Si le bloc est complet, il explose imm@'ediatement. Sinon la rang@'ee ou la colonne
+de pi@`eces de puzzle dont fait partie celle qui a @'et@'e touch@'ee, est d@'ecal@'ee
+circulairement soit dans le sens horizontal soit dans le sens vertical.
+
+Il y a une variante rare des pi@`eces de puzzle, que l'on trouve surtout dans les
+niveaux de Oxyd 1, et que l'on reconna@^it @`a leur couleur orange (au lieu de bleue).
+Ces pierres sont immobiles, et leur comportement est celui que la baguette magique
+conf@`ere aux pi@`eces de puzzle bleues: Explosion si le puzzle est complet, et d@'ecalage
+circulaire d'une rang@'ee ou d'une colonne sinon.
+
+ at node Bo@^ites postales,  , Pi@`eces de puzzle, Pierres
+ at subsection Bo@^ites postales
+
 @image{images/st-mail,,0.7cm}
 
-La bo@^ite aux lettres est une pierre en g@'en@'eral prolong@'ee par un tuyau form@'e de puzzles; @`a chaque
-contact avec une bo@^ite aux lettres, la boule noire exp@'edie au bout de ce tuyau, l'outil le plus @`a gauche
-de son inventaire. Mais une fois qu'un objet autre qu'un puzzle a @'et@'e exp@'edi@'e, la poste est bloqu@'ee.
-En g@'en@'eral on doit construire le tuyau en exp@'ediant ses morceaux par la poste.
+La bo@^ite aux lettres est une pierre en g@'en@'eral prolong@'ee par un tuyau
+form@'e de puzzles; @`a chaque contact avec une bo@^ite aux lettres, la boule
+noire exp@'edie au bout de ce tuyau, l'outil le plus @`a gauche de son inventaire.
+Mais une fois qu'un objet autre qu'un puzzle a @'et@'e exp@'edi@'e, la poste est
+bloqu@'ee. En g@'en@'eral on doit construire le tuyau en exp@'ediant ses morceaux
+par la poste.
 
- at c @node Tourniquets, Eboulis, Pierres de puzzle, Pierres
+ at c @node Tourniquets, Eboulis, Pi@`eces de puzzle, Pierres
 @c @subsection Tourniquets
 
 
@@ -667,120 +760,233 @@
 @c @node Elastiques et ciseaux,  , Eboulis, Pierres
 @c @subsection Elastiques et ciseaux
 
- at node Triche, Cr@'edits, Objets du jeu, Haut
+ at node Expertise, Triche, Quelques objets du jeu, Haut
+ at chapter Expertise
+
+ at menu
+* Paquets utilisateur::            Historique, r@'esultats recherche et Auto
+* Sauvegardes::                      Que sauvegarder pour la s@'ecurit@'e
+* Homologuer les scores::          Que le monde sache comme vous r@'eussissez
+* Mise @`a jour::             Mettre @`a jour les scores et les niveaux
+ at end menu
+
+ at node Paquets utilisateur, Sauvegardes, Expertise, Expertise
+ at section Paquets utilisateur
+
+ at ref{Le menu des paquets de niveaux} en dit plus sur le sujet. Le groupe
+ at samp{User} contient trois paquets de niveaux, initialement vides:
+ at samp{Auto Folder}, @samp{History} and @samp{Search Result}.
+
+En cliquant sur le bouton @samp{Search} dans le menu des paquets de niveaux,
+vous pouvez effectuer une recherche dans l'ensemble des niveaux. Pour cela, placez
+la souris au-dessus de la zone de texte, puis entrez la cha@^ine de caract@`eres @`a
+chercher. Vous pouvez effectuer une recherche par auteur, par titre ou par nom de
+fichier. La cha@^ine peut @^etre entr@'ee en minuscules sans changer le r@'esultat. Par
+exemple, vous pouvez entrer ``jump''. Le r@'esultat de la recherche est fourni sous
+la forme d'un paquet de niveaux appel@'e ``Search Results''.
+
+Le paquet de niveaux @samp{History} est automatiquement mis @`a jour chaque fois
+que vous jouez un niveau. Cela peut @^etre utile si vous cherchez un niveau auquel
+vous jouates la semaine derni@`ere sans savoir quels mots-cl@'es entrer pour le
+rechercher.
+
+ at samp{Auto Folder} est un paquet de niveaux dont vous pouvez vous servir pour
+ajouter de nouveaux niveaux, par exemple que vous avez t@'el@'echarg@'es, ou cr@'e@'es
+vous-m@^eme. Ces niveaux devraient @^etre plac@'es dans @samp{levels/auto} ou dans
+ at samp{User Path} comme indiqu@'e dans @ref{Options de jeu}. Les niveaux qui sont
+dans ce dossier sont automatiquement charg@'es au d@'emarrage d'Enigma.
+
+Bien d'autres aspects utiles d'Enigma d@'epassent le cadre de ce manuel. Consultez
+le manuel de r@'ef@'erence pour plus de d@'etails.
+
+ at node Sauvegardes, Homologuer les scores, Paquets utilisateur, Expertise
+ at section Sauvegardes
+
+Si vous craignez qu'une d@'efaillance de v@^otre disque dur vous fasse perdre tous
+vos scores, ou si vous voulez transf@'erer ceux-ci vers un autre ordinateur, voici
+quelques informations sur l'@'etat d'Enigma. Premi@`erement, jetez un oeil sur
+ at samp{User Path} dans le menu @ref{Options de jeu} .  Vous pouvez vous contenter
+de sauvegarder tout le dossier -- les fichiers importants @'etant @samp{enigma.score}
+et @samp{state.xml}.
+
+ at node Homologuer les scores, Mise @`a jour, Sauvegardes, Expertise
+ at section Homologuer les scores
+
+Si vous voulez homologuer vos scores, vous devez envoyer le fichier @samp{enigma.score}
+situ@'e dans le dossier @samp{User Path}. La page d'accueil vous donnera les d@'etails
+sur la mani@`ere de proc@'eder.
+
+Pour la mise @`a jour automatique des records du monde, il suffit d'activer
+l'option @samp{Ratings Update}.
+
+ at node Mise @`a jour, , Homologuer les scores, Expertise
+ at section Mise @`a jour
+
+Si vous n'avez pas personnalis@'e v@^otre ancienne version d'Enigma, il vous suffit
+de la d@'esinstaller avant d'installer la nouvelle version. Ainsi vos scores seront
+automatiquement mis @`a jour.
+
+Mais si vous avez ajout@'e des niveaux @`a v@^otre ancienne version d'Enigma, vous
+devrez les sauvegarder avant la d@'esinstallation. Ensuite vous pouvez tranquillement
+d@'esinstaller avant d'installer la nouvelle version.
+
+ at c TODO: too technical (HOMEless, environment variable)@item
+ at c TODO: split in two sentences
+L'ancien fichier @samp{~/.enigmarc2} pour les syst@`emes qui ont un environnement
+ at samp{HOME} ou @samp{.../Application Data/enigmarc.lua2} pour les
+Windows sans HOME (@emph{des fen@^etres sans maison? Comment cela se peut-il?})
+est automatiquement converti au nouveau format de fichier. Vous pouvez supprimer
+l'ancien fichier d@`es que vous avez r@'eussi ne serait-ce qu'un seul niveau de Enigma 1.00.
+
+Pour utiliser des niveaux que vous avez r@'ecup@'er@'es de l'ancienne version d'Enigma,
+consultez le manuel de r@'ef@'erence.
+
+ at node Triche, Cr@'edits, Expertise, Haut
 @chapter Triche
 
 Ce chapitre contient des indices pour certains des niveaux les plus difficiles.
 On vous conseille vraiment de ne @emph{pas} lire les indices tant que vous n'@^etes pas
-compl@`etement bloqu@'es.  Certains niveaux sont vraiment
-difficiles (m@^eme les champions d'Enigma ne peuvent les r@'esoudre en moins de quelques heures).
-Certains niveaux sont plus faciles en mode 'facile' (voir section 2.1.2)
+compl@`etement bloqu@'es.  Certains niveaux sont vraiment difficiles (m@^eme les
+champions d'Enigma ne peuvent les r@'esoudre en moins de quelques heures).
+Certains niveaux sont plus faciles en mode 'facile' (@ref{Le menu des niveaux}).
 
 @menu
-* Tutoriel::                    Promenade dans 'advanced tutorial'
+* Tutoriel::                    Promenade dans `Advanced tutorial'
 * Indices::                       Indices pour plusieurs niveaux
 @end menu
 
 @node Tutoriel, Indices, Triche, Triche
- at section Promenade dans Advanced Tutorial
+ at section Promenade dans `Advanced tutorial'
 
-Cette section a @'et@'e @'ecrite par Jakob Scott, le cr@'eateur des niveaux 'tutorial'. Les niveaux du
-chapitre 'tutorial' sont cens@'es @^etre faciles, @`a l'exception du dernier d'entre eux ('advanced
-tutorial'), auquel les paragraphes suivants sont consacr@'es. Premier conseil: Lire tous les documents
-de chaque chambre d@`es qu'on y entre.
-Le but de ce jeu est donc de trouver, et toucher, toutes les oxydes du niveau, lequel est divis@'e en une
-vingtaine de chambres, regroup@'ees en trois zones: La zone 1 est compos@'ee de chambres o@`u on
-montre les @'el@'ements de base et certains sols de Enigma. La zone 2 est plus aggressive, avec
-l'@'elaboration de strat@'egies parfois destin@'ees @`a @'echapper @`a des ennemis. La zone 3 montre des
-interactions plus complexes entre objets Enigma. Dans ce niveau, les oxydes sont regroup@'ees dans
+Cette section a @'et@'e @'ecrite par Jakob Scott, le cr@'eateur des niveaux 'tutorial'.
+Les niveaux du chapitre 'tutorial' sont cens@'es @^etre faciles, @`a l'exception du
+dernier d'entre eux ('advanced tutorial'), auquel les paragraphes suivants sont
+consacr@'es. Premier conseil: Lire tous les documents de chaque chambre d@`es qu'on
+y entre. Le but de ce jeu est donc de trouver, et toucher, toutes les oxydes du niveau,
+lequel est divis@'e en une vingtaine de chambres, regroup@'ees en trois zones: La zone 1
+est compos@'ee de chambres o@`u on montre les @'el@'ements de base et certains sols de
+Enigma. La zone 2 est plus agressive, avec l'@'elaboration de strat@'egies parfois
+destin@'ees @`a @'echapper @`a des ennemis. La zone 3 montre des interactions plus
+complexes entre objets Enigma. Dans ce niveau, les oxydes sont regroup@'ees dans
 la chambre @`a laquelle on acc@`ede @`a la fin de la zone 3.
 
 @subsection Zone 1
 
-Au d@'epart, on est dans une chambre ferm@'ee par une porte en haut, contenant un peu d'eau en bas @`a
-gauche, et un trou dans le mur droit.
+Au d@'epart, on est dans une chambre ferm@'ee par une porte en haut, contenant un peu
+d'eau en bas @`a gauche, et un trou dans le mur droit.
+
 Chambre 1: Traverser ce trou pour aller dans la chambre 2.
+
 Chambre 2: Il suffit d'@'eviter les t@^etes de mort pour traverser cette chambre.
-Chambre 3: Fabriquer un pont au-dessus de l'eau avec les morceaux de bois; frapper les pierres
-noires @`a droite; @'ecarter les pierres mordor@'ees du chemin (par exemple en les poussant vers la
-gauche), puis faire un pont vers la droite avec les deux morceaux de bois.
-Chambre 4: Aller vers la toupie; quand elle entre en chasse, la mener vers la gauche jusqu'@`a avoir
-les pierres centrales entre elle (@`a gauche) et la boule noire; entrer dans la chambre suivante.
-Chambre 5: Le seul danger sont les t@^etes de mort du bas: Cette chambre montre certains sols: Dans
-l'ordre, le m@'etal a des propri@'et@'es analogues au sol verdoyant vu juqu'ici, le sol rouge frotte plus, la
-glace frotte moins et l'espace sid@'eral ne frotte pas du tout, au point qu'il est impossible de changer
-de direction quand on le traverse.
-Chambre 6: La pente ne pose aucun probl@`eme; aller vers la gauche en utilisant le sol invers@'e (quand
-on essaye d'aller vers la gauche, on va vers la droite etc.); au besoin, retourner le mulot peut aider.
-Chambre 7: Commencer par gagner une vie suppl@'ementaire en posant la pierre mobile sur la trappe
-du bas; la pousser d'abord un carreau vers le haut puis six carreaux vers la gauche; ensuite la pousser 5
-carreaux plus bas et 2 carreaux vers la droite; ramasser une autre vie suppl@'ementaire puis actionner
-l'autre trappe en y posant la pierre mobile, ce qui ouvre la porte @`a gauche vers la chambre suivante.
-Chambre 8: Prendre la dynamite et l'allumer devant les pierres jaunes, ce qui lib@`ere le passage; la
-b@^eche n'est pas n@'ecessaire mais on peut exp@'erimenter avec.
-Chambre 9: Pousser la pierre mobile la plus basse vers la gauche; les @'eboulis allant vers la droite
-bloquent le chemin; en d@'epla@,{c}ant la pierre mobile la plus @`a droite, on laisse l'@'eboulis se produire;
-ramasser la baguette magique en faisant attention @`a ne pas encore actionner un @'eboulis avec, puis
-pousser la pierre qui est au-dessus de l'eau. Ensuite placer la baguette magique en t@^ete de
-l'inventaire pour qu'elle soit active, et s'en servir sur les trois @'eboulis du haut, en faisant attention @`a
-ne pas se faire ensevelir; pousser la pierre de gauche pour entrer dans la chambre suivante.
-Chambre 10: Actionner l'interrupteur; pousser les deux pierres mordor@'ees dans l'eau; aller vers la gauche;
-pousser vers la gauche le bloc de bois du milieu, puis celui qui @'etait juste au-dessus de lui, dans l'eau;
-pousser les autres morceaux de bois dans l'eau en une ligne pour fabriquer un pont; d@'efoncer la
-fen@^etre @`a grande vitesse (attention aux d@'ebris de verre); r@'ecup@'erer une vie suppl@'ementaire et
-traverser le pont de bois jusqu'@`a la premi@`ere chambre; passer par la porte d@'esormais ouverte.
 
+Chambre 3: Fabriquer un pont au-dessus de l'eau avec les morceaux de bois; frapper
+les pierres noires @`a droite; @'ecarter les pierres mordor@'ees du chemin (par
+exemple en les poussant vers la gauche), puis faire un pont vers la droite avec
+deux morceaux de bois.
+
+Chambre 4: Aller vers la toupie; quand elle entre en chasse,
+la mener vers la gauche jusqu'@`a avoir les pierres centrales entre elle (@`a gauche)
+et la boule noire; entrer dans la chambre suivante.
+
+Chambre 5: Le seul danger sont  les t@^etes de mort du bas: Cette chambre montre
+certains sols: Dans l'ordre, le  m@'etal a des propri@'et@'es analogues au sol verdoyant
+vu juqu'ici, le sol rouge frotte plus, la glace frotte moins et l'espace sid@'eral ne
+frotte pas du tout, au point qu'il est impossible de changer de direction quand on
+le traverse.
+
+Chambre 6: La pente ne pose aucun probl@`eme; aller vers la gauche en utilisant le
+sol invers@'e (quand on essaye d'aller vers la gauche, on va vers la droite etc.);
+au besoin, retourner le mulot peut aider.
+
+Chambre 7: Commencer par gagner une vie  suppl@'ementaire en posant la pierre mobile sur
+la trappe du bas; la pousser d'abord  un carreau vers le haut puis six carreaux vers la
+gauche; ensuite la pousser 5 carreaux  plus bas et 2 carreaux vers la droite; ramasser
+une autre vie suppl@'ementaire puis actionner l'autre trappe en y posant la pierre mobile,
+ce qui ouvre la porte @`a gauche vers la chambre suivante.
+
+Chambre 8: Prendre la dynamite et l'allumer devant les pierres jaunes, ce qui lib@`ere le
+passage; la b@^eche n'est pas n@'ecessaire mais on peut exp@'erimenter avec.
+
+Chambre 9: Pousser la pierre mobile la plus basse vers la gauche; les @'eboulis allant
+vers la droite bloquent le chemin; en d@'epla@,{c}ant la pierre mobile la plus @`a droite,
+on laisse l'@'eboulis se produire; ramasser la baguette magique en faisant attention
+@`a ne pas encore actionner un @'eboulis avec, puis pousser la pierre qui est au-dessus
+de l'eau. Ensuite placer la baguette magique en t@^ete de l'inventaire pour qu'elle soit
+active, et s'en servir sur les trois @'eboulis du haut, en faisant attention @`a
+ne pas se faire ensevelir; pousser la pierre de gauche pour entrer dans la chambre
+suivante.
+
+Chambre 10: Actionner l'interrupteur; pousser les deux pierres mordor@'ees dans l'eau;
+aller vers la gauche; pousser vers la gauche le bloc de bois du milieu, puis celui qui
+@'etait juste au-dessus de lui, dans l'eau; pousser les autres morceaux de bois dans l'eau
+en une ligne pour fabriquer un pont; d@'efoncer la fen@^etre @`a grande vitesse (attention
+aux d@'ebris de verre); r@'ecup@'erer une vie suppl@'ementaire et traverser le pont de
+bois jusqu'@`a la premi@`ere chambre; passer par la porte d@'esormais ouverte.
+
 @subsection Zone 2
 
-Dans la zone 2 on rencontre des rotors, qui ne sont pas tr@`es amicaux avec la boule noire; il s'agit de
-les amener @`a faire ce qu'on veut leur faire faire tout en s'en pr@'eservant. Jeter un coup d'oeil (sans
-bouger pour l'instant la pierre mobile); il s'agit de traverser les trois portes en haut.
-Porte 1: Frapper la boule blanche sur la gauche pour lib@'erer celle-ci (attention @`a ne pas traverser le
-sens unique noir); ramasser la cuill@`ere puis pousser la boule blanche au travers du sens unique
-blanc, suffisamment fort pour qu'elle ne reste pas bloqu@'ee en chemin; maintenant traverser le sens
-unique noir et pousser la boule blanche au travers du corridor; la pousser au travers du sens unique
-blanc, suffisamment fort pour qu'elle ne reste pas dans le sens interdit. Une fois que la boule
-blanche a travers@'e, utiliser la cuill@`ere: On est de retour au d@'ebut du niveau, et plus enferm@'e;
-traverser la porte: La premi@`ere des portes du haut est d@'esormais ouverte.
-Porte 2: Pousser la pierre mobile qui se trouve @`a droite de la chambre vers la droite, et courir;
-un document comportant des informations int@'eressantes devrait @^etre apparu dans la porte qui s@'epare
-les zones 1 et 2; amener le rotor (par la m@^eme technique que pour la toupie) au-dessus du mur qui
-est @`a droite de la porte; retraverser la porte, puis le pont vers la chambre du bas; actionner
-l'interrupteur pour refermer la porte, puis retourner dans la chambre du d@'epart. Longer le mur du
-haut de droite @`a gauche pour amener le rotor @`a gauche, puis longer le mur de gauche vers le bas pour
-faire descendre le rotor le long du mur gauche, jusqu'@`a ce qu'on ne l'entende plus bouger. Il devrait
-avoir actionn@'e une trappe; actionner l'interrupteur pour rouvrir la porte et retourner dans la zone 2:
-La porte du milieu devrait @^etre ouverte.
-Porte 3: Pousser la pierre mobile qui a servi d'antre au rotor sur la trappe qui se trouve dans la
-chambre de d@'epart du rotor; retourner dans la chambre de gauche: La troisi@`eme porte est ouverte.
-Traverser les trois portes.
+Dans la zone 2 on rencontre des rotors, qui ne sont pas tr@`es amicaux avec la boule noire;
+il s'agit de les amener @`a faire ce qu'on veut leur faire faire tout en s'en pr@'eservant.
+Jeter un coup d'oeil (sans bouger pour l'instant la pierre mobile); il s'agit de traverser
+les trois portes en haut.
 
+Porte 1: Frapper la boule blanche sur la gauche pour lib@'erer celle-ci (attention @`a ne
+pas traverser le sens unique noir); ramasser la cuill@`ere puis pousser la boule blanche
+au travers du sens unique blanc, suffisamment fort pour qu'elle ne reste pas bloqu@'ee en
+chemin; maintenant traverser le sens unique noir et pousser la boule blanche au travers
+du corridor; la pousser au travers du sens unique blanc, suffisamment fort pour qu'elle ne
+reste pas dans le sens interdit. Une fois que la boule blanche a travers@'e, utiliser la
+cuill@`ere: On est de retour au d@'ebut du niveau, et plus enferm@'e; traverser la porte:
+La premi@`ere des portes du haut est d@'esormais ouverte.
+
+Porte 2: Pousser la pierre mobile qui se trouve @`a droite de la chambre vers la droite,
+et courir; un document comportant des informations int@'eressantes devrait @^etre apparu
+dans la porte qui s@'epare les zones 1 et 2; amener le rotor (par la m@^eme technique que
+pour la toupie) au-dessus du mur qui est @`a droite de la porte; retraverser la porte,
+puis le pont vers la chambre du bas; actionner l'interrupteur pour refermer la porte,
+puis retourner dans la chambre du d@'epart. Longer le mur du haut de droite @`a gauche
+pour amener le rotor @`a gauche, puis longer le mur de gauche vers le bas pour faire
+descendre le rotor le long du mur gauche, jusqu'@`a ce qu'on ne l'entende plus bouger.
+Il devrait avoir actionn@'e une trappe; actionner l'interrupteur pour rouvrir la porte et
+retourner dans la zone 2: La porte du milieu devrait @^etre ouverte.
+
+Porte 3: Pousser la pierre mobile qui a servi d'antre au rotor sur la trappe qui se trouve
+dans la chambre de d@'epart du rotor; retourner dans la chambre de gauche: La troisi@`eme
+porte est ouverte. Traverser les trois portes.
+
 @subsection Zone 3
 
-Chambre 1: Il faut que le rayon du laser atteigne la pierre noire: Pousser le miroir qui est en bas @`a
-gauche, d'un carreau vers le bas et le toucher doucement jusqu'@`a ce qu'il soit orient@'e comme ceci:
-'\'; pousser le miroir qui est en haut @`a gauche de 8 carreaux vers la gauche et un carreau vers le
-bas, puis l'orienter comme ceci: '/'; pousser le miroir qui est en haut @`a droite de 2 carreaux vers le
-haut et 3 carreaux vers la droite, puis l'orienter ainsi: '/'. Actionner l'interrupteur pour allumer le
-laser, tout en @'evitant son rayon; quand le pont sur la droite est construit, le traverser vers la droite.
-Chambre 2: Ramasser quelques pi@`eces; retourner dans la chambre pr@'ec@'edente; en @'eteignant, puis
-rallumant, le laser, irradier avec son rayon, une des pi@`eces de monnaie: Elle se se transforme en
-parapluie; ramasser ce parapluie apr@`es avoir @'eteint le laser, puis recommencer avec une autre pi@`ece
-pour obtenir un autre parapluie. Poser une pi@`ece @`a c@^ot@'e d'un des miroirs puis pousser ce miroir pour
-@'ecraser la pi@`ece; reprendre la pi@`ece et l'irradier avec le rayon du laser pour la transformer en un
-marteau. Irradier le marteau avec le laser (en l'@'eteignant puis le rallumant) pour obtenir une @'ep@'ee;
-ramasser l'@'ep@'ee. (Au besoin, en @'ecrasant d'autres pi@`eces 2 fois avec les miroirs, puis en @'eclairant les
-pi@`eces d'or obtenues avec le laser, on peut obtenir des vies suppl@'ementaires). Remettre les miroirs
-dans leur position initiale, puis rallumer le laser, pour pouvoir retourner dans la chambre avec les
-chevaliers; y aller. Mettre l'@'ep@'ee en t@^ete d'inventaire puis toucher 4 fois chaque chevalier. On peut
+Chambre 1: Il faut que le rayon du laser atteigne la pierre noire: Pousser le miroir qui
+est en bas @`a gauche, d'un carreau vers le bas et le toucher doucement jusqu'@`a ce qu'il
+soit orient@'e comme ceci: '\'; pousser le miroir qui est en haut @`a gauche de 8 carreaux
+vers la gauche et un carreau vers le bas, puis l'orienter comme ceci: '/'; pousser le
+miroir qui est en haut @`a droite de 2 carreaux vers le haut et 3 carreaux vers la droite,
+puis l'orienter ainsi: '/'. Actionner l'interrupteur pour allumer le laser, tout en
+@'evitant son rayon; quand le pont sur la droite est construit, le traverser vers la
+droite.
+
+Chambre 2: Ramasser quelques pi@`eces; retourner dans la chambre pr@'ec@'edente; en
+@'eteignant, puis rallumant, le laser, irradier avec son rayon, une des pi@`eces de
+monnaie: Elle se se transforme en parapluie; ramasser ce parapluie apr@`es avoir @'eteint
+le laser, puis recommencer avec une autre pi@`ece pour obtenir un autre parapluie. Poser
+une pi@`ece @`a c@^ot@'e d'un des miroirs puis pousser ce miroir pour @'ecraser la pi@`ece;
+reprendre la pi@`ece et l'irradier avec le rayon du laser pour la transformer en un
+marteau. Irradier le marteau avec le laser (en l'@'eteignant puis le rallumant) pour
+obtenir une @'ep@'ee; ramasser l'@'ep@'ee. (Au besoin, en @'ecrasant d'autres pi@`eces 2
+fois avec les miroirs, puis en @'eclairant les pi@`eces d'or obtenues avec le laser, on
+peut obtenir des vies suppl@'ementaires). Remettre les miroirs dans leur position initiale,
+puis rallumer le laser, pour pouvoir retourner dans la chambre avec les chevaliers; y aller.
+Mettre l'@'ep@'ee en t@^ete d'inventaire puis toucher 4 fois chaque chevalier. On peut
 passer.
-Chambre 3: Actionner un parapluie pour traverser l'ab@^ime des chambres en bas puis @`a droite; si le
-halo clignote, actionner l'autre parapluie.
-Chambre 4: Toucher les oxydes dans l'ordre pour les activer, tout en @'evitant les pierres p@'eteuses,
-dont l'odeur pestilentielle referme toutes les oxydes.
 
+Chambre 3: Actionner un parapluie pour traverser l'ab@^ime des chambres en bas puis @`a
+droite; si le halo clignote, actionner l'autre parapluie.
 
- at node Indices, , Tutoriel, Triche
+Chambre 4: Toucher les oxydes dans l'ordre pour les activer, tout en @'evitant les
+pierres p@'eteuses, dont l'odeur pestilentielle referme toutes les oxydes.
+
+
+ at node Indices,  , Tutoriel, Triche
 @section Indices pour plusieurs niveaux
 
 @table @strong
@@ -793,7 +999,7 @@
 deuxi@`eme shogun @emph{au-dessus} du cercle bleu de droite
 
 @item I/31: Where Am I?
-Si le petit Poucet n'avait pas de pain, il ramasserait des morceaux de bois. 
+Si le petit Poucet n'avait pas de pain, il ramasserait des morceaux de bois.
 
 @item I/32: The Grim Reaper
 C'est une histoire sans queue ni t@^ete: Quelle est la t@^ete d'une souris apr@`es un t@^ete-@`a-queue?
@@ -808,7 +1014,7 @@
 L'un des cercles bleus se comporte diff@'eremment.
 
 @item I/80: Meditation
-Alignez les boules blanches horizontallement. 
+Alignez les boules blanches horizontalement.
 
 @item II/15: Knock Knock
 Ce niveau est @`a se taper la t@^ete dans le mur.
@@ -827,7 +1033,7 @@
 Une astuce pour ce niveau se trouve dans ``Running Rings''.
 
 @item II/57: Floppy Swapping
-Commencer par chercher la disquette et la baguette magique (ils sont n@'ecessaires); 2)
+1) Commencer par chercher la disquette et la baguette magique (ils sont n@'ecessaires); 2)
 Toujours les garder avec soi; 3) Certaines pierres se ressemblent comme les deux P@^oles
 mais sont comme Pierre et Paul.
 
@@ -852,16 +1058,13 @@
 @item II/100: Patterns
 Y a-t-il de l'@'echo?
 
- at item III/9: What's the Problem?
-Des leurres partout partout; c'est un niveau de m@'editation.
-
 @item III/14: Use the PIN
 Utilisez le code PIN, ou votre encyclop@'edie si vous n'arrivez pas @`a retenir le num@'ero.
 
 @item III/16: Control Panel
 Le document de la chambre de gauche vous montre comment arranger les pierres sur les
 premi@`eres rang@'ees de trappes; @`a partir de l@`a, utilisez le code de couleurs de la chambre
-de gauche. 
+de gauche.
 
 @item III/22: Portable Laser
 Ne laissez pas le laser vous @emph{griller}!
@@ -878,13 +1081,13 @@
 Un @'echange vers le haut-- Un @'echange vers le bas-- Un puzzle vers la droite-- et on continue!
 
 @item III/40: Snow White
-Trois petits eskimos -- Perdus sur la banquise-- 
+Trois petits eskimos -- Perdus sur la banquise--
 Ne trouvaient plus leurs igloos -- Enneig@'es par la bise.
 
 @item III/43: The Ditch
 Pour r@'esoudre ce niveau, il vous faut briser une vie.
 
- at item III/95: Jump et Run
+ at item III/95: Jump and Run
 Un ressort est cach@'e sous un miroir.
 
 @item IV/6: TNT Shortage?
@@ -898,7 +1101,7 @@
 Encombrez les lasers si vous n'@^etes pas assez rapides.
 
 @item IV/27: Robbery
-Entrez dans la banque en passant par un sol fragile. 
+Entrez dans la banque en passant par un sol fragile.
 
 @item IV/34: Running Rings
 Une astuce pour ce niveau se trouve dans ``Pharao's Tomb''.
@@ -945,18 +1148,18 @@
 @item V/78: Don't Be Greedy
 Une aide figure quelque part ailleurs dans ce manuel.
 
- at item V/89: Ice-bombe
+ at item V/89: Ice-bomb
 Une aide figure quelque part sous l'oxyde.
 
 @item V/91: Firefox
 Le sol br@^ule plus vite.
 
- at item V/96: Prepare Your Defense
+ at item VI/8: Orbitting
+Ne laissez rien toucher les bords.
+
+ at item VI/23: Prepare Your Defense
 Le laser ne transforme pas que les outils.
 
- at item VI/7: Orbitting
-Ne laissez rien toucher les bords.
-
 @item esprit 43
 Faites un sacrifice au volcan.
 
@@ -979,129 +1182,208 @@
 @chapter Cr@'edits
 
 @menu
-* D@'eveloppeurs principaux::             
-* Special Thanks::              
-* Contributeurs::                
-* Logiciels utilis@'es::           
+* D@'eveloppeurs principaux::
+* Remerciements sp@'eciaux::
+* Contributeurs::
+* Logiciels utilis@'es::
 @end menu
 
 
- at node D@'eveloppeurs principaux, Special Thanks, Cr@'edits, Cr@'edits
+ at node D@'eveloppeurs principaux, Remerciements sp@'eciaux, Cr@'edits, Cr@'edits
 @section D@'eveloppeurs principaux
 
 @table @strong
 
+ at item Raoul Bourquin
+Administration et conception de niveaux, plus d'autres choses inestimables
+
 @item Siegfried Fennig
-Concepteur de niveaux, graphismes
+Conception de niveaux, graphismes
 
 @item Martin Hawlisch
-Concepteur de niveaux, graphismes, programmation
+Conception de niveaux, graphismes, programmation
 
 @item Daniel Heck
-D@'eveloppeur principal, graphismes, documentation
+Principal d@'eveloppeur, graphismes, documentation
 
+ at item Ronald Lamprecht
+XML, interface graphique, portabilit@'e, programmation du noyau, documentation
+
+ at item Andreas Lochmann
+Programmation, administration des niveaux, conception de niveaux, documentation
+
 @item Petr Machata
-Concepteur de niveaux, programmation
+Conception de niveaux, programmation
 
 @item Nat Pryce
-Concepteur de niveaux
+Conception de niveaux
 
 @item Jacob Scott
-Concepteur de niveaux
+Conception de niveaux
 
 @item Sven Siggelkow
-Concepteur de niveaux et connaissances pointues en Oxyd
+Conception de niveaux et expertise en Oxyd
 
 @item Ralf Westram
-Concepteur de niveaux, programmation
+Programmation, conception de niveaux
 @end table
 
 
- at node Special Thanks, Contributeurs, D@'eveloppeurs principaux, Cr@'edits
- at section Special Thanks
+ at node Remerciements sp@'eciaux, Contributeurs, D@'eveloppeurs principaux, Cr@'edits
+ at section Remerciements sp@'eciaux
 
 @table @strong
 @item Johannes Fortmann
-Portage sur Macintosh, un peu de programation, graphisme
+Portage Mac OS X , un peu de programmation, graphismes
 
 @item Dustin Norlander
-Concepteur de la police ?Dustismo?
+Auteur de la police ``Dustismo''
 
 @item Jeremy Sawicki
-Ing@'eni@'erie inverse sur le format des fichiers Oxyd, biblioth@`eque oxylib
+Ing@'eni@'erie inverse sur le format de fichier d'Oxyd, Oxydlib
 
 @item Erich Schubert
-Paquetages Debian
+paquets Debian/Ubuntu
 
 @item Meinolf Schneider
-L'id@'ee originale du jeu: @emph{Merci Monsieur Schneider !}
+Id@'ee initiale du jeu -- at emph{Merci}!
 
 @item Andrew ``Necros'' Sega
-Musique du menu (Pentagonal Dreams)
+Musique du menu (@emph{Pentagonal Dreams})
 
+ at c waiting for licence to add the sounds
+ at c @item ``Cellar of Rats''
+ at c Sound effects
 
 @item David W. Skinner
-Beaucoup des niveaux Sokoban; voir @uref{http://users.bentonrea.com/~sasquatch/sokoban}
+Beaucoup de niveau Sokoban, de
+ at uref{http://users.bentonrea.com/~sasquatch/sokoban}
 
+
 @end table
 
- at node Contributeurs, Logiciels utilis@'es, Special Thanks, Cr@'edits
+ at node Contributeurs, Logiciels utilis@'es, Remerciements sp@'eciaux, Cr@'edits
 @section Contributeurs
 
-Pour des contributions plus l@'eg@`eres et vari@'ees, citons p@^ele-m@^ele:
+Pour diverses contributions, merci @`a:
 
 @itemize @bullet
 
 @item
-Samuel El?as Mart?nez ?lvarez (traduction espagnole)
+Roberto Bardin (conception de niveaux)
 
- at item 
-Stephanie Fabian (d@'enonciation estimable de bogues)
+ at item
+Alain Busser (conception de niveaux, traduction fran@,{c}aise, la pr@'esente version du manuel)
+(@emph{autor@'ef@'erence quand tu nous tiens}!)
 
- at item 
-Edwin Groothuis (portage sous FreeBSD)
+ at item
+Guy Busser (conception de niveaux)
 
 @item
+Richi B@"utzer (conception de niveaux)
+
+ at item
+capkoh (conception de niveaux)
+
+ at item
+Serge Dremuk (traduction russe)
+
+ at item
+Xerxes M. Dynatos (conception de niveaux)
+
+ at item
+Edward (conception de niveaux)
+
+ at item
+Stephanie Fabian (d@'etection inestimable de bogues)
+
+ at item
+Roberto Garc@'ia (traduction espagnole)
+
+ at item
+Edwin Groothuis (portage FreeBSD)
+
+ at item
 Immanuel Herrmann (conception de niveaux)
 
 @item
-Samuele Kaplun (traduction en Italien)
+illmind (conception de niveaux)
 
 @item
-Manuel K?nig (conception de niveaux, d@'enonciation de bogues)
+M@'at@'e Lehel Juh@'asz (traduction hongroise)
 
 @item
+Samuele Kaplun (traduction italienne)
+
+ at item
 Jens-Christian Korth (conception de niveaux)
 
 @item
-Edward Leuf (d@'enonciation de bogues)
+Manuel K@"onig (conception de niveaux, d@'etection de bogues)
 
 @item
-Ingo van Lil (d@'enonciation de bogues)
+Markus Laire (conception de niveaux)
 
 @item
-Frank van der Loo (traduction hollandaise)
+Dominik Lehmann (conception de niveaux)
 
- at item 
-Achim Settelmeier (fichier de sp@'ecification RPM)
+ at item
+Edward Leuf (Feedback, d@'etection de bogues)
 
- at item 
-Jon Sneyers (conception de niveaux)
+ at item
+Ingo van Lil (Feedback, d@'etection de bogues)
 
 @item
+Frank van der Loo (traduction n@'eerlandaise)
+
+ at item
+Sidney Markowitz (portage Mac OS X )
+
+ at item
+moonpearl (conception de niveaux)
+
+ at item
+Krishnamurti Lelis Lima Vieira Nunes (traduction portugaise)
+
+ at item
+Daniel Nylander (traduction su@'edoise)
+
+ at item
 Peter Santo (conception de niveaux)
 
- at item 
+ at item
+Lukas Sch@"uller (conception de niveaux)
+
+ at item
+Achim Settelmeier (sp@'ecification RPM)
+
+ at item
+Jon Sneyers (conception de niveaux)
+
+ at item
+Spaceman (conception de niveaux)
+
+ at item
+Ulf Stegemann (conception de niveaux)
+
+ at item
+J@"urgen Sticht (conception de niveaux)
+
+ at item
 Andrzej Szombierski (conception de niveaux)
 
 @item
+Tacvek (mise @`a niveau Lua 5.1)
+
+ at item
 Michael Terry (fichier .desktop)
 
 @item
 Ray Wick (conception de niveaux)
 
 @item
-Joe Wreschnig (page Manuel)
+Joe Wreschnig (page Manual)
+
 @end itemize
 
 @node Logiciels utilis@'es,  , Contributeurs, Cr@'edits
@@ -1109,7 +1391,7 @@
 
 @table @strong
 
- at item SDL 
+ at item SDL
 @uref{http://www.libsdl.org/}
 
 @item SDL_image
@@ -1124,12 +1406,15 @@
 @item Oxydlib
 @uref{http://www.sawicki.us/oxyd}
 
- at item tolua
- at uref{http://www.tecgraf.puc-rio.br/~celes/tolua}
+ at item toLua++
+ at uref{http://www.codenix.com/~tolua}
 
 @item zipios
 @uref{http://zipios.sourceforge.net}
 
+ at item Xerces C++
+ at uref{http://xml.apache.org/xerces-c}
+
 @end table
 
 @bye



From ral at mail.berlios.de  Fri Jan 12 22:59:44 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Fri, 12 Jan 2007 22:59:44 +0100
Subject: [Enigma-game-svn] r573 - in trunk: lib-src/enigma-core src
Message-ID: <200701122159.l0CLxiFA029786@sheep.berlios.de>

Author: ral
Date: 2007-01-12 22:59:43 +0100 (Fri, 12 Jan 2007)
New Revision: 573

Modified:
   trunk/lib-src/enigma-core/ecl_util.hh
   trunk/src/actors.cc
   trunk/src/d_engine.hh
   trunk/src/display.cc
Log:
- fix r550 hide actors without necessarity of movement
- minor code optimizations


Modified: trunk/lib-src/enigma-core/ecl_util.hh
===================================================================
--- trunk/lib-src/enigma-core/ecl_util.hh	2007-01-11 19:12:30 UTC (rev 572)
+++ trunk/lib-src/enigma-core/ecl_util.hh	2007-01-12 21:59:43 UTC (rev 573)
@@ -37,8 +37,8 @@
 ** constructor or assignment operator.
 */
     class Nocopy {
-        Nocopy(const Nocopy&);
-        Nocopy& operator=(const Nocopy&);
+        Nocopy(const Nocopy&);            // not implemented to cause compiler error message on usage!
+        Nocopy& operator=(const Nocopy&); // not implemented to cause compiler error message on usage!
     public:
         Nocopy() {}
     };

Modified: trunk/src/actors.cc
===================================================================
--- trunk/src/actors.cc	2007-01-11 19:12:30 UTC (rev 572)
+++ trunk/src/actors.cc	2007-01-12 21:59:43 UTC (rev 573)
@@ -1065,8 +1065,8 @@
 
 void BasicBall::disable_shield() {
     if (has_shield()) {
-	m_shield_rest_time = 0;
-	update_halo();
+        m_shield_rest_time = 0;
+        update_halo();
     }
 }
 
@@ -1077,16 +1077,6 @@
 void BasicBall::update_halo() {
     HaloState newstate = m_halostate;
 
-    double radius = get_actorinfo()->radius;
-    string halokind;
-
-    // Determine which halomodel has to be used:
-    if (radius == 19.0/64) { // Halo for normal balls
-        halokind="halo";
-    }else if (radius == 13.0f/64) { // Halo for small balls
-        halokind="halo-small";
-    }
-
     if (m_shield_rest_time <= 0)
         newstate = NOHALO;
     else if (m_shield_rest_time <= 3.0)
@@ -1095,9 +1085,19 @@
         newstate = HALONORMAL;
 
     if (newstate != m_halostate) {
-	if (m_halostate == NOHALO){
-	   m_halosprite = display::AddSprite (get_pos(), halokind.c_str());
-    }
+        double radius = get_actorinfo()->radius;
+        string halokind;
+    
+        // Determine which halomodel has to be used:
+        if (radius == 19.0/64) { // Halo for normal balls
+            halokind = "halo";
+        } else if (radius == 13.0f/64) { // Halo for small balls
+            halokind = "halo-small";
+        }
+
+        if (m_halostate == NOHALO){
+            m_halosprite = display::AddSprite (get_pos(), halokind.c_str());
+        }
         switch (newstate) {
         case NOHALO:
             // remove halo
@@ -1113,8 +1113,7 @@
             break;
         }
         m_halostate = newstate;
-    }
-    else if (m_halostate != NOHALO) {
+    } else if (m_halostate != NOHALO) {
         m_halosprite.move (get_pos());
     }
 }

Modified: trunk/src/d_engine.hh
===================================================================
--- trunk/src/d_engine.hh	2007-01-11 19:12:30 UTC (rev 572)
+++ trunk/src/d_engine.hh	2007-01-12 21:59:43 UTC (rev 573)
@@ -197,12 +197,11 @@
         int          screenpos[2];
         SpriteLayer  layer;
         bool         visible;
-        bool         mayNeedRedraw;
         Sprite *     above[3];
         Sprite *     beneath[3];
 
         Sprite (const V2 & p, SpriteLayer l, Model *m)
-        : model(m), pos(p), layer(l), visible(true), mayNeedRedraw(false)
+        : model(m), pos(p), layer(l), visible(true)
         {
             screenpos[0] = screenpos[1] = 0;
             above[0] = above[1] = above[2] = NULL;
@@ -229,7 +228,7 @@
         void move_sprite (SpriteId, const ecl::V2& newpos);
         void replace_sprite (SpriteId id, Model *m);
 
-        void redraw_sprite_region (SpriteId id, bool is_add);
+        void redraw_sprite_region (SpriteId id);
         void draw_sprites (bool shades, ecl::GC &gc, const WorldArea &a);
 
         Model *get_model (SpriteId id) { return sprites[id]->model; }
@@ -243,6 +242,8 @@
         SpriteList bottomSprites; // bottom sprite for each x
 
     private:
+        void update_sprite_region (Sprite * s, bool is_add, bool is_redraw_only = false);
+        
         // ModelLayer interface
         virtual void tick (double /*dtime*/);
 

Modified: trunk/src/display.cc
===================================================================
--- trunk/src/display.cc	2007-01-11 19:12:30 UTC (rev 572)
+++ trunk/src/display.cc	2007-01-12 21:59:43 UTC (rev 573)
@@ -846,16 +846,22 @@
 }
 
 void SpriteHandle::hide() const {
-    if(layer->get_sprite(id)->visible) {
-        layer->get_sprite(id)->visible = false;
-        layer->get_sprite(id)->mayNeedRedraw = false;
+    if (layer) {
+        Sprite * s = layer->get_sprite(id);
+        if(s->visible) {
+            s->visible = false;
+            layer->redraw_sprite_region(id);
+        }
     }
 }
 
 void SpriteHandle::show() const {
-    if(not layer->get_sprite(id)->visible) {
-        layer->get_sprite(id)->visible = true;
-        layer->get_sprite(id)->mayNeedRedraw = true;
+    if (layer) {
+        Sprite * s = layer->get_sprite(id);
+        if(!s->visible) {
+            s->visible = true;
+            layer->redraw_sprite_region(id);
+        }
     }
 }
 
@@ -890,15 +896,14 @@
     int newx, newy;
     get_engine()->world_to_video (newpos, &newx, &newy);
 
-    if (newx != sprite->screenpos[0] || newy != sprite->screenpos[1] ||
-            sprite->mayNeedRedraw ) {
-        redraw_sprite_region(id, false); // make sure old sprite is removed
+    if (newx != sprite->screenpos[0] || newy != sprite->screenpos[1]) {
+        update_sprite_region(sprite, false); // make sure old sprite is removed
         sprite->pos = newpos;
         sprite->screenpos[0] = newx;
         sprite->screenpos[1] = newy;
         if (Anim2d* anim = dynamic_cast<Anim2d*>(sprite->model))
             anim->move (newx, newy);
-        redraw_sprite_region(id, true); // draw new sprite
+        update_sprite_region(sprite, true); // draw new sprite
     }
 }
 
@@ -925,7 +930,7 @@
     get_engine()->world_to_video (sprite->pos, &sprite->screenpos[0], &sprite->screenpos[1]);
     if (Model *m = sprite->model)
         m->expose (this, sprite->screenpos[0], sprite->screenpos[1]);
-    redraw_sprite_region(id, true);
+    update_sprite_region(sprite, true);
     numsprites += 1;
     return id;
 }
@@ -933,20 +938,20 @@
 void DL_Sprites::replace_sprite (SpriteId id, Model *m) {
     Sprite *sprite = sprites[id];
     if (Model *old = sprite->model) {
-        redraw_sprite_region(id, false);
+        update_sprite_region(sprite, false);
         old->remove (this);
         delete old;
     }
     sprite->model = m;
     if (m) {
         m->expose (this, sprite->screenpos[0], sprite->screenpos[1]);
-        redraw_sprite_region(id, true);
+        update_sprite_region(sprite, true);
     }
 }
 
 void DL_Sprites::kill_sprite (SpriteId id) {
     if (Sprite *sprite = sprites[id]) {
-        redraw_sprite_region(id, false);
+        update_sprite_region(sprite, false);
         if (Model *m = sprite->model) {
             m->remove (this);
         }
@@ -991,9 +996,12 @@
 //     draw_sprites (false, gc);
 }
 
-void DL_Sprites::redraw_sprite_region (SpriteId id, bool is_add) 
-{
+void DL_Sprites::redraw_sprite_region (SpriteId id) {
     Sprite *s = sprites[id];
+    update_sprite_region(s, true, true);
+}
+
+void DL_Sprites::update_sprite_region (Sprite * s, bool is_add, bool is_redraw_only) {
     if (s && s->model) {
         Rect r, redrawr;
         s->model->get_extension (r);
@@ -1002,6 +1010,8 @@
         DisplayEngine *e = get_engine();
         e->video_to_world (r, redrawr);
         e->mark_redraw_area (redrawr);
+        if (is_redraw_only)
+            return;
         
         int x = redrawr.x;
         for (int i = 0; i < redrawr.w; i++, x++) {



From andreasl at mail.berlios.de  Sun Jan 14 14:02:49 2007
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Sun, 14 Jan 2007 14:02:49 +0100
Subject: [Enigma-game-svn] r574 - trunk/src
Message-ID: <200701141302.l0ED2nfs020706@sheep.berlios.de>

Author: andreasl
Date: 2007-01-14 14:02:46 +0100 (Sun, 14 Jan 2007)
New Revision: 574

Modified:
   trunk/src/world.cc
Log:
Added "!a1.grabbed" in handle_actor_contact.


Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2007-01-12 21:59:43 UTC (rev 573)
+++ trunk/src/world.cc	2007-01-14 13:02:46 UTC (rev 574)
@@ -966,7 +966,7 @@
     V2 n = a1.pos - a2.pos; // normal to contact surface
     double dist = n.normalize();
     double overlap = a1.radius + a2.radius - dist;
-    if (overlap > 0 && !a2.grabbed) {
+    if (overlap > 0 && !a1.grabbed && !a2.grabbed) {
         double relspeed = (a2.vel-a1.vel)*n;
 
         if (relspeed < 0)   // not moving towards each other



From andreasl at mail.berlios.de  Sun Jan 14 21:17:04 2007
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Sun, 14 Jan 2007 21:17:04 +0100
Subject: [Enigma-game-svn] r575 - in trunk/data: gfx32 gfx40 gfx48
Message-ID: <200701142017.l0EKH4gI002752@sheep.berlios.de>

Author: andreasl
Date: 2007-01-14 21:16:58 +0100 (Sun, 14 Jan 2007)
New Revision: 575

Modified:
   trunk/data/gfx32/st-oneway.png
   trunk/data/gfx40/st-oneway.png
   trunk/data/gfx48/st-oneway.png
Log:
Removed pink pixels from st-oneway.png.


Modified: trunk/data/gfx32/st-oneway.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st-oneway.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st-oneway.png
===================================================================
(Binary files differ)



From raoul at mail.berlios.de  Sun Jan 14 22:50:51 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sun, 14 Jan 2007 22:50:51 +0100
Subject: [Enigma-game-svn] r576 - in branches/1.0/data/levels:
	enigma_experimental enigma_oxyd enigma_peroxyd enigma_v
	enigma_vi lib
Message-ID: <200701142150.l0ELopa0011495@sheep.berlios.de>

Author: raoul
Date: 2007-01-14 22:50:47 +0100 (Sun, 14 Jan 2007)
New Revision: 576

Added:
   branches/1.0/data/levels/enigma_experimental/flood_demo_1.xml
   branches/1.0/data/levels/enigma_experimental/puzzle_demo_2.xml
   branches/1.0/data/levels/enigma_experimental/puzzle_testarea_1.xml
   branches/1.0/data/levels/lib/libflood_1.xml
   branches/1.0/data/levels/lib/libpuzzle_2.xml
Removed:
   branches/1.0/data/levels/enigma_experimental/puzzle_demo.xml
   branches/1.0/data/levels/enigma_experimental/randompuzzles.xml
Modified:
   branches/1.0/data/levels/enigma_experimental/index.xml
   branches/1.0/data/levels/enigma_experimental/items.xml
   branches/1.0/data/levels/enigma_oxyd/index.xml
   branches/1.0/data/levels/enigma_oxyd/oxyd70_1.xml
   branches/1.0/data/levels/enigma_oxyd/oxydlink33_1.xml
   branches/1.0/data/levels/enigma_oxyd/oxydlink68_1.xml
   branches/1.0/data/levels/enigma_peroxyd/index.xml
   branches/1.0/data/levels/enigma_peroxyd/peroxyd62_1.xml
   branches/1.0/data/levels/enigma_peroxyd/peroxydlink06_1.xml
   branches/1.0/data/levels/enigma_peroxyd/peroxydlink13_1.xml
   branches/1.0/data/levels/enigma_v/index.xml
   branches/1.0/data/levels/enigma_v/raoul05_1.xml
   branches/1.0/data/levels/enigma_v/raoul23_1.xml
   branches/1.0/data/levels/enigma_v/ss10_1.xml
   branches/1.0/data/levels/enigma_vi/index.xml
   branches/1.0/data/levels/enigma_vi/raoul13_1.xml
   branches/1.0/data/levels/enigma_vi/raoul26_1.xml
Log:
-> Fixed easymodebug in level ss10_1.
-> New version of libpuzzle, new testlevel, switched all my levels to this new version.
-> New lib: libflood and testlevel.



Added: branches/1.0/data/levels/enigma_experimental/flood_demo_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/flood_demo_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_experimental/flood_demo_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -0,0 +1,75 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Flood Demo" el:subtitle="Demolevel for libflood" el:id="flood_demo"/>
+      <el:version el:score="1" el:release="1" el:revision="0" el:status="stable"/>
+      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2007 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+       <el:dependency el:path="lib/libflood_1" el:id="lib/libflood" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- GENERAL --
+levelh = 13
+levelw = 20
+
+create_world(levelw, levelh)
+
+function renderLine( line, pattern)
+	for i=1, strlen(pattern) do
+		local c = strsub( pattern, i, i)
+  		if c=="x" then
+			oxyd(i-1,line)
+        elseif c=="#" then
+            set_stone("st-glass",i-1,line)
+            set_floor("fl-black",i-1,line)
+        elseif c==" " then
+            set_floor("fl-rough",i-1,line)
+        elseif c=="-" then
+            set_floor("fl-black",i-1,line)
+		end
+	end
+end
+
+renderLine(00 , "####################")
+renderLine(01 , "#------------------#")
+renderLine(02 , "#------------------#")
+renderLine(03 , "#---------------- -#")
+renderLine(04 , "#--      -         #")
+renderLine(05 , "#-     - ----     -#")
+renderLine(06 , "#-          -  ----#")
+renderLine(07 , "#-   ------ -  -  -#")
+renderLine(08 , "#- ---    - --    -#")
+renderLine(09 , "#    -  -      -  -#")
+renderLine(10 , "#- ----------------#")
+renderLine(11 , "#------------------#")
+renderLine(12 , "####################")
+
+oxyd_shuffle()
+set_actor("ac-blackball", 1.5,1.5, {player=0})
+
+-- PART FOR THE LIBFLOOD:
+
+init_flood({"################ #",
+            "##      #       ~ ",
+            "# ~   # ####     #",
+            "#          #  ####",
+            "#   ###### #  #  #",
+            "# ###~   # ##   ~#",
+            "    #  #      # ~#",
+            "# ################"},{1,3},1)
+
+set_stone("st-switch_black",2,2,{action="callback", target="do_flood"})
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_experimental/flood_demo_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/1.0/data/levels/enigma_experimental/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/index.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_experimental/index.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Development" location="70300" network="false" owner="Enigma Team" release="1" revision="1" title="Exp"/>
+  <info enigma="1.00" group="Development" location="70300" network="false" owner="Enigma Team" release="1" revision="1" title="Experimental"/>
 
   <attributes/>
 
@@ -13,10 +13,11 @@
     <level _seq="5" _title="Template 3" _xpath="./template3" author="AUTHOR" ctrl="force" easy="false" id="template3" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="6" _title="Impulstest" _xpath="./testimpulses" author="Enigma Team" ctrl="force" easy="false" id="testimpulses" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="7" _title="Wolf Among Sheep" _xpath="./wolfamongsheep" author="illmind" ctrl="force" easy="false" id="wolfamongsheep" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="8" _title="Puzzle Labor" _xpath="./randompuzzles" author="Raoul Bourquin" ctrl="force" easy="false" id="randompuzzles" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="9" _title="Puzzle Demo" _xpath="./puzzle_demo" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_demo" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="8" _title="Puzzle Labor" _xpath="./puzzle_testarea_1" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_testarea" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="9" _title="Puzzle Demo" _xpath="./puzzle_demo_2" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_demo" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="10" _title="All Items" _xpath="./items" author="Raoul Bourquin" ctrl="force" easy="false" id="items" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="11" _title="Impossible?" _xpath="./wb2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb2_exp" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="12" _title="Flood Demo" _xpath="./flood_demo_1" author="Raoul Bourquin" ctrl="force" easy="false" id="flood_demo" rel="1" rev="0" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: branches/1.0/data/levels/enigma_experimental/items.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/items.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_experimental/items.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -2,12 +2,12 @@
 <el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
   <el:protected>
     <el:info el:type="level">
-      <el:identity el:title="All Items" el:subtitle="" el:id="items"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="experimental"/>
+      <el:identity el:title="All Items" el:subtitle="Testlevel with all Items" el:id="items"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="stable"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2006 Raoul Bourquin</el:copyright>
+      <el:copyright>Copyright ? 2006, 2007 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
+      <el:compatibility el:enigma="1.00">
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
       <el:comments>
@@ -24,7 +24,7 @@
 display.SetFollowMode(display.FOLLOW_SCROLLING)
 
 -- DESIGN --
-boden="fl-sahara"
+boden="fl-black"
 wand="st-glass"
 
 -- FLOOR --
@@ -34,20 +34,18 @@
 draw_border(wand)
 
 -- ITEMS --
-set_item("it-document", 10, 6, {text="many many many many Tools !"})
+set_item("it-document", 10, 6, {text="text1"})
 
 -- ACTORS --
 actor1=set_actor("ac-blackball", 4.5,4.5, {player=0})
 
 -- Funktionen
 -- VARS
-itemlist={"it-1pkillstone","it-2pkillstone","it-abyss","it-bag","it-banana","it-blackbomb","it-blackbomb_burning","it-blocker","it-blocker-new","it-booze","it-brake","it-bridge-oxyd","it-bridge-oxyd_active","it-brush","it-burnable","it-burnable_ash","it-burnable_burning","it-burnable_fireproof","it-burnable_ignited","it-changefloor","it-cherry","it-coffee","it-coin1","it-coin2","it-coin4","it-crack1","it-cross","it-debris","it-document","it-drop","it-dummy","it-dynamite","it-easykeepstone","it-easykillstone","it-explosion1","it-explosion2","it-explosion3","it-extinguisher","it-extinguisher_empty","it-extinguisher_medium","it-extralife","it-flagblack","it-flagwhite","it-floppy","it-glasses","it-glasses-broken","it-hammer","it-hill","it-hollow","it-hstrip","it-inversesensor","it-key","it-key_a","it-key_b","it-key_c","it-landmine","it-magicwand","it-magnet","it-magnet-off","it-magnet-on","it-odometer","it-oxyd5f","it-pencil","it-pin","it-pipe-e","it-pipe-es","it-pipe-h","it-pi!
 pe-n","it-pipe-ne","it-pipe-s","it-pipe-sw","it-pipe-v","it-pipe-w","it-pipe-wn","it-puller-e","it-puller-n","it-puller-s","it-puller-w","it-ring","it-rubberband","it-seed","it-seed_nowood","it-seed_volcano","it-sensor","it-shogun-l","it-shogun-m","it-shogun-s","it-signalfilter0","it-signalfilter1","it-spade","it-spoon","it-spring1","it-spring2","it-springboard","it-squashed","it-surprise","it-sword","it-tinyhill","it-tinyhollow","it-trigger","it-umbrella","it-vortex-closed","it-vortex-open","it-vstrip","it-weight","it-whitebomb","it-wormhole","it-wormhole-off","it-wrench","it-yinyang"}
+itemlist={"it-abyss", "it-bag", "it-banana", "it-blackbomb", "it-blocker", "it-booze", "it-booze-broken", "it-brake", "it-brush", "it-burnable", "it-burnable_ash", "it-burnable_burning", "it-burnable_fireproof", "it-burnable_ignited", "it-burnable_oil", "it-changefloor", "it-cherry", "it-coffee", "it-coin1", "it-coin2", "it-coin4", "it-crack0", "it-crack1", "it-crack2", "it-crack3", "it-cross", "it-death", "it-document", "it-drop", "it-dynamite", "it-extinguisher", "it-extinguisher_medium", "it-extinguisher_empty", "it-extralife", "it-flagblack", "it-flagwhite", "it-floppy", "it-glasses", "it-glasses-broken", "it-hammer", "it-hill", "it-hollow", "it-hstrip", "it-inversesensor", "it-key", "it-landmine", "it-magicwand", "it-magnet", "it-magnet-on", "it-odometer", "it-pencil", "it-pin", "it-pipe-e", "it-pipe-es", "it-pipe-h", "it-pipe-n", "it-pipe-ne", "it-pipe-s", "it-pipe-sw", "it-pipe-v", "it-pipe-w", "it-pipe-wn", "it-puller-n", "it-puller-e", "it-puller-s", "it-puller-w",!
  "it-ring", "it-rubberband", "it-seed", "it-seed_nowood", "it-seed_volcano", "it-sensor", "it-shogun-l", "it-shogun-m", "it-shogun-s", "it-spade", "it-spoon", "it-spring1", "it-spring2", "it-springboard", "it-squashed", "it-surprise", "it-sword", "it-tinyhill", "it-tinyhollow", "it-trigger", "it-umbrella", "it-vortex-closed", "it-vortex-open", "it-vstrip", "it-weight", "it-whitebomb", "it-wormhole", "it-wormhole-off", "it-wrench", "it-yinyang" }
 
-itemdoku={"it-1pkillstone","it-2pkillstone","it-abyss","it-bag","it-banana","it-blackbomb","it-blackbomb_burning","it-blocker","it-blocker-new","it-booze","it-brake","it-bridge-oxyd","it-bridge-oxyd_active","it-brush","it-burnable","it-burnable_ash","it-burnable_burning","it-burnable_fireproof","it-burnable_ignited","it-changefloor","it-cherry","it-coffee","it-coin1( value )","it-coin2( value )","it-coin4( value )","it-crack{0..3} ( type fixed brittleness )","it-cross","it-debris","it-document( text )","it-drop","it-dummy","it-dynamite","it-easykeepstone","it-easykillstone","it-explosion1","it-explosion2","it-explosion3","it-extinguisher( load )","it-extinguisher_empty( load )","it-extinguisher_medium( load )","it-extralife","it-flagblack","it-flagwhite","it-floppy","it-glasses","it-glasses-broken","it-hammer","it-hill","it-hollow","it-hstrip","it-inversesensor","it-key( keycode )","it-key_a","it-key_b","it-key_c","it-landmine","it-magicwand","it-magnet( on strength range )!
 ","it-magnet-off( on strength range )","it-magnet-on( on strength range )","it-odometer","it-oxyd5f","it-pencil","it-pin","it-pipe-e","it-pipe-es","it-pipe-h","it-pipe-n","it-pipe-ne","it-pipe-s","it-pipe-sw","it-pipe-v","it-pipe-w","it-pipe-wn","it-puller-e","it-puller-n","it-puller-s","it-puller-w","it-ring","it-rubberband( object1 object2 length strength )","it-seed","it-seed_nowood","it-seed_volcano","it-sensor","it-shogun-l","it-shogun-m","it-shogun-s","it-signalfilter0","it-signalfilter1","it-spade","it-spoon","it-spring1","it-spring2","it-springboard","it-squashed","it-surprise","it-sword","it-tinyhill","it-tinyhollow","it-trigger( invisible )","it-umbrella","it-vortex-closed( autoclose targetx targety )","it-vortex-open( autoclose targetx targety )","it-vstrip","it-weight","it-whitebomb","it-wormhole( on targetx targety strength range )","it-wormhole-off( on targetx targety strength range )","it-wrench","it-yinyang"}
-
 ------
 nr=1
-for i=1,110 do
+for i=1,table.getn(itemlist) do
       nr = nr+1
       set_stone("st-switch",1+i,3, {action="callback", target="sw"..nr, name="switch"..nr})
       func = "function sw"..nr.."() itnr="..i.."; settem(itnr) ; end"
@@ -56,7 +54,7 @@
 
 function settem(itnr)
  item= itemlist[itnr]
- itdo=itemdoku[itnr]
+ itdo=itemlist[itnr]
  set_item(item,1+itnr,5)
  set_item("it-document", 1+itnr, 1, {text=itdo})
 end
@@ -69,6 +67,9 @@
       <el:string el:key="title">
         <el:english el:translate="false"/>
       </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Level with all items of Enigma 1.00!</el:english>
+      </el:string> 
     </el:i18n>
   </el:protected>
 </el:level>

Deleted: branches/1.0/data/levels/enigma_experimental/puzzle_demo.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/puzzle_demo.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_experimental/puzzle_demo.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -1,153 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Puzzle Demo" el:subtitle="" el:id="puzzle_demo"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="experimental"/>
-      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2006 Raoul Bourquin</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- GENERAL --
-levelw = 39
-levelh = 25
-
-create_world(levelw, levelh)
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-          if c=="x" then
-            --oxyd(i-1,line)
-                elseif c=="#" then
-                   set_stone("st-glass",i-1,line)
-                   set_floor("fl-sahara",i-1,line)
-                elseif c==" " then
-                   set_floor("fl-sahara",i-1,line)
-        end
-    end    
-end
-
-renderLine(00 , "#######################################")
-renderLine(01 , "#                  #                  #")
-renderLine(02 , "#                  #                  #")
-renderLine(03 , "#                  #                  #")
-renderLine(04 , "#                                     #")
-renderLine(05 , "#                                     #")
-renderLine(06 , "#                                     #")
-renderLine(07 , "#                                     #")
-renderLine(08 , "#                                     #")
-renderLine(09 , "#                  #                  #")
-renderLine(10 , "#                  #                  #")
-renderLine(11 , "#                  #                  #")
-renderLine(12 , "######        ###########        ######")
-renderLine(13 , "#                  #                  #")
-renderLine(14 , "#                  #                  #")
-renderLine(15 , "#                  #                  #")
-renderLine(16 , "#                                     #")
-renderLine(17 , "#                                     #")
-renderLine(18 , "#                                     #")
-renderLine(19 , "#                                     #")
-renderLine(20 , "#                                     #")
-renderLine(21 , "#                  #                  #")
-renderLine(22 , "#                  #                  #")
-renderLine(23 , "#                  #                  #")
-renderLine(24 , "#######################################")
-
-oxyd_shuffle()
-
--- Special
-set_item("it-document", 3, 8, {text="Welcome to the demonstration of libpuzzle version 0.97"})
-set_item("it-document", 3, 9, {text="Please also look at the source code of the lib and of this level."})
-set_actor("ac-blackball", 2.5,7.5, {player=0}) 
-set_item("it-magicwand", 2, 7) 
-
-set_item("it-document", 11, 7, {text="Room 1: Some general things you can do with libpuzzle"})
-set_item("it-document", 8, 18, {text="The red puzzles, generated with permutations, are ALL solvable."})
-set_item("it-document", 11, 18, {text="The blue ones, generated with random, aren't!"})
-set_item("it-document", 28, 8, {text="Room 2: Every figure in here, the +/T/L, all are solvable because they are generated  from the solved puzzle with permutations."})
-set_item("it-document", 23, 16, {text="Room 4: Some things, you can do with pseude pieces: open puzzle clusters..."})
-
-
---first room:
---rings, treppe, figure1...
---shows some general things
---"normal" use of the lib, no WORLD variables or default arguments...
-
-  --ring1
-  puzzle({{1,1,1},{1,0,1},{1,1,1}},2,2,"red","no")
-
-  puzzle({{1,1,1,0},{1,0,0,1},{1,0,1,1},{1,1,1,0}},10,6,"red","no")
-
-  puzzle({{1,0,0},{1,1,0},{0,1,1}},10,2,"red","yes")
-
-  puzzle({{1,1,1},{1,1,1},{1,1,1}},14,2,"red","no")
-
-  puzzle({{0,0,1,0,0},{0,1,1,1,0},{1,1,0,1,1}},14,9,"blue","no")
-
-  puzzle({{0,0,1,0},{0,1,1,0},{0,1,0,0},{0,1,1,1},{0,0,0,1},{1,1,1,1}},5, 4,"blue","no")
-
---second room:
---every puzzle here is solvable, generated with permutations
---configured with the WORLD Variables:
-  art="2"
-  must_shuffle=1
-  puzzle({{0,1,0},{1,1,1},{0,1,0}},21,1)
-  puzzle({{0,1,0},{1,1,1},{0,1,0}},25,1)
-  puzzle({{0,1,0},{1,1,1},{0,1,0}},30,1)
-  puzzle({{0,1,0},{1,1,1},{0,1,0}},34,1)
-
-  puzzle({{1,1,1},{0,1,0},{0,1,0}},21,5)
-  puzzle({{1,1,1},{0,1,0},{0,1,0}},25,5)
-  puzzle({{1,1,1},{0,1,0},{0,1,0}},30,5)
-  puzzle({{1,1,1},{0,1,0},{0,1,0}},34,5)
-
-  puzzle({{1,0,0},{1,0,0},{1,1,1}},21,9)
-  puzzle({{1,0,0},{1,0,0},{1,1,1}},25,9)
-  puzzle({{1,0,0},{1,0,0},{1,1,1}},30,9)
-  puzzle({{1,0,0},{1,0,0},{1,1,1}},34,9)
-
-
---third room:
---shows the difference between random and permutation shuffle.
-
-  must_shuffle=1
-  shuffle_method="random"
-  puzzle({{1},{1},{1}},11,20,"blue")
-  puzzle({{1},{1},{1},{1}},13,19,"blue")
-  puzzle({{1},{1},{1},{1},{1}},15,18,"blue")
-  puzzle({{1},{1},{1},{1},{1},{1}},17,17,"blue")
-
-  shuffle_method="permutation"
-  puzzle({{1},{1},{1}},8,14,"red")
-  puzzle({{1},{1},{1},{1}},6,14,"red")
-  puzzle({{1},{1},{1},{1},{1}},4,14,"red")
-  puzzle({{1},{1},{1},{1},{1},{1}},2,14,"red")
-
---4. room:
---shows the wonderfull possibilities of pseudo_pieces.
-
-  puzzle({{0,2,0,2,0},{2,1,1,1,2},{0,1,0,1,0},{2,1,1,1,2},{0,2,0,2,0}},21,14,"blue","no")
-
-  puzzle({{1,1,2,1},{1,0,0,1},{1,2,1,1}},26,20,"blue","no")
-
-  puzzle({{1,1,1},{1,2,1},{1,1,1}},27,14,"red","no")
-
-  puzzle({{1,1,1,1},{2,0,0,1},{0,2,0,1},{1,1,1,1},{0,1,0,0},{0,1,0,2},{2,1,1,1}},32,15,"blue","no")
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Added: branches/1.0/data/levels/enigma_experimental/puzzle_demo_2.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/puzzle_demo_2.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_experimental/puzzle_demo_2.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -0,0 +1,242 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Puzzle Demo" el:subtitle="Demolevel for libpuzzle" el:id="puzzle_demo"/>
+      <el:version el:score="2" el:release="2" el:revision="2" el:status="stable"/>
+      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2006, 2007 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- GENERAL --
+levelw = 39
+levelh = 37
+
+create_world(levelw, levelh)
+
+function renderLine( line, pattern)
+    for i=1, strlen(pattern) do
+        local c = strsub( pattern, i, i)
+          if c=="x" then
+            --oxyd(i-1,line)
+                elseif c=="#" then
+                   set_stone("st-glass",i-1,line)
+                   set_floor("fl-black",i-1,line)
+                elseif c==" " then
+                   set_floor("fl-black",i-1,line)
+        end
+    end    
+end
+
+renderLine(00 , "#######################################")
+renderLine(01 , "#                  #                  #")
+renderLine(02 , "#                  #                  #")
+renderLine(03 , "#                  #                  #")
+renderLine(04 , "#                                     #")
+renderLine(05 , "#                                     #")
+renderLine(06 , "#                                     #")
+renderLine(07 , "#                                     #")
+renderLine(08 , "#                                     #")
+renderLine(09 , "#                  #                  #")
+renderLine(10 , "#                  #                  #")
+renderLine(11 , "#                  #                  #")
+renderLine(12 , "######        ###########        ######")
+renderLine(13 , "#                  #                  #")
+renderLine(14 , "#                  #                  #")
+renderLine(15 , "#                  #                  #")
+renderLine(16 , "#                                     #")
+renderLine(17 , "#                                     #")
+renderLine(18 , "#                                     #")
+renderLine(19 , "#                                     #")
+renderLine(20 , "#                                     #")
+renderLine(21 , "#                  #                  #")
+renderLine(22 , "#                  #                  #")
+renderLine(23 , "#                  #                  #")
+renderLine(24 , "######        ###########        ######")
+renderLine(25 , "#                  #                  #")
+renderLine(26 , "#                  #                  #")
+renderLine(27 , "#                  #                  #")
+renderLine(28 , "#                                     #")
+renderLine(29 , "#                                     #")
+renderLine(30 , "#                                     #")
+renderLine(31 , "#                                     #")
+renderLine(32 , "#                                     #")
+renderLine(33 , "#                  #                  #")
+renderLine(34 , "#                  #                  #")
+renderLine(35 , "#                  #                  #")
+renderLine(36 , "#######################################")
+
+oxyd_shuffle()
+
+-- Special
+set_item("it-document", 3, 8, {text="Welcome to the demonstration of libpuzzle version 2"})
+set_item("it-document", 3, 9, {text="Please also look at the source code of the lib and of this level."})
+set_actor("ac-blackball", 2.5,7.5, {player=0}) 
+set_item("it-magicwand", 2, 7) 
+
+set_item("it-document", 11, 7, {text="Room 1: Some general things you can do with libpuzzle"})
+set_item("it-document", 8, 18, {text="The red puzzles, generated with permutations, are ALL solvable."})
+set_item("it-document", 11, 18, {text="The blue ones, generated with random, aren't!"})
+set_item("it-document", 28, 8, {text="Room 2: Every figure in here, the +/T/L, all are solvable because they are generated  from the solved puzzle with permutations."})
+set_item("it-document", 23, 16, {text="Room 4: Some things, you can do with pseude pieces: open puzzle clusters ..."})
+set_item("it-document", 8, 30, {text="Room 5: Some things, you can do with Bigbricks ..."})
+set_item("it-document", 26, 27, {text="Room 6: Some things, you can do with Bigbluesandstones ..."})
+
+
+-- First room:
+-- Shows some general figures with puzzlestones
+
+  --ring1
+  puzzle({"###",
+          "# #",
+          "###"},{2,2},"redpuzzle","none")
+
+  puzzle({"### ",
+          "#  #",
+          "# ##",
+          "### "},{10,6},"redpuzzle","none")
+
+  puzzle({"#  ",
+          "## ",
+          " ##"},{10,2},"redpuzzle","random")
+
+  puzzle({"###",
+          " # ",
+          "###"},{14,2},"bluepuzzle","permutation")
+
+  puzzle({"  #  ",
+          " ### ",
+          "## ##"},{14,9},"bluepuzzle","none")
+
+  puzzle({"  # ",
+          " ## ",
+          " #  ",
+          " ###",
+          "   #",
+          "####"},{5,4},"bluepuzzle","none")
+
+-- Second room:
+-- Every puzzle here is solvable, generated with permutations
+
+  puzzle({" # ","###"," # "},{21,1},"redpuzzle","permutation")
+  puzzle({" # ","###"," # "},{25,1},"redpuzzle","permutation")
+  puzzle({" # ","###"," # "},{30,1},"redpuzzle","permutation")
+  puzzle({" # ","###"," # "},{34,1},"redpuzzle","permutation")
+
+  puzzle({"###"," # "," # "},{21,5},"redpuzzle","permutation")
+  puzzle({"###"," # "," # "},{25,5},"redpuzzle","permutation")
+  puzzle({"###"," # "," # "},{30,5},"redpuzzle","permutation")
+  puzzle({"###"," # "," # "},{34,5},"redpuzzle","permutation")
+
+  puzzle({"#  ","#  ","###"},{21,9},"redpuzzle","permutation")
+  puzzle({"#  ","#  ","###"},{25,9},"redpuzzle","permutation")
+  puzzle({"#  ","#  ","###"},{30,9},"redpuzzle","permutation")
+  puzzle({"#  ","#  ","###"},{34,9},"redpuzzle","permutation")
+
+-- Third room:
+-- Shows the difference between random and permutation shuffle.
+
+  puzzle({"#","#","#"},{11,20},"bluepuzzle","random")
+  puzzle({"#","#","#","#"},{13,19},"bluepuzzle","random")
+  puzzle({"#","#","#","#","#"},{15,18},"bluepuzzle","random")
+  puzzle({"#","#","#","#","#","#"},{17,17},"bluepuzzle","random")
+
+  puzzle({"#","#","#"},{8,14},"redpuzzle","permutation")
+  puzzle({"#","#","#","#"},{6,14},"redpuzzle","permutation")
+  puzzle({"#","#","#","#","#"},{4,14},"redpuzzle","permutation")
+  puzzle({"#","#","#","#","#","#"},{2,14},"redpuzzle","permutation")
+
+-- Fourth room:
+-- Shows the wonderfull possibilities of pseudo_pieces.
+
+  puzzle({" + + ",
+          "+###+",
+          " # # ",
+          "+###+",
+          " + + "},{21,14},"bluepuzzle","none")
+
+  puzzle({"##+#","#  #","#+##"},{26,20},"bluepuzzle","none")
+
+  puzzle({"###","#+#","###"},{27,14},"redpuzzle","none")
+
+  puzzle({"####",
+          "+  #",
+          " + #",
+          "####",
+          " #  ",
+          " # +",
+          "+###"},{32,15},"bluepuzzle","none")
+
+  puzzle({"# #",
+          " # ",
+          "# #"},{22,20},"bluepuzzle","permutation")
+
+-- 5. room:
+-- Things, you can do with bigbricks.
+
+  puzzle({"###","# #","  #","###"},{3,26},"bigbrick","none")
+
+  puzzle({"### #",
+          "#   #",
+          "# ###"},{3,32},"bigbrick","none")
+
+  puzzle({"###","# #"},{9,33},"bigbrick","random")
+
+  puzzle({"#    ",
+          "##   ",
+          " ##  ",
+          "  ## ",
+          "   ##"},{9,27},"bigbrick","none")
+
+  puzzle({" # # ",
+          "#####",
+          " # # "},{12,26},"bigbrick","none")
+
+  puzzle({"###",
+          "###",
+          "###"},{15,32},"bigbrick","none")
+
+-- 6. room:
+-- Things, you can do with bigbluesandstones.
+
+  puzzle({" ##",
+          "# #",
+          "###"},{21,26},"bigbluesand","none")
+
+  puzzle({"  ####",
+          "  #  #",
+          "#### #",
+          "# ####",
+          "#  #  ",
+          "####  "},{20,30},"bigbluesand","none")
+
+  puzzle({"## ### ##",
+          " ### ### "},{28,26},"bigbluesand","none")
+
+  puzzle({"## ##",
+          " ### ",
+          "## ##"},{29,30},"bigbluesand","none")
+
+  puzzle({"  ##+",
+          " ##  ",
+          "##   ",
+          "#    ",
+          "+    "},{34,32},"bigbluesand","none")
+
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_experimental/puzzle_demo_2.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/enigma_experimental/puzzle_testarea_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/puzzle_testarea_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_experimental/puzzle_testarea_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -0,0 +1,187 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Puzzle Labor" el:subtitle="Testlevel to examine new puzzles" el:id="puzzle_testarea"/>
+      <el:version el:score="1" el:release="1" el:revision="0" el:status="stable"/>
+      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2005, 2007 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+levelw = 39
+levelh = 13
+create_world(levelw, levelh)
+enigma.ConserveLevel = FALSE
+
+-- Design --
+boden="fl-sahara"
+wand="st-glass"
+boden2="fl-black"
+
+-- FLOOR --
+fill_floor(boden, 0,0,levelw,levelh)
+fill_floor(boden2,7,3,8,6)
+
+-- STONES --
+draw_border(wand)
+draw_stones(wand,{19,1},{0,1},11)
+
+-- ACTORS --
+local ac1=set_actor("ac-blackball", 1.5,1.5, {player=0, essential = 1})
+local ac2=set_actor("ac-whiteball", 21.5,2.5, {player=1, essential = 1})
+
+-- ITEMS
+set_item("it-yinyang",1,1)
+set_item("it-yinyang",21,2)
+
+set_item("it-document",17,11,{text="Clear"})
+
+set_item("it-document",21,5,{text="With the switches at the right, you can determine the layout of the desired puzzle."})
+set_item("it-document",21,6,{text="Switch up means stone, switch down means no stone at that position."})
+set_item("it-document",21,7,{text="After you set up the layout, hit the switch at the top and return to the left screen."})
+set_item("it-document",21,1,{text="Store the figure the draw it."})
+set_item("it-document",21,11,{text="Reset all switches."})
+
+set_item("it-document",1,10,{text="Which Stonetype? Possible are: \"st-puzzle\", \"st-puzzle2\", \"st-bigbrick\" or \"st-bigbluesand\"."})
+set_item("it-document",17,1,{text="Draw the puzzle unshuffled. (shuffle_method = \"none\")."})
+set_item("it-document",17,3,{text="Draw the puzzle shuffled with the \"random\" method."})
+set_item("it-document",17,5,{text="Draw the puzzle shuffled with the \"permutation\" method."})
+
+set_item("it-magicwand",2,10)
+--------------------------------------------------------------------------------
+-- SWITCHES, left room:
+-- Switches to draw the puzzle:
+set_stone("st-switch", 18, 1, {action="callback",target="draw_none",name="draw1"})
+set_stone("st-switch", 18, 3, {action="callback",target="draw_random",name="draw2"})
+set_stone("st-switch", 18, 5, {action="callback",target="draw_permutation",name="draw3"})
+
+-- Clear the canvas:
+set_stone("st-switch", 18, 11, {action="callback",target="remove_puzzle",name="clear"})
+
+set_stone("st-switch", 1, 11, {action="callback",target="stone_kind_switch",name="kind"})
+
+-- Right room:
+set_stone("st-switch", 20, 1, {action="callback",target="write_values",name="w_v"})
+set_stone("st-switch", 20, 11, {action="callback",target="clear_values",name="c_v"})
+
+-- Generate the switches and functions
+nr=0
+array={}
+for i=1,6 do
+    for j=1,8 do
+        nr = nr+1
+        set_stone("st-switch",21+2*j,-1+2*i, {action="callback", target="sw"..nr, name="swi"..nr})
+
+        func = "function sw"..nr.."() k="..nr.."; if array[k]==0 then array[k]=1 else array[k]=0 end end"
+        dostring(func)
+        array[nr] = 0
+   end
+end
+--------------------------------------------------------------------------------
+---------------------
+--WORLD-VALUES:
+defaultmap = {" # # ",
+              "#####",
+              " # # "}
+
+stone_kind = {"redpuzzle","bluepuzzle","bigbrick","bigbluesand"}
+kind_pointer = 1
+
+charmap = defaultmap
+
+-- Functions to draw the puzzle:
+function draw_none()
+    puzzle(charmap,{7,3},stone_kind[kind_pointer],"none")
+end
+
+function draw_random()
+    puzzle(charmap,{7,3},stone_kind[kind_pointer],"random")
+end
+
+function draw_permutation()
+    puzzle(charmap,{7,3},stone_kind[kind_pointer],"permutation")
+end
+
+-- Clear:
+function remove_puzzle()
+    for i=1,8 do
+        for j=1,6 do
+            enigma.KillStone(6+i,2+j)
+        end
+    end
+end
+
+-- Chose the kind
+function stone_kind_switch()
+    kind_pointer = kind_pointer +1
+    if kind_pointer > 4 then
+        kind_pointer = 1
+    end
+    set_item("it-document",2,11,{text="Stonekind set to: "..stone_kind[kind_pointer]})
+end
+--------------------------------------------------------------------------------
+-- Reset the switches
+function clear_values()
+    matrix={{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0}}
+    for o=1,48 do
+        enigma.SendMessage(enigma.GetNamedObject("swi"..o),"off",nil)
+    end
+end
+
+-- Store the switchvalues
+function write_values()
+    matrix={{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0}}
+    local x = 1
+    local y = 1
+    local h = 0
+    for h=1, 48 do
+        matrix[y][x] = array[h]
+        if x == 8 then
+            x = 0
+            y = y + 1
+        end
+        x = x+1
+    end
+    gen_charmap()
+end
+
+-- Generate the charmap
+function gen_charmap()
+    charmap = {}
+    local checker = 0
+    local i, j = 0, 0
+    for i=1, 6 do
+        charmap[i]=""
+        local buffer = ""
+        for j=1, 8 do
+            if matrix[i][j] == 1 then
+                checker = 1
+                buffer = buffer.."#"
+            elseif matrix[i][j] == 0 then
+                buffer = buffer.." "
+            end
+        end
+        charmap[i] = buffer
+    end
+    if checker == 0 then
+        -- If we leave this out, libpuzzle would raise an error!
+        charmap = defaultmap
+    end
+end
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_experimental/puzzle_testarea_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Deleted: branches/1.0/data/levels/enigma_experimental/randompuzzles.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/randompuzzles.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_experimental/randompuzzles.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -1,164 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Puzzle Labor" el:subtitle="" el:id="randompuzzles"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="experimental"/>
-      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2005 Raoul Bourquin</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-levelw = 39
-levelh = 13
-create_world(levelw, levelh)
-enigma.ConserveLevel = FALSE
-
--- Design --
-boden="fl-sahara"
-wand="st-glass"
-boden2="fl-black"
-
--- FLOOR --
-fill_floor(boden, 0,0,levelw,levelh)
-fill_floor(boden2,7,3,8,6)
-
--- STONES --
-draw_border(wand)
-draw_stones(wand,{19,1},{0,1},11)
-
-set_stone("st-switch", 18, 1, {action="callback",target="wrap1",name="sg"})
-set_stone("st-switch", 18, 2, {action="callback",target="wrap2",name="sg"})
-set_stone("st-switch", 18, 11, {action="callback",target="del",name="sd"})
-
-set_stone("st-switch", 20, 1, {action="callback",target="write_vals",name="sw"})
-set_stone("st-switch", 20, 11, {action="callback",target="leere",name="sl"})
-
-set_stone("st-switch", 1, 11, {action="callback",target="was",name="art_steine_switch"})
-
-set_stone("st-switch", 3, 11, {action="callback",target="method",name="shuffle_method"})
-
--- ACTORS --
-local ac1=set_actor("ac-blackball", 1.5,1.5, {player=0})
-local ac2=set_actor("ac-whiteball", 21.5,2.5, {player=1})
-
--- ITEMS
-set_item("it-yinyang",1,1)
-set_item("it-yinyang",21,2)
-
-set_item("it-document",17,1,{text="Zeichne Figur mit durchmixten Teilen"})
-set_item("it-document",17,2,{text="Zeichne Figur mit nicht durchmixten Teilen"})
-set_item("it-document",17,11,{text="L?sche Reste auf dem Experimentierplatz"})
-
-set_item("it-document",21,1,{text="Speichere Figur zum anschliessenden Zeichnen"})
-set_item("it-document",21,11,{text="Reset aller Schalter"})
-
-set_item("it-document",1,10,{text="Rote oder Blaue Puzzlesteine ?"})
-set_item("it-document",3,10,{text="shuffle_method = permutation oder random"})
-
-
-set_item("it-magicwand",2,11)
-
----------------------
--- Zeichne Schalter und Eventhandler dazu:
-nr=0
-array={}
-for i=1,6 do
-   for j=1,8 do
-      nr = nr+1
-      set_stone("st-switch",21+2*j,-1+2*i, {action="callback", target="sw"..nr, name="swi"..nr})
-
-      func = "function sw"..nr.."() k="..nr.."; if array[k]==0 then array[k]=1 else array[k]=0 end end"
-      dostring(func)
-      array[nr] = 0
-   end
-end
----------------------
---WORLD-VALUES:
-art_steine="red"
-shuffle_method="permutation"
-
--- Zeichne die Figur mit durchmischten Teilen
-function wrap1()
- must_shuffle=1
- puzzle(matrix,7,3,art_steine)
-end
-
--- Zeichne die Figur geloest
-function wrap2()
- must_shuffle=0
- puzzle(matrix,7,3,art_steine)
-end
-
--- Setzte die Schalter zurueck
-function leere()
- for o=1,48 do
-  enigma.SendMessage(enigma.GetNamedObject("swi"..o),"off",nil)
- end
-end
-
--- loesche nicht loesbare Uebereste
-function del()
- for i=1,8 do
-  for j=1,6 do
-   enigma.KillStone(6+i,2+j)
-  end
- end
-end
-
---welche art steine ?
-function was()
- if art_steine=="blue" then 
-  art_steine="red"
- else
-  art_steine="blue"
- end
- return art_steine
-end
-
---welche shuffle_,ethod ?
-function method()
- if shuffle_method=="permutation" then 
-  shuffle_method="random"
- else
-  shuffle_method="permutation"
- end
- set_item("it-document",4,11,{text="set to "..shuffle_method})
-end
-
-
--- Speichere die Schalter
-function write_vals()
-matrix={{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0},{0,0,0,0,0,0,0,0}}
- zz=1
- zs=1
-
- for h=1,48 do
-   matrix[zz][zs]=array[h]
-
-  if zs==8 then
-   zs=0
-   zz=zz+1
-  end
-  zs=zs+1
- end
-end
-
--- Initial Code execution:
-write_vals()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Modified: branches/1.0/data/levels/enigma_oxyd/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/index.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_oxyd/index.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -36,7 +36,7 @@
     <level _seq="28" _title="Moonwalking" _xpath="./oxyd52_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20060629ulf006" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="29" _title="Scrooge" _xpath="./oxyd53_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried100" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="30" _title="Soaring High" _xpath="./oxyd54_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried101" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="31" _title="Oxyd 70" _xpath="./oxyd70_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd70" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="31" _title="Oxyd 70" _xpath="./oxyd70_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd70" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="32" _title="Oxyd 77" _xpath="./oxyd77_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd77" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="33" _title="Oxyd 79" _xpath="./oxyd79_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20070103ulf015" rel="1" rev="68" score="1" target="time" unit="duration"/>
     <level _seq="34" _title="Oxyd 90" _xpath="./oxyd90_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd90" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -51,12 +51,12 @@
     <level _seq="43" _title="OxydLink 23" _xpath="./oxydlink23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried104" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="44" _title="Preferences" _xpath="./oxydlink28_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10d" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="45" _title="Letter Bomb" _xpath="./oxydlink31_1" author="Siegfried Fennig" ctrl="force" easy="false" id="oxydlink31" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="46" _title="Oxyd Link 33" _xpath="./oxydlink33_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p33" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="46" _title="Oxyd Link 33" _xpath="./oxydlink33_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p33" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="47" _title="Mirror III" _xpath="./oxydlink41_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried80" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="48" _title="My Way, Your Way" _xpath="./oxydlink46_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10e" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="49" _title="Center Court" _xpath="./oxydlink61_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level11c" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="50" _title="Parcours" _xpath="./oxydlink65_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8a" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="51" _title="Oxyd Link 68" _xpath="./oxydlink68_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p68" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="51" _title="Oxyd Link 68" _xpath="./oxydlink68_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p68" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="52" _title="Slide Show" _xpath="./oxydlink72_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8c" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="53" _title="Oxyd Link 87" _xpath="./oxydlink87_1" author="Raoul Bourquin" ctrl="force" easy="false" id="oxyd2p87" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="54" _title="OxydLink 95" _xpath="./oxydlink95_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried103" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_oxyd/oxyd70_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxyd70_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_oxyd/oxyd70_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Oxyd 70" el:subtitle="Oxyd 70" el:id="oxyd70"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2005 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92" el:engine="oxyd1">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+      <el:compatibility el:enigma="1.00" el:engine="oxyd1">
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
       <el:comments>
@@ -34,7 +34,7 @@
                 elseif c=="H" then
                         set_stone("st-metal_hole",i-1,line)
                 elseif c==" " then
-            set_floor("fl-brick",i-1,line)
+                        set_floor("fl-brick",i-1,line)
 
                 elseif c=="a" then
                         set_stone("st-bigbrick-sw",i-1,line)
@@ -84,8 +84,17 @@
 set_actor("ac-whiteball-small", 10,14.5, {player=0})
 set_actor("ac-whiteball-small", 10,20.5, {player=0})  
 
-puzzle({{0,0,1,0,0,1,0,0},{0,0,1,0,0,1,0,0},{1,1,1,1,1,1,1,1},{0,0,1,0,0,1,0,0},{0,0,1,0,0,1,0,0}},6,5,"red","yes")
-puzzle({{0,0,1,0,0,1,0,0},{0,0,1,0,0,1,0,0},{1,1,1,1,1,1,1,1},{0,0,1,0,0,1,0,0},{0,0,1,0,0,1,0,0}},6,15,"red","no")
+puzzle({"  #  #  ",
+        "  #  #  ",
+        "########",
+        "  #  #  ",
+        "  #  #  "},{6,5},"redpuzzle","permutation")
+
+puzzle({"  #  #  ",
+        "  #  #  ",
+        "########",
+        "  #  #  ",
+        "  #  #  "},{6,15},"redpuzzle","none")
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Modified: branches/1.0/data/levels/enigma_oxyd/oxydlink33_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxydlink33_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_oxyd/oxydlink33_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Oxyd Link 33" el:subtitle="Oxyd Link 33" el:id="oxyd2p33"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2005,2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92" el:engine="oxyd1">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+      <el:compatibility el:enigma="1.00" el:engine="oxyd1">
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="true"/>
       <el:comments>
@@ -83,7 +83,10 @@
 oxyd_default_flavor = "a"
 oxyd_shuffle()
 
-puzzle({{1,1,1,1},{1,0,0,0},{1,0,0,0},{1,0,0,0}},9,4,"red")
+puzzle({"####",
+        "#   ",
+        "#   ",
+        "#   "},{9,4},"redpuzzle","permutation")
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Modified: branches/1.0/data/levels/enigma_oxyd/oxydlink68_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_oxyd/oxydlink68_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_oxyd/oxydlink68_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Oxyd Link 68" el:subtitle="Oxyd Link 68" el:id="oxyd2p68"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92" el:engine="oxyd1">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+      <el:compatibility el:enigma="1.00" el:engine="oxyd1">
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="true"/>
       <el:comments>
@@ -65,7 +65,10 @@
 oxyd_shuffle()
 
 --Ring
-puzzle({{1,1,1,1},{1,0,0,1},{1,0,0,1},{1,1,1,1}},8,4,"red")
+puzzle({"####",
+        "#  #",
+        "#  #",
+        "####"},{8,4},"redpuzzle","permutation")
 
 -- Special
 set_item("it-document",4,3,{text="text1"})

Modified: branches/1.0/data/levels/enigma_peroxyd/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/index.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_peroxyd/index.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -36,7 +36,7 @@
     <level _seq="28" _title="Cliffhanger" _xpath="./peroxyd54_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10f" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="29" _title="Per.Oxyd 55" _xpath="./peroxyd55_2" author="Sven Siggelkow" ctrl="force" easy="false" id="ss_pox55" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="30" _title="Roadblock" _xpath="./peroxyd58_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7b" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="31" _title="Per.Oxyd 62" _xpath="./peroxyd62_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd62" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="31" _title="Per.Oxyd 62" _xpath="./peroxyd62_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd62" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="32" _title="Serious Patching" _xpath="./peroxyd73_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8f" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="33" _title="One Single Try" _xpath="./peroxyd75_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried78" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="34" _title="Plumbing" _xpath="./peroxyd79_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7e" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -48,8 +48,8 @@
     <level _seq="40" _title="It Takes Two" _xpath="./peroxydlink01_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin43" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="41" _title="Oops, Sorry!" _xpath="./peroxydlink02_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7f" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="42" _title="Good Company" _xpath="./peroxydlink03_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10a" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="43" _title="Per.Oxyd Link 6" _xpath="./peroxydlink06_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p6" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="44" _title="Per.Oxyd Link 13" _xpath="./peroxydlink13_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p13" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="43" _title="Per.Oxyd Link 6" _xpath="./peroxydlink06_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p6" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="44" _title="Per.Oxyd Link 13" _xpath="./peroxydlink13_1" author="Raoul Bourquin" ctrl="force" easy="false" id="peroxyd2p13" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="45" _title="Monolith" _xpath="./peroxydlink22_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level10c" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="46" _title="Let Me Out!" _xpath="./peroxydlink44_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried92" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="47" _title="Crisscross" _xpath="./peroxydlink45_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin62" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_peroxyd/peroxyd62_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/peroxyd62_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_peroxyd/peroxyd62_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Per.Oxyd 62" el:subtitle="Per.Oxyd 62" el:id="peroxyd62"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2005 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92" el:engine="per.oxyd">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+      <el:compatibility el:enigma="1.00" el:engine="per.oxyd">
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
       <el:comments>
@@ -55,10 +55,10 @@
                 elseif c=="a" then
                    set_floor("fl-abyss",i-1,line)
 
-        elseif c=="f" then
-           set_item("it-flagblack",i-1,line)
-        elseif c=="s" then
-           set_item("it-spring1",i-1,line)
+                elseif c=="f" then
+                   set_item("it-flagblack",i-1,line)
+                elseif c=="s" then
+                   set_item("it-spring1",i-1,line)
         end
     end    
 end
@@ -77,7 +77,8 @@
 renderLine(11 , "#######################################")
 renderLine(12 , "                                       ")
 
-puzzle({{1,1},{1,1}},24,8,"blue","no")
+puzzle({"##",
+        "##"},{24,8},"bluepuzzle","none")
 
 -- Special
 set_item("it-document", 17, 10, {text="text1"})

Modified: branches/1.0/data/levels/enigma_peroxyd/peroxydlink06_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/peroxydlink06_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_peroxyd/peroxydlink06_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Per.Oxyd Link 6" el:subtitle="Per.Oxyd Link 6" el:id="peroxyd2p6"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92" el:engine="per.oxyd">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+      <el:compatibility el:enigma="1.00" el:engine="per.oxyd">
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="true"/>
       <el:comments>
@@ -32,7 +32,7 @@
           if c=="x" then
             oxyd(i-1,line)
                 elseif c=="#" then
-            set_stone("st-rock2",i-1,line)
+                    set_stone("st-rock2",i-1,line)
                    
                 elseif c==" " then
                    set_floor("fl-concrete",i-1,line)
@@ -41,7 +41,6 @@
                    set_stone("st-black1",i-1,line)
                 elseif c=="w" then
                    set_stone("st-white1",i-1,line)
-
         end
     end    
 end
@@ -81,7 +80,12 @@
 set_item("it-yinyang", 11,5)
 set_item("it-yinyang", 11,15)
 
-puzzle({{1,1,1,1,1,1,1,1,1,1},{1,0,0,0,0,0,0,0,0,1},{1,0,0,0,0,0,0,0,0,1},{1,0,0,0,0,0,0,0,0,1},{1,0,0,0,0,0,0,0,0,1},{1,1,1,1,1,1,1,1,1,1}},14,10,"blue","no")
+puzzle({"##########",
+        "#        #",
+        "#        #",
+        "#        #",
+        "#        #",
+        "##########"},{14,10},"bluepuzzle","none")
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Modified: branches/1.0/data/levels/enigma_peroxyd/peroxydlink13_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/peroxydlink13_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_peroxyd/peroxydlink13_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Per.Oxyd Link 13" el:subtitle="Per.Oxyd Link 13" el:id="peroxyd2p13"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
       <el:compatibility el:enigma="0.92" el:engine="per.oxyd">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="true"/>
       <el:comments>
@@ -64,30 +64,55 @@
 set_item("it-yinyang",3,8)
 
 --THE PUZZLES:
-must_shuffle=0
-art=""
+puzzle({"#",
+        "#",
+        "#",
+        "#",
+        "#"},{5,4},"bluepuzzle","none")
 
-puzzle({{1},{1},{1},{1},{1}},5,4)
+puzzle({"    ###########",
+        "    #          ",
+        "    #          ",
+        "    #          ",
+        "#####          "},{6,4},"bluepuzzle","none")
 
-puzzle({{0,0,0,0,1,1,1,1,1,1,1,1,1,1,1},{0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0},{0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0},{1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}},6,4)
+puzzle({"#####"},{14,8},"bluepuzzle","none")
 
-puzzle({{1,1,1,1,1}},14,8)
+puzzle({"###",
+        "  #",
+        "  #",
+        "  #",
+        "  #"},{23,4},"bluepuzzle","none")
 
-puzzle({{1,1,1},{0,0,1},{0,0,1},{0,0,1},{0,0,1}},23,4)
+puzzle({"  #  ",
+        "#####",
+        "  #  ",
+        "  #  ",
+        "  #  ",
+        "#####",
+        "  #  "},{30,3},"bluepuzzle","none")
 
-puzzle({{0,0,1,0,0},{1,1,1,1,1},{0,0,1,0,0},{0,0,1,0,0},{0,0,1,0,0},{1,1,1,1,1},{0,0,1,0,0}},30,3)
-
 --Oben
-puzzle({{1},{1},{1}},44,2)
-puzzle({{1,0},{1,2}},45,3)
-puzzle({{1},{1}},46,4)
-puzzle({{2,1},{0,1}},46,3)
+puzzle({"#",
+        "#",
+        "#"},{44,2},"bluepuzzle","none")
+puzzle({"# ",
+        "#+"},{45,3},"bluepuzzle","none")
+puzzle({"#",
+        "#"},{46,4},"bluepuzzle","none")
+puzzle({"+#",
+        " #"},{46,3},"bluepuzzle","none")
 
 --Unten
-puzzle({{1},{1},{1}},44,8)
-puzzle({{1,2},{1,0}},45,8)
-puzzle({{1},{1}},46,7)
-puzzle({{0,1},{2,1}},46,8)
+puzzle({"#",
+        "#",
+        "#"},{44,8},"bluepuzzle","none")
+puzzle({"#+",
+        "# "},{45,8},"bluepuzzle","none")
+puzzle({"#",
+        "#"},{46,7},"bluepuzzle","none")
+puzzle({" #",
+        "+#"},{46,8},"bluepuzzle","none")
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Modified: branches/1.0/data/levels/enigma_v/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/index.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_v/index.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -24,7 +24,7 @@
     <level _seq="16" _title="Draggers" _xpath="./ant21_1" author="Petr Machata" ctrl="force" easy="false" id="ant21" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="17" _title="Break and Enter" _xpath="./siegfried16_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level5b" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="18" _title="Double play" _xpath="./just06_1" author="JuSt" ctrl="force" easy="false" id="just06" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="19" _title="Oxyd-Puzzle" _xpath="./raoul05_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul05" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="19" _title="Oxyd-Puzzle" _xpath="./raoul05_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul05" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="20" _title="- Meditation -" _xpath="./ralf12_1" author="Ralf Westram" ctrl="force" easy="true" id="ralf12" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="21" _title="Plan Ahead" _xpath="./duffy114_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy114" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="22" _title="Keystone" _xpath="./raoul12_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul12" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -65,7 +65,7 @@
     <level _seq="57" _title="Too Heavy?" _xpath="./martin101_1" author="Martin Hawlisch" ctrl="force" easy="true" id="martin101" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="58" _title="Now What?" _xpath="./duffy127_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy127" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="59" _title="Pneumatic Delivery" _xpath="./malla01_1" author="Manuel K?nig" ctrl="force" easy="false" id="malla01" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="60" _title="Jumpin' Jack Flash" _xpath="./ss10_1" author="Sven Siggelkow" ctrl="force" easy="true" id="ss10" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="60" _title="Jumpin' Jack Flash" _xpath="./ss10_1" author="Sven Siggelkow" ctrl="force" easy="true" id="ss10" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="61" _title="Venice I" _xpath="./raoul16_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul16" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="62" _title="No way out?" _xpath="./just08_1" author="JuSt" ctrl="force" easy="false" id="just08" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="63" _title="Venice II" _xpath="./raoul17_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul17" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -104,7 +104,7 @@
     <level _seq="96" _title="The Chamber" _xpath="./luc31_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc31" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="97" _title="Automaton" _xpath="./duffy95_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy95" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="98" _title="Caterpillar" _xpath="./nat15_1" author="Nat Pryce" ctrl="force" easy="false" id="nat15" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="99" _title="Spacestation" _xpath="./raoul23_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul23" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="99" _title="Spacestation" _xpath="./raoul23_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul23" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="100" _title="Island Labyrinth" _xpath="./duffy129_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy129" rel="1" rev="0" score="1" target="time" unit="duration"/>
   </levels>
 

Modified: branches/1.0/data/levels/enigma_v/raoul05_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/raoul05_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_v/raoul05_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Oxyd-Puzzle" el:subtitle="" el:id="raoul05"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="raoul at users.berlios.de" el:homepage=""/>
       <el:copyright>Copyright ? 2005,2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+      <el:compatibility el:enigma="1.00">
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
       <el:comments>
@@ -70,7 +70,7 @@
 oxyd_default_flavor = "b"
 
 --RANDOM TILES FOR UPPER ROW:
-tiles={{{1,1,0},{0,1,0},{0,1,1}},{{0,1,1},{0,1,0},{1,1,0}},{{0,1,1},{1,1,0},{1,0,0}},{{1,1,0},{0,1,1},{0,0,1}},{{0,1,0},{1,1,1},{0,1,0}},{{1,1,1},{0,1,0},{0,1,0}},{{0,1,0},{0,1,0},{1,1,1}},{{1,1,1},{1,0,0},{1,0,0}},{{1,1,1},{0,0,1},{0,0,1}},{{0,1,0},{1,1,1},{1,0,0}},{{0,1,0},{1,1,1},{0,0,1}},{{1,1,0},{0,1,1},{0,1,0}},{{0,1,1},{1,1,0},{0,1,0}}}
+tiles={{"## "," # "," ##"},{" ##"," # ","## "},{" ##","## ","#  "},{"## "," ##","  #"},{" # ","###"," # "},{"###"," # "," # "},{" # "," # ","###"},{"###","#  ","#  "},{"###","  #","  #"},{" # ","###","#  "},{" # ","###","  #"},{"## "," ##"," # "},{" ##","## "," # "}}
 chosen_tiles_up={}    
 leftcorners={{4,1},{9,1},{14,1}}
 
@@ -87,15 +87,13 @@
 for fields=1,3 do
  for i=1,3 do
   for j=1,3 do
-   if chosen_tiles_up[fields][i][j]==0 then
     set_stone("st-glass2_hole",leftcorners[fields][1]+j-1,leftcorners[fields][2]+i-1)
-   end
   end
  end
 end
 
 --RANDOM TILES FOR LOWER ROW:
-tiles={{{1,1,0},{0,1,0},{0,1,1}},{{0,1,1},{0,1,0},{1,1,0}},{{1,0,0},{1,1,0},{0,1,1}},{{0,0,1},{0,1,1},{1,1,0}},{{0,1,0},{1,1,1},{0,1,0}},{{1,1,1},{0,1,0},{0,1,0}},{{0,1,0},{0,1,0},{1,1,1}},{{1,0,0},{1,0,0},{1,1,1}},{{0,0,1},{0,0,1},{1,1,1}},{{1,0,0},{1,1,1},{0,1,0}},{{0,0,1},{1,1,1},{0,1,0}},{{1,1,0},{0,1,1},{0,1,0}},{{0,1,1},{1,1,0},{0,1,0}}}
+tiles={{"## "," # "," ##"},{" ##"," # ","## "},{"#  ","## "," ##"},{"  #"," ##","## "},{" # ","###"," # "},{"###"," # "," # "},{" # "," # ","###"},{"#  ","#  ","###"},{"  #","  #","###"},{"#  ","###"," # "},{"  #","###"," # "},{"## "," ##"," # "},{" ##","## "," # "}}
 chosen_tiles_lo={}
 leftcorners={{3,9},{8,9},{13,9}}
 
@@ -112,9 +110,7 @@
 for fields=1,3 do
  for i=1,3 do
   for j=1,3 do
-   if chosen_tiles_lo[fields][i][j]==0 then
     set_stone("st-glass2_hole",leftcorners[fields][1]+j-1,leftcorners[fields][2]+i-1)
-   end
   end
  end
 end
@@ -149,37 +145,37 @@
 
 --Wrap-Funktionen
 function wrap1()
- puzzle(chosen_tiles_up[1],4,1,"red")
+ puzzle(chosen_tiles_up[1],{4,1},"redpuzzle","permutation")
  da[1]=1
  do_test()
 end
 
 function wrap2()
- puzzle(chosen_tiles_up[2],9,1,"red")
+ puzzle(chosen_tiles_up[2],{9,1},"redpuzzle","permutation")
  da[2]=1
  do_test()
 end
 
 function wrap3()
- puzzle(chosen_tiles_up[3],14,1,"red")
+ puzzle(chosen_tiles_up[3],{14,1},"redpuzzle","permutation")
  da[3]=1
  do_test()
 end
 
 function wrap4()
- puzzle(chosen_tiles_lo[1],3,9,"red")
+ puzzle(chosen_tiles_lo[1],{3,9},"redpuzzle","permutation")
  da[4]=1
  do_test()
 end
 
 function wrap5()
- puzzle(chosen_tiles_lo[2],8,9,"red")
+ puzzle(chosen_tiles_lo[2],{8,9},"redpuzzle","permutation")
  da[5]=1
  do_test()
 end
 
 function wrap6()
- puzzle(chosen_tiles_lo[3],13,9,"red")
+ puzzle(chosen_tiles_lo[3],{13,9},"redpuzzle","permutation")
  da[6]=1
  do_test()
 end

Modified: branches/1.0/data/levels/enigma_v/raoul23_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/raoul23_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_v/raoul23_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,13 +3,13 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Spacestation" el:subtitle="" el:id="raoul23"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="raoul at users.berlios.de" el:homepage=""/>
       <el:copyright>Copyright ? 2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
       <el:compatibility el:enigma="1.0">
        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="true" el:single="true" el:network="true"/>
       <el:score el:easy="-" el:difficult="7:29"/>
@@ -239,16 +239,24 @@
 -- "Things":
 function set_thing(x,y,init)
     if init==1 then
-        puzzle({{1,2,1},{1,0,1},{1,1,1}},x,y,"blue","no")
+        puzzle({"#+#",
+                "# #",
+                "###"},{x,y},"bluepuzzle","none")
         set_stone("st-puzzle-hollow",x+1,y)
     elseif init==2 then
-        puzzle({{1,1,1},{1,0,2},{1,1,1}},x,y,"blue","no")
+        puzzle({"###",
+                "# +",
+                "###"},{x,y},"bluepuzzle","none")
         set_stone("st-puzzle-hollow",x+2,y+1)
     elseif init==3 then
-        puzzle({{1,1,1},{1,0,1},{1,2,1}},x,y,"blue","no")
+        puzzle({"###",
+                "# #",
+                "#+#"},{x,y},"bluepuzzle","none")
         set_stone("st-puzzle-hollow",x+1,y+2)
     elseif init==4 then    
-        puzzle({{1,1,1},{2,0,1},{1,1,1}},x,y,"blue","no")
+        puzzle({"###",
+                "+ #",
+                "###"},{x,y},"bluepuzzle","none")
         set_stone("st-puzzle-hollow",x,y+1)
     end
 end

Modified: branches/1.0/data/levels/enigma_v/ss10_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/ss10_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_v/ss10_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Jumpin' Jack Flash" el:subtitle="" el:id="ss10"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Sven Siggelkow" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2003 Sven Siggelkow</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -34,7 +34,7 @@
       elseif c=="h" then
          set_item("it-hollow", i-1,line,{essential=1})
       elseif c=="b" then
-         if difficult==FALSE then
+         if not difficult then
       set_item("it-spade", i-1,line)
          end
       elseif c=="G" then

Modified: branches/1.0/data/levels/enigma_vi/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/index.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_vi/index.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -30,7 +30,7 @@
     <level _seq="22" _title="Edwards Second Level" _xpath="./edward02_1" author="Edward" ctrl="force" easy="false" id="edward02" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="23" _title="Prepare Your Defense" _xpath="./duffy132_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy132" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="24" _title="The Stable" _xpath="./andreas30_1" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas30" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="25" _title="Oxydrings" _xpath="./raoul13_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul13" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="25" _title="Oxydrings" _xpath="./raoul13_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul13" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="26" _title="Dialers" _xpath="./edward05_1" author="Edward" ctrl="force" easy="true" id="edward05" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="27" _title="Persecution Mania" _xpath="./ral12_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060911ral294" rel="1" rev="34" score="1" target="time" unit="duration"/>
     <level _seq="28" _title="Holes!" _xpath="./edward14_1" author="Edward" ctrl="force" easy="false" id="edward14" rel="1" rev="1" score="1" target="time" unit="duration"/>
@@ -66,7 +66,7 @@
     <level _seq="58" _title="- Meditation -" _xpath="./raoul18_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul18" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="59" _title="Pool with a pole" _xpath="./alain28_1" author="Alain Busser" ctrl="force" easy="false" id="alain28" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="60" _title="- Meditation -" _xpath="./edward30_1" author="Edward" ctrl="force" easy="true" id="edward30" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="61" _title="Puzzle Puzzles" _xpath="./raoul26_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul26" rel="1" rev="22" score="1" target="time" unit="duration"/>
+    <level _seq="61" _title="Puzzle Puzzles" _xpath="./raoul26_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul26" rel="1" rev="23" score="1" target="time" unit="duration"/>
     <level _seq="62" _title="Tarzan" _xpath="./ulf03_1" author="Ulf Stegemann" ctrl="force" easy="true" id="20060629ulf003" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="63" _title="Houdini" _xpath="./ral11_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060816ral719" rel="1" rev="45" score="1" target="time" unit="duration"/>
     <level _seq="64" _title="Walk the line" _xpath="./erich02_1" author="Erich Schubert" ctrl="force" easy="true" id="erich02" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_vi/raoul13_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/raoul13_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_vi/raoul13_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Oxydrings" el:subtitle="" el:id="raoul13"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="raoul at users.berlios.de" el:homepage=""/>
       <el:copyright>Copyright ? 2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
       <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
       <el:comments>
@@ -71,7 +71,16 @@
 oxyd_shuffle()
 
 -- RINGS --
-puzzle({{1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1},{1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1},{1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1},{1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1},{0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0},{0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0},{1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1},{1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1},{1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1},{1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1}},2,2,"blue","no")
+puzzle({"####         ####",
+        "#  #         #  #",
+        "#  ###########  #",
+        "####         ####",
+        "  #           #  ",
+        "  #           #  ",
+        "####         ####",
+        "#  ###########  #",
+        "#  #         #  #",
+        "####         ####"},{2,2},"bluepuzzle","none")
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Modified: branches/1.0/data/levels/enigma_vi/raoul26_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/raoul26_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/enigma_vi/raoul26_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Puzzle Puzzles" el:subtitle="look forward!" el:id="raoul26"/>
-      <el:version el:score="1" el:release="1" el:revision="22" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="23" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
       <el:compatibility el:enigma="1.0">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="true" el:single="true" el:network="false"/>
       <el:comments>
@@ -281,23 +281,33 @@
 end
 ---- PUZZLES ----
   -- W
-  puzzle({{0,1,1},{1,1,0},{1,0,0}},23,6,"blue","no")
+  puzzle({" ##",
+          "## ",
+          "#  "},{23,6},"bluepuzzle","none")
   -- Z
-  puzzle({{0,1,1},{0,2,0},{1,1,0}},32,18,"blue","no")
+  puzzle({" ##",
+          " + ",
+          "## "},{32,18},"bluepuzzle","none")
   set_stone("st-puzzle-hollow",33,19)
   -- shell_lower_part
-  shuffle_method="permutation"
-  puzzle({{1,1,0,1,1},{0,1,1,1,0},{0,0,1,0,0}},31,31,"blue","yes")
+  puzzle({"## ##",
+          " ### ",
+          "  #  "},{31,31},"bluepuzzle","permutation")
   -- shell_upper_part
-  puzzle({{0,1,0},{1,1,1}},32,29,"blue","yes")
+  puzzle({" # ",
+          "###"},{32,29},"bluepuzzle","permutation")
   -- -
-  puzzle({{1,2,1}},34,3,"blue","no")
+  puzzle({"#+#"},{34,3},"bluepuzzle","none")
   set_stone("st-puzzle-hollow",35,3)
   -- |
-  puzzle({{1},{2},{1}},33,2,"blue","no")
+  puzzle({"#",
+          "+",
+          "#"},{33,2},"bluepuzzle","none")
   set_stone("st-puzzle-hollow",33,3)
   -- T
-  puzzle({{0,0,1},{1,2,1},{0,0,1}},33,7,"blue","no")
+  puzzle({"  #",
+          "#+#",
+          "  #"},{33,7},"bluepuzzle","none")
   set_stone("st-puzzle-hollow",34,8)
 
 ---- ITEMS ----

Added: branches/1.0/data/levels/lib/libflood_1.xml
===================================================================
--- branches/1.0/data/levels/lib/libflood_1.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/lib/libflood_1.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -0,0 +1,371 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="library">
+      <el:identity el:title="" el:id="lib/libflood"/>
+      <el:version el:score="1" el:release="1" el:revision="5" el:status="released"/>
+      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2007 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="false" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+-- REFERENCE --
+---------------
+-- Used Globals:
+-- land_map
+-- top_left
+-- flood_method
+-- flood_map
+-- flood_front
+-- to_flood
+
+-- Defaults:
+land_map = {"~"}
+top_left = {0,0}
+flood_method = 1
+
+function init_flood(new_map, corner, method)
+    land_map = new_map
+    top_left = corner
+    flood_method = method
+
+    -- Is the map bigger than 0 x 0 ?
+    local x, y = get_map_size(land_map)
+    if x < 1 or y < 1 then
+        error("init_flood(new_map, corner): Map "..tostring(x).." x "..tostring(y).." is too small!\n")
+    end
+    -- Is the map rectangular?
+    is_rectangular()
+    -- Test top_left for valid koordinates
+    if top_left[1] <= 0 or top_left[2] <= 0 then
+        error("init_flood(new_map, corner): Invalid value for top left map corner! "..tostring(top_left[1])..";"..tostring(top_left[2]).."\n")
+    end
+    if flood_method ~= 1 and flood_method ~= 2 then
+        error("init_flood(new_map, corner, method): Invalid value for method: "..tostring(method).."! Values are [1,2].\n")
+    end
+
+    -- Build up the flood_map table.
+    build_up_flood_map(land_map)
+    -- Build up the data for a new flood_front.
+    new_flood_front()
+    search_initial_water()
+    -- Now draw the initial waterspots.
+    flood_it(flood_front,top_left)
+    return 0
+end
+
+function do_flood()
+    -- Create a new global to_flood.
+    new_to_flood()
+    -- Iterate over all elements in flood_front to find the tiles, we have to flood.
+    local flood_front_size = table.getn(flood_front)
+    local k,v
+    for k,v in pairs(flood_front) do
+        local akt_pos = flood_front[k]
+        if flood_method == 1 then
+            examine_field_nesw(akt_pos[1], akt_pos[2])
+        elseif flood_method == 2 then
+            examine_field_all8(akt_pos[1], akt_pos[2])
+        end
+    end
+    -- Write the to_flood to flood_front.
+    clear_flood_front()
+    copy_to_flood_to_flood_front()
+    -- We don't need to update the flood_map, because we updated it in
+    -- examine_field_neighbour(x,y). This improves performance a big bit!
+    --update_flood_map()
+    -- FLOOD !
+    flood_it(to_flood,top_left)
+    return 0
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+-- Get the dimensions of the land_map:
+function get_map_size(land_map)
+    local y_size=table.getn(land_map)
+    local x_size=string.len(land_map[1])
+    return x_size, y_size
+end
+
+-- Get the dimensions of the flood_map:
+function get_flood_map_size(flood_map)
+    local y_size=table.getn(flood_map)
+    local x_size=table.getn(flood_map[1])
+    return x_size, y_size
+end
+
+function is_inside_map(x,y)
+    -- Test, if x and y are inside the flood_map. If no, raise an error.
+    local x_size, y_size = get_flood_map_size(flood_map)
+    if x > x_size then
+        error("is_inside_map(x,y): x is not inside the map! "..tostring(x).."\n")
+    end
+    if y > y_size then
+        error("is_inside_map(x,y): y is not inside the map! "..tostring(y).."\n")
+    end
+end
+
+function is_on_border(x,y)
+    -- Test, if x and y are on the flood_map border.
+    local x_size, y_size = get_flood_map_size(flood_map)
+    local on_x, on_y = 0, 0
+    -- Is x on a border?
+    if x == 1 then
+        -- is on left border
+        on_y = 1
+    elseif x == x_size then
+        -- is on right border
+        on_y = 2
+    end
+    -- Is y on a border?
+    if y == 1 then
+        -- is on top border
+        on_x = 1
+    elseif y == y_size then
+        -- is on bottom border
+        on_x = 2
+    end
+    return on_x, on_y
+end
+
+function is_rectangular()
+    local x_size, y_size = get_map_size(land_map)
+    -- Length of the first line in the map:
+    local buffer = string.len(land_map[1])
+    local i, temp
+    for i=1, y_size do
+        temp = string.len(land_map[i])
+        if temp ~= buffer then
+            error("is_rectangular(): Map in not rectangular!\n")
+        end
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+function get_specific_char(x,y)
+    local akt_line = land_map[y]
+    local this_char = string.sub(akt_line,x,x)
+    return this_char
+end
+
+function parse_this_char(akt_char)
+    if akt_char == "#" then
+        return 0
+    elseif akt_char == " " then
+        return 1
+    elseif akt_char == "~" then
+        return 2
+    else
+        error("parse_this_char(akt_char): Illegal char \""..akt_char.."\" in the map! Valid chars are: [#, ,~].\n")
+    end
+end
+
+function build_up_flood_map(land_map)
+    -- new global:
+    flood_map={}
+    local x_size, y_size = get_map_size(land_map)
+    -- build up the flood_map table:
+    local i,j
+    for i=1, y_size do
+        -- each line is a table:
+        flood_map[i]={}
+        for j=1, x_size do
+            local akt_char = get_specific_char(j,i)
+            flood_map[i][j] = parse_this_char(akt_char)
+        end
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+function modify_flood_map(x,y,type)
+    is_inside_map(x,y)
+    -- type valid?
+    if type ~= 0 and type ~= 1 and type ~= 2 then
+        error("modify_flood_map(x,y,type): Illegal type! "..tostring(type).."\n")
+    end
+    flood_map[y][x] = type
+    return 0
+end
+--------------------------------------------------------------------------------
+function new_flood_front()
+    -- new global:
+    flood_front = {}
+    return 0
+end
+
+function add_to_flood_front(x,y)
+    local this_pos = {x,y}
+    table.insert(flood_front,this_pos)
+    return 0
+end
+--------------------------------------------------------------------------------
+function search_initial_water()
+    local x_size, y_size = get_flood_map_size(flood_map)
+    local has_any_water = 0
+    local i,j
+    for i=1, y_size do
+        for j=1, x_size do
+            if flood_map[i][j] == 2 then
+                has_any_water = has_any_water+1
+                add_to_flood_front(j,i)
+            end
+        end
+    end
+    if has_any_water == 0 then
+        error("search_initial_water(): No Water found! Please set at least 1 Water tile!\n")
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+function new_to_flood()
+    -- new global:
+    to_flood = {}
+    return 0
+end
+
+function add_to_flood(x,y)
+    local this_pos = {x,y}
+    table.insert(to_flood,this_pos)
+    return 0
+end
+--------------------------------------------------------------------------------
+---F-L-O-O-D---M-E-T-H-O-D-S----------------------------------------------------
+-- Method 1:
+function examine_field_nesw(x,y)
+    -- Check, if x or y is out of the flood_map bounds
+    is_inside_map(x,y)
+
+    local x_border, y_border = is_on_border(x,y)
+    -- NORTH
+    if x_border ~= 1 then
+        examine_field_neighbour(x,y-1)
+    end
+    -- EAST
+    if y_border ~= 2 then
+        examine_field_neighbour(x+1,y)
+    end
+    -- SOUTH
+    if x_border ~= 2 then
+        examine_field_neighbour(x,y+1)
+    end
+    -- WEST
+    if y_border ~= 1 then
+        examine_field_neighbour(x-1,y)
+    end
+    return 0
+end
+
+-- Method 2:
+function examine_field_all8(x,y)
+    -- Check, if x or y is out of the flood_map bounds
+    is_inside_map(x,y)
+
+    local x_border, y_border = is_on_border(x,y)
+    -- NORTH
+    if x_border ~= 1 then
+        examine_field_neighbour(x,y-1)
+        if y_border ~= 1 then
+            examine_field_neighbour(x-1,y-1)
+        end
+        if y_border ~= 2 then
+            examine_field_neighbour(x+1,y-1)
+        end
+    end
+    -- EAST
+    if y_border ~= 2 then
+        examine_field_neighbour(x+1,y)
+    end
+    -- SOUTH
+    if x_border ~= 2 then
+        examine_field_neighbour(x,y+1)
+        if y_border ~= 1 then
+            examine_field_neighbour(x-1,y+1)
+        end
+        if y_border ~= 2 then
+            examine_field_neighbour(x+1,y+1)
+        end
+    end
+    -- WEST
+    if y_border ~= 1 then
+        examine_field_neighbour(x-1,y)
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+function examine_field_neighbour(x,y)
+    -- What sort of floor is the examined position?
+    if flood_map[y][x] == 0 then
+        -- DEBUG:
+        --print("Stone found at: "..tostring(x)..";"..tostring(y).."\n")
+    elseif flood_map[y][x] == 1 then
+        -- the only case we have to do something
+        -- DEBUG:
+        --print("Floodable ground found at: "..tostring(x)..";"..tostring(y).."\n")
+        add_to_flood(x,y)
+        -- Mark field as flooded in flood_map here will improve performance!!
+        modify_flood_map(x, y, 2)
+    elseif flood_map[y][x] == 2 then
+        -- DEBUG:
+        --print("Water found at: "..tostring(x)..";"..tostring(y).."\n")
+    -- If there are more possibilities, add more elseifs here.
+    -- We need no default-error, because flood_map IS clean.
+    -- Errors were detected in parse_this_char().
+    end
+end
+--------------------------------------------------------------------------------
+function clear_flood_front()
+    -- Just recreate the var.
+    new_flood_front()
+    return 0
+end
+
+function copy_to_flood_to_flood_front()
+    local tab_size = table.getn(to_flood)
+    for i=1, tab_size do
+        local temp = to_flood[i]
+        local temp_x = temp[1]
+        local temp_y = temp[2]
+        add_to_flood_front(temp_x,temp_y)
+    end
+    return 0
+end
+
+-- Fill the flood_map with the additional flooded fields. This is obsolete since
+-- we add the fields just when they are detected.
+function update_flood_map()
+    local tab_size = table.getn(flood_front)
+    for i=1, tab_size do
+        local temp = to_flood[i]
+        local temp_x = temp[1]
+        local temp_y = temp[2]
+        modify_flood_map(temp_x, temp_y, 2)
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+function flood_it(map,top_left)
+    local k, v
+    for k,v in pairs(map) do
+        local akt_pos = map[k]
+        set_floor("fl-water", top_left[1]+akt_pos[1]-1, top_left[2]+akt_pos[2]-1)
+    end
+end
+--------------------------------------------------------------------------------
+---E--N--D------O--F------L--I--B--F--L--O--O--D--------------------------------
+--------------------------------------------------------------------------------
+    ]]></el:luamain>
+    <el:i18n>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/lib/libflood_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/lib/libpuzzle_2.xml
===================================================================
--- branches/1.0/data/levels/lib/libpuzzle_2.xml	2007-01-14 20:16:58 UTC (rev 575)
+++ branches/1.0/data/levels/lib/libpuzzle_2.xml	2007-01-14 21:50:47 UTC (rev 576)
@@ -0,0 +1,641 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="library">
+      <el:identity el:title="" el:id="lib/libpuzzle"/>
+      <el:version el:score="2" el:release="2" el:revision="2" el:status="released"/>
+      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2005, 2006, 2007 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="false" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- LIBPUZZLE, VERSION 2
+--
+-- Parameters:
+-- map: a charmap with the puzzle
+-- corner: top left corner, array {x,y}
+-- type: type of stone to use, one of these: "redpuzzle","bluepuzzle","bigbrick" or "bigbluesand"
+-- shuffle: shuffle method, one of these: "none","random" or "permutation"
+--
+-- Globals:
+-- puzzle_map: the arraymap with the puzzle layout.
+-- parttable: the array with the parts.
+-- part_map: map with the parts stored in it.
+-- permutations: struct with all permutationdata.
+--
+-- DEFAULT VALUES:
+-- map = {"###",
+--        "# #",
+--        "###"}
+--
+-- corner = {0,0}
+-- 
+-- type = "redpuzzle"
+-- 
+-- shuffle = "none"
+--
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+-- Wrapper to set a puzzle
+function puzzle(map, corner, type, shuffle)
+    -- Are all parameters set?
+    -- If no, set the default for the missing ones.
+    if map == nil then
+        map = {"###","# #","###"}
+    end
+    if corner == nil then
+        corner = {0,0}
+    end
+    if type == nil then
+        type = "redpuzzle"
+    end
+    if shuffle == nil then
+        shuffle = "none"
+    end
+
+    -- IS THE map VALID?
+    -- Is the map bigger than 0 x 0 ?
+    local x, y = get_charmap_size(map)
+    if x < 1 or y < 1 then
+        error("puzzle(map, corner, type, shuffle): Map "..tostring(x).." x "..tostring(y).." is too small!\n")
+    end
+    -- Is the map rectangular?
+    is_rectangular(map)
+    -- If there is no error until here, the map is ok
+    -- IS THE corner VALID?
+    if corner[1] < 0 or corner[2] < 0 then
+        error("puzzle(map, corner, type, shuffle): Invalid value for top left map corner! "..tostring(corner[1])..";"..tostring(corner[2])..". It has to be >= (0;0).\n")
+    end
+    -- IS THE type VALID?
+    local stone_type = is_valid_type(type)
+    -- IS VALID shuffle?
+    local shuffle_method = is_valid_shuffle(shuffle)
+
+    -- If there is no error until here, all parameters are ok
+    -- Beginn with the work.
+
+    -- Parse the charmap to a table:
+    parse_map(map)
+
+    -- Get the parts:
+    get_parts(puzzle_map)
+
+    -- Determine the shuffle method to use.
+    if shuffle_method == 1 then
+        shuffle_parts_with_noshuffle()
+    elseif shuffle_method == 2 then
+        shuffle_parts_with_random()
+    elseif shuffle_method == 3 then
+        shuffle_parts_with_permutation()
+    end
+
+    plot_puzzle(corner,stone_type)
+    return 0
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+-- Helper functions --
+function get_array_size(array)
+    local its_size = table.getn(array)
+    return its_size
+end
+
+function get_charmap_size(map)
+    local y_size = table.getn(map)
+    local x_size = string.len(map[1])
+    return x_size, y_size
+end
+
+function get_arraymap_size(map)
+    local y_size = table.getn(map)
+    local x_size = table.getn(map[1])
+    return x_size, y_size
+end
+
+function is_inside_map(x,y)
+    local x_size, y_size = get_arraymap_size(puzzle_map)
+    if x < 0 or x > x_size then
+        error("is_inside_map(x,y): x is not inside of the map! "..tostring(x))
+    end
+    if y < 0 or y > y_size then
+        error("is_inside_map(x,y): y is not inside of the map! "..tostring(y))
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+-- Security functions --
+function is_rectangular(map)
+    local x_size, y_size = get_charmap_size(map)
+    -- Length of the first line in the map:
+    local buffer = string.len(map[1])
+    local i
+    for i=1, y_size do
+        local temp = string.len(map[i])
+        if temp ~= buffer then
+            error("puzzle(map, corner, type, shuffle): Map in not rectangular!\n")
+        end
+    end
+    return 0
+end
+
+function is_valid_type(type)
+    local stone
+    if type == "redpuzzle" then
+        stone = "st-puzzle2"
+    elseif type == "bluepuzzle" then
+        stone = "st-puzzle"
+    elseif type == "bigbrick" then
+        stone = "st-bigbrick"
+    elseif type == "bigbluesand" then
+        stone = "st-bigbluesand"
+    else
+        error("puzzle(map, corner, type, shuffle): Invald type \""..tostring(type).."\"! It has to be one of these types: \"redpuzzle\",\"bluepuzzle\",\"bigbrick\" or \"bigbluesand\".")
+    end
+    return stone
+end
+
+function is_valid_shuffle(shufflemethod)
+    local method
+    if shufflemethod == "none" then
+        method = 1
+    elseif shufflemethod == "random" then
+        method = 2
+    elseif shufflemethod == "permutation" then
+        method = 3
+    else
+        error("puzzle(map, corner, type, shuffle): Invald shuffle \""..tostring(shufflemethod).."\"! It has to be one of these methodes: \"none\",\"random\" or \"permutation\".")
+    end
+    return method
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+-- Create new, empty map for the puzzle layout:
+function new_puzzlemap(x_size, y_size)
+    -- new global:
+    puzzle_map = {}
+    local i, j = 0,0
+    for i=1, y_size do
+        -- each element of puzzlemap is an array:
+        puzzle_map[i] = {}
+        for j=1, x_size do
+            modify_puzzle_map(j,i,0)
+        end
+    end
+    return 0
+end
+
+function modify_puzzle_map(x,y,type)
+    puzzle_map[y][x] = type
+    return 0
+end
+--------------------------------------------------------------------------------
+-- functions for parsing the original map --
+function get_specific_char(map,x,y)
+    local akt_line = map[y]
+    local this_char = string.sub(akt_line,x,x)
+    return this_char
+end
+
+function parse_this_char(akt_char)
+    if akt_char == " " then
+        -- this is no piece
+        return 0
+    elseif akt_char == "#" then
+        -- this is a piece
+        return 1
+    elseif akt_char == "+" then
+        -- this is a pseudo piece
+        return 2
+    else
+        error("puzzle(map, corner, type, shuffle): Illegal char \""..akt_char.."\" in the map! Char must be one of these: \" \" = no piece, \"#\"= piece or \"+\"= pseudo-piece.")
+    end
+end
+
+function parse_map(charmap)
+    local x_size, y_size = get_charmap_size(charmap)
+    -- Create a new puzzle_map with the right dimensions.
+    new_puzzlemap(x_size, y_size)
+
+    local i, j
+    for i=1, y_size do
+        for j=1, x_size do
+            local akt_char = get_specific_char(charmap,j,i)
+            local puzzle_type = parse_this_char(akt_char)
+            modify_puzzle_map(j,i,puzzle_type)
+        end       
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+function is_on_border(x,y)
+    -- Test, if x and y are on the flood_map border.
+    local x_size, y_size = get_arraymap_size(puzzle_map)
+    local on_left, on_right, on_top, on_bottom = 0, 0, 0, 0
+    -- Is x on a border?
+    if x == 1 then
+        -- is on left border
+        on_left = 1
+    end
+    if x == x_size then
+        -- is on right border
+        on_right = 1
+    end
+    -- Is y on a border?
+    if y == 1 then
+        -- is on top border
+        on_top = 1
+    end
+    if y == y_size then
+        -- is on bottom border
+        on_bottom = 1
+    end
+    return on_left, on_right, on_top, on_bottom
+end
+--------------------------------------------------------------------------------
+-- Create a new, empty table with the parts needed.
+function new_parttable()
+    -- new Global:
+    parttable = {}
+    return 0
+end
+
+function add_to_parttable(part)
+    table.insert(parttable, part)
+    return 0
+end
+
+function has_piece(x,y)
+    -- There is a piece @ x,y
+    if puzzle_map[y][x] == 1 then
+        return true
+    end
+    return false -- no piece found
+end
+
+function has_piece_or_pseudopiece(x,y)
+    -- There is a piece OR pseude piece @ x,y
+    if puzzle_map[y][x] == 1 or puzzle_map[y][x] == 2 then
+        return true
+    end
+    return false -- no piece found
+end
+
+function examine_pos(x,y)
+    local north = ""
+    local east = ""
+    local south = ""
+    local west = ""
+    local part_buffer = ""
+
+    local left, right, top, bottom = is_on_border(x,y)
+    -- NORTH
+    if top ~= 1 then
+        if has_piece_or_pseudopiece(x,y-1) then north = "n" end
+    end
+    -- EAST
+    if right ~= 1 then
+        if has_piece_or_pseudopiece(x+1,y) then east = "e" end
+    end
+    -- SOUTH
+    if bottom ~= 1 then
+        if has_piece_or_pseudopiece(x,y+1) then south = "s" end
+    end
+    -- WEST
+    if left ~= 1 then 
+        if has_piece_or_pseudopiece(x-1,y) then west = "w" end
+    end
+
+    -- To get a valid Stone if no neighbours were present, we define it as the
+    -- (untunneled) cross ("nesw")
+    if north == "" and east == "" and south == "" and west == "" then
+        north = "n"
+        east = "e"
+        south = "s"
+        west = "w"
+    end
+    
+    part_buffer = north..east..south..west
+    return part_buffer
+end
+
+-- Get the parts needed
+function get_parts(map)
+    new_parttable()
+
+    local x_size, y_size = get_arraymap_size(map)
+    local i, j = 0, 0
+    local part = ""
+    -- Examine where the piece @ x,y has to have connections
+    for i=1, y_size do
+        for j=1, x_size do
+            -- Examine the position only, if there is a part on it!
+            if has_piece(j,i) then
+                part = examine_pos(j,i)
+                add_to_parttable(part)
+            end
+        end
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+-- New map with the kind of all parts at their location in the puzzle
+function new_partmap()
+    -- New Global:
+    part_map = {}
+
+    local x_size, y_size = get_arraymap_size(puzzle_map)
+    local part_counter = 1
+    local i,j = 0,0
+    for i=1, y_size do
+        -- each element of partmap is an array:
+        part_map[i] = {}
+        for j=1, x_size do
+            if has_piece(j,i) then
+                part_map[i][j] = parttable[part_counter]               
+                part_counter = part_counter+1
+            else 
+                part_map[i][j] = "-"
+            end
+        end
+    end
+    return 0
+end
+
+function add_to_partmap(x,y,part)
+    part_map[y][x]=part
+    return 0
+end
+
+function shift_cell(cell,dir)
+-- Move the value of parttable[cell] into direction vector dir.
+    local cell_value = part_map[cell[2]][cell[1]]
+    add_to_partmap(cell[1]+dir[1], cell[2]+dir[2],cell_value)
+    return 0
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+-- Shuffle with the random method
+function shuffle_parts_with_noshuffle()
+    -- Create the part_map with the unshuffled parts.
+    new_partmap()
+    return 0
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+-- Shuffle with the random method
+function swap_parts(k,l)
+    parttable[l], parttable[k] = parttable[k], parttable[l]
+    return 0
+end
+
+function shuffle_parts_with_random()
+
+    local number_swaps = 0
+    local number_parts = get_array_size(parttable)
+    number_swaps = number_parts + math.random(1,number_parts)
+
+    local i = 0
+    for i=1, number_swaps do
+        local r = math.random(1, number_parts)
+        local s = math.random(1, number_parts)
+        swap_parts(r,s)
+    end
+
+    -- Create the part_map with the shuffled parts.
+    new_partmap()
+    return 0
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+-- Shuffle with the permutation method
+function new_permutation_table()
+    -- New Global:
+    permutations = {}
+    return 0
+end
+
+function add_permutation(start, stop)
+    local temp = {{start[1],start[2]},{stop[1],stop[2]}}
+    table.insert(permutations,temp)
+    return 0
+end
+
+function get_permutation_size(array,start)
+    local size_counter = 1
+    -- As long as there are pieces in the line to scan, go on
+    while array[start+size_counter]==1 do
+        size_counter = size_counter+1
+    end
+    return size_counter
+end
+
+-- Scan row 
+function scan_row(row)
+    -- Create a temporary array with the row to scan.
+    local akt_row = puzzle_map[row]
+    local perm_size = 0
+    local i = 1
+    
+    while i <= table.getn(akt_row) do
+    -- We dont need to test the last element ... so i < ...
+        -- If there as a piece at position pos, examine how many pieces will follow
+        if has_piece(i,row) then     
+            perm_size = get_permutation_size(akt_row,i)
+            
+            if perm_size > 1 then
+            -- We have a real permutation (2 or more pieces in a row)
+            -- and not only one single piece.
+                add_permutation({i,row},{i+perm_size-1,row})
+                -- Go on after all the pieces found + 1 gap element.
+                -- If there would be a piece in the gap, the perm_size would be
+                -- one element bigger ...
+                -- The gap element is added below, so we can just increment i
+                -- in every loop.
+                i = i + perm_size --+1
+            end
+        end
+        i = i+1
+    end
+    return 0
+end
+
+-- Scan column
+function scan_col(col)
+    -- Create a temporary array with the column to scan.
+    local akt_col = {}
+    local k = 0
+    for k=1, table.getn(puzzle_map) do
+        akt_col[k] = puzzle_map[k][col]
+    end
+
+    local perm_size = 0
+    local i = 1
+     
+    while i <= table.getn(akt_col) do
+    -- We dont need to test the last element ... so i < ...
+        -- If there as a piece at position pos, examine how many pieces will follow
+        if has_piece(col,i) then     
+            perm_size = get_permutation_size(akt_col,i)
+            
+            if perm_size > 1 then
+            -- We have a real permutation (2 or more pieces in a row)
+            -- and not only one single piece.
+                add_permutation({col,i},{col,i+perm_size-1})
+                -- Go on after all the pieces found + 1 gap element.
+                -- If there would be a piece in the gap, the perm_size would be
+                -- one element bigger ...
+                -- The gap element is added below, so we can just increment i
+                -- in every loop.
+                i = i + perm_size --+1
+            end
+        end
+        i = i+1
+    end
+    return 0
+end
+
+function scan_puzzle_for_permutations()
+    -- Create a new table which will contain all permutations found
+    new_permutation_table()
+
+    local x_size, y_size = get_arraymap_size(puzzle_map)
+
+    local i, j = 0, 0
+    -- Scan the puzzle row for row for permutations
+    for i=1, y_size do
+        scan_row(i)
+    end
+    -- Scan the puzzle column for column for permutations
+    for j=1, x_size do
+        scan_col(j)
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+function is_horizontal(n)
+    -- Is the permutation horizontal or not?
+    -- y_start is same as y_stop?
+    if permutations[n][1][2] == permutations[n][2][2] then
+        return true
+    else
+        return false
+    end
+end
+
+function use_permutation(n)
+-- Use a specific permutation n
+    -- The data of the permutation n
+    local akt_permutation = permutations[n]
+    local akt_permutation_start = akt_permutation[1]
+    local akt_permutation_stop = akt_permutation[2]
+
+    -- Buffer for the last element
+    local last_element_buffer
+    -- Size of the used permutation
+    local permutation_size = 0
+
+    if is_horizontal(n) then
+    -- The permutation we use is a horizontal one.
+        last_element_buffer = part_map[akt_permutation_stop[2]][akt_permutation_stop[1]]
+        permutation_size = akt_permutation_stop[1]-akt_permutation_start[1]+1
+        
+        local i = akt_permutation_stop[1]-1
+        while i >= akt_permutation_start[1] do
+            shift_cell({i,akt_permutation_start[2]},{1,0})
+            i = i-1
+        end
+
+        add_to_partmap(akt_permutation_start[1],akt_permutation_start[2],last_element_buffer)
+    else
+    -- The permutation we use is a vertical one.
+        last_element_buffer = part_map[akt_permutation_stop[2]][akt_permutation_stop[1]]
+        permutation_size = akt_permutation_stop[2]-akt_permutation_start[2]+1
+        
+        local i = akt_permutation_stop[2]-1
+        while i >= akt_permutation_start[2] do
+            shift_cell({akt_permutation_start[1],i},{0,1})
+            i = i-1
+        end
+
+        add_to_partmap(akt_permutation_start[1],akt_permutation_start[2],last_element_buffer)
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+function shuffle_parts_with_permutation()
+    -- New map with the parts in their proper location.
+    new_partmap()
+
+    -- Scan the puzzle for all possible permutations.
+    scan_puzzle_for_permutations()
+
+    -- How many puzzlestones are in the current cluster?
+    local anz_pieces = table.getn(parttable)
+
+    -- How many permutation we have?
+    local anz_permutations = table.getn(permutations)
+
+    if anz_permutations > 0 then
+        local num_permutations_to_do = anz_permutations + math.random(1,anz_pieces)
+        local i = 0
+        for i=1, num_permutations_to_do do
+            r = math.random(1,anz_permutations)
+            use_permutation(r)
+        end
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
+--[[function translate_type(type)
+    local translate_table =
+    {w =    "0001",
+     s =    "0010",
+     sw=    "0011",
+     e =    "0100",
+     ew =   "0101",
+     es =   "0110",
+     esw =  "0111",
+     n =    "1000",
+     nw =   "1001",
+     ns =   "1010",
+     nsw =  "1011",
+     ne =   "1100",
+     new =  "1101",
+     nes =  "1110",
+     nesw = "1111"}
+    return translate_table[type]
+end]]
+
+function plot_puzzle(corner,stone_type)
+    local x_size, y_size = get_arraymap_size(puzzle_map)
+    local i = 0
+
+    for i=1, y_size do
+        for j=1, x_size do
+            if has_piece(j,i) then
+                -- Do not use this, because not all stones support this until now.
+                --local sockets = translate_type(part_map[i][j])
+                set_stone(stone_type.."-"..part_map[i][j],corner[1]+j-1,corner[2]+i-1,{})
+            end
+        end
+    end
+    return 0
+end
+--------------------------------------------------------------------------------
+---E--N--D------O--F------L--I--B--P--U--Z--Z--L--E------------------------------
+--------------------------------------------------------------------------------
+    ]]></el:luamain>
+    <el:i18n>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/lib/libpuzzle_2.xml
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:eol-style
   + native



From raoul at mail.berlios.de  Mon Jan 15 17:37:03 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Mon, 15 Jan 2007 17:37:03 +0100
Subject: [Enigma-game-svn] r577 - in branches/1.0/data/levels:
	enigma_experimental enigma_v lib
Message-ID: <200701151637.l0FGb3kj029476@sheep.berlios.de>

Author: raoul
Date: 2007-01-15 17:37:02 +0100 (Mon, 15 Jan 2007)
New Revision: 577

Modified:
   branches/1.0/data/levels/enigma_experimental/index.xml
   branches/1.0/data/levels/enigma_experimental/puzzle_demo_2.xml
   branches/1.0/data/levels/enigma_experimental/puzzle_testarea_1.xml
   branches/1.0/data/levels/enigma_v/index.xml
   branches/1.0/data/levels/enigma_v/raoul05_1.xml
   branches/1.0/data/levels/enigma_v/raoul12_1.xml
   branches/1.0/data/levels/lib/libpuzzle_2.xml
Log:
-> raoul05 and raoul12 changes to use libpuzzle v2
-> Added a feature to libpuzzle v2 to make it suitable for andreas34



Modified: branches/1.0/data/levels/enigma_experimental/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/index.xml	2007-01-14 21:50:47 UTC (rev 576)
+++ branches/1.0/data/levels/enigma_experimental/index.xml	2007-01-15 16:37:02 UTC (rev 577)
@@ -13,7 +13,7 @@
     <level _seq="5" _title="Template 3" _xpath="./template3" author="AUTHOR" ctrl="force" easy="false" id="template3" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="6" _title="Impulstest" _xpath="./testimpulses" author="Enigma Team" ctrl="force" easy="false" id="testimpulses" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="7" _title="Wolf Among Sheep" _xpath="./wolfamongsheep" author="illmind" ctrl="force" easy="false" id="wolfamongsheep" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="8" _title="Puzzle Labor" _xpath="./puzzle_testarea_1" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_testarea" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="8" _title="Puzzle Labor" _xpath="./puzzle_testarea_1" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_testarea" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="9" _title="Puzzle Demo" _xpath="./puzzle_demo_2" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_demo" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="10" _title="All Items" _xpath="./items" author="Raoul Bourquin" ctrl="force" easy="false" id="items" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="11" _title="Impossible?" _xpath="./wb2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb2_exp" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_experimental/puzzle_demo_2.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/puzzle_demo_2.xml	2007-01-14 21:50:47 UTC (rev 576)
+++ branches/1.0/data/levels/enigma_experimental/puzzle_demo_2.xml	2007-01-15 16:37:02 UTC (rev 577)
@@ -86,6 +86,8 @@
 set_item("it-document", 11, 7, {text="Room 1: Some general things you can do with libpuzzle"})
 set_item("it-document", 8, 18, {text="The red puzzles, generated with permutations, are ALL solvable."})
 set_item("it-document", 11, 18, {text="The blue ones, generated with random, aren't!"})
+set_item("it-document", 2, 22, {text="This figure is solvable with max. 3 hits!"})
+set_item("it-document", 17, 14, {text="This figure is solvable with max. 4 hits!"})
 set_item("it-document", 28, 8, {text="Room 2: Every figure in here, the +/T/L, all are solvable because they are generated  from the solved puzzle with permutations."})
 set_item("it-document", 23, 16, {text="Room 4: Some things, you can do with pseude pieces: open puzzle clusters ..."})
 set_item("it-document", 8, 30, {text="Room 5: Some things, you can do with Bigbricks ..."})
@@ -144,6 +146,7 @@
 
 -- Third room:
 -- Shows the difference between random and permutation shuffle.
+-- And with specify the num_shuffles parameter
 
   puzzle({"#","#","#"},{11,20},"bluepuzzle","random")
   puzzle({"#","#","#","#"},{13,19},"bluepuzzle","random")
@@ -155,6 +158,14 @@
   puzzle({"#","#","#","#","#"},{4,14},"redpuzzle","permutation")
   puzzle({"#","#","#","#","#","#"},{2,14},"redpuzzle","permutation")
 
+  puzzle({"## ##",
+          " ### ",
+          "## ##"},{11,14},"redpuzzle","permutation",4)
+
+  puzzle({"## ##",
+          " ### ",
+          "## ##"},{4,20},"bluepuzzle","permutation",3)
+
 -- Fourth room:
 -- Shows the wonderfull possibilities of pseudo_pieces.
 

Modified: branches/1.0/data/levels/enigma_experimental/puzzle_testarea_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/puzzle_testarea_1.xml	2007-01-14 21:50:47 UTC (rev 576)
+++ branches/1.0/data/levels/enigma_experimental/puzzle_testarea_1.xml	2007-01-15 16:37:02 UTC (rev 577)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Puzzle Labor" el:subtitle="Testlevel to examine new puzzles" el:id="puzzle_testarea"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="stable"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="stable"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2005, 2007 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -43,12 +43,15 @@
 set_item("it-yinyang",1,1)
 set_item("it-yinyang",21,2)
 
+set_item("it-document",2,7,{text="Increment the num_permutation, beginning with 1."})
+set_item("it-document",2,8,{text="Reset the num_permutation to nil (random default)."})
+
 set_item("it-document",17,11,{text="Clear"})
 
 set_item("it-document",21,5,{text="With the switches at the right, you can determine the layout of the desired puzzle."})
 set_item("it-document",21,6,{text="Switch up means stone, switch down means no stone at that position."})
 set_item("it-document",21,7,{text="After you set up the layout, hit the switch at the top and return to the left screen."})
-set_item("it-document",21,1,{text="Store the figure the draw it."})
+set_item("it-document",21,1,{text="Store the figure to draw it."})
 set_item("it-document",21,11,{text="Reset all switches."})
 
 set_item("it-document",1,10,{text="Which Stonetype? Possible are: \"st-puzzle\", \"st-puzzle2\", \"st-bigbrick\" or \"st-bigbluesand\"."})
@@ -67,6 +70,8 @@
 -- Clear the canvas:
 set_stone("st-switch", 18, 11, {action="callback",target="remove_puzzle",name="clear"})
 
+set_stone("st-switch", 1, 7, {action="callback",target="increment_num_permutations",name="num"})
+set_stone("st-switch", 1, 8, {action="callback",target="reset_num_permutations",name="rnum"})
 set_stone("st-switch", 1, 11, {action="callback",target="stone_kind_switch",name="kind"})
 
 -- Right room:
@@ -98,17 +103,18 @@
 
 charmap = defaultmap
 
+local num_permutations = nil
 -- Functions to draw the puzzle:
 function draw_none()
     puzzle(charmap,{7,3},stone_kind[kind_pointer],"none")
 end
 
 function draw_random()
-    puzzle(charmap,{7,3},stone_kind[kind_pointer],"random")
+    puzzle(charmap,{7,3},stone_kind[kind_pointer],"random",num_permutations)
 end
 
 function draw_permutation()
-    puzzle(charmap,{7,3},stone_kind[kind_pointer],"permutation")
+    puzzle(charmap,{7,3},stone_kind[kind_pointer],"permutation",num_permutations)
 end
 
 -- Clear:
@@ -128,6 +134,20 @@
     end
     set_item("it-document",2,11,{text="Stonekind set to: "..stone_kind[kind_pointer]})
 end
+
+function increment_num_permutations()
+    if num_permutations == nil then
+        num_permutations = 1
+    else
+        num_permutations = num_permutations +1
+    end
+    set_item("it-document",2,7,{text="Num_Permutations set to: "..tostring(num_permutations)})
+end
+
+function reset_num_permutations()
+    num_permutations = nil
+    set_item("it-document",2,7,{text="Num_Permutations set to: "..tostring(num_permutations)})
+end
 --------------------------------------------------------------------------------
 -- Reset the switches
 function clear_values()

Modified: branches/1.0/data/levels/enigma_v/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/index.xml	2007-01-14 21:50:47 UTC (rev 576)
+++ branches/1.0/data/levels/enigma_v/index.xml	2007-01-15 16:37:02 UTC (rev 577)
@@ -27,7 +27,7 @@
     <level _seq="19" _title="Oxyd-Puzzle" _xpath="./raoul05_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul05" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="20" _title="- Meditation -" _xpath="./ralf12_1" author="Ralf Westram" ctrl="force" easy="true" id="ralf12" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="21" _title="Plan Ahead" _xpath="./duffy114_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy114" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="22" _title="Keystone" _xpath="./raoul12_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul12" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="22" _title="Keystone" _xpath="./raoul12_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul12" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="23" _title="Print 23" _xpath="./richi07_1" author="Richi B?tzer" ctrl="force" easy="false" id="richi07" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="24" _title="Space Pirates" _xpath="./siegfried19_2" author="Siegfried Fennig" ctrl="force" easy="false" id="level6a" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="25" _title="Laser Crossing" _xpath="./luc24_1" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc24" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_v/raoul05_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/raoul05_1.xml	2007-01-14 21:50:47 UTC (rev 576)
+++ branches/1.0/data/levels/enigma_v/raoul05_1.xml	2007-01-15 16:37:02 UTC (rev 577)
@@ -7,7 +7,7 @@
       <el:author  el:name="Raoul Bourquin" el:email="raoul at users.berlios.de" el:homepage=""/>
       <el:copyright>Copyright ? 2005,2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.00">
+      <el:compatibility el:enigma="0.92">
        <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
@@ -70,114 +70,150 @@
 oxyd_default_flavor = "b"
 
 --RANDOM TILES FOR UPPER ROW:
-tiles={{"## "," # "," ##"},{" ##"," # ","## "},{" ##","## ","#  "},{"## "," ##","  #"},{" # ","###"," # "},{"###"," # "," # "},{" # "," # ","###"},{"###","#  ","#  "},{"###","  #","  #"},{" # ","###","#  "},{" # ","###","  #"},{"## "," ##"," # "},{" ##","## "," # "}}
-chosen_tiles_up={}    
-leftcorners={{4,1},{9,1},{14,1}}
+tiles={{{1,1,0},{0,1,0},{0,1,1}},{{0,1,1},{0,1,0},{1,1,0}},{{0,1,1},{1,1,0},{1,0,0}},{{1,1,0},{0,1,1},{0,0,1}},{{0,1,0},{1,1,1},{0,1,0}},{{1,1,1},{0,1,0},{0,1,0}},{{0,1,0},{0,1,0},{1,1,1}},{{1,1,1},{1,0,0},{1,0,0}},{{1,1,1},{0,0,1},{0,0,1}},{{0,1,0},{1,1,1},{1,0,0}},{{0,1,0},{1,1,1},{0,0,1}},{{1,1,0},{0,1,1},{0,1,0}},{{0,1,1},{1,1,0},{0,1,0}}}
+chosen_tiles_up = {}    
+leftcorners_up = {{4,1},{9,1},{14,1}}
 
 --chose tiles:
 ct=1
 for t=1,3 do
- local r=random(1,13)
- local f=tiles[r] 
- chosen_tiles_up[ct]=f
- ct=ct+1
+    local r=random(1,13)
+    local f=tiles[r] 
+    chosen_tiles_up[ct]=f
+    ct=ct+1
 end
 
 --Draw black stones:
 for fields=1,3 do
- for i=1,3 do
-  for j=1,3 do
-    set_stone("st-glass2_hole",leftcorners[fields][1]+j-1,leftcorners[fields][2]+i-1)
-  end
- end
+    for i=1,3 do
+        for j=1,3 do
+            if chosen_tiles_up[fields][i][j]==0 then
+                set_stone("st-glass2_hole",leftcorners_up[fields][1]+j-1,leftcorners_up[fields][2]+i-1)
+            end
+        end
+    end
 end
 
 --RANDOM TILES FOR LOWER ROW:
-tiles={{"## "," # "," ##"},{" ##"," # ","## "},{"#  ","## "," ##"},{"  #"," ##","## "},{" # ","###"," # "},{"###"," # "," # "},{" # "," # ","###"},{"#  ","#  ","###"},{"  #","  #","###"},{"#  ","###"," # "},{"  #","###"," # "},{"## "," ##"," # "},{" ##","## "," # "}}
-chosen_tiles_lo={}
-leftcorners={{3,9},{8,9},{13,9}}
+tiles={{{1,1,0},{0,1,0},{0,1,1}},{{0,1,1},{0,1,0},{1,1,0}},{{1,0,0},{1,1,0},{0,1,1}},{{0,0,1},{0,1,1},{1,1,0}},{{0,1,0},{1,1,1},{0,1,0}},{{1,1,1},{0,1,0},{0,1,0}},{{0,1,0},{0,1,0},{1,1,1}},{{1,0,0},{1,0,0},{1,1,1}},{{0,0,1},{0,0,1},{1,1,1}},{{1,0,0},{1,1,1},{0,1,0}},{{0,0,1},{1,1,1},{0,1,0}},{{1,1,0},{0,1,1},{0,1,0}},{{0,1,1},{1,1,0},{0,1,0}}}
+chosen_tiles_lo = {}
+leftcorners_lo = {{3,9},{8,9},{13,9}}
 
 --chose tiles:
 ct=1
 for t=1,3 do
- local r=random(1,13)
- local f=tiles[r] 
- chosen_tiles_lo[ct]=f
- ct=ct+1
+    local r=random(1,13)
+    local f=tiles[r] 
+    chosen_tiles_lo[ct]=f
+    ct=ct+1
 end
 
 --Draw black stones:
 for fields=1,3 do
- for i=1,3 do
-  for j=1,3 do
-    set_stone("st-glass2_hole",leftcorners[fields][1]+j-1,leftcorners[fields][2]+i-1)
-  end
- end
+    for i=1,3 do
+        for j=1,3 do
+            if chosen_tiles_lo[fields][i][j]==0 then
+                set_stone("st-glass2_hole",leftcorners_lo[fields][1]+j-1,leftcorners_lo[fields][2]+i-1)
+            end
+        end
+    end
 end
 
 --set the oxyds
 function set_oxyd()
- if onemal==0 then
- onemal=1
-  for o=0,2 do
-   oxyd(5+o*5,0)
-  end
-  for o=0,2 do
-   oxyd(4+o*5,12)
-  end
-  oxyd_shuffle()
- end
+    if onemal==0 then
+        onemal=1
+        for o=0,2 do
+            oxyd(5+o*5,0)
+        end
+        for o=0,2 do
+            oxyd(4+o*5,12)
+        end
+        oxyd_shuffle()
+    end
 end
 
 --test if all puzzles set, if yes, set the oxyds
-da={0,0,0,0,0,0}
+da = {0,0,0,0,0,0}
 
 function do_test()
- ist=0
- for l=1,6 do
-  ist=ist+da[l]
- end
- if ist==6 then
-  da={0,0,0,0,0,0}
-  set_oxyd()
- end
+    local ist=0
+    for l=1,6 do
+        ist=ist+da[l]
+    end
+    if ist==6 then
+        da={0,0,0,0,0,0}
+        set_oxyd()
+    end
 end
 
 --Wrap-Funktionen
+function generate_charmap(row,puzzle)
+    local charmap = {}
+    local i,j = 0, 0
+    for i=1,3 do
+        charmap[i] = {}
+        local buffer = ""
+        for j=1,3 do
+            if row == 1 then
+                if chosen_tiles_up[puzzle][i][j]==0 then
+                    buffer = buffer.." "
+                else
+                    buffer = buffer.."#"
+                end
+            else
+                if chosen_tiles_lo[puzzle][i][j]==0 then
+                    buffer = buffer.." "
+                else
+                    buffer = buffer.."#"
+                end
+            end
+        end
+        charmap[i] = buffer
+    end
+    return charmap
+end
+
 function wrap1()
- puzzle(chosen_tiles_up[1],{4,1},"redpuzzle","permutation")
- da[1]=1
- do_test()
+    local map = generate_charmap(1,1)
+    puzzle(map,leftcorners_up[1],"redpuzzle","permutation")
+    da[1]=1
+    do_test()
 end
 
 function wrap2()
- puzzle(chosen_tiles_up[2],{9,1},"redpuzzle","permutation")
- da[2]=1
- do_test()
+    local map = generate_charmap(1,2)
+    puzzle(map,leftcorners_up[2],"redpuzzle","permutation")
+    da[2]=1
+    do_test()
 end
 
 function wrap3()
- puzzle(chosen_tiles_up[3],{14,1},"redpuzzle","permutation")
- da[3]=1
- do_test()
+    local map = generate_charmap(1,3)
+    puzzle(map,leftcorners_up[3],"redpuzzle","permutation")
+    da[3]=1
+    do_test()
 end
 
 function wrap4()
- puzzle(chosen_tiles_lo[1],{3,9},"redpuzzle","permutation")
- da[4]=1
- do_test()
+    local map = generate_charmap(2,1)
+    puzzle(map,leftcorners_lo[1],"redpuzzle","permutation")
+    da[4]=1
+    do_test()
 end
 
 function wrap5()
- puzzle(chosen_tiles_lo[2],{8,9},"redpuzzle","permutation")
- da[5]=1
- do_test()
+    local map = generate_charmap(2,2)
+    puzzle(map,leftcorners_lo[2],"redpuzzle","permutation")
+    da[5]=1
+    do_test()
 end
 
 function wrap6()
- puzzle(chosen_tiles_lo[3],{13,9},"redpuzzle","permutation")
- da[6]=1
- do_test()
+    local map = generate_charmap(2,3)
+    puzzle(map,leftcorners_lo[3],"redpuzzle","permutation")
+    da[6]=1
+    do_test()
 end
     ]]></el:luamain>
     <el:i18n>

Modified: branches/1.0/data/levels/enigma_v/raoul12_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/raoul12_1.xml	2007-01-14 21:50:47 UTC (rev 576)
+++ branches/1.0/data/levels/enigma_v/raoul12_1.xml	2007-01-15 16:37:02 UTC (rev 577)
@@ -3,12 +3,12 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Keystone" el:subtitle="" el:id="raoul12"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="raoul at users.berlios.de" el:homepage=""/>
       <el:copyright>Copyright ? 2006 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
       <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="1" el:preload="true"/>
+       <el:dependency el:path="lib/libpuzzle_2" el:id="lib/libpuzzle" el:release="2" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="true" el:single="true" el:network="false"/>
       <el:comments>
@@ -56,16 +56,6 @@
 set_stone("st-switch_white", 12, 31, {action="callback",target="per1",name="rot7"})
 end
 
--- PUZZLES --
---blaue:
-puzzle({{1,0,0,1,0},{1,1,1,1,1},{1,0,1,0,0}},4,5,"blue","no")
-
-puzzle({{0,1,0,0,1},{1,1,1,1,1},{0,1,0,0,1}},12,5,"blue","no")
-
-puzzle({{1,1,1},{0,1,0},{1,1,1},{0,1,0},{0,1,0}},9,1,"blue","no")
-
-puzzle({{0,1,0},{0,1,1},{1,1,0},{0,1,0},{1,1,1}},9,7,"blue","no")
-
 -- ACTORS --
 set_actor("ac-blackball", 15.5,10.5, {player=0})
 set_actor("ac-whiteball", 7.5,28.5, {player=1})
@@ -80,69 +70,53 @@
 oxyd_default_flavor = "d"
 oxyd_shuffle()
 
--- LUA-FUNCTIONS --
---Overwrite the PUZZLE_SHUFFLE() in libpuzzle.lua:
-waswo={"","","","","","","","","","",""}
+-- Oranges Puzzleteil:
+puzzle({"## ##",
+        " ### ",
+        "## ##"},{8,5},"redpuzzle","permutation")
 
-function puzzle_shuffle(teile)
- 
- shuffled_pieces={}
+-- shift_helper_functions --
+waswo = {"","","","","","","","","","",""}
+nr = 1
 
- local restteile={}
- local anz=anz_stones
- local zyklen=anz
- local i,j,k
- local counter=1
+function translate_type(type)
+    local translate_table = {"","w","s","sw","e","ew","es","esw","n","nw","ns","nsw","ne","new","nes","nesw"}
+    return translate_table[type]
+end
 
- for i=1,zyklen do
+local i, j = 0, 0
+for i=1, 3 do
+    for j=1, 5 do
+        local this_stone = enigma.GetStone(8+j-1,5+i-1)
+        if this_stone ~= nil then
+            local temp = translate_type(enigma.GetAttrib(this_stone,"connections"))
+            waswo[nr] = "st-puzzle2-"..tostring(temp)
+            nr = nr+1
+        end
+    end
+end
 
-  --shuffle pieces:
-  t=random(1,anz)
-  
-  aktteil=teile[t]
-  shuffled_pieces[counter]=aktteil
-  counter=counter+1
-  
- --add this line for this level:
-  waswo[i]=aktteil
+-- Blaue Puzzleteile:
+puzzle({"#  # ",
+        "#####",
+        "# #  "},{4,5},"bluepuzzle","none")
 
-  --prepare the teile array for next cycle
-  local restteile={}
-  local schogse=0
+puzzle({" #  #",
+        "#####",
+        " #  #"},{12,5},"bluepuzzle","none")
 
-  --copy the teile array, mark the piece we just have used with "0"
-  for k=1,anz do
-   if teile[k]==aktteil and schogse==0 then
-    restteile[k]="0"
-    schogse=1
-   else
-    restteile[k]=teile[k]
-   end
-  end
+puzzle({"###",
+        " # ",
+        "###",
+        " # ",
+        " # "},{9,1},"bluepuzzle","none")
 
-  --clear teile array:
-  teile={}
-  local t=1
+puzzle({" # ",
+        " ##",
+        "## ",
+        " # ",
+        "###"},{9,7},"bluepuzzle","none")
 
-  for j=1,anz do
-   if restteile[j]~="0" then
-    teile[t]=restteile[j]
-    t=t+1
-   end 
-  end
-  
-  --we have used one piece:
-  anz=anz-1
- end
-
- return shuffled_pieces
-
-end
-
---Oranges Puzzleteil
-shuffle_method="random"
-puzzle({{1,1,0,1,1},{0,1,1,1,0},{1,1,0,1,1}},8,5,"red","yes")
-
 ---------------
 function per1()
  localram={"",""}
@@ -153,8 +127,8 @@
  localram[1]=tmp
  waswo[1]=localram[1]
  waswo[2]=localram[2]
- set_stone("st-puzzle".."2".."-"..localram[1],8,5)
- set_stone("st-puzzle".."2".."-"..localram[2],9,5)
+ set_stone(localram[1],8,5)
+ set_stone(localram[2],9,5)
 end
 ---------------
 function per2()
@@ -166,8 +140,8 @@
  localram[1]=tmp 
  waswo[8]=localram[1]
  waswo[9]=localram[2]
- set_stone("st-puzzle".."2".."-"..localram[1],8,7)
- set_stone("st-puzzle".."2".."-"..localram[2],9,7)
+ set_stone(localram[1],8,7)
+ set_stone(localram[2],9,7)
 end
 ---------------
 function per3()
@@ -182,9 +156,9 @@
  waswo[2]=localram[1]
  waswo[5]=localram[2]
  waswo[9]=localram[3]
- set_stone("st-puzzle".."2".."-"..localram[1],9,5)
- set_stone("st-puzzle".."2".."-"..localram[2],9,6)
- set_stone("st-puzzle".."2".."-"..localram[3],9,7)
+ set_stone(localram[1],9,5)
+ set_stone(localram[2],9,6)
+ set_stone(localram[3],9,7)
 end
 ---------------
 function per4()
@@ -199,9 +173,9 @@
  waswo[5]=localram[1]
  waswo[6]=localram[2]
  waswo[7]=localram[3]
- set_stone("st-puzzle".."2".."-"..localram[1],9,6)
- set_stone("st-puzzle".."2".."-"..localram[2],10,6)
- set_stone("st-puzzle".."2".."-"..localram[3],11,6)
+ set_stone(localram[1],9,6)
+ set_stone(localram[2],10,6)
+ set_stone(localram[3],11,6)
 end
 ---------------
 function per5()
@@ -216,9 +190,9 @@
  waswo[3]=localram[1]
  waswo[7]=localram[2]
  waswo[10]=localram[3]
- set_stone("st-puzzle".."2".."-"..localram[1],11,5)
- set_stone("st-puzzle".."2".."-"..localram[2],11,6)
- set_stone("st-puzzle".."2".."-"..localram[3],11,7)
+ set_stone(localram[1],11,5)
+ set_stone(localram[2],11,6)
+ set_stone(localram[3],11,7)
 end
 ---------------
 function per6()
@@ -230,8 +204,8 @@
  localram[1]=tmp
  waswo[3]=localram[1]
  waswo[4]=localram[2]
- set_stone("st-puzzle".."2".."-"..localram[1],11,5)
- set_stone("st-puzzle".."2".."-"..localram[2],12,5)
+ set_stone(localram[1],11,5)
+ set_stone(localram[2],12,5)
 end
 ---------------
 function per7()
@@ -243,8 +217,8 @@
  localram[1]=tmp
  waswo[10]=localram[1]
  waswo[11]=localram[2]
- set_stone("st-puzzle".."2".."-"..localram[1],11,7)
- set_stone("st-puzzle".."2".."-"..localram[2],12,7)
+ set_stone(localram[1],11,7)
+ set_stone(localram[2],12,7)
 end
     ]]></el:luamain>
     <el:i18n>

Modified: branches/1.0/data/levels/lib/libpuzzle_2.xml
===================================================================
--- branches/1.0/data/levels/lib/libpuzzle_2.xml	2007-01-14 21:50:47 UTC (rev 576)
+++ branches/1.0/data/levels/lib/libpuzzle_2.xml	2007-01-15 16:37:02 UTC (rev 577)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="library">
       <el:identity el:title="" el:id="lib/libpuzzle"/>
-      <el:version el:score="2" el:release="2" el:revision="2" el:status="released"/>
+      <el:version el:score="2" el:release="2" el:revision="3" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2005, 2006, 2007 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -22,7 +22,10 @@
 -- map: a charmap with the puzzle
 -- corner: top left corner, array {x,y}
 -- type: type of stone to use, one of these: "redpuzzle","bluepuzzle","bigbrick" or "bigbluesand"
--- shuffle: shuffle method, one of these: "none","random" or "permutation"
+-- shuffle_method: shuffle method, one of these: "none","random" or "permutation"
+-- num_shuffles: Given number of shuffles to do. If not set, it will be a random number:
+--  -> in the intervall [num_pieces; num_pieces+random(1,num_pieces)] for the random shuffle method
+--  -> in the intervall [num_permutations; num_permutations + math.random(1,num_pieces)] for the permutation shuffle method
 --
 -- Globals:
 -- puzzle_map: the arraymap with the puzzle layout.
@@ -41,10 +44,11 @@
 -- 
 -- shuffle = "none"
 --
+-- num_shuffles = nil (-> random number will be determined!)
 --------------------------------------------------------------------------------
 --------------------------------------------------------------------------------
 -- Wrapper to set a puzzle
-function puzzle(map, corner, type, shuffle)
+function puzzle(map, corner, type, shuffle_method, num_shuffles)
     -- Are all parameters set?
     -- If no, set the default for the missing ones.
     if map == nil then
@@ -59,25 +63,29 @@
     if shuffle == nil then
         shuffle = "none"
     end
+    -- Default (random) values for num_shuffles is set in the shuffle-functions.
 
     -- IS THE map VALID?
     -- Is the map bigger than 0 x 0 ?
     local x, y = get_charmap_size(map)
     if x < 1 or y < 1 then
-        error("puzzle(map, corner, type, shuffle): Map "..tostring(x).." x "..tostring(y).." is too small!\n")
+        error("puzzle(map, corner, type, shuffle_method, num_shuffles): Map "..tostring(x).." x "..tostring(y).." is too small!\n")
     end
     -- Is the map rectangular?
     is_rectangular(map)
     -- If there is no error until here, the map is ok
     -- IS THE corner VALID?
     if corner[1] < 0 or corner[2] < 0 then
-        error("puzzle(map, corner, type, shuffle): Invalid value for top left map corner! "..tostring(corner[1])..";"..tostring(corner[2])..". It has to be >= (0;0).\n")
+        error("puzzle(map, corner, type, shuffle_method, num_shuffles): Invalid value for top left map corner! "..tostring(corner[1])..";"..tostring(corner[2])..". It has to be >= (0;0).\n")
     end
     -- IS THE type VALID?
     local stone_type = is_valid_type(type)
     -- IS VALID shuffle?
-    local shuffle_method = is_valid_shuffle(shuffle)
-
+    local method = is_valid_shuffle(shuffle_method)
+    -- IS num_shuffle VALID?
+    if num_shuffles ~= nil and num_shuffles < 1 then
+        error("puzzle(map, corner, type, shuffle_method, num_shuffles): num_shuffles has illegal value "..tostring(num_shuffles).."! It has to be >= 1 or nil.\n") 
+    end
     -- If there is no error until here, all parameters are ok
     -- Beginn with the work.
 
@@ -88,12 +96,12 @@
     get_parts(puzzle_map)
 
     -- Determine the shuffle method to use.
-    if shuffle_method == 1 then
+    if method == 1 then
         shuffle_parts_with_noshuffle()
-    elseif shuffle_method == 2 then
-        shuffle_parts_with_random()
-    elseif shuffle_method == 3 then
-        shuffle_parts_with_permutation()
+    elseif method == 2 then
+        shuffle_parts_with_random(num_shuffles)
+    elseif method == 3 then
+        shuffle_parts_with_permutation(num_shuffles)
     end
 
     plot_puzzle(corner,stone_type)
@@ -140,7 +148,7 @@
     for i=1, y_size do
         local temp = string.len(map[i])
         if temp ~= buffer then
-            error("puzzle(map, corner, type, shuffle): Map in not rectangular!\n")
+            error("puzzle(map, corner, type, shuffle_method, num_shuffles): Map in not rectangular!\n")
         end
     end
     return 0
@@ -157,7 +165,7 @@
     elseif type == "bigbluesand" then
         stone = "st-bigbluesand"
     else
-        error("puzzle(map, corner, type, shuffle): Invald type \""..tostring(type).."\"! It has to be one of these types: \"redpuzzle\",\"bluepuzzle\",\"bigbrick\" or \"bigbluesand\".")
+        error("puzzle(map, corner, type, shuffle_method, num_shuffles): Invald type \""..tostring(type).."\"! It has to be one of these types: \"redpuzzle\",\"bluepuzzle\",\"bigbrick\" or \"bigbluesand\".")
     end
     return stone
 end
@@ -171,7 +179,7 @@
     elseif shufflemethod == "permutation" then
         method = 3
     else
-        error("puzzle(map, corner, type, shuffle): Invald shuffle \""..tostring(shufflemethod).."\"! It has to be one of these methodes: \"none\",\"random\" or \"permutation\".")
+        error("puzzle(map, corner, type, shuffle_method, num_shuffles): Invald shuffle \""..tostring(shufflemethod).."\"! It has to be one of these methodes: \"none\",\"random\" or \"permutation\".")
     end
     return method
 end
@@ -397,11 +405,18 @@
     return 0
 end
 
-function shuffle_parts_with_random()
+function shuffle_parts_with_random(num_swaps)
+    -- How many swaps we will do?
+    local number_swaps = 0
 
-    local number_swaps = 0
     local number_parts = get_array_size(parttable)
-    number_swaps = number_parts + math.random(1,number_parts)
+    -- Is there a number of swaps to do given?
+    if num_swaps == nil then
+        -- If not, determine a random number:
+        number_swaps = number_parts + math.random(1,number_parts)
+    else
+        number_swaps = num_swaps
+    end
 
     local i = 0
     for i=1, number_swaps do
@@ -571,7 +586,7 @@
     return 0
 end
 --------------------------------------------------------------------------------
-function shuffle_parts_with_permutation()
+function shuffle_parts_with_permutation(num_permutations)
     -- New map with the parts in their proper location.
     new_partmap()
 
@@ -579,13 +594,22 @@
     scan_puzzle_for_permutations()
 
     -- How many puzzlestones are in the current cluster?
-    local anz_pieces = table.getn(parttable)
+    local num_pieces = table.getn(parttable)
 
-    -- How many permutation we have?
+    -- How many possible permutation we have?
     local anz_permutations = table.getn(permutations)
 
     if anz_permutations > 0 then
-        local num_permutations_to_do = anz_permutations + math.random(1,anz_pieces)
+        -- The number of permutations we will use
+        local num_permutations_to_do
+
+        if num_permutations == nil then
+        -- If there is no number of permutations to do given, determine a random one:
+            num_permutations_to_do = anz_permutations + math.random(1,num_pieces)
+        else
+            num_permutations_to_do = num_permutations
+        end
+
         local i = 0
         for i=1, num_permutations_to_do do
             r = math.random(1,anz_permutations)



From raoul at mail.berlios.de  Wed Jan 17 13:26:01 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Wed, 17 Jan 2007 13:26:01 +0100
Subject: [Enigma-game-svn] r578 - in branches/1.0/data/levels:
	enigma_experimental enigma_peroxyd
Message-ID: <200701171226.l0HCQ1I0026960@sheep.berlios.de>

Author: raoul
Date: 2007-01-17 13:26:00 +0100 (Wed, 17 Jan 2007)
New Revision: 578

Added:
   branches/1.0/data/levels/enigma_experimental/floors_1.xml
   branches/1.0/data/levels/enigma_experimental/items_1.xml
   branches/1.0/data/levels/enigma_experimental/stones_1.xml
   branches/1.0/data/levels/enigma_peroxyd/peroxyd29_2.xml
Removed:
   branches/1.0/data/levels/enigma_experimental/items.xml
   branches/1.0/data/levels/enigma_peroxyd/peroxyd29_1.xml
Modified:
   branches/1.0/data/levels/enigma_experimental/index.xml
   branches/1.0/data/levels/enigma_peroxyd/index.xml
Log:
-> New version of peroxyd29_2 with ghosts.
-> Stones, Floors and Items testlevel updated



Added: branches/1.0/data/levels/enigma_experimental/floors_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/floors_1.xml	2007-01-15 16:37:02 UTC (rev 577)
+++ branches/1.0/data/levels/enigma_experimental/floors_1.xml	2007-01-17 12:26:00 UTC (rev 578)
@@ -0,0 +1,72 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="All Floors" el:subtitle="Testlevel with all Floors" el:id="floors"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="stable"/>
+      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2007 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- GENERAL --
+levelh = 13
+levelw = 100
+
+create_world(levelw, levelh)
+enigma.ConserveLevel = TRUE
+display.SetFollowMode(display.FOLLOW_SCROLLING)
+
+-- DESIGN --
+floor="fl-black"
+wall="st-glass"
+
+-- FLOOR --
+fill_floor(floor, 0,0,levelw,levelh)
+
+-- STONES --
+draw_border(wall)
+
+-- ITEMS --
+set_item("it-document", 10, 6, {text="text1"})
+
+-- ACTORS --
+set_actor("ac-blackball", 4.5,4.5, {player=0})
+set_actor("ac-whiteball", 6.5,4.5, {player=1})
+set_item("it-yinyang",4,4)
+set_item("it-yinyang",6,4)
+
+-- Funktionen
+-- VARS
+floorlist={"fl-abyss_fake", "fl-black", "fl-bluegray", "fl-bluegreen", "fl-bluegreenx", "fl-brick", "fl-bumps", "fl-concrete", "fl-darkgray", "fl-dunes", "fl-floor_001", "fl-gravel", "fl-gray", "fl-hay", "fl-himalaya", "fl-leaves", "fl-leavesb", "fl-leavesc1", "fl-leavesc2", "fl-leavesc3", "fl-leavesc4", "fl-leavesd1", "fl-leavesd2", "fl-leavesd3", "fl-leavesd4", "fl-leavese1", "fl-leavese2", "fl-leavese3", "fl-leavese4", "fl-light", "fl-lightgray", "fl-marble", "fl-metal1", "fl-metal2", "fl-metal3", "fl-metal4", "fl-metal5", "fl-metal6", "fl-mortar", "fl-normal", "fl-normal_x", "fl-plank", "fl-red", "fl-rock", "fl-rough", "fl-rough_medium", "fl-rough_slow", "fl-rough-blue", "fl-rough-red", "fl-sahara", "fl-samba", "fl-samba1", "fl-samba2", "fl-sand", "fl-springboard", "fl-stone", "fl-stwood", "fl-stwood1", "fl-stwood2", "fl-tigris", "fl-trigger", "fl-white", "fl-wood", "fl-woven", "fl-abyss", "fl-acblack", "fl-acwhite", "fl-bridge-closed", "fl-gradient1", "fl-gradient2", "!
 fl-gradient3", "fl-gradient4", "fl-gradient5", "fl-gradient6", "fl-gradient7", "fl-gradient8", "fl-gradient9", "fl-gradient10", "fl-gradient11", "fl-gradient12", "fl-gradient13", "fl-gradient14", "fl-gradient15", "fl-gradient16", "fl-ice", "fl-inverse", "fl-inverse2", "fl-nomouse", "fl-space", "fl-space-force", "fl-swamp", "fl-thief", "fl-water"}
+
+------
+nr=1
+for i=1,table.getn(floorlist) do
+      nr = nr+1
+      set_stone("st-switch",1+i,3, {action="callback", target="sw"..nr, name="switch"..nr})
+      func = "function sw"..nr.."() flnr="..i.."; setfloor(flnr) ; end"
+      dostring(func)
+end
+
+function setfloor(flnr)
+ floor=floorlist[flnr]
+ fldo=floorlist[flnr]
+ draw_floor(floor,{1+flnr,5},{0,1},5)
+ set_item("it-document", 1+flnr, 1, {text=fldo})
+end
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Level with all floors of Enigma 1.00!</el:english>
+      </el:string> 
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_experimental/floors_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/1.0/data/levels/enigma_experimental/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/index.xml	2007-01-15 16:37:02 UTC (rev 577)
+++ branches/1.0/data/levels/enigma_experimental/index.xml	2007-01-17 12:26:00 UTC (rev 578)
@@ -11,13 +11,15 @@
     <level _seq="3" _title="Template 1" _xpath="./template1" author="AUTHOR" ctrl="force" easy="false" id="template1" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="4" _title="Template 2" _xpath="./template2" author="AUTHOR" ctrl="force" easy="false" id="template2" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="5" _title="Template 3" _xpath="./template3" author="AUTHOR" ctrl="force" easy="false" id="template3" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="6" _title="Impulstest" _xpath="./testimpulses" author="Enigma Team" ctrl="force" easy="false" id="testimpulses" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="7" _title="Wolf Among Sheep" _xpath="./wolfamongsheep" author="illmind" ctrl="force" easy="false" id="wolfamongsheep" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="8" _title="Puzzle Labor" _xpath="./puzzle_testarea_1" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_testarea" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="9" _title="Puzzle Demo" _xpath="./puzzle_demo_2" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_demo" rel="2" rev="2" score="2" target="time" unit="duration"/>
-    <level _seq="10" _title="All Items" _xpath="./items" author="Raoul Bourquin" ctrl="force" easy="false" id="items" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="11" _title="Impossible?" _xpath="./wb2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb2_exp" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="12" _title="Flood Demo" _xpath="./flood_demo_1" author="Raoul Bourquin" ctrl="force" easy="false" id="flood_demo" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="6" _title="All Stones" _xpath="./stones_1" author="Raoul Bourquin" ctrl="force" easy="false" id="stones" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="7" _title="All Floors" _xpath="./floors_1" author="Raoul Bourquin" ctrl="force" easy="false" id="floors" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="8" _title="All Items" _xpath="./items_1" author="Raoul Bourquin" ctrl="force" easy="false" id="items" rel="1" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="9" _title="Impulstest" _xpath="./testimpulses" author="Enigma Team" ctrl="force" easy="false" id="testimpulses" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="10" _title="Wolf Among Sheep" _xpath="./wolfamongsheep" author="illmind" ctrl="force" easy="false" id="wolfamongsheep" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="11" _title="Puzzle Labor" _xpath="./puzzle_testarea_1" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_testarea" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="12" _title="Puzzle Demo" _xpath="./puzzle_demo_2" author="Raoul Bourquin" ctrl="force" easy="false" id="puzzle_demo" rel="2" rev="2" score="2" target="time" unit="duration"/>
+    <level _seq="13" _title="Flood Demo" _xpath="./flood_demo_1" author="Raoul Bourquin" ctrl="force" easy="false" id="flood_demo" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="14" _title="Impossible?" _xpath="./wb2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb2_exp" rel="1" rev="0" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Deleted: branches/1.0/data/levels/enigma_experimental/items.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/items.xml	2007-01-15 16:37:02 UTC (rev 577)
+++ branches/1.0/data/levels/enigma_experimental/items.xml	2007-01-17 12:26:00 UTC (rev 578)
@@ -1,75 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="All Items" el:subtitle="Testlevel with all Items" el:id="items"/>
-      <el:version el:score="1" el:release="1" el:revision="1" el:status="stable"/>
-      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2006, 2007 Raoul Bourquin</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.00">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- GENERAL --
-levelw = 120
-levelh = 13
-create_world(levelw, levelh)
-enigma.ConserveLevel = TRUE
-display.SetFollowMode(display.FOLLOW_SCROLLING)
-
--- DESIGN --
-boden="fl-black"
-wand="st-glass"
-
--- FLOOR --
-fill_floor(boden, 0,0,levelw,levelh)
-
--- STONES --
-draw_border(wand)
-
--- ITEMS --
-set_item("it-document", 10, 6, {text="text1"})
-
--- ACTORS --
-actor1=set_actor("ac-blackball", 4.5,4.5, {player=0})
-
--- Funktionen
--- VARS
-itemlist={"it-abyss", "it-bag", "it-banana", "it-blackbomb", "it-blocker", "it-booze", "it-booze-broken", "it-brake", "it-brush", "it-burnable", "it-burnable_ash", "it-burnable_burning", "it-burnable_fireproof", "it-burnable_ignited", "it-burnable_oil", "it-changefloor", "it-cherry", "it-coffee", "it-coin1", "it-coin2", "it-coin4", "it-crack0", "it-crack1", "it-crack2", "it-crack3", "it-cross", "it-death", "it-document", "it-drop", "it-dynamite", "it-extinguisher", "it-extinguisher_medium", "it-extinguisher_empty", "it-extralife", "it-flagblack", "it-flagwhite", "it-floppy", "it-glasses", "it-glasses-broken", "it-hammer", "it-hill", "it-hollow", "it-hstrip", "it-inversesensor", "it-key", "it-landmine", "it-magicwand", "it-magnet", "it-magnet-on", "it-odometer", "it-pencil", "it-pin", "it-pipe-e", "it-pipe-es", "it-pipe-h", "it-pipe-n", "it-pipe-ne", "it-pipe-s", "it-pipe-sw", "it-pipe-v", "it-pipe-w", "it-pipe-wn", "it-puller-n", "it-puller-e", "it-puller-s", "it-puller-w",!
  "it-ring", "it-rubberband", "it-seed", "it-seed_nowood", "it-seed_volcano", "it-sensor", "it-shogun-l", "it-shogun-m", "it-shogun-s", "it-spade", "it-spoon", "it-spring1", "it-spring2", "it-springboard", "it-squashed", "it-surprise", "it-sword", "it-tinyhill", "it-tinyhollow", "it-trigger", "it-umbrella", "it-vortex-closed", "it-vortex-open", "it-vstrip", "it-weight", "it-whitebomb", "it-wormhole", "it-wormhole-off", "it-wrench", "it-yinyang" }
-
-------
-nr=1
-for i=1,table.getn(itemlist) do
-      nr = nr+1
-      set_stone("st-switch",1+i,3, {action="callback", target="sw"..nr, name="switch"..nr})
-      func = "function sw"..nr.."() itnr="..i.."; settem(itnr) ; end"
-      dostring(func)
-end
-
-function settem(itnr)
- item= itemlist[itnr]
- itdo=itemlist[itnr]
- set_item(item,1+itnr,5)
- set_item("it-document", 1+itnr, 1, {text=itdo})
-end
-
---Laser:
-set_stone("st-laser", 115, 3, {name="laser1", dir=SOUTH, on="0"})
-set_stone("st-switch", 115,1, {action="onoff", target="laser1"})
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-      <el:string el:key="text1">
-        <el:english el:translate="true">Level with all items of Enigma 1.00!</el:english>
-      </el:string> 
-    </el:i18n>
-  </el:protected>
-</el:level>

Added: branches/1.0/data/levels/enigma_experimental/items_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/items_1.xml	2007-01-15 16:37:02 UTC (rev 577)
+++ branches/1.0/data/levels/enigma_experimental/items_1.xml	2007-01-17 12:26:00 UTC (rev 578)
@@ -0,0 +1,78 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="All Items" el:subtitle="Testlevel with all Items" el:id="items"/>
+      <el:version el:score="1" el:release="1" el:revision="2" el:status="stable"/>
+      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2006, 2007 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- GENERAL --
+levelw = 120
+levelh = 13
+create_world(levelw, levelh)
+enigma.ConserveLevel = TRUE
+display.SetFollowMode(display.FOLLOW_SCROLLING)
+
+-- DESIGN --
+boden="fl-black"
+wand="st-glass"
+
+-- FLOOR --
+fill_floor(boden, 0,0,levelw,levelh)
+
+-- STONES --
+draw_border(wand)
+
+-- ITEMS --
+set_item("it-document", 10, 6, {text="text1"})
+
+-- ACTORS --
+set_actor("ac-blackball", 4.5,4.5, {player=0})
+set_actor("ac-whiteball", 6.5,4.5, {player=1})
+set_item("it-yinyang",4,4)
+set_item("it-yinyang",6,4)
+
+-- Funktionen
+-- VARS
+itemlist={"it-abyss", "it-bag", "it-banana", "it-blackbomb", "it-blocker", "it-booze", "it-booze-broken", "it-brake", "it-brush", "it-burnable", "it-burnable_ash", "it-burnable_burning", "it-burnable_fireproof", "it-burnable_ignited", "it-burnable_oil", "it-changefloor", "it-cherry", "it-coffee", "it-coin1", "it-coin2", "it-coin4", "it-crack0", "it-crack1", "it-crack2", "it-crack3", "it-cross", "it-death", "it-document", "it-drop", "it-dynamite", "it-extinguisher", "it-extinguisher_medium", "it-extinguisher_empty", "it-extralife", "it-flagblack", "it-flagwhite", "it-floppy", "it-glasses", "it-glasses-broken", "it-hammer", "it-hill", "it-hollow", "it-hstrip", "it-inversesensor", "it-key", "it-landmine", "it-magicwand", "it-magnet", "it-magnet-on", "it-odometer", "it-pencil", "it-pin", "it-pipe-e", "it-pipe-es", "it-pipe-h", "it-pipe-n", "it-pipe-ne", "it-pipe-s", "it-pipe-sw", "it-pipe-v", "it-pipe-w", "it-pipe-wn", "it-puller-n", "it-puller-e", "it-puller-s", "it-puller-w",!
  "it-ring", "it-rubberband", "it-seed", "it-seed_nowood", "it-seed_volcano", "it-sensor", "it-shogun-l", "it-shogun-m", "it-shogun-s", "it-spade", "it-spoon", "it-spring1", "it-spring2", "it-springboard", "it-squashed", "it-surprise", "it-sword", "it-tinyhill", "it-tinyhollow", "it-trigger", "it-umbrella", "it-vortex-closed", "it-vortex-open", "it-vstrip", "it-weight", "it-whitebomb", "it-wormhole", "it-wormhole-off", "it-wrench", "it-yinyang" }
+
+------
+nr=1
+for i=1,table.getn(itemlist) do
+      nr = nr+1
+      set_stone("st-switch",1+i,3, {action="callback", target="sw"..nr, name="switch"..nr})
+      func = "function sw"..nr.."() itnr="..i.."; settem(itnr) ; end"
+      dostring(func)
+end
+
+function settem(itnr)
+ item= itemlist[itnr]
+ itdo=itemlist[itnr]
+ set_item(item,1+itnr,5)
+ set_item("it-document", 1+itnr, 1, {text=itdo})
+end
+
+--Laser:
+set_stone("st-laser", 115, 3, {name="laser1", dir=SOUTH, on="0"})
+set_stone("st-switch", 115,1, {action="onoff", target="laser1"})
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Level with all items of Enigma 1.00!</el:english>
+      </el:string> 
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_experimental/items_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: branches/1.0/data/levels/enigma_experimental/stones_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_experimental/stones_1.xml	2007-01-15 16:37:02 UTC (rev 577)
+++ branches/1.0/data/levels/enigma_experimental/stones_1.xml	2007-01-17 12:26:00 UTC (rev 578)
@@ -0,0 +1,72 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="All Stones" el:subtitle="Testlevel with all Stones" el:id="stones"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="stable"/>
+      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2007 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- GENERAL --
+levelh = 13
+levelw = 300
+
+create_world(levelw, levelh)
+enigma.ConserveLevel = TRUE
+display.SetFollowMode(display.FOLLOW_SCROLLING)
+
+-- DESIGN --
+floor="fl-black"
+wall="st-glass"
+
+-- FLOOR --
+fill_floor(floor, 0,0,levelw,levelh)
+
+-- STONES --
+draw_border(wall)
+
+-- ITEMS --
+set_item("it-document", 10, 6, {text="text1"})
+
+-- ACTORS --
+set_actor("ac-blackball", 4.5,4.5, {player=0})
+set_actor("ac-whiteball", 6.5,4.5, {player=1})
+set_item("it-yinyang",4,4)
+set_item("it-yinyang",6,4)
+
+-- Funktionen
+-- VARS
+stonelist={"st-beads", "st-blue-sand", "st-bluegray", "st-bluegray_hole", "st-brick", "st-brownie", "st-bumps", "st-camouflage", "st-fakeoxyd", "st-glass", "st-glass1", "st-glass2", "st-glass3", "st-glass1_hole", "st-glass2_hole", "st-glass1_move", "st-glass_move", "st-greenbrown", "st-greenbrown_hole", "st-greenbrown_move", "st-likeoxyda", "st-likeoxydb", "st-likeoxydc", "st-likeoxydd", "st-likeoxyda-open", "st-likeoxydb-open", "st-likeoxydc-open", "st-likeoxydd-open", "st-marble", "st-marble_hole", "st-marble_move", "st-metal", "st-redrock", "st-rock1", "st-rock2", "st-rock3", "st-rock4", "st-rock5", "st-rock6", "st-rock7", "st-rock8", "st-rock9", "st-rock10", "st-rock1_hole", "st-rock2_hole", "st-rock3_hole", "st-rock1_move", "st-rock3_move", "st-stone1", "st-stone2", "st-wood", "st-wood1", "st-wood2", "st-wood_001", "st-woven", "st-yellow", "st-actorimpulse", "st-actorimpulse_invisible", "st-bigbluesand-n", "st-bigbluesand-e", "st-bigbluesand-s", "st-bigbluesand-w", "st!
 -bigbluesand-ne", "st-bigbluesand-ns", "st-bigbluesand-nw", "st-bigbluesand-es", "st-bigbluesand-ew", "st-bigbluesand-sw", "st-bigbluesand-nes", "st-bigbluesand-new", "st-bigbluesand-nsw", "st-bigbluesand-esw", "st-bigbluesand-nesw", "st-bigbrick-n", "st-bigbrick-e", "st-bigbrick-s", "st-bigbrick-w", "st-bigbrick-ne", "st-bigbrick-ns", "st-bigbrick-nw", "st-bigbrick-es", "st-bigbrick-ew", "st-bigbrick-sw", "st-bigbrick-nes", "st-bigbrick-new", "st-bigbrick-nsw", "st-bigbrick-esw", "st-bigbrick-nesw", "st-black1", "st-black2", "st-black3", "st-black4", "st-blackballs", "st-block", "st-blocker", "st-bolder-e", "st-bolder-n", "st-bolder-s", "st-bolder-w", "st-bombs", "st-brake", "st-break_acblack", "st-break_acwhite", "st-break_bolder", "st-break_gray", "st-break_invisible", "st-brick_magic", "st-bug", "st-chameleon", "st-chargeminus", "st-chargeplus", "st-chargezero", "st-chess_black", "st-chess_white", "st-coffee", "st-coinslot", "st-death", "st-death_invisible", "st-disco-d!
 ark", "st-disco-light", "st-disco-medium", "st-door-h", "st-do!
 or-v", "
st-door_a", "st-door_b", "st-door_c", "st-fakeoxyda", "st-fart", "st-firebreak", "st-firebreak_move", "st-flash", "st-flhay", "st-floppy", "st-flrock", "st-fourswitch", "st-grate1", "st-grate2", "st-grate3", "st-invisible", "st-invisible_magic", "st-key", "st-knight", "st-laser-e", "st-laser-n", "st-laser-s", "st-laser-w", "st-laserbreak", "st-laserswitch", "st-lasertimeswitch", "st-lightpassenger", "st-magic", "st-mail-e", "st-mail-n", "st-mail-s", "st-mail-w", "st-mirror-3<", "st-mirror-3<m", "st-mirror-3<t", "st-mirror-3<tm", "st-mirror-3>", "st-mirror-3>m", "st-mirror-3>t", "st-mirror-3>tm", "st-mirror-3^", "st-mirror-3^m", "st-mirror-3^t", "st-mirror-3^tm", "st-mirror-3v", "st-mirror-3vm", "st-mirror-3vt", "st-mirror-3vtm", "st-mirror-p-", "st-mirror-p-m", "st-mirror-p-t", "st-mirror-p-tm", "st-mirror-p/", "st-mirror-p/m", "st-mirror-p/t", "st-mirror-p/tm", "st-mirror-p\\", "st-mirror-p\\m", "st-mirror-p\\t", "st-mirror-p\\tm", "st-mirror-p|", "st-mirror-p|m", "st-mirro!
 r-p|t", "st-mirror-p|tm", "st-oneway-n", "st-oneway-e", "st-oneway-s", "st-oneway-w", "st-oneway_black-n", "st-oneway_black-e", "st-oneway_black-s", "st-oneway_black-w", "st-oneway_white-n", "st-oneway_white-e", "st-oneway_white-s", "st-oneway_white-w", "st-oxyd", "st-plain", "st-plain_break", "st-plain_cracked", "st-plain_hole", "st-plain_move", "st-polarswitch", "st-pull", "st-puzzle-hollow", "st-puzzle-n", "st-puzzle-e", "st-puzzle-s", "st-puzzle-w", "st-puzzle-ne", "st-puzzle-ns", "st-puzzle-nw", "st-puzzle-es", "st-puzzle-ew", "st-puzzle-sw", "st-puzzle-nes", "st-puzzle-new", "st-puzzle-nsw", "st-puzzle-esw", "st-puzzle-nesw", "st-puzzle2-hollow", "st-puzzle2-n", "st-puzzle2-e", "st-puzzle2-s", "st-puzzle2-w", "st-puzzle2-ne", "st-puzzle2-ns", "st-puzzle2-nw", "st-puzzle2-es", "st-puzzle2-ew", "st-puzzle2-sw", "st-puzzle2-nes", "st-puzzle2-new", "st-puzzle2-nsw", "st-puzzle2-esw", "st-puzzle2-nesw", "st-rock3_break", "st-rock3_movebreak", "st-rotator-left", "st-rotator!
 -right", "st-rotator_move-left", "st-rotator_move-right", "st-!
 rubberba
nd", "st-scissors", "st-shogun-s", "st-shogun-m", "st-shogun-l", "st-spitter", "st-stone_break", "st-stonebrush", "st-stoneimpulse", "st-stoneimpulse-hollow", "st-stoneimpulse_movable", "st-surprise", "st-swap", "st-switch", "st-switch_black", "st-switch_white", "st-thief", "st-timer", "st-timeswitch", "st-turnstile", "st-turnstile-green", "st-turnstile-e", "st-turnstile-n", "st-turnstile-s", "st-turnstile-w", "st-volcano", "st-volcano_active", "st-volcano_inactive", "st-white1", "st-white2", "st-white3", "st-white4", "st-whiteballs", "st-window", "st-wood", "st-yinyang1", "st-yinyang2", "st-yinyang3"}
+
+------
+nr=1
+for i=1,table.getn(stonelist) do
+      nr = nr+1
+      set_stone("st-switch",1+i,3, {action="callback", target="sw"..nr, name="switch"..nr})
+      func = "function sw"..nr.."() stnr="..i.."; setstone(stnr) ; end"
+      dostring(func)
+end
+
+function setstone(stnr)
+ stone=stonelist[stnr]
+ stdo=stonelist[stnr]
+ set_stone(stone,1+stnr,5)
+ set_item("it-document", 1+stnr, 1, {text=stdo})
+end
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Level with all stones of Enigma 1.00!</el:english>
+      </el:string> 
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_experimental/stones_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/1.0/data/levels/enigma_peroxyd/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/index.xml	2007-01-15 16:37:02 UTC (rev 577)
+++ branches/1.0/data/levels/enigma_peroxyd/index.xml	2007-01-17 12:26:00 UTC (rev 578)
@@ -25,7 +25,7 @@
     <level _seq="17" _title="On the Beach" _xpath="./peroxyd24_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin16" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="18" _title="Per.Oxyd 27" _xpath="./peroxyd27_1" author="Ulf Stegemann" ctrl="force" easy="true" id="20060629ulf008" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="19" _title="Per.Oxyd 28" _xpath="./peroxyd28_1" author="Ulf Stegemann" ctrl="force" easy="true" id="20070104ulf016" rel="1" rev="68" score="1" target="time" unit="duration"/>
-    <level _seq="20" _title="Per.Oxyd 29" _xpath="./peroxyd29_1" author="Ulf Stegemann" ctrl="force" easy="true" id="20061222ulf013" rel="1" rev="68" score="1" target="time" unit="duration"/>
+    <level _seq="20" _title="Per.Oxyd 29" _xpath="./peroxyd29_2" author="Ulf Stegemann" ctrl="force" easy="true" id="20061222ulf013" rel="2" rev="69" score="2" target="time" unit="duration"/>
     <level _seq="21" _title="- Meditation - " _xpath="./peroxyd30_1" author="Raoul Bourquin" ctrl="force" easy="true" id="peroxyd30" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="22" _title="- Meditation -" _xpath="./peroxyd40_1" author="Daniel Heck" ctrl="force" easy="false" id="daniel4" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="23" _title="Push and Pull" _xpath="./peroxyd44_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level1b" rel="1" rev="0" score="1" target="time" unit="duration"/>

Deleted: branches/1.0/data/levels/enigma_peroxyd/peroxyd29_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/peroxyd29_1.xml	2007-01-15 16:37:02 UTC (rev 577)
+++ branches/1.0/data/levels/enigma_peroxyd/peroxyd29_1.xml	2007-01-17 12:26:00 UTC (rev 578)
@@ -1,73 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
-  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
-  xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Per.Oxyd 29"
-        el:subtitle="Per.Oxyd 29"
-        el:id="20061222ulf013"/>
-      <el:version el:score="1" el:release="1" el:revision="$Revision: 68 $" el:status="released"/>
-      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
-        el:homepage="http://ulf.zeitform.de"/>
-      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="true" el:single="true" el:network="false" el:control="force"
-        el:scoreunit="duration" el:scoretarget="time"/>
-      <el:score el:easy="00:20" el:difficult="00:24"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- CELLS --
-cells={}
-cells[" "]=cell{floor="fl-white"}
-cells["x"]=cell{floor="fl-abyss"}
-cells["#"]=cell{stone="st-stone2"}
-if (not difficult) then -- easy
-  cells["r"]=cell{actor={"ac-top",{range=100,force=7}}}
-else
-  cells["r"]=cell{actor={"ac-top",{range=100,force=11}}}
-end
--- LANDSCAPE MAP --
-level = {
-   "xxxxxxxxxxxxxxxxxxxx",
-   "####################",
-   "#                  #",
-   "# # 0 # ######## 0 #",
-   "# # # #    #     # #",
-   "# # # ## # 0 ### # #",
-   "#   # #  #r    # # #",
-   "# ### 0 ## ### 0 # #",
-   "# #      #   #   # #",
-   "# 0 #### ### ### # #",
-   "#        O         #",
-   "####################",
-   "xxxxxxxxxxxxxxxxxxxx"
-}
-
--- GENERAL --
-enigma.ConserveLevel=TRUE
-oxyd_default_flavor = "a"
-set_default_parent(cells[" "])
-create_world_by_map(level)
-oxyd_shuffle()
-
--- ACTOR --
-if (not difficult) then -- easy
-  set_actor("ac-top",3.5,6,{range=100,force=7})
-else
-  set_actor("ac-top",3.5,6,{range=100,force=11})
-end
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-      <el:string el:key="subtitle">
-        <el:english el:translate="false"/>
-      </el:string>
-     </el:i18n>
-  </el:protected>
-</el:level>

Added: branches/1.0/data/levels/enigma_peroxyd/peroxyd29_2.xml
===================================================================
--- branches/1.0/data/levels/enigma_peroxyd/peroxyd29_2.xml	2007-01-15 16:37:02 UTC (rev 577)
+++ branches/1.0/data/levels/enigma_peroxyd/peroxyd29_2.xml	2007-01-17 12:26:00 UTC (rev 578)
@@ -0,0 +1,85 @@
+<?xml version="1.0" encoding="utf-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd"
+  xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected >
+    <el:info el:type="level">
+      <el:identity el:title="Per.Oxyd 29"
+        el:subtitle="Per.Oxyd 29"
+        el:id="20061222ulf013"/>
+      <el:version el:score="2" el:release="2" el:revision="69" el:status="released"/>
+      <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de"
+        el:homepage="http://ulf.zeitform.de"/>
+      <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+        <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+        <el:dependency el:path="lib/andreas_ghosts" el:id="lib/andreas_ghosts" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="true" el:single="true" el:network="false" el:control="force"
+        el:scoreunit="duration" el:scoretarget="time"/>
+      <el:score el:easy="00:20" el:difficult="00:24"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- -> add ghosts !!
+
+enigma.SlopeForce = 15
+
+-- CELLS --
+cells={}
+cells[" "]=cell{parent={{ghosts_set_rail,1,"fl-white"}}}
+cells["x"]=cell{floor="fl-abyss"}
+cells["#"]=cell{stone="st-stone2"}
+if (not difficult) then -- easy
+  cells["r"]=cell{parent={{ghosts_set_ghost,"ac-top",1,
+            ghosts_direction_intelligent,{range=3,force=20,gohome=FALSE}}}}
+else
+  cells["r"]=cell{parent={{ghosts_set_ghost,"ac-top",1,
+              ghosts_direction_intelligent,{range=4,force=30,gohome=FALSE}}}}
+end
+-- LANDSCAPE MAP --
+level = {
+   "xxxxxxxxxxxxxxxxxxxx",
+   "####################",
+   "#                  #",
+   "# # 0 # ######## 0 #",
+   "# # # #    #     # #",
+   "# # # ## # 0 ### # #",
+   "#   # #  #r    # # #",
+   "# ### 0 ## ### 0 # #",
+   "# #      #   #   # #",
+   "# 0 #### ### ### # #",
+   "#        O         #",
+   "####################",
+   "xxxxxxxxxxxxxxxxxxxx"
+}
+
+-- GENERAL --
+enigma.ConserveLevel=TRUE
+oxyd_default_flavor = "a"
+set_default_parent(cells[" "])
+create_world_by_map(level)
+oxyd_shuffle()
+
+-- ACTOR --
+if (not difficult) then -- easy
+  ghosts_set_ghost(3,6,"ac-top",1, ghosts_direction_intelligent,{range=3,force=20,gohome=FALSE})
+else
+  ghosts_set_ghost(3,6,"ac-top",1, ghosts_direction_intelligent,{range=4,force=30,gohome=FALSE})
+end
+
+ghosts_savedfloor[1] = "fl-abyss"
+ghosts_savedfloor[2] = "fl-abyss"
+
+set_stone("st-timer", 0, 0, {interval = ghosts_timerinterval, invisible = TRUE, action = "callback", target = "ghosts_timercallback"})
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="subtitle">
+        <el:english el:translate="false"/>
+      </el:string>
+     </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_peroxyd/peroxyd29_2.xml
___________________________________________________________________
Name: svn:eol-style
   + native



From raoul at mail.berlios.de  Wed Jan 17 18:04:44 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Wed, 17 Jan 2007 18:04:44 +0100
Subject: [Enigma-game-svn] r579 - in trunk/data: . gfx32 gfx40 gfx48
Message-ID: <200701171704.l0HH4iG5028012@sheep.berlios.de>

Author: raoul
Date: 2007-01-17 18:04:43 +0100 (Wed, 17 Jan 2007)
New Revision: 579

Removed:
   trunk/data/gfx32/sh-whiteball.png
   trunk/data/gfx40/sh-whiteball.png
   trunk/data/gfx48/sh-whiteball.png
Modified:
   trunk/data/gfx32/it-weight.png
   trunk/data/gfx40/fg-blackball.png
   trunk/data/gfx40/halo-blink.png
   trunk/data/gfx40/halo.png
   trunk/data/gfx40/it-weight.png
   trunk/data/gfx48/it-weight.png
   trunk/data/models-2d.lua
Log:
-> New image for it-weight
-> Paddig for sprites
-> Removed sh-whiteball.png



Modified: trunk/data/gfx32/it-weight.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-whiteball.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/fg-blackball.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/halo-blink.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/halo.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/it-weight.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-whiteball.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/it-weight.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-whiteball.png
===================================================================
(Binary files differ)

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2007-01-17 12:26:00 UTC (rev 578)
+++ trunk/data/models-2d.lua	2007-01-17 17:04:43 UTC (rev 579)
@@ -101,7 +101,7 @@
 -- Horse --
 -----------
 do
-    SpriteImage ("fg-horse")
+    SpriteImage ("fg-horse",0.5,0.19)
     SpriteImage ("sh-horse", 0.4)
     def_shmodel ("ac-horse", "fg-horse", "sh-horse")
 end
@@ -274,7 +274,7 @@
 -- Bug --
 ---------
 do
-    SpriteImage("fg-bug")
+    SpriteImage("fg-bug",0.5,0.44)
     def_shmodel("ac-bug", "fg-bug", "sh-whiteball-small")
 end
 



From raoul at mail.berlios.de  Fri Jan 19 18:33:01 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Fri, 19 Jan 2007 18:33:01 +0100
Subject: [Enigma-game-svn] r580 - in trunk/data: . gfx32 gfx40 gfx48
Message-ID: <200701191733.l0JHX1Bc026556@sheep.berlios.de>

Author: raoul
Date: 2007-01-19 18:32:58 +0100 (Fri, 19 Jan 2007)
New Revision: 580

Modified:
   trunk/data/gfx32/fg-blackball.png
   trunk/data/gfx40/fg-whiteball.png
   trunk/data/gfx40/halo-blink.png
   trunk/data/gfx40/halo.png
   trunk/data/gfx48/fg-blackball.png
   trunk/data/gfx48/fg-whiteball.png
   trunk/data/models-2d.lua
Log:
-> Adjusted a few things around black- and whiteballs



Modified: trunk/data/gfx32/fg-blackball.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/fg-whiteball.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/halo-blink.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/halo.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/fg-blackball.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/fg-whiteball.png
===================================================================
(Binary files differ)

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2007-01-17 17:04:43 UTC (rev 579)
+++ trunk/data/models-2d.lua	2007-01-19 17:32:58 UTC (rev 580)
@@ -24,6 +24,9 @@
 def_image("dummy")
 def_image("invisible")
 
+------------------------------------------------------------------------
+-- padding is calculated as:
+-- padding = (1.25 - 2*Actorradius)/2
 
 function SpriteImages(spriteimg, n, offsetfactor, padding)
     local factor = offsetfactor or 0.5



From ral at mail.berlios.de  Sun Jan 21 23:09:11 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 21 Jan 2007 23:09:11 +0100
Subject: [Enigma-game-svn] r581 - trunk/src
Message-ID: <200701212209.l0LM9BDP003568@sheep.berlios.de>

Author: ral
Date: 2007-01-21 23:09:09 +0100 (Sun, 21 Jan 2007)
New Revision: 581

Modified:
   trunk/src/actors.cc
   trunk/src/enigma.cc
   trunk/src/enigma.hh
   trunk/src/floors.cc
   trunk/src/items.cc
   trunk/src/laser.cc
   trunk/src/lua.cc
   trunk/src/objects.cc
   trunk/src/objects_decl.hh
   trunk/src/oxyd.cc
   trunk/src/player.cc
   trunk/src/st_switches.cc
   trunk/src/stones.cc
   trunk/src/stones_complex.cc
   trunk/src/stones_internal.hh
   trunk/src/stones_simple.cc
   trunk/src/world.cc
Log:
Reengineering of Value and get_attr()
- add a DEFAULT value that stands for not explicit set attributes
- cast operators and comparison operators for Value that allows simplified usage
- replace "Value *get_attr()" by "Value getAttr()" for traits and ivar attributes
- support for default values
- simplify usage of values with boolean content
- methods documented in doxygen


Modified: trunk/src/actors.cc
===================================================================
--- trunk/src/actors.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/actors.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -492,16 +492,11 @@
   m_target()
 {
     set_attrib("force", Value(10.0));
-    set_attrib("target1", Value());
-    set_attrib("target2", Value());
-    set_attrib("target3", Value());
-    set_attrib("target4", Value());
 }
  
 void Horse::think (double /* dtime */) 
 {
-    double force = 0;
-    double_attrib("force", &force);
+    double force = getAttr("force");
     update_target ();
     if (m_targetidx != -1) {
         add_force (normalize(m_target - get_pos()) * force);
@@ -518,7 +513,9 @@
     string targetstr;
     GridLoc loc;
 
-    if (!string_attrib (attrs[idx-1], &targetstr))
+    if (Value v = getAttr(attrs[idx-1]))
+        targetstr = v.get_string();
+    else
         return false;
     
     to_gridloc(targetstr.c_str(), loc);

Modified: trunk/src/enigma.cc
===================================================================
--- trunk/src/enigma.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/enigma.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -121,25 +121,54 @@
     return d;
 }
 
-
+
 /* -------------------- Value implementation -------------------- */
 
-Value::Value(const char* str)
-: type(STRING)
-{
+Value::Value() : type (NIL) {
+}
+
+Value::Value(const char* str) : type (STRING) {
     val.str = new char[strlen(str)+1];
     strcpy(val.str, str);
 }
 
-Value::~Value() 
-{ 
+Value::Value(double d) : type (DOUBLE) {
+     val.dval = d;
+}
+
+Value::Value(int i) : type (DOUBLE) {
+     val.dval = i;
+}
+
+Value::Value(bool b) {
+     if (b) {
+        type = DOUBLE;
+        val.dval = 1;
+     } else
+        type = NIL;
+}
+
+Value::Value(Type t) : type (t) {
+    switch (t) {
+        case DOUBLE :
+            val.dval = 0;
+            break;
+        case STRING :
+            val.str = new char[1];
+            val.str[0] = 0;
+            break;
+        case OBJECT :
+            // tbd
+            break;
+    }
+}
+
+Value::~Value() { 
     clear(); 
 }
 
 
-Value::Value(const string& str)
-: type(STRING)
-{
+Value::Value(const string& str) : type(STRING) {
     val.str = new char[str.length()+1];
     strcpy(val.str, str.c_str());
 }
@@ -153,7 +182,7 @@
         if (other.type == STRING) {
             assign(other.val.str);
         } else {
-	    clear();
+            clear();
             type = other.type;
             val = other.val;
         }
@@ -161,7 +190,77 @@
     return *this;
 }
 
+bool Value::operator==(const Value& other) const {
+    if (type != other.type)
+        return false;
+    else
+        switch (type) {
+            case DOUBLE :
+                return val.dval == other.val.dval;
+            case STRING :
+                return strcmp(val.str, other.val.str) == 0;
+            case OBJECT :
+                return false; // tbd
+        }
+    return true;
+}
 
+bool Value::operator!=(const Value& other) const {
+    return ! (*this == other);
+}
+
+bool Value::operator==(int i) const {
+    return (int) *this == i;
+}
+
+bool Value::operator!=(int i) const {
+    return (int) *this != i;
+}
+
+Value::operator bool() const {
+    if (isDefault())
+        return false;
+    else
+        return true;
+}
+
+Value::operator double() const {
+    switch (type) {
+        case DOUBLE: 
+            return val.dval;
+        case STRING:
+            return atof(val.str);  // TODO use strtod and eval remaining part of string
+        default:
+            return 0.0;
+    }
+}
+
+Value::operator int() const {
+    switch (type) {
+        case DOUBLE:
+            return round_nearest<int>(val.dval);
+        case STRING: 
+            return atoi(val.str);  //TODO use strtol and eval remaining part of string
+    default: return 0;
+    }
+}
+
+Value::operator const char*() const {
+    static std::string s;
+    switch (type) {
+        case Value::DOUBLE:
+            s = ecl::strf("%f", val.dval);
+            return s.c_str();
+        case Value::STRING: 
+            return val.str;
+        case Value::NIL:
+        case Value::DEFAULT:
+        default: 
+            s.clear();
+            return s.c_str();
+    }
+}
+
 void Value::assign(const char* s) {
     clear();
     type = STRING;
@@ -169,114 +268,63 @@
     strcpy(val.str, s);
 }
 
-void Value::assign(double d) 
-{ 
+void Value::assign(double d) { 
     clear(); type=DOUBLE; val.dval=d; 
 }
 
-
 void Value::clear() {
     if (type == STRING)
 	delete[] val.str;
     type = NIL;
 }
 
-double Value::get_double() const throw()
-{
+Value::Type Value::getType() const {
+    return type;
+}
+
+double Value::get_double() const throw(){
     ASSERT(type == DOUBLE, XLevelRuntime, "get_double: type not double");
     return val.dval;
 }
 
-const char* Value::get_string() const throw()
-{
+const char* Value::get_string() const throw() {
     ASSERT(type == STRING, XLevelRuntime, "get_string: type not string");
     return val.str;
 }
 
-Buffer& enigma::operator<<(Buffer& buf, const Value& val)
-{
-    buf << Uint8(val.get_type());
+bool Value::isDefault() const {
+    return type == DEFAULT;
+}
 
-    switch (val.get_type()) {
-    case Value::NIL:
-        break;
-    case Value::DOUBLE:
-        buf << val.get_double();
-        break;
-    case Value::STRING:
-        {
-            const char* str = val.get_string();
-            buf << (Uint16)strlen(str);
-            buf.write(str, strlen(str));
-        } break;
+std::string Value::to_string() const{
+    return std::string(*this);
+}
+
+bool Value::to_bool() const {
+    switch (type) {
+        case NIL :
+        case DEFAULT :
+            return false;
+        default :
+            return true;
     }
-    return buf;
 }
 
-// Buffer& enigma::operator>>(Buffer& buf, Value& val)
-// {
-//     Uint8 type = Value::NIL;
-//     buf >> type;
 
-//     switch (type) {
-//     case Value::NIL:
-//         // ## fixme
-//         break;
-//     case Value::DOUBLE:
-//         {
-//             double tmp;
-//             if (buf >> tmp)
-//                 val = Value(tmp);
-//         } break;
-//     case Value::STRING:
-//         {
-//             Uint16 len;
-//             if (buf >> len) {
-//                 char* tmp = new char[len+1];
-//                 tmp[len] = 0;
-//                 if (buf.read(tmp, len))
-//                     val.assign(tmp);
-//                 delete[] tmp;
-//             }
-//         } break;
-//     }
-//     return buf;
-// }
-
 int enigma::to_int(const Value &v) {
-    switch (v.get_type()) {
-    case Value::DOUBLE: return round_nearest<int>(v.get_double());
-    case Value::STRING: return atoi(v.get_string());
-    default: return 0;
-    }
+    return v;
 }
 
 bool enigma::to_bool(const Value &v) {
-    return (v.get_type() != Value::NIL);
+    return v.to_bool();
 }
 
 double enigma::to_double(const Value &v) {
-    switch (v.get_type()) {
-    case Value::DOUBLE: return v.get_double();
-    case Value::STRING: return atof(v.get_string());
-    default: return 0;
-    }
+    return v;
 }
 
-#ifdef _MSC_VER
-#define snprintf _snprintf
-#endif
-
-const char * enigma::to_string(const Value &v) {
-    static char buf[30];
-    switch (v.get_type()) {
-    case Value::NIL: return "";
-    case Value::DOUBLE:
-        snprintf(buf, sizeof(buf), "%f", v.get_double());
-        return buf;
-    case Value::STRING: return v.get_string();
-    default: return 0;
-    }
+std::string enigma::to_string(const Value &v) {
+    return v.to_string();
 }
 
 Direction enigma::to_direction (const Value &v) {
@@ -284,16 +332,6 @@
     return static_cast<Direction>(val);
 }
 
-ostream& enigma::operator<<(ostream& os, const Value& val)
-{
-    switch (val.get_type()) {
-    case Value::NIL:   os << "nil"; break;
-    case Value::DOUBLE: os << val.get_double(); break;
-    case Value::STRING: os << val.get_string(); break;
-    }
-    return os;
-}
-
 /* -------------------- GridPos -------------------- */
 
 GridPos::GridPos(const ecl::V2& p) 

Modified: trunk/src/enigma.hh
===================================================================
--- trunk/src/enigma.hh	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/enigma.hh	2007-01-21 22:09:09 UTC (rev 581)
@@ -126,27 +126,169 @@
 
 /* -------------------- Value -------------------- */
 
+    /**
+     * A flexible container for various types of data. This class is one
+     * of the central Enigma concepts. It is used for Object attributes,
+     * for passing arguments and return values in messages and for exchanging
+     * values with LUA code.
+     * 
+     * Object attributes besides the common floor, item, stone, actor traits
+     * are usually very specific and only few objects will be aware of
+     * them. The Value provides a common container, that allows all objects
+     * and the world to pass these attributes without any further knowledge.
+     * 
+     * Instances of Value can be passed to and from the type free LUA language.
+     * Objects can be configured in their attributes and questioned about states
+     * via attributes.
+     * 
+     * Value are converted to required types as far as possible and in a
+     * LUA compatible manner.
+     * 
+     * Due to the history of Enigma and LUA the bool values are not a native
+     * type. The value "false" is coded as type "NIL". Every Value besides
+     * type "NIL" and "DEFAULT" is interpreted as "true". All attributes 
+     * should be declared with a default value of "false". Bool Values can
+     * not be assigned directly to a bool variable. Use the to_bool() method
+     * for retrieving proper bool values.
+     * 
+     * A special Value type called "DEFAULT" exists within the C++ engine. It
+     * describes a not existing Value. The receiver of this Value should use
+     * or request the default behaviour. "DEFAULT" Values are the only Values
+     * that are converted to bool "false". All other Values convert to bool 
+     * "true". Thus a value can be checked for existance by evaluating it as a
+     * bool. This remains true even for Values that contain bool content! A
+     * common pattern for handling Values is:
+     * 
+     * <pre>
+     * if (Value v = getAttr("key")) {   // proceed only if attribute exists
+     *     int i = v;                    // assign value to an int
+     *     std::string s(v);             // create a string out of a value
+     *     x = (double)v * 2;            // cast v to a desired type
+     *     double d = getAttr("x", 2);   // get a value with a default of 2.0
+     * }
+     * </pre>
+     */
     class Value {
     public:
-        enum Type { NIL, DOUBLE, STRING };
+        /**
+         * Specifier for the current type of the value content.
+         */
+        enum Type { 
+            DEFAULT,  ///< Pseudotype for a not existing attribute that should
+                      ///< cause the default behaviour of the object
+            NIL,      ///< Value that is equivalent to Lua "nil". It represents
+                      ///< the bool "false"
+            DOUBLE,   ///< Value is numerical and can take a "double". It is used
+                      ///< for other numericals values like "int", too.
+            STRING,   ///< Value is a string. Such a string may encode another
+                      ///< type that has no native representation in Value
+            OBJECT    ///< Value is an object id. The id is a persistent object
+                      ///< identifier.
+        };
 
-        Value() : type(NIL) {}
-        Value(double d) : type(DOUBLE) { val.dval = d; }
-        Value(const char* str);
-        Value(const std::string& str);
+        Value();                       ///< Constructor for NIL value that 
+                                       ///< represents boolean "false", too 
+        Value(double d);               ///< Constructor for DOUBLE value
+        Value(const char* str);        ///< Constructor for STRING value. The
+                                       ///< given string is duplicated
+        Value(const std::string& str); ///< Constructor for STRING value. The
+                                       ///< given string is duplicated
+        Value(int i);                  ///< Constructor for DOUBLE value
+        Value(bool b);                 ///< Constructor for a value that properly
+                                       ///< represents the given bool
+        Value(Type t);                 ///< Constructor for a given type. The
+                                       ///< value defaults to 0.0 or ""
         ~Value();
 
-        Value(const Value& v);
-        Value& operator=(const Value& v);
+        Value(const Value& v);                 ///< Explicit copy constructor that
+                                               ///< performs a deep copy
+        Value& operator=(const Value& v);      ///< Explicit copy assignment that
+                                               ///< performs a deep copy
+        /**
+         * Compare values in type and value. This compare is a LUA like
+         * compare of values. Note that a DOUBLE value of 1.0 does not equal
+         * a STRING value of "1.0" even though both values are seamless casted
+         * to the same double and result in the same numerical calculation results.
+         * 
+         * If you want to compare two values that express numerical data independent
+         * of their value type use the pattern:
+         * <pre>
+         *     (double) value1 == (double) value2
+         * </pre>
+         */
+        bool operator==(const Value& v) const;
+        bool operator!=(const Value& v) const; ///< Compare values in type and value
+        bool operator==(int i) const;          ///< Compare value with int without casting.
+                                               ///< f.e <code>if (v == 2)</code>
+        bool operator!=(int i) const;          ///< Compare value with int without casting
+        
+        /**
+         * Test of a value for explicit existence besides a default.
+         * This conversion returns "false" if the value is of type DEFAULT.
+         * This happens when a "getAttr()" call did not find a concrete value.
+         * All other value types that represent explicit given values return "true".
+         * The main usage is the common pattern <code>if (Value v = getAttr("key"))</code>.
+         * 
+         * Note: this conversion does not return the result of a boolean stored
+         * in the value. If a concrete value contains a boolean this test
+         * returns always "true", even if the boolean is "false" and the value
+         * is of type NIL.
+         */
+        operator bool() const;
+        
+        /**
+         * Conversion of a value to a double. String values are interpreted as
+         * a double like it is done by LUA. All other values default to a double
+         * value of 0.0.
+         */
+        operator double() const;
+         
+        /**
+         * Conversion of a value to a int. String values are interpreted as
+         * a int like it is done by LUA. All other values default to a int
+         * value of 0.
+         */
+        operator int() const;
+        
+        /**
+         * Conversion of a value to a <code>char *</code> just for initialization
+         * of a std::string. Numerical values are converted to a string like it
+         * id done by LUA. All other values default to an empty string.
+         * 
+         * Note that the returned pointer may be volatile and
+         * cannot be used for any further usage besides immediate initialization of
+         * a string object. For all other purposes use the <code>to_string()</code> method to
+         * receive a non-volatile copy of the string.
+         */
+        operator const char*() const;
 
-        void assign(double d);
-        void assign(const char* s);
+        void assign(double d);       ///< Reset value to a DOUBLE
+        void assign(const char* s);  ///< Reset value to a STRING with a copy of
+                                     ///< the given string
 
-        Type    get_type() const { return type; }
-        double  get_double() const throw();
-        const char* get_string() const throw();
+        Type    getType() const;               ///< Returns the current value type
+        double  get_double() const throw();     ///< Returns the current double value without
+                                                ///< any conversion if it is a DOUBLE.
+                                                ///< On type mismatch a XLevelRuntime is thrown
+        const char* get_string() const throw(); ///< Returns the current string value without
+                                                ///< any conversion if it is a STRING.
+                                                ///< On type mismatch a XLevelRuntime is thrown
+        bool isDefault() const;                 ///< Returns true if type is DEFAULT
+        
+        /**
+         * Returns a std::string with convertion of numerical values. All other
+         * values default to an empty string.
+         */
+        std::string to_string() const;
+        
+        /**
+         * Returns the LUA compatible boolean representation of the value.
+         * <code>false</code> is returned for a NIL value and <code>true</code>
+         * for any other value.
+         */
+        bool to_bool() const;
     private:
-        void clear();
+        void clear();      ///< Release resources and assign type NIL
 
         // Variables
         Type type;
@@ -156,17 +298,13 @@
         } val;
     };
 
-    ecl::Buffer& operator<<(ecl::Buffer& buf, const Value& val);
-//     ecl::Buffer& operator>>(ecl::Buffer& buf, Value& val);
 
-    std::ostream& operator<<(std::ostream& os, const Value& val);
+    bool        to_bool(const Value &v);        ///< Synonym for v.to_bool()
+    int         to_int(const Value &v);         ///< Synonym for (int)v
+    double      to_double(const Value &v);      ///< Synonym for (double)v
+    std::string to_string(const Value &v);      ///< Synonym for v.to_string()
+    Direction   to_direction (const Value &v);  ///< Casting of value to Direction
 
-    bool        to_bool(const Value &v);
-    int         to_int(const Value &v);
-    double      to_double(const Value &v);
-    const char *to_string(const Value &v);
-    Direction   to_direction (const Value &v);
-
 /* -------------------- Timers -------------------- */
 
     /* Interface for time event handlers. */

Modified: trunk/src/floors.cc
===================================================================
--- trunk/src/floors.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/floors.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -418,23 +418,25 @@
                 return (selector == flft_burnable) && !has_flags(it, itf_fireproof);
         }
     }
-    if(selector == flft_burnable)
-        if(const Value *v = get_attrib("burnable"))  return to_int(*v) == 1;
-    if(selector == flft_ignitable)
-        if(const Value *v = get_attrib("ignitable")) return to_int(*v) == 1;
-    if(selector == flft_secure)
-        if(const Value *v = get_attrib("secure"))    return to_int(*v) == 1;
-    if(selector == flft_eternal)
-        if(const Value *v = get_attrib("eternal"))   return to_int(*v) == 1;
-    if(selector == flft_noash)
-        if(const Value *v = get_attrib("noash"))     return to_int(*v) == 1;
-    if(selector == flft_fastfire)
-        if(const Value *v = get_attrib("fastfire"))  return to_int(*v) == 1;
-    if(selector == flft_initfire)
-        if(const Value *v = get_attrib("initfire"))  return to_int(*v) == 1;
-    if(server::GameCompatibility == GAMET_ENIGMA)
-        return traits.firetype & selector;
+    if ((server::GameCompatibility == GAMET_ENIGMA) && (traits.firetype & selector))
+        return true;
     // In non-Enigma-modes, without items on them, all floors behave the same:
+    switch (selector) {
+        case flft_burnable :
+            return getAttr("burnable") != 0;   // no !=0 compare if attribute is boolean
+        case flft_ignitable :
+            return getAttr("ignitable") != 0;  //  ...
+        case flft_secure :
+            return getAttr("secure") != 0;
+        case flft_eternal :
+            return getAttr("eternal") != 0;
+        case flft_noash :
+            return getAttr("noash") != 0;
+        case flft_fastfire :
+            return getAttr("fastfire") != 0;
+        case flft_initfire :
+            return getAttr("initfire") != 0;
+    }
     return false;
 }
 
@@ -554,7 +556,7 @@
     private:
         void actor_enter(Actor *) {
             static int lastCode = -1;
-            int        code     = int_attrib("code");
+            int        code     = getAttr("code");
             if (lastCode != code) {
                 fprintf(stderr, "Entering floor 0x%x\n", code);
                 lastCode = code;
@@ -708,7 +710,7 @@
 
         char get_type() const {
             string type = "a";
-            string_attrib("type", &type);
+            if (Value v = getAttr("type")) type = v.get_string();
             return type[0];
         }
 
@@ -883,7 +885,7 @@
         state = EMERGING;
         m_affected_actor = a;
         affected_player = -1;
-        m_affected_actor->int_attrib("player", &affected_player);
+        if (Value v = m_affected_actor->getAttr("player")) affected_player = v;
     }
 }
 

Modified: trunk/src/items.cc
===================================================================
--- trunk/src/items.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/items.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -182,7 +182,7 @@
         }
 
         bool is_on() const {
-            return int_attrib("on") == 1;
+            return getAttr("on") == 1;
         }
 
         void set_on (bool newon) {
@@ -233,11 +233,11 @@
         DECL_TRAITS;
 
         void on_pickup(Actor *) {
-            int code = int_attrib("code");
+            int code = getAttr("code");
             fprintf(stderr, "Picked up item 0x%x\n", code);
         }
         void on_drop(Actor *) {
-            int code = int_attrib("code");
+            int code = getAttr("code");
             fprintf(stderr, "Dropped item 0x%x\n", code);
         }
     public:
@@ -451,8 +451,7 @@
                 for (int idx=0; GetSignalTargetPos (this, keystonepos, idx); ++idx) {
                     Stone *st = GetStone(keystonepos);
                     if (st && st->is_kind("st-key"))
-                        st->set_attrib("keycode",
-                                       int_attrib("keycode"));
+                        st->set_attrib("keycode", getAttr("keycode"));
                 }
             }
             return Value();
@@ -847,7 +846,7 @@
          hi != instances.end(); ++hi)
     {
         const Hollow& h         = **hi;
-        bool          essential = h.int_attrib("essential") != 0;
+        bool          essential = (h.getAttr("essential") != 0);
 
         if (h.whiteball && (server::LevelTime - h.enter_time) >= MINTIME) {
             if (essential) ess_wcnt++;
@@ -865,10 +864,7 @@
 }
 
 void Hollow::setup_successor(Item *newitem) {
-    const Value *essential = get_attrib("essential");
-    if (essential != NULL) {
-        newitem->set_attrib("essential",*essential);
-    }
+    newitem->set_attrib("essential", getAttr("essential"));
 }
 
 
@@ -1070,8 +1066,8 @@
 
         ItemAction activate(Actor *, GridPos)
         {
-            string txt;
-            if (string_attrib ("text", &txt)) {
+            if (Value v = getAttr("text")) {
+                std::string txt(v);
                 lev::Proxy *level = lev::Proxy::loadedLevel();
                 // after complete switch to Proxy as levelloader the following
                 // conditional can be abolished
@@ -1360,7 +1356,7 @@
 
 void Trigger::init_model()
 {
-    if (int_attrib("invisible"))
+    if (getAttr("invisible") != 0)
         set_model("invisible");
     else if (m_pressedp)
         set_model("it-trigger1");
@@ -1594,25 +1590,21 @@
         DECL_TRAITS_ARRAY(2, is_on());
     public:
         Magnet(bool onoff) : OnOffItem (onoff) {
-            set_attrib ("strength", Value()); // 30.0
-            set_attrib ("range", Value());
         }
     private:
         void on_creation (GridPos p) {
-            double range = server::MagnetRange;
-	    double_attrib("range", &range);
+            double range = getAttr("range", server::MagnetRange);
+            double strength = getAttr("strength", server::MagnetForce);
 
-            double strength = server::MagnetForce;
-	    double_attrib("strength", &strength);
-
             ff.m_active = is_on();
             ff.set_pos (p);
-	    ff.set_range (range);
-	    ff.set_strength (strength);
+	        ff.set_range (range);
+	        ff.set_strength (strength);
 
             world::AddForceField(&ff);
             Item::on_creation (p);
         }
+        
         void on_removal (GridPos p) {
             Item::on_removal(p);
             world::RemoveForceField(&ff);
@@ -1679,11 +1671,6 @@
         DECL_TRAITS_ARRAY(2, is_on());
     public:
         WormHole(bool onoff_) : OnOffItem(onoff_) {
-            set_attrib("targetx", Value());
-            set_attrib("targety", Value());
-            set_attrib("strength", Value());
-            set_attrib("range", Value());
-            set_attrib("interval", Value()); // see get_interval() for default
             state = TELEPORT_IDLE;
             justWarping = false;
         }
@@ -1716,12 +1703,10 @@
         void set_forcefield() {
             if (is_on()) {
                 ff.set_pos(get_pos());
-                double range = server::WormholeRange;
-                double_attrib("range", &range);
+                double range = getAttr("range", server::WormholeRange);
                 ff.set_range (range);
 
-                double s = server::WormholeForce;
-                double_attrib("strength", &s);
+                double s = getAttr("strength", server::WormholeForce);
                 ff.set_strength (s);
 
                 world::AddForceField(&ff);
@@ -1737,9 +1722,7 @@
         bool get_target (V2 &targetpos);
 
         double get_interval() const {
-            double interval = 0.0;
-            double_attrib("interval", &interval);
-            return interval;
+            return getAttr("interval");
         }
 
         // Variables.
@@ -1754,9 +1737,11 @@
 }
 
 bool WormHole::get_target(V2 &targetpos) {
-    V2 t;
-    if (double_attrib("targetx", &t[0]) && double_attrib("targety", &t[1])) {
-        targetpos = t;
+    Value vx = getAttr("targetx");
+    Value vy = getAttr("targety");
+    if (vx && vy) {
+        targetpos[0] = vx;
+        targetpos[1] = vy;
         return true;
     }
     else {
@@ -1907,9 +1892,6 @@
   m_target_index (0),
   m_target_vortex(0)
 {
-    set_attrib ("autoclose", Value());
-    set_attrib ("targetx", Value());
-    set_attrib ("targety", Value());
 }
 
 void Vortex::prepare_for_warp (Actor *actor)
@@ -2015,9 +1997,11 @@
     }
     // no signal defined
     else if (idx == 0) {
-        V2 t;
-        if (double_attrib("targetx", &t[0]) && double_attrib("targety", &t[1])) {
-            target = t;
+        Value vx = getAttr("targetx");
+        Value vy = getAttr("targety");
+        if (vx && vy) {
+            target[0] = vx;
+            target[1] = vy;
             return true;
         }
     }
@@ -2288,17 +2272,16 @@
             {
                 set_attrib("type", type);
                 set_attrib("fixed", 0.0);
-                set_attrib("brittleness", Value());
              }
 
         enum State { IDLE, CRACKING1, CRACKING2 } state;
         bool anim_end;
 
         int get_type() const {
-            int t = int_attrib("type");
+            int t = getAttr("type");
             return ecl::Clamp(t, 0, 4);
         }
-	    bool is_fixed() const { return int_attrib("fixed") != 0; }
+	    bool is_fixed() const { return getAttr("fixed") != 0; }
 
         void init_model() {
             if (int t=get_type()) {
@@ -2358,7 +2341,7 @@
             if (msg == "crack" && state==IDLE && !is_fixed()) {
                 int type = get_type();
                 if ((type == 0 && do_crack()) || (type > 0)) {
-                    set_attrib("type", Value(int_attrib("type") + 1));
+                    set_attrib("type", Value((int)getAttr("type") + 1));
                     sound_event ("crack");
                     init_model();
                 }
@@ -2372,14 +2355,12 @@
         }
 
         bool do_crack() {
-	    if (!is_fixed()) {
-		double brittleness = server::Brittleness;
-		double_attrib ("brittleness", &brittleness);
-		double rnd = DoubleRand(0, 1);
-		return rnd < brittleness;
-	    }
-	    else
-		return false;
+            if (!is_fixed()) {
+                double brittleness = getAttr("brittleness", server::Brittleness);
+                double rnd = DoubleRand(0, 1);
+                return rnd < brittleness;
+    	    } else
+                return false;
         }
     };
     ItemTraits Crack::traits[4] = {
@@ -2515,7 +2496,7 @@
     	    set_attrib("load", load);
         }
 
-        int get_load() const { return ecl::Clamp<int>(int_attrib("load"),0,2); }
+        int get_load() const { return ecl::Clamp<int>(getAttr("load"),0,2); }
         void set_load (int load) { set_attrib("load", ecl::Clamp<int>(load,0,2)); }
 
         void extinguish (GridPos p) {
@@ -2716,10 +2697,9 @@
         int open = -1;
 
         if (msg == "signal") {
-            if (val.get_type() == Value::DOUBLE) {
+            if (val.getType() == Value::DOUBLE) {
                 // val: 1 means "shrink", 0 means "grow"
-                open = static_cast<int>(val.get_double());
-//                 warning("received signal %i", open);
+                open = (int)val;
             }
             else {
                 ASSERT(0, XLevelRuntime, "Blocker: message 'signal' with wrong typed value");
@@ -3143,7 +3123,7 @@
         bool m_active;
 
         void actor_enter(Actor *a) {
-            if (!m_active && a->get_attrib("player") != 0) {
+            if (!m_active && a->getAttr("player")) {
                 GameTimer.set_alarm (this, 10);
             }
         }
@@ -3436,9 +3416,8 @@
         info->pos = olda->get_pos();
         info->vel = olda->get_vel();
 
-        int iplayer;
-        if (olda->int_attrib("player", &iplayer)) {
-            player::ReplaceActor (iplayer, olda, newa);
+        if (Value v = olda->getAttr("player")) {
+            player::ReplaceActor((int)v, olda, newa);
         }
 
         world::AddActor (newa);
@@ -3476,7 +3455,7 @@
         {
             const double ROTOR_LIFETIME = 5.0;
 
-            int     iplayer = a->int_attrib("player");
+            int     iplayer = a->getAttr("player");
             ActorID id      = get_id (a);
 
             if (id == ac_blackball || id == ac_whiteball) {
@@ -3487,10 +3466,13 @@
                 rotor->set_attrib ("controllers", Value (iplayer+1));
                 rotor->set_attrib ("player", Value (iplayer));
                 rotor->set_attrib ("gohome", Value (0.0));
-                rotor->set_attrib ("essential", Value(a->int_attrib("essential")));
+                rotor->set_attrib ("essential", a->getAttr("essential"));
                 std::string essId;
-                if (!a->string_attrib ("essential_id", &essId))
+                if (Value v = a->getAttr("essential_id")) {
+                    essId = v.to_string();
+                } else {
                     essId = a->get_traits().name;
+                }
                 rotor->set_attrib ("essential_id", Value(essId));
 
                 replace_actor (a, rotor);
@@ -3517,12 +3499,10 @@
 
         ItemAction activate(Actor *a, GridPos p) {
             // Default values for the rubberband:
-            double strength = 10.0;
-            double length = 1.0;
-            double minlength = 0.0;
-            double_attrib ("strength", &strength);
-            double_attrib ("length", &length);
-            double_attrib ("minlength", &minlength);
+            double strength = getAttr("strength", 10.0);
+            double length = getAttr("length", 1.0);
+            double minlength = getAttr("minlength", 0.0);
+            
 
             world::RubberBandData rbd;
             rbd.strength = strength;
@@ -3530,16 +3510,15 @@
             rbd.minlength = minlength;
 
             // Target to connect to, default: ""
-            string target = "";
-            string_attrib("target",&target);
+            std::string target(getAttr("target"));
+            
             // TODO: Multiple Targets!
             // TODO: Target for black and target for white marble?
             // TODO: MultiplayerGame: Defaulttarget is second actor!
 
             // The mode attribute "scissor" defines, if when using an it-rubberband,
             // other rubberbands to the actor will be cut of or not, true means they will. false is default.
-            enigma::Value const *scissorValue = get_attrib("scissor");
-            bool isScissor = (scissorValue == NULL)? false : to_bool(*scissorValue);
+            bool isScissor = to_bool(getAttr("scissor"));
 
             // Get actor or stone with the name, given in "connect_to":
             Actor *target_actor = dynamic_cast<Actor*>(GetNamedObject(target));

Modified: trunk/src/laser.cc
===================================================================
--- trunk/src/laser.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/laser.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -133,7 +133,7 @@
 
         // Private methods.
         void emit_light();
-        Direction get_dir() const {return Direction(int_attrib("dir"));}
+        Direction get_dir() const {return to_direction(getAttr("dir"));}
 
         // Stone interface.
         void on_creation (GridPos p);
@@ -446,11 +446,11 @@
     protected:
         MirrorStone(const char *name, bool movable=false, bool transparent=false);
 
-        bool is_transparent() const { return int_attrib("transparent") != 0; }
-        bool is_movable() const { return int_attrib("movable") != 0; }
+        bool is_transparent() const { return getAttr("transparent") != 0; }
+        bool is_movable() const { return getAttr("movable") != 0; }
 
         void set_orientation(int o) { set_attrib("orientation", o); }
-        int get_orientation() { return int_attrib("orientation"); }
+        int get_orientation() { return getAttr("orientation"); }
 
         void emit_light(Direction dir) {
             if (!has_dir(outdirs, dir))

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/lua.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -76,14 +76,14 @@
     lua::Error _lua_err_code (int i)
     {
         switch (i) {
-	case 0: return NO_LUAERROR;
-	case LUA_ERRRUN: return ERRRUN;
-	case LUA_ERRFILE: return ERRFILE;
-	case LUA_ERRSYNTAX: return ERRSYNTAX;
-	case LUA_ERRMEM: return ERRMEM;
-	case LUA_ERRERR: return ERRERR;
-	}
-	assert (!"Should never get there!");
+            case 0: return NO_LUAERROR;
+            case LUA_ERRRUN: return ERRRUN;
+            case LUA_ERRFILE: return ERRFILE;
+            case LUA_ERRSYNTAX: return ERRSYNTAX;
+            case LUA_ERRMEM: return ERRMEM;
+            case LUA_ERRERR: return ERRERR;
+        }
+        assert (!"Should never get there!");
     }
 
     void throwLuaError(lua_State * L, const char * message) {
@@ -146,10 +146,17 @@
 static void
 push_value(lua_State *L, const Value &val)
 {
-    switch (val.get_type()) {
-    case Value::NIL: lua_pushnil(L); break;
-    case Value::DOUBLE: lua_pushnumber(L, to_double(val)); break;
-    case Value::STRING: lua_pushstring(L, to_string(val)); break;
+    switch (val.getType()) {
+        case Value::NIL:
+        case Value::DEFAULT :
+            lua_pushnil(L);
+            break;
+        case Value::DOUBLE:
+            lua_pushnumber(L, val.get_double());
+            break;
+        case Value::STRING:
+            lua_pushstring(L, val.get_string());
+            break;
     }
 }
 
@@ -258,13 +265,7 @@
         return 0;
     }
 
-    const Value *v =  obj->get_attrib(key);
-    if (!v) {
-        // unknown attribute
-        lua_pushnil(L);
-    }
-    else
-        push_value(L, *v);
+    push_value(L, obj->getAttr(key));
     return 1;
 }
 

Modified: trunk/src/objects.cc
===================================================================
--- trunk/src/objects.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/objects.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -100,11 +100,9 @@
 }
 
 
-const char *
-Object::get_kind() const
-{
+const char * Object::get_kind() const {      // To be made pure virtual
     const Value *v = get_attrib("kind");
-    ASSERT(v && v->get_type()==Value::STRING, XLevelRuntime,
+    ASSERT(v && v->getType() == Value::STRING, XLevelRuntime,
         "Object: attribute kind is not of type string (found in get_kind)");
     return v->get_string();
 }
@@ -120,10 +118,12 @@
 }
 
 void Object::set_attrib(const string& key, const Value& val) {
-    attribs[key] = val;//.insert (key, val);
+    if (val)         // only set non-default values
+        attribs[key] = val;  //.insert (key, val);
 }
 
-const Value* Object::get_attrib(const string& key) const {
+const Value* Object::get_attrib(const string& key) const { // To be delete as soon as
+                                                           // get_kind() has no need of it
     AttribMap::const_iterator i = attribs.find(key);
     if (i == attribs.end())
         return 0;
@@ -131,44 +131,30 @@
         return &i->second;
 }
 
-bool Object::string_attrib(const string &name, string *val) const {
-    if (const Value *v = get_attrib(name)) {
-        if (v->get_type() != Value::NIL) {
-            const char *s = to_string(*v);
-            if (s != 0) {
-                *val = s;
-                return true;
-            }
-        }
-    }
-    return false;
+Value Object::getAttr(const string& key) const {
+    AttribMap::const_iterator i = attribs.find(key);
+    if (i == attribs.end())
+        return Value(Value::DEFAULT);
+    else
+        return i->second;
 }
 
-int Object::int_attrib(const string &name) const {
-    if (const Value *v = get_attrib(name))
-        return to_int(*v);
-    return 0;
+Value Object::getAttr(const string& key, Value defaultValue) const {
+    if (Value v = getAttr(key))
+        return v;
+    else
+        return defaultValue;
 }
 
-bool Object::int_attrib(const string &name, int *val) const {
-    if (const Value *v = get_attrib(name)) {
-        *val = to_int(*v);
-        return true;
-    }
-    return false;
+Value Object::getValue(const string& key) const {
+    return getAttr(key);       // TODO write template method
 }
 
-
-bool Object::double_attrib(const string &name, double *val) const {
-    if (const Value *v = get_attrib(name)) {
-        if (v->get_type() != Value::NIL) {
-            *val = to_double(*v);
-            return true;
-        }
-    }
-    return false;
+Value Object::getDefaultValue(const string &key) const {
+    return Value(Value::DEFAULT);
 }
 
+
 /* Send an impulse to position 'dest' into direction dir.  If 'dest'
    contains a stone, on_impulse() is called for that stone */
 void Object::send_impulse(const GridPos& dest, Direction dir) 

Modified: trunk/src/objects_decl.hh
===================================================================
--- trunk/src/objects_decl.hh	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/objects_decl.hh	2007-01-21 22:09:09 UTC (rev 581)
@@ -57,16 +57,20 @@
 
         typedef ecl::AssocList<std::string, Value> AttribMap;
 
-        bool string_attrib (const string &name, string *val) const;
-        int  int_attrib (const string &name) const;
-        bool int_attrib (const string &name, int *val) const;
-        bool double_attrib (const string &name, double *val) const;
-
         bool is_kind(const char *kind) const;
         bool is_kind(const string& kind) const;
 
         const AttribMap &get_attribs() const { return attribs; }
+        
+        /**
+         * Get an attribute or a special given default value. This method
+         * gets attributes like the simple argumented getAttr method but
+         * returns the given default value instead of a DEFAULT value if
+         * no explicit attribute exists.
+         */
+        Value getAttr(const string &key, Value defaultValue) const;
 
+
         /* ---------- Helper routines ---------- */
 
         void send_impulse(const GridPos& dest, Direction dir);
@@ -79,7 +83,31 @@
         virtual Value on_message (const Message &m);
         virtual Value message(const string& msg, const Value &val);
         virtual void set_attrib(const string& key, const Value &val);
-        virtual const Value* get_attrib(const string& key) const;
+        
+        /**
+         * Get an attribute that has been set or that stands as a proxy for a
+         * trait or ivar. Object itself will just return attribute values
+         * that are stored in its attribute map. For not existing attributes
+         * a value of type DEFAULT is returned.
+         * 
+         * Subclasses may override this method to supply values of traits or
+         * ivars. This way levels can gain read access to attributes that can
+         * not to be stored in the attribute map due to performance reasons.
+         */
+        virtual Value getAttr(const string &key) const;
+        
+        /**
+         * Get the attribute, traits, ivar or default value for a given key.
+         * This is the main access method for object values that returns
+         * the best available value known for a key. It resolves attributes,
+         * uses proxy values for ivars and traits, uses class defaults,
+         * world defaults or system defaults.
+         * 
+         * This is a template method. Subclass have to override the method
+         * <code>getDefaultValue()</code> to supply proper class defaults.
+         * All other defaults are resolved by this method
+         */
+        Value getValue(const string &key) const;
 
         virtual Object *clone()=0;
         virtual void dispose()=0;
@@ -88,7 +116,10 @@
 
         virtual void warning(const char *format, ...) const;
 
+    protected:
+        virtual Value getDefaultValue(const string &key) const;
     private:
+        const Value* get_attrib(const string& key) const;
         AttribMap attribs;
     };
 

Modified: trunk/src/oxyd.cc
===================================================================
--- trunk/src/oxyd.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/oxyd.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -93,21 +93,21 @@
         for (unsigned y=0; y<sgrid.getHeight(); ++y)
             for (unsigned x=0; x<sgrid.getWidth(); ++x)
                 if (Stone *st = world::GetStone(GridPos(x, y)))
-                    if (int code = st->int_attrib("code"))
+                    if (int code = st->getAttr("code"))
                         stones.insert(code);
 
         const Grid &igrid = level.getGrid (GridType_Objects);
         for (unsigned y=0; y<igrid.getHeight(); ++y)
             for (unsigned x=0; x<igrid.getWidth(); ++x)
                 if (Item *it = world::GetItem(GridPos(x, y)))
-                    if (int code = it->int_attrib("code"))
+                    if (int code = it->getAttr("code"))
                         items.insert(code);
 
         const Grid &fgrid = level.getGrid (GridType_Objects);
         for (unsigned y=0; y<fgrid.getHeight(); ++y)
             for (unsigned x=0; x<fgrid.getWidth(); ++x)
                 if (world::Floor *fl = world::GetFloor(GridPos(x, y)))
-                    if (int code = fl->int_attrib("code"))
+                    if (int code = fl->getAttr("code"))
                         floors.insert(code);
 
         if (!stones.empty()) {

Modified: trunk/src/player.cc
===================================================================
--- trunk/src/player.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/player.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -235,8 +235,8 @@
 
 Inventory * player::GetInventory (Actor *a) 
 {
-    if (const Value *v = a->get_attrib("player"))
-        return GetInventory(to_int(*v));
+    if (Value v = a->getAttr("player"))
+        return GetInventory((int)v);
     return 0;
 }
 
@@ -285,10 +285,8 @@
         vector<Actor *> &al = players[i].actors;
 
         for (unsigned j=0; j<al.size(); ++j) {
-            const Value *val = al[j]->get_attrib(black ? "blackball" : "whiteball");
-            if (val) {
+            if (al[j]->getAttr(black ? "blackball" : "whiteball"))
                 al[j]->set_respawnpos(center);
-            }
         }
     }
 }
@@ -299,10 +297,8 @@
         vector<Actor *> &al = players[i].actors;
 
         for (unsigned j=0; j<al.size(); ++j) {
-            const Value *val = al[j]->get_attrib(black ? "blackball" : "whiteball");
-            if (val) {
+            if (al[j]->getAttr(black ? "blackball" : "whiteball"))
                 al[j]->remove_respawnpos();
-            }
         }
     }
 }
@@ -409,9 +405,11 @@
         for (size_t i=0; i<actors.size(); ++i) {
             Actor *a = actors[i];
             std::string essId;
-            if (!a->string_attrib ("essential_id", &essId))
+            if (Value v = a->getAttr("essential_id"))
+                essId = v.to_string();
+            else
                 essId = a->get_traits().name;
-            int essential = a->int_attrib("essential");
+            int essential = a->getAttr("essential");
             // count number of necessary actors per kind
             if (essential == 1)
                 --essMap[essId];
@@ -536,7 +534,7 @@
 Inventory *player::MayPickup(Actor *a) 
 {
     int iplayer=-1;
-    a->int_attrib("player", &iplayer);
+    if (Value v = a->getAttr("player")) iplayer = v;
     if (iplayer < 0 || (unsigned)iplayer >= players.size()) {
         //        cerr << "PickupItem: illegal 'player' entry\n";
         return 0;

Modified: trunk/src/st_switches.cc
===================================================================
--- trunk/src/st_switches.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/st_switches.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -241,8 +241,7 @@
                 sound_event ("coinsloton");
                 set_anim("st-coin2slot");
 
-                double coin_value = 0;
-                it->double_attrib("value", &coin_value);
+                double coin_value = it->getAttr("value");
                 remaining_time += coin_value;
 
                 inv->yield_first();
@@ -314,11 +313,9 @@
 bool KeyStone::check_matching_key (enigma::Inventory *inv)
 {
     Item *it = inv->get_item(0);
-    int keycode, my_keycode = int_attrib ("keycode");
     return (it
             && it->is_kind("it-key*")
-            && it->int_attrib("keycode", &keycode)
-            && my_keycode == keycode);
+            && it->getAttr("keycode") == getAttr("keycode"));
 }
 
 void KeyStone::actor_hit(const StoneContact &sc)
@@ -333,7 +330,7 @@
         if (is_on()) {
             if (!inv->is_full()) {
                 Item *key = MakeItem("it-key");
-                key->set_attrib ("keycode", int_attrib ("keycode"));
+                key->set_attrib ("keycode", getAttr("keycode"));
                 inv->add_item(key);
                 toggle = true;
             }
@@ -446,7 +443,7 @@
         virtual const char *get_inactive_model() const = 0;
         virtual double timer_delay() const;
 
-        bool inverse() { return int_attrib("inverse") == 1; }
+        bool inverse() { return getAttr("inverse") == 1; }
 
         // Stone interface
         void on_creation (GridPos p);
@@ -599,10 +596,10 @@
 }
 
 double LaserTimeSwitch::timer_delay() const {
-    double delay;
-    if (!double_attrib("delay", &delay))
+    if (Value v = getAttr("delay"))
+        return v;
+    else
         ASSERT(0, XLevelRuntime, "LaserTimeSwitch: delay not properly defined");
-    return delay;
 }
 
 void LaserTimeSwitch::actor_hit(const StoneContact &sc) {

Modified: trunk/src/stones.cc
===================================================================
--- trunk/src/stones.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/stones.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -191,24 +191,13 @@
    If components are not set, use ((1,0),(0,1)) as
    default matrix, resp. defaultfactor as hit_factor. */
 ecl::V2 Stone::distortedVelocity (ecl::V2 vel, double defaultfactor = 1.0) {
-    ecl::V2 newvel(0,0);    
-    if(const Value *xx = this->get_attrib("hit_distortion_xx"))
-        newvel[0] += to_double(*xx) * vel[0];
-    else
-        newvel[0] += vel[0];
-    if(const Value *xy = this->get_attrib("hit_distortion_xy"))
-        newvel[0] += to_double(*xy) * vel[1];
-    if(const Value *yx = this->get_attrib("hit_distortion_yx"))
-        newvel[1] += to_double(*yx) * vel[0];
-    if(const Value *yy = this->get_attrib("hit_distortion_yy"))
-        newvel[1] += to_double(*yy) * vel[1];
-    else
-        newvel[1] += vel[1];
-    if (const Value *factor = this->get_attrib("hit_factor"))
-        newvel *= to_double(*factor);
-    else
-        newvel *= defaultfactor;    
-    return newvel;
+    ecl::V2 newvel;
+    double factor = this->getAttr("hit_factor", defaultfactor);
+    newvel[0] = (double)(this->getAttr("hit_distortion_xx", 1)) * vel[0]
+                + (double)(this->getAttr("hit_distortion_xy")) * vel[1];
+    newvel[1] = (double)(this->getAttr("hit_distortion_yx")) * vel[0]
+                + (double)(this->getAttr("hit_distortion_yy", 1)) * vel[1];
+    return newvel * factor;
 }
 
 
@@ -262,8 +251,7 @@
         }
     private:
         double get_charge() {
-            double q = 0;
-            double_attrib("charge", &q);
+            double q = getAttr("charge");
             return max(-1.0, min(1.0, q));
         }
         void animcb() { init_model(); }

Modified: trunk/src/stones_complex.cc
===================================================================
--- trunk/src/stones_complex.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/stones_complex.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -342,7 +342,7 @@
         bool is_floating() const { return true; }
 
         Direction get_orientation() const {
-            return Direction(int_attrib("orientation"));
+            return to_direction(getAttr("orientation"));
         }
         void set_orientation(Direction dir) {
             set_attrib("orientation", Value(dir));
@@ -367,7 +367,7 @@
     private:
         CLONEOBJ(OneWayStone_black);
         virtual bool actor_may_pass (Actor *a) {
-            return a->get_attrib("blackball") != 0;
+            return a->getAttr("blackball") != 0;
         }
         void actor_hit (const StoneContact&) {
             // do nothing if hit by actor
@@ -381,7 +381,7 @@
     private:
         CLONEOBJ(OneWayStone_white);
         virtual bool actor_may_pass (Actor *a) {
-            return a->get_attrib("whiteball") != 0;
+            return a->getAttr("whiteball") != 0;
         }
         void actor_hit (const StoneContact&) {
             // do nothing if hit by actor
@@ -403,7 +403,7 @@
 }
 
 Value OneWayBase::message(const string& msg, const Value &val) {
-    if (msg == "direction" && val.get_type() == Value::DOUBLE) {
+    if (msg == "direction" && val.getType() == Value::DOUBLE) {
         set_orientation(to_direction(val));
         init_model();
     }
@@ -472,7 +472,7 @@
 
 
         Direction get_dir() const {
-            return static_cast<Direction>(int_attrib("direction"));
+            return to_direction(getAttr("direction"));
         }
         void set_dir(Direction d) {
             if (d != get_dir())
@@ -798,7 +798,7 @@
 DirectionBits
 ConnectiveStone::get_connections() const
 {
-    int conn=int_attrib("connections") - 1;
+    int conn = (int)getAttr("connections") - 1;
     if (conn >=0 && conn <16)
         return DirectionBits(conn);
     else
@@ -810,7 +810,7 @@
 }
 
 int ConnectiveStone::get_modelno() const {
-    return int_attrib("connections");
+    return getAttr("connections");
 }
 
 
@@ -930,7 +930,7 @@
 
         /* ---------- Private methods ---------- */
 
-        bool oxyd1_compatible() const { return int_attrib("oxyd") != 0; }
+        bool oxyd1_compatible() const { return getAttr("oxyd") != 0; }
 
         static bool visit_dir(vector<GridPos> &stack, GridPos curpos,
                               Direction dir, int wanted_oxyd_attrib);
@@ -1004,7 +1004,7 @@
     GridPos newpos = move(curpos, dir);
     PuzzleStone *pz = dynamic_cast<PuzzleStone*>(GetStone(newpos));
 
-    if ((!pz) || (wanted_oxyd_attrib != pz->int_attrib("oxyd")))
+    if ((!pz) || (wanted_oxyd_attrib != (int)pz->getAttr("oxyd")))
         return false;
 
     DirectionBits cfaces = pz->get_connections();
@@ -1033,7 +1033,7 @@
     bool is_complete = true;
     pos_stack.push_back(get_pos());
     this->visited = true;
-    int wanted_oxyd_attrib = int_attrib("oxyd");
+    int wanted_oxyd_attrib = getAttr("oxyd");
 
     while (!pos_stack.empty())
     {
@@ -1067,7 +1067,7 @@
     GridPos newpos = move(curpos, dir);
     if (PuzzleStone *pz = dynamic_cast<PuzzleStone*>(GetStone(newpos))) {
         if (!pz->visited) {
-            if (wanted_oxyd_attrib == pz->int_attrib("oxyd")) {
+            if (wanted_oxyd_attrib == (int)pz->getAttr("oxyd")) {
                 pz->visited = true;
                 stack.push_back(newpos);
             }
@@ -1087,7 +1087,7 @@
     pos_stack.push_back(get_pos());
     this->visited = true;
 
-    int wanted_oxyd_attrib = int_attrib("oxyd");
+    int wanted_oxyd_attrib = getAttr("oxyd");
 
     while (!pos_stack.empty()) {
         GridPos curpos = pos_stack.back();
@@ -1114,7 +1114,7 @@
 
     GridPos p = startpos;
     while (Stone *puzz = dynamic_cast<PuzzleStone*>(GetStone(p))) {
-        if (wanted_oxyd_attrib != -1 && wanted_oxyd_attrib != puzz->int_attrib("oxyd"))
+        if (wanted_oxyd_attrib != -1 && wanted_oxyd_attrib != (int)puzz->getAttr("oxyd"))
             break; // stop when an unrequested puzzle stone type is readed
         c.push_back(p);
         p.move(dir);
@@ -1218,7 +1218,7 @@
 }
 
 int PuzzleStone::get_modelno() const {
-    int modelno = int_attrib("connections");
+    int modelno = getAttr("connections");
     if (oxyd1_compatible()) modelno += 16;
     return modelno;
 }
@@ -1226,10 +1226,10 @@
 void PuzzleStone::rotate_cluster(const Cluster &c) {
     size_t size = c.size();
     if (size > 1) {
-        int cn = GetStone(c[size-1])->int_attrib("connections");
+        int cn = GetStone(c[size-1])->getAttr("connections");
         for (size_t i=size-1; i>0; --i) {
             PuzzleStone *st = dynamic_cast<PuzzleStone*> (GetStone (c[i]));
-            st->set_attrib ("connections", GetStone(c[i-1])->int_attrib ("connections"));
+            st->set_attrib ("connections", GetStone(c[i-1])->getAttr("connections"));
             st->init_model();
         }
         GetStone(c[0])->set_attrib ("connections", cn);
@@ -1254,7 +1254,7 @@
                                         int wanted_oxyd_attrib)
 {
     PuzzleStone *puzz = dynamic_cast<PuzzleStone*>(GetStone(p));
-    if (puzz && wanted_oxyd_attrib == puzz->int_attrib("oxyd")) {
+    if (puzz && wanted_oxyd_attrib == (int)puzz->getAttr("oxyd")) {
         // explode adjacent puzzle stones of same type
         puzz->trigger_explosion(delay);
     }
@@ -1262,7 +1262,7 @@
 
 void PuzzleStone::explode() {
     GridPos p       = get_pos();
-    int     ox_attr = int_attrib("oxyd");
+    int     ox_attr = getAttr("oxyd");
 
     // exchange puzzle stone with explosion
     sound_event("stonedestroy");
@@ -1408,7 +1408,7 @@
 {
     if (dir != NODIR) {
         Cluster c;
-        find_row_or_column_cluster(c, get_pos(), dir, int_attrib ("oxyd"));
+        find_row_or_column_cluster(c, get_pos(), dir, (int)getAttr("oxyd"));
         if (c.size() >= 2) {
 //             warning("ok -> rotate");
             rotate_cluster(c);
@@ -1653,8 +1653,7 @@
         virtual string closing_sound() const { return "doorclose"; }
         virtual const char *collision_sound() { return "electric"; }
         string get_type() const {
-            string type="h";
-            string_attrib("type", &type);
+            string type(getAttr("type", "h"));
             return type;
         }
 
@@ -1772,7 +1771,7 @@
 }
 
 ShogunStone::Holes ShogunStone::get_holes() const {
-    int h=int_attrib("holes");
+    int h = getAttr("holes");
     if (h>=1 && h<=7)
         return Holes(h);
     else {
@@ -1830,7 +1829,7 @@
         init_model();
     }
     else {
-        string_attrib("name", &old_name); // store name of disappearing stone
+        if (Value v = getAttr("name")) old_name = v.get_string(); // store name of disappearing stone
         SendMessage(GetItem(my_pos), "noshogun");
         KillStone(my_pos);
     }
@@ -1885,7 +1884,7 @@
 
         virtual Value message(const string &m, const Value &value) {
             if (m=="trigger") {
-                incoming = (value.get_type() == Value::DOUBLE)
+                incoming = (value.getType() == Value::DOUBLE)
                     ? Direction( static_cast<int> (value.get_double()+0.1))
                     : NODIR;
 
@@ -2241,22 +2240,18 @@
             OxydStone *o1 = instances[closed_oxyds[i]];
             OxydStone *o2 = instances[closed_oxyds[a]];
 
-            string icolor, acolor;
-            o1->string_attrib("color", &icolor);
-            o2->string_attrib("color", &acolor);
+            Value icolor = o1->getAttr("color"); 
 
-            o1->set_attrib("color", acolor.c_str());
-            o2->set_attrib("color", icolor.c_str());
+            o1->set_attrib("color", o2->getAttr("color"));
+            o2->set_attrib("color", icolor);
         }
     }
 }
 
 void OxydStone::change_state(State newstate) 
 {
-    string flavor = "a";
-    string color = "1";
-    string_attrib("flavor", &flavor);
-    string_attrib("color", &color);
+    string flavor(getAttr("flavor","a"));
+    string color(getAttr("color", "1"));
 
     string modelname = string("st-oxyd") + flavor + color;
 
@@ -2324,7 +2319,7 @@
 
 void OxydStone::maybe_open_stone() {
     if (state == CLOSED || state == CLOSING) {
-        int mycolor = int_attrib("color");
+        Value mycolor = getAttr("color");
 
         // Is another oxyd stone currently blinking?
         InstanceList::iterator i;
@@ -2339,10 +2334,10 @@
                 // open both stones. Close one of them otherwise.
                 // (This is the Oxyd behaviour; it doesn't work with
                 // some Enigma levels.)
-                can_open = (mycolor == (*i)->int_attrib("color") && (*i)->state==BLINKING);
+                can_open = (mycolor == (*i)->getAttr("color") && (*i)->state==BLINKING);
             }
             else 
-                can_open = (mycolor == (*i)->int_attrib("color"));
+                can_open = (mycolor == (*i)->getAttr("color"));
 
             if (can_open) {
                 change_state(OPEN);
@@ -2365,18 +2360,13 @@
 
 void OxydStone::on_creation (GridPos) 
 {
-    string flavor = "a";
-    string_attrib("flavor", &flavor);
+    string flavor(getAttr("flavor", "a"));
     set_model(string("st-oxyd") + flavor);
     photo_activate();
 }
 
 bool OxydStone::is_removable() const {
-    const Value* isStatic = get_attrib("static");
-    if (isStatic != NULL)
-        return !to_bool(*isStatic);
-    else
-        return true;
+    return !getAttr("static").to_bool();
 }
 
 void OxydStone::on_removal(GridPos p) 
@@ -2973,7 +2963,7 @@
 
     string ChessStone::get_model_name() {
         string mname = get_kind();
-        mname += int_attrib("color") == 0.0 ? "_black" : "_white";
+        mname += (getAttr("color") == 0) ? "_black" : "_white";
         return mname;
     }
 
@@ -3021,10 +3011,10 @@
     void ChessStone::actor_hit(const StoneContact &sc) {
          if (player::WieldedItemIs (sc.actor, "it-magicwand")) {
              sound_event ("stonepaint");
-             set_color(1 - int_attrib("color"));
+             set_color(1 - (int)getAttr("color"));
              // If not IDLE, color will be set next time IDLE is set.
-         } else if ((sc.actor->get_attrib("blackball") && int_attrib("color") == 0)
-                    || (sc.actor->get_attrib("whiteball") && int_attrib("color") == 1)) {
+         } else if ((sc.actor->getAttr("blackball") && getAttr("color") == 0)
+                    || (sc.actor->getAttr("whiteball") && getAttr("color") == 1)) {
             V2 v = sc.actor->get_vel();
             Direction dir1 = get_push_direction(sc);
             if(dir1 == NODIR)  return;
@@ -3070,7 +3060,6 @@
             } else {
                 // Test stone. Is it opposite chess stone or totally another one?
                 Stone *st = GetStone(destination);
-                const Value *col = get_attrib("color");
                 if(to_int(SendMessage(st, "capture", Value(get_model_name()))) ) {
                     // Give it some time for animation, then replace it.
                     ASSERT(try_state(CAPTURING), XLevelRuntime,
@@ -3108,7 +3097,7 @@
 
     Value ChessStone::message(const string &msg, const Value &v) {
         if(msg == "capture") {
-            if(state == IDLE && to_string(v) != get_model_name())
+            if(state == IDLE && v.to_string() != get_model_name())
                 if(try_state(CAPTURED)) {
                     set_anim(get_model_name() + "-captured");
                     return Value(1);
@@ -3123,11 +3112,11 @@
         else   if(msg == "move_wwn") { return message_move(WEST, NORTH); }
         else   if(msg == "move_nnw") { return message_move(NORTH, WEST); }
         else   if(msg == "move") {
-            Direction dir1 = (Direction) int_attrib("direction1");
-            Direction dir2 = (Direction) int_attrib("direction2");
+            Direction dir1 = to_direction(getAttr("direction1"));
+            Direction dir2 = to_direction(getAttr("direction2"));
             return message_move(dir1, dir2);
         } else if(msg == "signal") { set_color(to_int(v)); }
-        else   if(msg == "flip") { set_color(1 - int_attrib("color")); }
+        else   if(msg == "flip") { set_color(1 - (int)getAttr("color")); }
         else
             return Stone::message(msg, v);
         return Value();
@@ -3152,7 +3141,7 @@
                 rememberSwamp = true;
             else
                 state = newstate;        
-            if(state == IDLE && newcolor != int_attrib("color"))
+            if(state == IDLE &&  getAttr("color") != newcolor)
                 set_color(newcolor);
             if(state == IDLE && rememberFalling) {
                 state = FALLING;
@@ -3278,19 +3267,17 @@
                 the force resulting from floor->add_force. "baseinterval"
                 is 50 ms or the interval given in "interval".
             */
-            double base = 0.05;
-            if (const Value *v = this->get_attrib("interval")) 
-                base = to_double(*v);
-            if (const Value *f = this->get_attrib("friction_factor"))
-                base *= 1.0 + to_double(*f) * GetFloor(get_pos())->get_friction();
-            if (const Value *g = this->get_attrib("gradient_factor"))
+            double base = getAttr("interval", 0.05);
+            if (Value f = getAttr("friction_factor"))
+                base *= 1.0 + (double)f * GetFloor(get_pos())->get_friction();
+            if (Value g = getAttr("gradient_factor"))
                 if (skateDir != NODIR) {
                     V2 vec = V2(0.0,0.0);
                     double quot = 0;
                     GetFloor(get_pos())->add_force(0, vec);
                     quot = skateDir == NORTH ? -vec[1] : skateDir == SOUTH ? vec[1] :
                         skateDir == EAST ? vec[0] : skateDir == WEST ? -vec[0] : 0;
-                    base /= max(1.0 + to_double(*g) * quot, 0.01);                    
+                    base /= max(1.0 + (double)g * quot, 0.01);                    
                 }
             return max(base, 0.02);
         }

Modified: trunk/src/stones_internal.hh
===================================================================
--- trunk/src/stones_internal.hh	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/stones_internal.hh	2007-01-21 22:09:09 UTC (rev 581)
@@ -88,7 +88,7 @@
         }
 
         bool is_on() const { 
-            return int_attrib("on") == 1; 
+            return getAttr("on") == 1; 
         }
 
         virtual void set_on(bool newon) {

Modified: trunk/src/stones_simple.cc
===================================================================
--- trunk/src/stones_simple.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/stones_simple.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -187,7 +187,7 @@
 
         StoneResponse collision_response(const StoneContact &/*sc*/) {
             static int lastCode = -1;
-            int        code     = int_attrib("code");
+            int        code     = getAttr("code");
             if (code != lastCode) {
                 fprintf(stderr, "Collision with stone 0x%02x\n", code);
                 lastCode = code;
@@ -724,7 +724,7 @@
         Break_acwhite() : BreakableStone("st-break_acwhite") {}
     private:
         bool may_be_broken_by(Actor *a) const {
-            return a->get_attrib("whiteball") &&
+            return (a->getAttr("whiteball") != 0) &&
                 player::WieldedItemIs (a, "it-hammer");
         }
     };
@@ -754,7 +754,7 @@
         Break_acblack() : BreakableStone("st-break_acblack") {}
     private:
         bool may_be_broken_by(Actor *a) const {
-            return a->get_attrib("blackball") &&
+            return (a->getAttr("blackball") != 0) &&
                 player::WieldedItemIs (a, "it-hammer");
         }
     };
@@ -1125,12 +1125,9 @@
         DECL_TRAITS;
 
         void actor_hit(const StoneContact &sc) {
-            double strength = 10.0;
-            double length = 1.0;
-            double minlength = 0.0;
-            double_attrib ("strength", &strength);
-            double_attrib ("length", &length);
-            double_attrib ("minlength", &minlength);
+            double strength = getAttr("strength", 10.0);
+            double length = getAttr("length", 1.0);
+            double minlength = getAttr("minlength");
 
             world::RubberBandData rbd;
             rbd.strength = strength;
@@ -1139,8 +1136,7 @@
 
             // The mode attribute "scissor" defines, if when touching an st-rubberband,
             // other rubberbands to the actor will be cut of or not, true means they will. true is default.
-            enigma::Value const *scissorValue = get_attrib("scissor");
-            bool isScissor = (scissorValue == NULL)? true : to_bool(*scissorValue);
+            bool isScissor = to_bool(getAttr("scissor"));
 
             if (!world::HasRubberBand (sc.actor, this)) {
                 sound_event ("rubberband");
@@ -1228,12 +1224,10 @@
         int m_signalvalue;
 
         double get_interval() const {
-            double interval = 100;
-            double_attrib("interval", &interval);
-            return interval;
+            return getAttr("interval", 100);
         }
         void init_model() {
-            if (int_attrib("invisible")) {
+            if (getAttr("invisible") == 1) {
                 set_model("invisible");
             }
             else {
@@ -1411,8 +1405,7 @@
         set_anim("st-thief-emerge");
         state = EMERGING;
         m_affected_actor = sc.actor;
-        affected_player = -1;
-        m_affected_actor->int_attrib("player", &affected_player);
+        affected_player = m_affected_actor->getAttr("player", -1);
     }
 }
 
@@ -1490,8 +1483,7 @@
                 // actor_hit is called before reflect, but the force added below
                 // is applied to actor after the reflection.
 
-                double forcefac = server::BumperForce;
-                double_attrib("force", &forcefac);
+                double forcefac = getAttr("force", server::BumperForce);
 
                 V2 vec = normalize(sc.actor->get_pos() - get_pos().center());
                 sc.actor->add_force (distortedVelocity(vec, forcefac));                
@@ -1617,11 +1609,11 @@
 
         StoneResponse collision_response(const StoneContact &sc) {
             if (m_type < 4) {
-                return (sc.actor->get_attrib("blackball")) ? 
+                return (sc.actor->getAttr("blackball") != 0) ? 
                     STONE_PASS : STONE_REBOUND;
             }
             else {
-                return (sc.actor->get_attrib("whiteball")) ? 
+                return (sc.actor->getAttr("whiteball") != 0) ? 
                     STONE_PASS : STONE_REBOUND;
             }
         }
@@ -1685,8 +1677,8 @@
 
     private:
         void actor_hit(const StoneContact &sc) {
-            if      (sc.actor->get_attrib("blackball")) turn_white();
-            else if (sc.actor->get_attrib("whiteball")) turn_black();
+            if      (sc.actor->getAttr("blackball") != 0) turn_white();
+            else if (sc.actor->getAttr("whiteball") != 0) turn_black();
         }
     };
 
@@ -1696,8 +1688,8 @@
         YinYangStone2() : YinYangStone("st-yinyang2") {}
     private:
         void actor_hit(const StoneContact &sc) {
-            if      (sc.actor->get_attrib("blackball")) turn_black();
-            else if (sc.actor->get_attrib("whiteball")) turn_white();
+            if      (sc.actor->getAttr("blackball") != 0) turn_black();
+            else if (sc.actor->getAttr("whiteball") != 0) turn_white();
         }
     };
 
@@ -1713,9 +1705,9 @@
             if (player::WieldedItemIs (sc.actor, "it-magicwand") ||
                 player::WieldedItemIs (sc.actor, "it-brush"))
             {
-                if      (sc.actor->get_attrib("blackball")) 
+                if      (sc.actor->getAttr("blackball") != 0) 
                     turn_white("st-white4");
-                else if (sc.actor->get_attrib("whiteball")) 
+                else if (sc.actor->getAttr("whiteball") != 0) 
                     turn_black("st-black4");
             }
         }
@@ -1793,7 +1785,7 @@
         CLONEOBJ(MagicStone);
         DECL_TRAITS;
         void actor_hit(const StoneContact &sc) {
-            if (sc.actor->get_attrib("player") && 
+            if (sc.actor->getAttr("player") && 
                 sc.actor->get_vel() * sc.normal < -4)
             {
                 KillStone(get_pos());

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2007-01-19 17:32:58 UTC (rev 580)
+++ trunk/src/world.cc	2007-01-21 22:09:09 UTC (rev 581)
@@ -475,9 +475,8 @@
 void World::unname (Object *obj)
 {
     ASSERT(obj, XLevelRuntime, "unname: no object given");
-    string name;
-    if (obj->string_attrib("name", &name)) {
-        m_objnames.remove(name);
+    if (Value v = obj->getAttr("name")) {
+        m_objnames.remove(v.to_string());
         obj->set_attrib("name", "");
     }
 }
@@ -1254,9 +1253,9 @@
         a->on_creation(a->get_actorinfo()->pos);
         a->message ("init", Value());
 
-        int iplayer;
-        if (a->int_attrib("player", &iplayer)) {
-            player::AddActor(iplayer,a);
+        if (Value v = a->getAttr("player")) {
+            int iplayer = v;
+            player::AddActor(iplayer, a);
             if (iplayer == 0) seen_player0 = true;
         } else {
             player::AddUnassignedActor(a);
@@ -1289,7 +1288,8 @@
 void world::NameObject(Object *obj, const std::string &name)
 {
     string old_name;
-    if (obj->string_attrib("name", &old_name)) {
+    if (Value v = obj->getAttr("name")) {
+        old_name = v.to_string();
         obj->warning("name '%s' overwritten by '%s'",
                      old_name.c_str(), name.c_str());
         UnnameObject(obj);
@@ -1304,13 +1304,12 @@
 
 void world::TransferObjectName (Object *source, Object *target)
 {
-    string name;
-    if (source->string_attrib("name", &name)) {
+    if (Value v = source->getAttr("name")) {
+        string name(v);
         UnnameObject(source);
-        string targetName;
-        if (target->string_attrib("name", &targetName)) {
+        if (Value v = target->getAttr("name")) {
             target->warning("name '%s' overwritten by '%s'",
-                            targetName.c_str(), name.c_str());
+                            v.to_string().c_str(), name.c_str());
             UnnameObject(target);
         }
         NameObject(target, name);
@@ -1552,10 +1551,9 @@
 void world::PerformAction (Object *o, bool onoff) 
 {
     string action = "idle";
-    string target;
+    string target(o->getAttr("target"));
 
-    o->string_attrib("action", &action);
-    o->string_attrib("target", &target);
+    if (Value v = o->getAttr("action")) action = v.to_string();
 
 #if defined(VERBOSE_MESSAGES)
     o->warning("PerformAction action=%s target=%s", action.c_str(), target.c_str());



From raoul at mail.berlios.de  Mon Jan 22 18:42:04 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Mon, 22 Jan 2007 18:42:04 +0100
Subject: [Enigma-game-svn] r582 - in branches/1.0: data/levels/enigma_cross
	data/levels/enigma_v data/levels/enigma_vi data/levels/lib po
Message-ID: <200701221742.l0MHg4V6002232@sheep.berlios.de>

Author: raoul
Date: 2007-01-22 18:41:59 +0100 (Mon, 22 Jan 2007)
New Revision: 582

Added:
   branches/1.0/data/levels/enigma_v/luc31_2.xml
   branches/1.0/data/levels/enigma_vi/andy01_2.xml
Removed:
   branches/1.0/data/levels/enigma_v/luc31_1.xml
Modified:
   branches/1.0/data/levels/enigma_cross/newlevels.xml
   branches/1.0/data/levels/enigma_cross/newlevels_1.0.1.xml
   branches/1.0/data/levels/enigma_v/index.xml
   branches/1.0/data/levels/enigma_vi/index.xml
   branches/1.0/data/levels/lib/libflood_1.xml
   branches/1.0/po/es.po
Log:
-> New level "Red Herrings" from Andy Geldmacher
-> Bugfix in "The Chamber"
-> Important bugfix in libflood
-> Update of spanish translation



Modified: branches/1.0/data/levels/enigma_cross/newlevels.xml
===================================================================
--- branches/1.0/data/levels/enigma_cross/newlevels.xml	2007-01-21 22:09:09 UTC (rev 581)
+++ branches/1.0/data/levels/enigma_cross/newlevels.xml	2007-01-22 17:41:59 UTC (rev 582)
@@ -146,7 +146,7 @@
     <level _seq="138" _title="Firefox" _xpath="enigma_v/ral01_2" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060213ral003" rel="2" rev="32" score="2" target="time" unit="duration"/>
     <level _seq="139" _title="You need them" _xpath="enigma_v/raoul11_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul11" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="140" _title="Pipes and Plumbing" _xpath="enigma_v/andreas27_1" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas27" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="141" _title="The Chamber" _xpath="enigma_v/luc31_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc31" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="141" _title="The Chamber" _xpath="enigma_v/luc31_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc31" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="142" _title="Spacestation" _xpath="enigma_v/raoul23_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul23" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="143" _title="A-way" _xpath="enigma_vi/richi06_1" author="Richi B?tzer" ctrl="force" easy="true" id="richi06" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="144" _title="Toreador" _xpath="enigma_vi/ral02_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060213ral004" rel="1" rev="43" score="1" target="time" unit="duration"/>

Modified: branches/1.0/data/levels/enigma_cross/newlevels_1.0.1.xml
===================================================================
--- branches/1.0/data/levels/enigma_cross/newlevels_1.0.1.xml	2007-01-21 22:09:09 UTC (rev 581)
+++ branches/1.0/data/levels/enigma_cross/newlevels_1.0.1.xml	2007-01-22 17:41:59 UTC (rev 582)
@@ -11,6 +11,7 @@
     <level _seq="3" _title="Knight's Journey" _xpath="enigma_vi/johannes02_1" author="Johannes Laire" ctrl="force" easy="false" id="20061210johannes313" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="4" _title="Blitz Chess" _xpath="enigma_vi/luc32_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc322006" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="5" _title="River of Challenges" _xpath="enigma_vi/luc33_1" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc332006" rel="1" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="6" _title="Red Herrings" _xpath="enigma_vi/andy01_2" author="Andy Geldmacher" ctrl="force" easy="false" id="20070116money001" rel="3" rev="0" score="3" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: branches/1.0/data/levels/enigma_v/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/index.xml	2007-01-21 22:09:09 UTC (rev 581)
+++ branches/1.0/data/levels/enigma_v/index.xml	2007-01-22 17:41:59 UTC (rev 582)
@@ -101,7 +101,7 @@
     <level _seq="93" _title="You need them" _xpath="./raoul11_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul11" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="94" _title="Pipes and Plumbing" _xpath="./andreas27_1" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas27" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="95" _title="You Must Be Kidding" _xpath="./duffy91_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy91" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="96" _title="The Chamber" _xpath="./luc31_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc31" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="96" _title="The Chamber" _xpath="./luc31_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc31" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="97" _title="Automaton" _xpath="./duffy95_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy95" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="98" _title="Caterpillar" _xpath="./nat15_1" author="Nat Pryce" ctrl="force" easy="false" id="nat15" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="99" _title="Spacestation" _xpath="./raoul23_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul23" rel="1" rev="1" score="1" target="time" unit="duration"/>

Deleted: branches/1.0/data/levels/enigma_v/luc31_1.xml
===================================================================
--- branches/1.0/data/levels/enigma_v/luc31_1.xml	2007-01-21 22:09:09 UTC (rev 581)
+++ branches/1.0/data/levels/enigma_v/luc31_1.xml	2007-01-22 17:41:59 UTC (rev 582)
@@ -1,111 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="The Chamber" el:subtitle="" el:id="luc31"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
-      <el:copyright>Copyright ? 2006 Lukas Sch?ller</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- Created with BlackBallEd
-
-function file_oxyd(x,y,f)
-    oxyd_default_flavor=f
-    oxyd(x,y)
-end
-levelh=13
-levelw=20
-enigma.FlatForce=30
-enigma.SlopeForce=30
-enigma.ElectricForce=30
-cells={}
-items={}
-stones={}
-stones[" "]=cell{}
-cells[" "]=cell{}
-items[" "]=cell{}
-cells["!"]=cell{floor="fl-stwood"}
-stones["!"]=cell{stone="st-blue-sand"}
-stones["#"]=cell{parent={{file_oxyd,"c"}}}
-stones["$"]=cell{stone="st-door-v"}
-items["!"]=cell{item="it-trigger"}
-stones["%"]=cell{stone="st-wood"}
-stones["&"]=cell{stone="st-door-h"}
-level={"!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!"}
-itmap={"                    ",
-       "                    ",
-       "                    ",
-       "                    ",
-       "                    ",
-       "       ! !          ",
-       "        ! !         ",
-       "       ! !          ",
-       "        ! !         ",
-       "                    ",
-       "                    ",
-       "                    ",
-       "                    "}
-stmap={"!!!!!!!!!!!!!!!!!!!!",
-       "#                  #",
-       "!    !!!!!!!!!!!   !",
-       "!    $ $ $ $ $ !   !",
-       "!    !!!!!!!!!&!   !",
-       "!    !  % %  ! !   !",
-       "!    ! % %   ! !   !",
-       "!    !  % %  !&!   !",
-       "!    ! % %   $ !   !",
-       "!    !!!!!!!!!!!   !",
-       "!                  !",
-       "#                  #",
-       "!!!!!!!!!!!!!!!!!!!!"}
-create_world_by_map(level)
-draw_map(0,0,stmap,stones)
-draw_map(0,0,itmap,items)
-SetAttrib(enigma.GetItem(7,5),"invisible",FALSE)
-SetAttrib(enigma.GetItem(7,7),"invisible",FALSE)
-SetAttrib(enigma.GetItem(8,6),"invisible",FALSE)
-SetAttrib(enigma.GetItem(8,8),"invisible",FALSE)
-SetAttrib(enigma.GetItem(9,5),"invisible",FALSE)
-SetAttrib(enigma.GetItem(9,7),"invisible",FALSE)
-SetAttrib(enigma.GetItem(10,6),"invisible",FALSE)
-SetAttrib(enigma.GetItem(10,8),"invisible",FALSE)
-Signal ("it(7 5)","st(13 8)")
-Signal ("it(9 5)","st(14 7)")
-Signal ("it(8 6)","st(14 4)")
-Signal ("it(10 6)","st(13 3)")
-Signal ("it(7 7)","st(11 3)")
-Signal ("it(9 7)","st(9 3)")
-Signal ("it(8 8)","st(7 3)")
-Signal ("it(10 8)","st(5 3)")
-oxyd_shuffle()
-set_actor("ac-blackball",6.5,5.5)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: branches/1.0/data/levels/enigma_v/luc31_2.xml (from rev 576, branches/1.0/data/levels/enigma_v/luc31_1.xml)
===================================================================
--- branches/1.0/data/levels/enigma_v/luc31_1.xml	2007-01-14 21:50:47 UTC (rev 576)
+++ branches/1.0/data/levels/enigma_v/luc31_2.xml	2007-01-22 17:41:59 UTC (rev 582)
@@ -0,0 +1,122 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="The Chamber" el:subtitle="" el:id="luc31"/>
+      <el:version el:score="2" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
+      <el:copyright>Copyright ? 2006 Lukas Sch?ller</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="0.92">
+       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+-- Created with BlackBallEd
+enigma.ConserveLevel = FALSE
+
+function file_oxyd(x,y,f)
+    oxyd_default_flavor=f
+    oxyd(x,y)
+end
+
+levelh=13
+levelw=20
+
+enigma.FlatForce=30
+enigma.SlopeForce=30
+enigma.ElectricForce=30
+
+cells={}
+items={}
+stones={}
+
+stones[" "]=cell{}
+cells[" "]=cell{}
+items[" "]=cell{}
+
+cells["!"]=cell{floor="fl-stwood"}
+stones["!"]=cell{stone="st-blue-sand"}
+stones["#"]=cell{parent={{file_oxyd,"c"}}}
+stones["$"]=cell{stone="st-door-v"}
+items["!"]=cell{item="it-trigger"}
+stones["%"]=cell{stone="st-wood"}
+stones["&"]=cell{stone="st-door-h"}
+
+level={"!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!",
+       "!!!!!!!!!!!!!!!!!!!!"}
+itmap={"                    ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "       ! !          ",
+       "        ! !         ",
+       "       ! !          ",
+       "        ! !         ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    "}
+stmap={"!!!!!!!!!!!!!!!!!!!!",
+       "#                  #",
+       "!    !!!!!!!!!!!   !",
+       "!    $ $ $ $ $ !   !",
+       "!    !!!!!!!!!&!   !",
+       "!    !  % %  ! !   !",
+       "!    ! % %   ! !   !",
+       "!    !  % %  !&!   !",
+       "!    ! % %   $ !   !",
+       "!    !!!!!!!!!!!   !",
+       "!                  !",
+       "#                  #",
+       "!!!!!!!!!!!!!!!!!!!!"}
+
+create_world_by_map(level)
+draw_map(0,0,stmap,stones)
+draw_map(0,0,itmap,items)
+
+SetAttrib(enigma.GetItem(7,5),"invisible",FALSE)
+SetAttrib(enigma.GetItem(7,7),"invisible",FALSE)
+SetAttrib(enigma.GetItem(8,6),"invisible",FALSE)
+SetAttrib(enigma.GetItem(8,8),"invisible",FALSE)
+SetAttrib(enigma.GetItem(9,5),"invisible",FALSE)
+SetAttrib(enigma.GetItem(9,7),"invisible",FALSE)
+SetAttrib(enigma.GetItem(10,6),"invisible",FALSE)
+SetAttrib(enigma.GetItem(10,8),"invisible",FALSE)
+
+Signal ("it(7 5)","st(13 8)")
+Signal ("it(9 5)","st(14 7)")
+Signal ("it(8 6)","st(14 4)")
+Signal ("it(10 6)","st(13 3)")
+Signal ("it(7 7)","st(11 3)")
+Signal ("it(9 7)","st(9 3)")
+Signal ("it(8 8)","st(7 3)")
+Signal ("it(10 8)","st(5 3)")
+
+oxyd_shuffle()
+set_actor("ac-blackball",6.5,5.5)
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Added: branches/1.0/data/levels/enigma_vi/andy01_2.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/andy01_2.xml	2007-01-21 22:09:09 UTC (rev 581)
+++ branches/1.0/data/levels/enigma_vi/andy01_2.xml	2007-01-22 17:41:59 UTC (rev 582)
@@ -0,0 +1,107 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Red Herrings" el:subtitle="" el:id="20070116money001"/>
+      <el:version el:score="3" el:release="3" el:revision="0" el:status="released"/>
+      <el:author el:name="Andy Geldmacher" el:email="" el:homepage="http://www.geldmacher.privat.t-online.de"/>
+      <el:copyright>Copyright ? 2007 Andy Geldmacher</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.0">
+       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="01:00"/>
+    </el:info>
+    <el:luamain><![CDATA[
+enigma.ConserveLevel=FALSE
+
+function file_oxyd(x,y,f)
+    oxyd_default_flavor=f
+    oxyd(x,y)
+end
+
+cells={}
+cells[" "]=cell{floor="fl-sahara"}
+cells["W"]=cell{floor="fl-water"}
+
+stones={}
+stones["#"]=cell{stone="st-rock1"}
+stones["a"]=cell{stone="st-stoneimpulse"}
+stones["b"]=cell{stone="st-grate1"}
+stones["c"]=cell{stone="st-oneway_black-e"}
+stones["d"]=cell{stone="st-stone_break"}
+stones["e"]=cell{stone="st-swap"}
+stones["f"]=cell{stone={"st-door-v", {name="door1"}}}
+stones["g"]=cell{stone={"st-coinslot", {action="openclose", target="door1"}}}
+stones["h"]=cell{stone={"st-door-v", {name="door2"}}}
+stones["i"]=cell{stone={"st-laser-e", {name="laser1"}}}
+stones["j"]=cell{stone={"st-switch", {action="onoff", target="laser1"}}}
+stones["k"]=cell{stone="st-wood"}
+stones["l"]=cell{stone="st-oneway_black-s"}
+stones["m"]=cell{stone="st-mirror-p/m"}
+stones["x"]=cell{parent={{file_oxyd,"d"}}}
+
+items={}
+items["1"]=cell{item="it-seed"}
+items["2"]=cell{item="it-coin2"}
+items["3"]=cell{item="it-umbrella"}
+items["4"]=cell{item={"it-trigger", {action="openclose", target="door2"}}}
+items["5"]=cell{item="it-dynamite"}
+items["6"]=cell{item="it-puller-w"}
+
+level={"                    ",
+       "              WWWW  ",
+       "              WWWW  ",
+       "             WWWWWW ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    "}
+stmap={"######aaaaag########",
+       "#x k #k###a f      #",
+       "# d #  l #a #x    x#",
+       "#k    # kaa #b    b#",
+       "# d####  #  c      #",
+       "## #     #  c #  a##",
+       "j        #bb#b#bbc #",
+       "# ########b a #  e #",
+       "#         b aaa  a##",
+       "i         b b a  #x#",
+       "###mbbbbbbbbebbbb# #",
+       "# #       b b b  h #",
+       "####################"}
+itmap={"                    ",
+       "    1        5    6 ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "       4          1 ",
+       "                    ",
+       "                    ",
+       "                    ",
+       "                    ",
+       " 3                2 ",
+       "                    "}
+
+create_world_by_map(level)
+draw_map(0,0,stmap,stones)
+draw_map(0,0,itmap,items)
+
+set_actor("ac-blackball", 6, 9,{player=0})
+
+oxyd_shuffle()
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: branches/1.0/data/levels/enigma_vi/andy01_2.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: branches/1.0/data/levels/enigma_vi/index.xml
===================================================================
--- branches/1.0/data/levels/enigma_vi/index.xml	2007-01-21 22:09:09 UTC (rev 581)
+++ branches/1.0/data/levels/enigma_vi/index.xml	2007-01-22 17:41:59 UTC (rev 582)
@@ -74,6 +74,7 @@
     <level _seq="66" _title="Knight's Journey" _xpath="./johannes02_1" author="Johannes Laire" ctrl="force" easy="false" id="20061210johannes313" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="67" _title="Blitz Chess" _xpath="./luc32_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc322006" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="68" _title="River of Challenges" _xpath="./luc33_1" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc332006" rel="1" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="69" _title="Red Herrings" _xpath="./andy01_2" author="Andy Geldmacher" ctrl="force" easy="false" id="20070116money001" rel="3" rev="0" score="3" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: branches/1.0/data/levels/lib/libflood_1.xml
===================================================================
--- branches/1.0/data/levels/lib/libflood_1.xml	2007-01-21 22:09:09 UTC (rev 581)
+++ branches/1.0/data/levels/lib/libflood_1.xml	2007-01-22 17:41:59 UTC (rev 582)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="library">
       <el:identity el:title="" el:id="lib/libflood"/>
-      <el:version el:score="1" el:release="1" el:revision="5" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="6" el:status="released"/>
       <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2007 Raoul Bourquin</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -21,37 +21,67 @@
 --------------------------------------------------------------------------------
 -- REFERENCE --
 ---------------
--- Used Globals:
--- land_map
--- top_left
--- flood_method
--- flood_map
--- flood_front
--- to_flood
+-- Parameters:
+--
+-- land_map: Charmap containig the landscape with the (un)floodable floors
+-- Allowed chars: "#" : unfloodable
+--                " " : floodable, not yet flooded
+--                "~" : flooded (is water)
+--
+-- top_left: Array with the real levelcoordinates of the top left corner.
+-- 
+-- flood_method: Method to determine the next tiles.
+-- This can be: 1 : only examine the north, east, south and west field
+--              2 : examine all 8 neighbour fields
+--
+-- Used Globals (interesting for programmers only):
+-- flood_map: Arraymap with the current state of the flood, starts as copy of land_map
+-- flood_front: Coordinates of all tiles to examine in this step
+-- to_flood: All tiles that will be flooded at the end of this step
 
 -- Defaults:
-land_map = {"~"}
-top_left = {0,0}
-flood_method = 1
+-- Declare all as local to avoid a conflict with variables maybe used by the levelauthors
+local land_map = nil
+local top_left = nil
+local flood_method = nil
+local flood_map = nil
+local flood_front = nil
+local to_flood = nil
 
 function init_flood(new_map, corner, method)
-    land_map = new_map
-    top_left = corner
-    flood_method = method
+    -- Set defaults if no values are given:
+    if new_map ~= nil then
+        land_map = new_map
+    else
+        land_map = {"~"}
+    end
+    if corner ~= nil then
+        top_left = corner
+    else
+        top_left = {0,0}
+    end
+    if flood_method ~= nil then
+        flood_method = method
+    else
+        flood_method = 1
+    end
 
     -- Is the map bigger than 0 x 0 ?
     local x, y = get_map_size(land_map)
     if x < 1 or y < 1 then
-        error("init_flood(new_map, corner): Map "..tostring(x).." x "..tostring(y).." is too small!\n")
+        error("init_flood(new_map, corner, method): Map "..tostring(x).." x "..tostring(y).." is too small!\n")
     end
     -- Is the map rectangular?
     is_rectangular()
-    -- Test top_left for valid koordinates
-    if top_left[1] <= 0 or top_left[2] <= 0 then
-        error("init_flood(new_map, corner): Invalid value for top left map corner! "..tostring(top_left[1])..";"..tostring(top_left[2]).."\n")
+    -- Test top_left corner for valid koordinates
+    -- We do not test, if the map is bigger than the level!
+    -- The bottom right corner may lie outside of the level -> flood_it will raise an error ...
+    if top_left[1] < 0 or top_left[2] < 0 then
+        error("init_flood(new_map, corner, method): Invalid value for top left map corner! "..tostring(top_left[1])..";"..tostring(top_left[2]).."\n")
     end
+    -- Valid flood method?
     if flood_method ~= 1 and flood_method ~= 2 then
-        error("init_flood(new_map, corner, method): Invalid value for method: "..tostring(method).."! Values are [1,2].\n")
+        error("init_flood(new_map, corner, method): Invalid value for method: "..tostring(method).."! Values are 1 or 2.\n")
     end
 
     -- Build up the flood_map table.
@@ -69,6 +99,9 @@
     new_to_flood()
     -- Iterate over all elements in flood_front to find the tiles, we have to flood.
     local flood_front_size = table.getn(flood_front)
+    -- DEBUG:
+    --print("Flood Front has size: "..tostring(flood_front_size))
+    
     local k,v
     for k,v in pairs(flood_front) do
         local akt_pos = flood_front[k]
@@ -78,18 +111,24 @@
             examine_field_all8(akt_pos[1], akt_pos[2])
         end
     end
+
     -- Write the to_flood to flood_front.
     clear_flood_front()
     copy_to_flood_to_flood_front()
     -- We don't need to update the flood_map, because we updated it in
     -- examine_field_neighbour(x,y). This improves performance a big bit!
     --update_flood_map()
-    -- FLOOD !
+    -- FLOOD!
     flood_it(to_flood,top_left)
     return 0
 end
 --------------------------------------------------------------------------------
+-- Export public functions:
+-- Not yet used
+--init_flood = init_flood
+--do_flood = do_flood
 --------------------------------------------------------------------------------
+--------------------------------------------------------------------------------
 -- Get the dimensions of the land_map:
 function get_map_size(land_map)
     local y_size=table.getn(land_map)
@@ -104,6 +143,7 @@
     return x_size, y_size
 end
 
+-- This function is not used anymore
 function is_inside_map(x,y)
     -- Test, if x and y are inside the flood_map. If no, raise an error.
     local x_size, y_size = get_flood_map_size(flood_map)
@@ -118,24 +158,24 @@
 function is_on_border(x,y)
     -- Test, if x and y are on the flood_map border.
     local x_size, y_size = get_flood_map_size(flood_map)
-    local on_x, on_y = 0, 0
-    -- Is x on a border?
+    local on_left, on_right, on_top, on_bottom = false, false, false, false
     if x == 1 then
         -- is on left border
-        on_y = 1
-    elseif x == x_size then
+        on_left = true
+    end
+    if x == x_size then
         -- is on right border
-        on_y = 2
+        on_right = true
     end
-    -- Is y on a border?
     if y == 1 then
         -- is on top border
-        on_x = 1
-    elseif y == y_size then
+        on_top = true
+    end
+    if y == y_size then
         -- is on bottom border
-        on_x = 2
+        on_bottom = true
     end
-    return on_x, on_y
+    return on_left, on_right, on_top, on_bottom
 end
 
 function is_rectangular()
@@ -146,7 +186,7 @@
     for i=1, y_size do
         temp = string.len(land_map[i])
         if temp ~= buffer then
-            error("is_rectangular(): Map in not rectangular!\n")
+            error("init_flood(new_map, corner, method): Map is not rectangular!\n")
         end
     end
     return 0
@@ -160,13 +200,16 @@
 
 function parse_this_char(akt_char)
     if akt_char == "#" then
+        -- Unfloodable
         return 0
     elseif akt_char == " " then
+        -- Floodable, not yet flooded
         return 1
     elseif akt_char == "~" then
+        -- Floodable, flooded
         return 2
     else
-        error("parse_this_char(akt_char): Illegal char \""..akt_char.."\" in the map! Valid chars are: [#, ,~].\n")
+        error("init_flood(new_map, corner, method): Illegal char \""..akt_char.."\" in the map! Valid chars are: [#, ,~].\n")
     end
 end
 
@@ -188,11 +231,12 @@
 end
 --------------------------------------------------------------------------------
 function modify_flood_map(x,y,type)
-    is_inside_map(x,y)
+    -- Not needed, calls from within this lib are valid
+    --is_inside_map(x,y)
     -- type valid?
-    if type ~= 0 and type ~= 1 and type ~= 2 then
-        error("modify_flood_map(x,y,type): Illegal type! "..tostring(type).."\n")
-    end
+    --if type ~= 0 and type ~= 1 and type ~= 2 then
+    --    error("modify_flood_map(x,y,type): Illegal type! "..tostring(type).."\n")
+    --end
     flood_map[y][x] = type
     return 0
 end
@@ -222,7 +266,7 @@
         end
     end
     if has_any_water == 0 then
-        error("search_initial_water(): No Water found! Please set at least 1 Water tile!\n")
+        error("init_flood(new_map, corner, method): No water found! Please set at least 1 water tile!\n")
     end
     return 0
 end
@@ -244,23 +288,24 @@
 -- Method 1:
 function examine_field_nesw(x,y)
     -- Check, if x or y is out of the flood_map bounds
-    is_inside_map(x,y)
+    -- Not needed, calls from within this lib are valid
+    --is_inside_map(x,y)
 
-    local x_border, y_border = is_on_border(x,y)
+    local on_left, on_right, on_top, on_bottom = is_on_border(x,y)
     -- NORTH
-    if x_border ~= 1 then
+    if not on_top then
         examine_field_neighbour(x,y-1)
     end
     -- EAST
-    if y_border ~= 2 then
+    if not on_right then
         examine_field_neighbour(x+1,y)
     end
     -- SOUTH
-    if x_border ~= 2 then
+    if not on_bottom then
         examine_field_neighbour(x,y+1)
     end
     -- WEST
-    if y_border ~= 1 then
+    if not on_left then
         examine_field_neighbour(x-1,y)
     end
     return 0
@@ -269,35 +314,38 @@
 -- Method 2:
 function examine_field_all8(x,y)
     -- Check, if x or y is out of the flood_map bounds
-    is_inside_map(x,y)
+    -- Not needed, calls from within this lib are valid
+    --is_inside_map(x,y)
 
-    local x_border, y_border = is_on_border(x,y)
+    local on_left, on_right, on_top, on_bottom = is_on_border(x,y)
     -- NORTH
-    if x_border ~= 1 then
+    if not on_top then
         examine_field_neighbour(x,y-1)
-        if y_border ~= 1 then
+        -- Check also for north-west and north-east
+        if not on_left then
             examine_field_neighbour(x-1,y-1)
         end
-        if y_border ~= 2 then
+        if not on_right then
             examine_field_neighbour(x+1,y-1)
         end
     end
     -- EAST
-    if y_border ~= 2 then
+    if not on_right then
         examine_field_neighbour(x+1,y)
     end
     -- SOUTH
-    if x_border ~= 2 then
+    if not on_bottom then
         examine_field_neighbour(x,y+1)
-        if y_border ~= 1 then
+        -- Check also for south-west and south-east
+        if not on_left then
             examine_field_neighbour(x-1,y+1)
         end
-        if y_border ~= 2 then
+        if not on_right then
             examine_field_neighbour(x+1,y+1)
         end
     end
     -- WEST
-    if y_border ~= 1 then
+    if not on_left then
         examine_field_neighbour(x-1,y)
     end
     return 0

Modified: branches/1.0/po/es.po
===================================================================
--- branches/1.0/po/es.po	2007-01-21 22:09:09 UTC (rev 581)
+++ branches/1.0/po/es.po	2007-01-22 17:41:59 UTC (rev 582)
@@ -7,7 +7,7 @@
 msgstr ""
 "Project-Id-Version: Enigma 0.90\n"
 "Report-Msgid-Bugs-To: \n"
-"POT-Creation-Date: 2006-12-10 18:42+0100\n"
+"POT-Creation-Date: 2006-11-22 23:27+0100\n"
 "PO-Revision-Date: 2005-05-15 23:03+0100\n"
 "Last-Translator: Roberto Garc?a <robi_garcia at gmx.ch>\n"
 "Language-Team: Spanish\n"
@@ -15,12 +15,12 @@
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: 8bit\n"
 
-#: src/server.cc:146 src/server.cc:160 src/gui/LevelInspector.cc:196
+#: src/server.cc:146 src/server.cc:160 src/gui/LevelInspector.cc:194
 msgid "Server Error: could not load level '"
 msgstr "Error del servidor: imposible cargar nivel '"
 
 #: src/client.cc:65
-#, c-format
+# c-format
 msgid "Mouse speed: %d"
 msgstr "Velocidad del rat?n: %d"
 
@@ -192,36 +192,36 @@
 msgid " Cheater!"
 msgstr " ?Tramposo!"
 
-#: src/client.cc:809
-#, c-format
+#: src/client.cc:810
+# c-format
 msgid "Enigma pack %s - level #%d: %s"
 msgstr "Lote de Enigma %s - Nivel #%d: %s"
 
-#: src/client.cc:819
+#: src/client.cc:820
 msgid "Your record: "
 msgstr "Tu mejor Tiempo:"
 
-#: src/client.cc:821
+#: src/client.cc:822
 msgid "World record to beat: "
 msgstr "Tiempo a batir: "
 
 #: src/main.cc:277
-#, c-format
+# c-format
 msgid "Error in configuration file.\n"
 msgstr "Error en fichero de configuraci?n.\n"
 
 #: src/main.cc:479 src/main.cc:497
-#, c-format
+# c-format
 msgid "Error Home directory does not exist.\n"
 msgstr "Error Home directory no existe.\n"
 
 #: src/main.cc:489
-#, c-format
+# c-format
 msgid "Error Application Data directory does not exist.\n"
 msgstr "Error Application Data directory no existe.\n"
 
 #: src/main.cc:517 src/main.cc:566
-#, c-format
+# c-format
 msgid "Error in XML initialization.\n"
 msgstr "Error en la inicializaci?n de XML.\n"
 
@@ -229,15 +229,14 @@
 msgid ""
 "Fatal Error that causes the application to quit:\n"
 "\n"
-msgstr ""
-"Error fatal que tiene por causa que se cierra la aplicaci?n:\n"
+msgstr "Error fatal que tiene por causa que se cierra la aplicaci?n:\n"
 "\n"
 
-#: src/main.cc:735 src/gui/MainMenu.cc:214
+#: src/main.cc:735 src/gui/MainMenu.cc:210
 msgid "Quit"
 msgstr "Salir"
 
-#: src/gui/MainMenu.cc:70 src/gui/MainMenu.cc:206 src/gui/LevelPackMenu.cc:62
+#: src/gui/MainMenu.cc:70 src/gui/MainMenu.cc:202 src/gui/LevelPackMenu.cc:62
 msgid "Start Game"
 msgstr "Iniciar juego"
 
@@ -245,7 +244,7 @@
 msgid "Join Game"
 msgstr "Eligir Juego"
 
-#: src/gui/MainMenu.cc:72 src/gui/OptionsMenu.cc:343
+#: src/gui/MainMenu.cc:72 src/gui/OptionsMenu.cc:342
 #: src/gui/ScreenshotViewer.cc:34
 msgid "Back"
 msgstr "Volver"
@@ -268,8 +267,7 @@
 
 #: src/gui/MainMenu.cc:117
 msgid "  MEINOLF SCHNEIDER (game idea, level design)"
-msgstr ""
-" MEINOLF SCHNEIDER (idea, dise?o de niveles), ANDREW \"NECROS\" SEGA (men? "
+msgstr " MEINOLF SCHNEIDER (idea, dise?o de niveles), ANDREW \"NECROS\" SEGA (men? "
 "m?sica)"
 
 #: src/gui/MainMenu.cc:119
@@ -308,47 +306,47 @@
 msgid "Contributors:"
 msgstr "Principales colaboradores:"
 
-#: src/gui/MainMenu.cc:207 src/gui/LevelMenu.cc:64
+#: src/gui/MainMenu.cc:203 src/gui/LevelMenu.cc:64
 msgid "Level Pack"
 msgstr "Lote de niveles"
 
-#: src/gui/MainMenu.cc:209
+#: src/gui/MainMenu.cc:205
 msgid "Network Game"
 msgstr "Jugar por la red"
 
-#: src/gui/MainMenu.cc:210
+#: src/gui/MainMenu.cc:206
 msgid "Editor"
 msgstr "Editor"
 
-#: src/gui/MainMenu.cc:212 src/gui/GameMenu.cc:48
+#: src/gui/MainMenu.cc:208 src/gui/GameMenu.cc:48
 msgid "Options"
 msgstr "Opciones"
 
-#: src/gui/MainMenu.cc:213
+#: src/gui/MainMenu.cc:209
 msgid "Credits"
 msgstr "Cr?ditos"
 
-#: src/gui/MainMenu.cc:303
+#: src/gui/MainMenu.cc:299
 msgid "Preferences Path:"
 msgstr "Preferencias del camino:"
 
-#: src/gui/MainMenu.cc:313
+#: src/gui/MainMenu.cc:309
 msgid "User Path:"
 msgstr "Camino del usador:"
 
-#: src/gui/MainMenu.cc:323
+#: src/gui/MainMenu.cc:319
 msgid "User Image Path:"
 msgstr "Nombre del Usador:"
 
-#: src/gui/MainMenu.cc:333
+#: src/gui/MainMenu.cc:329
 msgid "System Path:"
 msgstr "Camino del sistema:"
 
-#: src/gui/MainMenu.cc:343
+#: src/gui/MainMenu.cc:339
 msgid "Resource Paths:"
 msgstr "Resurcias del camino:"
 
-#: src/gui/MainMenu.cc:353
+#: src/gui/MainMenu.cc:349
 msgid "L10n Path:"
 msgstr "Camino L10n:"
 
@@ -398,62 +396,62 @@
 msgid "normal"
 msgstr "normal"
 
-#: src/gui/OptionsMenu.cc:297 src/gui/LevelInspector.cc:331
-#: src/gui/LevelInspector.cc:347 src/gui/LevelInspector.cc:360
+#: src/gui/OptionsMenu.cc:296 src/gui/LevelInspector.cc:329
+#: src/gui/LevelInspector.cc:345 src/gui/LevelInspector.cc:358
 msgid "unknown"
 msgstr "desconocido"
 
-#: src/gui/OptionsMenu.cc:362
+#: src/gui/OptionsMenu.cc:361
 msgid "Language: "
 msgstr "Idioma"
 
-#: src/gui/OptionsMenu.cc:363
+#: src/gui/OptionsMenu.cc:362
 msgid "Fullscreen: "
 msgstr "Pantalla completa: "
 
-#: src/gui/OptionsMenu.cc:364
+#: src/gui/OptionsMenu.cc:363
 msgid "Video mode: "
-msgstr "Modo de v?deo"
+msgstr "Modo de v??deo"
 
-#: src/gui/OptionsMenu.cc:365
+#: src/gui/OptionsMenu.cc:364
 msgid "Gamma correction: "
-msgstr "Correcci?n gamma"
+msgstr "Correcci?n gamma"
 
-#: src/gui/OptionsMenu.cc:366
+#: src/gui/OptionsMenu.cc:365
 msgid "Mouse speed: "
-msgstr "Velocidad del rat?n: "
+msgstr "Velocidad del rat?n: "
 
-#: src/gui/OptionsMenu.cc:379
+#: src/gui/OptionsMenu.cc:378
 msgid "Sound volume: "
 msgstr "Volumen del sonido: "
 
-#: src/gui/OptionsMenu.cc:380
+#: src/gui/OptionsMenu.cc:379
 msgid "Sound set: "
 msgstr "Grupo de sonidos: "
 
-#: src/gui/OptionsMenu.cc:381
+#: src/gui/OptionsMenu.cc:380
 msgid "Music volume: "
 msgstr "Volumen de m?sica: "
 
-#: src/gui/OptionsMenu.cc:382
+#: src/gui/OptionsMenu.cc:381
 msgid "Stereo: "
 msgstr "Est?reo: "
 
-#: src/gui/OptionsMenu.cc:383
+#: src/gui/OptionsMenu.cc:382
 msgid "Ratings update: "
 msgstr "Actualizaci?n del rating"
 
-#: src/gui/OptionsMenu.cc:397
+#: src/gui/OptionsMenu.cc:396
 msgid "User name: "
 msgstr "Nombre: "
 
-#: src/gui/OptionsMenu.cc:398
+#: src/gui/OptionsMenu.cc:397
 msgid "User path: "
 msgstr "Camino del usador: "
 
-#: src/gui/OptionsMenu.cc:399
+#: src/gui/OptionsMenu.cc:398
 msgid "User image path: "
-msgstr "Camino del imagen del usador: "
+msgstr "Imagen del usador: "
 
 #: src/gui/LevelMenu.cc:62 src/gui/LevelPackMenu.cc:63
 msgid "Main Menu"
@@ -516,60 +514,60 @@
 msgstr "No puedes jugar este nivel a?n."
 
 #: src/gui/LevelMenu.cc:280 src/gui/LevelPackComposer.cc:348
-#, c-format
+# c-format
 msgid "%s: %d levels"
 msgstr "%s: %d niveles"
 
 #: src/gui/LevelMenu.cc:296
-#, c-format
+# c-format
 msgid "%d%% best"
 msgstr "%d%% mejor"
 
-#: src/gui/LevelMenu.cc:301
-#, c-format
-msgid "%d%% par, hcp %.1f"
-msgstr "%d%% record, hcp %.1f"
+#: src/gui/LevelMenu.cc:300
+# c-format
+msgid "%d%% par"
+msgstr "%d%% record"
 
-#: src/gui/LevelMenu.cc:305
-#, c-format
+#: src/gui/LevelMenu.cc:304
+# c-format
 msgid "%d%% solved"
 msgstr "%d%% resuelto"
 
-#: src/gui/LevelMenu.cc:339
-#, c-format
+#: src/gui/LevelMenu.cc:338
+# c-format
 msgid "Your time: %d:%02d"
 msgstr "Tu marca: %d:%02d"
 
-#: src/gui/LevelMenu.cc:345
+#: src/gui/LevelMenu.cc:344
 msgid "That's world record."
 msgstr "Esto es record del mundo."
 
-#: src/gui/LevelMenu.cc:347
-#, c-format
+#: src/gui/LevelMenu.cc:346
+# c-format
 msgid "That's %d:%02d below world record."
 msgstr "%d:%02d por debajo del record."
 
-#: src/gui/LevelMenu.cc:355
-#, c-format
+#: src/gui/LevelMenu.cc:354
+# c-format
 msgid "World record by %s: %d:%02d"
 msgstr "Record de %s: %d:%02d"
 
-#: src/gui/LevelMenu.cc:358
-#, c-format
+#: src/gui/LevelMenu.cc:357
+#fuzzy, c-format
 msgid "Par: %d:%02d World record by %s: %d:%02d"
-msgstr "Par: %d:%02d Record de %s: %d:%02d"
+msgstr "Record de %s: %d:%02d"
 
-#: src/gui/LevelMenu.cc:362
-#, c-format
+#: src/gui/LevelMenu.cc:361
+# c-format
 msgid "World record: %d:%02d"
 msgstr "Tu marca: %d:%02d"
 
-#: src/gui/LevelMenu.cc:364
-#, c-format
+#: src/gui/LevelMenu.cc:363
+#fuzzy, c-format
 msgid "Par: %d:%02d World record: %d:%02d"
-msgstr "Par: %d:%02d Tu marca: %d:%02d"
+msgstr "Tu marca: %d:%02d"
 
-#: src/gui/LevelMenu.cc:398
+#: src/gui/LevelMenu.cc:397
 msgid "No further unsolved level available!"
 msgstr "?No quedan m?s niveles por resolver!"
 
@@ -653,9 +651,9 @@
 msgstr "De acuerdo"
 
 #: src/gui/LevelPackComposer.cc:362
-#, c-format
+#fuzzy, c-format
 msgid "Clipboard: %d levels"
-msgstr "El fichero: %d niveles"
+msgstr "%s: %d niveles"
 
 #: src/gui/LevelPackConfig.cc:154
 msgid "Levelpack:"
@@ -714,10 +712,8 @@
 msgstr "Actualizar lote"
 
 #: src/gui/LevelPackConfig.cc:382
-msgid ""
-"Error: empty title not allowed - press \"Undo\" to exit without modifications"
-msgstr ""
-"Error: titulo vacio no acceptado - pulse \"anular\" para salir sin cambios"
+msgid "Error: empty title not allowed - press \"Undo\" to exit without modifications"
+msgstr "Error: titulo vacio no acceptado - pulse \"anular\" para salir sin cambios"
 
 #: src/gui/LevelPackConfig.cc:393
 msgid "Error: use only \"a-zA-Z0-9 _-#\" for levelpack title"
@@ -772,11 +768,8 @@
 msgstr "Borrar grupo"
 
 #: src/gui/LPGroupConfig.cc:128
-msgid ""
-"Error: empty group name not allowed - press \"Undo\" to exit without "
-"modifications"
-msgstr ""
-"Error: titulo vacio no acceptado - pulse \"anular\" para salir sin cambios"
+msgid "Error: empty group name not allowed - press \"Undo\" to exit without modifications"
+msgstr "Error: titulo vacio no acceptado - pulse \"anular\" para salir sin cambios"
 
 #: src/gui/LPGroupConfig.cc:139
 msgid "Error: group name is a duplicate of an existing group"
@@ -827,172 +820,172 @@
 msgid "Screenshot"
 msgstr "Captura de pantalla"
 
-#: src/gui/LevelInspector.cc:223
+#: src/gui/LevelInspector.cc:221
 msgid "Level: "
 msgstr "Lote de niveles"
 
-#: src/gui/LevelInspector.cc:225 src/gui/LevelInspector.cc:283
+#: src/gui/LevelInspector.cc:223 src/gui/LevelInspector.cc:281
 msgid "Author: "
 msgstr "Autor: "
 
-#: src/gui/LevelInspector.cc:226
+#: src/gui/LevelInspector.cc:224
 msgid "Contact: "
 msgstr "Contacto: "
 
-#: src/gui/LevelInspector.cc:227
+#: src/gui/LevelInspector.cc:225
 msgid "Homepage: "
 msgstr "P?gina de red: "
 
-#: src/gui/LevelInspector.cc:248
+#: src/gui/LevelInspector.cc:246
 msgid "Public Ratings"
 msgstr "Ratas del publico"
 
-#: src/gui/LevelInspector.cc:250
+#: src/gui/LevelInspector.cc:248
 msgid "Intelligence: "
 msgstr "Inteligencia: "
 
-#: src/gui/LevelInspector.cc:251
+#: src/gui/LevelInspector.cc:249
 msgid "Dexterity: "
 msgstr "Dexteridad: "
 
-#: src/gui/LevelInspector.cc:252
+#: src/gui/LevelInspector.cc:250
 msgid "Patience: "
 msgstr "Paciencia: "
 
-#: src/gui/LevelInspector.cc:253
+#: src/gui/LevelInspector.cc:251
 msgid "Knowledge: "
 msgstr "Saber: "
 
-#: src/gui/LevelInspector.cc:254
+#: src/gui/LevelInspector.cc:252
 msgid "Speed: "
 msgstr "Velocidad: "
 
-#: src/gui/LevelInspector.cc:255
+#: src/gui/LevelInspector.cc:253
 msgid "Difficulty: "
 msgstr "Dificultad: "
 
-#: src/gui/LevelInspector.cc:276
+#: src/gui/LevelInspector.cc:274
 msgid "Scores"
 msgstr "Resultados"
 
-#: src/gui/LevelInspector.cc:279
+#: src/gui/LevelInspector.cc:277
 msgid "You: "
 msgstr "Tu: "
 
-#: src/gui/LevelInspector.cc:280
+#: src/gui/LevelInspector.cc:278
 msgid "World: "
 msgstr "Mundo: "
 
 #. TRANSLATORS: PAR = professional average rate - an expression used by golfers
-#: src/gui/LevelInspector.cc:282
+#: src/gui/LevelInspector.cc:280
 msgid "PAR: "
 msgstr "Record: "
 
-#: src/gui/LevelInspector.cc:284
+#: src/gui/LevelInspector.cc:282
 msgid "Solved %: "
 msgstr "Conseguido %: "
 
-#: src/gui/LevelInspector.cc:285
+#: src/gui/LevelInspector.cc:283
 msgid "Solved #: "
 msgstr "Conseguido #: "
 
-#: src/gui/LevelInspector.cc:307
+#: src/gui/LevelInspector.cc:305
 msgid "Version"
 msgstr "Versi?n"
 
-#: src/gui/LevelInspector.cc:310
+#: src/gui/LevelInspector.cc:308
 msgid "Score: "
 msgstr "Resultado: "
 
-#: src/gui/LevelInspector.cc:312 src/gui/LevelInspector.cc:316
+#: src/gui/LevelInspector.cc:310 src/gui/LevelInspector.cc:314
 msgid "Status: "
 msgstr "Estado: "
 
-#: src/gui/LevelInspector.cc:313
+#: src/gui/LevelInspector.cc:311
 msgid "Release: "
 msgstr "Publicaci?n: "
 
-#: src/gui/LevelInspector.cc:314
+#: src/gui/LevelInspector.cc:312
 msgid "Revision: "
 msgstr "Revisi?n: "
 
-#: src/gui/LevelInspector.cc:317
+#: src/gui/LevelInspector.cc:315
 msgid "Control: "
 msgstr "Control: "
 
-#: src/gui/LevelInspector.cc:318
+#: src/gui/LevelInspector.cc:316
 msgid "Target: "
 msgstr "Meta: "
 
-#: src/gui/LevelInspector.cc:325 src/gui/LevelInspector.cc:341
+#: src/gui/LevelInspector.cc:323 src/gui/LevelInspector.cc:339
 msgid "stable"
 msgstr "estable"
 
-#: src/gui/LevelInspector.cc:327 src/gui/LevelInspector.cc:343
+#: src/gui/LevelInspector.cc:325 src/gui/LevelInspector.cc:341
 msgid "test"
 msgstr "test"
 
-#: src/gui/LevelInspector.cc:329 src/gui/LevelInspector.cc:345
+#: src/gui/LevelInspector.cc:327 src/gui/LevelInspector.cc:343
 msgid "experimental"
 msgstr "experimental"
 
-#: src/gui/LevelInspector.cc:339
+#: src/gui/LevelInspector.cc:337
 msgid "released"
 msgstr "publicado"
 
-#: src/gui/LevelInspector.cc:351
+#: src/gui/LevelInspector.cc:349
 msgid "force"
 msgstr "fuerza"
 
-#: src/gui/LevelInspector.cc:354
+#: src/gui/LevelInspector.cc:352
 msgid "balance"
 msgstr "equilibrio"
 
-#: src/gui/LevelInspector.cc:357
+#: src/gui/LevelInspector.cc:355
 msgid "key"
 msgstr "llave"
 
-#: src/gui/LevelInspector.cc:365
+#: src/gui/LevelInspector.cc:363
 msgid "time"
 msgstr "tiempo"
 
-#: src/gui/LevelInspector.cc:366
+#: src/gui/LevelInspector.cc:364
 msgid "pushes"
 msgstr "pulses"
 
-#: src/gui/LevelInspector.cc:367
+#: src/gui/LevelInspector.cc:365
 msgid "moves"
 msgstr "movidas"
 
-#: src/gui/LevelInspector.cc:383
+#: src/gui/LevelInspector.cc:381
 msgid "World Record Holders: "
 msgstr "Los que tienes el record: "
 
-#: src/gui/LevelInspector.cc:399
+#: src/gui/LevelInspector.cc:397
 msgid "Credits: "
 msgstr "Cr?ditos"
 
-#: src/gui/LevelInspector.cc:410
+#: src/gui/LevelInspector.cc:408
 msgid "Dedication: "
 msgstr "Dedicaci?n: "
 
-#: src/gui/LevelInspector.cc:421
+#: src/gui/LevelInspector.cc:419
 msgid "Level Path: "
 msgstr "Lote de niveles"
 
-#: src/gui/LevelInspector.cc:441
+#: src/gui/LevelInspector.cc:439
 msgid "Compatibility: "
 msgstr "Compatibilidad: "
 
-#: src/gui/LevelInspector.cc:448
+#: src/gui/LevelInspector.cc:446
 msgid "Annotation: "
 msgstr "Anotaci?n: "
 
-#: src/gui/LevelInspector.cc:454
+#: src/gui/LevelInspector.cc:451
 msgid "Rating: "
 msgstr "Evaluaci?n: "
 
-#: src/gui/LevelInspector.cc:456
+#: src/gui/LevelInspector.cc:453
 msgid "Average: "
 msgstr "Media: "
 
@@ -1014,51 +1007,48 @@
 
 #: src/lev/Proxy.cc:162
 msgid "Error on auto registration of levelfile: "
-msgstr "Error en fichero de configuraci?n."
+msgstr "Error en fichero de configuraci?n: "
 
 #: src/lev/Proxy.cc:164
 msgid ""
 "Note: the level will not show up in the \"Auto Folder\" levelpack!\n"
 "\n"
-msgstr ""
-"Nota: el nivel no sera mostrado en el \"Auto Folder\" levelpack!\n"
+msgstr "Nota: el nivel no sera mostrado en el \"Auto Folder\" levelpack!\n"
 "\n"
 
 #: src/lev/Proxy.cc:166 src/lev/PersistentIndex.cc:306 src/d_models.cc:210
-#: src/d_models.cc:224 src/PreferenceManager.cc:181 src/StateManager.cc:159
+#: src/d_models.cc:224 src/PreferenceManager.cc:181 src/StateManager.cc:145
 msgid "Continue"
 msgstr "Continuar"
 
 #: src/lev/PersistentIndex.cc:302
-#, fuzzy
-msgid "Error on  registration of levelpack index: \n"
+msgid "Error on registration of levelpack index: \n"
 msgstr "error en la registraci?n del indice del lote de niveles: \n"
 
 #: src/lev/PersistentIndex.cc:304
 msgid ""
 "Note: the levelpack will not show up!\n"
 "\n"
-msgstr ""
-"Nota: el lote de niveles no sera mostrado!\n"
+msgstr "Nota: el lote de niveles no sera mostrado!\n"
 "\n"
 
 #: src/lua.cc:800
-#, c-format
+# c-format
 msgid "Cannot find '%s'.\n"
 msgstr "No puede encontrar '%s'.\n"
 
 #: src/lua.cc:801 src/lua.cc:808
-#, c-format
+# c-format
 msgid "Your installation may be incomplete or invalid.\n"
 msgstr "La instalaci?n puede estar incompleta o inv?lida.\n"
 
 #: src/lua.cc:807
-#, c-format
+# c-format
 msgid "There was an error loading '%s'.\n"
 msgstr "Error al cargar '%s'.\n"
 
 #: src/lua.cc:809
-#, c-format
+# c-format
 msgid "Error: '%s'\n"
 msgstr "Error: '%s'\n"
 
@@ -1103,7 +1093,7 @@
 msgstr "Dale otro ..."
 
 #  level: "Knight Moves"
-#  author: "illmind" email "support at mag-heut.net"
+#  author: "illmind" email ""
 #: po/level_i18n.cc:90
 msgid "So,  where  are  the  knights?  -  you'll  be  sorry  you  asked!"
 msgstr "Vale, donde estan los hombres hierros?"
@@ -1122,8 +1112,7 @@
 msgid ""
 "The other document tells the truth and the other wormhole has been left on "
 "the right side."
-msgstr ""
-"El otro documento no miente y el otro wormhole es el izqierda a la derecha"
+msgstr "El otro documento no miente y el otro wormhole es el izqierda a la derecha"
 
 #  level: "Domain of Mysteries"
 #  author: "Siegfried Fennig" email ""
@@ -1150,12 +1139,11 @@
 "A Stone, a Tree, and Trees be Three,   --   For to Defeat the Enemy,   --   "
 "Between Might Lay   --   A Secret Way!   --   (If this you see, press Shift-"
 "F3.)"
-msgstr ""
-"Piedra, arbol y arboles para 3,  --  Para ganar contra el enemigo, -- Entra "
-"might lay  --  un camino oculto!  -- (Si ves esto pulsa Shift-F3)"
+msgstr "Piedra, arbol y arboles para 3,  --  Para ganar contra el enemigo, -- "
+"Entra might lay  --  un camino oculto!  -- (Si ves esto pulsa Shift-F3)"
 
 #  level: "Laser Paradise"
-#  author: "illmind" email "support at mag-heut.net"
+#  author: "illmind" email ""
 #: po/level_i18n.cc:153
 msgid "...  now  go  back  and  get  the  hammer!"
 msgstr "... vuelve y coge el martillo!"
@@ -1175,8 +1163,7 @@
 #  level: "Pentomino I"
 #  author: "Ralf Westram" email "amgine at reallysoft.de"
 #: po/level_i18n.cc:165
-#, fuzzy
-msgid "Five form twelve!"
+msgid "Five for twelve!"
 msgstr "12 menos 5"
 
 #  level: "Enignimm"
@@ -1213,9 +1200,8 @@
 msgid ""
 "One of the puzzle stones needs to be placed onto the trigger "
 "field.                       Guess which ... :)"
-msgstr ""
-"Uno de las piedras puzzle tiene que ser placeado encima del trigero Cual "
-"ser? ...;)"
+msgstr "Uno de las piedras puzzle tiene que ser placeado encima del trigero "
+"Cual ser? ...;)"
 
 #  level: "Khun Phan"
 #  author: "Ralf Westram" email "amgine at reallysoft.de"
@@ -1226,8 +1212,8 @@
 #  level: "Welcome"
 #  author: "Raoul Bourquin" email ""
 #: po/level_i18n.cc:233 po/level_i18n.cc:689 po/level_i18n.cc:808
-#: po/level_i18n.cc:1755 po/level_i18n.cc:1971 po/level_i18n.cc:2971
-#: po/level_i18n.cc:3079
+#: po/level_i18n.cc:1729 po/level_i18n.cc:1945 po/level_i18n.cc:2936
+#: po/level_i18n.cc:3032
 msgid "Welcome"
 msgstr "Bienvenido"
 
@@ -1255,9 +1241,8 @@
 msgid ""
 "Each color appears at most once; each good color gives whites if not at the "
 "good place, blacks if it is also well placed."
-msgstr ""
-"Cada color aparece m?s que una vez; cada color cambia al blanco si esta mal "
-"situado, y al negro si esta bien situado."
+msgstr "Cada color aparece m?s que una vez; cada color cambia al blanco si esta "
+"mal situado, y al negro si esta bien situado."
 
 #  level: "Road to Eden"
 #  author: "Alain Busser" email ""
@@ -1273,23 +1258,22 @@
 msgstr "Haz una espada, & un paraguas"
 
 #  level: "Growing Boxes"
-#  author: "Lukas Sch?ller" email "Lucky_Luc at web.de"
+#  author: "Lukas Sch??ller" email "Lucky_Luc at web.de"
 #: po/level_i18n.cc:281
 msgid "You'd need a portable box!"
 msgstr "Necesitas una caja portatil"
 
 #  level: "Growing Boxes"
-#  author: "Lukas Sch?ller" email "Lucky_Luc at web.de"
+#  author: "Lukas Sch??ller" email "Lucky_Luc at web.de"
 #: po/level_i18n.cc:282
 msgid ""
 "Congratulations! You found a seed! Try to use it behind the grate (and move "
 "away quickly)"
-msgstr ""
-"Felicidades! encontraste una semilla! Pruebalo atras del grato (y marchate "
+msgstr "Felicidades! encontraste una semilla! Pruebalo atras del grato (y marchate "
 "lo m?s rapido que puedas)"
 
 #  level: "Growing Boxes"
-#  author: "Lukas Sch?ller" email "Lucky_Luc at web.de"
+#  author: "Lukas Sch??ller" email "Lucky_Luc at web.de"
 #: po/level_i18n.cc:283
 msgid ""
 "Remember that you can't fill a closed bridge with a "
@@ -1297,22 +1281,21 @@
 "3rd seed differently!"
 msgstr ""
 "Recuerda que no puedes llenar un puete cerrado con una "
-"caja ...                                          pero a lo mejor puedes "
-"usar latercer semilla de otra manera!"
+"caja ...                                          pero a lo mejor puedes usar la"
+"tercer semilla de otra manera!"
 
 #  level: "Growing Boxes"
-#  author: "Lukas Sch?ller" email "Lucky_Luc at web.de"
+#  author: "Lukas Sch??ller" email "Lucky_Luc at web.de"
 #: po/level_i18n.cc:284
 msgid "There are different kinds of seeds ... Try to use them!"
 msgstr "Ay diferentes semillas ... Usalas!"
 
 #  level: "Growing Boxes"
-#  author: "Lukas Sch?ller" email "Lucky_Luc at web.de"
+#  author: "Lukas Sch??ller" email "Lucky_Luc at web.de"
 #  comment: "read from the right"
 #: po/level_i18n.cc:286
 msgid "Noitcerid etisoppo eht yrt! Tuo syaw owt? Rorrim, rorrim ..."
-msgstr ""
-"Odal orto la n?iccerid al abeurp! Areuf arap sonimac sod? Ojepse, ojepse ..."
+msgstr "Odal orto la n?iccerid al abeurp! Areuf arap sonimac sod? Ojepse, ojepse ..."
 
 #  level: "Pentomino III"
 #  author: "Ralf Westram" email "amgine at reallysoft.de"
@@ -1332,7 +1315,8 @@
 #: po/level_i18n.cc:342
 msgid ""
 "Our full attention should deserve:           Air and Fire, Water, Earth."
-msgstr "nuestra atenci?n:\t\t\t\t    Aira y fuego, agua, tierra."
+msgstr ""
+"nuestra atenci?n:				    Aira y fuego, agua, tierra."
 
 #  level: "Moure-Switches"
 #  author: "Andreas Lochmann" email ""
@@ -1344,7 +1328,7 @@
 msgstr ""
 
 #  level: "Disk Royal"
-#  author: "illmind" email "support at mag-heut.net"
+#  author: "illmind" email ""
 #: po/level_i18n.cc:367
 msgid "is  black  always  beautiful?"
 msgstr ""
@@ -1438,7 +1422,7 @@
 
 #  level: "The Race"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:487 po/level_i18n.cc:1862
+#: po/level_i18n.cc:487 po/level_i18n.cc:1836
 msgid "It's a race!"
 msgstr ""
 
@@ -1909,233 +1893,215 @@
 
 #  level: "Basketball"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:877
+#: po/level_i18n.cc:874
 msgid "Pass the ball in time"
 msgstr ""
 
 #  level: "Just a Maze?"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:893
+#: po/level_i18n.cc:890
 msgid "It isn't as easy as it looks."
 msgstr ""
 
 #  level: "Meditation Disturbance"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:898
+#: po/level_i18n.cc:895
 msgid "Meditation Disturbance"
 msgstr ""
 
 #  level: "Meditation Disturbance"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
 #  comment: "free translatable joke about being hit by a horse"
-#: po/level_i18n.cc:901
+#: po/level_i18n.cc:898
 msgid "Hit by a bolting horse"
 msgstr ""
 
 #  level: "Bodyguard"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:906
+#: po/level_i18n.cc:903
 msgid "In the line of thieves"
 msgstr ""
 
 #  level: "Bodyguard"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:908
+#: po/level_i18n.cc:905
 msgid "Keys from left to right are NE, NW, SE, SW."
 msgstr ""
 
-#  level: "be quick or be dead"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:912
-msgid "illmind's be quick or be dead"
-msgstr ""
-
 #  level: "Dialers"
 #  author: "Edward" email ""
-#: po/level_i18n.cc:928
+#: po/level_i18n.cc:918
 msgid "Dialers"
 msgstr ""
 
 #  level: "Edwards Mountain"
 #  author: "Edward" email ""
-#: po/level_i18n.cc:932
+#: po/level_i18n.cc:922
 msgid "Edwards Mountain"
 msgstr ""
 
 #  level: "Procrustes"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:943
+#: po/level_i18n.cc:933
 msgid "Procrustes"
 msgstr ""
 
 #  level: "Houdini"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
 #  comment: "Escape as unchaining"
-#: po/level_i18n.cc:949
+#: po/level_i18n.cc:939
 msgid "Escape by Chaining Thieves"
 msgstr ""
 
 #  level: "Houdini"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
 #  comment: "Characters of Michael Ende's fantasy novel 'The Neverending Story'"
-#: po/level_i18n.cc:952
+#: po/level_i18n.cc:942
 msgid "Remember Atreyu's horse Atrax!"
 msgstr ""
 
 #  level: "Houdini"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:954
+#: po/level_i18n.cc:944
 msgid "I am unguilty! I've never stolen anything!"
 msgstr ""
 
 #  level: "Houdini"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:956
+#: po/level_i18n.cc:946
 msgid "It is said that pirates have taken the treasure."
 msgstr ""
 
 #  level: "Houdini"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:958
+#: po/level_i18n.cc:948
 msgid "Pirates usually hide their treasure!"
 msgstr ""
 
 #  level: "Houdini"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:960
+#: po/level_i18n.cc:950
 msgid "A closed door gives a better overview!"
 msgstr ""
 
 #  level: "- Meditation -"
 #  author: "Edward" email ""
-#: po/level_i18n.cc:964
+#: po/level_i18n.cc:954
 msgid "Can you rest in your bed, when all else is hectic?"
 msgstr ""
 
 #  level: "Chessing Positions"
 #  author: "Raoul Bourquin" email "raoul at users.berlios.de"
-#: po/level_i18n.cc:971
+#: po/level_i18n.cc:961
 msgid "Remember 'Changing Positions'?"
 msgstr ""
 
-#  level: "Simple Space"
-#  author: "Ulf Stegemann" email "ulf-enigma at zeitform.de"
-#: po/level_i18n.cc:979
-msgid "A really annoying Level"
-msgstr ""
-
 #  level: "Persecution Mania"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:1005
+#: po/level_i18n.cc:987
 msgid "Persecution Mania"
 msgstr ""
 
 #  level: "Persecution Mania"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:1007
+#: po/level_i18n.cc:989
 msgid "A problem shared is a problem halved!"
 msgstr ""
 
-#  level: "Tarzan"
-#  author: "Ulf Stegemann" email "ulf-enigma at zeitform.de"
-#: po/level_i18n.cc:1012
-msgid "Hanging around in the Jungle"
-msgstr ""
-
 #  level: "Ben Hur"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:1029
+#: po/level_i18n.cc:1006
 msgid "The art of steering a quadriga"
 msgstr ""
 
 #  level: "Ben Hur"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
 #  comment: "quater - historical death penalty to be devided in four parts"
-#: po/level_i18n.cc:1032
+#: po/level_i18n.cc:1009
 msgid "Dropping the spoon redeems from being quartered!"
 msgstr ""
 
 #  level: "Letter Bomb"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:1213 po/level_i18n.cc:1557
+#: po/level_i18n.cc:1190 po/level_i18n.cc:1531
 msgid "Everything's been counted carefully!"
 msgstr ""
 
 #  level: "Letter Bomb"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:1214 po/level_i18n.cc:1558
+#: po/level_i18n.cc:1191 po/level_i18n.cc:1532
 msgid "Parts of the tubes disappear during detonation!"
 msgstr ""
 
 #  level: "The Amazing Maze"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:1218
+#: po/level_i18n.cc:1195
 msgid "Business hours from 8am to 4pm"
 msgstr ""
 
 #  level: "Take a Break"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:1234
+#: po/level_i18n.cc:1211
 msgid "Forget the laser, try using force!"
 msgstr ""
 
 #  level: "Moonwalking"
-#  author: "Ulf Stegemann" email "ulf-enigma at zeitform.de"
-#: po/level_i18n.cc:1275
-msgid "Free fall with fatal consequences!"
+#  author: "Siegfried Fennig" email ""
+#: po/level_i18n.cc:1252
+msgid "Area closed"
 msgstr ""
 
 #  level: "Minor Obstacle"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:1282
+#: po/level_i18n.cc:1259
 msgid "Let there be light!"
 msgstr ""
 
 #  level: "Scrooge"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:1298
+#: po/level_i18n.cc:1275
 msgid "You really will need every penny!"
 msgstr ""
 
 #  level: "Soaring High"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:1317
+#: po/level_i18n.cc:1294
 msgid "No problem! Piece of cake!"
 msgstr ""
 
 #  level: "Soaring High"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:1318
+#: po/level_i18n.cc:1295
 msgid "It was easy, wasn't it!"
 msgstr ""
 
 #  level: "Twin Rooms"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:1334
+#: po/level_i18n.cc:1311
 msgid "Don't believe all that you see!"
 msgstr ""
 
 #  level: "Oxyd Link 68"
 #  author: "Raoul Bourquin" email ""
-#: po/level_i18n.cc:1345
+#: po/level_i18n.cc:1322
 msgid "It's a ring!"
 msgstr ""
 
 #  level: "ATARI Nostalgia"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:1349
+#: po/level_i18n.cc:1326
 msgid "Umbrellas prevent free fall!"
 msgstr ""
 
 #  level: "More Speed"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1353
+#: po/level_i18n.cc:1330
 msgid "You need to be fast!"
 msgstr ""
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1369
+#: po/level_i18n.cc:1343
 msgid ""
 "Welcome to Enigma!  This tutorial I (Jacob Scott) made will help you learn "
 "how to play."
@@ -2143,7 +2109,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1370
+#: po/level_i18n.cc:1344
 msgid ""
 "You control the black ball.  To pick up an object, just roll over it.  You "
 "can bounce off most walls (try it), but avoid the blue floor near the bottom "
@@ -2154,13 +2120,13 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1371
+#: po/level_i18n.cc:1345
 msgid "This is pretty self-explanatory."
 msgstr ""
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1372
+#: po/level_i18n.cc:1346
 msgid ""
 "Enigma is full of puzzles of various types.  In the next room, you will "
 "encounter your first one."
@@ -2168,7 +2134,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1373
+#: po/level_i18n.cc:1347
 msgid ""
 "You can't walk on water!  Try pushing the blocks into the water to get to "
 "the other side."
@@ -2176,7 +2142,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1374
+#: po/level_i18n.cc:1348
 msgid ""
 "Notice that you can't push a row of two or more blocks.  Also, blocks can't "
 "be on the same squares as grates but you can."
@@ -2184,7 +2150,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1375
+#: po/level_i18n.cc:1349
 msgid ""
 "There are different types of blocks here.  Those black blocks sink when they "
 "fall into water.  The tan blocks don't sink but don't form bridges either."
@@ -2192,7 +2158,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1376
+#: po/level_i18n.cc:1350
 msgid ""
 "That thing is a top -- it will destroy your ball if they touch.  Also, as "
 "long as you are close enough to it, the top will chase you.  If you die, you "
@@ -2203,7 +2169,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1377
+#: po/level_i18n.cc:1351
 msgid ""
 "Good job!  Notice that the top can't go beneath that block with a black "
 "outline -- you're safe."
@@ -2211,13 +2177,13 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1378
+#: po/level_i18n.cc:1352
 msgid "Those are different types of floors.  Try going over them."
 msgstr ""
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1379
+#: po/level_i18n.cc:1353
 msgid ""
 "The grayish floors are slopes.  The white floor is inverse-floor (you will "
 "see)."
@@ -2225,7 +2191,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1380
+#: po/level_i18n.cc:1354
 msgid ""
 "Watch what happens when you go over those triggers.  See if you can get the "
 "extra ball."
@@ -2233,7 +2199,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1381
+#: po/level_i18n.cc:1355
 msgid ""
 "That's dynamite.  Try dropping some next to that yellowish wall (and moving "
 "out of the way)."
@@ -2241,13 +2207,13 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1382
+#: po/level_i18n.cc:1356
 msgid "Try using the spade on the holes caused by the dynamite."
 msgstr ""
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1383
+#: po/level_i18n.cc:1357
 msgid ""
 "Those things are bolders -- try moving one of the tan blocks.  Don't fall "
 "into the water or abyss (the black floor)."
@@ -2255,7 +2221,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1384
+#: po/level_i18n.cc:1358
 msgid ""
 "Take the magic wand and hit a bolder.  Try to let the row of three bolders "
 "pass the large column."
@@ -2263,13 +2229,13 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1385
+#: po/level_i18n.cc:1359
 msgid "Hit it hard enough!"
 msgstr ""
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1386
+#: po/level_i18n.cc:1360
 msgid ""
 "It appears to be a simple room, but you're getting an extra ball anyway.  "
 "Maybe there is a reason ..."
@@ -2277,7 +2243,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1387
+#: po/level_i18n.cc:1361
 msgid ""
 "Try to get the laser beam to hit that black stone, but don't get hit by it!  "
 "Use the mirrors to direct the beam."
@@ -2285,7 +2251,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1388
+#: po/level_i18n.cc:1362
 msgid ""
 "Many objects change when hit with a laser beam.  Try hitting some of the "
 "coins with the laser beam.  Also, try hitting a block over a coin.  Those "
@@ -2295,7 +2261,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1389
+#: po/level_i18n.cc:1363
 msgid ""
 "Do you have any umbrellas?  Each one will give you approximately ten seconds "
 "of protection from danger (such as falling)."
@@ -2303,7 +2269,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1390
+#: po/level_i18n.cc:1364
 msgid ""
 "Those black stones are fart stones -- they reset all progress made with the "
 "oxyd stones.  The other stones are the oxyd stones.  Match them up to win!"
@@ -2311,7 +2277,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1391
+#: po/level_i18n.cc:1365
 msgid ""
 "This area at the bottom of the screen is your inventory -- when you pick "
 "things up, they go here (there is a maximum of twelve).  To scroll through "
@@ -2325,7 +2291,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1392
+#: po/level_i18n.cc:1366
 msgid ""
 "Naturally, you're supposed to go through those closed gates at the top of "
 "the screen.                         Try going down that slope near the "
@@ -2341,7 +2307,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1393
+#: po/level_i18n.cc:1367
 msgid ""
 "The stone in the top-right of the room is a switch.  Hit it -- it is "
 "probably useful.  In this case the switch opens and closes a door (Do you "
@@ -2351,7 +2317,7 @@
 
 #  level: "Advanced Tutorial"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1394
+#: po/level_i18n.cc:1368
 msgid ""
 "That was a rotor (similar to a top).  Some levels have many rotors and tops "
 "to make them difficult.                            However, maybe this rotor "
@@ -2361,19 +2327,19 @@
 
 #  level: "Floors 2"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1398
+#: po/level_i18n.cc:1372
 msgid "Don't drown in the swamp."
 msgstr ""
 
 #  level: "Floors 3"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1402
+#: po/level_i18n.cc:1376
 msgid "Careful - you can not swim in the water."
 msgstr ""
 
 #  level: "Doors and Triggers"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1406
+#: po/level_i18n.cc:1380
 msgid ""
 "Those doors on the right block your way to the oxyds ... on the left you see "
 "some triggers. Maybe they are somehow connected?"
@@ -2381,7 +2347,7 @@
 
 #  level: "Timers"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1410
+#: po/level_i18n.cc:1384
 msgid ""
 "This oscillating stone is a timer-stone. You cannot interact with it, but "
 "nevertheless be aware when you see one: After some time-period anything "
@@ -2390,7 +2356,7 @@
 
 #  level: "Timers"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1411
+#: po/level_i18n.cc:1385
 msgid ""
 "The stones with arrows are one-way-stones. As you might have guessed, you "
 "can only pass them in one direction.                Mazes are cherished "
@@ -2399,7 +2365,7 @@
 
 #  level: "Timers"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1412
+#: po/level_i18n.cc:1386
 msgid ""
 "Well done!     When you have finished this level, let's play some example "
 "levels from the actual Enigma packs!"
@@ -2407,7 +2373,7 @@
 
 #  level: "Blocks and Slopes"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1416
+#: po/level_i18n.cc:1390
 msgid ""
 "This wooden block is movable and heavy enough to hold down the trigger on "
 "the right.   Try to push it there!"
@@ -2415,14 +2381,14 @@
 
 #  level: "Blocks and Slopes"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1417
+#: po/level_i18n.cc:1391
 msgid ""
 "Remember?  There are different kinds of floors.  And these are steep ..."
 msgstr ""
 
 #  level: "Blocks and Slopes"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1418
+#: po/level_i18n.cc:1392
 msgid ""
 "Is there more one can do with wooden blocks?   Yes!  Just explore the next "
 "levels."
@@ -2430,7 +2396,7 @@
 
 #  level: "Lasers and Mirrors"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1422
+#: po/level_i18n.cc:1396
 msgid ""
 "The bright light beam is a laser beam.   Don't get to close to it!   But it "
 "has its usages ...    You can use the mirrors to direct the laser to its "
@@ -2439,7 +2405,7 @@
 
 #  level: "Items"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1426
+#: po/level_i18n.cc:1400
 msgid ""
 "Use the right mouse-button to rotate your inventory,  it's the bar at the "
 "bottom of the screen.   And guess what these three items down there can be "
@@ -2448,7 +2414,7 @@
 
 #  level: "Items"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1427
+#: po/level_i18n.cc:1401
 msgid ""
 "There are lots of different items to use in Enigma, as well as special "
 "floors and stones.   Let's explore some more of the actual Enigma levels!   "
@@ -2458,7 +2424,7 @@
 
 #  level: "Bye!"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1431
+#: po/level_i18n.cc:1405
 msgid ""
 "But before this, take a look at the final tutorial level Jacob devised for "
 "you.   See it as an exam, if you want to.   It's quite difficult, so don't "
@@ -2467,7 +2433,7 @@
 
 #  level: "Bye!"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:1432
+#: po/level_i18n.cc:1406
 msgid ""
 "Well, I hope you enjoyed this tutorial-pack.   You will see most of these "
 "levels a second time in the Enigma packs, together with many new and much "
@@ -2476,7 +2442,7 @@
 
 #  level: "Oxyd Stones 1"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1436
+#: po/level_i18n.cc:1410
 msgid ""
 "The blue stones are Oxyd stones. Open them by touching them with your black "
 "marble."
@@ -2484,112 +2450,112 @@
 
 #  level: "Oxyd Stones 2"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1440
+#: po/level_i18n.cc:1414
 msgid "Remember the colors."
 msgstr ""
 
 #  level: "Oxyd Stones 3"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1444
+#: po/level_i18n.cc:1418
 msgid "Some stones look exactly like the Oxyd stones!"
 msgstr ""
 
 #  level: "Movement 1"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1448
+#: po/level_i18n.cc:1422
 msgid "Learn to move your black ball properly."
 msgstr ""
 
 #  level: "Movement 2"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1452
+#: po/level_i18n.cc:1426
 msgid "Prepare for even more mouse gymnastics in the next levels."
 msgstr ""
 
 #  level: "Movement 3"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1456
+#: po/level_i18n.cc:1430
 msgid "Take your time ..."
 msgstr ""
 
 #  level: "Movement 4"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1460
+#: po/level_i18n.cc:1434
 msgid "Don't touch everything!"
 msgstr ""
 
 #  level: "Movement 5"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1464
+#: po/level_i18n.cc:1438
 msgid "Levels can be larger than one screen."
 msgstr ""
 
 #  level: "Floors 1"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1468
+#: po/level_i18n.cc:1442
 msgid "Friction and acceleration depend on the floor type."
 msgstr ""
 
 #  level: "Meditation 1"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1472
+#: po/level_i18n.cc:1446
 msgid ""
 "Move all small marbles into the holes. Only one marble per hole is allowed."
 msgstr ""
 
 #  level: "Template 1"
 #  author: "AUTHOR" email ""
-#: po/level_i18n.cc:1565
+#: po/level_i18n.cc:1539
 msgid "Template for a simple level."
 msgstr ""
 
 #  level: "Template 2"
 #  author: "AUTHOR" email ""
-#: po/level_i18n.cc:1569
+#: po/level_i18n.cc:1543
 msgid "Template for a level with the RenderLine method."
 msgstr ""
 
 #  level: "Template 3"
 #  author: "AUTHOR" email ""
-#: po/level_i18n.cc:1573
+#: po/level_i18n.cc:1547
 msgid "Template for a level coded with the ant library."
 msgstr ""
 
 #  level: "Demo I18N"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:1596
+#: po/level_i18n.cc:1570
 msgid "Translate or let it be translated"
 msgstr ""
 
 #  level: "Demo I18N"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
 #  comment: "Let 'right' be ambiguous: correct and opposite of left - if not possible choose correct"
-#: po/level_i18n.cc:1600
+#: po/level_i18n.cc:1574
 msgid "Read the right document"
 msgstr ""
 
 #  level: "Demo I18N"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
 #  comment: "the correct one and not the right positioned one"
-#: po/level_i18n.cc:1603
+#: po/level_i18n.cc:1577
 msgid "The right one, not the right one!"
 msgstr ""
 
 #  level: "The Document"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1670
+#: po/level_i18n.cc:1644
 msgid "What do you want the first gate to do?"
 msgstr ""
 
 #  level: "The Document"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1671
+#: po/level_i18n.cc:1645
 msgid "Opposite"
 msgstr ""
 
 #  level: "The Document"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1672
+#: po/level_i18n.cc:1646
 msgid ""
 "If ten equals three, five equals four, two equals three, four equals four, "
 "and thirteen equals eight, what does nine equal?"
@@ -2597,32 +2563,32 @@
 
 #  level: "The Document"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:1673
+#: po/level_i18n.cc:1647
 msgid "Congratulations!"
 msgstr ""
 
 #  level: "Mirror Room II"
-#  author: "Lukas Sch?ller" email "Lucky_Luc at web.de"
-#: po/level_i18n.cc:1680
+#  author: "Lukas Sch??ller" email "Lucky_Luc at web.de"
+#: po/level_i18n.cc:1654
 msgid "Same room, new mirrors ..."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
 #  comment: "because there is a 'w' letter in 'awale' as many 'w' letters have been used in these texts; it is not necessary to translate this feature"
-#: po/level_i18n.cc:1713
+#: po/level_i18n.cc:1687
 msgid "The witch of this switch waits for your wish."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1715
+#: po/level_i18n.cc:1689
 msgid "The witch of this switch resets the awale game."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1717
+#: po/level_i18n.cc:1691
 msgid ""
 "A turn consists in taking the walnuts of a row behind the windowy walls and "
 "sowing them 1 by 1 in the following rows."
@@ -2630,7 +2596,7 @@
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1719
+#: po/level_i18n.cc:1693
 msgid ""
 "Warning: What awaits the wailing warrior at the end of a turn? If there are "
 "2 or 3 walnuts in a row, they are a warm award for the warrior, as are the "
@@ -2640,13 +2606,13 @@
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1721
+#: po/level_i18n.cc:1695
 msgid "Warning: If one warrior's walls are empty, this awesome warrior wins."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1723
+#: po/level_i18n.cc:1697
 msgid ""
 "When a warrior has awarded more than half the walnuts, he wins. What does he "
 "win? The way to the waiting oxyds he wants."
@@ -2654,13 +2620,13 @@
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1725
+#: po/level_i18n.cc:1699
 msgid "Congratulations! You are the most aware awale player of the valley ..."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1727
+#: po/level_i18n.cc:1701
 msgid ""
 "Lost in the savannah? Don't wait and walk on the way to the reset switch on "
 "the far left ..."
@@ -2668,19 +2634,19 @@
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1729
+#: po/level_i18n.cc:1703
 msgid "Validate your choice here."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1731
+#: po/level_i18n.cc:1705
 msgid "Reset the game."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1733
+#: po/level_i18n.cc:1707
 msgid ""
 "A turn consists in taking the stones of a row and sowing them 1 by 1 in "
 "one's other rows, counterclockwise, coming back to the beginning."
@@ -2688,7 +2654,7 @@
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1735
+#: po/level_i18n.cc:1709
 msgid ""
 "At the end of a turn, if the last stone falls in a nonempty row, one takes "
 "the stones of the facing row if there is any, and repeats a turn."
@@ -2696,13 +2662,13 @@
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1737
+#: po/level_i18n.cc:1711
 msgid "A turn begins in one of the most left rows, unless impossible."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1739
+#: po/level_i18n.cc:1713
 msgid ""
 "At the end of the game (if one player cannot move anymore), the player who "
 "has the most stones wins."
@@ -2710,19 +2676,19 @@
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1741
+#: po/level_i18n.cc:1715
 msgid "A yellow stone stands for 10 blue stones (then for 2 brown stones)."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1743
+#: po/level_i18n.cc:1717
 msgid "A brown stone stands for 5 blue stones."
 msgstr ""
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1745
+#: po/level_i18n.cc:1719
 msgid ""
 "This katro game comes from Madagascar; in Easy mode there is an african "
 "Awale."
@@ -2730,13 +2696,13 @@
 
 #  level: "Enigmawale"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1747
+#: po/level_i18n.cc:1721
 msgid "Only reset or 'Shift+F3' can make things evolve ..."
 msgstr ""
 
 #  level: "Welcome to the Machine"
 #  author: "Ralf Westram" email "amgine at reallysoft.de"
-#: po/level_i18n.cc:1762
+#: po/level_i18n.cc:1736
 msgid ""
 "Sections which have the same color always turn at the same time and in the "
 "same way."
@@ -2744,79 +2710,78 @@
 
 #  level: "Welcome to the Machine"
 #  author: "Ralf Westram" email "amgine at reallysoft.de"
-#: po/level_i18n.cc:1763
+#: po/level_i18n.cc:1737
 msgid ""
 "Maintenance code: metal-stone-stone-stone-red-yellow-yellow-red-red-stone-"
 "stone."
 msgstr ""
 
 #  level: "Flying"
-#  author: "Lukas Sch?ller" email "Lucky_Luc at web.de"
-#: po/level_i18n.cc:1845
+#  author: "Lukas Sch??ller" email "Lucky_Luc at web.de"
+#: po/level_i18n.cc:1819
 msgid "You can fly a little time, if you use the umbrella."
 msgstr ""
 
 #  level: "Is It Easy?"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:1855
+#: po/level_i18n.cc:1829
 msgid " . . . There are more than two . . ."
 msgstr ""
 
 #  level: "The Grim Reaper"
 #  author: "Daniel Heck" email ""
-#: po/level_i18n.cc:1912
+#: po/level_i18n.cc:1886
 msgid "The Grim Reaper"
 msgstr ""
 
 #  level: "The Enigmhanoi Towers"
 #  author: "Alain Busser" email ""
 #  comment: "wordplay between 'enigma' and the 'hanoi towers' solitary game"
-#: po/level_i18n.cc:1924
+#: po/level_i18n.cc:1898
 msgid "The Enigmhanoi Towers"
 msgstr ""
 
 #  level: "The Enigmhanoi Towers"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1926
+#: po/level_i18n.cc:1900
 msgid "Who speaks, does not know (Lao Tse)"
 msgstr ""
 
 #  level: "The Enigmhanoi Towers"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1928
+#: po/level_i18n.cc:1902
 msgid "The wise man laughs (Lao Tse)"
 msgstr ""
 
 #  level: "The Enigmhanoi Towers"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:1930
+#: po/level_i18n.cc:1904
 msgid "Who knows, does not speak (Lao Tse)"
 msgstr ""
 
 #  level: "Welcome"
 #  author: "Raoul Bourquin" email ""
-#: po/level_i18n.cc:1972
+#: po/level_i18n.cc:1946
 msgid "Welcome to Enigma V"
 msgstr "Bienvenido a Enigma V"
 
 #  level: "Jumpin' Jack Flash"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:1985
+#: po/level_i18n.cc:1959
 msgid "This is a meditation landscape: put a small marble into every hole ..."
-msgstr ""
-"Este paisaje es de meditaci?n: pon una peque?a canica en cada agujero ..."
+msgstr "Este paisaje es de meditaci?n: pon una peque?a canica en cada agujero ..."
 
 #  level: "Firefox"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
 #  comment: "Set fire or die"
-#: po/level_i18n.cc:1991
+#: po/level_i18n.cc:1965
 msgid "Fire or be fired"
 msgstr "Fuego o que seas fuegado"
 
 #  level: "Firefox"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
 #  comment: "Firefox in sense of clever in handling fire"
-#: po/level_i18n.cc:1994
+#: po/level_i18n.cc:1968
 msgid ""
 "Do you think a bushman would start to search an extinguisher in the cellar "
 "in case of a wall of fire is approaching? Be a Firefox - you have the first "
@@ -2825,17 +2790,15 @@
 
 #  level: "Firefox"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:1996
+#: po/level_i18n.cc:1970
 msgid ""
 "You can extinguish fire with water. This is a good place to refill your "
 "extinguisher. Be aware, water is rare!"
-msgstr ""
-"Puedes apagar fuego con agua. este es buen sitio para llenar tu apaguedor. "
-"Cuidado, que no hay mucha agua"
+msgstr "Puedes apagar fuego con agua. este es buen sitio para llenar tu apaguedor. Cuidado, que no hay mucha agua"
 
 #  level: "Firefox"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:1998
+#: po/level_i18n.cc:1972
 msgid ""
 "OOPS! The maze is broken! Prepare to repair the maze before you destroy it."
 msgstr "UPS! Se ha roto! Prueba de arreglarlo antes que lo rompas"
@@ -2843,72 +2806,71 @@
 #  level: "Pirates Island"
 #  author: "Alain Busser" email ""
 #  comment: "There are coins and wood boxes (pirate's troves) and alimentary junks like seeds, empty bottles and bananas."
-#: po/level_i18n.cc:2019
+#: po/level_i18n.cc:1993
 msgid "Pirates Island"
 msgstr "Isla de los piratas"
 
 #  level: "Pirates Island"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:2021
+#: po/level_i18n.cc:1995
 msgid "The pirates have lost several hidden things on this island ..."
 msgstr "Los piratas han perdido algunas coasa encima de esta isla ..."
 
 #  level: "Elaborate"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:2025
+#: po/level_i18n.cc:1999
 msgid "It is not quite that easy."
 msgstr "No es tan facil"
 
 #  level: "Fatal Attraction I"
 #  author: "Spaceman" email ""
-#: po/level_i18n.cc:2035
+#: po/level_i18n.cc:2009
 msgid "Don't get too attracted!"
 msgstr "No te dejes demasiado atirrar"
 
 #  level: "Laser Path"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:2039
+#: po/level_i18n.cc:2013
 msgid "Try the easy mode first ..."
 msgstr "Prueba el modo facil primero ..."
 
 #  level: "Banana Republic"
 #  author: "Alain Busser" email ""
 #  comment: "This is not real spanish, only an ambience"
-#: po/level_i18n.cc:2045
+#: po/level_i18n.cc:2019
 msgid ""
 "Caramba!! El Dictator has muchos pesos in his cristal safe but muchos costa "
 "guardia too; Hay!! Poor Bola Negra has only frutos and a lasero!!!"
-msgstr ""
-"Caramba!! El Dictator has muchos pesos in his cristal safe but muchos costa "
+msgstr "Caramba!! El Dictator has muchos pesos in his cristal safe but muchos costa "
 "guardia too; Hay!! Poor Bola Negra has only frutos and a lasero!!!"
 
 #  level: "Designed with love"
 #  author: "JuSt" email ""
-#: po/level_i18n.cc:2050
+#: po/level_i18n.cc:2024
 msgid "Did you really think, this one is so easy?"
 msgstr "Pensabas que este nivel era facil?"
 
 #  level: "Designed with love"
 #  author: "JuSt" email ""
-#: po/level_i18n.cc:2052
+#: po/level_i18n.cc:2026
 msgid "Did you forget something?"
 msgstr "Te olvidaste de algo?"
 
 #  level: "Designed with love"
 #  author: "JuSt" email ""
-#: po/level_i18n.cc:2054
+#: po/level_i18n.cc:2028
 msgid "Go on! There's no way back now!"
 msgstr "Camina! Ya no puedes ir pa tras"
 
 #  level: "Designed with love"
 #  author: "JuSt" email ""
-#: po/level_i18n.cc:2056
+#: po/level_i18n.cc:2030
 msgid "STOP! Not this way! There's a short-cut ..."
 msgstr "ALTO! No por ese camino! Ay uno mas corto ..."
 
 #  level: "Designed with love"
 #  author: "JuSt" email ""
-#: po/level_i18n.cc:2058
+#: po/level_i18n.cc:2032
 msgid ""
 "There's a trigger one step to the left. If you could keep it depressed, it "
 "would help you a lot if you go back! "
@@ -2916,294 +2878,280 @@
 
 #  level: "No way out?"
 #  author: "JuSt" email ""
-#: po/level_i18n.cc:2065
+#: po/level_i18n.cc:2039
 msgid "No way out?"
 msgstr "Ninguna salida?"
 
 #  level: "No way out?"
 #  author: "JuSt" email ""
-#: po/level_i18n.cc:2066
+#: po/level_i18n.cc:2040
 msgid "Do you miss something?"
 msgstr "Te falta algo"
 
 #  level: "Fatal Attraction II"
 #  author: "Spaceman" email ""
-#: po/level_i18n.cc:2091
+#: po/level_i18n.cc:2065
 msgid "Don't get attracted!"
 msgstr "No te dejes admirar"
 
 #  level: "Print 23"
-#  author: "Richi B?tzer" email ""
-#: po/level_i18n.cc:2101
+#  author: "Richi B??tzer" email ""
+#: po/level_i18n.cc:2075
 msgid ""
 "If you have never heard about Brainf***, visit e.g. http://en.wikipedia.org/"
 "wiki/Brainfuck before you try to solve this level."
-msgstr ""
-"Nunca escuchaste de Brainf***, visita http://en.wikipedia.org/wiki/Brainfuck "
+msgstr "Nunca escuchaste de Brainf***, visita http://en.wikipedia.org/wiki/Brainfuck "
 "para resolver este nivel"
 
 #  level: "Solvable?"
 #  author: "Barry & Lori Mead" email "bmead15 at cox.net"
-#: po/level_i18n.cc:2105
+#: po/level_i18n.cc:2079
 msgid "Make an umbrella."
 msgstr "Haz un paraguas"
 
 #  level: "Gods of Enigma"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2109
+#: po/level_i18n.cc:2083
 msgid ""
 "Beware, stranger! The ancient gods of Enigma have set many traps to protect "
 "their holy Oxyds! You will have to get through the Four Tests to prove your "
 "worth!"
-msgstr ""
-"Cuidado, estranjero! los dioses ancianos de enigma han hecho muchas trampas "
-"para proteger los Oxyds santos! Tienes que hacer 4 pruebas para que nos "
-"gustes "
+msgstr "Cuidado, estranjero! los dioses ancianos de enigma han hecho muchas trampas "
+"para proteger los Oxyds santos! Tienes que hacer 4 pruebas para que nos gustes "
 
 #  level: "Gods of Enigma"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2110
+#: po/level_i18n.cc:2084
 msgid "Prove your speed in the Test of Fire!"
 msgstr "Prueba tu velocidad en la prueba del fuego"
 
 #  level: "Gods of Enigma"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2111
+#: po/level_i18n.cc:2085
 msgid "You have proven your worth! The ancients grant you a FLAG!"
 msgstr "Muy bien nos gustas! Los ancianos te dan una bandera"
 
 #  level: "Gods of Enigma"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2112
+#: po/level_i18n.cc:2086
 msgid "Prove your intelligence in the Test of Earth!"
 msgstr "Prueba tu inteligencia en la prueba de la tierra"
 
 #  level: "Gods of Enigma"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2113
+#: po/level_i18n.cc:2087
 msgid "You have proven your worth! The ancients grant you a SPRING!"
 msgstr "Muy bien nos gustas! Los ancianos te dan una pluma"
 
 #  level: "Gods of Enigma"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2114
+#: po/level_i18n.cc:2088
 msgid "Prove your dexterity in the Test of Air!"
 msgstr "Prueva tu dexteridad del aire"
 
 #  level: "Gods of Enigma"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2115
+#: po/level_i18n.cc:2089
 msgid "You have proven your worth! The ancients grant you a NAIL!"
 msgstr "Muy bien nos gustas! Los ancianos te dan un clavo"
 
 #  level: "Gods of Enigma"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2116
+#: po/level_i18n.cc:2090
 msgid "Prove your patience in the Test of Water!"
 msgstr "Ten paciencia en la prueba del agua"
 
 #  level: "Gods of Enigma"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2117
+#: po/level_i18n.cc:2091
 msgid ""
 "This can't be! No mortal can reach our Holy Oxyds! Prove yourself once more! "
 "Fwahahaha!"
-msgstr ""
-"No puede ser nadie llega hasta los Oxyds santos! Prueba otra vez! JEJEJEJEJE!"
+msgstr "No puede ser nadie llega hasta los Oxyds santos! Prueba otra vez! "
+"JEJEJEJEJE!"
 
 #  level: "Walk The Plank"
 #  author: "Nat Pryce" email ""
-#: po/level_i18n.cc:2124
+#: po/level_i18n.cc:2098
 msgid ""
 "Here lies Black Ball the pirate, marooned in the year 1802 after travelling "
 "in the wrong direction."
-msgstr ""
-"Aqui esta canica negra, cuando se hundio en el a?o 1802 navegando a la "
-"direcci?n falsa."
+msgstr "Aqui esta canica negra, cuando se hundio en el a?o 1802 "
+"navegando a la direcci?n falsa."
 
 #  level: "Walk The Plank"
 #  author: "Nat Pryce" email ""
-#: po/level_i18n.cc:2125
+#: po/level_i18n.cc:2099
 msgid ""
 "To cure sea sickness hold a large bank note between your teeth and lean over "
 "the side."
-msgstr ""
-"Para curar la enfermedad del mar coge un billete y metetelo entre los dientes"
+msgstr "Para curar la enfermedad del mar coge un billete y metetelo entre los dientes"
 
 #  level: "Lifes' Cross"
 #  author: "Raoul Bourquin" email "raoul at users.berlios.de"
-#: po/level_i18n.cc:2139
+#: po/level_i18n.cc:2113
 msgid "Could you need something?"
 msgstr "Podrias necesitar algo??"
 
 #  level: "Send me the keys !"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:2147
+#: po/level_i18n.cc:2121
 msgid "Send me the keys !"
 msgstr "Mandame las llaves"
 
 #  level: "Send me the keys !"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:2149
+#: po/level_i18n.cc:2123
 msgid "ALL the keys!!!"
 msgstr "TODAS las llaves"
 
 #  level: "Hobbyte"
 #  author: "Alain Busser" email ""
 #  comment: "an attempt has been made to imitate the language Aragorn uses in Tolkien's 'the 2 towers', which itself is an imitation of the ancient english Shakespeare wrote; the most faithful way to translate this is then to use a medieval-looking language."
-#: po/level_i18n.cc:2158
+#: po/level_i18n.cc:2132
 msgid ""
 "Mightie art the Knightes of The Olde Ages who keepe the Elfic Oxyde Stones, "
 "and numerous art the Ghostes who lye in the waye to them; many art the "
 "adventurers who tryed to steale Aylendil the Sworde but none has ever come "
 "back. Hazy is the swampe where the Magick of the Ancients is buryed; the "
 "lair of Whiteballs the dragon thu shalt avoyd in feare of awaken him ..."
-msgstr ""
-"Demasiado texto para traducir en espa?ol, pero lo resumo se trata de una "
-"historia de dragones y cuavas. nada importante!"
+msgstr "Demasiado texto para traducir en espa?ol, pero lo resumo "
+"se trata de una historia de dragones y cuavas. nada importante!"
 
 #  level: "A bayou by you"
 #  author: "Alain Busser" email ""
 #  comment: "alligators=tops, mosquitoes=tops and zombies=death stones"
-#: po/level_i18n.cc:2164
+#: po/level_i18n.cc:2138
 msgid ""
 "The most dangerous animals of the bayou are the alligators, the "
 "mosquitoes ... and the zombies! (But the zombies at least, don't move ...)"
-msgstr ""
-"Los animales m?s peligrosos  son los aligadores, los moscitos ... y los "
-"zombies! (pero los Zombies son los ?ltimos, no te muevas ...)"
+msgstr "Los animales m?s peligrosos  son los aligadores, los "
+"moscitos ... y los zombies! (pero los Zombies son los ?ltimos, no te muevas ...)"
 
 #  level: "Tropical Island"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:2168
+#: po/level_i18n.cc:2142
 msgid ""
 "Why has there always to be an active volcano and a village of marble-eating "
 "inhabitants on a tropical island?"
-msgstr ""
-"Porque tiene que haber siempre un volc?n activo y un pueblo de habitantes "
+msgstr "Porque tiene que haber siempre un volc?n activo y un pueblo de habitantes "
 "que comen canicas en una isla tropical?"
 
 #  level: "Pneumatic Delivery"
-#  author: "Manuel K?nig" email ""
-#: po/level_i18n.cc:2175
+#  author: "Manuel K??nig" email ""
+#: po/level_i18n.cc:2149
 msgid ""
 "This is my first landscape, dedicated to my father. I hope you'll enjoy it!"
 msgstr "Es mi primer tierra, dedicado a mi padre. Espero que te guste!"
 
 #  level: "Gods of Enigma II"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2182
+#: po/level_i18n.cc:2156
 msgid ""
 "You again! We won't let you pass this time! See these Oxyds? You can't reach "
 "them unless you rob our Four Holy Items! But they are well guarded! "
 "Fwahahahaha!"
-msgstr ""
-"Tu otra vez! Esta vez no te dejamos pasar! ves estos Oxyds? No llegas hasta "
-"que no has robado nuestros 4 objetos santos! Pero estan bien escondidos! "
+msgstr "Tu otra vez! Esta vez no te dejamos pasar! ves estos Oxyds? No llegas "
+"hasta que no has robado nuestros 4 objetos santos! Pero estan bien escondidos! "
 "JEJEJEJEJE!"
 
 #  level: "Gods of Enigma II"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2183
+#: po/level_i18n.cc:2157
 msgid ""
 "Fire burns and destroys ... Want to remove blocking stones? Then dig your "
 "way to the Holy Hammer!"
-msgstr ""
-"Fuego quema y deshace ... Quieres deshacer piedras blocantes? Pues cava tu "
-"camino hacia el santo martillo"
+msgstr "Fuego quema y deshace ... Quieres deshacer piedras blocantes? Pues cava "
+"tu camino hacia el santo martillo!"
 
 #  level: "Gods of Enigma II"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2184
+#: po/level_i18n.cc:2158
 msgid "Try again! Fwahahaha!"
 msgstr "Prueba de nuevo! JEJEJEJE"
 
 #  level: "Gods of Enigma II"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2185
+#: po/level_i18n.cc:2159
 msgid ""
 "Earth fills and lasts ... Want to replace missing floors? Then build your "
 "way to the Holy Seed!"
-msgstr ""
-"Tierra llena y pesa ... Quieres hacer m?s caminos? Pues haz tu camino a la "
-"sante tierra!"
+msgstr "Tierra llena y pesa ... Quieres hacer m?s caminos? Pues haz tu "
+"camino a la sante tierra!"
 
 #  level: "Gods of Enigma II"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2186
+#: po/level_i18n.cc:2160
 msgid ""
 "Air blows and goes by ... Want to jump across the void? Then make your way "
 "to the Holy Spring!"
-msgstr ""
-"Aire sopla ... Quieres saltar sobre la estufa? Pues haz tu camino a la santa "
-"primavera!"
+msgstr "Aire sopla ... Quieres saltar sobre la estufa? Pues haz tu camino "
+"a la santa primavera!"
 
 #  level: "Gods of Enigma II"
 #  author: "moonpearl" email ""
-#: po/level_i18n.cc:2187
+#: po/level_i18n.cc:2161
 msgid ""
 "Water waves and shifts ... Want to trade minds with your partner? Then find "
 "your way to the Holy Yin-Yang!"
-msgstr ""
-"Agua moja ... Quieres cambiar mente con tu compa?ero? Pues encuentra el "
-"camino al santo Yin-Yang!"
+msgstr "Agua moja ... Quieres cambiar mente con tu compa?ero? Pues encuentra "
+"el camino al santo Yin-Yang!"
 
 #  level: "Doors forever"
 #  author: "JuSt" email ""
-#: po/level_i18n.cc:2191
+#: po/level_i18n.cc:2165
 msgid "Look carefully at anything!"
 msgstr "Mira a todo con cuidado"
 
 #  level: "Doors forever"
 #  author: "JuSt" email ""
-#: po/level_i18n.cc:2192
+#: po/level_i18n.cc:2166
 msgid "Do you need a helping hand?"
 msgstr "Necesitas una mano ayudante?"
 
 #  level: "The Prison"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:2211
+#: po/level_i18n.cc:2185
 msgid "Warning ... ... thieves!"
 msgstr "Cuidado ... ... ladrones"
 
 #  level: "Ice-Bomb"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:2239
+#: po/level_i18n.cc:2213
 msgid ""
 "Remember Seed Puzzle 2? There was a similar problem. Or was it Portable "
 "Laser ...?"
-msgstr ""
-"Te recuerdas de Seed Puzzle 2? Habia un problema igual. O era Laser "
+msgstr "Te recuerdas de Seed Puzzle 2? Habia un problema igual. O era Laser "
 "Portable ...?"
 
 #  level: "Catwalk Meditation"
 #  author: "Ronald Lamprecht" email "ral at users.berlios.de"
-#: po/level_i18n.cc:2244
+#: po/level_i18n.cc:2218
 msgid "Catwalk Meditation"
 msgstr "Catwalk Meditation"
 
 #  level: "Draggers"
 #  author: "Petr Machata" email ""
-#: po/level_i18n.cc:2272
+#: po/level_i18n.cc:2246
 msgid "This level is symmetric ..."
 msgstr "Este nivel es simetrico ..."
 
 #  level: "April 1st"
 #  author: "Alain Busser" email ""
 #  comment: "in France it is an habit to tell jokes (what seems true is false) on april 1st, and these jokes are called 'april fishes'."
-#: po/level_i18n.cc:2302
+#: po/level_i18n.cc:2276
 msgid "April 1st"
 msgstr "El primero de abril"
 
 #  level: "April 1st"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:2304
+#: po/level_i18n.cc:2278
 msgid "Do you REALLY want to do this???"
 msgstr "Seguro que quieres hacer esto???"
 
 #  level: "April 1st"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:2306
+#: po/level_i18n.cc:2280
 msgid ""
 "Didn't your mother tell you that you should not spend your money in such a "
 "careless manner?"
@@ -3211,396 +3159,334 @@
 
 #  level: "April 1st"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:2308
+#: po/level_i18n.cc:2282
 msgid "What is the current month?"
 msgstr "Que mes tenemos?"
 
 #  level: "April 1st"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:2310
+#: po/level_i18n.cc:2284
 msgid "What is this level's name?"
 msgstr "Como se llama este nivel?"
 
 #  level: "Blet"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:2321
+#: po/level_i18n.cc:2295
 msgid ""
 "When you change the color of one square, the colors of the 2 nearest squares "
 "change as well; you must get as much green squares as possible."
-msgstr ""
-"Si cambias el color de un cuadro, los colores de los 2 cuadros m?s cerca "
+msgstr "Si cambias el color de un cuadro, los colores de los 2 cuadros m?s cerca "
 "cambi?n tambi?n; tienes que conseguir lo m?s posible de cuadros verdes."
 
 #  level: "Blet"
 #  author: "Alain Busser" email ""
-#: po/level_i18n.cc:2323
+#: po/level_i18n.cc:2297
 msgid ""
 "You are only allowed to change a color when it is surrounded by the other "
 "color."
-msgstr "Solo puedes cambiar de color si esta alrededor de otro color."
+msgstr "Solo puedes cambiar de color si esta alrededor de otro "
+"color."
 
 #  level: "Psycho Pushing"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:2330
+#: po/level_i18n.cc:2304
 msgid "If I only had a bag."
 msgstr "Si tendr?a una bolsa"
 
 #  level: "Psycho Pushing"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:2331
+#: po/level_i18n.cc:2305
 msgid "shh ... listen!"
 msgstr "psss ... escucha"
 
 #  level: "Snugly Packed II"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:2590
+#: po/level_i18n.cc:2564
 msgid "Nothing can stop us!"
 msgstr "Nada nos puede para"
 
 #  level: "Gardening Work"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:2615
+#: po/level_i18n.cc:2589
 msgid "Dig in ..."
 msgstr "Cava adentro ..."
 
 #  level: "Pipe Dreams"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:2620
+#: po/level_i18n.cc:2594
 msgid "... did it!"
 msgstr "... hecho!"
 
 #  level: "Per.Oxyd 11"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:2630
+#: po/level_i18n.cc:2604
 msgid "Rest on the bright spot for a minute."
 msgstr "Quedate en el punto brillante para un minuto"
 
 #  level: "Per.Oxyd 11"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:2631
+#: po/level_i18n.cc:2605
 msgid "You'll do anything you're told!"
 msgstr "Tienes que hacer lo que te digan"
 
 #  level: "Per.Oxyd 62"
 #  author: "Raoul Bourquin" email ""
-#: po/level_i18n.cc:2654
+#: po/level_i18n.cc:2628
 msgid "Did you bring your flag?"
 msgstr "Has traido tu bandera?"
 
 #  level: "Per.Oxyd 88"
 #  author: "Raoul Bourquin" email ""
-#: po/level_i18n.cc:2671
+#: po/level_i18n.cc:2645
 msgid "Watch out for water holes!"
 msgstr "Mira por agujeros de agua"
 
-#  level: "Still Swapping?"
-#  author: "Ulf Stegemann" email "ulf-enigma at zeitform.de"
-#: po/level_i18n.cc:2697
-msgid "Bricks change!"
-msgstr ""
-
-#  level: "Per.Oxyd 27"
-#  author: "Ulf Stegemann" email "ulf-enigma at zeitform.de"
-#: po/level_i18n.cc:2708
-msgid "If you think that's to easy, try \"Difficulty: Normal\"."
-msgstr ""
-
-#  level: "Per.Oxyd 27"
-#  author: "Ulf Stegemann" email "ulf-enigma at zeitform.de"
-#: po/level_i18n.cc:2710
-msgid "If you think that's to hard, try \"Difficulty: Easy\"."
-msgstr ""
-
 #  level: "Handle With Care"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:2724
+#: po/level_i18n.cc:2689
 msgid "Some stones and stone rows can be moved!"
 msgstr "Algunas piedras y lineas de piedras se pueden mover"
 
 #  level: "Deadend"
 #  author: "Daniel Heck" email ""
-#: po/level_i18n.cc:2764
+#: po/level_i18n.cc:2729
 msgid "Look closely!"
 msgstr "Mira cerca"
 
 #  level: "Control Panel"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:2768
+#: po/level_i18n.cc:2733
 msgid "The left-most room is important!"
 msgstr "la habitaci?n m?s izquierda es importante"
 
 #  level: "Control Panel"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:2769
+#: po/level_i18n.cc:2734
 msgid "This is the control panel."
 msgstr "Esto es el panel de control."
 
 #  level: "The Turtle"
 #  author: "Petr Machata" email ""
-#: po/level_i18n.cc:2782
+#: po/level_i18n.cc:2747
 msgid ""
 "Welcome to the control room. Use the triggers and switches to plan the "
 "movement of the turtle. The switches are, clockwise: Add, Run and Restart."
-msgstr ""
-"Bienvenido a la habitaci?n del control. Usa los disparadores y los "
-"interruptores para planear el movimiento de la tortuga. Los interruptores "
-"son como un reloj: A?adir, Correr y Renovar."
+msgstr "Bienvenido a la habitaci?n del control. Usa los disparadores y los interruptores "
+"para planear el movimiento de la tortuga. Los interruptores son como un reloj: A?adir, Correr y Renovar."
 
 #  level: "Emergency Exit"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:2795
+#: po/level_i18n.cc:2760
 msgid "Flood Control Dam #3 seems rather unstable. Be quick or be dead."
 msgstr "El dique #3 parece muy inestable. Sea rapido o muere."
 
 #  level: "Automatic Transmission"
 #  author: "Jacob Scott" email ""
-#: po/level_i18n.cc:2799
+#: po/level_i18n.cc:2764
 msgid "The block near the top-left can move."
 msgstr "La piedra arriba a la izquierda se puede mover"
 
 #  level: "Bridge Builders"
 #  author: "Jon 'WB' Sneyers" email ""
-#: po/level_i18n.cc:2836
+#: po/level_i18n.cc:2801
 msgid "White helps black, black helps white."
 msgstr "Blanco ayuda a negro, negro ayuda a blanco"
 
 #  level: "The Sargasso Sea"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:2864
+#: po/level_i18n.cc:2829
 msgid "This level is much bigger! Press F3!"
 msgstr "Este nivel es much?simo m?s grande! Pulsa F3!"
 
 #  level: "Waterworld"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:2877
-msgid ""
-"Remember  to  only  move  enough  stones  to  just  look  into  the  next  "
+#  author: "illmind" email ""
+#: po/level_i18n.cc:2842
+msgid "Remember  to  only  move  enough  stones  to  just  look  into  the  next  "
 "room  ..."
-msgstr ""
-"Recuerda de mover solo las suficientes piedras para mirar a la pr?xima "
+msgstr "Recuerda de mover solo las suficientes piedras para mirar a la pr?xima "
 "habitaci?n ..."
 
 #  level: "Waterworld"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:2878
+#  author: "illmind" email ""
+#: po/level_i18n.cc:2843
 msgid "You  have  lost  ..."
 msgstr "Perdiste ..."
 
 #  level: "The Ditch"
-#  author: "Richi B?tzer" email ""
-#: po/level_i18n.cc:2892
+#  author: "Richi B??tzer" email ""
+#: po/level_i18n.cc:2857
 msgid "Risk your life ..."
 msgstr "Riesga tu vida ..."
 
 #  level: "Block its way!"
 #  author: "Jon 'WB' Sneyers" email ""
-#: po/level_i18n.cc:2896
+#: po/level_i18n.cc:2861
 msgid "Don't forget to open the door ..."
 msgstr "No te olvides de abrir la puerta ..."
 
 #  level: "Block its way!"
 #  author: "Jon 'WB' Sneyers" email ""
-#: po/level_i18n.cc:2897
+#: po/level_i18n.cc:2862
 msgid "Good Luck!"
 msgstr "Mucha suerta!"
 
 #  level: "Block its way!"
 #  author: "Jon 'WB' Sneyers" email ""
-#: po/level_i18n.cc:2898
+#: po/level_i18n.cc:2863
 msgid "Hurry!"
 msgstr "Rapido!"
 
 #  level: "Block its way!"
 #  author: "Jon 'WB' Sneyers" email ""
-#: po/level_i18n.cc:2899
+#: po/level_i18n.cc:2864
 msgid "Congratulations! (or try again)"
 msgstr "Felicidades! (o prueba otra vez)"
 
 #  level: "Block its way!"
 #  author: "Jon 'WB' Sneyers" email ""
-#: po/level_i18n.cc:2900
+#: po/level_i18n.cc:2865
 msgid "Almost finished ..."
 msgstr "Casi terminado ..."
 
 #  level: "Push? Pull!"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:2910
+#: po/level_i18n.cc:2875
 msgid "Restart with F3 ..."
 msgstr "Renueva con F3 ..."
 
 #  level: "The Safe"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:2932
+#: po/level_i18n.cc:2897
 msgid "It's a long way ..."
 msgstr "Es un largo camino ..."
 
 #  level: "Unfair!"
 #  author: "Petr Machata" email ""
-#: po/level_i18n.cc:2948
-msgid ""
-"I don't believe that you are the Marble. I won't let you pass until you "
+#: po/level_i18n.cc:2913
+msgid "I don't believe that you are the Marble. I won't let you pass until you "
 "prove me wrong: you have to be faster than my champion!"
-msgstr ""
-"No puedo creer que eres la canica. No te dejare pasar hasta que me muestres "
-"que estoy equivocado: tienes que ser m?s rapido que mi campe?n!"
+msgstr "No puedo creer que eres la canica. No te dejare pasar hasta que "
+"me muestres que estoy equivocado: tienes que ser m?s rapido que mi campe?n!"
 
 #  level: "Unfair!"
 #  author: "Petr Machata" email ""
-#: po/level_i18n.cc:2949
+#: po/level_i18n.cc:2914
 msgid "Congratulations! You may pass!"
 msgstr "Felicidades! Puedes pasar!"
 
 #  level: "White Contrast"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:2956
-msgid ""
-"One  more  and  you  won't  get  this  hammer  until  you  don't  need  it  "
+#  author: "illmind" email ""
+#: po/level_i18n.cc:2921
+msgid "One  more  and  you  won't  get  this  hammer  until  you  don't  need  it  "
 "anymore!"
-msgstr ""
-"Una vez m?s y no reciberas este martillo hasta que lo necesitas nunca m?s!"
+msgstr "Una vez m?s y no reciberas este martillo hasta que lo necesitas "
+"nunca m?s!"
 
 #  level: "Hidden Danger"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:2960
+#: po/level_i18n.cc:2925
 msgid "The danger is not visible!!!"
 msgstr "El peligro no es visible!!!"
 
 #  level: "Welcome"
 #  author: "Raoul Bourquin" email ""
-#: po/level_i18n.cc:2972
+#: po/level_i18n.cc:2937
 msgid "Welcome to Enigma III"
 msgstr "Bienvenido a Enigma III"
 
 #  level: "- Snow White -"
 #  author: "Petr Machata" email ""
-#: po/level_i18n.cc:2979
+#: po/level_i18n.cc:2944
 msgid "Look ... they're over there!"
 msgstr "Mira ... est?n por all?"
 
 #  level: "Jump And Run"
 #  author: "Siegfried Fennig" email ""
-#: po/level_i18n.cc:2983
+#: po/level_i18n.cc:2948
 msgid "Watch your step!"
 msgstr "Cuidado escal?n"
 
 #  level: "Laser Castle"
 #  author: "Andreas Lochmann" email ""
-#: po/level_i18n.cc:3023
+#: po/level_i18n.cc:2988
 msgid "A castle lies before you ... beware of guardians!"
 msgstr "Un castillo miente antes que ... cuidado de los guardianes"
 
-#  level: "deja-vu"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:3055
-msgid "when  you've  been  particular  places"
-msgstr ""
-
-#  level: "deja-vu"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:3057
-msgid "that  you  know  you've  never  seen  before"
-msgstr ""
-
-#  level: "deja-vu"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:3059
-msgid "can  you  be  sure?"
-msgstr ""
-
-#  level: "deja-vu"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:3061
-msgid "feel  like  I've  been  here  before"
-msgstr ""
-
-#  level: "deja-vu"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:3063
-msgid "quote:  Iron  Maiden   -   Deja-Vu"
-msgstr ""
-
-#  level: "deja-vu"
-#  author: "illmind" email "support at mag-heut.net"
-#: po/level_i18n.cc:3065
-msgid "for  illmind's  deja  vu  try  the  top  left  corner  ..."
-msgstr ""
-
 #  level: "Welcome"
 #  author: "Raoul Bourquin" email ""
-#: po/level_i18n.cc:3080
+#: po/level_i18n.cc:3033
 msgid "Welcome to Enigma VII"
 msgstr "Bienvenido a Enigma VII"
 
 #  level: "esprit 7"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3084
+#: po/level_i18n.cc:3037
 msgid "Watch out, slippery!"
 msgstr "Cuidado, resbaladero"
 
 #  level: "Bank-O-Mat"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3097
+#: po/level_i18n.cc:3050
 msgid "Sorry for inconvenience, the Bank-O-Mat is empty."
 msgstr "Perdon por la onconveniencia, el cajero esta vacio."
 
 #  level: "esprit 8"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3125
+#: po/level_i18n.cc:3078
 msgid "Umbrellas protect!"
 msgstr "Paraguas protegen!"
 
 #  level: "esprit 96"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3150
+#: po/level_i18n.cc:3103
 msgid "It's easier with a shovel!"
 msgstr "Ser? m?s f?cil con una pala"
 
 #  level: "esprit 52"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3157
+#: po/level_i18n.cc:3110
 msgid "Sunday, bloody Sunday!"
 msgstr "Domingo, maldito Domingo!"
 
 #  level: "esprit 59"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3164
+#: po/level_i18n.cc:3117
 msgid "Watch out!!"
 msgstr "Cuidado!!"
 
 #  level: "esprit 3"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:3201
+#: po/level_i18n.cc:3154
 msgid "Can you see the hidden oxyd stones?"
 msgstr "Puedes ver los oxyd stones occultos?"
 
 #  level: "esprit 17"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3256
+#: po/level_i18n.cc:3209
 msgid "Please remember:    42"
 msgstr "Por favor recuerda:    42"
 
 #  level: "esprit 73"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3260
-#, fuzzy
-msgid "If you think this is too easy, then play -Bavarian Madness-"
+#: po/level_i18n.cc:3213
+msgid "If you think this is to easy, then play -Bavarian Madness-"
 msgstr "Si piensas que esto es demasiado f?cil, pues juega - Bavarian Madness-"
 
 #  level: "esprit 92"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3273
+#: po/level_i18n.cc:3226
 msgid "Take the key to the left first!"
 msgstr "Coge primero la llave a tu izquierda"
 
 #  level: "esprit 5"
 #  author: "Martin Hawlisch" email ""
-#: po/level_i18n.cc:3289
+#: po/level_i18n.cc:3242
 msgid "Easy?"
 msgstr "Facil?"
 
 #  level: "esprit 94"
 #  author: "Sven Siggelkow" email ""
-#: po/level_i18n.cc:3362
+#: po/level_i18n.cc:3315
 msgid "If you haven't won, you've lost!"
 msgstr "Si no has ganado, has perdido"
 



From ral at mail.berlios.de  Mon Jan 22 23:28:27 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Mon, 22 Jan 2007 23:28:27 +0100
Subject: [Enigma-game-svn] r583 - trunk/src
Message-ID: <200701222228.l0MMSRE0016810@sheep.berlios.de>

Author: ral
Date: 2007-01-22 23:28:27 +0100 (Mon, 22 Jan 2007)
New Revision: 583

Modified:
   trunk/src/floors.cc
Log:
- fix r581 fire attribute defaults
- switch fire attributes from 0/1 to boolean false/true

Modified: trunk/src/floors.cc
===================================================================
--- trunk/src/floors.cc	2007-01-22 17:41:59 UTC (rev 582)
+++ trunk/src/floors.cc	2007-01-22 22:28:27 UTC (rev 583)
@@ -418,26 +418,26 @@
                 return (selector == flft_burnable) && !has_flags(it, itf_fireproof);
         }
     }
-    if ((server::GameCompatibility == GAMET_ENIGMA) && (traits.firetype & selector))
-        return true;
+    bool dflt = (server::GameCompatibility == GAMET_ENIGMA) 
+            && (traits.firetype & selector);
     // In non-Enigma-modes, without items on them, all floors behave the same:
     switch (selector) {
         case flft_burnable :
-            return getAttr("burnable") != 0;   // no !=0 compare if attribute is boolean
+            return getAttr("burnable", dflt).to_bool();
         case flft_ignitable :
-            return getAttr("ignitable") != 0;  //  ...
+            return getAttr("ignitable", dflt).to_bool();
         case flft_secure :
-            return getAttr("secure") != 0;
+            return getAttr("secure", dflt).to_bool();
         case flft_eternal :
-            return getAttr("eternal") != 0;
+            return getAttr("eternal", dflt).to_bool();
         case flft_noash :
-            return getAttr("noash") != 0;
+            return getAttr("noash", dflt).to_bool();
         case flft_fastfire :
-            return getAttr("fastfire") != 0;
+            return getAttr("fastfire", dflt).to_bool();
         case flft_initfire :
-            return getAttr("initfire") != 0;
+            return getAttr("initfire", dflt).to_bool();
     }
-    return false;
+    return dflt;
 }
 
 void Floor::animcb() {



From raoul at mail.berlios.de  Tue Jan 30 20:51:51 2007
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Tue, 30 Jan 2007 20:51:51 +0100
Subject: [Enigma-game-svn] r584 - in trunk: attic attic/fonts
	attic/gfx-templates data/gfx data/gfx32 data/gfx40
Message-ID: <200701301951.l0UJpp2Q010945@sheep.berlios.de>

Author: raoul
Date: 2007-01-30 20:51:48 +0100 (Tue, 30 Jan 2007)
New Revision: 584

Added:
   trunk/attic/fonts/
   trunk/attic/fonts/andover.ttf
   trunk/attic/fonts/free.txt
   trunk/attic/gfx-templates/
   trunk/attic/gfx-templates/actor32.xcf
   trunk/attic/gfx-templates/enigma_logo3.xcf
   trunk/attic/gfx-templates/fl-bridgea.xcf
   trunk/attic/gfx-templates/fl-darkstone.xcf
   trunk/attic/gfx-templates/fl-redstone.xcf
   trunk/attic/gfx-templates/gfx_TODO
   trunk/attic/gfx-templates/it-drop.xcf
   trunk/attic/gfx-templates/it-magic.xcf
   trunk/attic/gfx-templates/it-trigger1.xcf
   trunk/attic/gfx-templates/it-weight.xcf
   trunk/attic/gfx-templates/items.xcf
   trunk/attic/gfx-templates/ring-anim.xcf
   trunk/attic/gfx-templates/ring-anim2.xcf
   trunk/attic/gfx-templates/st-bigbrick.xcf
   trunk/attic/gfx-templates/st-bolder.xcf
   trunk/attic/gfx-templates/st-brick.xcf
   trunk/attic/gfx-templates/st-brownie.xcf
   trunk/attic/gfx-templates/st-enigma1_0.xcf
   trunk/attic/gfx-templates/st-enigma1_templ.xcf
   trunk/attic/gfx-templates/st-fakeoxyd-blink.xcf
   trunk/attic/gfx-templates/st-floppy.xcf
   trunk/attic/gfx-templates/st-fourswitch.xcf
   trunk/attic/gfx-templates/st-greenbrown.xcf
   trunk/attic/gfx-templates/st-laser-e.xcf
   trunk/attic/gfx-templates/st-laser-n.xcf
   trunk/attic/gfx-templates/st-laser-s.xcf
   trunk/attic/gfx-templates/st-laser-w.xcf
   trunk/attic/gfx-templates/st-mirror-movable.xcf
   trunk/attic/gfx-templates/st-mirror-static.xcf
   trunk/attic/gfx-templates/st-mirrortempl.xcf
   trunk/attic/gfx-templates/st-onewaytempl.xcf
   trunk/attic/gfx-templates/st-oxyda-open.xcf
   trunk/attic/gfx-templates/st-oxydb-templ.xcf
   trunk/attic/gfx-templates/st-oxydbtempl.xcf
   trunk/attic/gfx-templates/st-puzzletempl.xcf
   trunk/attic/gfx-templates/st-rock3.xcf
   trunk/attic/gfx-templates/st-rotator.xcf
   trunk/attic/gfx-templates/st-shogun.xcf
   trunk/attic/gfx-templates/st-stoneimpulse.xcf
   trunk/attic/gfx-templates/st-switch.xcf
   trunk/attic/gfx-templates/st-switch1.xcf
   trunk/attic/gfx-templates/st-switch_black1.png
   trunk/attic/gfx-templates/st-switch_black2.png
   trunk/attic/gfx-templates/st-switch_white1.png
   trunk/attic/gfx-templates/st-switch_white2.png
   trunk/attic/gfx-templates/st-thief2.xcf
   trunk/attic/gfx-templates/st-timer.xcf
   trunk/attic/gfx-templates/st-wood.xcf
   trunk/attic/gfx-templates/st-woven.xcf
Removed:
   trunk/data/gfx/enigma_logo3.xcf
   trunk/data/gfx32/actor32.xcf
   trunk/data/gfx32/fl-bridgea.xcf
   trunk/data/gfx32/fl-darkstone.xcf
   trunk/data/gfx32/fl-redstone.xcf
   trunk/data/gfx32/it-magic.xcf
   trunk/data/gfx32/it-trigger1.xcf
   trunk/data/gfx32/items.xcf
   trunk/data/gfx32/ring-anim.xcf
   trunk/data/gfx32/ring-anim2.xcf
   trunk/data/gfx32/st-bigbrick.xcf
   trunk/data/gfx32/st-bolder.xcf
   trunk/data/gfx32/st-brick.xcf
   trunk/data/gfx32/st-brownie.xcf
   trunk/data/gfx32/st-enigma1_0.xcf
   trunk/data/gfx32/st-enigma1_templ.xcf
   trunk/data/gfx32/st-fakeoxyd-blink.xcf
   trunk/data/gfx32/st-floppy.xcf
   trunk/data/gfx32/st-fourswitch.xcf
   trunk/data/gfx32/st-greenbrown.xcf
   trunk/data/gfx32/st-laser-e.xcf
   trunk/data/gfx32/st-laser-n.xcf
   trunk/data/gfx32/st-laser-s.xcf
   trunk/data/gfx32/st-laser-w.xcf
   trunk/data/gfx32/st-mirror-movable.xcf
   trunk/data/gfx32/st-mirror-static.xcf
   trunk/data/gfx32/st-mirrortempl.xcf
   trunk/data/gfx32/st-onewaytempl.xcf
   trunk/data/gfx32/st-oxyda-open.xcf
   trunk/data/gfx32/st-oxydb-templ.xcf
   trunk/data/gfx32/st-oxydbtempl.xcf
   trunk/data/gfx32/st-puzzletempl.xcf
   trunk/data/gfx32/st-rock3.xcf
   trunk/data/gfx32/st-rotator.xcf
   trunk/data/gfx32/st-shogun.xcf
   trunk/data/gfx32/st-stoneimpulse.xcf
   trunk/data/gfx32/st-switch.xcf
   trunk/data/gfx32/st-switch1.xcf
   trunk/data/gfx32/st-thief2.xcf
   trunk/data/gfx32/st-timer.xcf
   trunk/data/gfx32/st-wood.xcf
   trunk/data/gfx32/st-woven.xcf
   trunk/data/gfx40/TODO
   trunk/data/gfx40/ac-whiteball-sinkdown.png
   trunk/data/gfx40/sh-blackball-sinkdown.png
   trunk/data/gfx40/st-switch_black1.png
   trunk/data/gfx40/st-switch_black2.png
   trunk/data/gfx40/st-switch_white1.png
   trunk/data/gfx40/st-switch_white2.png
Log:
-> Big clean up in the gfx dirs
-> Added title font and some templates



Added: trunk/attic/fonts/andover.ttf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/fonts/andover.ttf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/attic/fonts/free.txt
===================================================================
--- trunk/attic/fonts/free.txt	2007-01-22 22:28:27 UTC (rev 583)
+++ trunk/attic/fonts/free.txt	2007-01-30 19:51:48 UTC (rev 584)
@@ -0,0 +1,30 @@
+	http://www.netspace.net.au/~joison/uddi/fonts/fonts.htm
+
+
+
+	
+	t h i s   f o n t			t h i s   f o n t
+	is	  f r e e			is	  f r e e
+				   d
+	m a d e       b y			m a d e       b y
+	u d d i   u d d i			u d d i   u d d i
+
+
+			   t h i s   f o n t
+		u	   is	     f r e e		d
+
+			   m a d e       b y
+			   u d d i   u d d i
+
+	t h i s   f o n t			t h i s   f o n t
+	is	  f r e e			is	  f r e e
+				   i
+	m a d e       b y			m a d e       b y
+	u d d i   u d d i			u d d i   u d d i
+
+	
+
+
+	 http://www.netspace.net.au/~joison/uddi/fonts/fonts.htm
+			
+			uddiuddi at earthling.net
\ No newline at end of file


Property changes on: trunk/attic/fonts/free.txt
___________________________________________________________________
Name: svn:eol-style
   + native

Copied: trunk/attic/gfx-templates/actor32.xcf (from rev 583, trunk/data/gfx32/actor32.xcf)

Copied: trunk/attic/gfx-templates/enigma_logo3.xcf (from rev 583, trunk/data/gfx/enigma_logo3.xcf)

Copied: trunk/attic/gfx-templates/fl-bridgea.xcf (from rev 583, trunk/data/gfx32/fl-bridgea.xcf)

Copied: trunk/attic/gfx-templates/fl-darkstone.xcf (from rev 583, trunk/data/gfx32/fl-darkstone.xcf)

Copied: trunk/attic/gfx-templates/fl-redstone.xcf (from rev 583, trunk/data/gfx32/fl-redstone.xcf)

Copied: trunk/attic/gfx-templates/gfx_TODO (from rev 583, trunk/data/gfx40/TODO)

Added: trunk/attic/gfx-templates/it-drop.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/gfx-templates/it-drop.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Copied: trunk/attic/gfx-templates/it-magic.xcf (from rev 583, trunk/data/gfx32/it-magic.xcf)

Copied: trunk/attic/gfx-templates/it-trigger1.xcf (from rev 583, trunk/data/gfx32/it-trigger1.xcf)

Added: trunk/attic/gfx-templates/it-weight.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/gfx-templates/it-weight.xcf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Copied: trunk/attic/gfx-templates/items.xcf (from rev 583, trunk/data/gfx32/items.xcf)

Copied: trunk/attic/gfx-templates/ring-anim.xcf (from rev 583, trunk/data/gfx32/ring-anim.xcf)

Copied: trunk/attic/gfx-templates/ring-anim2.xcf (from rev 583, trunk/data/gfx32/ring-anim2.xcf)

Copied: trunk/attic/gfx-templates/st-bigbrick.xcf (from rev 583, trunk/data/gfx32/st-bigbrick.xcf)

Copied: trunk/attic/gfx-templates/st-bolder.xcf (from rev 583, trunk/data/gfx32/st-bolder.xcf)

Copied: trunk/attic/gfx-templates/st-brick.xcf (from rev 583, trunk/data/gfx32/st-brick.xcf)

Copied: trunk/attic/gfx-templates/st-brownie.xcf (from rev 583, trunk/data/gfx32/st-brownie.xcf)

Copied: trunk/attic/gfx-templates/st-enigma1_0.xcf (from rev 583, trunk/data/gfx32/st-enigma1_0.xcf)

Copied: trunk/attic/gfx-templates/st-enigma1_templ.xcf (from rev 583, trunk/data/gfx32/st-enigma1_templ.xcf)

Copied: trunk/attic/gfx-templates/st-fakeoxyd-blink.xcf (from rev 583, trunk/data/gfx32/st-fakeoxyd-blink.xcf)

Copied: trunk/attic/gfx-templates/st-floppy.xcf (from rev 583, trunk/data/gfx32/st-floppy.xcf)

Copied: trunk/attic/gfx-templates/st-fourswitch.xcf (from rev 583, trunk/data/gfx32/st-fourswitch.xcf)

Copied: trunk/attic/gfx-templates/st-greenbrown.xcf (from rev 583, trunk/data/gfx32/st-greenbrown.xcf)

Copied: trunk/attic/gfx-templates/st-laser-e.xcf (from rev 583, trunk/data/gfx32/st-laser-e.xcf)

Copied: trunk/attic/gfx-templates/st-laser-n.xcf (from rev 583, trunk/data/gfx32/st-laser-n.xcf)

Copied: trunk/attic/gfx-templates/st-laser-s.xcf (from rev 583, trunk/data/gfx32/st-laser-s.xcf)

Copied: trunk/attic/gfx-templates/st-laser-w.xcf (from rev 583, trunk/data/gfx32/st-laser-w.xcf)

Copied: trunk/attic/gfx-templates/st-mirror-movable.xcf (from rev 583, trunk/data/gfx32/st-mirror-movable.xcf)

Copied: trunk/attic/gfx-templates/st-mirror-static.xcf (from rev 583, trunk/data/gfx32/st-mirror-static.xcf)

Copied: trunk/attic/gfx-templates/st-mirrortempl.xcf (from rev 583, trunk/data/gfx32/st-mirrortempl.xcf)

Copied: trunk/attic/gfx-templates/st-onewaytempl.xcf (from rev 583, trunk/data/gfx32/st-onewaytempl.xcf)

Copied: trunk/attic/gfx-templates/st-oxyda-open.xcf (from rev 583, trunk/data/gfx32/st-oxyda-open.xcf)

Copied: trunk/attic/gfx-templates/st-oxydb-templ.xcf (from rev 583, trunk/data/gfx32/st-oxydb-templ.xcf)

Copied: trunk/attic/gfx-templates/st-oxydbtempl.xcf (from rev 583, trunk/data/gfx32/st-oxydbtempl.xcf)

Copied: trunk/attic/gfx-templates/st-puzzletempl.xcf (from rev 583, trunk/data/gfx32/st-puzzletempl.xcf)

Copied: trunk/attic/gfx-templates/st-rock3.xcf (from rev 583, trunk/data/gfx32/st-rock3.xcf)

Copied: trunk/attic/gfx-templates/st-rotator.xcf (from rev 583, trunk/data/gfx32/st-rotator.xcf)

Copied: trunk/attic/gfx-templates/st-shogun.xcf (from rev 583, trunk/data/gfx32/st-shogun.xcf)

Copied: trunk/attic/gfx-templates/st-stoneimpulse.xcf (from rev 583, trunk/data/gfx32/st-stoneimpulse.xcf)

Copied: trunk/attic/gfx-templates/st-switch.xcf (from rev 583, trunk/data/gfx32/st-switch.xcf)

Copied: trunk/attic/gfx-templates/st-switch1.xcf (from rev 583, trunk/data/gfx32/st-switch1.xcf)

Copied: trunk/attic/gfx-templates/st-switch_black1.png (from rev 583, trunk/data/gfx40/st-switch_black1.png)

Copied: trunk/attic/gfx-templates/st-switch_black2.png (from rev 583, trunk/data/gfx40/st-switch_black2.png)

Copied: trunk/attic/gfx-templates/st-switch_white1.png (from rev 583, trunk/data/gfx40/st-switch_white1.png)

Copied: trunk/attic/gfx-templates/st-switch_white2.png (from rev 583, trunk/data/gfx40/st-switch_white2.png)

Copied: trunk/attic/gfx-templates/st-thief2.xcf (from rev 583, trunk/data/gfx32/st-thief2.xcf)

Copied: trunk/attic/gfx-templates/st-timer.xcf (from rev 583, trunk/data/gfx32/st-timer.xcf)

Copied: trunk/attic/gfx-templates/st-wood.xcf (from rev 583, trunk/data/gfx32/st-wood.xcf)

Copied: trunk/attic/gfx-templates/st-woven.xcf (from rev 583, trunk/data/gfx32/st-woven.xcf)

Deleted: trunk/data/gfx/enigma_logo3.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/actor32.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-bridgea.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-darkstone.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-redstone.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-magic.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-trigger1.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/items.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/ring-anim.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/ring-anim2.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-bigbrick.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-bolder.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-brick.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-brownie.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-enigma1_0.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-enigma1_templ.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-fakeoxyd-blink.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-floppy.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-fourswitch.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-greenbrown.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-laser-e.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-laser-n.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-laser-s.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-laser-w.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-mirror-movable.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-mirror-static.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-mirrortempl.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-onewaytempl.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-oxyda-open.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-oxydb-templ.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-oxydbtempl.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-puzzletempl.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-rock3.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-rotator.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-shogun.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-stoneimpulse.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-switch.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-switch1.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-thief2.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-timer.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-wood.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-woven.xcf
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/TODO
===================================================================
--- trunk/data/gfx40/TODO	2007-01-22 22:28:27 UTC (rev 583)
+++ trunk/data/gfx40/TODO	2007-01-30 19:51:48 UTC (rev 584)
@@ -1,359 +0,0 @@
-o  ac-blackball-fall.png
-o  ac-blackball-jump.png
-o  ac-blackball-shatter.png
-o  ac-drowned.png
-.  ac-horse.png
-.  ac-whiteball-fall.png
-.  ac-whiteball-jump.png
-.  ac-whiteball-shatter.png
-.  ac-whiteball-sinkdown.png
-.  ac-whiteball-small-fall.png
-.  ac-whiteball-small-shatter.png
-.  ac-whiteball-small-shattered.png
-.  ac-whiteball-small.png
-.  ac-whiteball.png
-.  dummy.png
-.  error.png
-.  expl.png
-o  fg-blackball-sink.png
-o  fg-blackball.png
-.  fg-bug.png
-o  fg-rotor.png
-o  fg-top.png
-o  fg-whiteball-sink.png
-o  fl-abyss.png
-o  fl-acblack.png
-o  fl-acwhite.png
-o  fl-black.png
-o  fl-bluegray.png
-o  fl-bluegreen.png
-o  fl-bluegreen2.png
-o  fl-bluegreenx.png
-o  fl-bluegreenx2.png
-o  fl-brick.png
-o  fl-bridgea-closed.png
-o  fl-bridgea-open.png
-o  fl-bridgea.png
-o  fl-bridgex-closed.png
-o  fl-bridgex-open.png
-o  fl-bridgex.png
-o  fl-bridgey-closed.png
-o  fl-bridgey-open.png
-o  fl-bridgey.png
-o  fl-bumps.png
-o  fl-concrete.png
-o  fl-darkgray.png
-o  fl-dummy.png
-o  fl-dunes.png
-o  fl-floor_001.png
-o  fl-gradient2.png
-o  fl-gravel.png
-o  fl-gray.png
-o  fl-hay.png
-o  fl-himalaya.png
-o  fl-ice.png
-o  fl-inverse.png
-o  fl-inverse2.png
-o  fl-leaves.png
-o  fl-light.png
-o  fl-lightgray.png
-o  fl-marble.png
-o  fl-metal.png
-o  fl-metalb.png
-o  fl-mortar.png
-o  fl-normal.png
-o  fl-plank.png
-o  fl-red.png
-o  fl-rock1.png
-o  fl-rock2.png
-o  fl-rough-blue.png
-o  fl-rough-red.png
-o  fl-rough.png
-o  fl-sahara.png
-o  fl-samba.png
-o  fl-sand.png
-o  fl-space.png
-o  fl-springboard.png
-o  fl-stone.png
-o  fl-stwood.png
-o  fl-swamp.png
-x  fl-tigris.png
-o  fl-trigger.png
-o  fl-water.png
-o  fl-white.png
-o  fl-wood.png
-o  fl-woven.png
-o  halo-blink.png
-o  halo.png
-.  inv-blackball.png
-.  inv-whiteball.png
-o  invisible.png
-o  it-banana.png
-o  it-blackbomb-burning.png
-o  it-blackbomb.png
-o  it-blocker.png
-o  it-booze.png
-o  it-brush.png
-o  it-burnable_ash.png
-o  it-burnable_burning.png
-o  it-burnable_fireproof.png
-o  it-burnable_ignite.png
-o  it-cherry.png
-o  it-coffee.png
-o  it-coin1.png
-o  it-coin2.png
-o  it-coin4.png
-o  it-crack.png
-o  it-cross.png
-o  it-dummy.png
-o  it-dynamite-burning.png
-o  it-dynamite.png
-o  it-extinguisher.png
-o  it-glasses-broken.png
-o  it-glasses.png
-o  it-hstrip.png
-o  it-key.png
-o  it-landmine.png
-o  it-magnet-off.png
-o  it-magnet-on.png
-o  it-pencil.png
-o  it-pipe.png
-o  it-seed.png
-o  it-shogun-big.png
-o  it-shogun-med.png
-o  it-shogun-small.png
-o  it-spoon.png
-o  it-springboard.png
-o  it-squashed.png
-o  it-vortex.png
-o  it-vstrip.png
-o  it-weight.png
-o  it-whitebomb-burning.png
-o  it-whitebomb.png
-o  it-wormhole.png
-o  it-wrench.png
-o  items.png
-o  ring-anim.png
-o  sh-actorimpulse.png
-o  sh-blackball-jump.png
-o  sh-blackball-sink.png
-.  sh-blackball-sinkdown.png
-.  sh-blackball.png
-.  sh-brake.png
-.  sh-doorh.png
-.  sh-doorv.png
-x  sh-floating.png
-.  sh-glass.png
-o  sh-grate1.png
-.  sh-grate2.png
-o  sh-grate3.png
-.  sh-horse.png
-.  sh-pull.png
-.  sh-puzzle1.png
-o  sh-rotor.png
-.  sh-round.png
-.  sh-round2-growing.png
-.  sh-round2.png
-o  sh-shogun1.png
-o  sh-shogun2.png
-o  sh-shogun4.png
-.  sh-solid.png
-.  sh-top.png
-o  sh-white4.png
-.  sh-whiteball-small.png
-.  sh-whiteball.png
-o  st-actorimpulse.png
-.  st-bigbrick.png
-o  st-blackballs.png
-o  st-blocker.png
-o  st-blue-sand.png
-o  st-bluegray.png
-o  st-bolder-fall.png
-o  st-bolder.png
-o  st-bombs.png
-o  st-brake.png
-o  st-break.png
-o  st-break_acblack.png
-o  st-break_acwhite.png
-o  st-break_bolder.png
-o  st-break_gray.png
-o  st-break_invisible.png
-o  st-brick.png
-o  st-brownie.png
-.  st-bug.png
-.  st-bumps.png
-.  st-chargeminus.png
-.  st-chargeplus.png
-.  st-chargezero.png
-.  st-coin2slot.png
-.  st-coinslot.png
-o  st-death.png
-.  st-disco.png
-.  st-doorb.png
-.  st-doorh.png
-.  st-doorv.png
-.  st-dummy.png
-.  st-easymode.png
-.  st-fakeoxyd-blink_0001.png
-.  st-fakeoxyd-blink_0002.png
-.  st-fakeoxyd-blink_0003.png
-.  st-fakeoxyd-blink_0004.png
-.  st-fart-break.png
-.  st-flash.png
-.  st-floppy1.png
-.  st-floppy2.png
-.  st-fourswitch.png
-.  st-glass.png
-.  st-glass1.png
-.  st-glass2.png
-.  st-glass3.png
-.  st-grate1.png
-.  st-grate2.png
-.  st-grate3.png
-.  st-greenbrown.png
-.  st-key1.png
-.  st-key2.png
-.  st-knight.png
-.  st-laser-base.png
-.  st-laser-e_0001.png
-.  st-laser-e_0002.png
-.  st-laser-e_0003.png
-.  st-laser-e_0004.png
-.  st-laser-e_0005.png
-.  st-laser-e_0006.png
-.  st-laser-e_0007.png
-.  st-laser-e_0008.png
-.  st-laser-e_0009.png
-.  st-laser-n_0001.png
-.  st-laser-n_0002.png
-.  st-laser-n_0003.png
-.  st-laser-n_0004.png
-.  st-laser-n_0005.png
-.  st-laser-n_0006.png
-.  st-laser-n_0007.png
-.  st-laser-n_0008.png
-.  st-laser-n_0009.png
-.  st-laser-s_0001.png
-.  st-laser-s_0002.png
-.  st-laser-s_0003.png
-.  st-laser-s_0004.png
-.  st-laser-s_0005.png
-.  st-laser-s_0006.png
-.  st-laser-s_0007.png
-.  st-laser-s_0008.png
-.  st-laser-s_0009.png
-.  st-laser-w_0001.png
-.  st-laser-w_0002.png
-.  st-laser-w_0003.png
-.  st-laser-w_0004.png
-.  st-laser-w_0005.png
-.  st-laser-w_0006.png
-.  st-laser-w_0007.png
-.  st-laser-w_0008.png
-.  st-laser-w_0009.png
-.  st-magic.png
-.  st-mail.png
-.  st-marble.png
-.  st-metal.png
-.  st-mirror-movable.png
-.  st-mirror-static.png
-.  st-mirrortempl_0001.png
-.  st-mirrortempl_0002.png
-.  st-mirrortempl_0003.png
-.  st-mirrortempl_0004.png
-.  st-mirrortempl_0005.png
-.  st-mirrortempl_0006.png
-.  st-mirrortempl_0007.png
-.  st-mirrortempl_0008.png
-.  st-mirrortempl_0009.png
-.  st-mirrortempl_0010.png
-.  st-mirrortempl_0011.png
-.  st-mirrortempl_0012.png
-.  st-mirrortempl_0013.png
-.  st-mirrortempl_0014.png
-.  st-mirrortempl_0015.png
-.  st-mirrortempl_0016.png
-.  st-oneway.png
-.  st-oxyd-questmark.png
-.  st-oxyda-open.png
-.  st-oxyda-opening.png
-.  st-oxyda.png
-.  st-oxydb-open.png
-.  st-oxydb-opening.png
-.  st-oxydb.png
-.  st-oxydbtempl_0001.png
-.  st-oxydbtempl_0002.png
-.  st-oxydbtempl_0003.png
-.  st-oxydbtempl_0004.png
-.  st-oxydbtempl_0005.png
-.  st-oxydbtempl_0006.png
-.  st-oxydbtempl_0007.png
-.  st-oxydbtempl_0008.png
-.  st-oxydbtempl_0009.png
-.  st-oxydbtempl_0010.png
-.  st-oxydbtempl_0011.png
-.  st-oxydbtempl_0012.png
-.  st-oxydbtempl_0013.png
-.  st-oxydbtempl_0014.png
-.  st-oxydc-open.png
-.  st-oxydc-opening.png
-.  st-oxydc.png
-.  st-oxydd-open.png
-.  st-oxydd-opening.png
-.  st-oxydd.png
-.  st-plain.png
-.  st-pull.png
-.  st-puzzle.png
-.  st-rock1.png
-.  st-rock2.png
-.  st-rock3-break.png
-.  st-rock3-falling.png
-.  st-rock3.png
-.  st-rock3_cracked.png
-.  st-rock4.png
-.  st-rock5.png
-.  st-rock6.png
-.  st-rock7.png
-.  st-rock8.png
-.  st-rock9.png
-.  st-rotator-left.png
-.  st-rotator-right.png
-.  st-rubberband.png
-.  st-scissors-snip.png
-.  st-scissors.png
-.  st-shogun.png
-.  st-stone1.png
-.  st-stone2.png
-.  st-stone_break.png
-.  st-stoneimpulse-hollow.png
-.  st-stoneimpulse.png
-.  st-surprise.png
-.  st-swap.png
-.  st-switch.png
-.  st-switch_black.png
-.  st-switch_black1.png
-.  st-switch_black2.png
-.  st-switch_white.png
-.  st-switch_white1.png
-.  st-switch_white2.png
-.  st-thief.png
-.  st-time1switch.png
-.  st-timer.png
-.  st-timeswitch.png
-.  st-turnstile-green.png
-.  st-turnstile.png
-.  st-white1.png
-.  st-white2.png
-.  st-white3.png
-.  st-white4.png
-.  st-whiteballs.png
-.  st-window.png
-.  st-wood-growing.png
-.  st-wood.png
-.  st-wood_001.png
-.  st-woven.png
-.  st-yellow.png
-.  st-yinyang1.png
-.  st-yinyang2.png
-.  stones.png
-.  unavailable.png

Deleted: trunk/data/gfx40/ac-whiteball-sinkdown.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-blackball-sinkdown.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-switch_black1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-switch_black2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-switch_white1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-switch_white2.png
===================================================================
(Binary files differ)



