<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1285 - trunk/doc/reference
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2008-August/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1285%20-%20trunk/doc/reference&In-Reply-To=%3C200808232004.m7NK4Le9024759%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000714.html">
   <LINK REL="Next"  HREF="000716.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1285 - trunk/doc/reference</H1>
    <B>andreasl at mail.berlios.de</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1285%20-%20trunk/doc/reference&In-Reply-To=%3C200808232004.m7NK4Le9024759%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1285 - trunk/doc/reference">andreasl at mail.berlios.de
       </A><BR>
    <I>Sat Aug 23 22:04:21 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000714.html">[Enigma-game-svn] r1284 - in trunk/data/levels: enigma_iii	enigma_tutorial enigma_vi enigma_vii enigma_viii lib
</A></li>
        <LI>Next message: <A HREF="000716.html">[Enigma-game-svn] r1286 - in trunk: data data/levels/lib src	src/stones
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#715">[ date ]</a>
              <a href="thread.html#715">[ thread ]</a>
              <a href="subject.html#715">[ subject ]</a>
              <a href="author.html#715">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: andreasl
Date: 2008-08-23 22:04:18 +0200 (Sat, 23 Aug 2008)
New Revision: 1285

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk:
 - Add chapter &quot;Libraries&quot; to refman, current sections:
    - liblua (complete)
    - libmath (complete)
    - libmap (complete)
    - libsoko (empty)
 - Adapt example &quot;Wired&quot; after splitting of libluatools.
 - Adapt subsection about &quot;drawMap&quot;.
Todo:
 - Section about libsoko.
 - Possibly a full example for the first three libraries
   (mabye &quot;Fashions Pass&quot;?)


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2008-08-23 16:58:35 UTC (rev 1284)
+++ trunk/doc/reference/enigma-ref.texi	2008-08-23 20:04:18 UTC (rev 1285)
@@ -38,6 +38,7 @@
 * Stone Objects::
 * Actor Objects::
 * Other Objects::               Rubberbands, etc.
+* Libraries::                   Advanced tools
 * Advanced Features::           Fire, ...
 * Extension Development::       Resolver, Library Development
 * Old API - Objects::           Description of all objects in Enigma
@@ -1338,7 +1339,7 @@
 * Internationalization (i18n)::
 * Usage::
 * Update and Upgrade::
-* Libraries::
+* Using Libraries::
 @end menu
 
 @node Getting Started with Levels
@@ -2554,15 +2555,15 @@
 use this element for the same purpose, with the same syntax, without modifying the author's
 protected section.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at node</A> Libraries
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at section</A> Libraries
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Using Libraries
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at section</A> Using Libraries
 
 Libraries are collections of Lua functions for reuse in many levels. To use a library, you must
-declare it as an dependency, as described in @ref{&lt;compatibility&gt;}. Preloading the library is all
+declare it as a dependency, as described in @ref{&lt;compatibility&gt;}. Preloading the library is all
 you have to do to use the library. Otherwise, you can use the function @ref{enigma.LoadLib} to
 load the library at a certain point of execution.
 
-Enigma provides several very useful libraries. You will find them on the system
+Enigma provides several very useful @ref{Libraries}. You will find them on the system
 path in the subdirectory @samp{levels/lib}. Most of them are documented in-line.
 You will find a separate documentation file
 @samp{doc/ant_lua.txt} for @samp{ant}.
@@ -4595,7 +4596,7 @@
 
 @example
 01	  &lt;el:compatibility el:enigma=&quot;1.10&quot;&gt;
-02	    &lt;el:dependency el:path=&quot;lib/libluatools&quot; el:id=&quot;lib/libluatools&quot; el:release=&quot;1&quot; el:preload=&quot;true&quot;/&gt;
+02	    &lt;el:dependency el:path=&quot;lib/libmath&quot; el:id=&quot;lib/libmath&quot; el:release=&quot;1&quot; el:preload=&quot;true&quot;/&gt;
 03	  &lt;/el:compatibility&gt;
 ...
 04    @i{ti}[&quot;@var{ }&quot;] = @{&quot;@b{fl-sahara}&quot;, @b{friction} = @var{3.5}, @b{adhesion} = @var{4.0}@}
@@ -4614,11 +4615,11 @@
 17    @i{ti}[&quot;@var{S}&quot;] = @{&quot;@b{st_switch}&quot;, @b{target} = &quot;@var{easy_mode_call}&quot;@}
 18    
 19    @var{floors}  = @{@i{ti}[&quot;@var{ }&quot;], @i{ti}[&quot;@var{a}&quot;], @i{ti}[&quot;@var{b}&quot;], @i{ti}[&quot;@var{c}&quot;]@}
-20    @var{polynom} = @i{luatools}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{random_vector}(@var{10}, @var{4})
+20    @var{polynom} = @i{lib}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{math}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{random_vector}(@var{10}, @var{4})
 21    
 22    function @var{myresolver}(@var{key}, @var{x}, @var{y})
 23      if @var{key} == &quot;@var{ }&quot; then 
-24	  return @var{floors}[@i{luatools}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{cubic_polynomial}(@var{polynom}, @var{x}, @var{y}) % (#@var{floors}) + @var{1}]
+24	  return @var{floors}[@i{lib}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{math}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{cubic_polynomial}(@var{polynom}, @var{x}, @var{y}) % (#@var{floors}) + @var{1}]
 25      elseif    (@var{key} == &quot;@var{#}&quot;)
 26            or ((@var{key} == &quot;@var{_}&quot;) and (@i{random}(@var{4}) == @var{1}))
 27            or ((@var{key} == &quot;@var{S}&quot;) and @i{wo}[&quot;@b{IsDifficult}&quot;]) then
@@ -4645,8 +4646,8 @@
 48       &quot;@var{####################___________________}&quot;
 49    @})
 50    
-51    @var{door_p} = @i{luatools}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{permutation}(@var{12})
-52    @var{wire_p} = @i{luatools}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{permutation}(@var{12})
+51    @var{door_p} = @i{lib}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{math}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{permutation}(@var{12})
+52    @var{wire_p} = @i{lib}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{math}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{permutation}(@var{12})
 53    @var{woods} = @i{no}[&quot;@var{wood}#*&quot;]
 54    @var{triggers} = @i{no}[&quot;@var{trigger}#*&quot;]
 55    @var{doors} = @i{no}[&quot;@var{door}#*&quot;]
@@ -4682,11 +4683,11 @@
 
 @example
 01	  &lt;el:compatibility el:enigma=&quot;1.10&quot;&gt;
-02	    &lt;el:dependency el:path=&quot;lib/libluatools&quot; el:id=&quot;lib/libluatools&quot; el:release=&quot;1&quot; el:preload=&quot;true&quot;/&gt;
+02	    &lt;el:dependency el:path=&quot;lib/libmath&quot; el:id=&quot;lib/libmath&quot; el:release=&quot;1&quot; el:preload=&quot;true&quot;/&gt;
 03	  &lt;/el:compatibility&gt;
 @end example
-We make use of some functions of the luatools library. Thus we need to preload it, 
-besides declaration of compatibility to Enigma 1.10.
+We make use of some functions of the @ref{libmath} library. Thus we need to
+preload it, besides declaration of compatibility to Enigma 1.10.
 
 @example
 04    @i{ti}[&quot;@var{ }&quot;] = @{&quot;@b{fl-sahara}&quot;, @b{friction} = @var{3.5}, @b{adhesion} = @var{4.0}@}
@@ -4731,7 +4732,7 @@
 
 @example
 19    @var{floors}  = @{@i{ti}[&quot;@var{ }&quot;], @i{ti}[&quot;@var{a}&quot;], @i{ti}[&quot;@var{b}&quot;], @i{ti}[&quot;@var{c}&quot;]@}
-20    @var{polynom} = @i{luatools}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{random_vector}(@var{10}, @var{4})
+20    @var{polynom} = @i{lib}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{math}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{random_vector}(@var{10}, @var{4})
 @end example
 Preparations for the floor design. The four floor tiles are stored in a table
 for number based index access. Ten random numbers in the range 1 to 4 are
@@ -4749,7 +4750,7 @@
 
 @example
 23      if @var{key} == &quot;@var{ }&quot; then 
-24	  return @var{floors}[@i{luatools}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{cubic_polynomial}(@var{polynom}, @var{x}, @var{y}) % (#@var{floors}) + @var{1}]
+24	  return @var{floors}[@i{lib}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{math}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{cubic_polynomial}(@var{polynom}, @var{x}, @var{y}) % (#@var{floors}) + @var{1}]
 @end example
 These two lines generate the always changing floor design. For every map key
 @samp{ } we calculate the cubic polynomial that is randomized due to the
@@ -4798,11 +4799,11 @@
 default floor is @samp{ }, too.
 
 @example
-51    @var{door_p} = @i{luatools}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{permutation}(@var{12})
-52    @var{wire_p} = @i{luatools}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{permutation}(@var{12})
+51    @var{door_p} = @i{lib}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{math}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{permutation}(@var{12})
+52    @var{wire_p} = @i{lib}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{math}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">. at i</A>{permutation}(@var{12})
 @end example
 Now let us shuffle the trigger/door assignment and the wire distribution. We
-do this by permutating 12 index numbers to be used for door and wire access.
+do this by permuting 12 index numbers to be used for door and wire access.
 
 @example
 53    @var{woods} = @i{no}[&quot;@var{wood}#*&quot;]
@@ -9082,6 +9083,962 @@
 @menu
 @end menu
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ===================  Libraries  =======================
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Libraries
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at chapter</A> Libraries
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at menu</A>
+* liblua::       General methods for tables.
+* libmath::      Mathematical algorithms, like random permutations.
+* libmap::       Methods for API 2-maps.
+* libsoko::      A library to interpret Sokoban level files.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> menu
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> liblua
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at section</A> liblua
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at menu</A>
+* lib.lua.combine_tables::  Collect entries of anonymous Lua-tables into a common table.
+* lib.lua.cond::            A wrapper for if.
+* lib.lua.deep_copy::       Complete copies of Lua-tables.
+* lib.lua.mod::             A modulo operation.
+* lib.lua.print_table::     Print tables for debug reasons.
+* lib.lua.shuffle_table::   Shuffle arbitrary anonymous Lua-tables.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> menu
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- combine_tables -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.lua.combine_tables
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.lua.combine_tables
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{combine_tables} combines all entries of a set or table of tables into one
+common table (i.e., it joins the subtables). As some of the subtables can have
+equally named entries, the first subtable has highest priority, the second
+subtable second priority etc.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.lua.combine_tables}(@i{overtable})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.lua.combine_tables}(@i{table1}, @i{table2}, ...)
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{overtable}
+A table of tables: @samp{overtable = @{table1, table2, ...@}}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{table1}, @i{table2}, ...
+Lua tables to be joined.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+all_contacts = lib.lua.combine_tables(telephon_numbers, email_addresses)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+Just as groups can be joined by @samp{grp1 + grp2}, it can sometimes be
+neccessary to join anonymous tables, as well. 
+In most situations, object grouping should be used instead, but when one works
+with more abstract data (like names of objects instead of objects, or tables
+holding design informations), @samp{combine_tables} can be useful.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- cond -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.lua.cond
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.lua.cond
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{lib.lua.cond} is a conditional assignment, a ternary operator very
+similar (but not equal to) the @samp{?:}-expression in C-like languages. Note
+however, that there are caveats, see details.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.lua.cond}(@i{condition}, @i{iftrue}, @i{iffalse})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{condition}
+A boolean expression.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{iftrue}
+The expression to be returned if @samp{condition} is true.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{iffalse}
+The expression to be returned if @samp{condition} is false.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.lua.cond(wo[&quot;IsDifficult&quot;], @{&quot;st_death&quot;@}, ti[&quot;#&quot;])
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{lib.lua.cond} evaluates both expressions @samp{iftrue} and
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{iffalse}, regargless of @samp{condition}. Hence,
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.lua.cond(t == 0, 1/t, error(&quot;Division by zero&quot;))
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+will always raise an error: All sideeffects will happen.
+Another example which will not work:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+w,h = lib.lua.cond(wo[&quot;IsDifficult&quot;], wo(ti, &quot; &quot;, map1), wo(ti, &quot; &quot;, map2))
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+Use this instead:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+w,h = wo(ti, &quot; &quot;, lib.lua.cond(wo[&quot;IsDifficult&quot;], map1, map2))
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+However, in most cases @samp{lib.lua.cond} is used with static expressions for
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{iftrue} and @samp{iffalse} (e.g. strings or variables), when no
+sideeffects are possible.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- deep_copy -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.lua.deep_copy
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.lua.deep_copy
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{deep_copy} returns a copy of its argument, where table entries are
+not copied as memory references (like Lua typically does), but complete
+(thereby called &quot;deep copy&quot;).
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.lua.deep_copy}(@i{source})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{source}
+The object to be copied.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+a = @{5@}
+b = a
+c = lib.lua.deep_copy(a)
+b[1] = 4
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+After these four commands, @samp{a[1]} and @samp{b[1]} will both be @samp{4},
+but @samp{c[1]} will still be @samp{5}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+Metatables are transfered, but not deep-copied.
+Userdata (like tiles and positions) is not guaranteed to be deep-copied.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- mod -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.lua.mod
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.lua.mod
+
+A wrapper for the modulo operation.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.lua.mod}(@i{value}, @i{modul})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{value}, @i{modul}
+Numbers. @samp{modul} must be positive (non-zero).
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.lua.mod(7*7, 17)
+lib.lua.mod(5.3, 1/3)
+lib.lua.mod(no[&quot;marble&quot;].x, 1)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+Lua 5.0 uses @samp{math.mod} as modulo operation, Lua 5.1 provides @samp{%} and
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{math.fmod}. Whereas all three operations agree on positive numbers and
+zero as @samp{value}, there are differences on negative numbers:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+math.mod(-1, 4) == -1
+math.fmod(-1, 4) == -1
+(-1)%4 == 3
+lib.lua.mod(-1, 4) == 3
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+While the Lua-own modulo functions yield results even for negative
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{modul} (with varying signs of the outcome), @samp{lib.lua.mod} will raise
+an error if @samp{modul &lt;= 0}, and the result @samp{r} is otherwise guaranteed
+to be @samp{0 &lt;= r &lt; modul}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- print_table -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.lua.print_table
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.lua.print_table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{print_table} is a debug command, which uses the API's @samp{print}
+command to recursively print its argument to the standard output.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.lua.print_table}(@i{table}, @i{prefix}, @i{depth})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{table}
+The table to be printed.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{prefix}
+A string which will be printed before the table as a
+separator. Can be @samp{nil}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{depth}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{nil} in normal use, @samp{-1} if you want to suppress the recursion.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+a = @{1, 5=2, &quot;Hello&quot;, other_table = @{x = 4, y = 5, z = &quot;World&quot;@}@}
+lib.lua.print_table(a, nil, -1)
+lib.lua.print_table(a, &quot;--&gt; &quot;)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{print_table} is recursive, i.e. a table with table
+as entries will call @samp{print_table} again. To avoid
+infinite loops, @samp{depth} is used internally to count
+the depth level of the recursion. The recursion currently
+stops on depth 5. Set @samp{depth} to @samp{-1} to stop
+recursion entirely.
+
+Use @samp{print_table} only for debugging and testing, it
+is not meant as an element of gameplay.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- shuffle_table -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.lua.shuffle_table
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.lua.shuffle_table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{shuffle_table} randomly resorts its argument.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.lua.shuffle_table}(@i{source})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{source}
+The table to be shuffled.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+a = @{1, 2, 3, &quot;r&quot;, @{&quot;x&quot;, &quot;y&quot;, &quot;z&quot;@}, 4@}
+lib.lua.shuffle_table(a)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+A typical result for @samp{a} would be
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+a = @{&quot;r&quot;, 4, 2, @{&quot;x&quot;, &quot;y&quot;, &quot;z&quot;@}, 1, 3@}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+The result is a permutation of the original table. The permutation restricts to
+those entries with numerical keys, and of those only the ones between @samp{1}
+and @samp{table.getn(@i{source})}. @samp{shuffle_table} has no return value.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> libmath
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at section</A> libmath
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at menu</A>
+* lib.math.combinations::       Calculates all possible combinations of a set.
+* lib.math.cubic_polynomial::   Calculates the result of a cubic polynomial.
+* lib.math.cyclic_permutation:: Random cyclic permutation.
+* lib.math.digits::             Decomposes a number into digits for an arbitrary base.
+* lib.math.manhattan_distance:: Calculates the Manhattan distance of positions.
+* lib.math.permutation::        Random permutation.
+* lib.math.random_vector::      A table with random entries.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> menu
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- combinations -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.math.combinations
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.math.combinations
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{lib.math.combinations} returns a table of all combinations of
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{depth} entries, each of which is chosen from @samp{digits}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.math.combinations}(@i{depth}, @i{digits})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{depth}
+A positive integer.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{digits}
+A positive integer or a table with numerical entries.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.math.combinations(2, 2)
+ == @{ @{1, 1@}, @{1, 2@}, @{2, 1@}, @{2, 2@} @}
+lib.math.combinations(3, @{7, 8, &quot;a&quot;@})
+ == @{ @{7,7,7@}, @{7,7,8@}, @{7,7,&quot;a&quot;@},
+       @{7,8,7@}, @{7,8,8@}, @{7,8,&quot;a&quot;@},
+       @{7,&quot;a&quot;,7@}, @{7,&quot;a&quot;,8@}, @{7,&quot;a&quot;,&quot;a&quot;@},
+       @{8,7,7@}, ... @}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+Mathematically, it builds the leafs of an @samp{#digits}-ary tree
+of depth @samp{depth}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- cubic_polynomial -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.math.cubic_polynomial
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.math.cubic_polynomial
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{cubic_polynomial} returns the result of the following polynomial with
+coefficients in @samp{a}:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+a[10]*y*y*y + a[9]*x*y*y + a[8]*x*x*y + a[7]*x*x*x
+  + a[6]*y*y + a[5]*x*y + a[4]*x*x + a[3]*y + a[2]*x + a[1]
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.math.cubic_polynomial}(@i{a}, @i{x}, @i{y})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{a}
+A table with numerical entries @samp{a[1]} to @samp{a[10]}. The entries may be
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{nil} (i.e. missing), then they are interpreted as zero.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{x}, @i{y}
+Numbers.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.math.cubic_polynomial(@{1, a, b@}, x, y) == a*x + b*y
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+You can use @samp{lib.math.random_vector(10, ...)} and a modulo operation to
+easily form a random pattern of a floor, or choose the coefficients to your own
+liking. Entries in A which are not numbers are considered zero.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
+This is an excerpt from &quot;Wired&quot; and demonstrates the use of
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{cubic_polynomial} inside a custom resolver to create random, but
+patternlike floors:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+[...]
+floors = @{ti[&quot; &quot;], ti[&quot;a&quot;], ti[&quot;b&quot;], ti[&quot;c&quot;]@}
+polynom = lib.math.random_vector(10, 4)
+
+function myresolver(key, x, y)
+  if key == &quot; &quot; then  
+    return floors[lib.math.cubic_polynomial(a, x, y) % (#floors) + 1]
+  elseif
+    [...]
+  else
+    return ti[key]
+  end
+end
+
+w, h = wo(myresolver, &quot; &quot;, @{
+[...]
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+&quot;Wired&quot; is explained in detail in section @ref{Wired}.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- cyclic_permutation -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.math.cyclic_permutation
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.math.cyclic_permutation
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{cyclic_permutation} returns a random permutation (i.e. a random shuffling)
+of the numbers 1 to @samp{n}, which is cyclic: There exists a closed path from
+any number to any other number (see details below).
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.math.cyclic_permutation}(@i{n})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{n}
+A positive integer.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.math.cyclic_permutation(#no[&quot;marbles#*&quot;])
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+A cyclic permutation is a special kind of permutation, which has only one
+cycle. The easiest way is to give an example for a cyclic permutation:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+8, 1, 2, 9, 3, 7, 4, 6, 10, 5
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+We may write this as:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+1 -&gt; 8
+2 -&gt; 1
+3 -&gt; 2
+...
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+We can now put all of these together into a sequence:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+1 -&gt; 8 -&gt; 6 -&gt; 7 -&gt; 4 -&gt; 9 -&gt; 10 -&gt; 5 -&gt; 3 -&gt; 2 -&gt; 1
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+This is, the sequence creates a single cycle through all 10 numbers.
+This is not always possible with a general permutation.
+
+If you need a fixpoint-free permutation, you might choose to use a cyclic
+permutation instead, although not every fixpoint-free permutation is cyclic.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
+If you want to connect an arbitrary number of meditation marbles with
+rubberbands in a cyclic manner, but otherwise randomly, you can use
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{lib.math.cyclic_permutation}:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+marbles = no[&quot;marbles#*&quot;]
+p = lib.math.cyclic_permutation(#marbles)
+
+for j = 1, #marbles do
+  wo:add(@{&quot;ot_rubberband&quot;, anchor1 = marbles[j], anchor2 = marbles[p[j]]@})
+end
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+If you want to connect them in a linear way, you can either remove a step in
+the loop:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+[...]
+for j = 1, #marbles - 1 do
+[...]
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+or use @samp{lib.math.permutation} in the following way:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+marbles = no[&quot;marbles#*&quot;]
+p = lib.math.permutation(#marbles)
+
+for j = 1, #marbles - 1 do
+  wo:add(@{&quot;ot_rubberband&quot;, anchor1 = marbles[p[j]], anchor2 = marbles[p[j+1]]@})
+end
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- digits -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.math.digits
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.math.digits
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{lib.math.digits} returns a table whose elements are the digits of
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{number} in base @samp{base}. @samp{base} can be a positive integer (e.g.
+3 to get ternary) as well as a table (then the table entries with numerical
+keys will be used as digits).
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.math.digits}(@i{number}, @i{base})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{number}
+A non-negative integer.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{base}
+A positive integer other than 1, or a table with numerical keys.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.math.digits(13, 2) == @{1, 0, 1, 1@}
+lib.math.digits(15, 16) == @{15@}
+lib.math.digits(17, 3) == @{2, 2, 1@}
+lib.math.digits(17, @{2, &quot;b&quot;, 5@}) == @{5, 5, &quot;b&quot;@}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+The following function can be used to get a table with hexadecimal entries:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.math.digits(x, @{0,1,2,3,4,5,6,7,8,9,&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;@})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- manhattan_distance -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.math.manhattan_distance
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.math.manhattan_distance
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{manhattan_distance} calculates the Manhattan distance between two
+positions @samp{pos1} and @samp{pos2}, which is 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+|pos1.x - pos2.x| + |pos1.y - pos2.y|.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.math.manhattan_distance}(@i{pos1}, @i{pos2})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.math.manhattan_distance}(@i{x1}, @i{y1}, @i{x2}, @i{y2})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{pos1}, @i{pos2}
+Positions (e.g. object references or tables @samp{@{posx, posy@}}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{x1}, @i{y1}, @i{x2}, @i{y2}
+Coordinates of the positions @samp{pos1} and @samp{pos2}, respectively.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.math.manhattan_distance(4, 5, 3, 3)
+lib.math.manhattan_distance(@{4, 5@}, @{3, 3@})
+lib.math.manhattan_distance(no[&quot;marble&quot;], no[&quot;othermarble&quot;])
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+The Manhattan distance counts the minimal number of pushes neccessary to push a
+wood stone from one position to another. Its unit balls are squares with the
+diagonals parallel to the x- and y-axis (rhombi).
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- permutation -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.math.permutation
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.math.permutation
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{permutation} returns a random permutation (i.e. a random shuffling) of the
+numbers 1 to @samp{n}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.math.permutation}(@i{n})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{n}
+A positive integer.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.math.permutation(#no[&quot;doors#*&quot;])
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+Permutations give a simple way to randomize a level, e.g. by changing the
+assignment of action/target-pairs (&quot;Which trigger to which door?&quot;).
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- random_vector -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> lib.math.random_vector
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> lib.math.random_vector
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{random_vector} returns a table of @samp{n} random entries.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{lib.math.random_vector}(@i{n}, @i{...})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{n}
+A non-negative integer.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{...}
+Further arguments, which are the same as for @samp{math.random}: Either no
+further arguments, then the random numbers will be float values in
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{[0,1)}, or with one additional number @samp{p}, then the random numbers
+will be integers between 1 and @samp{p} (both included), or two additional
+numbers @samp{p, q}, then the random numbers will be integers between @samp{p}
+and @samp{q} (both included).
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.math.random_vector(4, 3)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+will return a table of 4 random numbers out of @{1,2,3@}, and
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+lib.math.random_vector(22)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+returns a table of 22 float values between 0.0 and 1.0 (excluding 1.0).
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{random_vector} can be used in conjunction with @samp{cubic_polynomial} to
+create random patterns, see @ref{lib.math.cubic_polynomial} and @ref{Wired}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Full Example:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+  
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> libmap
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at section</A> libmap
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{libmap} gives the author more possibilities to work with API 2-maps. Up
+to now, a map just is a table of strings, as described in @ref{World Creation
+and Resolver Chaining}. With @samp{libmap}, you can utilize maps in a more
+advanced way.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at menu</A>
+* Creating Maps::
+* Drawing Maps::
+* Rotating and Mirroring Maps::
+* Requesting and Changing Single Map Entries::
+* Connecting Two Maps::
+* Other Map Tasks::
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> menu
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Creating Maps -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Creating Maps
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Creating Maps
+
+We start by defining a table of strings representing the level we want to
+write in a two-dimensional array of tile keys:
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mypremap = @{&quot;# # # # # # # &quot;,
+            &quot;o t1  #   t2o &quot;,
+            &quot;#     #     # &quot;,
+            &quot;#     d2d1# # &quot;,
+            &quot;# @@1#     @@2# &quot;,
+            &quot;# # #     t1# &quot;,
+            &quot;o   d3    t3o &quot;,
+            &quot;# # # # # # # &quot;@}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+To not get confused with names, in this section we'll call such a table of
+strings a 'premap'. We create a map (in the sense of libmap) by applying
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{wo:newMap} to it, with a default key and the premap as arguments:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mymap = wo:newMap(&quot;  &quot;, mypremap)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+The default key is saved in @samp{mymap} as well, it's part of a map.
+
+You can use
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mymap = wo:newMap(key, height, width)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+to define map of size @samp{height*width}, where every tile key is @samp{key},
+and the default key is set to @samp{key} as well. You might even omit
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{height} and @samp{width}, then you create a map consisting of only one
+character.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Drawing Maps -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Drawing Maps
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Drawing Maps
+
+Just as we could've used the premap with @samp{wo} or @samp{wo:drawMap} to draw
+it (see @ref{drawMap}), we can use the newly created map as well:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+wo(resolver, mymap)
+wo:drawMap(resolver, anchor, mymap)
+wo:drawMap(resolver, anchor, ignore, mymap)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+When the @samp{ignore}-attribute for @samp{drawMap} is omitted, the default key
+of @samp{mymap} is used instead.
+
+Of course you can draw the map multiple times, even from within a resolver, see
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{drawMap} for a full example.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Rotating and Mirroring Maps -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Rotating and Mirroring Maps
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Rotating and Mirroring Maps
+
+We can transform a single map simply by using one of the following commands:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+newmap = lib.map.transform(mymap, operation)
+newmap = mymap ^ operation
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{operation} can be any of the following constants:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @samp{MAP_IDENT}
+No transformation.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @samp{MAP_ROT_CW}
+Rotate 90 degrees clockwise.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @samp{MAP_ROT_180}
+Rotate 180 degrees (i.e. a point reflection around the midpoint)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @samp{MAP_ROT_CCW}
+Rotate 90 degrees counter-clockwise.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @samp{MAP_MIRROR_HORIZONTAL}
+Mirror along a vertical axis, i.e. left and right are swapped.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @samp{MAP_MIRROR_VERTICAL}
+Mirror along a horizontal axis, i.e. up and down are swapped.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @samp{MAP_MIRROR_SLASH}
+Mirror along the diagonal from upper-left to lower-right corner.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @samp{MAP_MIRROR_BACKSLASH}
+Mirror along the diagonal from upper-right to lower-left corner.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+The mirror-constants might seem inverse to their meaning, however it's meant in
+the following sense: @samp{MAP_MIRROR_HORIZONTAL} flips left and right, i.e. the
+reflection is done in horizontal direction, with a vertical axis.
+
+When you want to perform two transformations after each other, remember that
+neither
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+newmap = mymap ^ operation1 ^ operation2
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+nor
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+newmap = mymap ^ (operation1 * operation2)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+will work. The correct syntax is:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+newmap = (mymap ^ operation1) ^ operation2
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Requesting and Changing Single Map Entries -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Requesting and Changing Single Map Entries
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Requesting and Changing Single Map Entries
+
+Let's take a look at our example again:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mymap = wo:newMap(&quot;  &quot;, @{&quot;# # # # # # # &quot;,
+                         &quot;o t1  #   t2o &quot;,
+                         &quot;#     #     # &quot;,
+                         &quot;#     d2d1# # &quot;,
+                         &quot;# @@1#     @@2# &quot;,
+                         &quot;# # #     t1# &quot;,
+                         &quot;o   d3    t3o &quot;,
+                         &quot;# # # # # # # &quot;@})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+It's easy to check, what kind of tile key is at position @code{@{1,1@}} (note
+that the upper left corner is at position @code{@{0,0@}}):
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mymap[@{1, 1@}] == &quot;t1&quot;
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+It's similarly easy to change it. Let's say, we want to create a passage
+one tile right beside the second marble @samp{@@2}, which is named
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{marble2}:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mymap[no[&quot;marble2&quot;] + @{1,0@}]
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+Note that the reference to @samp{marble2} only works after the marble has been
+set.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Connecting Two Maps -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Connecting Two Maps
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Connecting Two Maps
+
+Given two maps @samp{map1} and @samp{map2}, we can glue them together
+horizontally by @samp{map1 .. map2} as well as vertically with @samp{map1 +
+map2}. Missing entries will be filled with the default key of the respective
+map, the default key of the result will be the one of @samp{map1}. A simple
+example:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+map1 = wo:newMap(&quot; &quot;, @{&quot;####&quot;,
+                        &quot;o  #&quot;,
+                        &quot;# w#&quot;,
+                        &quot;####&quot;@})
+map2 = wo:newMap(&quot;.&quot;, @{&quot;#######&quot;,
+                        &quot;#w.#..#&quot;,
+                        &quot;#..D..#&quot;,
+                        &quot;#..#.w#&quot;,
+                        &quot;#######&quot;@})
+map1 .. map2 == wo:newMap(&quot; &quot;, @{&quot;###########&quot;,
+                                &quot;o  ##w.#..#&quot;,
+                                &quot;# w##..D..#&quot;,
+                                &quot;#####..#.w#&quot;,
+                                &quot;    #######&quot;@})
+map2 .. map1 == wo:newMap(&quot;.&quot;, @{&quot;###########&quot;,
+                                &quot;#w.#..#o  #&quot;,
+                                &quot;#..D..## w#&quot;,
+                                &quot;#..#.w#####&quot;,
+                                &quot;#######    &quot;@})
+map1 + map2 == wo:newMap(&quot; &quot;, @{&quot;####   &quot;,
+                               &quot;o  #   &quot;,
+                               &quot;# w#   &quot;,
+                               &quot;####   &quot;,
+                               &quot;#######&quot;,
+                               &quot;#w.#..#&quot;,
+                               &quot;#..D..#&quot;,
+                               &quot;#..#.w#&quot;,
+                               &quot;#######&quot;@})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+It's also possible to paste a map into another map:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+map1:paste(map2, pos)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+will paste @samp{map2} into @samp{map1} at position @samp{pos} (relative to
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{map1}: @code{@{0,0@}} is the upper left edge). If neccessary, @samp{map1}
+will be extended such that the whole of @samp{map2} fits into it. You can use
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{map1.sub} to reduce its size again (see below) as well as to define
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{map2} as a section of another map. During the pasting, any occurence of
+the default key of @samp{map2} will be ignored, i.e. not drawn onto
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{map1}. You can change the default key with @samp{map2.defaultkey = ...}
+prior to the paste command to circumvent this, or use
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{map2.replace(tile)} to replace more tile keys by the default key, such
+that they are not drawn as well. You can use an object group for @samp{pos}, in
+this case several copies of @samp{map2} will be pasted into @samp{map1}. There
+is no guarantee about the sequence in which the maps will be pasted into
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{map1}.
+
+However, there's a fourth possibility: Two maps may represent two different
+parts of tile keys. Let's give an example to fuse two tile key layers:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+first_char = wo:newMap(&quot;.&quot;, @{&quot;#######&quot;,
+                             &quot;#w.#..#&quot;,
+                             &quot;#..D..#&quot;,
+                             &quot;#..#.w#&quot;,
+                             &quot;#######&quot;@})
+last_char  = wo:newMap(&quot;.&quot;, @{&quot;C     C&quot;,
+                             &quot; 11 22 &quot;,
+                             &quot; 11322 &quot;,
+                             &quot; 11 22 &quot;,
+                             &quot;C     C&quot;@})
+first_char * last_char = wo:newMap(&quot; .&quot;, @{&quot;#C# # # # # #C&quot;,
+                                          &quot;# w1.1# .2.2# &quot;,
+                                          &quot;# .1.1D3.2.2# &quot;,
+                                          &quot;# .1.1# .2w2# &quot;,
+                                          &quot;#C# # # # # #C&quot;@})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+The default key of the fused map is the concatenation of the two original
+default keys. You can use a string instead of any of the two maps, in this case
+the whole tile key layer will consist of this string everywhere:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+first_char = wo:newMap(&quot;.&quot;, @{&quot;#######&quot;,
+                             &quot;#w.#..#&quot;,
+                             &quot;#..D..#&quot;,
+                             &quot;#..#.w#&quot;,
+                             &quot;#######&quot;@})
+first_char * &quot;u&quot; = wo:newMap(&quot; u&quot;, @{&quot;#u#u#u#u#u#u#u&quot;,
+                                    &quot;#uwu.u#u.u.u#u&quot;,
+                                    &quot;#u.u.uDu.u.u#u&quot;,
+                                    &quot;#u.u.u#u.uwu#u&quot;,
+                                    &quot;#u#u#u#u#u#u#u&quot;@})
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+Fusing maps can be a mighty technique in combination with the
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{res.composer}- and @ref{res.autotile}-resolvers.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Other Map Tasks -------------------- 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Other Map Tasks
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Other Map Tasks
+
+You can access the default key of a map by @samp{mymap.defaultkey}, and change
+it just as easily:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mymap.defaultkey = &quot;.3&quot;
+mymap:set_default_key(&quot;.3&quot;)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+The new default key should have the same length as the old one. However, it is
+possible to choose a new key length as long as it fits to the map.
+
+You can replace any occurence of a tile key @samp{tile1} by @samp{tile2} simply
+by
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mymap:replace(tile1, tile2)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+You can omit @samp{tile2}, then any occurence of @samp{tile1} will be replaced
+by the default key.
+
+Width and height of a map can be accessed via @samp{mymap.width} and
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{mymap.height}. However, these values can be changed only through the
+following commands @samp{mymap:extend} and @samp{mymap:sub}.
+
+It's possible to extend a map to a given position, as long as both
+coordinates are non-negative:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mymap:extend(@{19, 12@})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+will extend @samp{mymap} up to position @samp{@{19,12@}}. Missing entries will
+be filled with the default key. If the map already covers this position, no
+change will be done.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{lib.map.sub} allows you to copy a rectangular area of a map and create a
+&quot;submap&quot; this way. @samp{lib.map.sub} uses the same syntax as
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{wo:drawRect}, i.e. either
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+submap = mymap:sub(pos1, pos2)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+with @samp{pos1} being the top left-hand corner and @samp{pos2} the bottom
+right-hand corner, or alternatively
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+submap = mymap:sub(pos1, width, height)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+to define the rectangle by its top left-hand corner and the side lengths of its
+area. If the bottom right-hand corner overlaps the area of @samp{mymap}, the
+resulting @samp{submap} will still be just the rectangular section of
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{mymap}, i.e. width and height can be less than the arguments specified.
+Use @samp{submap:extend(width, height)} to ensure the full width and height.
+The default key of the submap of course is the default key of the original map.
+
+If you want to check whether a position @samp{pos} lies inside a map, you can
+use @samp{mymap:covers(pos)}, which returns a boolean value. Note that a map
+always starts in @samp{@{0,0@}}.
+
+Finally, you can use @samp{mymap:print()} to print @samp{mymap} to standard
+output. Similar to @ref{lib.lua.print_table}, this is useful for debugging a
+level by taking a look at its maps, but should not appear in the final level.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{mymap:print()} allows several optional arguments:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+mymap:print(withXYCounts, left_separator, right_separator)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+If @samp{withXYCounts} is @samp{true}, the map is printed with coordinates on
+the top and on the left. @samp{left_separator} and @samp{right_separator} can
+be strings to be put between the left coordinate axis and the map, and behind
+the map (to analyse space characters).
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> libsoko
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at section</A> libsoko
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at menu</A>
+* lib.soko.create::
+* lib.soko.recreate::
+* lib.soko.draw::
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> menu
+
 @c ===================  Advanced Features  =======================
 
 @node Advanced Features
@@ -9184,8 +10141,10 @@
 @table @asis
 @item @b{Syntax:}
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at b</A>{wo:drawMap}(@i{resolver}, @i{anchor}, @i{ignore}, @i{map})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{wo:drawMap}(@i{resolver}, @i{anchor}, @i{ignore}, @i{map}, [@i{readdir}])
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{wo:drawMap}(@i{resolver}, @i{anchor}, @i{libmap-map}, [@i{readdir}])
+
 @table @asis
 @item @i{subresolver}
 Resolver to which unresolved requests should be forwarded. May be @samp{ti}
@@ -9197,12 +10156,20 @@
 if it not used within the map.
 @item @i{map}
 A table of strings. Each string describes a row of tiles by its tile keys.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{libmap-map}
+If the map used is created via @ref{libmap}, the @samp{ignore}-string can
+be omitted. The map's default key will then be ignored instead.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{readdir}
+An optional argument to modify the direction of the map relative to the world.
+This argument can be any of the constants described in @ref{Rotating and
+Mirroring Maps}.
 @end table
 
 @item @b{Syntax Samples:}
 @example
 wo:drawMap(ti, po(5, 7), &quot;-&quot;, @{&quot;abcabc&quot;@})
 wo:drawMap(ti, anchor_object, &quot;--&quot;, @{&quot;--##--##&quot;,&quot;##--##&quot;@})
+wo:drawMap(ti, {12, 5}, &quot; &quot;, @{&quot;122  221&quot;@}, MAP_ROT_CW)
 @end example
 
 @item @b{Details:}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000714.html">[Enigma-game-svn] r1284 - in trunk/data/levels: enigma_iii	enigma_tutorial enigma_vi enigma_vii enigma_viii lib
</A></li>
	<LI>Next message: <A HREF="000716.html">[Enigma-game-svn] r1286 - in trunk: data data/levels/lib src	src/stones
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#715">[ date ]</a>
              <a href="thread.html#715">[ thread ]</a>
              <a href="subject.html#715">[ subject ]</a>
              <a href="author.html#715">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
