<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1397 - in trunk/src: . items
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2008-December/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1397%20-%20in%20trunk/src%3A%20.%20items&In-Reply-To=%3C200812152351.mBFNpTis011365%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000825.html">
   <LINK REL="Next"  HREF="000827.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1397 - in trunk/src: . items</H1>
    <B>ral at BerliOS</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1397%20-%20in%20trunk/src%3A%20.%20items&In-Reply-To=%3C200812152351.mBFNpTis011365%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1397 - in trunk/src: . items">ral at mail.berlios.de
       </A><BR>
    <I>Tue Dec 16 00:51:29 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000825.html">[Enigma-game-svn] r1396 - in trunk: data data/schemas src src/stones
</A></li>
        <LI>Next message: <A HREF="000827.html">[Enigma-game-svn] r1398 - homepage/input
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#826">[ date ]</a>
              <a href="thread.html#826">[ thread ]</a>
              <a href="subject.html#826">[ subject ]</a>
              <a href="author.html#826">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ral
Date: 2008-12-16 00:51:27 +0100 (Tue, 16 Dec 2008)
New Revision: 1397

Added:
   trunk/src/items/Coin.cc
   trunk/src/items/Coin.hh
   trunk/src/items/ExtraLife.cc
   trunk/src/items/ExtraLife.hh
   trunk/src/items/Hammer.cc
   trunk/src/items/Hammer.hh
   trunk/src/items/SimpleItems.cc
   trunk/src/items/SimpleItems.hh
   trunk/src/items/Sword.cc
   trunk/src/items/Sword.hh
   trunk/src/items/Umbrella.cc
   trunk/src/items/Umbrella.hh
Modified:
   trunk/src/Makefile.am
   trunk/src/items.cc
Log:
Trunk 1.1:
- code cleanup of reengineered item classes:
  - extraction of classes ExtraLife, Hammer, Sword, Umbrella, Coin
  - files SimpeItems with Brush, DeathItem, Floppy, Key, Wrench


Modified: trunk/src/Makefile.am
===================================================================
--- trunk/src/Makefile.am	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/Makefile.am	2008-12-15 23:51:27 UTC (rev 1397)
@@ -194,8 +194,14 @@
 	items/BrakeItem.hh	\
 	items/BlockerItem.cc	\
 	items/BlockerItem.hh	\
+	items/Coin.cc		\
+	items/Coin.hh		\
+	items/ExtraLife.cc	\
+	items/ExtraLife.hh	\
 	items/GlassesItem.cc	\
 	items/GlassesItem.hh	\
+	items/Hammer.cc		\
+	items/Hammer.hh		\
 	items/Magnet.cc		\
 	items/Magnet.hh		\
 	items/Meditation.cc	\
@@ -210,10 +216,16 @@
 	items/Sensor.hh		\
 	items/ShogunDot.cc	\
 	items/ShogunDot.hh	\
+	items/SimpleItems.cc	\
+	items/SimpleItems.hh	\
 	items/StripItem.cc	\
 	items/StripItem.hh	\
+	items/Sword.cc		\
+	items/Sword.hh		\
 	items/Trigger.cc	\
 	items/Trigger.hh	\
+	items/Umbrella.cc	\
+	items/Umbrella.hh	\
 	items/Vortex.cc		\
 	items/Vortex.hh		\
 	items/WormHole.cc	\

Added: trunk/src/items/Coin.cc
===================================================================
--- trunk/src/items/Coin.cc	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/Coin.cc	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,75 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include &quot;items/Coin.hh&quot;
+//#include &quot;errors.hh&quot;
+//#include &quot;main.hh&quot;
+//#include &quot;player.hh&quot;
+#include &quot;world.hh&quot;
+
+namespace enigma {
+
+    Coin::Coin(int type) {
+        state = type;
+        setAttr(&quot;coin_value&quot;, state == 0 ? 3.0 : (state == 1 ? 6.0 : 12.0));
+    }
+    
+    std::string Coin::getClass() const {
+        return &quot;it_coin&quot;;
+    }
+    
+    void Coin::setState(int extState) {
+        // ignore any state access
+    }
+
+    void Coin::processLight(Direction d) {
+        sound_event(&quot;itemtransform&quot;);
+        switch (state) {
+            case 0 : 
+                transform(&quot;it_umbrella_new&quot;); break;
+            case 1 :
+                transform(&quot;it_hammer_new&quot;); break;
+            case 2 :
+                transform(&quot;it_extralife_new&quot;); break;
+        }
+    }
+
+    void Coin::on_stonehit(Stone *) {
+        if (state &lt;= 1) {
+            state += 1;
+            setAttr(&quot;coin_value&quot;, (state == 1 ? 6.0 : 12.0));  // API 1 compatibility
+            init_model();
+        }
+
+    }
+    
+    ItemTraits Coin::traits[3] = {
+        {&quot;it_coin_s&quot;,  it_coin1,  itf_none, 0.0},
+        {&quot;it_coin_m&quot;,  it_coin2,  itf_none, 0.0},
+        {&quot;it_coin_l&quot;,  it_coin4,  itf_none, 0.0},
+    };
+
+    BOOT_REGISTER_START
+        BootRegister(new Coin(0), &quot;it_coin_s&quot;);
+        BootRegister(new Coin(1), &quot;it_coin_m&quot;);
+        BootRegister(new Coin(2), &quot;it_coin_l&quot;);
+    BOOT_REGISTER_END
+
+} // namespace enigma


Property changes on: trunk/src/items/Coin.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/Coin.hh
===================================================================
--- trunk/src/items/Coin.hh	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/Coin.hh	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,53 @@
+/*
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef COINITEM_HH
+#define COINITEM_HH
+
+#include &quot;items.hh&quot;
+
+#include &quot;enigma.hh&quot;
+
+namespace enigma {
+    /**
+     */
+// TODO id renaming when names are stable
+
+    class Coin : public Item {
+        CLONEOBJ(Coin);
+        DECL_ITEMTRAITS_ARRAY(3, state);
+
+    public:
+        Coin(int type);
+        
+        // Object interface
+        virtual std::string getClass() const;
+
+        // StateObject interface
+        virtual void setState(int extState);
+
+        // GridObject interface
+        virtual void processLight(Direction d);
+        
+        // Item interface
+        virtual void on_stonehit(Stone *st);
+    };
+   
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/items/Coin.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/ExtraLife.cc
===================================================================
--- trunk/src/items/ExtraLife.cc	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/ExtraLife.cc	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,83 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include &quot;items/ExtraLife.hh&quot;
+//#include &quot;errors.hh&quot;
+//#include &quot;main.hh&quot;
+//#include &quot;server.hh&quot;
+#include &quot;player.hh&quot;
+#include &quot;world.hh&quot;
+
+namespace enigma {
+
+    ExtraLife::ExtraLife(bool isNew) : Item() {
+        if (isNew) {
+            objFlags |= ALL_DIRECTIONS;
+        }
+    }
+    
+    std::string ExtraLife::get_inventory_model() {
+        if (player::CurrentPlayer()==0)
+            return &quot;inv-blackball&quot;;
+        else
+            return &quot;inv-whiteball&quot;;
+    }
+
+    void ExtraLife::on_creation(GridPos p) {
+        if ((objFlags &amp; ALL_DIRECTIONS) == ALL_DIRECTIONS) {
+            // a new transformed extralife
+            GameTimer.set_alarm(this, 0.2, false);
+        } else {
+            updateCurrentLightDirs();
+            activatePhoto();
+        }
+        Item::on_creation(p);
+    }
+    
+    void ExtraLife::on_removal(GridPos p) {
+        GameTimer.remove_alarm(this);
+        objFlags &amp;= ~ALL_DIRECTIONS;
+        Item::on_removal(p);
+    }
+    
+    void ExtraLife::lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs) {
+        if (added_dirs(oldDirs, newDirs) != 0) {
+            sound_event (&quot;itemtransform&quot;);
+            replace(&quot;it_glasses&quot;);
+        }
+    }
+    
+    void  ExtraLife::setup_successor(Item *newitem) {
+        newitem-&gt;setState(server::ExtralifeGlasses);
+    }
+    
+    void ExtraLife::alarm() {
+            DirectionBits db = updateCurrentLightDirs();
+            activatePhoto();        
+    }
+
+    DEF_ITEMTRAITS(ExtraLife, &quot;it_extralife&quot;, it_extralife);
+
+    BOOT_REGISTER_START
+        BootRegister(new ExtraLife(false), &quot;it_extralife&quot;);
+        BootRegister(new ExtraLife(true), &quot;it_extralife_new&quot;);
+    BOOT_REGISTER_END
+
+} // namespace enigma


Property changes on: trunk/src/items/ExtraLife.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/ExtraLife.hh
===================================================================
--- trunk/src/items/ExtraLife.hh	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/ExtraLife.hh	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,51 @@
+/*
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef EXTRALIFEITEM_HH
+#define EXTRALIFEITEM_HH
+
+#include &quot;items.hh&quot;
+
+#include &quot;enigma.hh&quot;
+
+namespace enigma {
+    /**
+     */
+    class ExtraLife : public Item, public TimeHandler {
+        CLONEOBJ(ExtraLife);
+        DECL_ITEMTRAITS;
+        
+    public:
+        ExtraLife(bool isNew);
+
+        // GridObject interface
+        virtual void on_creation(GridPos p);
+        virtual void on_removal(GridPos p);
+        virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
+        
+        // Item interface
+        virtual string get_inventory_model();
+        virtual void setup_successor(Item *newitem);
+
+        // TimeHandler interface
+        virtual void alarm();
+    };
+    
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/items/ExtraLife.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/Hammer.cc
===================================================================
--- trunk/src/items/Hammer.cc	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/Hammer.cc	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,71 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include &quot;items/Hammer.hh&quot;
+//#include &quot;errors.hh&quot;
+//#include &quot;main.hh&quot;
+#include &quot;world.hh&quot;
+
+namespace enigma {
+
+    Hammer::Hammer(bool isNew) : Item() {
+        if (isNew) {
+            objFlags |= ALL_DIRECTIONS;
+        }
+    }
+    
+    void Hammer::on_creation(GridPos p) {
+        if ((objFlags &amp; ALL_DIRECTIONS) == ALL_DIRECTIONS) {
+            // a new transformed hammer
+            GameTimer.set_alarm(this, 0.2, false);
+        } else {
+            updateCurrentLightDirs();
+            activatePhoto();
+        }
+        Item::on_creation(p);
+    }
+    
+    void Hammer::on_removal(GridPos p) {
+        GameTimer.remove_alarm(this);
+        objFlags &amp;= ~ALL_DIRECTIONS;
+        Item::on_removal(p);
+    }
+    
+    void Hammer::lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs) {
+        if (added_dirs(oldDirs, newDirs) != 0 &amp;&amp; server::GameCompatibility != enigma::GAMET_PEROXYD) {
+            sound_event (&quot;itemtransform&quot;);
+            transform(&quot;it_sword_new&quot;);
+        }
+    }
+    
+    void Hammer::alarm() {
+            DirectionBits db = updateCurrentLightDirs();
+            activatePhoto();        
+    }
+    
+    DEF_ITEMTRAITS(Hammer, &quot;it_hammer&quot;, it_hammer);
+
+
+    BOOT_REGISTER_START
+        BootRegister(new Hammer(false), &quot;it_hammer&quot;);
+        BootRegister(new Hammer(true), &quot;it_hammer_new&quot;);
+    BOOT_REGISTER_END
+
+} // namespace enigma


Property changes on: trunk/src/items/Hammer.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/Hammer.hh
===================================================================
--- trunk/src/items/Hammer.hh	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/Hammer.hh	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,47 @@
+/*
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef HAMMERITEM_HH
+#define HAMMERITEM_HH
+
+#include &quot;items.hh&quot;
+
+#include &quot;enigma.hh&quot;
+
+namespace enigma {
+    /**
+     */
+    class Hammer : public Item, public TimeHandler {
+        CLONEOBJ(Hammer);
+        DECL_ITEMTRAITS;
+
+    public:
+        Hammer(bool isNew);
+
+        // GridObject interface
+        virtual void on_creation(GridPos p);
+        virtual void on_removal(GridPos p);
+        virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
+
+        // TimeHandler interface
+        virtual void alarm();
+    };
+   
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/items/Hammer.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/SimpleItems.cc
===================================================================
--- trunk/src/items/SimpleItems.cc	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/SimpleItems.cc	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,76 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include &quot;items/SimpleItems.hh&quot;
+//#include &quot;errors.hh&quot;
+//#include &quot;main.hh&quot;
+//#include &quot;player.hh&quot;
+#include &quot;world.hh&quot;
+
+namespace enigma {
+
+/* -------------------- Brush -------------------- */
+   
+    Brush::Brush() {
+    }
+    
+    ItemAction Brush::activate(Actor *a, GridPos p) {
+        if (Item *it = GetItem(p))
+            SendMessage (it, &quot;_brush&quot;);
+        return ITEM_DROP;
+    }
+    
+    DEF_ITEMTRAITSF(Brush, &quot;it_brush&quot;, it_brush, itf_inflammable);
+
+/* -------------------- Death Item  -------------------- */
+    
+    DeathItem::DeathItem() {
+    }
+    
+    void DeathItem::animcb() { 
+        set_model(&quot;it_death&quot;); 
+        state = 0;
+     }
+
+    bool DeathItem::actor_hit(Actor *a) {
+        ActorInfo &amp;ai = * a-&gt;get_actorinfo();
+        if (!ai.grabbed) {
+            SendMessage(a, &quot;shatter&quot;);
+            if (state == 0) {
+                state = 1;
+                set_anim(&quot;it_death_anim&quot;);
+            }
+        }
+        return false;
+    }
+    
+    DEF_ITEMTRAITSF(DeathItem, &quot;it_death&quot;, it_death, itf_static | itf_indestructible);
+
+
+    BOOT_REGISTER_START
+        BootRegister(new Brush(), &quot;it_brush&quot;);
+        BootRegister(new DeathItem(), &quot;it_death&quot;);
+        BootRegister(new Floppy(), &quot;it_floppy&quot;);
+        BootRegister(new MagicWand(), &quot;it_magicwand&quot;);
+        BootRegister(new Key(), &quot;it_key&quot;);
+        BootRegister(new Wrench(), &quot;it_wrench&quot;);
+    BOOT_REGISTER_END
+
+} // namespace enigma


Property changes on: trunk/src/items/SimpleItems.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/SimpleItems.hh
===================================================================
--- trunk/src/items/SimpleItems.hh	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/SimpleItems.hh	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,82 @@
+/*
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef SIMPLEITEMS_HH
+#define SIMPLEITEMS_HH
+
+#include &quot;items.hh&quot;
+
+#include &quot;enigma.hh&quot;
+
+namespace enigma {
+    /**
+     * Brush Can &quot;paint&quot; some stones and remove ash
+     */
+    class Brush : public Item {
+        CLONEOBJ(Brush);
+        DECL_ITEMTRAITS;
+
+    public:
+        Brush();
+        
+        // Item interface
+        virtual ItemAction activate(Actor* a, GridPos p);
+    };
+    
+
+    /**
+     * DeathItem
+     */
+    class DeathItem : public Item {
+        CLONEOBJ(DeathItem);
+        DECL_ITEMTRAITS;
+        
+    public:
+        DeathItem();
+        
+        // ModelCallback interface
+        virtual void animcb();
+
+        // Item interface
+        virtual bool actor_hit(Actor *a);
+        
+    };
+
+    /**
+     * Floppy
+     */
+    DEF_ITEM(Floppy, &quot;it_floppy&quot;, it_floppy);
+
+    /**
+     * MagicWand
+     */
+    DEF_ITEM(MagicWand, &quot;it_magicwand&quot;, it_magicwand);
+
+    /**
+     * Key
+     */
+    DEF_ITEM(Key, &quot;it_key&quot;, it_key);
+
+    /**
+     * Wrench
+     */
+    DEF_ITEM(Wrench, &quot;it_wrench&quot;, it_wrench);
+
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/items/SimpleItems.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/Sword.cc
===================================================================
--- trunk/src/items/Sword.cc	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/Sword.cc	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,72 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include &quot;items/Sword.hh&quot;
+//#include &quot;errors.hh&quot;
+//#include &quot;main.hh&quot;
+#include &quot;world.hh&quot;
+
+namespace enigma {
+
+    Sword::Sword(bool isNew) : Item() {
+        if (isNew) {
+            objFlags |= ALL_DIRECTIONS;
+        }
+    }
+
+    void Sword::on_creation(GridPos p) {
+        if ((objFlags &amp; ALL_DIRECTIONS) == ALL_DIRECTIONS) {
+            // a new transformed hammer
+            GameTimer.set_alarm(this, 0.2, false);
+        } else {
+            updateCurrentLightDirs();
+            activatePhoto();
+        }
+        Item::on_creation(p);
+    }
+    
+    void Sword::on_removal(GridPos p) {
+        GameTimer.remove_alarm(this);
+        objFlags &amp;= ~ALL_DIRECTIONS;
+        Item::on_removal(p);
+    }
+
+    
+    void Sword::lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs) {
+        if (added_dirs(oldDirs, newDirs) != 0) {
+            sound_event (&quot;itemtransform&quot;);
+            transform(&quot;it_hammer_new&quot;);
+        }
+    }
+    
+    void Sword::alarm() {
+            updateCurrentLightDirs();
+            activatePhoto();        
+    }
+    
+    DEF_ITEMTRAITS(Sword, &quot;it_sword&quot;, it_sword);
+
+
+    BOOT_REGISTER_START
+        BootRegister(new Sword(false), &quot;it_sword&quot;);
+        BootRegister(new Sword(true), &quot;it_sword_new&quot;);
+    BOOT_REGISTER_END
+
+} // namespace enigma


Property changes on: trunk/src/items/Sword.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/Sword.hh
===================================================================
--- trunk/src/items/Sword.hh	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/Sword.hh	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,47 @@
+/*
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef SWORDITEM_HH
+#define SWORDITEM_HH
+
+#include &quot;items.hh&quot;
+
+#include &quot;enigma.hh&quot;
+
+namespace enigma {
+    /**
+     */
+    class Sword : public Item, public TimeHandler {
+        CLONEOBJ(Sword);
+        DECL_ITEMTRAITS;
+
+    public:
+        Sword(bool isNew);
+
+        // GridObject interface
+        virtual void on_creation(GridPos p);
+        virtual void on_removal(GridPos p);
+        virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
+
+        // TimeHandler interface
+        virtual void alarm();
+    };
+   
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/items/Sword.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/Umbrella.cc
===================================================================
--- trunk/src/items/Umbrella.cc	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/Umbrella.cc	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,77 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include &quot;items/Umbrella.hh&quot;
+//#include &quot;errors.hh&quot;
+//#include &quot;main.hh&quot;
+//#include &quot;server.hh&quot;
+//#include &quot;player.hh&quot;
+#include &quot;world.hh&quot;
+
+namespace enigma {
+
+    Umbrella::Umbrella(bool isNew) : Item() {
+        if (isNew) {
+            objFlags |= ALL_DIRECTIONS;
+        }
+    }
+    
+    void Umbrella::on_creation(GridPos p) {
+        if ((objFlags &amp; ALL_DIRECTIONS) == ALL_DIRECTIONS) {
+            // a new transformed umbrella
+            GameTimer.set_alarm(this, 0.2, false);
+        } else {
+            updateCurrentLightDirs();
+            activatePhoto();
+        }
+        Item::on_creation(p);
+    }
+    
+    void Umbrella::on_removal(GridPos p) {
+        GameTimer.remove_alarm(this);
+        objFlags &amp;= ~ALL_DIRECTIONS;
+        Item::on_removal(p);
+    }
+    
+    void Umbrella::lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs) {
+        if (added_dirs(oldDirs, newDirs) != 0 &amp;&amp; server::GameCompatibility != enigma::GAMET_PEROXYD) {
+            sound_event (&quot;itemtransform&quot;);
+            replace(&quot;it-explosion1&quot;);
+        }
+    }
+    
+    ItemAction Umbrella::activate(Actor *a, GridPos) {
+        SendMessage(a, &quot;shield&quot;);
+        return ITEM_KILL;
+    }
+    
+    void Umbrella::alarm() {
+            DirectionBits db = updateCurrentLightDirs();
+            activatePhoto();        
+    }
+
+    DEF_ITEMTRAITS (Umbrella, &quot;it_umbrella&quot;, it_umbrella);
+
+    BOOT_REGISTER_START
+        BootRegister(new Umbrella(false), &quot;it_umbrella&quot;);
+        BootRegister(new Umbrella(true), &quot;it_umbrella_new&quot;);
+    BOOT_REGISTER_END
+
+} // namespace enigma


Property changes on: trunk/src/items/Umbrella.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/items/Umbrella.hh
===================================================================
--- trunk/src/items/Umbrella.hh	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items/Umbrella.hh	2008-12-15 23:51:27 UTC (rev 1397)
@@ -0,0 +1,50 @@
+/*
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef UMBRELLAITEM_HH
+#define UMBRELLAITEM_HH
+
+#include &quot;items.hh&quot;
+
+#include &quot;enigma.hh&quot;
+
+namespace enigma {
+    /**
+     */
+    class Umbrella : public Item, public TimeHandler {
+        CLONEOBJ(Umbrella);
+        DECL_ITEMTRAITS;
+
+    public:
+        Umbrella(bool isNew);
+
+        // GridObject interface
+        virtual void on_creation(GridPos p);
+        virtual void on_removal(GridPos p);
+        virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
+
+        // Item interface
+        virtual ItemAction activate(Actor* a, GridPos p);
+        
+        // TimeHandler interface
+        virtual void alarm();
+    };
+   
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/items/Umbrella.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/src/items.cc
===================================================================
--- trunk/src/items.cc	2008-12-15 23:46:13 UTC (rev 1396)
+++ trunk/src/items.cc	2008-12-15 23:51:27 UTC (rev 1397)
@@ -159,11 +159,7 @@
 
 namespace
 {
-    DEF_ITEM(MagicWand, &quot;it_magicwand&quot;, it_magicwand);
-    DEF_ITEM(Floppy,    &quot;it_floppy&quot;, it_floppy);
-    DEF_ITEM(Key,       &quot;it_key&quot;, it_key);
     DEF_ITEM(Odometer,  &quot;it-odometer&quot;, it_odometer);
-    DEF_ITEM(Wrench,    &quot;it_wrench&quot;, it_wrench);
     DEF_ITEMF(Coffee,   &quot;it-coffee&quot;, it_coffee, itf_inflammable);
 }
 
@@ -284,251 +280,6 @@
     };
     DEF_ITEMTRAITS(Banana, &quot;it-banana&quot;, it_banana);
 
-/* -------------------- Sword -------------------- */
-
-    class Sword : public Item, public TimeHandler {
-        CLONEOBJ(Sword);
-        DECL_ITEMTRAITS;
-
-    public:
-        Sword(bool isNew);
-
-        // GridObject interface
-        virtual void on_creation(GridPos p);
-        virtual void on_removal(GridPos p);
-        virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
-
-        // TimeHandler interface
-        virtual void alarm();
-    };
-
-    Sword::Sword(bool isNew) : Item() {
-        if (isNew) {
-            objFlags |= ALL_DIRECTIONS;
-        }
-    }
-
-    void Sword::on_creation(GridPos p) {
-        if ((objFlags &amp; ALL_DIRECTIONS) == ALL_DIRECTIONS) {
-            // a new transformed hammer
-            GameTimer.set_alarm(this, 0.2, false);
-        } else {
-            updateCurrentLightDirs();
-            activatePhoto();
-        }
-        Item::on_creation(p);
-    }
-    
-    void Sword::on_removal(GridPos p) {
-        GameTimer.remove_alarm(this);
-        objFlags &amp;= ~ALL_DIRECTIONS;
-        Item::on_removal(p);
-    }
-
-    
-    void Sword::lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs) {
-        if (added_dirs(oldDirs, newDirs) != 0) {
-            sound_event (&quot;itemtransform&quot;);
-            transform(&quot;it_hammer_new&quot;);
-        }
-    }
-    
-    void Sword::alarm() {
-            updateCurrentLightDirs();
-            activatePhoto();        
-    }
-    
-    DEF_ITEMTRAITS(Sword, &quot;it_sword&quot;, it_sword);
-
-/* -------------------- Hammer -------------------- */
-
-    class Hammer : public Item, public TimeHandler {
-        CLONEOBJ(Hammer);
-        DECL_ITEMTRAITS;
-
-    public:
-        Hammer(bool isNew);
-
-        // GridObject interface
-        virtual void on_creation(GridPos p);
-        virtual void on_removal(GridPos p);
-        virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
-
-        // TimeHandler interface
-        virtual void alarm();
-    };
-    
-    Hammer::Hammer(bool isNew) : Item() {
-        if (isNew) {
-            objFlags |= ALL_DIRECTIONS;
-        }
-    }
-    
-    void Hammer::on_creation(GridPos p) {
-        if ((objFlags &amp; ALL_DIRECTIONS) == ALL_DIRECTIONS) {
-            // a new transformed hammer
-            GameTimer.set_alarm(this, 0.2, false);
-        } else {
-            updateCurrentLightDirs();
-            activatePhoto();
-        }
-        Item::on_creation(p);
-    }
-    
-    void Hammer::on_removal(GridPos p) {
-        GameTimer.remove_alarm(this);
-        objFlags &amp;= ~ALL_DIRECTIONS;
-        Item::on_removal(p);
-    }
-    
-    void Hammer::lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs) {
-        if (added_dirs(oldDirs, newDirs) != 0 &amp;&amp; server::GameCompatibility != enigma::GAMET_PEROXYD) {
-            sound_event (&quot;itemtransform&quot;);
-            transform(&quot;it_sword_new&quot;);
-        }
-    }
-    
-    void Hammer::alarm() {
-            DirectionBits db = updateCurrentLightDirs();
-            activatePhoto();        
-    }
-    
-    DEF_ITEMTRAITS(Hammer, &quot;it_hammer&quot;, it_hammer);
-
-
-/* -------------------- ExtraLife -------------------- */
-
-    class ExtraLife : public Item, public TimeHandler {
-        CLONEOBJ(ExtraLife);
-        DECL_ITEMTRAITS;
-        
-    public:
-        ExtraLife(bool isNew);
-
-        // GridObject interface
-        virtual void on_creation(GridPos p);
-        virtual void on_removal(GridPos p);
-        virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
-        
-        // Item interface
-        virtual string get_inventory_model();
-        virtual void setup_successor(Item *newitem);
-
-        // TimeHandler interface
-        virtual void alarm();
-    };
-
-    ExtraLife::ExtraLife(bool isNew) : Item() {
-        if (isNew) {
-            objFlags |= ALL_DIRECTIONS;
-        }
-    }
-    
-    std::string ExtraLife::get_inventory_model() {
-        if (player::CurrentPlayer()==0)
-            return &quot;inv-blackball&quot;;
-        else
-            return &quot;inv-whiteball&quot;;
-    }
-
-    void ExtraLife::on_creation(GridPos p) {
-        if ((objFlags &amp; ALL_DIRECTIONS) == ALL_DIRECTIONS) {
-            // a new transformed extralife
-            GameTimer.set_alarm(this, 0.2, false);
-        } else {
-            updateCurrentLightDirs();
-            activatePhoto();
-        }
-        Item::on_creation(p);
-    }
-    
-    void ExtraLife::on_removal(GridPos p) {
-        GameTimer.remove_alarm(this);
-        objFlags &amp;= ~ALL_DIRECTIONS;
-        Item::on_removal(p);
-    }
-    
-    void ExtraLife::lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs) {
-        if (added_dirs(oldDirs, newDirs) != 0) {
-            sound_event (&quot;itemtransform&quot;);
-            replace(&quot;it_glasses&quot;);
-        }
-    }
-    
-    void  ExtraLife::setup_successor(Item *newitem) {
-        newitem-&gt;setState(server::ExtralifeGlasses);
-    }
-    
-    void ExtraLife::alarm() {
-            DirectionBits db = updateCurrentLightDirs();
-            activatePhoto();        
-    }
-
-    DEF_ITEMTRAITS(ExtraLife, &quot;it_extralife&quot;, it_extralife);
-
-/* -------------------- Umbrella -------------------- */
-
-    class Umbrella : public Item, public TimeHandler {
-        CLONEOBJ(Umbrella);
-        DECL_ITEMTRAITS;
-
-    public:
-        Umbrella(bool isNew);
-
-        // GridObject interface
-        virtual void on_creation(GridPos p);
-        virtual void on_removal(GridPos p);
-        virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
-
-        // Item interface
-        virtual ItemAction activate(Actor* a, GridPos p);
-        
-        // TimeHandler interface
-        virtual void alarm();
-    };
-
-    Umbrella::Umbrella(bool isNew) : Item() {
-        if (isNew) {
-            objFlags |= ALL_DIRECTIONS;
-        }
-    }
-    
-    void Umbrella::on_creation(GridPos p) {
-        if ((objFlags &amp; ALL_DIRECTIONS) == ALL_DIRECTIONS) {
-            // a new transformed umbrella
-            GameTimer.set_alarm(this, 0.2, false);
-        } else {
-            updateCurrentLightDirs();
-            activatePhoto();
-        }
-        Item::on_creation(p);
-    }
-    
-    void Umbrella::on_removal(GridPos p) {
-        GameTimer.remove_alarm(this);
-        objFlags &amp;= ~ALL_DIRECTIONS;
-        Item::on_removal(p);
-    }
-    
-    void Umbrella::lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs) {
-        if (added_dirs(oldDirs, newDirs) != 0 &amp;&amp; server::GameCompatibility != enigma::GAMET_PEROXYD) {
-            sound_event (&quot;itemtransform&quot;);
-            replace(&quot;it-explosion1&quot;);
-        }
-    }
-    
-    ItemAction Umbrella::activate(Actor *a, GridPos) {
-        SendMessage(a, &quot;shield&quot;);
-        return ITEM_KILL;
-    }
-    
-    void Umbrella::alarm() {
-            DirectionBits db = updateCurrentLightDirs();
-            activatePhoto();        
-    }
-
-    DEF_ITEMTRAITS (Umbrella, &quot;it_umbrella&quot;, it_umbrella);
-
 /* -------------------- Spoon -------------------- */
 namespace
 {
@@ -602,103 +353,6 @@
     DEF_ITEMTRAITSF(BrokenBooze, &quot;it-booze-broken&quot;, it_booze_broken, itf_static | itf_indestructible);
 }
 
-/* -------------------- Brush -------------------- */
-    /* Can &quot;paint&quot; some stones and remove ash. */
-    class Brush : public Item {
-        CLONEOBJ(Brush);
-        DECL_ITEMTRAITS;
-
-    public:
-        Brush();
-        
-        // Item interface
-        virtual ItemAction activate(Actor* a, GridPos p);
-    };
-    
-    Brush::Brush() {
-    }
-    
-    ItemAction Brush::activate(Actor *a, GridPos p) {
-        if (Item *it = GetItem(p))
-            SendMessage (it, &quot;_brush&quot;);
-        return ITEM_DROP;
-    }
-    
-    DEF_ITEMTRAITSF(Brush, &quot;it_brush&quot;, it_brush, itf_inflammable);
-
-
-
-/* -------------------- Coins -------------------- */
-
-// TODO id renaming when names are stable
-
-    class Coin : public Item {
-        CLONEOBJ(Coin);
-        DECL_ITEMTRAITS_ARRAY(3, state);
-
-    public:
-        Coin(int type);
-        static void setup();
-        
-        // Object interface
-        virtual std::string getClass() const;
-
-        // StateObject interface
-        virtual void setState(int extState);
-
-        // GridObject interface
-        virtual void processLight(Direction d);
-        
-        // Item interface
-        virtual void on_stonehit(Stone *st);
-    };
-    
-    void Coin::setup() {
-        RegisterItem (new Coin(0));
-        RegisterItem (new Coin(1));
-        RegisterItem (new Coin(2));
-    }
-
-    Coin::Coin(int type) {
-        state = type;
-        setAttr(&quot;coin_value&quot;, state == 0 ? 3.0 : (state == 1 ? 6.0 : 12.0));
-    }
-    
-    std::string Coin::getClass() const {
-        return &quot;it_coin&quot;;
-    }
-    
-    void Coin::setState(int extState) {
-        // ignore any state access
-    }
-
-    void Coin::processLight(Direction d) {
-        sound_event(&quot;itemtransform&quot;);
-        switch (state) {
-            case 0 : 
-                transform(&quot;it_umbrella_new&quot;); break;
-            case 1 :
-                transform(&quot;it_hammer_new&quot;); break;
-            case 2 :
-                transform(&quot;it_extralife_new&quot;); break;
-        }
-    }
-
-    void Coin::on_stonehit(Stone *) {
-        if (state &lt;= 1) {
-            state += 1;
-            setAttr(&quot;coin_value&quot;, (state == 1 ? 6.0 : 12.0));  // API 1 compatibility
-            init_model();
-        }
-
-    }
-    
-    ItemTraits Coin::traits[3] = {
-        {&quot;it_coin_s&quot;,  it_coin1,  itf_none, 0.0},
-        {&quot;it_coin_m&quot;,  it_coin2,  itf_none, 0.0},
-        {&quot;it_coin_l&quot;,  it_coin4,  itf_none, 0.0},
-    };
-    
 /* -------------------- Springs -------------------- */
 
 /** \page it-spring Spring
@@ -2076,44 +1730,6 @@
     DEF_ITEMTRAITS(Pencil, &quot;it-pencil&quot;, it_pencil);
 }
 
-/* -------------------- Death Item  -------------------- */
-    class DeathItem : public Item {
-        CLONEOBJ(DeathItem);
-        DECL_ITEMTRAITS;
-        
-    public:
-        DeathItem();
-        
-        // ModelCallback interface
-        virtual void animcb();
-
-        // Item interface
-        virtual bool actor_hit(Actor *a);
-        
-    };
-    
-    DeathItem::DeathItem() {
-    }
-    
-    void DeathItem::animcb() { 
-        set_model(&quot;it_death&quot;); 
-        state = 0;
-     }
-
-    bool DeathItem::actor_hit(Actor *a) {
-        ActorInfo &amp;ai = * a-&gt;get_actorinfo();
-        if (!ai.grabbed) {
-            SendMessage(a, &quot;shatter&quot;);
-            if (state == 0) {
-                state = 1;
-                set_anim(&quot;it_death_anim&quot;);
-            }
-        }
-        return false;
-    }
-    
-    DEF_ITEMTRAITSF(DeathItem, &quot;it_death&quot;, it_death, itf_static | itf_indestructible);
-
 /* -------------------- it-surprise -------------------- */
 namespace
 {
@@ -2268,15 +1884,12 @@
     RegisterItem (new BlackBombBurning);
     RegisterItem (new Booze);
     RegisterItem (new BrokenBooze);
-    RegisterItem (new Brush);
     Burnable::setup();
     RegisterItem (new ChangeFloorItem);
     RegisterItem (new Cherry);
     RegisterItem (new Coffee);
-    Coin::setup();
     Crack::setup();
     RegisterItem (new Cross);
-    RegisterItem (new DeathItem);
     RegisterItem (new Debris);
     RegisterItem (new Document);
     RegisterItem (new Drop);
@@ -2288,17 +1901,10 @@
     RegisterItem (new Explosion2);
     RegisterItem (new Explosion3);
     Extinguisher::setup();
-    RegisterItem (new ExtraLife(false));
-    Register (&quot;it_extralife_new&quot;, new ExtraLife(true));
     RegisterItem (new FlagBlack);
     RegisterItem (new FlagWhite);
-    RegisterItem (new Floppy);
-    RegisterItem (new Hammer(false));
-    Register (&quot;it_hammer_new&quot;, new Hammer(true));
     RegisterItem (new Trap);
-    RegisterItem (new Key);
     RegisterItem (new Landmine);
-    RegisterItem (new MagicWand);
     RegisterItem (new Odometer);
     RegisterItem (new OnePKillStone);
     RegisterItem (new OxydBridge);
@@ -2314,14 +1920,9 @@
     RegisterItem (new Springboard);
     RegisterItem (new Squashed);
     RegisterItem (new SurpriseItem);
-    RegisterItem (new Sword(false));
-    Register (&quot;it_sword_new&quot;, new Sword(true));
     RegisterItem (new TwoPKillStone);
-    RegisterItem (new Umbrella(false));
-    Register (&quot;it_umbrella_new&quot;, new Umbrella(true));
     RegisterItem (new Weight);
     RegisterItem (new WhiteBomb);
-    RegisterItem (new Wrench);
     RegisterItem (new YinYang);
 }
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000825.html">[Enigma-game-svn] r1396 - in trunk: data data/schemas src src/stones
</A></li>
	<LI>Next message: <A HREF="000827.html">[Enigma-game-svn] r1398 - homepage/input
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#826">[ date ]</a>
              <a href="thread.html#826">[ thread ]</a>
              <a href="subject.html#826">[ subject ]</a>
              <a href="author.html#826">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
