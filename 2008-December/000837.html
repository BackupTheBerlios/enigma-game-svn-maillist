<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1408 - in trunk: data data/levels/enigma_ii	data/schemas src src/actors src/floors src/items src/stones
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2008-December/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1408%20-%20in%20trunk%3A%20data%20data/levels/enigma_ii%0A%09data/schemas%20src%20src/actors%20src/floors%20src/items%20src/stones&In-Reply-To=%3C200812222238.mBMMc1Ke025326%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000836.html">
   <LINK REL="Next"  HREF="000838.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1408 - in trunk: data data/levels/enigma_ii	data/schemas src src/actors src/floors src/items src/stones</H1>
    <B>ral at BerliOS</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1408%20-%20in%20trunk%3A%20data%20data/levels/enigma_ii%0A%09data/schemas%20src%20src/actors%20src/floors%20src/items%20src/stones&In-Reply-To=%3C200812222238.mBMMc1Ke025326%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1408 - in trunk: data data/levels/enigma_ii	data/schemas src src/actors src/floors src/items src/stones">ral at mail.berlios.de
       </A><BR>
    <I>Mon Dec 22 23:38:01 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000836.html">[Enigma-game-svn] r1407 - team_levelpacks/team_test_new_api
</A></li>
        <LI>Next message: <A HREF="000838.html">[Enigma-game-svn] r1409 - in homepage: images/lotm input/lotm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#837">[ date ]</a>
              <a href="thread.html#837">[ thread ]</a>
              <a href="subject.html#837">[ subject ]</a>
              <a href="author.html#837">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ral
Date: 2008-12-22 23:37:58 +0100 (Mon, 22 Dec 2008)
New Revision: 1408

Modified:
   trunk/data/levels/enigma_ii/ralf16_1.xml
   trunk/data/models-2d.lua
   trunk/data/schemas/objects.xml
   trunk/src/actors.cc
   trunk/src/actors.hh
   trunk/src/actors/Balls.cc
   trunk/src/actors/Balls.hh
   trunk/src/floors/BridgeFloor.cc
   trunk/src/floors/SimpleFloors.cc
   trunk/src/items.cc
   trunk/src/items/GlassesItem.cc
   trunk/src/items/SimpleItems.cc
   trunk/src/items/Umbrella.cc
   trunk/src/items/Vortex.cc
   trunk/src/laser.cc
   trunk/src/player.cc
   trunk/src/server.cc
   trunk/src/stones/BlockerStone.cc
   trunk/src/stones/BoxStone.cc
   trunk/src/stones/DeathStone.cc
   trunk/src/stones/KnightStone.cc
   trunk/src/stones/PuzzleStone.cc
   trunk/src/stones/SimpleStones.cc
   trunk/src/stones/StoneImpulse.cc
   trunk/src/stones/Turnstile.cc
   trunk/src/stones/VolcanoStone.cc
   trunk/src/stones/WindowStone.cc
   trunk/src/stones_simple.cc
Log:
Trunk 1.1: new API reengineering
- fix broken pearl sink animation
- rename ball internal system messages
- add actor attribute &quot;charge&quot; - this allows initial charged actors
- rename BoxStone internal system message &quot;fall&quot;

Modified: trunk/data/levels/enigma_ii/ralf16_1.xml
===================================================================
--- trunk/data/levels/enigma_ii/ralf16_1.xml	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/data/levels/enigma_ii/ralf16_1.xml	2008-12-22 22:37:58 UTC (rev 1408)
@@ -164,7 +164,6 @@
          local bx = enigma.GetNamedObject(&quot;box&quot;..b)
          local x,y = enigma.GetPos(bx)
          set_floor(fl,x,y)
-         --SendMessage(bx,&quot;fall&quot;)
          dropbox[b] = { x=x, y=y }
       end
       dropboxes=5

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/data/models-2d.lua	2008-12-22 22:37:58 UTC (rev 1408)
@@ -150,13 +150,13 @@
     DefAnim(&quot;ac_pearl_white-jump&quot;, PingPong(BuildFrames(frames, 70)))
 
     -- sinking
-    DefAlias (&quot;ac-whiteball-small-sink0&quot;, &quot;ac-whiteball-small-fall1&quot;)
-    DefAlias (&quot;ac-whiteball-small-sink1&quot;, &quot;ac-whiteball-small-fall2&quot;)
-    DefAlias (&quot;ac-whiteball-small-sink2&quot;, &quot;ac-whiteball-small-fall3&quot;)
-    DefAlias (&quot;ac-whiteball-small-sink3&quot;, &quot;ac-whiteball-small-fall4&quot;)
-    DefAlias (&quot;ac-whiteball-small-sink4&quot;, &quot;ac-whiteball-small-fall5&quot;)
-    DefAlias (&quot;ac-whiteball-small-sink5&quot;, &quot;ac-whiteball-small-fall5&quot;)
-    DefAlias (&quot;ac-whiteball-small-sink6&quot;, &quot;ac-whiteball-small-fall5&quot;)
+    DefAlias (&quot;ac_pearl_white-sink0&quot;, &quot;ac-whiteball-small-fall1&quot;)
+    DefAlias (&quot;ac_pearl_white-sink1&quot;, &quot;ac-whiteball-small-fall2&quot;)
+    DefAlias (&quot;ac_pearl_white-sink2&quot;, &quot;ac-whiteball-small-fall3&quot;)
+    DefAlias (&quot;ac_pearl_white-sink3&quot;, &quot;ac-whiteball-small-fall4&quot;)
+    DefAlias (&quot;ac_pearl_white-sink4&quot;, &quot;ac-whiteball-small-fall5&quot;)
+    DefAlias (&quot;ac_pearl_white-sink5&quot;, &quot;ac-whiteball-small-fall5&quot;)
+    DefAlias (&quot;ac_pearl_white-sink6&quot;, &quot;ac-whiteball-small-fall5&quot;)
     DefAlias (&quot;ac_pearl_white-sunk&quot;, &quot;invisible&quot;)
 
     -- Shattering

Modified: trunk/data/schemas/objects.xml
===================================================================
--- trunk/data/schemas/objects.xml	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/data/schemas/objects.xml	2008-12-22 22:37:58 UTC (rev 1408)
@@ -73,7 +73,7 @@
     &lt;attr name=&quot;transparent&quot; type=&quot;bool&quot; default=&quot;false&quot; rw=&quot;rw&quot;/&gt;
     &lt;attr name=&quot;threshold&quot; type=&quot;double&quot; default=&quot;0&quot; rw=&quot;rw&quot;/&gt;
     &lt;attr name=&quot;wires&quot; type=&quot;group&quot; default=&quot;nil&quot; rw=&quot;r&quot;/&gt;
-    &lt;attr name=&quot;$charge&quot; type=&quot;int&quot; default=&quot;0&quot; min=&quot;-1&quot; max=&quot;1&quot; rw=&quot;&quot;/&gt;
+    &lt;attr name=&quot;$chargesign&quot; type=&quot;int&quot; default=&quot;0&quot; min=&quot;-1&quot; max=&quot;1&quot; rw=&quot;&quot;/&gt;
     &lt;attr name=&quot;$firetransform&quot; type=&quot;string&quot; default=&quot;&quot; rw=&quot;&quot;/&gt;
     &lt;attr name=&quot;$heattransform&quot; type=&quot;string&quot; default=&quot;&quot; rw=&quot;&quot;/&gt;
   &lt;/attributes&gt;
@@ -83,7 +83,6 @@
     &lt;msg name=&quot;darken&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;disconnect&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;expl&quot; type=&quot;nil&quot;/&gt;
-    &lt;msg name=&quot;fall&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;fire&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;flip&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;forcefire&quot; type=&quot;nil&quot;/&gt;
@@ -111,27 +110,39 @@
     &lt;msg name=&quot;toggle&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;turn&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;turnback&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_appear&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_bombstone&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_booze&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_brush&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_capture&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_checkflood&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_disappear&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_explosion&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_fall&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_fallvortex&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_freeze&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_glasses&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_hit&quot; type=&quot;object&quot;/&gt;
     &lt;msg name=&quot;_init&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_invisibility&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_jump&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_jumping&quot; type=&quot;bool&quot;/&gt;
+    &lt;msg name=&quot;_laserhit&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_levelfinish&quot; type=&quot;bool&quot;/&gt;
     &lt;msg name=&quot;_model_reanimated&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_passed&quot; type=&quot;nil&quot;/&gt;            &lt;!-- check type--&gt;
     &lt;msg name=&quot;_performaction&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_recheck&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_resurrect&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_revive&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_rise&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_scramble&quot; type=&quot;int&quot;/&gt;
+    &lt;msg name=&quot;_shatter&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_shield&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_shogun&quot; type=&quot;int&quot;/&gt;
     &lt;msg name=&quot;_spitter&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_start&quot; type=&quot;nil&quot;/&gt;
+    &lt;msg name=&quot;_suicide&quot; type=&quot;nil&quot;/&gt;
     &lt;msg name=&quot;_trigger&quot; type=&quot;bool&quot;/&gt;
     &lt;msg name=&quot;_updateglobals&quot; type=&quot;string&quot;/&gt;
   &lt;/messages&gt;
@@ -160,6 +171,21 @@
     &lt;/object&gt;
     &lt;object name=&quot;ac_marble&quot;&gt;
       &lt;attr name=&quot;color&quot; default=&quot;0&quot;/&gt;
+      &lt;msg name=&quot;_appear&quot;/&gt;
+      &lt;msg name=&quot;_booze&quot;/&gt;
+      &lt;msg name=&quot;_disappear&quot;/&gt;
+      &lt;msg name=&quot;_fall&quot;/&gt;
+      &lt;msg name=&quot;_fallvortex&quot;/&gt;
+      &lt;msg name=&quot;_init&quot;/&gt;
+      &lt;msg name=&quot;_invisibility&quot;/&gt;
+      &lt;msg name=&quot;_jump&quot;/&gt;
+      &lt;msg name=&quot;_laserhit&quot;/&gt;
+      &lt;msg name=&quot;_levelfinish&quot;/&gt;
+      &lt;msg name=&quot;_resurrect&quot;/&gt;
+      &lt;msg name=&quot;_rise&quot;/&gt;
+      &lt;msg name=&quot;_shatter&quot;/&gt;
+      &lt;msg name=&quot;_shield&quot;/&gt;
+      &lt;msg name=&quot;_suicide&quot;/&gt;
     &lt;/object&gt;
     &lt;object name=&quot;ac_marble_black&quot;&gt;
       &lt;attr name=&quot;color&quot; value=&quot;0&quot;/&gt;
@@ -169,6 +195,21 @@
     &lt;/object&gt;
     &lt;object name=&quot;ac_pearl&quot;&gt;
       &lt;attr name=&quot;color&quot; default=&quot;1&quot; min=&quot;1&quot;/&gt;
+      &lt;msg name=&quot;_appear&quot;/&gt;
+      &lt;msg name=&quot;_booze&quot;/&gt;
+      &lt;msg name=&quot;_disappear&quot;/&gt;
+      &lt;msg name=&quot;_fall&quot;/&gt;
+      &lt;msg name=&quot;_fallvortex&quot;/&gt;
+      &lt;msg name=&quot;_init&quot;/&gt;
+      &lt;msg name=&quot;_invisibility&quot;/&gt;
+      &lt;msg name=&quot;_jump&quot;/&gt;
+      &lt;msg name=&quot;_laserhit&quot;/&gt;
+      &lt;msg name=&quot;_levelfinish&quot;/&gt;
+      &lt;msg name=&quot;_resurrect&quot;/&gt;
+      &lt;msg name=&quot;_rise&quot;/&gt;
+      &lt;msg name=&quot;_shatter&quot;/&gt;
+      &lt;msg name=&quot;_shield&quot;/&gt;
+      &lt;msg name=&quot;_suicide&quot;/&gt;
     &lt;/object&gt;
     &lt;object name=&quot;ac_pearl_white&quot;&gt;
       &lt;attr name=&quot;color&quot; value=&quot;1&quot;/&gt;
@@ -661,7 +702,7 @@
       &lt;attr name=&quot;flavor&quot; default=&quot;wood&quot; rw=&quot;r&quot;/&gt;
       &lt;msg name=&quot;fire&quot;/&gt;
       &lt;msg name=&quot;heat&quot;/&gt;
-      &lt;msg name=&quot;fall&quot;/&gt;
+      &lt;msg name=&quot;_fall&quot;/&gt;
     &lt;/object&gt;
     &lt;object name=&quot;st_box_hay&quot; flavor=&quot;hay&quot;/&gt;
     &lt;object name=&quot;st_box_rock&quot; flavor=&quot;rock&quot;/&gt;
@@ -724,16 +765,16 @@
     &lt;/object&gt;
     &lt;object name=&quot;st_charge&quot;&gt;
       &lt;attr name=&quot;charge&quot;/&gt;
-      &lt;attr name=&quot;$charge&quot;/&gt;
+      &lt;attr name=&quot;$chargesign&quot;/&gt;
     &lt;/object&gt;
     &lt;object name=&quot;st_charge_zero&quot;&gt;
-      &lt;attr name=&quot;$charge&quot; value=&quot;0&quot;/&gt;
+      &lt;attr name=&quot;$chargesign&quot; value=&quot;0&quot;/&gt;
     &lt;/object&gt;
     &lt;object name=&quot;st_charge_plus&quot;&gt;
-      &lt;attr name=&quot;$charge&quot; value=&quot;1&quot;/&gt;
+      &lt;attr name=&quot;$chargesign&quot; value=&quot;1&quot;/&gt;
     &lt;/object&gt;
     &lt;object name=&quot;st_charge_minus&quot;&gt;
-      &lt;attr name=&quot;$charge&quot; value=&quot;-1&quot;/&gt;
+      &lt;attr name=&quot;$chargesign&quot; value=&quot;-1&quot;/&gt;
     &lt;/object&gt;
     &lt;object name=&quot;st_chess&quot;&gt;
       &lt;attr name=&quot;color&quot; default=&quot;0&quot;/&gt;

Modified: trunk/src/actors/Balls.cc
===================================================================
--- trunk/src/actors/Balls.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/actors/Balls.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -36,54 +36,42 @@
             m_drunk_rest_time (0), m_invisible_rest_time (0) {
         state = NO_STATE;
     }
-    
-//    void BasicBall::setAttr(const string&amp; key, const Value &amp;val) {
-//        if (key == &quot;charge&quot;) {
-//        } else
-//        Stone::setAttr(key, val);
-//    }
-//
-//    Value BasicBall::getAttr(const std::string &amp;key) const {
-//        if (key == &quot;charge&quot;) {
-//        } else
-//            return Stone::getAttr(key);
-//    }
 
-    Value BasicBall::message(const Message &amp;m) {
+    Value BasicBall::message(const Message &amp;m) {   // shatter, suicide, fall, jump, booze, shield are candidates for public usage
         bool handled = false;
         switch (state) {
             case NORMAL:
-                if (m.message == &quot;shatter&quot;) {
+                if (m.message == &quot;_shatter&quot;) {
                     change_state_noshield(SHATTERING);
                     handled = true;
-                } else if (m.message == &quot;suicide&quot;) {
+                } else if (m.message == &quot;_suicide&quot;) {
                     change_state(SHATTERING);
                     handled = true;
-                } else if (m.message == &quot;laserhit&quot;) {
+                } else if (m.message == &quot;_laserhit&quot;) {
                     change_state_noshield(SHATTERING);
                     handled = true;
-                } else if (m.message == &quot;fall&quot;) {
+                } else if (m.message == &quot;_fall&quot;) {
                     change_state_noshield(FALLING);
                     handled = true;
                 } else if (m.message == &quot;_fallvortex&quot;) {
                     change_state(FALLING_VORTEX);
                     handled = true;
-                } else if (m.message == &quot;jump&quot;) {
+                } else if (m.message == &quot;_jump&quot;) {
                     change_state(JUMPING);
                     handled = true;
-                } else if (m.message == &quot;appear&quot;) {
+                } else if (m.message == &quot;_appear&quot;) {
                     change_state(APPEARING);
                     handled = true;
-                } else if (m.message == &quot;disappear&quot;) {
+                } else if (m.message == &quot;_disappear&quot;) {
                     change_state(DISAPPEARING);
                     handled = true;
                 }
                 break;
             case JUMPING:
-                if (m.message == &quot;shatter&quot;) {
+                if (m.message == &quot;_shatter&quot;) {
                     change_state_noshield(SHATTERING);
                     handled = true;
-                } else if (m.message == &quot;disappear&quot;) {
+                } else if (m.message == &quot;_disappear&quot;) {
                     change_state(DISAPPEARING);
                     handled = true;
                 }
@@ -95,21 +83,21 @@
                 }
                 break;
             case DEAD:
-                if (m.message == &quot;resurrect&quot;) {
+                if (m.message == &quot;_resurrect&quot;) {
                     change_state(RESURRECTED);
                     handled = true;
                 }
                 break;
             case FALLING_VORTEX:
-                if (m.message == &quot;rise&quot;) {
+                if (m.message == &quot;_rise&quot;) {
                     change_state(RISING_VORTEX); // vortex-&gt;vortex teleportation
-                } else if (m.message == &quot;appear&quot;) {
+                } else if (m.message == &quot;_appear&quot;) {
                     change_state(APPEARING); // vortex-&gt;non-vortex teleportation
                     handled = true;
                 }
                 break;
             case JUMP_VORTEX:
-                if (m.message == &quot;laserhit&quot;) {
+                if (m.message == &quot;_laserhit&quot;) {
                     change_state(SHATTERING);
                     handled = true;
                 }
@@ -119,7 +107,7 @@
                 if (m.message == &quot;_init&quot;) {
                     Actor::message (m);
                     handled = true;
-                } else if (m.message == &quot;shatter&quot;) {
+                } else if (m.message == &quot;_shatter&quot;) {
                     change_state (SHATTERING);
                     handled = true;
                 }
@@ -131,7 +119,7 @@
         // Shield, booze and invisibility can be activated in all states except DEAD
     
         if (state != DEAD) {
-            if (m.message == &quot;shield&quot;) {
+            if (m.message == &quot;_shield&quot;) {
                 m_shield_rest_time += SHIELD_TIME;
                 update_halo();
                 handled = true;
@@ -140,7 +128,7 @@
                 m_invisible_rest_time += 8.0;
                 handled = true;
             }
-            else if (m.message == &quot;booze&quot;) {
+            else if (m.message == &quot;_booze&quot;) {
                 m_drunk_rest_time += 5.0; // Drunken for 5 more seconds
                 handled = true;
             }
@@ -253,9 +241,9 @@
             case FALLING:
                 set_model(kind+&quot;-fallen&quot;); // invisible
                 if (get_id (this) == ac_marble_white)
-                    sound_event (&quot;shattersmall&quot;);
+                    sound_event(&quot;shattersmall&quot;);
                 else
-                    sound_event (&quot;shatter&quot;);
+                    sound_event(&quot;shatter&quot;);
                 change_state(DEAD);
                 break;
             case JUMPING:

Modified: trunk/src/actors/Balls.hh
===================================================================
--- trunk/src/actors/Balls.hh	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/actors/Balls.hh	2008-12-22 22:37:58 UTC (rev 1408)
@@ -55,8 +55,6 @@
         BasicBall(const ActorTraits &amp;tr, int maxSinkDepthValue = 7);
 
         // Object interface.
-//        virtual void setAttr(const string&amp; key, const Value &amp;val);
-//        virtual Value getAttr(const std::string &amp;key) const;
         virtual Value message(const Message &amp;m);
         
         // Actor interface

Modified: trunk/src/actors.cc
===================================================================
--- trunk/src/actors.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/actors.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -101,6 +101,41 @@
     ASSERT(m_actorinfo.radius &lt;= get_max_radius(), XLevelRuntime, &quot;Actor: radius of actor too large&quot;);
 }
 
+    void Actor::setAttr(const string&amp; key, const Value &amp;val) {
+        if (key == &quot;controllers&quot;) {
+            controllers = val;
+        } else if (key == &quot;adhesion&quot;) { 
+            adhesion = val;
+        } else if (key == &quot;charge&quot;) {
+            m_actorinfo.charge = val;
+        } else
+            Object::setAttr(key, val);
+    }
+
+    Value Actor::getAttr(const std::string &amp;key) const {
+        if (key == &quot;controllers&quot;) {
+            return controllers;
+        } else if (key == &quot;adhesion&quot;) { 
+            return adhesion;
+        } else if (key == &quot;charge&quot;) {
+            return m_actorinfo.charge;
+        } else
+            return StateObject::getAttr(key);
+    }
+
+    Value Actor::message(const Message &amp;m) {
+        if (m.message == &quot;_init&quot;) {
+            startingpos = get_pos();
+            return Value();
+        } else if (m.message == &quot;_freeze&quot;) {
+            m_actorinfo.frozen_vel = m_actorinfo.vel;
+            m_actorinfo.vel = ecl::V2();
+        } else if (m.message == &quot;_revive&quot;) {
+            m_actorinfo.vel = m_actorinfo.frozen_vel;        
+        }
+        return StateObject::message(m);
+    }
+
 void Actor::on_collision (Actor *) 
 {
 }
@@ -260,32 +295,11 @@
     return true;
 }
 
-Value Actor::message(const Message &amp;m) {
-    if (m.message == &quot;_init&quot;) {
-        startingpos = get_pos();
-        return Value();
-    } else if (m.message == &quot;_freeze&quot;) {
-        m_actorinfo.frozen_vel = m_actorinfo.vel;
-        m_actorinfo.vel = ecl::V2();
-    } else if (m.message == &quot;_revive&quot;) {
-        m_actorinfo.vel = m_actorinfo.frozen_vel;        
-    }
-    return StateObject::message(m);
-}
 
 bool Actor::sound_event (const char *name, double vol) {
     return sound::EmitSoundEvent (name, get_pos(), getVolume(name, this, vol));
 }
 
-void Actor::setAttr(const string&amp; key, const Value &amp;val)
-{
-    if (key == &quot;controllers&quot;)
-        controllers = to_int (val);
-    else if (key == &quot;adhesion&quot;) 
-        adhesion = to_double (val);
-    Object::setAttr(key, val);
-}
-
     double Actor::squareDistance(const Object *other) const {
         const Actor *a = dynamic_cast&lt;const Actor *&gt;(other);
         if (a != NULL)
@@ -321,7 +335,7 @@
 //        bool is_on_floor() const { return false; } we need friction!
 
 	void on_collision (Actor *a) {
-	    SendMessage(a, &quot;shatter&quot;);
+	    SendMessage(a, &quot;_shatter&quot;);
 	}
 
         double range;
@@ -626,7 +640,7 @@
         bool is_dead() const { return false; }
 
 	void on_collision(Actor *a) {
-	    SendMessage(a, &quot;shatter&quot;);
+	    SendMessage(a, &quot;_shatter&quot;);
 	}
     };
 }

Modified: trunk/src/actors.hh
===================================================================
--- trunk/src/actors.hh	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/actors.hh	2008-12-22 22:37:58 UTC (rev 1408)
@@ -118,9 +118,10 @@
 
         /* ---------- Object interface ---------- */
         Actor *clone() = 0;
+        virtual void setAttr(const string&amp; key, const Value &amp;val);
+        virtual Value getAttr(const std::string &amp;key) const;
         virtual Value message(const Message &amp;m);
-        void   setAttr(const string&amp; key, const Value &amp;val);
-
+ 
         /* ---------- Actor interface ---------- */
         virtual const ActorTraits &amp;get_traits() const = 0;
 

Modified: trunk/src/floors/BridgeFloor.cc
===================================================================
--- trunk/src/floors/BridgeFloor.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/floors/BridgeFloor.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -128,7 +128,7 @@
     }
     
     void BridgeFloor::actor_contact(Actor *a) {
-        if (state != CLOSED) SendMessage(a, &quot;fall&quot;);
+        if (state != CLOSED) SendMessage(a, &quot;_fall&quot;);
     }
     
     std::string BridgeFloor::model_basename() const {

Modified: trunk/src/floors/SimpleFloors.cc
===================================================================
--- trunk/src/floors/SimpleFloors.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/floors/SimpleFloors.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -40,7 +40,7 @@
     }
 
     void Abyss::actor_contact (Actor* a) {
-        SendMessage(a, &quot;fall&quot;);
+        SendMessage(a, &quot;_fall&quot;);
     }
     
 /* -------------------- Ice -------------------- */

Modified: trunk/src/items/GlassesItem.cc
===================================================================
--- trunk/src/items/GlassesItem.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/items/GlassesItem.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -78,7 +78,7 @@
     }
     void Glasses::on_stonehit(Stone *) {
         if (state &gt; 0) {
-            sound_event (&quot;shatter&quot;);
+            sound_event(&quot;shatter&quot;);
             setState(0);
         }
     }

Modified: trunk/src/items/SimpleItems.cc
===================================================================
--- trunk/src/items/SimpleItems.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/items/SimpleItems.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -85,7 +85,7 @@
     bool DeathItem::actor_hit(Actor *a) {
         ActorInfo &amp;ai = * a-&gt;get_actorinfo();
         if (!ai.grabbed) {
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
             if (state == 0) {
                 state = 1;
                 set_anim(&quot;it_death_anim&quot;);

Modified: trunk/src/items/Umbrella.cc
===================================================================
--- trunk/src/items/Umbrella.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/items/Umbrella.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -58,7 +58,7 @@
     }
     
     ItemAction Umbrella::activate(Actor *a, GridPos) {
-        SendMessage(a, &quot;shield&quot;);
+        SendMessage(a, &quot;_shield&quot;);
         return ITEM_KILL;
     }
     

Modified: trunk/src/items/Vortex.cc
===================================================================
--- trunk/src/items/Vortex.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/items/Vortex.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -38,7 +38,7 @@
         GameTimer.remove_alarm(this);
         if (Actor *actor = dynamic_cast&lt;Actor *&gt;((Object *)getAttr(&quot;$grabbed_actor&quot;))) {
             // release an actor that is grabbed on behalf of this vortex - actor state FALLING_VORTEX
-            SendMessage(actor, &quot;rise&quot;);
+            SendMessage(actor, &quot;_rise&quot;);
         }
     }
 
@@ -163,7 +163,7 @@
         V2 v(destVortex-&gt;get_pos().center());
         if (Actor *actor = dynamic_cast&lt;Actor *&gt;((Object *)getAttr(&quot;$grabbed_actor&quot;))) {
             WarpActor(actor, v[0], v[1], false);
-            SendMessage(actor, &quot;rise&quot;);
+            SendMessage(actor, &quot;_rise&quot;);
             if (destVortex != this) {
                 bool isScissor = to_bool(getDefaultedAttr(&quot;scissor&quot;, 
                         (server::EnigmaCompatibility &gt;= 1.10) || server::GameCompatibility != GAMET_ENIGMA));
@@ -184,7 +184,7 @@
         client::Msg_Sparkle (target);
         if (Actor *actor = dynamic_cast&lt;Actor *&gt;((Object *)getAttr(&quot;$grabbed_actor&quot;))) {
             WarpActor(actor, target[0], target[1], false);
-            SendMessage(actor, &quot;appear&quot;);
+            SendMessage(actor, &quot;_appear&quot;);
             bool isScissor = to_bool(getDefaultedAttr(&quot;scissor&quot;, 
                     (server::EnigmaCompatibility &gt;= 1.10) || server::GameCompatibility != GAMET_ENIGMA));
             if (isScissor)

Modified: trunk/src/items.cc
===================================================================
--- trunk/src/items.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/items.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -224,7 +224,7 @@
         DECL_ITEMTRAITS;
 
         ItemAction activate(Actor *a, GridPos) {
-            SendMessage(a, &quot;suicide&quot;);
+            SendMessage(a, &quot;_suicide&quot;);
             return ITEM_DROP;
         }
     public:
@@ -246,7 +246,7 @@
 	}
     private:
 	ItemAction activate(Actor *a, GridPos) {
-	    SendMessage(a, &quot;booze&quot;);
+	    SendMessage(a, &quot;_booze&quot;);
 	    return ITEM_DROP;
 	}
     void on_stonehit(Stone *) {
@@ -267,7 +267,7 @@
         bool actor_hit(Actor *a) {
             ActorInfo &amp;ai = * a-&gt;get_actorinfo();
             if (!ai.grabbed &amp;&amp; a-&gt;is_on_floor()) {
-                SendMessage(a, &quot;shatter&quot;);
+                SendMessage(a, &quot;_shatter&quot;);
             }
             return false;
         }
@@ -311,7 +311,7 @@
     private:
         ItemAction activate(Actor *a, GridPos)
         {
-            SendMessage(a, &quot;jump&quot;);
+            SendMessage(a, &quot;_jump&quot;);
             return ITEM_KEEP;
         }
     };
@@ -327,7 +327,7 @@
         {
             Item *it = GetItem(p);
             if (!it || has_flags(it, itf_static)) {
-                SendMessage(a, &quot;jump&quot;);
+                SendMessage(a, &quot;_jump&quot;);
                 return ITEM_DROP;  // drop if grid has no item
             } else {
                 // don't jump if a regular item is on the grid
@@ -352,7 +352,7 @@
             double dist = length(a-&gt;get_pos() - item_center);
             if (dist &lt; ITEM_RADIUS) {
                 set_anim(&quot;it-springboard_anim&quot;);
-                SendMessage(a, &quot;jump&quot;);
+                SendMessage(a, &quot;_jump&quot;);
             }
             return false;
         }
@@ -377,7 +377,7 @@
     private:
         void init_model() {set_anim(&quot;expl&quot;);}
         bool actor_hit(Actor *actor) {
-            SendMessage(actor, &quot;shatter&quot;);
+            SendMessage(actor, &quot;_shatter&quot;);
             return false;
         }
     };
@@ -896,7 +896,7 @@
         }
         bool actor_hit(Actor *a) {
             if (anim_end)
-                SendMessage(a, &quot;fall&quot;);
+                SendMessage(a, &quot;_fall&quot;);
             return false;
         }
         virtual Value message(const Message &amp;m) {
@@ -941,7 +941,7 @@
         DECL_ITEMTRAITS;
 
         bool actor_hit(Actor *a) {
-            SendMessage(a, &quot;fall&quot;);
+            SendMessage(a, &quot;_fall&quot;);
             return false;
         }
         void animcb() {
@@ -1025,7 +1025,7 @@
 
 bool Burnable::actor_hit(Actor *a) {
     if (state == IGNITE || state == BURNING)
-        SendMessage(a, &quot;shatter&quot;);
+        SendMessage(a, &quot;_shatter&quot;);
     return false;
 }
 
@@ -1398,7 +1398,7 @@
     
     bool Trap::actor_hit(Actor *a) {
         if (!a-&gt;is_flying()) {
-            SendMessage(a, &quot;fall&quot;);
+            SendMessage(a, &quot;_fall&quot;);
             if (state == 0) {
                 state = 1;
                 set_anim(&quot;it_trap_breaking&quot;);
@@ -1782,7 +1782,7 @@
                 // Kill ALL rubberbands connected with the actor:
                 SendMessage(a, &quot;disconnect&quot;);
                 Actor *rotor = MakeActor(&quot;ac-rotor&quot;);
-                rotor-&gt;setAttr(&quot;mouseforce&quot;, Value (1.0));
+                rotor-&gt;setAttr(&quot;adhesion&quot;, Value (1.0));
                 rotor-&gt;setAttr(&quot;controllers&quot;, Value (iplayer+1));
                 rotor-&gt;setAttr(&quot;player&quot;, Value (iplayer));
                 rotor-&gt;setAttr(&quot;gohome&quot;, Value (0.0));

Modified: trunk/src/laser.cc
===================================================================
--- trunk/src/laser.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/laser.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -149,7 +149,7 @@
     if ((directions &amp; (EASTBIT | WESTBIT) &amp;&amp; dy&lt;-0.1) ||
         (directions &amp; (NORTHBIT | SOUTHBIT)) &amp;&amp; dx&lt;-0.1)
     {
-        SendMessage(actor, &quot;laserhit&quot;);
+        SendMessage(actor, &quot;_laserhit&quot;);
     }
 
     return false; // laser beams can't be picked up

Modified: trunk/src/player.cc
===================================================================
--- trunk/src/player.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/player.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -114,7 +114,7 @@
     const double RESPAWN_TIME = 1.5;
 
 //    a-&gt;find_respawnpos();
-    SendMessage(a, &quot;resurrect&quot;);
+    SendMessage(a, &quot;_resurrect&quot;);
     remove_extralife(a);
     respawn_list.push_back(RespawnInfo(a, RESPAWN_TIME));
 }
@@ -233,7 +233,7 @@
             if (stage == 0) {
                 SendMessage(a, &quot;_levelfinish&quot;);
             } else {
-                SendMessage(a, &quot;disappear&quot;);
+                SendMessage(a, &quot;_disappear&quot;);
                 SendMessage(a, &quot;disconnect&quot;);
             }
         }
@@ -326,7 +326,7 @@
     for (unsigned i=0; i&lt;players.size(); ++i) {
         vector&lt;Actor *&gt; &amp;al = players[i].actors;
         for (unsigned j=0; j&lt;al.size(); ++j) {
-            SendMessage(al[j], &quot;suicide&quot;);
+            SendMessage(al[j], &quot;_suicide&quot;);
         }
     }
 }

Modified: trunk/src/server.cc
===================================================================
--- trunk/src/server.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/server.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -496,8 +496,7 @@
 
     // ------------------------------ cheats
     else if (cmd == &quot;god&quot;) {
-        SendMessage (player::GetMainActor (player::CurrentPlayer()),
-                     &quot;shield&quot;);
+        SendMessage(player::GetMainActor(player::CurrentPlayer()), &quot;_shield&quot;);
         client::Msg_Command(&quot;cheater&quot;);
     }
     else if (cmd == &quot;collision&quot;) {

Modified: trunk/src/stones/BlockerStone.cc
===================================================================
--- trunk/src/stones/BlockerStone.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/BlockerStone.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -121,13 +121,13 @@
         if (!(getDefaultedAttr(&quot;autoclose&quot;, false).to_bool()) &amp;&amp; (
                 (state == GROWING &amp;&amp; server::GameCompatibility != GAMET_PEROXYD) ||
                 (state == SOLID &amp;&amp; server::GameCompatibility == GAMET_PEROXYD))) {
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
         }
     }
     void BlockerStone::actor_inside(Actor *a) {
         if ((state == GROWING &amp;&amp; server::GameCompatibility != GAMET_PEROXYD) ||
                 (state == SOLID &amp;&amp; server::GameCompatibility == GAMET_PEROXYD)) {
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
         }
     }
     

Modified: trunk/src/stones/BoxStone.cc
===================================================================
--- trunk/src/stones/BoxStone.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/BoxStone.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -89,7 +89,7 @@
             return true;  // allow fire to spread
         } else if (m.message == &quot;heat&quot;) {
             return (objFlags &amp; OBJBIT_BLOCKFIRE) != 0;  // block fire
-        } else if (m.message == &quot;fall&quot;) {
+        } else if (m.message == &quot;_fall&quot;) {
             maybe_fall_or_stopfire();
             return Value();
         }
@@ -137,19 +137,19 @@
     
     void BoxStone::actor_hit(const StoneContact &amp;sc) {
         if (state == GROWING)
-            SendMessage(sc.actor, &quot;shatter&quot;);
+            SendMessage(sc.actor, &quot;_shatter&quot;);
         else
             Stone::actor_hit(sc);
     }
     
     void BoxStone::actor_inside(Actor *a) {
         if (state == GROWING)
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
     }
     
     void BoxStone::actor_contact(Actor *a) {
         if (state == GROWING)
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
     }
     
     void BoxStone::on_move() {

Modified: trunk/src/stones/DeathStone.cc
===================================================================
--- trunk/src/stones/DeathStone.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/DeathStone.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -90,7 +90,7 @@
     }
     
     void DeathStone::actor_hit(const StoneContact &amp;sc) {
-        SendMessage(sc.actor, &quot;shatter&quot;);
+        SendMessage(sc.actor, &quot;_shatter&quot;);
         if (state == IDLE) {
             state = PULSING;
             set_anim(&quot;st-death-anim&quot;);

Modified: trunk/src/stones/KnightStone.cc
===================================================================
--- trunk/src/stones/KnightStone.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/KnightStone.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -59,7 +59,7 @@
                 }
                 init_model();
             } else {
-                SendMessage(sc.actor, &quot;shatter&quot;);
+                SendMessage(sc.actor, &quot;_shatter&quot;);
             }
         }
     }

Modified: trunk/src/stones/PuzzleStone.cc
===================================================================
--- trunk/src/stones/PuzzleStone.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/PuzzleStone.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -234,7 +234,7 @@
 
     void PuzzleStone::actor_contact (Actor *a) {
         if (state == EXPLODING || state == IGNITED)
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
     }
 
     void PuzzleStone::on_impulse(const Impulse&amp; impulse) {

Modified: trunk/src/stones/SimpleStones.cc
===================================================================
--- trunk/src/stones/SimpleStones.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/SimpleStones.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -43,7 +43,7 @@
     }
 
     Value ChargeStone::getAttr(const std::string &amp;key) const {
-        if (key == &quot;$charge&quot;) {
+        if (key == &quot;$chargesign&quot;) {             // used by validator to identify charge stone subkinds
             double charge = getAttr(&quot;charge&quot;);
             return (charge == 0) ? 0 : ((charge &gt; 0.0) ? 1 : -1);
         } else
@@ -69,8 +69,7 @@
     
     void ChargeStone::actor_hit(const StoneContact &amp;sc) {
         double charge = getAttr(&quot;charge&quot;);
-        ActorInfo *ai = sc.actor-&gt;get_actorinfo();
-        ai-&gt;charge = charge;
+        sc.actor-&gt;setAttr(&quot;charge&quot;, charge);
         set_anim(ecl::strf(&quot;st-charge%s-anim&quot;, (charge == 0) ? &quot;zero&quot; : ((charge &gt; 0.0) ? &quot;plus&quot; : &quot;minus&quot;)).c_str());
     }
     

Modified: trunk/src/stones/StoneImpulse.cc
===================================================================
--- trunk/src/stones/StoneImpulse.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/StoneImpulse.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -173,7 +173,7 @@
     
     void StoneImpulse::actor_inside(Actor *a) {
         if ((state != IDLE) &amp;&amp; (objFlags &amp; OBJBIT_HOLLOW))
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
     }
     
     void StoneImpulse::actor_hit(const StoneContact &amp;sc) {

Modified: trunk/src/stones/Turnstile.cc
===================================================================
--- trunk/src/stones/Turnstile.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/Turnstile.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -294,7 +294,7 @@
                 // Move only the actor that hit the turnstile in Oxyd mode
                 do_warp = (ac == dynamic_cast&lt;Actor*&gt;(impulse_sender));
                 if (!do_warp &amp;&amp; arm_seen[idx_source])
-                    SendMessage(ac, &quot;shatter&quot;); // hit by an arm
+                    SendMessage(ac, &quot;_shatter&quot;); // hit by an arm
             } else { // green turnstile
                 // move all actors only if pushed by an arm
                 do_warp = arm_seen[idx_source];
@@ -307,7 +307,7 @@
             GridPos ac_target_pos(pv_pos.x+to_x[idx_target], pv_pos.y+to_y[idx_target]);
 
             if(!IsInsideLevel(ac_target_pos)) {
-                SendMessage(ac, &quot;shatter&quot;);
+                SendMessage(ac, &quot;_shatter&quot;);
                 continue;
             }
 

Modified: trunk/src/stones/VolcanoStone.cc
===================================================================
--- trunk/src/stones/VolcanoStone.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/VolcanoStone.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -136,23 +136,23 @@
             state = BREAKING;
             init_model();
         } else if (state == GROWING) {
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
         }
     }
     
     void VolcanoStone::actor_touch(const StoneContact &amp;sc) {
         if (state == GROWING)
-            SendMessage(sc.actor, &quot;shatter&quot;);        
+            SendMessage(sc.actor, &quot;_shatter&quot;);        
     }
 
     void VolcanoStone::actor_inside(Actor *a) {
         if (state != NEW)
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
     }
     
     void VolcanoStone::actor_contact(Actor *a) {
         if (state == GROWING)
-            SendMessage(a, &quot;shatter&quot;);
+            SendMessage(a, &quot;_shatter&quot;);
     }
     
     FreezeStatusBits VolcanoStone::get_freeze_bits() {

Modified: trunk/src/stones/WindowStone.cc
===================================================================
--- trunk/src/stones/WindowStone.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones/WindowStone.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -154,7 +154,7 @@
                 threshold -= 10;
             
             if (impulse &gt; 35) {
-                SendMessage(a, &quot;shatter&quot;);
+                SendMessage(a, &quot;_shatter&quot;);
             }
 
             else if (!(objFlags &amp; OBJBIT_SECURE) &amp;&amp; impulse &gt; threshold) {

Modified: trunk/src/stones_simple.cc
===================================================================
--- trunk/src/stones_simple.cc	2008-12-22 00:20:36 UTC (rev 1407)
+++ trunk/src/stones_simple.cc	2008-12-22 22:37:58 UTC (rev 1408)
@@ -852,9 +852,9 @@
             Stone *st = MakeStone(&quot;st-greenbrown&quot;);
             ReplaceStone(get_pos(), st);
         }
-        void actor_contact(Actor *a) {SendMessage(a, &quot;shatter&quot;);}
-        void actor_inside(Actor *a) {SendMessage(a, &quot;shatter&quot;);}
-        void actor_hit(const StoneContact &amp;sc) {SendMessage(sc.actor, &quot;shatter&quot;);}
+        void actor_contact(Actor *a) {SendMessage(a, &quot;_shatter&quot;);}
+        void actor_inside(Actor *a) {SendMessage(a, &quot;_shatter&quot;);}
+        void actor_hit(const StoneContact &amp;sc) {SendMessage(sc.actor, &quot;_shatter&quot;);}
     };
     DEF_TRAITS(GreenbrownStone_Growing, &quot;st-greenbrown-growing&quot;, st_greenbrown_growing);
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000836.html">[Enigma-game-svn] r1407 - team_levelpacks/team_test_new_api
</A></li>
	<LI>Next message: <A HREF="000838.html">[Enigma-game-svn] r1409 - in homepage: images/lotm input/lotm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#837">[ date ]</a>
              <a href="thread.html#837">[ thread ]</a>
              <a href="subject.html#837">[ subject ]</a>
              <a href="author.html#837">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
