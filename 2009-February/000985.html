<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1555 - in trunk: data doc/reference src/items
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2009-February/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1555%20-%20in%20trunk%3A%20data%20doc/reference%20src/items&In-Reply-To=%3C200902252344.n1PNisxR026533%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000984.html">
   <LINK REL="Next"  HREF="000986.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1555 - in trunk: data doc/reference src/items</H1>
    <B>ral at mail.berlios.de</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1555%20-%20in%20trunk%3A%20data%20doc/reference%20src/items&In-Reply-To=%3C200902252344.n1PNisxR026533%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1555 - in trunk: data doc/reference src/items">ral at mail.berlios.de
       </A><BR>
    <I>Thu Feb 26 00:44:54 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000984.html">[Enigma-game-svn] r1554 - in trunk: data data/schemas src src/items	src/others src/stones
</A></li>
        <LI>Next message: <A HREF="000986.html">[Enigma-game-svn] r1556 - in homepage: . input
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#985">[ date ]</a>
              <a href="thread.html#985">[ thread ]</a>
              <a href="subject.html#985">[ subject ]</a>
              <a href="author.html#985">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ral
Date: 2009-02-26 00:44:43 +0100 (Thu, 26 Feb 2009)
New Revision: 1555

Modified:
   trunk/data/api2init.lua
   trunk/doc/reference/enigma-ref.texi
   trunk/src/items/SurpriseItem.cc
Log:
Trunk 1.1: new API reengineering
- refman: further updates on objects and resolvers
- small fixes and internal renamings


Modified: trunk/data/api2init.lua
===================================================================
--- trunk/data/api2init.lua	2009-02-23 23:41:52 UTC (rev 1554)
+++ trunk/data/api2init.lua	2009-02-25 23:44:43 UTC (rev 1555)
@@ -527,16 +527,16 @@
     if tile ~= nil then
         return tile
     end
-    local template = context[4]
-    if template == nil then
-        template = &quot;123456789&quot;
+    local sequence = context[4]
+    if sequence == nil then
+        sequence = &quot;123456789&quot;
     end
     -- try to compose tile
     for i = 1, #key do
         local subkey = &quot;&quot;
         local ic = &quot;&quot; .. i
         for j = 1, #key do
-            if template:sub(j, j) == ic then
+            if sequence:sub(j, j) == ic then
                 subkey = subkey .. key:sub(j, j)
             else
                 subkey = subkey .. &quot; &quot;
@@ -559,16 +559,16 @@
 
 function res.composer(subresolver, ...)
     local args = {...}
-    local template = nil
+    local sequence = nil
     if #args &gt;  1 then
         error(&quot;Resolver composer did not expect more than one argument&quot; ,2)
     elseif #args == 1 then
         if type(args[1]) ~= &quot;string&quot; then
             error(&quot;Resolver composer did expect string as first argument&quot; ,2)
         end
-        template = args[1]
+        sequence = args[1]
     end
-    local context = {res.composer_implementation, nil, subresolver, template}
+    local context = {res.composer_implementation, nil, subresolver, sequence}
     return context
 end
 

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-02-23 23:41:52 UTC (rev 1554)
+++ trunk/doc/reference/enigma-ref.texi	2009-02-25 23:44:43 UTC (rev 1555)
@@ -3121,7 +3121,7 @@
 @example
 mySwitch[&quot;color&quot;] = nil
 mySwitch[&quot;color&quot;] = DEFAULT
-wo[{3,6}] = @{&quot;ac_marble_black&quot;, player=DEFAULT@}
+wo[@{3,6@}] = @{&quot;ac_marble_black&quot;, player=DEFAULT@}
 @end example
 
 Note that @samp{DEFAULT} is not equal to @samp{nil}. They are different values
@@ -6479,10 +6479,12 @@
 @section Standard Items
 
 @menu
-* it_bag::
+* it_bag::             Portable Item Container
+* it_banana::          Transformable Banana
 * it_blocker::         Shrinked Blocker Stone
 * it_brake::           Movable Stone Brake
 * it_brush::
+* it_cherry::          Source of Invisibility
 * it_coin::            Enigma's currency
 * it_cross::           Floor switch for patient Actors
 * it_death::           Unpassable grid blocker
@@ -6495,20 +6497,24 @@
 * it_magicwand::       Wizards Tools
 * it_magnet::
 * it_meditation::
+* it_pin::             Friction increasing crampon
 * it_pipe::
 * it_rubberband::
 * it_seed::            Seeds for Wood, Volcano Stones
 * it_sensor::          Floor Switch for passing Actors
 * it_shogun::          Dot for Shogun Stones
+* it_squashed::        Remnant of squashed Fruits
 * it_strip::           Narrow Bridge
+* it_surprise::        Random Transforming item
 * it_sword::
 * it_trap::
 * it_trigger::         Floor Switch for Actors and Stones
 * it_umbrella::        Death Protection Item
 * it_vortex::          Teleport of Marbels
+* it_weight::          Portable Mass
 * it_wormhole::        Teleport of Actors
-* it_wrench::
-* it_yinyang::
+* it_wrench::          Tool for mechanical Stones
+* it_yinyang::         Player toggling Switch
 @end menu
 
 
@@ -6517,9 +6523,64 @@
 @subsection it_bag
 @obindex it_bag
 
+A bag is a portable container for other objects. The player can fill it with
+up to 13 other items, including other empty or filled bags.
 
+The bag allows a player to carry in total more than 13 items in his inventory.
+Nevertheless most items carried in a bag can not directly be applied. Just the
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{it_weight} does apply its mass even when carried in a bag. On the other
+hand bags offer the user the possibility to pick up and drop items that can not
+be dropped otherwise as they would be activated. E.g. an @ref{it_cherry} can
+not be dropped without application, but if it is contained in a bag the bag
+can be dropped and the cherry can be extracted later on. A bag is useful to
+transfer multiple items via @ref{st_mail}, too.
 
+As long as an @code{it_bag} is at the first place in the inventory, new items
+are put into the bag instead of the inventory, until the bag is full (13 items).
+The player can drop an @code{it_bag} anytime.  When picked up again, items from
+the bag are put back into the inventory (until it is full).
 
+The quite complex rules of pick up in detail:
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at enumerate</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A>
+Inventory and bag are limited concerning pickups to 13 items.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A>
+Both are generally LIFO (last item picked up is first item out), but the 
+inventory content can be rotated.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A>
+If you pick up any item besides a bag and your first inventory item is not a bag
+the item is added to the inventory.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A>
+If you pick up any item besides a non-empty bag and your first inventory item is
+a bag the item is added to the first inventroy bag (this includes non-empty bags
+being added into first inventory bags!)
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A>
+You empty a bag by dropping it and picking it up again with any item at the
+first inventory position but a bag. As many items as possible are taken from the
+bag and added to the inventory.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A>
+Empty bags are never put into other bags (this would cause unresolvable
+recursion problems). They will only be added as items directly to the inventory.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A>
+If the &quot;picked up&quot; bag can not empty its contents to the inventory or a bag at
+the first inventory position is full the bag is not picked up and keeps the
+remaining items.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> enumerate
+
+You can add items directly to a bag by usage of the world @ref{add} method.
+
+Bags are are used by @ref{st_thief} and @ref{fl_thief} to carry their stolen
+items. When the thiefs are captured by @ref{st_chess} the bag remains on the
+grid position filled up with the stolen items.
+
 @table @asis
 
 @item @b{Attributes:} none
@@ -6528,6 +6589,21 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Banana Item --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_banana
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_banana
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_banana
+
+A portable item without direct usage. But it transforms into an @ref{it_cherry}
+when it by a laser beam.
+
+When a stone is pushed over it an @ref{it_squashed} remains as remnants.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Blocker Item --------------------
 @node it_blocker
 @subsection it_blocker
@@ -6650,6 +6726,8 @@
 
 TBD
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{it_squashed}
+
 @table @asis
 
 @item @b{Attributes:} none
@@ -6658,6 +6736,29 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Cherry Item --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_cherry
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_cherry
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_cherry
+
+A magic item that makes the activating actor for 8 seconds invisible. But not
+all actors become insivible. Just the ball like actors @ref{ac_marble} and
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{ac_pearl} do vanish. Other actors just drop the cherry on activation.
+
+An invisible actor can walk through most kinds of glass 
+(@pxref{Transparent Stones})and as being invisible
+they do no longer attrackt hostile @ref{ac_rotor} and @ref{ac_top}.
+
+When several cherries are activated in sequence each does prolong the actor's
+time of invisiblity by additional 8 seconds.
+
+When a stone is pushed over a cherry an @ref{it_squashed} remains as remnants.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Coin Item --------------------
 @node it_coin
 @subsection it_coin
@@ -7119,6 +7220,27 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Pin Item --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_pin
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_pin
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_pin
+
+A pin is a friction increasing item that can be used as a crampon on @ref{fl_ice}.
+When it is picked up and is added to the inventory it significantly increases
+the floor friction applied to all actors owned by the inventory's owner.
+
+Pins do just increase friction as long as they are directly part of the 
+inventory. A pin contained within an @ref{it_bag}, being part of the inventory,
+has no influence on the friction. Two or more pins do not apply more friction
+than a single pin. As soon as the last pin is dropped the friction returns
+to its standard values.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
 @c ----------------- Pipe Item --------------------
 @node it_pipe
 @subsection it_pipe
@@ -7367,6 +7489,23 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Squashed Item --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_squashed
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_squashed
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_squashed
+
+The remnants of fruits like @ref{it_cherry} and @ref{it_banana} after pushing
+a stone over it.
+
+The squashed remnants are scarcely visible on some floor types. The player can
+not pick them up. But it can be wiped away by application of an @ref{it_brush}
+or by a nearby exploding @ref{it_bomb}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Strip Item --------------------
 @node it_strip
 @subsection it_strip
@@ -7425,6 +7564,50 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Surprise Item --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_surprise
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_surprise
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_surprise
+
+An item that transforms into a random item as soon as the player drops it.
+
+The replacement item is a random one out of a given selection. You can set
+the @samp{selection} attribute with token of strings. Every string needs either
+to be an @ref{Object Kind} or a tile key prefixed by an equal sign @samp{=}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+ti[&quot;m&quot;] = @{&quot;it_magicwand&quot;@}
+ti[&quot;e&quot;] = @{&quot;it_extralife&quot;@}
+ti[&quot;s&quot;] = @{&quot;it_surprise&quot;, selection=@{&quot;it_seed&quot;, &quot;=m&quot;, &quot;=e&quot;, &quot;=e&quot;@}@}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+The replacement item is randomly chosen out of the given selection. By listing
+an item several times you can take influence on the likelyhood.
+
+The tile declarations referenced by a key may even contain objects besides
+items. But you should make rare and proper usage of this feature.
+
+Prior replacing the surprise item but after droping it the surprise item will
+perform its action. You can use this action to modify the selection or to set
+objects on your own.
+
+The surprise item is killed by any replacement item set to the grid position.
+If your selection does not resolve to an item you may need to add @ref{&quot;it_nil&quot;}
+to the replacement tile declaration.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{selection}, @ @ @i{values}: tokens of item kinds and tile keys; @ @ @i{default}: @code{@{&quot;it_umbrella&quot;, &quot;it_spring_keep&quot;, &quot;it_dynamite&quot;, &quot;it_coffee&quot;, &quot;it_hammer&quot;@}}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:} @ @ @xref{target}, @ @ @xref{action}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Sword Item --------------------
 @node it_sword
 @subsection it_sword
@@ -7665,6 +7848,34 @@
 @end table
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Weight Item --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> it_weight
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> it_weight
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> it_weight
+
+A weight is an item with a mass, that defaults to the mass of 10 @ref{ac_marble}s.
+When it is picked up it is added to the inventory and increases the mass of
+all actors owned by the inventory's owner.
+
+Weights can easily be picked up, but the player can not drop them. Just indirect
+methods like hitting @ref{st_mail}, @ref{st_thief} or crossing a @ref{fl_thief}
+may remove this item from the inventory.
+
+The inventories mass is always updated to the mass of all weights kept in the
+inventory or contained in any @ref{it_bag} contained in the inventory.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{mass} @ @ @i{values}: positive float number; @ @ @i{default}: @code{+10.0}
+Mass unit is the mass of an @ref{ac_marble}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Wormhole Item --------------------
 @node it_wormhole
 @subsection it_wormhole
@@ -7764,7 +7975,7 @@
 @obindex it_yinyang
 
 A special switch that allows the user to toggle the @ref{Player and Inventory}
-between @code{YIN} and code{YANG}.
+between @code{YIN} and @code{YANG}.
 
 On activation this item does not get dropped but remains unchanged in the
 inventory.
@@ -8307,12 +8518,14 @@
 
 @menu
 * st_actorimpulse::    Bumper Stone
+* st_beads::           Frame of Glass Beads
 * st_blocker::         Shrinkable Blocker
 * st_blur::            Passage of yet undetermined color
 * st_boulder::         Moving Arrow Boulder
 * st_brake::           Brake for moving Boulders
 * st_chess::           Movable Chess Knight Stone
 * st_coinslot::        Coin Driven Switch
+* st_darkglass::       Semitransparent metall framed Glass
 * st_death::           Skull Stone
 * st_disco::           Light shading Stone
 * st_door::            Door of various Flavors
@@ -8323,7 +8536,9 @@
 * st_laser::           Lightemitting Laser
 * st_laserflop::       Lightsensitive Monoflop
 * st_laserswitch::     Lightsensitive Switch
+* st_lightglass::      Transparent metall framed Glass
 * st_lightpassenger::  Stone pushed by Light
+* st_magic::           Magic Tranforming Stone
 * st_mail::            Mail office for Item transportation
 * st_mirror::          Mirrors of all flavors
 * st_monoflop::        Monoflop Switch
@@ -8334,11 +8549,14 @@
 * st_pull::            Pullable Stone
 * st_puzzle::          Clusterable Puzzle Stones
 * st_quake::           Oxyd closing Stone
+* st_rawglass::        Transparent Glass Block
+* st_redfiber::        Woven Fiber in a metall Frame
 * st_rotator::         Rotating Stone Impulser
 * st_rubberband::      Rubberband generator
 * st_scissors::        Scissors cutting rubberbands
 * st_shogun::          Stackable Hole Stones
 * st_stoneimpulse::    Neighbor Pushing pulsing Stone
+* st_surprise::        Random Transforming Stone
 * st_swap::            Neighbor Swapping Stone
 * st_switch::          Classical on/off Switch
 * st_timer::           Animated Timer
@@ -8412,6 +8630,30 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Beads Stone --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_beads
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_beads
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_beads
+
+A stone framed by glass beads. Like other @ref{Transparent Stones} it is 
+passable for invisible actors, but it is not transparent to laser beams.
+
+Like @ref{st_oneway} the beads stone does not detain visible actors once they
+entered the grid and lets them leave on any side.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_beads}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Blocker Stone --------------------
 @node st_blocker
 @subsection st_blocker
@@ -8767,6 +9009,39 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Darkglass Stone --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_darkglass
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_darkglass
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_darkglass
+
+A metal framed semi transparent glass stone. It exists in static, movable and 
+hollow variants and is just transparent to laser light in its hollow variant.
+Like other @ref{Transparent Stones} it is passable for invisible actors as long
+as it is not @samp{movable}.
+
+A @ref{st_lightpassenger} in state @samp{OFF} looks identical to a darkglass
+stone
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{hollow} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: read only @ @ @xref{hollow}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{movable} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: read only @ @ @xref{movable}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_darkglass}: hollow = @code{false}, movable = @code{false}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_darkglass_hollow}: hollow = @code{true}, movable = @code{false}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_darkglass_movable}: hollow = @code{false}, movable = @code{true}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Death Stone --------------------
 @node st_death
 @subsection st_death
@@ -9254,6 +9529,39 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Lightglass Stone --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_lightglass
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_lightglass
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_lightglass
+
+A metal framed transparent glass stone. It exists in static, movable and 
+hollow variants and is by its very nature transparent to laser light. Like other
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{Transparent Stones} it is passable for invisible actors as long as it is
+not @samp{movable}.
+
+A @ref{st_magic} of variant @code{st_magic_oxyda} transforms on actor hits to
+a movable lightglass stone
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{hollow} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: read only @ @ @xref{hollow}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{movable} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: read only @ @ @xref{movable}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_lightglass}: hollow = @code{false}, movable = @code{false}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_lightglass_hollow}: hollow = @code{true}, movable = @code{false}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_lightglass_movable}: hollow = @code{false}, movable = @code{true}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Lightpassenger Stone --------------------
 
 @node st_lightpassenger
@@ -9291,9 +9599,9 @@
 i.e., the sum of gradient-force and @code{force_x/y}-attributes.
 
 The light passenger can be switched on and off by messages (see below), and
-appears as @samp{st_glass2} when inactive. A player with an @ref{it_glasses}
+appears as @samp{st_darkglass} when inactive. A player with an @ref{it_glasses}
 in his inventory that includes the @samp{SPOT_LIGHTPASSENGER} feature is able
-to distinguish the switched off lightpassenger from an @samp{st_glass2}.
+to distinguish the switched off lightpassenger from an @samp{st_darkglass}.
 The variant @samp{st_lightpassenger_off} is deactivated from the beginning.
 A lightpassenger that moves onto an @ref{it_cross} switches off immediatly. A
 switchted off lightpassenger can be switched on by an actor hit with a revealed
@@ -9344,6 +9652,48 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Magic Stone --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_magic
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_magic
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_magic
+
+A stone that mimics one stone, but transforms on actor hits into another stone.
+
+Like @ref{st_fake} this stone does initially look like another stone of a kind
+given by the attribute @samp{flavor}. But on an actor hit with or without tool
+it transforms to another stone, which provides its own set of features.
+
+The flavor @code{&quot;brick&quot;} just transforms on a hit with a revealed
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{it_magicwand} into a static @ref{st_rawglass}.
+
+The flavor @code{&quot;oxyda&quot;} transforms on any hit into a movable 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{st_lightglass}.
+
+The flavor @code{&quot;oxydc&quot;} transforms on any hit into a movable 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{st_rawglass}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{flavor} @ @ @i{values}: @code{&quot;brick&quot;}, @code{&quot;oxyda&quot;}, @code{&quot;oxydc&quot;}; @ @ @i{default}: @code{&quot;brick&quot;}; @ @ @i{access}: read only
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_magic}: flavor=@code{&quot;brick&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_magic_brick}: flavor=@code{&quot;brick&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_magic_oxyda}: flavor=@code{&quot;oxyda&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_magic_oxydc}: flavor=@code{&quot;oxydc&quot;}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Mail Stone --------------------
 @node st_mail
 @subsection st_mail
@@ -10032,6 +10382,58 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Rawglass Stone --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_rawglass
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_rawglass
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_rawglass
+
+A block of raw glass. It exists in static and movable variants and is by its
+very nature transparent to laser light. Like other @ref{Transparent Stones} it
+is passable for invisible actors.
+
+This stone looks identical to @ref{st_ice}, but differs of course in its
+features.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{movable} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: read only @ @ @xref{movable}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_rawglass}: movable = @code{false}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_rawglass_movable}: movable = @code{true}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Redfiber Stone --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_redfiber
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_redfiber
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_redfiber
+
+A metal frame with woven red fiber. Like other @ref{Transparent Stones} it is
+passable ransparent to laser light. But the redfiber is not passable to any
+actors.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:} none
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Variants:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{st_redfiber}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Rotator Stone --------------------
 @node st_rotator
 @subsection st_rotator
@@ -10317,6 +10719,49 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Surprise Stone --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> st_surprise
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> st_surprise
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at obindex</A> st_surprise
+
+A stone that transforms into a random stone as soon as an actor hits it.
+
+The replacement stone is a random one out of a given selection. You can set
+the @samp{selection} attribute with token of strings. Every string needs either
+to be an @ref{Object Kind} or a tile key prefixed by an equal sign @samp{=}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+ti[&quot;b&quot;] = @{&quot;st_brake&quot;@}
+ti[&quot;d&quot;] = @{&quot;st_death&quot;@}
+ti[&quot;s&quot;] = @{&quot;st_surprise&quot;, selection=@{&quot;st_chess&quot;, &quot;=b&quot;, &quot;=d&quot;, &quot;=d&quot;@}@}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+The replacement stone is randomly chosen out of the given selection. By listing
+a stone several times you can take influence on the likelyhood.
+
+The tile declarations referenced by a key may even contain objects besides
+stone. But you should make rare and proper usage of this feature.
+
+Prior replacing the surprise stone the surprise stone will perform its action. 
+You can use this action to modify the selection or to set objects on your own.
+
+The surprise stone is killed by any replacement stone set to the grid position.
+If your selection does not resolve to a stone you may need to add @ref{&quot;st_nil&quot;}
+to the replacement tile declaration.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Attributes:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{selection}, @ @ @i{values}: tokens of stone kinds and tile keys; @ @ @i{default}: @code{@{&quot;st_grate_cross&quot;, &quot;st_death&quot;, &quot;st_surprise&quot;, &quot;st_lightglass_hollow&quot;, &quot;st_knight&quot;, &quot;st_thief&quot;, &quot;st_flat_breakable&quot;, &quot;st_flat_breaking&quot;@}}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Messages:}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Action:} @ @ @xref{target}, @ @ @xref{action}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- Swap Stone --------------------
 @node st_swap
 @subsection st_swap
@@ -10859,6 +11304,37 @@
 @node Transparent Stones
 @subsection Transparent Stones
 
+Enigma provides a collection of transparent stones, all similar, but with
+different features. Some of them may be passed after the use of an
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{it-cherry}, others will be just pushed. Some are transparent for lasers,
+but not all! This table shows their exact properties.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at multitable</A> {st_lightpassenger} {st_lightpassenger_off_plus} {actor is visible:  } {actor is invisible:  } {lasertransparent:  }
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at headitem</A> class @tab kind: @tab actor is visible: @tab actor is invisible: @tab lasertransparent:
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_rawglass} @tab st_rawglass @tab rebound @tab pass @tab yes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_rawglass} @tab st_rawglass_movable @tab push @tab pass @tab yes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_lightglass} @tab st_lightglass @tab rebound @tab pass @tab yes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_lightglass} @tab st_lightglass_movable @tab push @tab push @tab yes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_lightglass} @tab st_lightglass_hollow @tab pass @tab pass @tab yes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_darkglass} @tab st_darkglass @tab rebound @tab pass @tab no
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_darkglass} @tab st_darkglass_movable @tab push @tab push @tab no
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_darkglass} @tab st_darkglass_hollow @tab pass @tab pass @tab yes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_redfiber} @tab st_redfiber @tab rebound @tab rebound @tab yes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_polarswitch} @tab st_polarswitch_on @tab toggle @tab pass @tab yes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_polarswitch} @tab st_polarswitch_off @tab toggle @tab pass @tab no
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_beads} @tab st_beads @tab leave @tab pass @tab no
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_lightpassenger} @tab st_lightpassenger_off @tab rebound @tab rebound @tab no
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> multitable
+
+These entries can be memorized as follows: A stone is transparent for laser 
+light or if it is hollow, but not if it is dark. Exception is @samp{st_beads},
+whose irregular sides would scatter the beam. A stone can always be passed by 
+invisible actors, with three exceptions: @samp{st_redfiber}, whose inside is 
+filled with red stripes, and the two movables @samp{st_lightglass_movable} and 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{st_darkglass_movable} which have a non-glass frame which the actor can
+use to move the stone. @code{st_rawglass_movable} does not have such a frame
+and can not be moved by an invisible actor.
+
 @c ----------------- Breakable Stones --------------------
 @node Breakable Stones
 @subsection Breakable Stones
@@ -13027,9 +13503,16 @@
 &quot;                    &quot;
 @})
 @end example
+A more elaborate example can be found in @ref{Orthogonal Autotiling}.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Caveats:}
+Do not use the hash sign @samp{#} as suffix character for key length 2 and
+above autotiled keys. A key @code{&quot;A#&quot;} could result in an unexpected @samp{%%}
+substitution in the name attribute. A name @code{&quot;sample%%&quot;} would be 
+substituted by @code{&quot;sample%#&quot;} which is a name that will be autonumbered 
+(@pxref{Object Naming}).
 @end table
 
-A more elaborate example can be found in @ref{Orthogonal Autotiling}.
 
 @c ----------------- Composer Resolver --------------------
 
@@ -13037,7 +13520,7 @@
 @subsection res.composer
 
 The composer resolver reduces the number of required tile declarations by
-generating them by composition of base tiles. Small motley levels and nearly
+generating them by composition of base tiles. Even small levels and nearly
 every large level will use many different objects in numerous tile compositions.
 As the usable one character tile key candidates will not suffice you will need
 to use two or three character tile keys. But you will need numerous tile
@@ -13064,10 +13547,15 @@
 
 @b{res.composer}(@i{subresolver})
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{res.composer}(@i{subresolver}, @i{sequence})
+
 @table @asis
 @item @i{subresolver}
 Resolver to which unresolved requests should be forwarded. May be @samp{ti}
 as the final resolver of the resolver chain.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{sequence}
+Search sequence for basic tile declarations given as a string of priority 
+numbers. The sequence defaults to @code{&quot;123456789&quot;}.
 @end table
 
 @item @b{Syntax Samples:}
@@ -13077,27 +13565,65 @@
 
 @item @b{Details:}
 For every key in the map the subresolver will be first requested for a tile
-declaration. Thus any given declaration will preceede the auto composition.
+declaration. Thus any given explicit declaration will preceede the auto 
+composition.
 
 Just in case that no declaration exists the search starts for existing subkey
-tiles. Subkeys are keys with some characters replaced by a whitespace @samp{ }.
-For all key lengths the basic subkeys with just one character different from a
-whitespace will be examined. Additionally just for three character key length
-the three keys with just one whitespace replacement and two remaining
-original characters will be examined and these compositions will preced the
-composition of three one character tiles.
+tiles. Subkeys are keys with all but some characters replaced by a whitespace 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{ }.
 
-Thus for the key @code{&quot;h~&quot;} the composer will look for @code{&quot;h &quot;} and
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at code</A>{&quot; ~&quot;}. For the three character key @code{&quot;#h~&quot;} The composer will look for
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at code</A>{&quot;#h &quot;} plus @code{&quot;  ~&quot;}, @code{&quot;# ~&quot;} plus @code{&quot; h &quot;}, @code{&quot; h~&quot;}
-plus @code{&quot;#  &quot;} and finally @code{&quot;#  &quot;} plus @code{&quot; h &quot;} plus @code{&quot;  ~&quot;}.
-For the 4 character key @code{&quot;A#h~&quot;} the composer will just look for
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at code</A>{&quot;A   &quot;} plus @code{&quot; #  &quot;} plus @code{&quot;  h &quot;} plus @code{&quot;   ~&quot;}. The
-same holds for any larger key length.
+The search sequence is given by the optional second argument and defaults to
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at code</A>{&quot;123456789&quot;}. In the first step all character positions marked by a 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{1} in the sequence string are maintained in the key string and all others
+are replaced by whitespace. In the second step all  character positions marked
+by a @samp{2} in the sequence string are maintained in the key string and all 
+others are replaced by whitespace. This procedure continues until the number
+equals the key length. All generated subkeys are resolved by the subresolver
+and concatenated in the given sequence.
 
-It is recommended to add the composer resolver behind most other library
-resolvers in the resolver chain.
+With the default sequence @code{&quot;123456789&quot;} a key request for @code{&quot;~mX&quot;} is
+resolved to subkeys @code{&quot;~  &quot;}, @code{&quot; m &quot;} and @code{&quot;  X&quot;}. These subkeys
+are resolved by the subresolver. If the subresolver is @samp{ti} the result is:
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+ti[&quot;~  &quot;] .. ti[&quot; m &quot;] .. ti[&quot;  X&quot;]
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+With a key length of 3 or more characters it is sometimes useful to avoid a
+total decomposition into single character based subkeys. E.g. you may want
+to use a @ref{res.autotile} or @ref{res.puzzle} as subresolver. Both have the
+need of essential 2 character subkeys. In this case you can simply define
+the sequence as @code{&quot;122&quot;} for a key length of 3. A key request of 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at code</A>{&quot;~Pa&quot;} will be resolved to subkeys @code{&quot;~  &quot;}, @code{&quot; Pa&quot;}. In case
+of a puzzle subresolver this would result in:
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+ti[&quot;~  &quot;] .. ti[&quot; P&quot;]
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+with second tile declaration being a @ref{st_puzzle} declaration with the
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{connections} attribute being set to @code{&quot;w&quot;} according to the last key
+charcter @samp{a}.
+
+With a @code{&quot;231&quot;} you stick to a total decomposition, but you redefine the
+sequence of evaluation and composition. For the key @code{&quot;~mX&quot;} you would get
+in contrast to the first example:
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+ti[&quot;  X&quot;] .. ti[&quot;~  &quot;] .. ti[&quot; m &quot;]
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+In all cases subkeys, that are strings of whitespaces only, will simply be 
+ignored. With the default sequence the key @code{&quot;~ X&quot;} will result just in:
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
+ti[&quot;~  &quot;] .. ti[&quot;  X&quot;]
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
+
+If you set your floors by usage of the composer you should use the all 
+whitespace key as your default floor as this key does not resolve via the
+composer and needs the backup of the default mechanism.
+
 @item @b{Full Example:}
 @example
 ti[&quot;  &quot;] = @{&quot;fl_sahara&quot;@}
@@ -13123,12 +13649,13 @@
 local resolver = res.composer(ti)
 
 w, h = wo(resolver, &quot;  &quot;, @{
-&quot;                                        &quot;,
-&quot;  h= ;W;2;c G~ ~# #.2.X X~k=k;          &quot;,
-&quot;                                        &quot;,
-&quot;  2;s;    2.s.    2=s=                  &quot;,
-&quot;  c;h;    c.h.    c=h=    xx            &quot;,
-&quot;                                        &quot;
+--0001020304050607080910111213141516171819
+ &quot;                                        &quot;,
+ &quot;  h= ;W;2;c G~ ~# #.2.X X~k=k;          &quot;,
+ &quot;                                        &quot;,
+ &quot;  2;s;    2.s.    2=s=                  &quot;,
+ &quot;  c;h;    c.h.    c=h=    xx            &quot;,
+ &quot;                                        &quot;
 @})
 @end example
 

Modified: trunk/src/items/SurpriseItem.cc
===================================================================
--- trunk/src/items/SurpriseItem.cc	2009-02-23 23:41:52 UTC (rev 1554)
+++ trunk/src/items/SurpriseItem.cc	2009-02-25 23:44:43 UTC (rev 1555)
@@ -27,7 +27,7 @@
 
 namespace enigma {
 
-/* -------------------- Surprise stone -------------------- */
+/* -------------------- Surprise item -------------------- */
     SurpriseItem::SurpriseItem() : Item() {
     }
     


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000984.html">[Enigma-game-svn] r1554 - in trunk: data data/schemas src src/items	src/others src/stones
</A></li>
	<LI>Next message: <A HREF="000986.html">[Enigma-game-svn] r1556 - in homepage: . input
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#985">[ date ]</a>
              <a href="thread.html#985">[ thread ]</a>
              <a href="subject.html#985">[ subject ]</a>
              <a href="author.html#985">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
