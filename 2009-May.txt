From a_abraham at mail.berlios.de  Fri May  1 17:23:45 2009
From: a_abraham at mail.berlios.de (a_abraham at mail.berlios.de)
Date: Fri, 1 May 2009 17:23:45 +0200
Subject: [Enigma-game-svn] r1651 - trunk/src
Message-ID: <200905011523.n41FNjer028414@sheep.berlios.de>

Author: a_abraham
Date: 2009-05-01 17:23:43 +0200 (Fri, 01 May 2009)
New Revision: 1651

Modified:
   trunk/src/Makefile.am
Log:
Fixed filename for case sensitive filesystems.

Modified: trunk/src/Makefile.am
===================================================================
--- trunk/src/Makefile.am	2009-04-29 21:23:16 UTC (rev 1650)
+++ trunk/src/Makefile.am	2009-05-01 15:23:43 UTC (rev 1651)
@@ -340,7 +340,7 @@
 	stones/GlassStones.cc	\
 	stones/GlassStones.hh	\
 	stones/GreenBrownStone.cc	\
-	stones/GreenBrownSTone.hh	\
+	stones/GreenBrownStone.hh	\
 	stones/IceBlock.cc	\
 	stones/IceBlock.hh	\
 	stones/JambStone.cc	\



From ral at mail.berlios.de  Fri May  1 22:46:04 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Fri, 1 May 2009 22:46:04 +0200
Subject: [Enigma-game-svn] r1652 - in trunk: data src src/floors src/items
	src/stones
Message-ID: <200905012046.n41Kk4A4013887@sheep.berlios.de>

Author: ral
Date: 2009-05-01 22:46:03 +0200 (Fri, 01 May 2009)
New Revision: 1652

Modified:
   trunk/data/models-2d.lua
   trunk/src/floors/SimpleFloors.cc
   trunk/src/floors/SimpleFloors.hh
   trunk/src/items.hh
   trunk/src/items/Crack.cc
   trunk/src/items/Extinguisher.cc
   trunk/src/items/SimpleItems.cc
   trunk/src/items/SimpleItems.hh
   trunk/src/lua.cc
   trunk/src/stones/IceBlock.cc
Log:
Trunk 1.1:
- fl_yinyang - special support for bogus st_chameleon
- it_debris - new variant it_debris_water, used by it_crack_water
- position - make a pure value:
  - disallow set of single coordinates - ASSERT on write attemps
- st_ice: explode bombs on ice being pushed onto them

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/data/models-2d.lua	2009-05-01 20:46:03 UTC (rev 1652)
@@ -647,6 +647,8 @@
     DefAnim("it_crack_abyss_anim", frames)
     
     local images = DefSubimages("it_crack_water", {h=8})
+    local frames = BuildFrames(images,50)
+    DefAnim("it_debris_water", frames)
 
     local frames = BuildFrames({"it_crack_water4", "it_crack_water5", "it_crack_water6", "it_crack_water7", "it_crack_water8"},120)
     DefAnim("it_crack_water_anim", frames)

Modified: trunk/src/floors/SimpleFloors.cc
===================================================================
--- trunk/src/floors/SimpleFloors.cc	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/src/floors/SimpleFloors.cc	2009-05-01 20:46:03 UTC (rev 1652)
@@ -117,6 +117,13 @@
         return "fl_yinyang";
     }
     
+    const char *YinyangFloor::get_kind() const {   //just for st_chameleon support
+        if (state == YIN)
+           return (objFlags & OBJBIT_INVISIBLE) ? "fl_yinyang_yin_invisible" : "fl_yinyang_yin";
+        else
+           return (objFlags & OBJBIT_INVISIBLE) ? "fl_yinyang_yang_invisible" : "fl_yinyang_yang";
+    }
+    
     void YinyangFloor::setAttr(const std::string &key, const Value &val) {
         if (key == "invisible") {
             objFlags = (objFlags & ~OBJBIT_INVISIBLE) | (val.to_bool() ? OBJBIT_INVISIBLE : 0);

Modified: trunk/src/floors/SimpleFloors.hh
===================================================================
--- trunk/src/floors/SimpleFloors.hh	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/src/floors/SimpleFloors.hh	2009-05-01 20:46:03 UTC (rev 1652)
@@ -129,6 +129,7 @@
 
         // Object interface
         virtual std::string getClass() const;
+        virtual const char *get_kind() const;
         virtual void setAttr(const std::string &key, const Value &val);
         virtual Value getAttr(const std::string &key) const;
         

Modified: trunk/src/items/Crack.cc
===================================================================
--- trunk/src/items/Crack.cc	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/src/items/Crack.cc	2009-05-01 20:46:03 UTC (rev 1652)
@@ -64,7 +64,7 @@
             return Value();
         } else if (m.message == "heat" || m.message == "_explosion" || m.message == "_cannonball") {
             sound_event("crack");
-            replace("it_debris");
+            replace(objFlags & OBJBIT_TYP ? "it_debris_water" : "it_debris");
             return true;
         } else if (m.message == "_freeze") {
             kill();   // The ice repairs the floor

Modified: trunk/src/items/Extinguisher.cc
===================================================================
--- trunk/src/items/Extinguisher.cc	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/src/items/Extinguisher.cc	2009-05-01 20:46:03 UTC (rev 1652)
@@ -91,7 +91,7 @@
     }
     
     int Extinguisher::traitsIdx() const {
-        return state;
+        return ecl::Clamp<int>(state, 0, 2);
     }
     
     ItemTraits Extinguisher::traits[3] = {

Modified: trunk/src/items/SimpleItems.cc
===================================================================
--- trunk/src/items/SimpleItems.cc	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/src/items/SimpleItems.cc	2009-05-01 20:46:03 UTC (rev 1652)
@@ -107,11 +107,12 @@
 
 /* -------------------- Debris -------------------- */
 
-    Debris::Debris() {
+    Debris::Debris(int type) {
+        state = type;
     }
     
     void Debris::animcb() { 
-        SetFloor(get_pos(), MakeFloor("fl_abyss"));
+        SetFloor(get_pos(), MakeFloor(state == 0 ? "fl_abyss" : "fl_water"));
         kill();
      }
 
@@ -120,9 +121,15 @@
         return false;
     }
 
-    DEF_ITEMTRAITSF(Debris, "it_debris", it_debris,
-                itf_static | itf_animation | itf_indestructible | itf_fireproof);
+    int Debris::traitsIdx() const {
+        return ecl::Clamp<int>(state, 0, 1);
+    }
     
+    ItemTraits Debris::traits[2] = {
+        {"it_debris", it_debris,  itf_static | itf_animation | itf_indestructible | itf_fireproof, 0.0},
+        {"it_debris_water", it_debris_water,  itf_static | itf_animation | itf_indestructible | itf_fireproof, 0.0},
+    };
+    
 /* -------------------- Explosion -------------------- */
 
     Explosion::Explosion(int strength) {
@@ -170,6 +177,10 @@
         return false;
     }
      
+    int Explosion::traitsIdx() const {
+        return ecl::Clamp<int>(state, 0, 3);
+    }
+    
     ItemTraits Explosion::traits[4] = {
         {"it_explosion_nil",  it_explosion_nil, itf_static | itf_animation | itf_indestructible | itf_norespawn | itf_fireproof, 0.0},
         {"it_explosion_hollow",  it_explosion_hollow, itf_static | itf_animation | itf_indestructible | itf_norespawn | itf_fireproof, 0.0},
@@ -338,7 +349,7 @@
     }
     
     int Spring::traitsIdx() const {
-        return state;
+        return ecl::Clamp<int>(state, 0, 1);
     }
     
     ItemTraits Spring::traits[2] = {
@@ -455,7 +466,8 @@
         BootRegister(new Cherry(), "it_cherry");
         BootRegister(new Coffee(), "it_coffee");
         BootRegister(new DeathItem(), "it_death");
-        BootRegister(new Debris(), "it_debris");
+        BootRegister(new Debris(0), "it_debris");
+        BootRegister(new Debris(1), "it_debris_water");
         BootRegister(new Explosion(0), "it_explosion");
         BootRegister(new Explosion(0), "it_explosion_nil");
         BootRegister(new Explosion(1), "it_explosion_hollow");

Modified: trunk/src/items/SimpleItems.hh
===================================================================
--- trunk/src/items/SimpleItems.hh	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/src/items/SimpleItems.hh	2009-05-01 20:46:03 UTC (rev 1652)
@@ -100,16 +100,19 @@
      */
     class Debris : public Item {
         CLONEOBJ(Debris);
-        DECL_ITEMTRAITS;
+        DECL_ITEMTRAITS_ARRAY(2, traitsIdx());
 
     public:
-        Debris();
+        Debris(int type);
         
         // ModelCallback interface
         virtual void animcb();
 
         // Item interface
         virtual bool actor_hit(Actor *a);
+        
+    private:
+        int traitsIdx() const;
     };
 
     /**
@@ -117,7 +120,7 @@
      */
     class Explosion : public Item {
         CLONEOBJ(Explosion);
-        DECL_ITEMTRAITS_ARRAY(4, state);
+        DECL_ITEMTRAITS_ARRAY(4, traitsIdx());
 
     public:
         Explosion(int strength);
@@ -137,6 +140,9 @@
         
         // Item interface
         virtual bool actor_hit(Actor *a);
+        
+    private:
+        int traitsIdx() const;
     };
     
     /**

Modified: trunk/src/items.hh
===================================================================
--- trunk/src/items.hh	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/src/items.hh	2009-05-01 20:46:03 UTC (rev 1652)
@@ -59,6 +59,7 @@
         it_cross,
         it_death,
         it_debris,
+        it_debris_water,
         it_document,
         it_drop,
         it_dynamite,

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/src/lua.cc	2009-05-01 20:46:03 UTC (rev 1652)
@@ -1961,20 +1961,17 @@
     }
      
     if ((keyType == LUA_TSTRING) && ((keyStr == "x") || (keyStr == "y"))) {
-//    if (((keyType == LUA_TSTRING) &&
-//            ((keyStr == "x") || (keyStr == "y"))) || 
-//            ((keyType == LUA_TNUMBER) && ((keyNum == 1) || (keyNum == 2)))) {
-        lua_getmetatable(L, 1);
-        lua_pushvalue(L, -2);
-        if (keyStr == "x") {
-//        if (((keyType == LUA_TSTRING) && (keyStr == "x")) ||
-//                 ((keyType == LUA_TNUMBER) && (keyNum == 1))) {
-            lua_rawseti(L, -2, 1);
-            return 0;
-        } else {
-            lua_rawseti(L, -2, 2);
-            return 0;
-        }
+        throwLuaError(L, "Invalid position modification of x or y coordinate");
+        return 0;
+//        lua_getmetatable(L, 1);
+//        lua_pushvalue(L, -2);
+//        if (keyStr == "x") {
+//            lua_rawseti(L, -2, 1);
+//            return 0;
+//        } else {
+//            lua_rawseti(L, -2, 2);
+//            return 0;
+//        }
     }
     
     throwLuaError(L, "Invalid position index");

Modified: trunk/src/stones/IceBlock.cc
===================================================================
--- trunk/src/stones/IceBlock.cc	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/src/stones/IceBlock.cc	2009-05-01 20:46:03 UTC (rev 1652)
@@ -76,7 +76,10 @@
             SetFloor(get_pos(), MakeFloor("fl_ice"));
         }
         Stone::on_move(origin);
-        return false;
+        
+        // deny all item actions on stone move besides bomb explosions
+        itd = GetItem(get_pos());
+        return (itd != NULL && itd->isKind("it_bomb"));
     }
     
     void IceBlock::setNoAbyssFloor(const GridPos &p, std::string kind) const {



From a_abraham at mail.berlios.de  Fri May  1 23:14:06 2009
From: a_abraham at mail.berlios.de (a_abraham at mail.berlios.de)
Date: Fri, 1 May 2009 23:14:06 +0200
Subject: [Enigma-game-svn] r1653 - in trunk: lib-src/lua tools
Message-ID: <200905012114.n41LE6BH018363@sheep.berlios.de>

Author: a_abraham
Date: 2009-05-01 23:14:03 +0200 (Fri, 01 May 2009)
New Revision: 1653

Modified:
   trunk/lib-src/lua/tolua++.h
   trunk/lib-src/lua/tolua_is.c
   trunk/lib-src/lua/tolua_map.c
   trunk/tools/tolua.c
Log:
Added const directive to fix compiler warnings.



Modified: trunk/lib-src/lua/tolua++.h
===================================================================
--- trunk/lib-src/lua/tolua++.h	2009-05-01 20:46:03 UTC (rev 1652)
+++ trunk/lib-src/lua/tolua++.h	2009-05-01 21:14:03 UTC (rev 1653)
@@ -59,7 +59,7 @@
 #define TOLUA_NOPEER	LUA_REGISTRYINDEX /* for lua 5.1 */
 
 TOLUA_API const char* tolua_typename (lua_State* L, int lo);
-TOLUA_API void tolua_error (lua_State* L, char* msg, tolua_Error* err);
+TOLUA_API void tolua_error (lua_State* L, const char* msg, tolua_Error* err);
 TOLUA_API int tolua_isnoobj (lua_State* L, int lo, tolua_Error* err);
 TOLUA_API int tolua_isvalue (lua_State* L, int lo, int def, tolua_Error* err);
 TOLUA_API int tolua_isboolean (lua_State* L, int lo, int def, tolua_Error* err);
@@ -90,16 +90,16 @@
 TOLUA_API int tolua_register_gc (lua_State* L, int lo);
 TOLUA_API int tolua_default_collect (lua_State* tolua_S);
 
-TOLUA_API void tolua_usertype (lua_State* L, char* type);
-TOLUA_API void tolua_beginmodule (lua_State* L, char* name);
+TOLUA_API void tolua_usertype (lua_State* L, const char* type);
+TOLUA_API void tolua_beginmodule (lua_State* L, const char* name);
 TOLUA_API void tolua_endmodule (lua_State* L);
-TOLUA_API void tolua_module (lua_State* L, char* name, int hasvar);
-TOLUA_API void tolua_class (lua_State* L, char* name, char* base);
-TOLUA_API void tolua_cclass (lua_State* L, char* lname, char* name, char* base, lua_CFunction col);
-TOLUA_API void tolua_function (lua_State* L, char* name, lua_CFunction func);
-TOLUA_API void tolua_constant (lua_State* L, char* name, double value);
-TOLUA_API void tolua_variable (lua_State* L, char* name, lua_CFunction get, lua_CFunction set);
-TOLUA_API void tolua_array (lua_State* L,char* name, lua_CFunction get, lua_CFunction set);
+TOLUA_API void tolua_module (lua_State* L, const char* name, int hasvar);
+TOLUA_API void tolua_class (lua_State* L, const char* name, const char* base);
+TOLUA_API void tolua_cclass (lua_State* L, const char* lname, const char* name, const char* base, lua_CFunction col);
+TOLUA_API void tolua_function (lua_State* L, const char* name, lua_CFunction func);
+TOLUA_API void tolua_constant (lua_State* L, const char* name, double value);
+TOLUA_API void tolua_variable (lua_State* L, const char* name, lua_CFunction get, lua_CFunction set);
+TOLUA_API void tolua_array (lua_State* L, const char* name, lua_CFunction get, lua_CFunction set);
 
 /* TOLUA_API void tolua_set_call_event(lua_State* L, lua_CFunction func, char* type); */
 /* TOLUA_API void tolua_addbase(lua_State* L, char* name, char* base); */

Modified: trunk/lib-src/lua/tolua_is.c
===================================================================
--- trunk/lib-src/lua/tolua_is.c	2009-05-01 20:46:03 UTC (rev 1652)
+++ trunk/lib-src/lua/tolua_is.c	2009-05-01 21:14:03 UTC (rev 1653)
@@ -85,7 +85,7 @@
 	return lua_tostring(L,-1);
 }
 
-TOLUA_API void tolua_error (lua_State* L, char* msg, tolua_Error* err)
+TOLUA_API void tolua_error (lua_State* L, const char* msg, tolua_Error* err)
 {
 	if (msg[0] == '#')
 	{

Modified: trunk/lib-src/lua/tolua_map.c
===================================================================
--- trunk/lib-src/lua/tolua_map.c	2009-05-01 20:46:03 UTC (rev 1652)
+++ trunk/lib-src/lua/tolua_map.c	2009-05-01 21:14:03 UTC (rev 1653)
@@ -25,7 +25,7 @@
 /* Create metatable
 	* Create and register new metatable
 */
-static int tolua_newmetatable (lua_State* L, char* name)
+static int tolua_newmetatable (lua_State* L, const char* name)
 {
 	int r = luaL_newmetatable(L,name);
 
@@ -389,7 +389,7 @@
 	* It creates the correspoding metatable in the registry, for both 'type' and 'const type'.
 	* It maps 'const type' as being also a 'type'
 */
-TOLUA_API void tolua_usertype (lua_State* L, char* type)
+TOLUA_API void tolua_usertype (lua_State* L, const char* type)
 {
  char ctype[128] = "const ";
  strncat(ctype,type,120);
@@ -403,7 +403,7 @@
 /* Begin module
 	* It pushes the module (or class) table on the stack
 */
-TOLUA_API void tolua_beginmodule (lua_State* L, char* name)
+TOLUA_API void tolua_beginmodule (lua_State* L, const char* name)
 {
 	if (name)
 	{
@@ -426,7 +426,7 @@
 	* It creates a new module
 */
 #if 1
-TOLUA_API void tolua_module (lua_State* L, char* name, int hasvar)
+TOLUA_API void tolua_module (lua_State* L, const char* name, int hasvar)
 {
 	if (name)
 	{
@@ -462,7 +462,7 @@
 	lua_pop(L,1);               /* pop module */
 }
 #else
-TOLUA_API void tolua_module (lua_State* L, char* name, int hasvar)
+TOLUA_API void tolua_module (lua_State* L, const char* name, int hasvar)
 {
 	if (name)
 	{
@@ -518,7 +518,7 @@
 /* Map C class
 	* It maps a C class, setting the appropriate inheritance and super classes.
 */
-TOLUA_API void tolua_cclass (lua_State* L, char* lname, char* name, char* base, lua_CFunction col)
+TOLUA_API void tolua_cclass (lua_State* L, const char* lname, const char* name, const char* base, lua_CFunction col)
 {
 	char cname[128] = "const ";
 	char cbase[128] = "const ";
@@ -577,7 +577,7 @@
 /* Map function
 	* It assigns a function into the current module (or class)
 */
-TOLUA_API void tolua_function (lua_State* L, char* name, lua_CFunction func)
+TOLUA_API void tolua_function (lua_State* L, const char* name, lua_CFunction func)
 {
  lua_pushstring(L,name);
  lua_pushcfunction(L,func);
@@ -600,7 +600,7 @@
 /* Map constant number
 	* It assigns a constant number into the current module (or class)
 */
-TOLUA_API void tolua_constant (lua_State* L, char* name, double value)
+TOLUA_API void tolua_constant (lua_State* L, const char* name, double value)
 {
 	lua_pushstring(L,name);
 	tolua_pushnumber(L,value);
@@ -611,7 +611,7 @@
 /* Map variable
 	* It assigns a variable into the current module (or class)
 */
-TOLUA_API void tolua_variable (lua_State* L, char* name, lua_CFunction get, lua_CFunction set)
+TOLUA_API void tolua_variable (lua_State* L, const char* name, lua_CFunction get, lua_CFunction set)
 {
 	/* get func */
 	lua_pushstring(L,".get");
@@ -663,7 +663,7 @@
 /* Map an array
 	* It assigns an array into the current module (or class)
 */
-TOLUA_API void tolua_array (lua_State* L, char* name, lua_CFunction get, lua_CFunction set)
+TOLUA_API void tolua_array (lua_State* L, const char* name, lua_CFunction get, lua_CFunction set)
 {
 	lua_pushstring(L,".get");
 	lua_rawget(L,-2);

Modified: trunk/tools/tolua.c
===================================================================
--- trunk/tools/tolua.c	2009-05-01 20:46:03 UTC (rev 1652)
+++ trunk/tools/tolua.c	2009-05-01 21:14:03 UTC (rev 1653)
@@ -56,7 +56,7 @@
  fprintf(stderr, "%s (written by W. Celes, A. Manzur)\n",TOLUA_VERSION);
 }
 
-static void setfield (lua_State* L, int table, char* f, char* v)
+static void setfield (lua_State* L, int table, const char* f, const char* v)
 {
  lua_pushstring(L,f);
  lua_pushstring(L,v);



From a_abraham at mail.berlios.de  Fri May  1 23:34:44 2009
From: a_abraham at mail.berlios.de (a_abraham at mail.berlios.de)
Date: Fri, 1 May 2009 23:34:44 +0200
Subject: [Enigma-game-svn] r1654 - in trunk: intl po
Message-ID: <200905012134.n41LYiVg021412@sheep.berlios.de>

Author: a_abraham
Date: 2009-05-01 23:34:42 +0200 (Fri, 01 May 2009)
New Revision: 1654

Modified:
   trunk/intl/Makefile.in
   trunk/po/Makefile.in.in
Log:
Added datarootdir for autoconf


Modified: trunk/intl/Makefile.in
===================================================================
--- trunk/intl/Makefile.in	2009-05-01 21:14:03 UTC (rev 1653)
+++ trunk/intl/Makefile.in	2009-05-01 21:34:42 UTC (rev 1654)
@@ -31,6 +31,7 @@
 transform = @program_transform_name@
 libdir = @libdir@
 includedir = @includedir@
+datarootdir = @datarootdir@
 datadir = @datadir@
 localedir = $(datadir)/locale
 gettextsrcdir = $(datadir)/gettext/intl

Modified: trunk/po/Makefile.in.in
===================================================================
--- trunk/po/Makefile.in.in	2009-05-01 21:14:03 UTC (rev 1653)
+++ trunk/po/Makefile.in.in	2009-05-01 21:34:42 UTC (rev 1654)
@@ -23,6 +23,7 @@
 
 prefix = @prefix@
 exec_prefix = @exec_prefix@
+datarootdir = @datarootdir@
 datadir = @datadir@
 localedir = $(datadir)/locale
 gettextsrcdir = $(datadir)/gettext/po



From ral at mail.berlios.de  Sat May  2 00:59:35 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sat, 2 May 2009 00:59:35 +0200
Subject: [Enigma-game-svn] r1655 - trunk/lib-src/lua
Message-ID: <200905012259.n41MxZY9020173@sheep.berlios.de>

Author: ral
Date: 2009-05-02 00:59:34 +0200 (Sat, 02 May 2009)
New Revision: 1655

Modified:
   trunk/lib-src/lua/tolua++.h
   trunk/lib-src/lua/tolua_event.c
   trunk/lib-src/lua/tolua_is.c
   trunk/lib-src/lua/tolua_map.c
   trunk/lib-src/lua/tolua_push.c
   trunk/lib-src/lua/tolua_to.c
Log:
Trunk 1.1:
- upgrade tolua++ 1.0.93


Modified: trunk/lib-src/lua/tolua++.h
===================================================================
--- trunk/lib-src/lua/tolua++.h	2009-05-01 21:34:42 UTC (rev 1654)
+++ trunk/lib-src/lua/tolua++.h	2009-05-01 22:59:34 UTC (rev 1655)
@@ -20,7 +20,7 @@
 #define TOLUA_API extern
 #endif
 
-#define TOLUA_VERSION "tolua++-1.0.92"
+#define TOLUA_VERSION "tolua++-1.0.93"
 
 #ifdef __cplusplus
 extern "C" {
@@ -32,8 +32,12 @@
 #define tolua_iscppstringarray tolua_isstringarray
 #define tolua_pushfieldcppstring(L,lo,idx,s) tolua_pushfieldstring(L, lo, idx, s.c_str())
 
-#define TEMPLATE_BIND(p)
+#ifndef TEMPLATE_BIND
+ #define TEMPLATE_BIND(p)
+#endif
+
 #define TOLUA_TEMPLATE_BIND(p)
+
 #define TOLUA_PROTECTED_DESTRUCTOR
 #define TOLUA_PROPERTY_TYPE(p)
 
@@ -62,6 +66,7 @@
 TOLUA_API void tolua_error (lua_State* L, const char* msg, tolua_Error* err);
 TOLUA_API int tolua_isnoobj (lua_State* L, int lo, tolua_Error* err);
 TOLUA_API int tolua_isvalue (lua_State* L, int lo, int def, tolua_Error* err);
+TOLUA_API int tolua_isvaluenil (lua_State* L, int lo, tolua_Error* err);
 TOLUA_API int tolua_isboolean (lua_State* L, int lo, int def, tolua_Error* err);
 TOLUA_API int tolua_isnumber (lua_State* L, int lo, int def, tolua_Error* err);
 TOLUA_API int tolua_isstring (lua_State* L, int lo, int def, tolua_Error* err);
@@ -97,35 +102,35 @@
 TOLUA_API void tolua_class (lua_State* L, const char* name, const char* base);
 TOLUA_API void tolua_cclass (lua_State* L, const char* lname, const char* name, const char* base, lua_CFunction col);
 TOLUA_API void tolua_function (lua_State* L, const char* name, lua_CFunction func);
-TOLUA_API void tolua_constant (lua_State* L, const char* name, double value);
+TOLUA_API void tolua_constant (lua_State* L, const char* name, lua_Number value);
 TOLUA_API void tolua_variable (lua_State* L, const char* name, lua_CFunction get, lua_CFunction set);
-TOLUA_API void tolua_array (lua_State* L, const char* name, lua_CFunction get, lua_CFunction set);
+TOLUA_API void tolua_array (lua_State* L,const char* name, lua_CFunction get, lua_CFunction set);
 
 /* TOLUA_API void tolua_set_call_event(lua_State* L, lua_CFunction func, char* type); */
 /* TOLUA_API void tolua_addbase(lua_State* L, char* name, char* base); */
 
 TOLUA_API void tolua_pushvalue (lua_State* L, int lo);
 TOLUA_API void tolua_pushboolean (lua_State* L, int value);
-TOLUA_API void tolua_pushnumber (lua_State* L, double value);
+TOLUA_API void tolua_pushnumber (lua_State* L, lua_Number value);
 TOLUA_API void tolua_pushstring (lua_State* L, const char* value);
 TOLUA_API void tolua_pushuserdata (lua_State* L, void* value);
 TOLUA_API void tolua_pushusertype (lua_State* L, void* value, const char* type);
 TOLUA_API void tolua_pushusertype_and_takeownership(lua_State* L, void* value, const char* type);
 TOLUA_API void tolua_pushfieldvalue (lua_State* L, int lo, int index, int v);
 TOLUA_API void tolua_pushfieldboolean (lua_State* L, int lo, int index, int v);
-TOLUA_API void tolua_pushfieldnumber (lua_State* L, int lo, int index, double v);
+TOLUA_API void tolua_pushfieldnumber (lua_State* L, int lo, int index, lua_Number v);
 TOLUA_API void tolua_pushfieldstring (lua_State* L, int lo, int index, const char* v);
 TOLUA_API void tolua_pushfielduserdata (lua_State* L, int lo, int index, void* v);
 TOLUA_API void tolua_pushfieldusertype (lua_State* L, int lo, int index, void* v, const char* type);
 TOLUA_API void tolua_pushfieldusertype_and_takeownership (lua_State* L, int lo, int index, void* v, const char* type);
 
-TOLUA_API double tolua_tonumber (lua_State* L, int narg, double def);
+TOLUA_API lua_Number tolua_tonumber (lua_State* L, int narg, lua_Number def);
 TOLUA_API const char* tolua_tostring (lua_State* L, int narg, const char* def);
 TOLUA_API void* tolua_touserdata (lua_State* L, int narg, void* def);
 TOLUA_API void* tolua_tousertype (lua_State* L, int narg, void* def);
 TOLUA_API int tolua_tovalue (lua_State* L, int narg, int def);
 TOLUA_API int tolua_toboolean (lua_State* L, int narg, int def);
-TOLUA_API double tolua_tofieldnumber (lua_State* L, int lo, int index, double def);
+TOLUA_API lua_Number tolua_tofieldnumber (lua_State* L, int lo, int index, lua_Number def);
 TOLUA_API const char* tolua_tofieldstring (lua_State* L, int lo, int index, const char* def);
 TOLUA_API void* tolua_tofielduserdata (lua_State* L, int lo, int index, void* def);
 TOLUA_API void* tolua_tofieldusertype (lua_State* L, int lo, int index, void* def);
@@ -156,6 +161,30 @@
 
 TOLUA_API int tolua_fast_isa(lua_State *L, int mt_indexa, int mt_indexb, int super_index);
 
+#ifndef Mtolua_new
+#define Mtolua_new(EXP) new EXP
+#endif
+
+#ifndef Mtolua_delete
+#define Mtolua_delete(EXP) delete EXP
+#endif
+
+#ifndef Mtolua_new_dim
+#define Mtolua_new_dim(EXP, len) new EXP[len]
+#endif
+
+#ifndef Mtolua_delete_dim
+#define Mtolua_delete_dim(EXP) delete [] EXP
+#endif
+
+#ifndef tolua_outside
+#define tolua_outside
+#endif
+
+#ifndef tolua_owned
+#define tolua_owned
+#endif
+
 #ifdef __cplusplus
 }
 #endif

Modified: trunk/lib-src/lua/tolua_event.c
===================================================================
--- trunk/lib-src/lua/tolua_event.c	2009-05-01 21:34:42 UTC (rev 1654)
+++ trunk/lib-src/lua/tolua_event.c	2009-05-01 22:59:34 UTC (rev 1655)
@@ -371,7 +371,30 @@
 
 static int class_eq_event (lua_State* L)
 {
-	return do_operator(L,".eq");
+	/* copying code from do_operator here to return false when no operator is found */
+	if (lua_isuserdata(L,1))
+	{
+		/* Try metatables */
+		lua_pushvalue(L,1);                     /* stack: op1 op2 */
+		while (lua_getmetatable(L,-1))
+		{                                       /* stack: op1 op2 op1 mt */
+			lua_remove(L,-2);                      /* stack: op1 op2 mt */
+			lua_pushstring(L,".eq");                  /* stack: op1 op2 mt key */
+			lua_rawget(L,-2);                      /* stack: obj key mt func */
+			if (lua_isfunction(L,-1))
+			{
+				lua_pushvalue(L,1);
+				lua_pushvalue(L,2);
+				lua_call(L,2,1);
+				return 1;
+			}
+			lua_settop(L,3);
+		}
+	}
+
+	lua_settop(L, 3);
+	lua_pushboolean(L, 0);
+	return 1;
 }
 
 /*

Modified: trunk/lib-src/lua/tolua_is.c
===================================================================
--- trunk/lib-src/lua/tolua_is.c	2009-05-01 21:34:42 UTC (rev 1654)
+++ trunk/lib-src/lua/tolua_is.c	2009-05-01 22:59:34 UTC (rev 1655)
@@ -212,15 +212,6 @@
 	err->type = "[no object]";
  return 0;
 }
-TOLUA_API int tolua_isvalue (lua_State* L, int lo, int def, tolua_Error* err)
-{
-	if (def || abs(lo)<=lua_gettop(L))  /* any valid index */
-		return 1;
-	err->index = lo;
-	err->array = 0;
-	err->type = "value";
-	return 0;
-}
 
 TOLUA_API int tolua_isboolean (lua_State* L, int lo, int def, tolua_Error* err)
 {
@@ -295,6 +286,29 @@
 	return 0;
 }
 
+TOLUA_API int tolua_isvaluenil (lua_State* L, int lo, tolua_Error* err) {
+
+	if (lua_gettop(L)<abs(lo))
+		return 0; /* somebody else should chack this */
+	if (!lua_isnil(L, lo))
+		return 0;
+	
+	err->index = lo;
+	err->array = 0;
+	err->type = "value";
+	return 1;
+};
+
+TOLUA_API int tolua_isvalue (lua_State* L, int lo, int def, tolua_Error* err)
+{
+	if (def || abs(lo)<=lua_gettop(L))  /* any valid index */
+		return 1;
+	err->index = lo;
+	err->array = 0;
+	err->type = "value";
+	return 0;
+}
+
 TOLUA_API int tolua_isusertype (lua_State* L, int lo, const char* type, int def, tolua_Error* err)
 {
 	if (def && lua_gettop(L)<abs(lo))

Modified: trunk/lib-src/lua/tolua_map.c
===================================================================
--- trunk/lib-src/lua/tolua_map.c	2009-05-01 21:34:42 UTC (rev 1654)
+++ trunk/lib-src/lua/tolua_map.c	2009-05-01 22:59:34 UTC (rev 1655)
@@ -600,7 +600,7 @@
 /* Map constant number
 	* It assigns a constant number into the current module (or class)
 */
-TOLUA_API void tolua_constant (lua_State* L, const char* name, double value)
+TOLUA_API void tolua_constant (lua_State* L, const char* name, lua_Number value)
 {
 	lua_pushstring(L,name);
 	tolua_pushnumber(L,value);

Modified: trunk/lib-src/lua/tolua_push.c
===================================================================
--- trunk/lib-src/lua/tolua_push.c	2009-05-01 21:34:42 UTC (rev 1654)
+++ trunk/lib-src/lua/tolua_push.c	2009-05-01 22:59:34 UTC (rev 1655)
@@ -27,7 +27,7 @@
  lua_pushboolean(L,value);
 }
 
-TOLUA_API void tolua_pushnumber (lua_State* L, double value)
+TOLUA_API void tolua_pushnumber (lua_State* L, lua_Number value)
 {
  lua_pushnumber(L,value);
 }
@@ -133,7 +133,7 @@
 }
 
 
-TOLUA_API void tolua_pushfieldnumber (lua_State* L, int lo, int index, double v)
+TOLUA_API void tolua_pushfieldnumber (lua_State* L, int lo, int index, lua_Number v)
 {
  lua_pushnumber(L,index);
  tolua_pushnumber(L,v);

Modified: trunk/lib-src/lua/tolua_to.c
===================================================================
--- trunk/lib-src/lua/tolua_to.c	2009-05-01 21:34:42 UTC (rev 1654)
+++ trunk/lib-src/lua/tolua_to.c	2009-05-01 22:59:34 UTC (rev 1655)
@@ -17,7 +17,7 @@
 #include <string.h>
 #include <stdlib.h>
 
-TOLUA_API double tolua_tonumber (lua_State* L, int narg, double def)
+TOLUA_API lua_Number tolua_tonumber (lua_State* L, int narg, lua_Number def)
 {
  return lua_gettop(L)<abs(narg) ? def : lua_tonumber(L,narg);
 }
@@ -71,7 +71,7 @@
  return lua_gettop(L)<abs(narg) ?  def : lua_toboolean(L,narg);
 }
 
-TOLUA_API double tolua_tofieldnumber (lua_State* L, int lo, int index, double def)
+TOLUA_API lua_Number tolua_tofieldnumber (lua_State* L, int lo, int index, lua_Number def)
 {
  double v;
  lua_pushnumber(L,index);



From a_abraham at mail.berlios.de  Sat May  2 15:38:49 2009
From: a_abraham at mail.berlios.de (a_abraham at mail.berlios.de)
Date: Sat, 2 May 2009 15:38:49 +0200
Subject: [Enigma-game-svn] r1656 - trunk/src
Message-ID: <200905021338.n42DcnCc009645@sheep.berlios.de>

Author: a_abraham
Date: 2009-05-02 15:38:47 +0200 (Sat, 02 May 2009)
New Revision: 1656

Modified:
   trunk/src/d_models.cc
   trunk/src/editor.cc
   trunk/src/main.cc
Log:
Fixed compiler warnings in fprintf

Modified: trunk/src/d_models.cc
===================================================================
--- trunk/src/d_models.cc	2009-05-01 22:59:34 UTC (rev 1655)
+++ trunk/src/d_models.cc	2009-05-02 13:38:47 UTC (rev 1656)
@@ -228,7 +228,7 @@
     if (lua::DoSysFile(L, "compat.lua") != lua::NO_LUAERROR) {
         std::string message = ecl::strf("Error loading 'compat.lua'\nError: '%s'\n",
                 lua::LastError(L).c_str());
-        fprintf(stderr, message.c_str());
+        fprintf(stderr, "%s", message.c_str());
         gui::ErrorMenu m(message + 
                 _("\n\nThis error may cause the application to behave strange!")
                 , N_("Continue"));
@@ -241,7 +241,7 @@
     if (lua::DoSysFile(L, vminfo->initscript) != lua::NO_LUAERROR) {
         std::string message = ecl::strf("Error loading '%s'\nError: '%s'\n",
                 fname.c_str(), lua::LastError(L).c_str());
-        fprintf(stderr, message.c_str());
+        fprintf(stderr, "%s", message.c_str());
         gui::ErrorMenu m(message + 
                 _("\n\nThis error may cause the application to behave strange!")
                 , N_("Continue"));

Modified: trunk/src/editor.cc
===================================================================
--- trunk/src/editor.cc	2009-05-01 22:59:34 UTC (rev 1655)
+++ trunk/src/editor.cc	2009-05-02 13:38:47 UTC (rev 1656)
@@ -211,11 +211,11 @@
     // TODO - just printing a message is not enough - the app will crash on missing editor.lua
     if (lua::DoSysFile(m_lua, "compat.lua") != lua::NO_LUAERROR) {
         std::string message = "While processing 'compat.lua':\n" +lua::LastError(m_lua);
-        fprintf( stderr, message.c_str() );
+        fprintf( stderr, "%s\n", message.c_str() );
     }
     if (lua::DoSysFile(m_lua, "editor.lua") != lua::NO_LUAERROR) {
         std::string message = "Error loading 'editor.lua'\n" +lua::LastError(m_lua);
-        fprintf( stderr, message.c_str() );
+        fprintf( stderr, "%s\n", message.c_str() );
     }
 }
 

Modified: trunk/src/main.cc
===================================================================
--- trunk/src/main.cc	2009-05-01 22:59:34 UTC (rev 1655)
+++ trunk/src/main.cc	2009-05-02 13:38:47 UTC (rev 1656)
@@ -283,7 +283,7 @@
     // initialize preferences -- needs LUA, XML
     if (!options::Load()) {
         fprintf(stderr, _("Error in configuration file.\n"));
-      	fprintf(stderr, lua::LastError (lua::GlobalState()).c_str());
+      	fprintf(stderr, "%s\n", lua::LastError (lua::GlobalState()).c_str());
     }     
     prefs = PreferenceManager::instance();
     



From ral at mail.berlios.de  Sun May  3 00:12:51 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sun, 3 May 2009 00:12:51 +0200
Subject: [Enigma-game-svn] r1657 - trunk/doc/reference
Message-ID: <200905022212.n42MCpGk030986@sheep.berlios.de>

Author: ral
Date: 2009-05-03 00:12:39 +0200 (Sun, 03 May 2009)
New Revision: 1657

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
. Chapter 5 Lua API additions

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-05-02 13:38:47 UTC (rev 1656)
+++ trunk/doc/reference/enigma-ref.texi	2009-05-02 22:12:39 UTC (rev 1657)
@@ -3659,10 +3659,14 @@
 * Basic Lua Examples::
 * API 2 Overview::
 * Advanced Lua Examples::
+* Introduction Datatypes::
 * Position::
 * Object::
 * Group::
 * NamedObjects::
+* PositionList::
+* Positions::
+* Functions::
 * Tile::
 * Tiles::
 * World::
@@ -4112,6 +4116,8 @@
 @table @asis
 @item @b{position:}@ @ @xref{Position}
 A position within the world that can be described by an x and y coordinate.
+ at item @b{positions:} @i{preset variable:} @code{@b{po}}; @ @ @xref{Positions}
+The singleton type of the repository of all named positions.
 @item @b{object:}@ @ @xref{Object}
 An Enigma object like a stone, item, floor, other. Any object is a position, too.
 @item @b{group:}@ @ @xref{Group}
@@ -4133,11 +4139,11 @@
 @end table
 @end table
 
-Please note the three handles @samp{no}, @samp{ti} and @samp{wo}. You have
-noticed two of them in the previous section @ref{Basic Lua Examples}. These
-are three variables, that are preset prior the level code gets executed.
+Please note the four handles @samp{po}, @samp{no}, @samp{ti} and @samp{wo}. You
+have noticed two of them in the previous section @ref{Basic Lua Examples}. These
+are four variables, that are preset prior the level code gets executed.
 
-API 2 uses generally two character names for frequently used variables and
+API 2 uses mainly two character names for frequently used variables and
 functions to shorten the level code and to make it better readable. Authors
 should try to use either single characters or names that are three characters or
 longer for private variable names.
@@ -4220,6 +4226,13 @@
 @var{pos_centered1} ~= @var{pos_centered2}    -- Lua's inequality operator
 @end example
 Position can be easily compared to equality.
+
+ at item @b{Position existence}
+ at example
+ at var{pos}:exists()
+ at end example
+ at samp{true} if a position is a valid position of the world. All positions 
+outside of the world return @samp{false}.
 @end table
 
 @c ----------------- Attribute Tasks --------------------
@@ -5086,11 +5099,316 @@
 by the same code as lines 65 to 68. Note that is essential that we stored and
 kept the used wire permutation in the variable @samp{wire_p}.
 
+ at c ----------------- Introduction Datatypes --------------------
+
+ at node Introduction Datatypes
+ at section Introduction Datatypes
+
+In the following subchapters we will describe the datatypes, their operators
+and methods, and global functions in detail. We need some syntax and
+conventions for an efficient description.
+
+The following short names, and those derived by appending a number, do always
+represent a value of the corresponding type:
+ at itemize @bullet
+ at item pos - @ref{Position}
+ at item obj - @ref{Object}
+ at item polist - @ref{PositionList}
+ at item group - @ref{Group}
+ at item cpos - constant position, a table with two numbers like @{2, 3@}
+ at end itemize
+
+On syntax descriptions of datatype operators or methods we need to list allowed
+argument types. Often several types are possible and you are allowed to choose
+any of a list. In these cases we enlist the types enclosed by @samp{<} and
+ at samp{>} and separated by @samp{|}. These characters are not part of the
+operator or method itself and should thus not be typed into the level code. Note
+that we keep square braces @samp{[}, @samp{]} and curly braces @samp{@{},
+ at samp{@}} as literal Lua symbols. When these braces appear in the syntax you 
+need to type them in the code. E.g. the following syntax rule:
+
+ at example
+result = @var{pos} + <@var{pos} | @var{obj} | @var{cpos} | @var{polist}>
+ at end example
+
+allows you to write any of the follwing lines in your level
+
+ at example
+ at var{result} = @var{pos} + @var{pos}
+ at var{result} = @var{pos} + @var{obj}
+ at var{result} = @var{pos} + @var{cpos}
+ at var{result} = @var{pos} + @var{polist}
+ at end example
+
+But a syntax rule like
+
+ at example
+x = pos["x"]
+ at end example
+
+requires the Lua square bracktes to be coded literally. Of course you are
+still free to name your position variable and the resulting value variable
+whatever you like.
+
+Another most important aspect of Lua data types is the difference between
+values and references. Values are numbers, booleans like @samp{true} and
+ at samp{false}, strings and @samp{nil}. The only reference data type is the Lua
+table.
+
+Values are always constant. They can never be modified. You assign a value to
+a variable. On calculations you may assign another value to the same variable.
+But the original value does never get modified. That should be obvious if you
+think of values like @samp{true} or numbers like @samp{7}. But it is even true
+for strings like @code{"hello"}. When you append two string you get a new
+string. But the components themselves do not change. All "string modifying"
+methods do return a new string with the resulting value. Thus a variable
+containing the value of the original string still contains the unmodified value.
+
+Tables are of a totally opposite nature. They represent data containers. In Lua
+you are just handling references to these containers. When you add or change
+a value within the container the table reference remains unmodified but the table
+contents changes. Thus two variable containing both references two the same
+table will afterwards both reference the same modified table.
+
+We will denote for every new data type the character of being a value or a
+reference. If you are unfamilar to the resulting effects you may want to read
+the appendix about @ref{Caveats}.
+
+ at cindex polymorphism
+You may have noticed that in many operations you can use an @ref{Object} as
+a @ref{Position}. This is due to the fact that objects support most of the
+position features as well. Objects are no positions, but they do speak the
+same language. This feature is called @samp{polymorphism} and helps you to
+simplify your code significantly. In the follwing subchapters you should
+carefully look at the syntax to understand which types of arguments do fit in
+seamlessly.
+
+ at cindex overloading
+The number of usable operators is limited by Lua. Thus an addition of two data
+by the @samp{+} operator causes different actions depending on the involved data
+themselves. An addition of two positions results in an vectorial addition. But
+the addition of two groups results in a join of the groups. This reusage of a
+single operator is called @samp{overloading}.
+
+Overloading combined with polymorphism can cause situations that are ambiguos
+by design. E.g. we decided to allow the addition of a position with an object
+resulting in the vectorial addition of the objects position to the first one.
+At the same time we want to be able to join an object with an existing group
+by usage of the @samp{+} operator. But what should be the result of an addition
+of two objects? The vectorial addition of their positions, or the join of both
+objects in a new group? Either makes sense and would be useful. In this case
+we decided for the first possibility as the minus operation as the vectorial
+difference between two objects is a very important feature. Anyway you can 
+always force the operation of your choice to be applied by transforming one
+object either into a position or a group. Please read carefully the given
+syntax rules for a clear understanding of the results.
+
 @c ----------------- Position --------------------
 
 @node Position
 @section Position
 
+A position is a Lua userdata type introduced by Enigma to handle world positions
+as introduced in @ref{World's Shape and Coordinates}. A position is a value
+and thus constant. Once a position is created it can not be modified anymore.
+But you can calculate with positions by usage of operators. When you add two
+position values you receive the resulting position as a new value. 
+
+In contrast to @ref{Object}s positions have an unlimited lifetime and will never
+cease to exist. Thus you can store position values in a global variables and
+keep them as long as you need. The values are constant and will not change even
+if the objects from which they have been derived have meanwhile moved to another
+grid or even been killed.
+
+Position values are not limited to valid world coordinates. Both coordinates
+can take every positive or negative number and zero, too. Thus you can calculate
+with positions and use them to express offsets between two other positions.
+
+Positions are are created by the @ref{Positions} singleton handle, that allows
+you to convert coordinates, objects, position constants into positions. The
+handle allows you to retrieve existing named positions, too. Furtheron positions
+are implicitly created as return values of many operations.
+
+Let us look at the supported operators:
+
+ at table @asis
+ at item @b{Addition/Subtraction:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{pos} <@b{+}|@b{-}> <@i{pos} | @i{obj} | @i{cpos} | @i{polist}>
+
+result = <@i{pos} | @i{obj} | @i{cpos} | @i{polist}> <@b{+}|@b{-}> @i{pos}
+
+ at item @b{Details:}
+When a position is added to or subtracted from another position or data 
+convertable to a position the result is the position value representing the 
+vectorial addition or difference of both arguments.
+
+If a position is added to subtracted from a position list a new list is created
+with the positions representing the sum or difference of the position with every
+member of the supplied position list.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpos} = @i{po}(3, 4) + @{1, 2@}              -- = po(4, 6)
+ at var{newpos} = @var{myobject} - @i{po}(1, 5)
+ at var{newpolist} = @i{po}(2, 3) + @var{NEIGHBORS_4}      -- po(1, 3) .. po(2, 4) .. po(3, 3) .. po(2, 2)
+ at var{newpolist} = @i{po}["@var{myfloor}#*"] - @i{po}(3, 0)
+ at end example
+ at end table
+
+ at item @b{Multiplication/Division:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{pos} <@b{*}|@b{/}> @i{number}
+
+result = @i{number} @b{*} @i{pos}
+
+ at item @b{Details:}
+A scalar multiplication or division of a position vector. A position value 
+with both coordinate values multiplicated or divided by the given number
+is returned.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpos} = 3 * @i{po}(3, 4)   -- = po(9, 12)
+ at var{newpos} = @i{po}(2, 3) / 2   -- = po(1, 1.5)
+ at end example
+ at end table
+
+ at item @b{Sign:}
+ at table @asis
+ at item @b{Syntax:}
+result = - at i{pos}
+
+ at item @b{Details:}
+An unary scalar multiplication of a position vector with @samp{-1}. A new 
+position value with both coordinate values multiplicated by @samp{-1} is returned.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpos} = - at i{po}(3, 4)   -- = po(-3, -4)
+ at end example
+ at end table
+
+ at item @b{Center:}
+ at table @asis
+ at item @b{Syntax:}
+result = #@i{pos}
+
+ at item @b{Details:}
+A rounding of a position vector to the center of the grid. A new position value
+with coordinates of the center of the containing grid position is returned.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpos} = #@i{po}(3, 4)   -- = po(3.5, 4.5)
+ at end example
+ at end table
+
+ at item @b{Equality/Inequality:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{pos1} <==|~=> @i{pos2}
+
+ at item @b{Details:}
+A comparison of two position values. Two position values are equal if both
+coordinates are equal. Otherwise they are unequal. If you want to know whether
+two positions point to the same grid, you may want to round both position prior
+comparison. You can round either to the center or to the grid by usage of
+the position operator @samp{#} or the method @samp{grid()}.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{bool} = @i{po}(3, 4) == @i{po}(@{3, 4@})  -- = true
+ at var{bool} = @i{po}(3, 4) == @i{po}(4, 3)    -- = false
+ at var{bool} = @i{po}(3, 4) ~= @i{po}(4, 3)    -- = true
+ at end example
+ at end table
+
+ at item @b{Join:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{pos1} .. <@i{pos2} | @i{polist}> 
+
+result = <@i{pos1} | @i{polist}> .. @i{pos2}
+
+ at item @b{Details:}
+Joins two positions or a position with an exting @ref{PositionList} to a new
+PositionList containing all positions in the given order.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpolist} = @i{po}(3, 4) .. @i{po}(4, 4)
+ at end example
+ at end table
+
+ at item @b{Coordinate Access:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{pos}["x"]
+
+result = @i{pos}["y"]
+
+result1, result2 = @i{pos}:xy()
+
+ at item @b{Details:}
+The single coordinates of a position can be read anytime. You can retrieve
+single coordinates by Lua square bracket index access. Of course you can use
+the Lua alternative dot index access syntax, too (see examples). If you want
+to evaluate both coordinates, you can make use of the method @samp{xy()}, that
+returns both numbers at once in a Lua multiple assignment.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{number} = @i{po}(3, 4)["x"]            -- = 3
+ at var{number} = @i{po}(3, 4).x               -- = 3
+ at var{number} = @i{po}(3, 4)["y"]            -- = 4
+ at var{number} = @i{po}(3, 4).y               -- = 4
+ at var{number1}, @var{number2} = @i{po}(3, 4):xy()  -- = 3, 4
+ at end example
+ at end table
+
+ at item @b{Grid Rounding:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{pos}:grid()
+
+ at item @b{Details:}
+Returns a new position value that points to the upper left corner of the grid
+that contains the position itself.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpos} = @i{po}(3.2, 4.7):grid()    -- = 3, 4
+ at var{newpos} = @i{po}(-2.4, -5.0):grid()  -- = -3, -5
+ at end example
+ at end table
+
+ at item @b{Existence:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{pos}:exists()
+
+ at item @b{Details:}
+Checks if the position is part of the world and returns @samp{true} if it is 
+contained. Otherwise @samp{false} is returned. 
+
+Note that the @ref{Object}s @samp{exists} method reports the existence of the
+object. Evaluation of @samp{po(obj):exists()} may result in @samp{false} for
+exisiting objects. E.g. this result occurs for @ref{Items} currently being part
+of a player's inventory. The item exists, but is not part of the world. But
+items contained in a bag placed in the world will report the same position as
+the bag.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{boolean} = @i{po}(3.2, 4.7):exists()
+ at end example
+ at end table
+ at end table
+
+
 @c ----------------- Object --------------------
 
 @node Object
@@ -5106,6 +5424,21 @@
 @node NamedObjects
 @section NamedObjects
 
+ at c ----------------- PositionList --------------------
+
+ at node PositionList
+ at section PositionList
+
+ at c ----------------- Positions --------------------
+
+ at node Positions
+ at section Positions
+
+ at c ----------------- Functions --------------------
+
+ at node Functions
+ at section Functions
+
 @c ----------------- Tile --------------------
 
 @node Tile
@@ -5354,7 +5687,7 @@
 a few objects have need of names and will otherwise be named by the engine with
 unique names.
 
-Note that is attribute is not listed in the individual object descriptions.
+Note that this attribute is not listed in the individual object descriptions.
 
 @table @asis
 @item @b{Type:} @ @ string
@@ -5824,7 +6157,7 @@
 @item @samp{OFF} = @code{0}, all switch like objects
 @item @samp{ON} = @code{1}, all switch like objects
 @item @samp{CLOSED} = @code{0}, all door like objects
- at item @samp{OPEN} = @code{0}, all door like objects
+ at item @samp{OPEN} = @code{1}, all door like objects
 @item @samp{IDLE} = @code{0}, other objects in the default passiv state
 @item @samp{ACTIVE} = @code{1}, other objects in the active state
 @item @samp{OXYDPAIR} = @code{2}, just by @ref{st_oxyd}
@@ -6981,7 +7314,6 @@
 @item @b{Access:} @ @ currently none - just by variants kind string on some floors
 @end table
 
->>>>>>> .r1644
 @c ----------------- Standard Floor --------------------
 @node Standard Floors
 @section Standard Floors
@@ -10871,7 +11203,6 @@
 
 @item @b{scissor}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}
 Rubberband cutting behaviour on teleporting.
-
 @item @b{freezable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: @code{read only} @ @ @xref{freezable}
 @item @b{liftable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: @code{read only} @ @ @xref{liftable}
 @item @b{portable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: @code{read only} @ @ @xref{portable}



From raoul at mail.berlios.de  Sun May  3 19:44:25 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sun, 3 May 2009 19:44:25 +0200
Subject: [Enigma-game-svn] r1658 - in trunk/data/levels: enigma_cross
	enigma_ii enigma_iii enigma_iv enigma_oxyd enigma_v enigma_viii
Message-ID: <200905031744.n43HiPmD008316@sheep.berlios.de>

Author: raoul
Date: 2009-05-03 19:44:23 +0200 (Sun, 03 May 2009)
New Revision: 1658

Added:
   trunk/data/levels/enigma_ii/duffy48_2.xml
   trunk/data/levels/enigma_iii/martin89_2.xml
   trunk/data/levels/enigma_iv/duffy82_2.xml
   trunk/data/levels/enigma_iv/wb01_4.xml
   trunk/data/levels/enigma_v/luc31_3.xml
   trunk/data/levels/enigma_v/spaceman01_3.xml
   trunk/data/levels/enigma_viii/devnull11_1.xml
Removed:
   trunk/data/levels/enigma_ii/duffy48_1.xml
   trunk/data/levels/enigma_iii/martin89_1.xml
   trunk/data/levels/enigma_iv/duffy82_1.xml
   trunk/data/levels/enigma_iv/wb01_3.xml
   trunk/data/levels/enigma_v/luc31_2.xml
   trunk/data/levels/enigma_v/spaceman01_2.xml
Modified:
   trunk/data/levels/enigma_cross/enigma0_92_2.xml
   trunk/data/levels/enigma_cross/enigma0_92_3.xml
   trunk/data/levels/enigma_cross/newlevels.xml
   trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
   trunk/data/levels/enigma_ii/index.xml
   trunk/data/levels/enigma_iii/index.xml
   trunk/data/levels/enigma_iv/index.xml
   trunk/data/levels/enigma_oxyd/oxyd28_1.xml
   trunk/data/levels/enigma_v/index.xml
   trunk/data/levels/enigma_viii/index.xml
   trunk/data/levels/enigma_viii/raoul33_1.xml
Log:
-> New rewritings
-> Typos
-> A new level ("2+2")


Modified: trunk/data/levels/enigma_cross/enigma0_92_2.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_2.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_cross/enigma0_92_2.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15200" network="false" owner="Enigma Team" release="1" revision="34" title="Enigma 0.92 - 2"/>
+  <info enigma="1.00" group="Facets" location="15200" network="false" owner="Enigma Team" release="1" revision="35" title="Enigma 0.92 - 2"/>
 
   <attributes/>
 
@@ -10,7 +10,7 @@
     <level _seq="2" _title="Three Plugs" _xpath="enigma_i/martin83_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin83" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="3" _title="The Far Side" _xpath="enigma_ii/martin75_2" author="Martin Hawlisch" ctrl="force" easy="true" id="martin75" rel="2" rev="5" score="2" target="time" unit="duration"/>
     <level _seq="4" _title="Over the Ditch" _xpath="enigma_i/martin78_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin78" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="5" _title="Spidering Around Death" _xpath="enigma_iii/martin89_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin89" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="5" _title="Spidering Around Death" _xpath="enigma_iii/martin89_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin89" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="6" _title="Brittle Floor!" _xpath="enigma_iii/martin91_1" author="Martin Hawlisch" ctrl="force" easy="true" id="martin91" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="7" _title="Alcatraz" _xpath="enigma_vi/ralf14_1" author="Ralf Westram" ctrl="force" easy="true" id="ralf14" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Snakes" _xpath="enigma_i/duffy19_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy19" rel="1" rev="1" score="1" target="time" unit="duration"/>
@@ -128,7 +128,7 @@
     <level _seq="120" _title="Washing Machine" _xpath="enigma_ii/duffy45_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy45" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="121" _title="No Jumping Necessary" _xpath="enigma_i/duffy46_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy46" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="122" _title="Cage The Lions" _xpath="enigma_i/duffy47_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy47" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="123" _title="Blocks and Grates" _xpath="enigma_ii/duffy48_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy48" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="123" _title="Blocks and Grates" _xpath="enigma_ii/duffy48_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy48" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="124" _title="Sacrifice" _xpath="enigma_iii/duffy49_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy49" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="125" _title="Take Turns" _xpath="enigma_v/duffy50_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy50" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="126" _title="Stranded" _xpath="enigma_v/duffy51_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy51" rel="2" rev="4" score="2" target="time" unit="duration"/>
@@ -158,7 +158,7 @@
     <level _seq="150" _title="Where is it?" _xpath="enigma_iv/barry02_1" author="Barry &amp; Lori Mead" ctrl="force" easy="false" id="barry02" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="151" _title="Tool Time" _xpath="enigma_ii/barry03_1" author="Barry &amp; Lori Mead" ctrl="force" easy="false" id="barry03" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="152" _title="(Counter)Clockwise" _xpath="enigma_i/wb13_1" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb13" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="153" _title="Hurry!" _xpath="enigma_iv/wb01_3" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb1" rel="3" rev="2" score="3" target="time" unit="duration"/>
+    <level _seq="153" _title="Hurry!" _xpath="enigma_iv/wb01_4" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb1" rel="4" rev="3" score="3" target="time" unit="duration"/>
     <level _seq="154" _title="Lotsa Triggers" _xpath="enigma_iii/wb03_1" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb3" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="155" _title="Annoying little balls" _xpath="enigma_i/wb09_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb9" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="156" _title="Bridge Builders" _xpath="enigma_iii/wb04_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb4" rel="2" rev="1" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/enigma0_92_3.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_3.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_cross/enigma0_92_3.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15300" network="false" owner="Enigma Team" release="1" revision="23" title="Enigma 0.92 - 3"/>
+  <info enigma="1.00" group="Facets" location="15300" network="false" owner="Enigma Team" release="1" revision="24" title="Enigma 0.92 - 3"/>
 
   <attributes/>
 
@@ -14,7 +14,7 @@
     <level _seq="6" _title="Oxyd Maze" _xpath="enigma_i/duffy79_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy79" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="7" _title="Path in the Stars" _xpath="enigma_ii/duffy80_2" author="Jacob Scott" ctrl="force" easy="true" id="duffy80" rel="2" rev="3" score="2" target="time" unit="duration"/>
     <level _seq="8" _title="Listen Carefully" _xpath="enigma_v/duffy81_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy81" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="9" _title="Flood Zone" _xpath="enigma_iv/duffy82_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy82" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="9" _title="Flood Zone" _xpath="enigma_iv/duffy82_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy82" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="10" _title="Fire Safety" _xpath="enigma_iv/duffy83_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy83" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="11" _title="Laser Tricks" _xpath="enigma_iii/duffy84_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy84" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="12" _title="Think Fast" _xpath="enigma_iii/duffy85_2" author="Jacob Scott" ctrl="force" easy="true" id="duffy85" rel="2" rev="3" score="2" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_cross/newlevels.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="41" title="Enigma 1.00 new"/>
+  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="42" title="Enigma 1.00 new"/>
 
   <attributes/>
 
@@ -78,7 +78,7 @@
     <level _seq="70" _title="Changing Positions" _xpath="enigma_iii/luc27_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc27" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="71" _title="Waterworld" _xpath="enigma_iii/illmind11_2" author="illmind" ctrl="force" easy="true" id="illmind11" rel="2" rev="6" score="2" target="time" unit="duration"/>
     <level _seq="72" _title="Wood robbing" _xpath="enigma_iv/alain08_1" author="Alain Busser" ctrl="force" easy="false" id="alain08" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="73" _title="Hurry!" _xpath="enigma_iv/wb01_3" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb1" rel="3" rev="2" score="3" target="time" unit="duration"/>
+    <level _seq="73" _title="Hurry!" _xpath="enigma_iv/wb01_4" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb1" rel="4" rev="3" score="3" target="time" unit="duration"/>
     <level _seq="74" _title="Antimaze" _xpath="enigma_iv/luc02_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc02" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="75" _title="Sierpinski" _xpath="enigma_iv/alain10_1" author="Alain Busser" ctrl="force" easy="false" id="alain10" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="76" _title="The Life Game" _xpath="enigma_iv/alain13_1" author="Alain Busser" ctrl="force" easy="false" id="alain13" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -130,7 +130,7 @@
     <level _seq="122" _title="Gods of Enigma II" _xpath="enigma_v/mp02_1" author="moonpearl" ctrl="force" easy="false" id="mp02" rel="1" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="123" _title="- Meditation -" _xpath="enigma_v/alain14_1" author="Alain Busser" ctrl="force" easy="false" id="alain14" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="124" _title="Frogger" _xpath="enigma_v/luc20_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc20" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="125" _title="Fatal Attraction I" _xpath="enigma_v/spaceman01_2" author="Spaceman" ctrl="force" easy="true" id="spaceman1" rel="2" rev="2" score="2" target="time" unit="duration"/>
+    <level _seq="125" _title="Fatal Attraction I" _xpath="enigma_v/spaceman01_3" author="Spaceman" ctrl="force" easy="true" id="spaceman1" rel="3" rev="3" score="2" target="time" unit="duration"/>
     <level _seq="126" _title="Acoustic Reminiscence" _xpath="enigma_v/andreas25_3" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas25" rel="3" rev="6" score="1" target="time" unit="duration"/>
     <level _seq="127" _title="Fatal Attraction II" _xpath="enigma_v/spaceman02_1" author="Spaceman" ctrl="force" easy="false" id="spaceman2" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="128" _title="Fatal Attraction III" _xpath="enigma_v/spaceman03_1" author="Spaceman" ctrl="force" easy="false" id="spaceman3" rel="1" rev="1" score="1" target="time" unit="duration"/>
@@ -146,7 +146,7 @@
     <level _seq="138" _title="Firefox" _xpath="enigma_v/ral01_3" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060213ral003" rel="3" rev="72" score="3" target="time" unit="duration"/>
     <level _seq="139" _title="You need them" _xpath="enigma_v/raoul11_2" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul11" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="140" _title="Pipes and Plumbing" _xpath="enigma_v/andreas27_1" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas27" rel="1" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="141" _title="The Chamber" _xpath="enigma_v/luc31_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc31" rel="2" rev="2" score="2" target="time" unit="duration"/>
+    <level _seq="141" _title="The Chamber" _xpath="enigma_v/luc31_3" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc31" rel="3" rev="3" score="2" target="time" unit="duration"/>
     <level _seq="142" _title="Spacestation" _xpath="enigma_v/raoul23_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul23" rel="1" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="143" _title="A-way" _xpath="enigma_vi/richi06_2" author="Richi B?tzer" ctrl="force" easy="true" id="richi06" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="144" _title="Toreador" _xpath="enigma_vi/ral02_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060213ral004" rel="1" rev="43" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="48" title="Enigma 1.1 new"/>
+  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="49" title="Enigma 1.1 new"/>
 
   <attributes/>
 
@@ -171,6 +171,7 @@
     <level _seq="163" _title="Pentomino XIV" _xpath="enigma_viii/pento14_1" author="Enigma Team" ctrl="force" easy="false" id="pento14" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="164" _title="Pentomino XV" _xpath="enigma_viii/pento15_1" author="Enigma Team" ctrl="force" easy="false" id="pento15" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="165" _title="Pentomino XVI" _xpath="enigma_viii/pento16_1" author="Enigma Team" ctrl="force" easy="false" id="pento16" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="166" _title="2 + 2" _xpath="enigma_viii/devnull11_1" author="/dev/null" ctrl="force" easy="true" id="devnull11" rel="1" rev="6" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Deleted: trunk/data/levels/enigma_ii/duffy48_1.xml
===================================================================
--- trunk/data/levels/enigma_ii/duffy48_1.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_ii/duffy48_1.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,81 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Blocks and Grates" el:subtitle="" el:id="duffy48"/>
-      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
-      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-rooms_wide=2
-rooms_high=1
-
-levelw=1+(19*rooms_wide)
-levelh=1+(12*rooms_high)
-
-create_world(levelw, levelh)
-
-draw_border("st-greenbrown")
-fill_floor("fl-hay")
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-        if c =="#" then
-            set_stone("st-greenbrown",i-1,line)
-        elseif c == "z" then
-            set_actor("ac-blackball", i-.5,line+.5)
-        elseif c == "o" then
-            oxyd(i-1,line)
-        elseif c == "g" then
-            draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
-        elseif c == "*" then
-            set_stone("st-brownie", i-1, line)
-        elseif c == "+" then
-            set_stone("st-wood", i-1, line)
-        elseif c == "!" then
-            abyss(i-1,line)
-        elseif c == "u" then
-            set_stone("st-bolder-n", i-1,line)
-        elseif c == "d" then
-            set_stone("st-bolder-s", i-1,line)
-        end
-    end
-end
-
--- Floor:  " "
--- Border: "#"
--- Oxyd:   "o"
-
-renderLine(00,"#######################################")
-renderLine(01,"#      ggggggg                     #o##")
-renderLine(02,"#      g     g                     # ##")
-renderLine(03,"#     gg g g gg         ############ ##")
-renderLine(04,"#     +g+g+g+g+         !!!!!!!!!!!!* #")
-renderLine(05,"#     g+ + + +g         ############u##")
-renderLine(06,"#     + + + + +  z   +  ###############")
-renderLine(07,"#     g+ + + +g         ############d##")
-renderLine(08,"#     +g+g+g+g+         !!!!!!!!!!!!* #")
-renderLine(09,"#     gg g g gg         ############ ##")
-renderLine(10,"#      g     g                     # ##")
-renderLine(11,"#      ggggggg                     #o##")
-renderLine(12,"#######################################")
-
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_ii/duffy48_2.xml (from rev 1652, trunk/data/levels/enigma_ii/duffy48_1.xml)
===================================================================
--- trunk/data/levels/enigma_ii/duffy48_1.xml	2009-05-01 20:46:03 UTC (rev 1652)
+++ trunk/data/levels/enigma_ii/duffy48_2.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -0,0 +1,48 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Blocks and Grates" el:subtitle="" el:id="duffy48"/>
+      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
+      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_hay"}
+ti["-"] = {"fl_abyss"}
+ti["#"] = {"st_greenbrown"}
+ti["+"] = {"st_box"}
+ti["*"] = {"st_brownie"}
+ti["X"] = {"st_grate", flavor="cross"}
+ti["^"] = {"st_boulder", orientation=NORTH}
+ti["V"] = {"st_boulder", orientation=SOUTH}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+    "#######################################",
+    "#      XXXXXXX                     #O##",
+    "#      X     X                     # ##",
+    "#     XX X X XX         ############ ##",
+    "#     +X+X+X+X+         ------------* #",
+    "#     X+ + + +X         ############^##",
+    "#     + + + + +  @   +  ###############",
+    "#     X+ + + +X         ############V##",
+    "#     +X+X+X+X+         ------------* #",
+    "#     XX X X XX         ############ ##",
+    "#      X     X                     # ##",
+    "#      XXXXXXX                     #O##",
+    "#######################################"})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_ii/index.xml
===================================================================
--- trunk/data/levels/enigma_ii/index.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_ii/index.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,14 +1,14 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10300" network="false" owner="Enigma Team" release="1" revision="24" title="Enigma II"/>
+  <info enigma="1.00" group="Enigma" location="10300" network="false" owner="Enigma Team" release="1" revision="25" title="Enigma II"/>
 
   <attributes/>
 
   <levels>
     <level _seq="1" _title="Welcome" _xpath="./welcometopack2_2" author="Raoul Bourquin" ctrl="force" easy="true" id="welcometopack2" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="2" _title="Round Trip" _xpath="./martin35_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin35" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="3" _title="Blocks and Grates" _xpath="./duffy48_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy48" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="3" _title="Blocks and Grates" _xpath="./duffy48_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy48" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="4" _title=".-R-.-U-.-N-." _xpath="./martin103_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin103" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="5" _title="Gateway" _xpath="./martin85_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin85" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="6" _title="Sentinels" _xpath="./siegfried23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8d" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_iii/index.xml
===================================================================
--- trunk/data/levels/enigma_iii/index.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_iii/index.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10400" network="false" owner="Enigma Team" release="1" revision="24" title="Enigma III"/>
+  <info enigma="1.00" group="Enigma" location="10400" network="false" owner="Enigma Team" release="1" revision="25" title="Enigma III"/>
 
   <attributes/>
 
@@ -47,7 +47,7 @@
     <level _seq="39" _title="Monster in the Dark" _xpath="./duffy52_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy52" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="40" _title="- Snow White -" _xpath="./ant15_1" author="Petr Machata" ctrl="force" easy="false" id="ant15" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="41" _title="Black Diamond Course" _xpath="./duffy28_1" author="Jacob Scott" ctrl="force" easy="true" id="duffy28" rel="1" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="42" _title="Spidering Around Death" _xpath="./martin89_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin89" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="42" _title="Spidering Around Death" _xpath="./martin89_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin89" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="43" _title="The Ditch" _xpath="./richi01_1" author="Richi B?tzer" ctrl="force" easy="false" id="richi01" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="44" _title="Rush Hour Traffic" _xpath="./duffy62_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy62" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="45" _title="The Turtle" _xpath="./ant05_1" author="Petr Machata" ctrl="force" easy="false" id="ant05" rel="1" rev="1" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_iii/martin89_1.xml
===================================================================
--- trunk/data/levels/enigma_iii/martin89_1.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_iii/martin89_1.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,61 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Spidering Around Death" el:subtitle="" el:id="martin89"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Martin Hawlisch" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Martin Hawlisch</el:copyright>
-      <el:license el:type="GPL version 2" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-levelw = 20
-levelh = 13
-
-create_world(levelw, levelh)
-draw_border("st-rubberband")
-fill_floor("fl-hay")
-
-draw_stones("st-death", {5,5}, {4,0},4)
-draw_stones("st-death", {2,7}, {4,0},4)
-
-oxyd_default_flavor = "d"
-
-oxyd(2,6)
-oxyd(3,6)
-oxyd(4,6)
-oxyd(5,6)
-oxyd(6,6)
-oxyd(7,6)
-oxyd(8,6)
-oxyd(9,6)
-oxyd(10,6)
-oxyd(11,6)
-oxyd(12,6)
-oxyd(13,6)
-oxyd(14,6)
-oxyd(15,6)
-oxyd(16,6)
-oxyd(17,6)
-
-oxyd_shuffle()
-
-st = set_stone("st-rubberband", 10,12)
-ac = set_actor("ac-blackball", 10,11)
-
-AddRubberBand(ac, st, 16,1)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_iii/martin89_2.xml (from rev 1652, trunk/data/levels/enigma_iii/martin89_1.xml)
===================================================================
--- trunk/data/levels/enigma_iii/martin89_1.xml	2009-05-01 20:46:03 UTC (rev 1652)
+++ trunk/data/levels/enigma_iii/martin89_2.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -0,0 +1,46 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Spidering Around Death" el:subtitle="" el:id="martin89"/>
+      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Martin Hawlisch" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Martin Hawlisch</el:copyright>
+      <el:license el:type="GPL version 2" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_hay"}
+ti["#"] = {"st_rubberband", name="rubbers#"}
+ti["D"] = {"st_death"}
+ti["O"] = {"st_oxyd", flavor="d", name="oxyds#"}
+ti["@"] = {"ac_marble_black", name="blackball"}
+
+wo(ti, " ", {
+    "####################",
+    "#                  #",
+    "#                  #",
+    "#                  #",
+    "#                  #",
+    "#    D   D   D   D #",
+    "# OOOOOOOOOOOOOOOO #",
+    "# D   D   D   D    #",
+    "#                  #",
+    "#                  #",
+    "#                  #",
+    "#         @        #",
+    "####################"})
+
+wo:shuffleOxyd({no["oxyds#*"]:sort("linear"), linear=true})
+wo:add({"ot_rubberband", anchor1="blackball", anchor2=no["rubbers#*"]:nearest(no["blackball"]), strength=16.0})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Deleted: trunk/data/levels/enigma_iv/duffy82_1.xml
===================================================================
--- trunk/data/levels/enigma_iv/duffy82_1.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_iv/duffy82_1.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,113 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Flood Zone" el:subtitle="" el:id="duffy82"/>
-      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
-      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2004 Jacob Scott</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-rooms_wide=1
-rooms_high=1
-
-levelw=1+(19*rooms_wide)
-levelh=1+(12*rooms_high)
-
-create_world( levelw, levelh)
-enigma.ConserveLevel = 0
-
-fill_floor("fl-wood", 0,0,levelw,levelh)
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-        if c =="#" then
-            set_stone( "st-greenbrown", i-1, line)
-        elseif c =="%" then
-            set_stone( "st-greenbrown", i-1, line)
-            set_floor("fl-normal",i-1,line)
-        elseif c == "o" then
-            oxyd( i-1, line)
-        elseif c == "*" then
-            set_stone( "st-brownie", i-1, line)
-        elseif c == "!" then
-            abyss(i-1,line)
-        elseif c == "~" then
-            set_floor("fl-water",i-1,line)
-        elseif c=="z" then
-            set_actor("ac-blackball", i-.5,line+.5, {player=0})
-        elseif c == "g" then
-            draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
-        elseif c=="+" then
-            set_stone( "st-wood", i-1, line)
-        elseif c=="=" then
-            set_floor("fl-space",i-1,line)
-        elseif c=="-" then
-            puzzle(i-1,line,PUZ_0101)
-        elseif c=="i" then
-            puzzle(i-1,line,PUZ_1010)
-        elseif c=="4" then
-            puzzle(i-1,line,PUZ_0100)
-        elseif c=="6" then
-            puzzle(i-1,line,PUZ_0001)
-        elseif c=="j" then
-            puzzle(i-1,line,PUZ_1001)
-        elseif c=="/" then
-            puzzle(i-1,line,PUZ_0110)
-        elseif c=="X" then
-            puzzle(i-1,line,PUZ_1111)
-        elseif c=="m" then
-            set_item("it-magicwand",i-1,line)
-        elseif c=="x" then
-            set_floor("fl-normal",i-1,line)
-        elseif c=="S" then
-            set_stone("st-switch",i-1,line,{action="callback",target="funcc1"})
-        end
-    end
-end
-
-renderLine(00,"####################")
-renderLine(01,"#                 S#")
-renderLine(02,"#                  #")
-renderLine(03,"#                  #")
-renderLine(04,"# 6j  %%%%%%%%xxx  #")
-renderLine(05,"#  -  %o+% x  xx%  #")
-renderLine(06,"#z i  % +%     %% m#")
-renderLine(07,"#  -  %o+     x%%  #")
-renderLine(08,"# 4/  %%%%%%%%xxx  #")
-renderLine(09,"#                  #")
-renderLine(10,"#                  #")
-renderLine(11,"#                 S#")
-renderLine(12,"####################")
-
-oxyd_shuffle()
-
-ff1=0
-function funcc1()
-    if ff1==0 then
-        fill_floor("fl-water",7,5,2,3)
-        fill_floor("fl-water",10,5,1,3)
-        set_floor("fl-water",9,7)
-        fill_floor("fl-water",11,6,1,2)
-        fill_floor("fl-water",12,5,2,3)
-        set_floor("fl-water",14,6)
-        ff1=1
-    end
-end
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_iv/duffy82_2.xml (from rev 1650, trunk/data/levels/enigma_iv/duffy82_1.xml)
===================================================================
--- trunk/data/levels/enigma_iv/duffy82_1.xml	2009-04-29 21:23:16 UTC (rev 1650)
+++ trunk/data/levels/enigma_iv/duffy82_2.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -0,0 +1,54 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Flood Zone" el:subtitle="" el:id="duffy82"/>
+      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
+      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2004 Jacob Scott</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+        <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="3" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by /dev/null</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti["  "] = {"fl_wood"}
+ti[" ~"] = {"fl_wood", name="toWater#"}
+ti[" -"] = {"fl_metal_7"}
+ti["# "] = {"st_greenbrown"}
+ti["W "] = {"st_box"}
+ti["S "] = {"st_switch", target = "toggleFloor"}
+ti["m "] = {"it_magicwand"}
+ti["P"] = {"st_puzzle", intensity = 0}
+ti["O "] = {"st_oxyd"}
+ti["@ "] = {"#ac_marble_black"}
+
+w, h = wo(res.composer(res.puzzle(ti, "P")), "  ", {
+    "# # # # # # # # # # # # # # # # # # # # ",
+    "#                                   S # ",
+    "#                                     # ",
+    "#                                     # ",
+    "#   PaPi    # # # # # # # #  - - -    # ",
+    "#     Pe    # O W~#  ~ - ~ ~ - -#     # ",
+    "# @   Pj    #  ~W~#  ~ ~ ~ ~ ~# #   m # ",
+    "#     Pe    # O W~ ~ ~ ~ ~ ~ -# #     # ",
+    "#   PdPf    # # # # # # # #  - - -    # ",
+    "#                                     # ",
+    "#                                     # ",
+    "#                                   S # ",
+    "# # # # # # # # # # # # # # # # # # # # "})
+
+function toggleFloor(value, sender)
+    wo[no["toWater#*"]] = {"fl_water"}
+end
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_iv/index.xml
===================================================================
--- trunk/data/levels/enigma_iv/index.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_iv/index.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10500" network="false" owner="Enigma Team" release="1" revision="38" title="Enigma IV"/>
+  <info enigma="1.00" group="Enigma" location="10500" network="false" owner="Enigma Team" release="1" revision="39" title="Enigma IV"/>
 
   <attributes/>
 
@@ -10,7 +10,7 @@
     <level _seq="2" _title="Happy New Year" _xpath="./duffy76_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy76" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="3" _title="Wood robbing" _xpath="./alain08_1" author="Alain Busser" ctrl="force" easy="false" id="alain08" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="4" _title="Termites" _xpath="./duffy104_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy104" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="5" _title="Hurry!" _xpath="./wb01_3" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb1" rel="3" rev="2" score="3" target="time" unit="duration"/>
+    <level _seq="5" _title="Hurry!" _xpath="./wb01_4" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb1" rel="4" rev="3" score="3" target="time" unit="duration"/>
     <level _seq="6" _title="TNT Shortage?" _xpath="./siegfried74_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried74" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="7" _title="Antimaze" _xpath="./luc02_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc02" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Boulder-Puzzle" _xpath="./duffy06_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy6" rel="2" rev="3" score="1" target="time" unit="duration"/>
@@ -98,7 +98,7 @@
     <level _seq="90" _title="Drunkard's Walk" _xpath="./duffy105_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy105" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="91" _title="Magritte" _xpath="./nat37_1" author="Nat Pryce" ctrl="force" easy="false" id="natmaze6" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="92" _title="Where Am I?" _xpath="./duffy72_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy72" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="93" _title="Flood Zone" _xpath="./duffy82_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy82" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="93" _title="Flood Zone" _xpath="./duffy82_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy82" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="94" _title="Wildfire" _xpath="./duffy63_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy63" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="95" _title="MetaPuzzle" _xpath="./ant03_2" author="Petr Machata" ctrl="force" easy="false" id="ant03" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="96" _title="TODO" _xpath="lib/todo" author="Martin Hawlisch" ctrl="force" easy="false" id="todo" rel="1" rev="1" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_iv/wb01_3.xml
===================================================================
--- trunk/data/levels/enigma_iv/wb01_3.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_iv/wb01_3.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,93 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Hurry!" el:subtitle="" el:id="wb1"/>
-      <el:version el:score="3" el:release="3" el:revision="2" el:status="released"/>
-      <el:author  el:name="Jon 'WB' Sneyers" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Jon 'WB' Sneyers</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="true" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- Nov 2005: Changes in level design, due to new timing engine.
---           Added easy mode (some seconds more time) -- Andreas
-
-cells={}
-
-cells[" "]=cell{{{randomfloor, cell{floor="fl-tigris"}, 3, cell{floor="fl-samba"}, 1, cell{floor="fl-stone"}, 20}}}
-cells["w"]=cell{stone="st-wood"}
-cells["i"]=cell{stone="st-stoneimpulse"}
-cells["X"]=cell{stone="st-stoneimpulse-hollow"}
-
-cells["="]=cell{stone="st-rock5"}
-cells["#"]=cell{stone="st-rock6"}
-cells["."]=cell{floor="fl-abyss"}
-
-cells["&"]=cell{{{oneway, EAST}}}
-cells["%"]=cell{{{oneway, WEST}}}
-
-cells["V"]=cell{parent=cells[" "], stone="st-bolder-s"}
-cells[">"]=cell{parent=cells[" "], stone="st-bolder-e"}
-cells["<"]=cell{parent=cells[" "], stone="st-bolder-w"}
-cells["^"]=cell{parent=cells[" "], stone="st-bolder-n"}
-
-cells["a"]=cell{stone={face="st-door", attr={name="doorA", type="v"}}}
-cells["A"]=cell{item= {face="it-trigger", attr={action="close", target="doorA"}}}
-cells["B"]=cell{item= {face="it-trigger", attr={action="open", target="doorA"}}}
-cells["O"]=cell{actor={face="ac-blackball", attr={player=0}}}
-cells["0"]=oxyd
-
-if difficult then
-  level = {
-     "#iii###0#0#0#0###00#",
-     "#i#ii &        a   0",
-     "#i##i B#0#0#0####00#",
-     "#iO&Xw#iiiiiiiiiiiii",
-     "#i###iii######### Vi",
-     "#iiiii####### Vi# ##",
-     "######### Vi# # # # ",
-     "##### Vi# # # #     ",
-     "# Vi# # # #         ",
-     "# # # #             ",
-     "# #                 ",
-     "#A# # # # # # # # # ",
-     "#i# ^i# ^i# ^i# ^i##",
-  }
-else
-  level = {
-     "#iii###0#0#0#0###00#",
-     "#i#ii &        a   0",
-     "#i##i B#0#0#0####00#",
-     "#iO&Xw#iiiiiiiiiiiii",
-     "#i###iii######### Vi",
-     "#iiiii### Vi# Vi# ##",
-     "##### Vi# # # # # # ",
-     "iii   #         A   ",
-     "i#                #<",
-     ">#                 i",
-     "                   i",
-     " # #i # # # # # # # ",
-     "## ^ii# ^i# ^i# ^i# ",
-  }
-end
-
-oxyd_default_flavor = "c"
-set_default_parent(cells[" "])
-create_world_by_map(level)
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_iv/wb01_4.xml (from rev 1652, trunk/data/levels/enigma_iv/wb01_3.xml)
===================================================================
--- trunk/data/levels/enigma_iv/wb01_3.xml	2009-05-01 20:46:03 UTC (rev 1652)
+++ trunk/data/levels/enigma_iv/wb01_4.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -0,0 +1,78 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Hurry!" el:subtitle="" el:id="wb1"/>
+      <el:version el:score="3" el:release="4" el:revision="3" el:status="released"/>
+      <el:author  el:name="Jon 'WB' Sneyers" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Jon 'WB' Sneyers</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>New API converted by R. Bourquin
+                 Nov 2005: Changes in level design, due to new timing engine.
+                 Added easy mode (some seconds more time) -- Andreas</el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_tigris"}
+ti["."] = {"fl_samba"}
+ti["-"] = {"fl_stone"}
+ti["#"] = {"st_purplegray"}
+ti["&"] = {"st_oneway", orientation=EAST}
+ti["I"] = {"st_stoneimpulse"}
+ti["i"] = {"st_stoneimpulse_hollow"}
+ti["+"] = {"st_box"}
+ti["^"] = {"st_boulder", orientation=NORTH}
+ti[">"] = {"st_boulder", orientation=EAST}
+ti["V"] = {"st_boulder", orientation=SOUTH}
+ti["<"] = {"st_boulder", orientation=WEST}
+ti["|"] = {"st_door", flavor="d", faces="ew", name="door"}
+ti["a"] = {"it_trigger", target="door", action="open"}
+ti["b"] = {"it_trigger", target="door", action="close"}
+ti["O"] = {"st_oxyd", flavor="c"}
+ti["@"] = {"#ac_marble_black"}
+
+if wo["IsDifficult"] then
+    wo(res.random(ti, " ", {{" ", 3}, {".", 1}, {"-", 20}}), " ", {
+    "#III###O#O#O#O###OO#",
+    "#I#II &        |   O",
+    "#I##I a#O#O#O####OO#",
+    "#I@&i+#IIIIIIIIIIIII",
+    "#I###III######### VI",
+    "#IIIII####### VI# ##",
+    "######### VI# # # # ",
+    "##### VI# # # #     ",
+    "# VI# # # #         ",
+    "# # # #             ",
+    "# #                 ",
+    "#b# # # # # # # # # ",
+    "#I# ^I# ^I# ^I# ^I##"})
+else
+    wo(res.random(ti, " ", {{" ", 3}, {".", 1}, {"-", 20}}), " ", {
+    "#III###O#O#O#O###OO#",
+    "#I#II &        |   O",
+    "#I##I a#O#O#O####OO#",
+    "#I@&i+#IIIIIIIIIIIII",
+    "#I###III######### VI",
+    "#IIIII### VI# VI# ##",
+    "##### VI# # # # # # ",
+    "III   #         b   ",
+    "I#                #<",
+    ">#                 I",
+    "                   I",
+    " # #I # # # # # # # ",
+    "## ^II# ^I# ^I# ^I# "})
+end
+
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_oxyd/oxyd28_1.xml
===================================================================
--- trunk/data/levels/enigma_oxyd/oxyd28_1.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_oxyd/oxyd28_1.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -3,7 +3,7 @@
   <el:protected >
     <el:info el:type="level">
       <el:identity el:title="Oxyd 28" el:subtitle="Oxyd 28" el:id="20070104ulf017"/>
-      <el:version el:score="1" el:release="1" el:revision="$Revision: 69 $" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 70 $" el:status="released"/>
       <el:author  el:name="Ulf Stegemann" el:email="ulf-enigma at zeitform.de" el:homepage="http://ulf.zeitform.de"/>
       <el:copyright>Copyright ? 2006 Ulf Stegemann</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -49,7 +49,7 @@
 oxyd_default_flavor = "a"
 create_world_by_map(level)
 oxyd_shuffle()
-enigma.WaterSinkSpeed = 600
+enigma.WaterSinkSpeed = 200
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Modified: trunk/data/levels/enigma_v/index.xml
===================================================================
--- trunk/data/levels/enigma_v/index.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_v/index.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10600" network="false" owner="Enigma Team" release="1" revision="35" title="Enigma V"/>
+  <info enigma="1.00" group="Enigma" location="10600" network="false" owner="Enigma Team" release="1" revision="36" title="Enigma V"/>
 
   <attributes/>
 
@@ -77,7 +77,7 @@
     <level _seq="69" _title="Gods of Enigma II" _xpath="./mp02_1" author="moonpearl" ctrl="force" easy="false" id="mp02" rel="1" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="70" _title="- Meditation -" _xpath="./alain14_1" author="Alain Busser" ctrl="force" easy="false" id="alain14" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="71" _title="Frogger" _xpath="./luc20_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc20" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="72" _title="Fatal Attraction I" _xpath="./spaceman01_2" author="Spaceman" ctrl="force" easy="true" id="spaceman1" rel="2" rev="2" score="2" target="time" unit="duration"/>
+    <level _seq="72" _title="Fatal Attraction I" _xpath="./spaceman01_3" author="Spaceman" ctrl="force" easy="true" id="spaceman1" rel="3" rev="3" score="2" target="time" unit="duration"/>
     <level _seq="73" _title="Acoustic Reminiscence" _xpath="./andreas25_3" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas25" rel="3" rev="6" score="1" target="time" unit="duration"/>
     <level _seq="74" _title="Fatal Attraction II" _xpath="./spaceman02_1" author="Spaceman" ctrl="force" easy="false" id="spaceman2" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="75" _title="Stranded" _xpath="./duffy51_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy51" rel="2" rev="4" score="2" target="time" unit="duration"/>
@@ -101,7 +101,7 @@
     <level _seq="93" _title="You need them" _xpath="./raoul11_2" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul11" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="94" _title="Pipes and Plumbing" _xpath="./andreas27_1" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas27" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="95" _title="You Must Be Kidding" _xpath="./duffy91_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy91" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="96" _title="The Chamber" _xpath="./luc31_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc31" rel="2" rev="2" score="2" target="time" unit="duration"/>
+    <level _seq="96" _title="The Chamber" _xpath="./luc31_3" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc31" rel="3" rev="3" score="2" target="time" unit="duration"/>
     <level _seq="97" _title="Automaton" _xpath="./duffy95_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy95" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="98" _title="Caterpillar" _xpath="./nat15_2" author="Nat Pryce" ctrl="force" easy="true" id="nat15" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="99" _title="Spacestation" _xpath="./raoul23_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul23" rel="1" rev="4" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_v/luc31_2.xml
===================================================================
--- trunk/data/levels/enigma_v/luc31_2.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_v/luc31_2.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,121 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="The Chamber" el:subtitle="" el:id="luc31"/>
-      <el:version el:score="2" el:release="2" el:revision="2" el:status="released"/>
-      <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
-      <el:copyright>Copyright ? 2006 Lukas Sch?ller</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- Created with BlackBallEd
-enigma.ConserveLevel = FALSE
-
-function file_oxyd(x,y,f)
-    oxyd_default_flavor=f
-    oxyd(x,y)
-end
-
-levelh=13
-levelw=20
-
-enigma.SlopeForce=30
-enigma.ElectricForce=30
-
-cells={}
-items={}
-stones={}
-
-stones[" "]=cell{}
-cells[" "]=cell{}
-items[" "]=cell{}
-
-cells["!"]=cell{floor="fl-stwood"}
-stones["!"]=cell{stone="st-blue-sand"}
-stones["#"]=cell{parent={{file_oxyd,"c"}}}
-stones["$"]=cell{stone="st-door-v"}
-items["!"]=cell{item="it-trigger"}
-stones["%"]=cell{stone="st-wood"}
-stones["&"]=cell{stone="st-door-h"}
-
-level={"!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!"}
-itmap={"                    ",
-       "                    ",
-       "                    ",
-       "                    ",
-       "                    ",
-       "       ! !          ",
-       "        ! !         ",
-       "       ! !          ",
-       "        ! !         ",
-       "                    ",
-       "                    ",
-       "                    ",
-       "                    "}
-stmap={"!!!!!!!!!!!!!!!!!!!!",
-       "#                  #",
-       "!    !!!!!!!!!!!   !",
-       "!    $ $ $ $ $ !   !",
-       "!    !!!!!!!!!&!   !",
-       "!    !  % %  ! !   !",
-       "!    ! % %   ! !   !",
-       "!    !  % %  !&!   !",
-       "!    ! % %   $ !   !",
-       "!    !!!!!!!!!!!   !",
-       "!                  !",
-       "#                  #",
-       "!!!!!!!!!!!!!!!!!!!!"}
-
-create_world_by_map(level)
-draw_map(0,0,stmap,stones)
-draw_map(0,0,itmap,items)
-
-SetAttrib(enigma.GetItem(7,5),"invisible",FALSE)
-SetAttrib(enigma.GetItem(7,7),"invisible",FALSE)
-SetAttrib(enigma.GetItem(8,6),"invisible",FALSE)
-SetAttrib(enigma.GetItem(8,8),"invisible",FALSE)
-SetAttrib(enigma.GetItem(9,5),"invisible",FALSE)
-SetAttrib(enigma.GetItem(9,7),"invisible",FALSE)
-SetAttrib(enigma.GetItem(10,6),"invisible",FALSE)
-SetAttrib(enigma.GetItem(10,8),"invisible",FALSE)
-
-Signal ("it(7 5)","st(13 8)")
-Signal ("it(9 5)","st(14 7)")
-Signal ("it(8 6)","st(14 4)")
-Signal ("it(10 6)","st(13 3)")
-Signal ("it(7 7)","st(11 3)")
-Signal ("it(9 7)","st(9 3)")
-Signal ("it(8 8)","st(7 3)")
-Signal ("it(10 8)","st(5 3)")
-
-oxyd_shuffle()
-set_actor("ac-blackball",6.5,5.5)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_v/luc31_3.xml (from rev 1651, trunk/data/levels/enigma_v/luc31_2.xml)
===================================================================
--- trunk/data/levels/enigma_v/luc31_2.xml	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/data/levels/enigma_v/luc31_3.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -0,0 +1,52 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="The Chamber" el:subtitle="" el:id="luc31"/>
+      <el:version el:score="2" el:release="3" el:revision="3" el:status="released"/>
+      <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
+      <el:copyright>Copyright ? 2006 Lukas Sch?ller</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ConserveLevel"] = false
+
+ti[" "] = {"fl_wood_framed"}
+ti["#"] = {"st_bluesand"}
+ti["*"] = {"st_box"}
+ti["trigger"] = {"it_trigger", target="door%%"}
+ti["doorh"] = {"st_door", flavor="d", faces="ns", name="door%%"}
+ti["doorv"] = {"st_door", flavor="d", faces="ew", name="door%%"}
+ti["O"] = {"st_oxyd", flavor="c"}
+ti["@"] = {"#ac_marble_black"}
+
+local resolver = res.autotile(ti, {"a", "h", "trigger"}, {"A", "E", "doorv"}, {"F", "G", "doorh", 6}, {"H", "H", "doorv", 8})
+
+wo(resolver, " ", {
+    "####################",
+    "O                  O",
+    "#    ###########   #",
+    "#    A B C D E #   #",
+    "#    #########F#   #",
+    "#    #@h*g*  # #   #",
+    "#    # *f*e  # #   #",
+    "#    # d*c*  #G#   #",
+    "#    # *b*a  H #   #",
+    "#    ###########   #",
+    "#                  #",
+    "O                  O",
+    "####################"})
+
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Deleted: trunk/data/levels/enigma_v/spaceman01_2.xml
===================================================================
--- trunk/data/levels/enigma_v/spaceman01_2.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_v/spaceman01_2.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,95 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Fatal Attraction I" el:subtitle="" el:id="spaceman1"/>
-      <el:version el:score="2" el:release="2" el:revision="2" el:status="released"/>
-      <el:author  el:name="Spaceman" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2006 Spaceman</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="true" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- Levelcode cleaned by raoul 3.2006
--- !!BBE105!! Do not delete this line
-
-function file_oxyd(x,y,f)
-    oxyd_default_flavor=f
-    oxyd(x,y)
-end
-
-levelh=13
-levelw=20
-
-cells={}
-stones={}
-
-stones[" "]=cell{}
-cells[" "]=cell{}
-
-cells["!"]=cell{floor="fl-normal"}
-
-if difficult then
-    stones["!"]=cell{stone="st-fart"}
-else
-    stones["!"]=cell{stone="st-likeoxydb"}
-end
-stones["#"]=cell{parent={{file_oxyd,"b"}}}
-
-level={"!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!"}
-stmap={"!!!!!!!!!!!!!!!!!!!!",
-       "!                  !",
-       "!                  !",
-       "!                  !",
-       "!       #  #       !",
-       "!      #    #      !",
-       "!     #      #     !",
-       "!    #        #    !",
-       "!   #          #   !",
-       "!  #            #  !",
-       "! #              # !",
-       "!#                #!",
-       "!!!!!!!!!!!!!!!!!!!!"}
-
-create_world_by_map(level)
-draw_map(0,0,stmap,stones)
-
-set_actor("ac-blackball",10.5,1.5,{player=0,name="bb"})
-set_actor("ac-rotor",4.5,11.5,{range=20,force=20,name="rot1",gohome=TRUE})
-set_actor("ac-rotor",15.5,11.5,{range=20,force=20,name="rot2",gohome=TRUE})
-
-AddRubberBand(enigma.GetNamedObject("bb"),enigma.GetNamedObject("rot1"),10,100)
-AddRubberBand(enigma.GetNamedObject("bb"),enigma.GetNamedObject("rot2"),10,100)
-
-set_item("it-document",10,1,{text="text1"})
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-      <el:string el:key="text1">
-        <el:english el:translate="true">Don't get too attracted!</el:english>
-      </el:string> 
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_v/spaceman01_3.xml (from rev 1651, trunk/data/levels/enigma_v/spaceman01_2.xml)
===================================================================
--- trunk/data/levels/enigma_v/spaceman01_2.xml	2009-05-01 15:23:43 UTC (rev 1651)
+++ trunk/data/levels/enigma_v/spaceman01_3.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -0,0 +1,57 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Fatal Attraction I" el:subtitle="" el:id="spaceman1"/>
+      <el:version el:score="2" el:release="3" el:revision="3" el:status="released"/>
+      <el:author  el:name="Spaceman" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2006 Spaceman</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_metal_7"}
+if wo["IsDifficult"] then
+    ti["#"] = {"st_quake"}
+else
+    ti["#"] = {"st_fake_oxydb"}
+end
+ti["O"] = {"st_oxyd", name="left#"}
+ti["o"] = {"st_oxyd", name="right#"}
+ti["r"] = {"ac_rotor", range=20.0, strength=20.0, name="rotor#"}
+ti["@"] = ti({"ac_marble_black", 0.0, 0.5, name="blackball"}) .. {"it_document", text="text1"}
+
+wo(ti, " ", {
+    "####################",
+    "#         @        #",
+    "#                  #",
+    "#                  #",
+    "#       O  o       #",
+    "#      O    o      #",
+    "#     O      o     #",
+    "#    O        o    #",
+    "#   O          o   #",
+    "#  O            o  #",
+    "# O              o #",
+    "#O  r          r  o#",
+    "####################"})
+
+wo:shuffleOxyd({"left#*", "right#*", min=4})
+
+for obj in no["rotor#*"] do
+    wo:add({"ot_rubberband", anchor1=obj, anchor2="blackball", length=100.0, strength=10.0})
+end
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Don't get too attracted!</el:english>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Added: trunk/data/levels/enigma_viii/devnull11_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/devnull11_1.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_viii/devnull11_1.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -0,0 +1,133 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="2 + 2" el:id="devnull11"/>
+      <el:version el:score="1" el:release="1" el:revision="6" el:status="released"/>
+      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2008 dev0</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="true"/>
+      <el:score el:easy="3:00" el:difficult="6:00"/>
+    </el:info>
+    <el:luamain><![CDATA[
+statW = 0
+statB = 0
+
+wo["ConserveLevel"] = false
+wo["ProvideExtralifes"] = false
+
+ti[" ."] = {"fl_dark", friction = 5.5, adhesion = 1.0}
+ti["  "] = {"fl_bridge_gc", state = CLOSED}
+ti[" ~"] = {"fl_abyss"}
+ti["# "] =  {"st_box_rock"}
+ti["blockerBlack"] = {"st_blocker", "blockerB%%#", state = CLOSED}
+ti["blockerWhite"] = ti[" ."] .. {"st_blocker", "blockerW%%#", state = CLOSED}
+ti["bridges"] = {"fl_bridge_gc", "bridges%%#", state = OPEN}
+ti["1 "] = {"st_window_sw",  secure = true}
+ti["2 "] = {"st_window_s",   secure = true}
+ti["3 "] = {"st_window_es",  secure = true}
+ti["4 "] = {"st_window_w",   secure = true}
+ti["6 "] = {"st_window_e",   secure = true}
+ti["7 "] = {"st_window_nw",  secure = true}
+ti["8 "] = {"st_window_n",   secure = true}
+ti["9 "] = {"st_window_ne",  secure = true}
+ti["= "] = {"st_window_ns",  secure = true}
+ti["A "] = {"st_window_new", secure = true}
+ti["F "] = {"st_window_nsw", secure = true}
+ti["H "] = {"st_window_ew",  secure = true}
+ti["U "] = {"st_window_esw", secure = true}
+ti["M "] = {"st_chess_black"}
+ti["N "] = {"st_chess_white"}
+ti[" a"] = ti[" ."] .. {"it_trigger", target = {"blockerW%A#*", "bridges%A#*"}}
+ti[" b"] = ti[" ."] .. {"it_trigger", target = {"blockerW%B#*", "bridges%B#*"}}
+ti[" c"] = ti[" ."] .. {"it_trigger", target = {"blockerW%C#*", "bridges%C#*"}}
+ti[" d"] = ti[" ."] .. {"it_trigger", target = {"blockerW%D#*", "blockerW%E#*"}}
+ti[" e"] = ti[" ."] .. {"it_trigger", target = {"blockerW%D#*", "blockerW%E#*"}}
+ti[" v"] = {"it_trigger", target = {"bridges%X#*",  "bridges%V#*"}}
+ti[" w"] = {"it_trigger", target = {"blockerB%W#*", "bridges%W#*"}}
+ti[" x"] = {"it_trigger", target = {"blockerB%X#*", "bridges%X#*"}}
+ti[" y"] = {"it_trigger", target = "blockerB%Y#*"}
+ti[" z"] = {"it_trigger", target = {"blockerB%Z#*", "bridges%W#*"}}
+ti["o "] = {"st_oxyd", "oxyds1#"}
+ti["O "] = {"st_oxyd", "oxyds3#"}
+ti["p "] = {"st_oxyd", "oxyds2#"}
+ti["P "] = {"st_oxyd", "oxyds4#"}
+ti[" k"] = {"#ac_marble_black", "marbleNE", essential = INDISPENSIBLE}
+ti[" K"] = ti({"fl_bridge_gc", state = CLOSED}) .. ti({"#ac_marble_black", "marbleSW", essential = INDISPENSIBLE})
+ti[" i"] = ti[" ."] .. {"#ac_marble_white", "marbleNW", essential = INDISPENSIBLE}
+ti[" I"] = ti({"fl_dark", friction = 5.5}) .. {"#ac_marble_white", "marbleSE", essential = INDISPENSIBLE}
+if  wo["IsDifficult"] then
+  ti["q."] = ti[" ~"]
+  ti[" :"] = ti[" ~"]
+  ti[" r"] = ti["  "]
+  ti[" R"] = ti["  "]
+  ti[" s"] = ti[" ."]
+  ti[" S"] = ti[" ."]
+else
+  ti["q "] = ti["6 "]
+  ti[" :"] = ti[" ."]
+  ti[" r"] = ti({"fl_bridge_gc", "floorNE#", state = CLOSED}) .. ti({"it_cross", "sensorNE#", target = "toggleMarbles", interval = 0.01, _color = "black"})
+  ti[" R"] = ti({"fl_bridge_gc", "floorSW#", state = CLOSED}) .. ti({"it_cross", "sensorSW#", target = "toggleMarbles", interval = 0.01, _color = "black"})
+  ti[" s"] = ti({"fl_dark", "floorNW#", friction = 5.5, adhesion = 1.0}) .. ti({"it_cross", "sensorNW#", target = "toggleMarbles", interval = 0.01, _color = "white"})
+  ti[" S"] = ti({"fl_dark", "floorSE#", friction = 5.5, adhesion = 1.0}) .. ti({"it_cross", "sensorSE#", target = "toggleMarbles", interval = 0.01, _color = "white"})
+end
+
+local resAutotile = res.autotile(ti, {"B", "blockerBlack"}, {"W", "blockerWhite"}, {"-", "bridges"})
+width, height = wo(res.composer(resAutotile), "  ", {
+  "7.8.7:8s8.8.8:7.8.9.8 8 8 8 8 7 8 7 8 9 ",
+  "4.o.4. . . e8.#. .6.P 7 8 A BX y ~1 P 6 ",
+  "4.WB4. . .q. . .#~6.8     4 8  ~# -V x6 ",
+  "F:2. . . . . .2.1.3.  8   1 N BW z1   3 ",
+  "4.-B1.6. .1. ~4.N.6.  M 8     1 3r  BZ6 ",
+  "H.o. ~-BWE .Mc . b6.  4k  6r          6 ",
+  "1.=.2.3.2.2.2.1s2.3i7I8.9S8.8.8:8.7.8.9.",
+  "4R      2     2  K# 4. a .WC . . .4.O.6.",
+  "4   =       8   M   4.N.6. ~ . . .9.-AA:",
+  "1 BY   v=   = 8 2 2 7.8.9S8. . . . .WA6:",
+  "4 -W9       2 3     4.#.6. . . . :3.-AU:",
+  "4 p  wBZ= 3   -X3 p 4. dWD . . : .4.O.6.",
+  "1R2 2 1 2 2 3 2 2 2 1.2.3.2.2.2.2.1.2.3."
+}) 
+if  wo["IsDifficult"] then
+  wo:shuffleOxyd({"oxyds1#*", "oxyds3#*", max = 0}, {"oxyds2#*",  "oxyds4#*", max = 0})
+else
+  wo:shuffleOxyd({"oxyds1#*", min = 1}, {"oxyds2#*",  min = 1}, {"oxyds3#*", min = 1}, {"oxyds4#*", min = 1})
+  no["marbleSW"]["adhesion"] = 0.0
+  no["marbleSE"]["adhesion"] = 0.0
+end
+
+function toggleMarbles(val, src)
+  if src["_color"] == "black" then
+    if statB == 0 then
+      no["marbleNE"]["adhesion"] = 0.0
+      no["marbleSW"]["adhesion"] = 1.0
+      statB = 1
+    elseif statB == 1 then
+      no["marbleSW"]["adhesion"] = 0.0
+      no["marbleNE"]["adhesion"] = 1.0
+      statB = 0
+    end
+  end
+  -- white marbles
+  if src["_color"] == "white" then
+    if statW == 0 then
+      no["marbleNW"]["adhesion"] = 0.0
+      no["marbleSE"]["adhesion"] = 1.0
+      statW = 1
+    elseif statW == 1 then
+      no["marbleSE"]["adhesion"] = 0.0
+      no["marbleNW"]["adhesion"] = 1.0
+      statW = 0
+    end
+  end
+end
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/devnull11_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/data/levels/enigma_viii/index.xml
===================================================================
--- trunk/data/levels/enigma_viii/index.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_viii/index.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="43" title="Enigma VIII"/>
+  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="44" title="Enigma VIII"/>
 
   <attributes/>
 
@@ -97,6 +97,7 @@
     <level _seq="89" _title="Pentomino XIV" _xpath="./pento14_1" author="Enigma Team" ctrl="force" easy="false" id="pento14" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="90" _title="Pentomino XV" _xpath="./pento15_1" author="Enigma Team" ctrl="force" easy="false" id="pento15" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="91" _title="Pentomino XVI" _xpath="./pento16_1" author="Enigma Team" ctrl="force" easy="false" id="pento16" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="92" _title="2 + 2" _xpath="./devnull11_1" author="/dev/null" ctrl="force" easy="true" id="devnull11" rel="1" rev="6" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: trunk/data/levels/enigma_viii/raoul33_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/raoul33_1.xml	2009-05-02 22:12:39 UTC (rev 1657)
+++ trunk/data/levels/enigma_viii/raoul33_1.xml	2009-05-03 17:44:23 UTC (rev 1658)
@@ -2,7 +2,7 @@
 <el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
   <el:protected>
     <el:info el:type="level">
-      <el:identity el:title="Push? Pull? Rotate!" el:subtitle="Puzzels in a wooden box" el:id="raoul33"/>
+      <el:identity el:title="Push? Pull? Rotate!" el:subtitle="Puzzles in a wooden box" el:id="raoul33"/>
       <el:version el:score="1" el:release="1" el:revision="3" el:status="released"/>
       <el:author el:name="Raoul Bourquin" el:email="raoul at users.berlios.de"/>
       <el:copyright>Copyright ? 2009 Raoul Bourquin</el:copyright>



From ral at mail.berlios.de  Sun May  3 22:40:31 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 3 May 2009 22:40:31 +0200
Subject: [Enigma-game-svn] r1659 - in trunk: data src src/items src/stones
Message-ID: <200905032040.n43KeV1x025945@sheep.berlios.de>

Author: ral
Date: 2009-05-03 22:40:30 +0200 (Sun, 03 May 2009)
New Revision: 1659

Modified:
   trunk/data/models-2d.lua
   trunk/src/items/Bomb.cc
   trunk/src/items/Bomb.hh
   trunk/src/stones/IceBlock.cc
   trunk/src/stones/IceBlock.hh
   trunk/src/world.cc
Log:
Trunk 1.1:
- crash fix 0.92 explosion effect handling
- st_ice - add breaking anim support:
  - engine code complete
  - model code ready but commented with alias substitution
  - images missing
- fix bomb explosion on stone hit:
  - add a delay by animation to avoid destruction of hit causing stone


Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-03 17:44:23 UTC (rev 1658)
+++ trunk/data/models-2d.lua	2009-05-03 20:40:30 UTC (rev 1659)
@@ -599,13 +599,19 @@
     local images = DefSubimages("it_bomb_black_burning", {h=9})
     local frames = BuildFrames(images, 100)
     DefAnim("it_bomb_black_burning", frames)
+    
+    local frames = BuildFrames({"it_bomb_black_burning8", "it_bomb_black_burning9"},120)
+    DefAnim("it_bomb_black_exploding", frames)
 end
 
 -- Burning white bomb --
 do
     local images = DefSubimages("it_bomb_white_burning", {h=9})
     local frames = BuildFrames(images, 100)
-    DefAnim("it_bomb_white_burning", frames)
+    DefAnim("it_bomb_white_burning", frames
+    )
+    local frames = BuildFrames({"it_bomb_white_burning8", "it_bomb_white_burning9"},120)
+    DefAnim("it_bomb_white_exploding", frames)
 end
 
 -- Burning dynamite --
@@ -1015,6 +1021,16 @@
    DefShModel("st-fourswitch-w", "st-fourswitch4", "sh-round")
 end
 
+-- st_ice --
+do
+    DefAlias("st_ice", "st_rawglass")
+    DefAlias("st_ice_breaking", "it_debris_water")
+--    local images = DefSubimages("st_ice_break", {h=3})
+--    local frames = BuildFrames(images,50)
+--    DefAnim("st_ice_break-anim", frames)
+--    DefShModel("st_ice_breaking", "st_ice_break-anim", "sh-glass")
+end
+
 -- st-knight --
 do
     local images = DefSubimages("st-knight", {modelname="knight", h=5})

Modified: trunk/src/items/Bomb.cc
===================================================================
--- trunk/src/items/Bomb.cc	2009-05-03 17:44:23 UTC (rev 1658)
+++ trunk/src/items/Bomb.cc	2009-05-03 20:40:30 UTC (rev 1659)
@@ -98,11 +98,11 @@
             case GAMET_OXYDMAGNUM:
                 if (!st->isKind("st_box_wood"))
                     // st-wood does not cause bombs to explode
-                    explode();
+                    ignite(); //delayed explosion to avoid selfdestruction on move
                 break;
             default :
                 if (!st->isKind("st_box_hay"))
-                    explode();
+                    ignite(); //delayed explosion to avoid selfdestruction on move
                 break;
         }
     }
@@ -114,6 +114,14 @@
         }
     }
     
+    void Bomb::ignite() {
+        if (state == IDLE) {
+            state = BURNING;
+            std::string color = (getAttr("color") == BLACK) ? "black" : "white";
+            set_anim(ecl::strf("it_bomb_%s_exploding", color.c_str()));   // shortened burning
+        }
+    }
+    
     void Bomb::explode() {
         GridPos p = get_pos();
         Value vc = getAttr("color");

Modified: trunk/src/items/Bomb.hh
===================================================================
--- trunk/src/items/Bomb.hh	2009-05-03 17:44:23 UTC (rev 1658)
+++ trunk/src/items/Bomb.hh	2009-05-03 20:40:30 UTC (rev 1659)
@@ -62,6 +62,7 @@
         
     private:
         void burn();
+        void ignite();
         void explode();
         int traitsIdx() const;
     };

Modified: trunk/src/stones/IceBlock.cc
===================================================================
--- trunk/src/stones/IceBlock.cc	2009-05-03 17:44:23 UTC (rev 1658)
+++ trunk/src/stones/IceBlock.cc	2009-05-03 20:40:30 UTC (rev 1659)
@@ -33,18 +33,16 @@
     
     Value IceBlock::message(const Message &m) {
         if (m.message == "_explosion" || m.message == "ignite") {
-            GridPos p = get_pos();
-            setNoAbyssFloor(p, "fl_ice");
-            setNoAbyssFloor(move(p, NORTH), "fl_ice");
-            setNoAbyssFloor(move(p, EAST), "fl_ice");
-            setNoAbyssFloor(move(p, SOUTH), "fl_ice");
-            setNoAbyssFloor(move(p, WEST), "fl_ice");
-            KillStone(p);
+            if (isDisplayable()) {
+                set_anim("st_ice_breaking");
+            }
             return Value();
         } else if (m.message == "heat") {
-            GridPos p = get_pos();
-            setNoAbyssFloor(p, "fl_water");
-            KillStone(p);
+            if (isDisplayable()) {
+                GridPos p = get_pos();
+                setNoAbyssFloor(p, "fl_water");
+                KillStone(p);
+            }
             return Value();            
         }
         return Stone::message(m);
@@ -54,6 +52,16 @@
         set_model("st_rawglass");
     }
     
+    void IceBlock::animcb() {
+        GridPos p = get_pos();
+        setNoAbyssFloor(p, "fl_ice");
+        setNoAbyssFloor(move(p, NORTH), "fl_ice");
+        setNoAbyssFloor(move(p, EAST), "fl_ice");
+        setNoAbyssFloor(move(p, SOUTH), "fl_ice");
+        setNoAbyssFloor(move(p, WEST), "fl_ice");
+        KillStone(p);
+    }
+    
     bool IceBlock::is_transparent(Direction d) const {
         return true;
     }

Modified: trunk/src/stones/IceBlock.hh
===================================================================
--- trunk/src/stones/IceBlock.hh	2009-05-03 17:44:23 UTC (rev 1658)
+++ trunk/src/stones/IceBlock.hh	2009-05-03 20:40:30 UTC (rev 1659)
@@ -32,6 +32,11 @@
         CLONEOBJ(IceBlock);
         DECL_TRAITS;
         
+    private:
+        enum iState {
+            IDLE,           ///< 
+            BREAKING,       ///< 
+        };
     public:
         IceBlock();
 
@@ -42,6 +47,9 @@
         // GridObject interface
         virtual void init_model();
         
+        // ModelCallback interface
+        virtual void animcb();
+        
         // Stone interface
         virtual bool is_transparent(Direction d) const;
         virtual bool on_move(const GridPos &origin);

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2009-05-03 17:44:23 UTC (rev 1658)
+++ trunk/src/world.cc	2009-05-03 20:40:30 UTC (rev 1659)
@@ -2000,16 +2000,13 @@
 
     for (int a = 0; a<AFFECTED_FIELDS; ++a) {
         GridPos  dest            = get_neighbour(center, a);
-        Item    *item            = GetItem(dest);
-        Stone   *stone           = GetStone(dest);
-        Floor   *floor           = GetFloor(dest);
         bool     direct_neighbor = a<=4;
 
         switch (type) {
             case EXPLOSION_DYNAMITE:
-                if (stone) SendMessage(stone, "ignite");
-                if (item)  SendMessage(item, "ignite");
-                if (floor) SendMessage(floor, "ignite");
+                if (Stone *stone = GetStone(dest)) SendMessage(stone, "ignite");
+                if (Item *item = GetItem(dest))  SendMessage(item, "ignite");
+                if (Floor *floor = GetFloor(dest)) SendMessage(floor, "ignite");
                 break;
 
             case EXPLOSION_BLACKBOMB:
@@ -2017,9 +2014,9 @@
                     explosion(center, dest, "it_explosion_nil");
                 } else if (server::GameCompatibility == GAMET_ENIGMA) {
                     // Note: should not ignite in non-enigma-mode!
-                    if (stone) SendMessage(stone, "ignite");
-                    if (item)  SendMessage(item, "ignite");
-                    if (floor) SendMessage(floor, "ignite");
+                    if (Stone *stone = GetStone(dest)) SendMessage(stone, "ignite");
+                    if (Item *item = GetItem(dest))  SendMessage(item, "ignite");
+                    if (Floor *floor = GetFloor(dest)) SendMessage(floor, "ignite");
                 }
                 break;
     
@@ -2033,9 +2030,9 @@
     
             case EXPLOSION_DISPENSER:
                 if (direct_neighbor) {
-                    if (stone) SendMessage(stone, "_dispenser");
-                    if (item) SendMessage(item, "_dispenser");
-                    if (floor) SendMessage(floor, "_dispenser");
+                    if (Stone *stone = GetStone(dest)) SendMessage(stone, "_dispenser");
+                    if (Item *item = GetItem(dest)) SendMessage(item, "_dispenser");
+                    if (Floor *floor = GetFloor(dest)) SendMessage(floor, "_dispenser");
                 }
                 break;
     



From ral at mail.berlios.de  Mon May  4 00:49:29 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Mon, 4 May 2009 00:49:29 +0200
Subject: [Enigma-game-svn] r1660 - trunk/src/stones
Message-ID: <200905032249.n43MnTod019471@sheep.berlios.de>

Author: ral
Date: 2009-05-04 00:49:27 +0200 (Mon, 04 May 2009)
New Revision: 1660

Modified:
   trunk/src/stones/IceBlock.cc
Log:
Trunk 1.1:
- st_ice fixes:
  - do not explode frozen bombs on moves
  - use model "st_ice"


Modified: trunk/src/stones/IceBlock.cc
===================================================================
--- trunk/src/stones/IceBlock.cc	2009-05-03 20:40:30 UTC (rev 1659)
+++ trunk/src/stones/IceBlock.cc	2009-05-03 22:49:27 UTC (rev 1660)
@@ -49,7 +49,7 @@
     }
     
     void IceBlock::init_model() {
-        set_model("st_rawglass");
+        set_model("st_ice");
     }
     
     void IceBlock::animcb() {
@@ -67,6 +67,7 @@
     }
     
     bool IceBlock::on_move(const GridPos &origin) {
+        bool isFrozenBomb = false;
         Item *itf = GetItem(origin);
         Item *itd = GetItem(get_pos());
         if (itd != NULL) {
@@ -74,9 +75,10 @@
             itd = GetItem(get_pos());
         }
         if (itf != NULL && itf->isFreezable()) {
-            if (itd == NULL || !itd->isStatic() || (itd->isFreezable() && !itf->isPortable()))
+            if (itd == NULL || !itd->isStatic() || (itd->isFreezable() && !itf->isPortable())) {
+                isFrozenBomb = itf->isKind("it_bomb");
                 SetItem(get_pos(), YieldItem(origin));
-            else
+            } else
                 KillItem(origin);
         }
         Floor *fl = GetFloor(get_pos());
@@ -87,7 +89,7 @@
         
         // deny all item actions on stone move besides bomb explosions
         itd = GetItem(get_pos());
-        return (itd != NULL && itd->isKind("it_bomb"));
+        return (itd != NULL && itd->isKind("it_bomb") && !isFrozenBomb);
     }
     
     void IceBlock::setNoAbyssFloor(const GridPos &p, std::string kind) const {



From ral at mail.berlios.de  Tue May  5 00:25:03 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Tue, 5 May 2009 00:25:03 +0200
Subject: [Enigma-game-svn] r1661 - homepage/input
Message-ID: <200905042225.n44MP3sV007011@sheep.berlios.de>

Author: ral
Date: 2009-05-05 00:24:53 +0200 (Tue, 05 May 2009)
New Revision: 1661

Modified:
   homepage/input/stat-other.html
   homepage/input/table-hcp.html
   homepage/input/table-rat.html
   homepage/input/table-solved.html
   homepage/input/table-wr.html
   homepage/input/userlist.html
Log:
Homepage:
- statistics April 2009


Modified: homepage/input/stat-other.html
===================================================================
--- homepage/input/stat-other.html	2009-05-03 22:49:27 UTC (rev 1660)
+++ homepage/input/stat-other.html	2009-05-04 22:24:53 UTC (rev 1661)
@@ -1,22 +1,22 @@
   <div class="stat-help">
     <h3>$$Other_Statistics$$</h3>
     <h4>$$Scores$$</h4>
-      89794 $$single_level_scores$$.
+      92298 $$single_level_scores$$.
     <h4>$$Ratings$$</h4>
-      17345 $$single_level_ratings$$ 4.94 $$and_distribution$$: 
+      17711 $$single_level_ratings$$ 4.93 $$and_distribution$$: 
       <table>
         <colgroup><col width="80"><col width="80"></colgroup>
         <tr><th>$$rating$$</th><th>$$count$$</th></tr>
-        <tr><td class="num">0</td><td class="num">113</td></tr>
-        <tr><td class="num">1</td><td class="num">315</td></tr>
-        <tr><td class="num">2</td><td class="num">900</td></tr>
-        <tr><td class="num">3</td><td class="num">2382</td></tr>
-        <tr><td class="num">4</td><td class="num">3273</td></tr>
-        <tr><td class="num">5</td><td class="num">4143</td></tr>
-        <tr><td class="num">6</td><td class="num">2945</td></tr>
-        <tr><td class="num">7</td><td class="num">1991</td></tr>
-        <tr><td class="num">8</td><td class="num">791</td></tr>
-        <tr><td class="num">9</td><td class="num">324</td></tr>
-        <tr><td class="num">10</td><td class="num">168</td></tr>
+        <tr><td class="num">0</td><td class="num">115</td></tr>
+        <tr><td class="num">1</td><td class="num">319</td></tr>
+        <tr><td class="num">2</td><td class="num">915</td></tr>
+        <tr><td class="num">3</td><td class="num">2441</td></tr>
+        <tr><td class="num">4</td><td class="num">3381</td></tr>
+        <tr><td class="num">5</td><td class="num">4233</td></tr>
+        <tr><td class="num">6</td><td class="num">2998</td></tr>
+        <tr><td class="num">7</td><td class="num">2017</td></tr>
+        <tr><td class="num">8</td><td class="num">795</td></tr>
+        <tr><td class="num">9</td><td class="num">328</td></tr>
+        <tr><td class="num">10</td><td class="num">169</td></tr>
       </table>
   </div>

Modified: homepage/input/table-hcp.html
===================================================================
--- homepage/input/table-hcp.html	2009-05-03 22:49:27 UTC (rev 1660)
+++ homepage/input/table-hcp.html	2009-05-04 22:24:53 UTC (rev 1661)
@@ -1,173 +1,177 @@
   <table>
-    <caption>$$Handicap_Statistics$$ $$March$$ 2009</caption>
+    <caption>$$Handicap_Statistics$$ $$April$$ 2009</caption>
     <colgroup><col width="130"><col width="220"></colgroup>
     <tr><th>$$solved_hcp$$</th><th class="left">$$user$$</th></tr>
-     <tr><td class="num">-148.3</td><td class="left">'Moneymaker'</td></tr>
-     <tr><td class="num"> -98.0</td><td class="left">'daydreamer'</td></tr>
-     <tr><td class="num"> -76.2</td><td class="left">'Stupid'</td></tr>
-     <tr><td class="num"> -75.9</td><td class="left">'Johannes'</td></tr>
-     <tr><td class="num"> -64.7</td><td class="left">'Great Scott'</td></tr>
-     <tr><td class="num"> -64.5</td><td class="left">'dev0'</td></tr>
-     <tr><td class="num"> -63.7</td><td class="left">'Mentist'</td></tr>
-     <tr><td class="num"> -56.3</td><td class="left">'Crystalicum'</td></tr>
+     <tr><td class="num">-153.1</td><td class="left">'Moneymaker'</td></tr>
+     <tr><td class="num">-105.2</td><td class="left">'daydreamer'</td></tr>
+     <tr><td class="num"> -76.1</td><td class="left">'Stupid'</td></tr>
+     <tr><td class="num"> -75.8</td><td class="left">'Johannes'</td></tr>
+     <tr><td class="num"> -65.9</td><td class="left">'Mentist'</td></tr>
+     <tr><td class="num"> -64.9</td><td class="left">'Great Scott'</td></tr>
+     <tr><td class="num"> -64.7</td><td class="left">'dev0'</td></tr>
+     <tr><td class="num"> -56.7</td><td class="left">'Crystalicum'</td></tr>
+     <tr><td class="num"> -55.2</td><td class="left">'Daisy'</td></tr>
      <tr><td class="num"> -55.1</td><td class="left">'Duffy'</td></tr>
-     <tr><td class="num"> -53.6</td><td class="left">'Malla'</td></tr>
-     <tr><td class="num"> -52.6</td><td class="left">'Daisy'</td></tr>
-     <tr><td class="num"> -50.3</td><td class="left">'ryujun'</td></tr>
-     <tr><td class="num"> -45.2</td><td class="left">'Alexandros'</td></tr>
-     <tr><td class="num"> -42.9</td><td class="left">'Django'</td></tr>
+     <tr><td class="num"> -53.4</td><td class="left">'Malla'</td></tr>
+     <tr><td class="num"> -50.1</td><td class="left">'ryujun'</td></tr>
+     <tr><td class="num"> -45.3</td><td class="left">'Alexandros'</td></tr>
+     <tr><td class="num"> -42.8</td><td class="left">'Django'</td></tr>
      <tr><td class="num"> -40.6</td><td class="left">'Gloop'</td></tr>
-     <tr><td class="num"> -33.5</td><td class="left">'Taztunes'</td></tr>
-     <tr><td class="num"> -31.3</td><td class="left">'Safalra'</td></tr>
-     <tr><td class="num"> -30.7</td><td class="left">'Emmanuel'</td></tr>
+     <tr><td class="num"> -33.3</td><td class="left">'Taztunes'</td></tr>
+     <tr><td class="num"> -31.7</td><td class="left">'Angolino'</td></tr>
+     <tr><td class="num"> -31.2</td><td class="left">'Safalra'</td></tr>
+     <tr><td class="num"> -30.9</td><td class="left">'Emmanuel'</td></tr>
      <tr><td class="num"> -28.6</td><td class="left">'Ludmian'</td></tr>
-     <tr><td class="num"> -28.5</td><td class="left">'Angolino'</td></tr>
-     <tr><td class="num"> -25.7</td><td class="left">'B-Huff'</td></tr>
-     <tr><td class="num"> -24.1</td><td class="left">'dpl'</td></tr>
-     <tr><td class="num"> -23.1</td><td class="left">'Zekobah'</td></tr>
-     <tr><td class="num"> -22.3</td><td class="left">'bojster'</td></tr>
-     <tr><td class="num"> -21.8</td><td class="left">'Ghatotkacha'</td></tr>
-     <tr><td class="num"> -19.0</td><td class="left">'ged'</td></tr>
-     <tr><td class="num"> -17.3</td><td class="left">'hendrik'</td></tr>
-     <tr><td class="num"> -16.4</td><td class="left">'ABS'</td></tr>
-     <tr><td class="num"> -15.9</td><td class="left">'Raoul'</td></tr>
-     <tr><td class="num"> -13.0</td><td class="left">'Ronald'</td></tr>
-     <tr><td class="num"> -11.6</td><td class="left">'Dime'</td></tr>
+     <tr><td class="num"> -25.9</td><td class="left">'B-Huff'</td></tr>
+     <tr><td class="num"> -24.2</td><td class="left">'dpl'</td></tr>
+     <tr><td class="num"> -23.3</td><td class="left">'Zekobah'</td></tr>
+     <tr><td class="num"> -22.4</td><td class="left">'bojster'</td></tr>
+     <tr><td class="num"> -22.1</td><td class="left">'Ghatotkacha'</td></tr>
+     <tr><td class="num"> -19.4</td><td class="left">'ged'</td></tr>
+     <tr><td class="num"> -19.0</td><td class="left">'Medimaster'</td></tr>
+     <tr><td class="num"> -17.8</td><td class="left">'hendrik'</td></tr>
+     <tr><td class="num"> -16.6</td><td class="left">'ABS'</td></tr>
+     <tr><td class="num"> -15.8</td><td class="left">'Raoul'</td></tr>
+     <tr><td class="num"> -12.8</td><td class="left">'Ronald'</td></tr>
+     <tr><td class="num"> -12.8</td><td class="left">'Dime'</td></tr>
      <tr><td class="num">  -8.0</td><td class="left">'Lukas'</td></tr>
-     <tr><td class="num">  -7.4</td><td class="left">'HuB34'</td></tr>
-     <tr><td class="num">  -3.9</td><td class="left">'Iceshark7'</td></tr>
-     <tr><td class="num">  -3.7</td><td class="left">'Timo'</td></tr>
-     <tr><td class="num">  -3.3</td><td class="left">'joseba'</td></tr>
-     <tr><td class="num">   0.0</td><td class="left">'Daniel'</td></tr>
-     <tr><td class="num">   0.9</td><td class="left">'fabian'</td></tr>
-     <tr><td class="num">   1.4</td><td class="left">'U-Punkt'</td></tr>
-     <tr><td class="num">   1.6</td><td class="left">'Hairball'</td></tr>
-     <tr><td class="num">   2.2</td><td class="left">'Craven'</td></tr>
-     <tr><td class="num">   2.3</td><td class="left">'JuSt'</td></tr>
-     <tr><td class="num">   2.7</td><td class="left">'Wuzzy'</td></tr>
-     <tr><td class="num">   3.0</td><td class="left">'Freshman'</td></tr>
-     <tr><td class="num">   3.5</td><td class="left">'mecke'</td></tr>
+     <tr><td class="num">  -7.3</td><td class="left">'HuB34'</td></tr>
+     <tr><td class="num">  -4.1</td><td class="left">'Iceshark7'</td></tr>
+     <tr><td class="num">  -3.9</td><td class="left">'Timo'</td></tr>
+     <tr><td class="num">  -3.6</td><td class="left">'joseba'</td></tr>
+     <tr><td class="num">  -0.1</td><td class="left">'Daniel'</td></tr>
+     <tr><td class="num">   0.7</td><td class="left">'fabian'</td></tr>
+     <tr><td class="num">   1.3</td><td class="left">'U-Punkt'</td></tr>
+     <tr><td class="num">   1.4</td><td class="left">'mecke'</td></tr>
+     <tr><td class="num">   1.5</td><td class="left">'Hairball'</td></tr>
+     <tr><td class="num">   2.3</td><td class="left">'Craven'</td></tr>
+     <tr><td class="num">   2.4</td><td class="left">'Wuzzy'</td></tr>
+     <tr><td class="num">   2.4</td><td class="left">'JuSt'</td></tr>
+     <tr><td class="num">   3.1</td><td class="left">'Freshman'</td></tr>
      <tr><td class="num">   3.7</td><td class="left">'Kevin'</td></tr>
-     <tr><td class="num">   3.8</td><td class="left">'mrduke'</td></tr>
-     <tr><td class="num">   4.8</td><td class="left">'para_doks'</td></tr>
-     <tr><td class="num">   5.2</td><td class="left">'Tobias'</td></tr>
-     <tr><td class="num">   6.5</td><td class="left">'Guglielmo'</td></tr>
-     <tr><td class="num">   6.6</td><td class="left">'alfred69'</td></tr>
-     <tr><td class="num">   6.6</td><td class="left">'Tiza'</td></tr>
-     <tr><td class="num">   7.4</td><td class="left">'Sigma'</td></tr>
+     <tr><td class="num">   3.9</td><td class="left">'mrduke'</td></tr>
+     <tr><td class="num">   4.8</td><td class="left">'Tiza'</td></tr>
+     <tr><td class="num">   4.9</td><td class="left">'para_doks'</td></tr>
+     <tr><td class="num">   5.3</td><td class="left">'Tobias'</td></tr>
+     <tr><td class="num">   5.7</td><td class="left">'Another'</td></tr>
+     <tr><td class="num">   6.4</td><td class="left">'Guglielmo'</td></tr>
+     <tr><td class="num">   6.5</td><td class="left">'alfred69'</td></tr>
+     <tr><td class="num">   7.2</td><td class="left">'Sigma'</td></tr>
+     <tr><td class="num">   7.4</td><td class="left">'serpent'</td></tr>
      <tr><td class="num">   7.6</td><td class="left">'Andy'</td></tr>
-     <tr><td class="num">   7.6</td><td class="left">'serpent'</td></tr>
-     <tr><td class="num">   9.9</td><td class="left">'Austin'</td></tr>
-     <tr><td class="num">  11.3</td><td class="left">'shoki'</td></tr>
-     <tr><td class="num">  13.8</td><td class="left">'ShadowPhrogg32642342'</td></tr>
-     <tr><td class="num">  15.9</td><td class="left">'Andreas'</td></tr>
-     <tr><td class="num">  16.1</td><td class="left">'Mark P.'</td></tr>
+     <tr><td class="num">   9.7</td><td class="left">'Austin'</td></tr>
+     <tr><td class="num">  10.4</td><td class="left">'H-J.Epting'</td></tr>
+     <tr><td class="num">  11.2</td><td class="left">'shoki'</td></tr>
+     <tr><td class="num">  13.1</td><td class="left">'oxyd4ever'</td></tr>
+     <tr><td class="num">  13.7</td><td class="left">'ShadowPhrogg32642342'</td></tr>
+     <tr><td class="num">  15.9</td><td class="left">'Mark P.'</td></tr>
+     <tr><td class="num">  16.0</td><td class="left">'Andreas'</td></tr>
      <tr><td class="num">  16.9</td><td class="left">'AlephD'</td></tr>
+     <tr><td class="num">  17.1</td><td class="left">'Chocolate Zero'</td></tr>
      <tr><td class="num">  17.1</td><td class="left">'Sim_Ed'</td></tr>
-     <tr><td class="num">  17.4</td><td class="left">'Chocolate Zero'</td></tr>
-     <tr><td class="num">  17.7</td><td class="left">'Agnieszka'</td></tr>
-     <tr><td class="num">  21.2</td><td class="left">'Ale'</td></tr>
-     <tr><td class="num">  21.6</td><td class="left">'Alex'</td></tr>
-     <tr><td class="num">  23.9</td><td class="left">'H-J.Epting'</td></tr>
-     <tr><td class="num">  24.0</td><td class="left">'Antonio EE'</td></tr>
+     <tr><td class="num">  17.5</td><td class="left">'Agnieszka'</td></tr>
+     <tr><td class="num">  20.4</td><td class="left">'ais523'</td></tr>
+     <tr><td class="num">  21.3</td><td class="left">'Ale'</td></tr>
+     <tr><td class="num">  21.7</td><td class="left">'Alex'</td></tr>
+     <tr><td class="num">  23.9</td><td class="left">'Antonio EE'</td></tr>
      <tr><td class="num">  24.2</td><td class="left">'Klaus'</td></tr>
      <tr><td class="num">  24.3</td><td class="left">'Jinajon'</td></tr>
-     <tr><td class="num">  24.8</td><td class="left">'Marc-Hendrik'</td></tr>
+     <tr><td class="num">  24.7</td><td class="left">'Marc-Hendrik'</td></tr>
      <tr><td class="num">  25.1</td><td class="left">'Chris'</td></tr>
-     <tr><td class="num">  25.9</td><td class="left">'Thomas'</td></tr>
-     <tr><td class="num">  26.2</td><td class="left">'Feynman'</td></tr>
-     <tr><td class="num">  26.5</td><td class="left">'hdwow'</td></tr>
+     <tr><td class="num">  25.7</td><td class="left">'Thomas'</td></tr>
+     <tr><td class="num">  26.1</td><td class="left">'Feynman'</td></tr>
+     <tr><td class="num">  26.4</td><td class="left">'hdwow'</td></tr>
      <tr><td class="num">  26.9</td><td class="left">'Gottseinsohn'</td></tr>
-     <tr><td class="num">  27.4</td><td class="left">'Bent'</td></tr>
-     <tr><td class="num">  27.8</td><td class="left">'Hans-HD'</td></tr>
-     <tr><td class="num">  28.9</td><td class="left">'un_guru'</td></tr>
-     <tr><td class="num">  29.2</td><td class="left">'Little_Mole'</td></tr>
-     <tr><td class="num">  29.7</td><td class="left">'J3FF'</td></tr>
-     <tr><td class="num">  30.4</td><td class="left">'biotopa'</td></tr>
-     <tr><td class="num">  30.5</td><td class="left">'oxyd4ever'</td></tr>
-     <tr><td class="num">  30.6</td><td class="left">'Vinksu'</td></tr>
-     <tr><td class="num">  30.8</td><td class="left">'GiannuzzITA'</td></tr>
-     <tr><td class="num">  30.9</td><td class="left">'oblo'</td></tr>
-     <tr><td class="num">  31.3</td><td class="left">'redsantz'</td></tr>
-     <tr><td class="num">  32.4</td><td class="left">'geembo_90'</td></tr>
-     <tr><td class="num">  32.6</td><td class="left">'Edgar_Flesk'</td></tr>
+     <tr><td class="num">  27.2</td><td class="left">'Bent'</td></tr>
+     <tr><td class="num">  27.7</td><td class="left">'Hans-HD'</td></tr>
+     <tr><td class="num">  28.8</td><td class="left">'un_guru'</td></tr>
+     <tr><td class="num">  29.1</td><td class="left">'Little_Mole'</td></tr>
+     <tr><td class="num">  29.4</td><td class="left">'J3FF'</td></tr>
+     <tr><td class="num">  30.5</td><td class="left">'biotopa'</td></tr>
+     <tr><td class="num">  30.5</td><td class="left">'Vinksu'</td></tr>
+     <tr><td class="num">  30.5</td><td class="left">'GiannuzzITA'</td></tr>
+     <tr><td class="num">  30.8</td><td class="left">'oblo'</td></tr>
+     <tr><td class="num">  31.4</td><td class="left">'redsantz'</td></tr>
+     <tr><td class="num">  32.1</td><td class="left">'geembo_90'</td></tr>
+     <tr><td class="num">  32.5</td><td class="left">'Edgar_Flesk'</td></tr>
      <tr><td class="num">  32.8</td><td class="left">'Melanie'</td></tr>
-     <tr><td class="num">  33.4</td><td class="left">'NorthForty'</td></tr>
-     <tr><td class="num">  33.4</td><td class="left">'IChrisI'</td></tr>
+     <tr><td class="num">  33.3</td><td class="left">'NorthForty'</td></tr>
+     <tr><td class="num">  33.3</td><td class="left">'IChrisI'</td></tr>
      <tr><td class="num">  33.6</td><td class="left">'erich'</td></tr>
      <tr><td class="num">  33.7</td><td class="left">'Gorn'</td></tr>
      <tr><td class="num">  36.4</td><td class="left">'niebie'</td></tr>
-     <tr><td class="num">  36.5</td><td class="left">'MicWa'</td></tr>
+     <tr><td class="num">  36.4</td><td class="left">'MicWa'</td></tr>
      <tr><td class="num">  36.7</td><td class="left">'WP319'</td></tr>
      <tr><td class="num">  37.0</td><td class="left">'Kosby'</td></tr>
      <tr><td class="num">  37.9</td><td class="left">'alain'</td></tr>
-     <tr><td class="num">  38.7</td><td class="left">'Liam Sheehan'</td></tr>
-     <tr><td class="num">  39.1</td><td class="left">'Rugby4ever'</td></tr>
-     <tr><td class="num">  40.0</td><td class="left">'WesleyCrusher'</td></tr>
+     <tr><td class="num">  38.5</td><td class="left">'Liam Sheehan'</td></tr>
+     <tr><td class="num">  39.0</td><td class="left">'Rugby4ever'</td></tr>
+     <tr><td class="num">  39.9</td><td class="left">'WesleyCrusher'</td></tr>
      <tr><td class="num">  40.1</td><td class="left">'Drotten'</td></tr>
-     <tr><td class="num">  40.5</td><td class="left">'Archcorenth'</td></tr>
-     <tr><td class="num">  40.7</td><td class="left">'Harry Lim'</td></tr>
-     <tr><td class="num">  41.1</td><td class="left">'B-man'</td></tr>
-     <tr><td class="num">  41.4</td><td class="left">'Nfol'</td></tr>
-     <tr><td class="num">  42.3</td><td class="left">'Tiger'</td></tr>
+     <tr><td class="num">  40.3</td><td class="left">'Archcorenth'</td></tr>
+     <tr><td class="num">  40.5</td><td class="left">'Harry Lim'</td></tr>
+     <tr><td class="num">  41.0</td><td class="left">'B-man'</td></tr>
+     <tr><td class="num">  41.2</td><td class="left">'Nfol'</td></tr>
+     <tr><td class="num">  42.1</td><td class="left">'Tiger'</td></tr>
      <tr><td class="num">  42.4</td><td class="left">'gringer'</td></tr>
      <tr><td class="num">  42.9</td><td class="left">'Vlad'</td></tr>
-     <tr><td class="num">  43.0</td><td class="left">'Snaily'</td></tr>
-     <tr><td class="num">  44.1</td><td class="left">'Momcat'</td></tr>
+     <tr><td class="num">  42.9</td><td class="left">'Snaily'</td></tr>
+     <tr><td class="num">  44.0</td><td class="left">'Momcat'</td></tr>
      <tr><td class="num">  44.8</td><td class="left">'Breezy'</td></tr>
-     <tr><td class="num">  45.3</td><td class="left">'Uli'</td></tr>
+     <tr><td class="num">  45.1</td><td class="left">'Uli'</td></tr>
      <tr><td class="num">  46.4</td><td class="left">'Tarim'</td></tr>
-     <tr><td class="num">  47.2</td><td class="left">'IntKecsk'</td></tr>
-     <tr><td class="num">  47.7</td><td class="left">'tjRaven'</td></tr>
+     <tr><td class="num">  47.1</td><td class="left">'IntKecsk'</td></tr>
+     <tr><td class="num">  47.3</td><td class="left">'Jonyzz'</td></tr>
+     <tr><td class="num">  47.4</td><td class="left">'tjRaven'</td></tr>
      <tr><td class="num">  48.3</td><td class="left">'Valkyrie2'</td></tr>
      <tr><td class="num">  48.5</td><td class="left">'ntaeijr'</td></tr>
      <tr><td class="num">  48.5</td><td class="left">'mhatta'</td></tr>
-     <tr><td class="num">  50.5</td><td class="left">'Zak'</td></tr>
-     <tr><td class="num">  50.6</td><td class="left">'Tomson'</td></tr>
-     <tr><td class="num">  50.7</td><td class="left">'rima'</td></tr>
+     <tr><td class="num">  50.4</td><td class="left">'Zak'</td></tr>
+     <tr><td class="num">  50.5</td><td class="left">'Tomson'</td></tr>
+     <tr><td class="num">  50.6</td><td class="left">'rima'</td></tr>
+     <tr><td class="num">  51.0</td><td class="left">'Sandra'</td></tr>
+     <tr><td class="num">  51.0</td><td class="left">'Mecki'</td></tr>
      <tr><td class="num">  51.1</td><td class="left">'brynn'</td></tr>
-     <tr><td class="num">  51.1</td><td class="left">'Sandra'</td></tr>
-     <tr><td class="num">  51.9</td><td class="left">'ReasonAnce'</td></tr>
-     <tr><td class="num">  51.9</td><td class="left">'jdcampo'</td></tr>
-     <tr><td class="num">  52.2</td><td class="left">'Jeffrey S'</td></tr>
+     <tr><td class="num">  51.8</td><td class="left">'jdcampo'</td></tr>
+     <tr><td class="num">  52.0</td><td class="left">'ReasonAnce'</td></tr>
+     <tr><td class="num">  52.1</td><td class="left">'Jeffrey S'</td></tr>
+     <tr><td class="num">  53.1</td><td class="left">'Slav'</td></tr>
      <tr><td class="num">  53.1</td><td class="left">'AkRa'</td></tr>
-     <tr><td class="num">  53.2</td><td class="left">'Slav'</td></tr>
-     <tr><td class="num">  53.4</td><td class="left">'Vaily'</td></tr>
-     <tr><td class="num">  53.5</td><td class="left">'Pascal'</td></tr>
-     <tr><td class="num">  54.4</td><td class="left">'Cyphase'</td></tr>
-     <tr><td class="num">  54.5</td><td class="left">'Turbogurk'</td></tr>
+     <tr><td class="num">  53.3</td><td class="left">'Vaily'</td></tr>
+     <tr><td class="num">  53.4</td><td class="left">'Pascal'</td></tr>
+     <tr><td class="num">  54.3</td><td class="left">'Cyphase'</td></tr>
+     <tr><td class="num">  54.4</td><td class="left">'Turbogurk'</td></tr>
      <tr><td class="num">  54.6</td><td class="left">'Neophilus'</td></tr>
      <tr><td class="num">  56.6</td><td class="left">'krazy62'</td></tr>
-     <tr><td class="num">  57.8</td><td class="left">'Adonica'</td></tr>
-     <tr><td class="num">  58.2</td><td class="left">'Kadu'</td></tr>
+     <tr><td class="num">  57.6</td><td class="left">'Adonica'</td></tr>
+     <tr><td class="num">  58.1</td><td class="left">'Kadu'</td></tr>
      <tr><td class="num">  59.9</td><td class="left">'Enrymather'</td></tr>
-     <tr><td class="num">  60.0</td><td class="left">'Mecki'</td></tr>
-     <tr><td class="num">  60.7</td><td class="left">'Sopoforic'</td></tr>
+     <tr><td class="num">  60.6</td><td class="left">'Sopoforic'</td></tr>
      <tr><td class="num">  61.4</td><td class="left">'jumbo'</td></tr>
-     <tr><td class="num">  62.1</td><td class="left">'jdrexler'</td></tr>
-     <tr><td class="num">  62.8</td><td class="left">'Asbel'</td></tr>
+     <tr><td class="num">  62.0</td><td class="left">'jdrexler'</td></tr>
+     <tr><td class="num">  62.7</td><td class="left">'Asbel'</td></tr>
      <tr><td class="num">  64.5</td><td class="left">'tasker'</td></tr>
-     <tr><td class="num">  64.7</td><td class="left">'Meeve'</td></tr>
+     <tr><td class="num">  64.8</td><td class="left">'Meeve'</td></tr>
      <tr><td class="num">  66.8</td><td class="left">'ael'</td></tr>
      <tr><td class="num">  67.5</td><td class="left">'Samuel'</td></tr>
-     <tr><td class="num">  67.7</td><td class="left">'schmusi20'</td></tr>
-     <tr><td class="num">  67.8</td><td class="left">'Fred_the_wise'</td></tr>
-     <tr><td class="num">  67.8</td><td class="left">'Sparkey'</td></tr>
+     <tr><td class="num">  67.6</td><td class="left">'schmusi20'</td></tr>
+     <tr><td class="num">  67.7</td><td class="left">'Fred_the_wise'</td></tr>
+     <tr><td class="num">  67.7</td><td class="left">'Sparkey'</td></tr>
      <tr><td class="num">  68.1</td><td class="left">'Alf'</td></tr>
-     <tr><td class="num">  69.9</td><td class="left">'Magnus and Susi'</td></tr>
+     <tr><td class="num">  69.8</td><td class="left">'Magnus and Susi'</td></tr>
      <tr><td class="num">  70.4</td><td class="left">'Zhura'</td></tr>
-     <tr><td class="num">  71.2</td><td class="left">'xmouse'</td></tr>
+     <tr><td class="num">  71.1</td><td class="left">'xmouse'</td></tr>
      <tr><td class="num">  72.6</td><td class="left">'AQZ'</td></tr>
      <tr><td class="num">  72.6</td><td class="left">'Joona'</td></tr>
      <tr><td class="num">  74.2</td><td class="left">'crypto_rsa'</td></tr>
      <tr><td class="num">  74.5</td><td class="left">'Dvorhagen'</td></tr>
      <tr><td class="num">  75.3</td><td class="left">'Eselchen'</td></tr>
-     <tr><td class="num">  75.5</td><td class="left">'Nicol?s'</td></tr>
+     <tr><td class="num">  75.4</td><td class="left">'Nicol?s'</td></tr>
      <tr><td class="num">  75.6</td><td class="left">'jojo'</td></tr>
-     <tr><td class="num">  75.7</td><td class="left">'AsuCaga'</td></tr>
+     <tr><td class="num">  75.6</td><td class="left">'AsuCaga'</td></tr>
      <tr><td class="num">  79.0</td><td class="left">'colonel crayon'</td></tr>
-     <tr><td class="num">  79.8</td><td class="left">'Kroetchen'</td></tr>
-     <tr><td class="num">  80.6</td><td class="left">'Agares'</td></tr>
+     <tr><td class="num">  79.7</td><td class="left">'Kroetchen'</td></tr>
+     <tr><td class="num">  80.5</td><td class="left">'Agares'</td></tr>
      <tr><td class="num">  81.7</td><td class="left">'IIkka'</td></tr>
      <tr><td class="num">  85.4</td><td class="left">'Miel56'</td></tr>
      <tr><td class="num">  90.2</td><td class="left">'The red O'</td></tr>

Modified: homepage/input/table-rat.html
===================================================================
--- homepage/input/table-rat.html	2009-05-03 22:49:27 UTC (rev 1660)
+++ homepage/input/table-rat.html	2009-05-04 22:24:53 UTC (rev 1661)
@@ -1,26 +1,26 @@
   <table>
-    <caption>$$Rating_Statistics$$ $$March$$ 2009</caption>
+    <caption>$$Rating_Statistics$$ $$April$$ 2009</caption>
     <colgroup><col width="80"><col width="80"><col width="220"></colgroup>
     <tr><th>$$count$$</th><th>$$average$$</th><th class="left">$$user$$</th></tr>    <tr><td class="num">1062</td><td class="num"> 5.06</td><td class="left">'ryujun'</td></tr>
     <tr><td class="num">1056</td><td class="num"> 4.83</td><td class="left">'Taztunes'</td></tr>
     <tr><td class="num">1045</td><td class="num"> 4.93</td><td class="left">'Crystalicum'</td></tr>
-    <tr><td class="num">1037</td><td class="num"> 5.04</td><td class="left">'dev0'</td></tr>
+    <tr><td class="num">1038</td><td class="num"> 5.04</td><td class="left">'dev0'</td></tr>
     <tr><td class="num">899</td><td class="num"> 4.80</td><td class="left">'daydreamer'</td></tr>
     <tr><td class="num">871</td><td class="num"> 5.09</td><td class="left">'Stupid'</td></tr>
     <tr><td class="num">653</td><td class="num"> 5.01</td><td class="left">'Duffy'</td></tr>
     <tr><td class="num">643</td><td class="num"> 4.79</td><td class="left">'U-Punkt'</td></tr>
-    <tr><td class="num">629</td><td class="num"> 4.99</td><td class="left">'Moneymaker'</td></tr>
+    <tr><td class="num">631</td><td class="num"> 4.99</td><td class="left">'Moneymaker'</td></tr>
     <tr><td class="num">622</td><td class="num"> 4.22</td><td class="left">'shoki'</td></tr>
+    <tr><td class="num">581</td><td class="num"> 5.33</td><td class="left">'Mentist'</td></tr>
     <tr><td class="num">573</td><td class="num"> 5.16</td><td class="left">'dpl'</td></tr>
     <tr><td class="num">562</td><td class="num"> 4.48</td><td class="left">'Alexandros'</td></tr>
-    <tr><td class="num">546</td><td class="num"> 5.30</td><td class="left">'Mentist'</td></tr>
     <tr><td class="num">534</td><td class="num"> 4.97</td><td class="left">'B-Huff'</td></tr>
     <tr><td class="num">511</td><td class="num"> 5.30</td><td class="left">'Lukas'</td></tr>
     <tr><td class="num">505</td><td class="num"> 5.05</td><td class="left">'Ronald'</td></tr>
     <tr><td class="num">482</td><td class="num"> 4.04</td><td class="left">'Vinksu'</td></tr>
     <tr><td class="num">448</td><td class="num"> 5.08</td><td class="left">'Johannes'</td></tr>
+    <tr><td class="num">439</td><td class="num"> 4.98</td><td class="left">'Tiza'</td></tr>
     <tr><td class="num">433</td><td class="num"> 4.36</td><td class="left">'ged'</td></tr>
-    <tr><td class="num">401</td><td class="num"> 4.99</td><td class="left">'Tiza'</td></tr>
     <tr><td class="num">388</td><td class="num"> 4.86</td><td class="left">'Gloop'</td></tr>
     <tr><td class="num">307</td><td class="num"> 4.01</td><td class="left">'Sim_Ed'</td></tr>
     <tr><td class="num">285</td><td class="num"> 4.60</td><td class="left">'ABS'</td></tr>
@@ -28,25 +28,27 @@
     <tr><td class="num">208</td><td class="num"> 6.15</td><td class="left">'Momcat'</td></tr>
     <tr><td class="num">200</td><td class="num"> 5.74</td><td class="left">'Malla'</td></tr>
     <tr><td class="num">187</td><td class="num"> 5.05</td><td class="left">'WP319'</td></tr>
+    <tr><td class="num">178</td><td class="num"> 4.41</td><td class="left">'Jonyzz'</td></tr>
     <tr><td class="num">135</td><td class="num"> 4.13</td><td class="left">'Edgar_Flesk'</td></tr>
     <tr><td class="num">132</td><td class="num"> 5.65</td><td class="left">'Raoul'</td></tr>
     <tr><td class="num">126</td><td class="num"> 5.79</td><td class="left">'Ghatotkacha'</td></tr>
     <tr><td class="num">124</td><td class="num"> 4.44</td><td class="left">'Sigma'</td></tr>
+    <tr><td class="num">100</td><td class="num"> 5.08</td><td class="left">'Angolino'</td></tr>
     <tr><td class="num"> 97</td><td class="num"> 4.16</td><td class="left">'Safalra'</td></tr>
-    <tr><td class="num"> 97</td><td class="num"> 5.11</td><td class="left">'Angolino'</td></tr>
     <tr><td class="num"> 91</td><td class="num"> 4.41</td><td class="left">'Zhura'</td></tr>
+    <tr><td class="num"> 87</td><td class="num"> 3.98</td><td class="left">'Medimaster'</td></tr>
     <tr><td class="num"> 85</td><td class="num"> 4.76</td><td class="left">'para_doks'</td></tr>
     <tr><td class="num"> 75</td><td class="num"> 4.52</td><td class="left">'Kroetchen'</td></tr>
     <tr><td class="num"> 72</td><td class="num"> 5.63</td><td class="left">'Wuzzy'</td></tr>
-    <tr><td class="num"> 64</td><td class="num"> 6.08</td><td class="left">'mecke'</td></tr>
+    <tr><td class="num"> 65</td><td class="num"> 6.09</td><td class="left">'mecke'</td></tr>
     <tr><td class="num"> 63</td><td class="num"> 4.84</td><td class="left">'Mark P.'</td></tr>
     <tr><td class="num"> 52</td><td class="num"> 6.56</td><td class="left">'Hairball'</td></tr>
     <tr><td class="num"> 51</td><td class="num"> 6.39</td><td class="left">'Little_Mole'</td></tr>
     <tr><td class="num"> 50</td><td class="num"> 5.26</td><td class="left">'Daniel'</td></tr>
     <tr><td class="num"> 49</td><td class="num"> 6.02</td><td class="left">'oblo'</td></tr>
     <tr><td class="num"> 49</td><td class="num"> 4.90</td><td class="left">'hendrik'</td></tr>
+    <tr><td class="num"> 49</td><td class="num"> 6.31</td><td class="left">'Dime'</td></tr>
     <tr><td class="num"> 47</td><td class="num"> 6.62</td><td class="left">'Ale'</td></tr>
-    <tr><td class="num"> 46</td><td class="num"> 6.28</td><td class="left">'Dime'</td></tr>
     <tr><td class="num"> 43</td><td class="num"> 3.74</td><td class="left">'Iceshark7'</td></tr>
     <tr><td class="num"> 39</td><td class="num"> 6.08</td><td class="left">'mrduke'</td></tr>
     <tr><td class="num"> 33</td><td class="num"> 3.39</td><td class="left">'Freshman'</td></tr>
@@ -57,16 +59,18 @@
     <tr><td class="num"> 30</td><td class="num"> 6.93</td><td class="left">'un_guru'</td></tr>
     <tr><td class="num"> 25</td><td class="num"> 4.88</td><td class="left">'Drotten'</td></tr>
     <tr><td class="num"> 19</td><td class="num"> 3.74</td><td class="left">'Eselchen'</td></tr>
+    <tr><td class="num"> 18</td><td class="num"> 4.22</td><td class="left">'Mecki'</td></tr>
     <tr><td class="num"> 17</td><td class="num"> 5.53</td><td class="left">'Jeffrey S'</td></tr>
     <tr><td class="num"> 16</td><td class="num"> 3.25</td><td class="left">'tasker'</td></tr>
-    <tr><td class="num"> 16</td><td class="num"> 3.88</td><td class="left">'Mecki'</td></tr>
     <tr><td class="num"> 13</td><td class="num"> 5.23</td><td class="left">'Samuel'</td></tr>
     <tr><td class="num"> 13</td><td class="num"> 8.15</td><td class="left">'Ludmian'</td></tr>
     <tr><td class="num"> 11</td><td class="num"> 6.36</td><td class="left">'ShadowPhrogg32642342'</td></tr>
     <tr><td class="num"> 10</td><td class="num"> 7.80</td><td class="left">'hdwow'</td></tr>
+    <tr><td class="num">  9</td><td class="num"> 5.11</td><td class="left">'ais523'</td></tr>
     <tr><td class="num">  8</td><td class="num"> 3.25</td><td class="left">'Vlad'</td></tr>
     <tr><td class="num">  8</td><td class="num"> 7.63</td><td class="left">'Antonio EE'</td></tr>
     <tr><td class="num">  7</td><td class="num"> 4.29</td><td class="left">'Snaily'</td></tr>
+    <tr><td class="num">  7</td><td class="num"> 5.29</td><td class="left">'oxyd4ever'</td></tr>
     <tr><td class="num">  5</td><td class="num"> 6.80</td><td class="left">'Breezy'</td></tr>
     <tr><td class="num">  5</td><td class="num"> 9.20</td><td class="left">'HuB34'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 6.75</td><td class="left">'Agares'</td></tr>

Modified: homepage/input/table-solved.html
===================================================================
--- homepage/input/table-solved.html	2009-05-03 22:49:27 UTC (rev 1660)
+++ homepage/input/table-solved.html	2009-05-04 22:24:53 UTC (rev 1661)
@@ -1,28 +1,28 @@
   <table>
-    <caption>$$Solved_Level_Statistics$$ $$March$$ 2009</caption>
+    <caption>$$Solved_Level_Statistics$$ $$April$$ 2009</caption>
     <colgroup><col width="130"><col width="130"><col width="130"><col width="240"></colgroup>
     <tr><th>$$difficult$$</th><th>$$easy$$</th><th>$$total$$</th><th class="left">$$user$$</th></tr>
     <tr><td class="num">1045/1045</td><td class="num">189/189</td><td class="num">100.00%</td><td class="left">'ryujun'</td></tr>
     <tr><td class="num">1043/1045</td><td class="num">189/189</td><td class="num"> 99.84%</td><td class="left">'Taztunes'</td></tr>
-    <tr><td class="num">1038/1045</td><td class="num">189/189</td><td class="num"> 99.43%</td><td class="left">'dev0'</td></tr>
+    <tr><td class="num">1039/1045</td><td class="num">189/189</td><td class="num"> 99.51%</td><td class="left">'dev0'</td></tr>
+    <tr><td class="num">1035/1045</td><td class="num">183/189</td><td class="num"> 98.70%</td><td class="left">'Dime'</td></tr>
     <tr><td class="num">1029/1045</td><td class="num">186/189</td><td class="num"> 98.46%</td><td class="left">'daydreamer'</td></tr>
+    <tr><td class="num">1034/1045</td><td class="num">181/189</td><td class="num"> 98.46%</td><td class="left">'Moneymaker'</td></tr>
     <tr><td class="num">1029/1045</td><td class="num">185/189</td><td class="num"> 98.38%</td><td class="left">'Freshman'</td></tr>
     <tr><td class="num">1025/1045</td><td class="num">189/189</td><td class="num"> 98.38%</td><td class="left">'Ronald'</td></tr>
-    <tr><td class="num">1030/1045</td><td class="num">182/189</td><td class="num"> 98.22%</td><td class="left">'Dime'</td></tr>
     <tr><td class="num">1029/1045</td><td class="num">183/189</td><td class="num"> 98.22%</td><td class="left">'Craven'</td></tr>
     <tr><td class="num">1026/1045</td><td class="num">185/189</td><td class="num"> 98.14%</td><td class="left">'Ale'</td></tr>
-    <tr><td class="num">1032/1045</td><td class="num">179/189</td><td class="num"> 98.14%</td><td class="left">'Moneymaker'</td></tr>
     <tr><td class="num">1021/1045</td><td class="num">177/189</td><td class="num"> 97.08%</td><td class="left">'Malla'</td></tr>
     <tr><td class="num">1014/1045</td><td class="num">175/189</td><td class="num"> 96.35%</td><td class="left">'Stupid'</td></tr>
     <tr><td class="num"> 999/1045</td><td class="num">177/189</td><td class="num"> 95.30%</td><td class="left">'biotopa'</td></tr>
-    <tr><td class="num"> 982/1045</td><td class="num">175/189</td><td class="num"> 93.76%</td><td class="left">'Daisy'</td></tr>
+    <tr><td class="num"> 985/1045</td><td class="num">176/189</td><td class="num"> 94.08%</td><td class="left">'Daisy'</td></tr>
     <tr><td class="num"> 970/1045</td><td class="num">166/189</td><td class="num"> 92.06%</td><td class="left">'Andy'</td></tr>
-    <tr><td class="num"> 961/1045</td><td class="num">173/189</td><td class="num"> 91.90%</td><td class="left">'mecke'</td></tr>
+    <tr><td class="num"> 962/1045</td><td class="num">173/189</td><td class="num"> 91.98%</td><td class="left">'mecke'</td></tr>
     <tr><td class="num"> 949/1045</td><td class="num">170/189</td><td class="num"> 90.68%</td><td class="left">'para_doks'</td></tr>
-    <tr><td class="num"> 937/1045</td><td class="num">159/189</td><td class="num"> 88.82%</td><td class="left">'H-J.Epting'</td></tr>
+    <tr><td class="num"> 938/1045</td><td class="num">160/189</td><td class="num"> 88.98%</td><td class="left">'H-J.Epting'</td></tr>
+    <tr><td class="num"> 926/1045</td><td class="num">160/189</td><td class="num"> 88.01%</td><td class="left">'Mentist'</td></tr>
     <tr><td class="num"> 922/1045</td><td class="num">154/189</td><td class="num"> 87.20%</td><td class="left">'mrduke'</td></tr>
     <tr><td class="num"> 933/1045</td><td class="num">125/189</td><td class="num"> 85.74%</td><td class="left">'Alex'</td></tr>
-    <tr><td class="num"> 898/1045</td><td class="num">153/189</td><td class="num"> 85.17%</td><td class="left">'Mentist'</td></tr>
     <tr><td class="num"> 914/1045</td><td class="num">135/189</td><td class="num"> 85.01%</td><td class="left">'JuSt'</td></tr>
     <tr><td class="num"> 894/1045</td><td class="num">140/189</td><td class="num"> 83.79%</td><td class="left">'Johannes'</td></tr>
     <tr><td class="num"> 863/1045</td><td class="num">161/189</td><td class="num"> 82.98%</td><td class="left">'Tobias'</td></tr>
@@ -42,6 +42,7 @@
     <tr><td class="num"> 779/1045</td><td class="num">121/189</td><td class="num"> 72.93%</td><td class="left">'U-Punkt'</td></tr>
     <tr><td class="num"> 739/1045</td><td class="num">131/189</td><td class="num"> 70.50%</td><td class="left">'ABS'</td></tr>
     <tr><td class="num"> 728/1045</td><td class="num">126/189</td><td class="num"> 69.21%</td><td class="left">'B-Huff'</td></tr>
+    <tr><td class="num"> 734/1045</td><td class="num">108/189</td><td class="num"> 68.23%</td><td class="left">'Another'</td></tr>
     <tr><td class="num"> 762/1045</td><td class="num"> 73/189</td><td class="num"> 67.67%</td><td class="left">'redsantz'</td></tr>
     <tr><td class="num"> 791/1045</td><td class="num"> 38/189</td><td class="num"> 67.18%</td><td class="left">'alfred69'</td></tr>
     <tr><td class="num"> 734/1045</td><td class="num"> 82/189</td><td class="num"> 66.13%</td><td class="left">'bojster'</td></tr>
@@ -54,6 +55,7 @@
     <tr><td class="num"> 665/1045</td><td class="num"> 64/189</td><td class="num"> 59.08%</td><td class="left">'alain'</td></tr>
     <tr><td class="num"> 643/1045</td><td class="num"> 83/189</td><td class="num"> 58.83%</td><td class="left">'Great Scott'</td></tr>
     <tr><td class="num"> 714/1045</td><td class="num">  0/189</td><td class="num"> 57.86%</td><td class="left">'Gottseinsohn'</td></tr>
+    <tr><td class="num"> 604/1045</td><td class="num"> 94/189</td><td class="num"> 56.56%</td><td class="left">'Tiza'</td></tr>
     <tr><td class="num"> 620/1045</td><td class="num"> 72/189</td><td class="num"> 56.08%</td><td class="left">'Breezy'</td></tr>
     <tr><td class="num"> 636/1045</td><td class="num"> 55/189</td><td class="num"> 56.00%</td><td class="left">'fabian'</td></tr>
     <tr><td class="num"> 575/1045</td><td class="num">115/189</td><td class="num"> 55.92%</td><td class="left">'Mark P.'</td></tr>
@@ -61,8 +63,9 @@
     <tr><td class="num"> 599/1045</td><td class="num"> 80/189</td><td class="num"> 55.02%</td><td class="left">'serpent'</td></tr>
     <tr><td class="num"> 577/1045</td><td class="num">100/189</td><td class="num"> 54.86%</td><td class="left">'Zekobah'</td></tr>
     <tr><td class="num"> 634/1045</td><td class="num"> 43/189</td><td class="num"> 54.86%</td><td class="left">'Klaus'</td></tr>
+    <tr><td class="num"> 611/1045</td><td class="num"> 59/189</td><td class="num"> 54.29%</td><td class="left">'ais523'</td></tr>
     <tr><td class="num"> 576/1045</td><td class="num"> 93/189</td><td class="num"> 54.21%</td><td class="left">'Guglielmo'</td></tr>
-    <tr><td class="num"> 582/1045</td><td class="num"> 83/189</td><td class="num"> 53.89%</td><td class="left">'Tiza'</td></tr>
+    <tr><td class="num"> 552/1045</td><td class="num">107/189</td><td class="num"> 53.40%</td><td class="left">'oxyd4ever'</td></tr>
     <tr><td class="num"> 525/1045</td><td class="num"> 95/189</td><td class="num"> 50.24%</td><td class="left">'ShadowPhrogg32642342'</td></tr>
     <tr><td class="num"> 589/1045</td><td class="num"> 26/189</td><td class="num"> 49.84%</td><td class="left">'hdwow'</td></tr>
     <tr><td class="num"> 533/1045</td><td class="num"> 82/189</td><td class="num"> 49.84%</td><td class="left">'Wuzzy'</td></tr>
@@ -80,9 +83,9 @@
     <tr><td class="num"> 508/1045</td><td class="num"> 26/189</td><td class="num"> 43.27%</td><td class="left">'Feynman'</td></tr>
     <tr><td class="num"> 462/1045</td><td class="num"> 63/189</td><td class="num"> 42.54%</td><td class="left">'Liam Sheehan'</td></tr>
     <tr><td class="num"> 494/1045</td><td class="num"> 26/189</td><td class="num"> 42.14%</td><td class="left">'Daniel'</td></tr>
+    <tr><td class="num"> 454/1045</td><td class="num"> 65/189</td><td class="num"> 42.06%</td><td class="left">'Angolino'</td></tr>
     <tr><td class="num"> 506/1045</td><td class="num"> 12/189</td><td class="num"> 41.98%</td><td class="left">'Duffy'</td></tr>
     <tr><td class="num"> 503/1045</td><td class="num">  7/189</td><td class="num"> 41.33%</td><td class="left">'Edgar_Flesk'</td></tr>
-    <tr><td class="num"> 438/1045</td><td class="num"> 61/189</td><td class="num"> 40.44%</td><td class="left">'Angolino'</td></tr>
     <tr><td class="num"> 397/1045</td><td class="num"> 93/189</td><td class="num"> 39.71%</td><td class="left">'Hairball'</td></tr>
     <tr><td class="num"> 440/1045</td><td class="num"> 50/189</td><td class="num"> 39.71%</td><td class="left">'ged'</td></tr>
     <tr><td class="num"> 369/1045</td><td class="num">112/189</td><td class="num"> 38.98%</td><td class="left">'Jinajon'</td></tr>
@@ -90,6 +93,7 @@
     <tr><td class="num"> 359/1045</td><td class="num"> 74/189</td><td class="num"> 35.09%</td><td class="left">'Crystalicum'</td></tr>
     <tr><td class="num"> 392/1045</td><td class="num"> 40/189</td><td class="num"> 35.01%</td><td class="left">'hendrik'</td></tr>
     <tr><td class="num"> 391/1045</td><td class="num"> 36/189</td><td class="num"> 34.60%</td><td class="left">'Iceshark7'</td></tr>
+    <tr><td class="num"> 389/1045</td><td class="num"> 37/189</td><td class="num"> 34.52%</td><td class="left">'Mecki'</td></tr>
     <tr><td class="num"> 397/1045</td><td class="num"> 24/189</td><td class="num"> 34.12%</td><td class="left">'Chocolate Zero'</td></tr>
     <tr><td class="num"> 376/1045</td><td class="num"> 35/189</td><td class="num"> 33.31%</td><td class="left">'Jeffrey S'</td></tr>
     <tr><td class="num"> 392/1045</td><td class="num"> 12/189</td><td class="num"> 32.74%</td><td class="left">'NorthForty'</td></tr>
@@ -109,8 +113,6 @@
     <tr><td class="num"> 288/1045</td><td class="num"> 36/189</td><td class="num"> 26.26%</td><td class="left">'Drotten'</td></tr>
     <tr><td class="num"> 300/1045</td><td class="num"> 19/189</td><td class="num"> 25.85%</td><td class="left">'Nfol'</td></tr>
     <tr><td class="num"> 261/1045</td><td class="num"> 53/189</td><td class="num"> 25.45%</td><td class="left">'Andreas'</td></tr>
-    <tr><td class="num"> 266/1045</td><td class="num"> 39/189</td><td class="num"> 24.72%</td><td class="left">'oxyd4ever'</td></tr>
-    <tr><td class="num"> 269/1045</td><td class="num"> 26/189</td><td class="num"> 23.91%</td><td class="left">'Mecki'</td></tr>
     <tr><td class="num"> 276/1045</td><td class="num"> 15/189</td><td class="num"> 23.58%</td><td class="left">'Thomas'</td></tr>
     <tr><td class="num"> 250/1045</td><td class="num"> 40/189</td><td class="num"> 23.50%</td><td class="left">'Tomson'</td></tr>
     <tr><td class="num"> 258/1045</td><td class="num"> 27/189</td><td class="num"> 23.10%</td><td class="left">'un_guru'</td></tr>
@@ -121,6 +123,7 @@
     <tr><td class="num"> 210/1045</td><td class="num"> 38/189</td><td class="num"> 20.10%</td><td class="left">'Sandra'</td></tr>
     <tr><td class="num"> 208/1045</td><td class="num"> 33/189</td><td class="num"> 19.53%</td><td class="left">'Uli'</td></tr>
     <tr><td class="num"> 203/1045</td><td class="num"> 34/189</td><td class="num"> 19.21%</td><td class="left">'ntaeijr'</td></tr>
+    <tr><td class="num"> 214/1045</td><td class="num"> 22/189</td><td class="num"> 19.12%</td><td class="left">'Jonyzz'</td></tr>
     <tr><td class="num"> 214/1045</td><td class="num"> 19/189</td><td class="num"> 18.88%</td><td class="left">'Adonica'</td></tr>
     <tr><td class="num"> 188/1045</td><td class="num"> 33/189</td><td class="num"> 17.91%</td><td class="left">'Pascal'</td></tr>
     <tr><td class="num"> 209/1045</td><td class="num"> 11/189</td><td class="num"> 17.83%</td><td class="left">'GiannuzzITA'</td></tr>
@@ -136,6 +139,7 @@
     <tr><td class="num"> 163/1045</td><td class="num"> 10/189</td><td class="num"> 14.02%</td><td class="left">'tjRaven'</td></tr>
     <tr><td class="num"> 131/1045</td><td class="num"> 36/189</td><td class="num"> 13.53%</td><td class="left">'Enrymather'</td></tr>
     <tr><td class="num"> 164/1045</td><td class="num">  0/189</td><td class="num"> 13.29%</td><td class="left">'Bent'</td></tr>
+    <tr><td class="num"> 135/1045</td><td class="num"> 25/189</td><td class="num"> 12.97%</td><td class="left">'Medimaster'</td></tr>
     <tr><td class="num"> 124/1045</td><td class="num"> 33/189</td><td class="num"> 12.72%</td><td class="left">'joseba'</td></tr>
     <tr><td class="num"> 127/1045</td><td class="num"> 29/189</td><td class="num"> 12.64%</td><td class="left">'ael'</td></tr>
     <tr><td class="num"> 120/1045</td><td class="num"> 35/189</td><td class="num"> 12.56%</td><td class="left">'Kadu'</td></tr>

Modified: homepage/input/table-wr.html
===================================================================
--- homepage/input/table-wr.html	2009-05-03 22:49:27 UTC (rev 1660)
+++ homepage/input/table-wr.html	2009-05-04 22:24:53 UTC (rev 1661)
@@ -1,52 +1,51 @@
   <table>
-    <caption>$$Worldrecord_Statistics$$ $$March$$ 2009</caption>
+    <caption>$$Worldrecord_Statistics$$ $$April$$ 2009</caption>
     <colgroup><col width="80"><col width="80"><col width="470"></colgroup>
     <tr><th>$$total$$</th><th>$$shared$$</th><th class="left">$$user$$</th></tr>
-    <tr><td class="num">1009</td><td class="num">302</td><td class="left">'Moneymaker'</td></tr>
-    <tr><td class="num">196</td><td class="num">172</td><td class="left">'Crystalicum'</td></tr>
-    <tr><td class="num">175</td><td class="num">152</td><td class="left">'daydreamer'</td></tr>
-    <tr><td class="num">134</td><td class="num"> 87</td><td class="left">'Stupid'</td></tr>
-    <tr><td class="num"> 97</td><td class="num"> 91</td><td class="left">'Johannes'</td></tr>
-    <tr><td class="num"> 95</td><td class="num"> 79</td><td class="left">'dev0'</td></tr>
-    <tr><td class="num"> 81</td><td class="num"> 73</td><td class="left">'Mentist'</td></tr>
-    <tr><td class="num"> 47</td><td class="num"> 38</td><td class="left">'Duffy'</td></tr>
-    <tr><td class="num"> 46</td><td class="num"> 40</td><td class="left">'Daisy'</td></tr>
-    <tr><td class="num"> 38</td><td class="num"> 32</td><td class="left">'Ghatotkacha'</td></tr>
-    <tr><td class="num"> 37</td><td class="num"> 26</td><td class="left">'Malla'</td></tr>
-    <tr><td class="num"> 36</td><td class="num"> 36</td><td class="left">'Great Scott'</td></tr>
-    <tr><td class="num"> 35</td><td class="num"> 31</td><td class="left">'Angolino'</td></tr>
-    <tr><td class="num"> 32</td><td class="num"> 29</td><td class="left">'Alexandros'</td></tr>
-    <tr><td class="num"> 30</td><td class="num"> 28</td><td class="left">'Iceshark7'</td></tr>
-    <tr><td class="num"> 30</td><td class="num"> 29</td><td class="left">'Django'</td></tr>
+    <tr><td class="num">1054</td><td class="num">315</td><td class="left">'Moneymaker'</td></tr>
+    <tr><td class="num">199</td><td class="num">163</td><td class="left">'daydreamer'</td></tr>
+    <tr><td class="num">183</td><td class="num">174</td><td class="left">'Crystalicum'</td></tr>
+    <tr><td class="num">113</td><td class="num"> 77</td><td class="left">'Stupid'</td></tr>
+    <tr><td class="num"> 91</td><td class="num"> 85</td><td class="left">'Johannes'</td></tr>
+    <tr><td class="num"> 85</td><td class="num"> 76</td><td class="left">'dev0'</td></tr>
+    <tr><td class="num"> 79</td><td class="num"> 72</td><td class="left">'Mentist'</td></tr>
+    <tr><td class="num"> 48</td><td class="num"> 36</td><td class="left">'Medimaster'</td></tr>
+    <tr><td class="num"> 45</td><td class="num"> 41</td><td class="left">'Daisy'</td></tr>
+    <tr><td class="num"> 38</td><td class="num"> 33</td><td class="left">'Duffy'</td></tr>
+    <tr><td class="num"> 36</td><td class="num"> 35</td><td class="left">'Ghatotkacha'</td></tr>
+    <tr><td class="num"> 35</td><td class="num"> 26</td><td class="left">'Malla'</td></tr>
+    <tr><td class="num"> 34</td><td class="num"> 33</td><td class="left">'Angolino'</td></tr>
+    <tr><td class="num"> 32</td><td class="num"> 32</td><td class="left">'Great Scott'</td></tr>
+    <tr><td class="num"> 29</td><td class="num"> 27</td><td class="left">'Alexandros'</td></tr>
     <tr><td class="num"> 28</td><td class="num"> 26</td><td class="left">'Zekobah'</td></tr>
-    <tr><td class="num"> 28</td><td class="num"> 28</td><td class="left">'ryujun'</td></tr>
-    <tr><td class="num"> 26</td><td class="num"> 25</td><td class="left">'joseba'</td></tr>
-    <tr><td class="num"> 21</td><td class="num"> 18</td><td class="left">'Emmanuel'</td></tr>
-    <tr><td class="num"> 20</td><td class="num"> 19</td><td class="left">'ged'</td></tr>
+    <tr><td class="num"> 28</td><td class="num"> 27</td><td class="left">'Django'</td></tr>
+    <tr><td class="num"> 27</td><td class="num"> 27</td><td class="left">'Iceshark7' + 'ryujun'</td></tr>
+    <tr><td class="num"> 26</td><td class="num"> 26</td><td class="left">'joseba'</td></tr>
+    <tr><td class="num"> 19</td><td class="num"> 17</td><td class="left">'Emmanuel'</td></tr>
+    <tr><td class="num"> 17</td><td class="num"> 17</td><td class="left">'ged'</td></tr>
     <tr><td class="num"> 15</td><td class="num"> 13</td><td class="left">'B-Huff'</td></tr>
     <tr><td class="num"> 15</td><td class="num"> 15</td><td class="left">'Safalra' + 'Ludmian'</td></tr>
-    <tr><td class="num"> 14</td><td class="num"> 13</td><td class="left">'HuB34'</td></tr>
-    <tr><td class="num"> 13</td><td class="num">  8</td><td class="left">'Ronald'</td></tr>
-    <tr><td class="num"> 13</td><td class="num"> 13</td><td class="left">'bojster'</td></tr>
-    <tr><td class="num"> 10</td><td class="num">  9</td><td class="left">'Dime'</td></tr>
+    <tr><td class="num"> 13</td><td class="num"> 12</td><td class="left">'HuB34'</td></tr>
+    <tr><td class="num"> 12</td><td class="num">  8</td><td class="left">'Ronald'</td></tr>
+    <tr><td class="num"> 12</td><td class="num"> 12</td><td class="left">'bojster'</td></tr>
+    <tr><td class="num"> 11</td><td class="num"> 10</td><td class="left">'Dime'</td></tr>
     <tr><td class="num"> 10</td><td class="num"> 10</td><td class="left">'dpl'</td></tr>
-    <tr><td class="num">  9</td><td class="num">  5</td><td class="left">'ShadowPhrogg32642342'</td></tr>
-    <tr><td class="num">  9</td><td class="num">  7</td><td class="left">'Gloop'</td></tr>
-    <tr><td class="num">  9</td><td class="num">  9</td><td class="left">'fabian' + 'ABS'</td></tr>
+    <tr><td class="num">  9</td><td class="num">  6</td><td class="left">'ShadowPhrogg32642342'</td></tr>
+    <tr><td class="num">  9</td><td class="num">  8</td><td class="left">'Gloop'</td></tr>
+    <tr><td class="num">  9</td><td class="num">  9</td><td class="left">'fabian'</td></tr>
     <tr><td class="num">  8</td><td class="num">  7</td><td class="left">'Chocolate Zero'</td></tr>
+    <tr><td class="num">  8</td><td class="num">  8</td><td class="left">'H-J.Epting' + 'ABS'</td></tr>
     <tr><td class="num">  7</td><td class="num">  6</td><td class="left">'Edgar_Flesk'</td></tr>
-    <tr><td class="num">  6</td><td class="num">  3</td><td class="left">'Breezy'</td></tr>
-    <tr><td class="num">  6</td><td class="num">  5</td><td class="left">'Taztunes' + 'Guglielmo'</td></tr>
+    <tr><td class="num">  6</td><td class="num">  5</td><td class="left">'Guglielmo'</td></tr>
     <tr><td class="num">  6</td><td class="num">  6</td><td class="left">'Tobias'</td></tr>
-    <tr><td class="num">  5</td><td class="num">  3</td><td class="left">'para_doks'</td></tr>
-    <tr><td class="num">  5</td><td class="num">  4</td><td class="left">'Lukas'</td></tr>
-    <tr><td class="num">  5</td><td class="num">  5</td><td class="left">'Raoul' + 'Thomas' + 'Chris' + 'Wuzzy' + 'Ralf'</td></tr>
-    <tr><td class="num">  4</td><td class="num">  2</td><td class="left">'Hairball'</td></tr>
-    <tr><td class="num">  4</td><td class="num">  4</td><td class="left">'Sigma' + 'U-Punkt' + 'J3FF' + 'Cyphase' + 'GiannuzzITA' + 'mecke'</td></tr>
-    <tr><td class="num">  3</td><td class="num">  2</td><td class="left">'Stephanie'</td></tr>
+    <tr><td class="num">  5</td><td class="num">  3</td><td class="left">'Breezy'</td></tr>
+    <tr><td class="num">  5</td><td class="num">  4</td><td class="left">'Another'</td></tr>
+    <tr><td class="num">  5</td><td class="num">  5</td><td class="left">'Taztunes' + 'Raoul' + 'Thomas' + 'mecke' + 'Chris' + 'Wuzzy' + 'Ralf'</td></tr>
+    <tr><td class="num">  4</td><td class="num">  4</td><td class="left">'Sigma' + 'U-Punkt' + 'J3FF' + 'Cyphase' + 'para_doks' + 'GiannuzzITA' + 'Lukas'</td></tr>
+    <tr><td class="num">  3</td><td class="num">  2</td><td class="left">'Hairball' + 'Stephanie'</td></tr>
     <tr><td class="num">  3</td><td class="num">  3</td><td class="left">'geembo_90' + 'Tiza' + 'Neophilus' + 'Nicol?s' + 'Andy'</td></tr>
-    <tr><td class="num">  2</td><td class="num">  2</td><td class="left">'alfred69' + 'ReasonAnce' + 'mrduke' + 'H-J.Epting' + 'Drotten' + 'tjRaven' + 'Sim_Ed' + 'hendrik' + 'Bent' + 'Austin' + 'Snaily' + 'Craven' + 'Sopoforic' + 'Ingo' + 'serpent'</td></tr>
-    <tr><td class="num">  1</td><td class="num">  0</td><td class="left">'Ale' + 'Feynman' + 'alain' + 'colonel crayon' + 'Gorn' + 'Nat'</td></tr>
+    <tr><td class="num">  2</td><td class="num">  2</td><td class="left">'alfred69' + 'ReasonAnce' + 'mrduke' + 'Drotten' + 'tjRaven' + 'Sim_Ed' + 'hendrik' + 'Bent' + 'Austin' + 'Snaily' + 'Craven' + 'Sopoforic' + 'Ingo' + 'serpent'</td></tr>
+    <tr><td class="num">  1</td><td class="num">  0</td><td class="left">'Feynman' + 'alain' + 'colonel crayon' + 'Gorn' + 'Nat'</td></tr>
     <tr><td class="num">  1</td><td class="num">  1</td><td class="left">'Agares' + 'Tiger' + 'Zak' + 'Daniel' + 'Slav' + 'niebie' + 'Andreas' + 'AlephD' + 'Samuel' + 'Mark P.' + 'oblo' + 'Pascal' + 'hdwow' + 'B-man' + 'Asbel' + 'Vlad' + 'Jinajon' + 'Vaily' + 'Antonio EE' + 'JuSt' + 'Timo'</td></tr>
-    <tr><td class="num">  0</td><td class="num">  0</td><td class="left">'AQZ' + 'tasker' + 'jumbo' + 'Miel56' + 'Zhura' + 'Alf' + 'Turbogurk' + 'Gottseinsohn' + 'ntaeijr' + 'Eselchen' + 'ael' + 'biotopa' + 'brynn' + 'IntKecsk' + 'Adonica' + 'Joona' + 'Sandra' + 'schmusi20' + 'Kosby' + 'Magnus and Susi' + 'WP319' + 'Kevin' + 'jdrexler' + 'xmouse' + 'erich' + 'Vinksu' + 'Uli' + 'Alex' + 'Valkyrie2' + 'Fred_the_wise' + 'jdcampo' + 'Freshman' + 'Little_Mole' + 'Kroetchen' + 'crypto_rsa' + 'Harry Lim' + 'Sequoyah' + 'AkRa' + 'Momcat' + 'Tomson' + 'NorthForty' + 'Mecki' + 'The red O' + 'gringer' + 'IIkka' + 'Jeffrey S' + 'Nfol' + 'Marc-Hendrik' + 'Kadu' + 'shoki' + 'Enrymather' + 'jojo' + 'WesleyCrusher' + 'rima' + 'Klaus' + 'MicWa' + 'AsuCaga' + 'oxyd4ever' + 'Rugby4ever' + 'Archcorenth' + 'Meeve' + 'mhatta' + 'Hans-HD' + 'un_guru' + 'krazy62' + 'Dvorhagen' + 'Sparkey' + 'Holger' + 'Ingo_K' + 'Ant' + 'Melanie' + 'IChrisI' + 'redsantz' + 'Markus' + 'Michael' + 'Liam Sheehan' + '!
 Tarim' + 'Agnieszka'</td></tr>
+    <tr><td class="num">  0</td><td class="num">  0</td><td class="left">'AQZ' + 'tasker' + 'jumbo' + 'Miel56' + 'Zhura' + 'Alf' + 'Turbogurk' + 'Gottseinsohn' + 'ntaeijr' + 'Eselchen' + 'ael' + 'biotopa' + 'Ale' + 'brynn' + 'IntKecsk' + 'Adonica' + 'Joona' + 'Sandra' + 'schmusi20' + 'Kosby' + 'Magnus and Susi' + 'WP319' + 'Kevin' + 'jdrexler' + 'xmouse' + 'erich' + 'Vinksu' + 'Uli' + 'Alex' + 'Valkyrie2' + 'Fred_the_wise' + 'jdcampo' + 'Freshman' + 'Little_Mole' + 'Kroetchen' + 'crypto_rsa' + 'Harry Lim' + 'Sequoyah' + 'AkRa' + 'Momcat' + 'Tomson' + 'NorthForty' + 'Mecki' + 'The red O' + 'gringer' + 'IIkka' + 'Jeffrey S' + 'Nfol' + 'Marc-Hendrik' + 'Kadu' + 'shoki' + 'Enrymather' + 'jojo' + 'WesleyCrusher' + 'rima' + 'Klaus' + 'MicWa' + 'AsuCaga' + 'oxyd4ever' + 'Jonyzz' + 'Rugby4ever' + 'Archcorenth' + 'Meeve' + 'mhatta' + 'Hans-HD' + 'un_guru' + 'krazy62' + 'Dvorhagen' + 'Sparkey' + 'ais523' + 'Holger' + 'Ingo_K' + 'Ant' + 'Melanie' + 'IChrisI' + 'redsantz' + 'Markus' + !
 'Michael' + 'Liam Sheehan' + 'Tarim' + 'Agnieszka'</td></tr>
   </table>

Modified: homepage/input/userlist.html
===================================================================
--- homepage/input/userlist.html	2009-05-03 22:49:27 UTC (rev 1660)
+++ homepage/input/userlist.html	2009-05-04 22:24:53 UTC (rev 1661)
@@ -6,6 +6,7 @@
     <li>ael</li>
     <li>Agares</li>
     <li>Agnieszka</li>
+    <li>ais523</li>
     <li>AkRa</li>
     <li>alain</li>
     <li>Ale</li>
@@ -17,6 +18,7 @@
     <li>Andreas</li>
     <li>Andy</li>
     <li>Angolino</li>
+    <li>Another</li>
     <li>Ant</li>
     <li>Antonio EE</li>
     <li>AQZ</li>
@@ -88,6 +90,7 @@
     <li>Jinajon</li>
     <li>Johannes</li>
     <li>jojo</li>
+    <li>Jonyzz</li>
     <li>Joona</li>
     <li>joseba</li>
     <li>jumbo</li>
@@ -109,6 +112,7 @@
     <li>Markus</li>
     <li>mecke</li>
     <li>Mecki</li>
+    <li>Medimaster</li>
     <li>Meeve</li>
     <li>Melanie</li>
     <li>Mentist</li>



From hgb at mail.berlios.de  Tue May  5 19:30:18 2009
From: hgb at mail.berlios.de (hgb at mail.berlios.de)
Date: Tue, 5 May 2009 19:30:18 +0200
Subject: [Enigma-game-svn] r1662 - homepage/input/lotm
Message-ID: <200905051730.n45HUIHF012754@sheep.berlios.de>

Author: hgb
Date: 2009-05-05 19:29:59 +0200 (Tue, 05 May 2009)
New Revision: 1662

Modified:
   homepage/input/lotm/lotm_200904.html
   homepage/input/lotm/lotm_200904_de.html
   homepage/input/lotm/lotm_200904_yang.html
   homepage/input/lotm/lotm_200904_yang_de.html
Log:
Some Changes to Lotm 4/2009
- Corrected spelling and typos
- Adjusted the layout
- Added a missing image to lotm_200904_de
- Attached the appeal for more articles from our readers at the end of the files.

To do:
Nothing. No need to to bring the Russian version into line with the English one.


Modified: homepage/input/lotm/lotm_200904.html
===================================================================
--- homepage/input/lotm/lotm_200904.html	2009-05-04 22:24:53 UTC (rev 1661)
+++ homepage/input/lotm/lotm_200904.html	2009-05-05 17:29:59 UTC (rev 1662)
@@ -9,10 +9,10 @@
 <hr>
 <table>
 <tr><td>
-You are currently on the Yin side of this article. The Yang side is here: 
+You are currently on the Yin side of this article. The Yang side is here:
 </td><td>
-<a href="$$lotm_200904_yang$$"> 
-<img src="$$imagedir$$/lotm/lotm_200904_yang.png" 
+<a href="$$lotm_200904_yang$$">
+<img src="$$imagedir$$/lotm/lotm_200904_yang.png"
 alt="The magical yin-yang stone" border="0">
 </a>
 </td></tr>
@@ -21,10 +21,9 @@
 
 <p>This month we are presenting to you another level designed by Jacob the Buil
 &hellip; Sorry, by Jacob Scott. This author has become a legend not only among
-Enigma players, but, as we already know (see LotM 7/2008) in the world of
+Enigma players, but, as we already know (see <a href="$$lotm_200807$$">LotM 7/2008, Gods Of Enigma II</a>) in the world of
 marbles as well. He produces new excellent levels at such an astonishing speed
-that some Enigma connoisseurs started to doubt if he is a human at all (see LotM
-7/2007) and I should say their arguments sound rather convincing. </p>
+that some Enigma connoisseurs started to doubt if he were a human at all (see <a href="$$lotm_200707$$">LotM 7/2007, Elaborate</a>) and I should say their arguments sound rather convincing.</p>
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200904_e.png" alt="Level of the Month" border="0">
@@ -32,7 +31,7 @@
 </div>
 
 <table cellpadding="0" cellspacing="1" class="statistics">
-<caption class="normalcaption">Some records of February 2009 (Yin Mode)</caption>
+<caption class="normalcaption">Some records of February 2009 <br>(Yin Mode)</caption>
 <colgroup>
     <col width="80">
     <col width="160">
@@ -111,36 +110,36 @@
 
 <p>Puzzled? We mean Henry Blackball, of course. Yes, you are right, the very
 Henry Blackball, the famous traveler, the marble who ventured into more worlds
-of Enigma than any marble who lived before or after him. Already during his
-lifetime he became a legend. And when at the beginning of Age 1.0 he published
+of Enigma than any marble who lived before or since. Already during his
+lifetime he became a legend. And when at the beginning, at Age 1.0 he published
 his book &quot;Against the Four Elements and Other Adventures&quot; which became
-an instant bestseller he truly became a household name. His mysterious fate only
+an instant bestseller, he truly became a household name. His mysterious fate only
 strengthened the public interest in him: soon after the book was published he
-forsook the fame and wealth that came to him as a bestselling writer and
+forsook the fame and wealth that came to him as a bestselling author and
 embarked on his second journey to the World of Gods, leaving behind his fianc&eacute;,
 the beautiful Anna Whiteball. As constant readers of our LotM section must have
-guessed, he never came back. Neither did Anna Whiteball, who, anxious for Henry,
+guessed, he never returned. Neither did Anna Whiteball, who, anxious about Henry,
 soon left her house too, intent on aiding him in his journey. </p>
 
 <p>Those readers who have solved the level will probably notice that Henry
 Blackball was not the most accurate narrator. In his book he mixed truth and
 fiction, and many years after his disappearance marbles still argued how much of
-his book he actually experienced and how much he made up. The readers will
+his book he actually experienced and how much he fabricated. The readers will
 notice that sometimes Henry's narrative does look rather improbable. Some of the
 things he describes in this chapter have never been seen by other travelers who
-ventured into that world after him, which probably means that he's made those
-things up. Or has he? The worlds of Enigma are known to mysteriously change
-sometimes. Short and easy ways to the oxyds sometimes mysteriously disappear,
+ventured into that world after him, which probably means that he'd made those
+things up. Or hadn't he? The worlds of Enigma are known to mysteriously change
+sometimes. Short and easy ways to the oxyds sometimes unexpectedly disappear,
 and new obstacles arise. Maybe the world in question has undergone some changes
 as well since the time Henry visited it. Nevertheless, we had to omit some parts
-of the chapter for they would be too much of a spoiler for the readers who have
+of the chapter, for they would be too much of a spoiler for the readers who have
 not yet solved the level. </p>
 
 <p>For our article we used the definitive edition published by Marble Press. The
 first edition of Henry's book was heavily censored by the marble government who
 did not want to make the information about some of the Enigma worlds public.
-Later on, when struggle for white marble rights started to arise passages that
-did not go in line with political correctness were cut from his book as well.
+Later on, when struggle for white marble rights began, passages that
+were not 'politically correct' were cut from his book as well.
 Even his hilarious remarks about smallballs, little insect-like creatures who
 travel from world to world through special types of holes in the floor, were
 omitted, though up to now no one has managed to prove that smallballs have even
@@ -150,14 +149,16 @@
 
 <h3>Against the Four Elements and Other Adventures</h3>
 
-<h4>by Henry Blackball</h4>
+<h4><i>by Henry Blackball</i></h4>
 
 <h4>Chapter 23: How I Excelled in Planning Ahead</h4>
 
+<a name="back1"></a>
+
 <p>Slowly I opened my eyes. The narrow escape from the rotor was still vivid in
 my memory. I had touched the last oxyd in that crazy place just a moment before
 the damn creature would have broken me. I was lucky to transport myself and
-Monday[1] in time. </p>
+Monday<a href="#note1"><sup><small>1</small></sup></a> in time. </p>
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200904_a.png" alt="Level of the Month" border="0">
@@ -168,10 +169,10 @@
 Pond? Yes, there's a pond here, and &hellip; For the first time I really saw the
 place. It was a rather beautiful place, small, with lovely dark red floor and
 grey walls. There was a pond there, blocked by yellow walls on two sides, two
-one-way passages (I noticed that the floor there had started to crumble, need to
-take that into account if I actually have to use them), a few seeds were
+one-way passages (I noticed that the floor there had started to crumble. I need to
+take that into account if I actually have to use it), a few seeds were
 scattered on the floor and next to them lay an old worn-out bag. &quot;I wonder
-what happened to the poor soul who abandoned it&quot; I thought. But I decided
+what happened to the poor soul who abandoned it&quot;, I thought. But I decided
 that it's better not to dwell too much on that. </p>
 
 <p>And to the right were the oxyds. The oxyds? So easy to reach? The gods who
@@ -184,10 +185,12 @@
 puzzle, or risk the valuable extralives, fleeing from rotors. Disappointed,
 because you will hardly gain any fame, exploring worlds like this. </p>
 
+<a name="back2"></a>
+
 <p>As the world seemed rather easy, and there was no immediate danger there I
 decided that I had time for research. I took from my pocket a book I never
 parted with: &quot;Which God Has Made This Particular World?&quot; by William
-Whiteball[2]. For a millionth time I wondered why I kept on consulting the book.
+Whiteball<a href="#note2"><sup><small>2</small></sup></a>. For a millionth time I wondered why I kept on consulting the book.
 How can we possibly be sure that the gods of Enigma existed at all, let alone
 know what elements each of them preferred when creating worlds. But on the other
 hand &mdash; the old marble is said to have delved into many forbidden
@@ -195,6 +198,13 @@
 cast an eye upon for millennia. Maybe there is at least a grain of truth in his
 book. </p>
 
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200904_b.png" alt="Level of the Month" border="0">
+<div class="imagetitle">The stupid creature <br> had lost its Yin-Yang!</div>
+</div>
+
+<a name="back3"></a>
+
 <p>Okay, question 1: &quot;Have you been trying to solve the puzzles in this world
 for months, in spite of the fact that there's nothing hidden here? If it is true
 then go to question 2, if it is false go to question 5.&quot; Ha, no, the world
@@ -207,14 +217,10 @@
 don't have any. But enough of that! Let's open the oxyds and move on to a more
 interesting place. &quot;Hey, Monday!&quot; </p>
 
-<div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200904_b.png" alt="Level of the Month" border="0">
-<div class="imagetitle">The stupid creature <br> had lost its Yin-Yang!</div>
-</div>
-
 <p>But suddenly a frightening thought occurred to me. The stupid creature had
 lost its Yin-Yang! Well, you can't expect someone whose last name is Whitebrush
-to be particularly bright, but that's a little too much even for him[3]. Fear
+to be particularly bright, but that's a little too much even for him<a
+href="#note3"><sup><small>3</small></sup></a>. Fear
 gripped my heart with its cold icy fingers. I'm stuck in this place forever! No
 one will come to my rescue! But then I told myself, &quot;Well, Henry, don't
 panic! Sooner or later you'll be able to think of something&quot;. I slowly
@@ -230,20 +236,28 @@
 need to give Monday? Do I need to take anything with me from the other side of
 the pond? I pondered a little more. [..] </p>
 
+<a name="back4"></a>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200904_c.png" alt="Level of the Month" border="0">
+<div class="imagetitle">&quot;Mr Blackball, you haven't <br>got any of these umbrellas 
+<br>from Bizzaro World <br> on you, have you?&quot;</div>
+</div>
+
 <p>I entered the one-way passage, carrying just the necessary number of seeds in
 my bag. I couldn't but admire what a clever idea I had. Any other marble would
 get stuck in this place forever. But I found a way out even without a second
 Yin-Yang. When I entered Monday's half of the room I turned back and saw the
-last remnants of the floor crumble down. Just as I had already guessed I won't
+last remnants of the floor crumble down. Just as I had already guessed, I wouldn't
 be able to use that passage anymore. Quickly I rolled to Monday, gave him the
 bag, and told him about my plan. His eyes widened in wonder at my cleverness.
 The poor creature must have already lost all his hope to get out of here and
-been silently beweeping his fate[4]. </p>
+been silently bemoaning his fate<a href="#note4"><sup><small>4</small></sup></a>.</p>
 
 <p>Leaving the bag behind, I rolled to the dynamite stick behind a one-way
 stone. Suddenly something clicked. Gods, no! An invisible trigger! I madly
 looked around. A floor tile near the place where Monday lay had disappeared.
-Just that? Well, even for Monday it won't be that difficult to avoid the abyss.
+Just that? Well, even for Monday it wouldn't be that difficult to avoid the abyss.
 But suddenly I saw a flicker of movement there. Oh, no! A rotor jumped from the
 abyss. Then another &hellip; And another. They immediately directed towards
 Monday. I ran to intercept them. Just as the first of them was a hair's width
@@ -254,12 +268,6 @@
 careful. A little too slow, and they would break me to pieces. A little too
 fast, and they would loose sight of me. </p>
 
-<div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200904_c.png" alt="Level of the Month" border="0">
-<div class="imagetitle">Just as the first of them was <br> a hair's width
-behind <br> Monday I was there.</div>
-</div>
-
 <p>Here it is! The abyss! Suddenly I swerved to the left and ran as fast as I
 could. The slow-witted creatures didn't notice it at first and continued to run
 to the abyss. Delighted, I saw them falling down one after the other. Done! Now
@@ -271,6 +279,11 @@
 wall, praying to gods that it doesn't turn by itself until we are done opening
 the oxyds. </p>
 
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200904_d.png" alt="Level of the Month" border="0">
+<div class="imagetitle">&quot;Pardon me! Do you have <br>the correct time?&quot;</div>
+</div>
+
 <p>I took the dynamite and ran back to my half of the room, hearing the tiles
 crumble behind me. Suddenly I heard something else. I looked back. The clock! It
 started moving! [..] I pushed the last box into the water just when the clock
@@ -291,20 +304,31 @@
 millionth time what the next world that I saw would be like, what beautiful or
 horrible things I would see there. </p>
 
+<p><i>Ludmian Sedai</i></p>
+
+<h3>Annotations by the editor:</h3>
+
 <div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200904_d.png" alt="Level of the Month" border="0">
-<div class="imagetitle">Just then I saw <br> the crazy clock <br> turning towards me.</div>
+<a href="#back1">
+<img src="$$imagedir$$/lotm/lotm_200904_z.png"
+alt="Zur&uuml;ck" border="0">
+</a>
 </div>
 
-<h4>Annotations by the editor:</h4>
-
-<p>[1] A white marble whom Henry met on one of his journeys. His real name was
+<p><a name="note1"><b>1) </b></a>A white marble whom Henry met on one of his journeys. His real name was
 Jeremy Whitebrush. He traveled with Henry a lot and was a great help in many of
 his adventures. No one knows why Henry called him Monday. When asked about it in
 an interview he replied, &quot;I called him Monday because I first met him on
 Thursday&quot;. That's about all the information we've got. </p>
 
-<p>[2] Probably the most famous scholar of his time. His works, among which one
+<div class="lotmpic">
+<a href="#back2">
+<img src="$$imagedir$$/lotm/lotm_200904_z.png"
+alt="Zur&uuml;ck" border="0">
+</a>
+</div>
+
+<p><a name="note2"><b>2) </b></a>Probably the most famous scholar of his time. His works, among which one
 could name the definitive treatise &quot;On the Multiple Worlds of Enigma&quot;,
 a questionnaire for travelers &quot;Which God has Made This Particular
 World&quot; and the bestselling &quot;Item Transformation for Dummies&quot;, are
@@ -318,28 +342,61 @@
 some remote corners of the Universe of Enigma, but their credibility is widely
 doubted. </p>
 
-<p>[3] Let us forgive Henry his prejudices. He was a marble of his time, and in
+<div class="lotmpic">
+<a href="#back3">
+<img src="$$imagedir$$/lotm/lotm_200904_z.png"
+alt="Zur&uuml;ck" border="0">
+</a>
+</div>
+
+<p><a name="note3"><b>3) </b></a>Let us forgive Henry his prejudices. He was a marble of his time, and in
 the age when the book was written the struggle for political correctness has
-only started to hatch. In his defense we can say that his love for the beautiful
+only started to stir. In his defense we can say that his love for the beautiful
 Anna Whiteball changed him a lot and in the last years of his life he became a
 well-known and influential champion of white marbles' rights. </p>
 
-<p>[4] As Jeremy Whitebrush later explained in his interview, actually he had
+<div class="lotmpic">
+<a href="#back4">
+<img src="$$imagedir$$/lotm/lotm_200904_z.png"
+alt="Zur&uuml;ck" border="0">
+</a>
+</div>
+
+<p><a name="note4"><b>4) </b></a>As Jeremy Whitebrush later explained in his interview, actually he had
 found a way out long ago and was just waiting for the moment when Henry would
 deign to talk to him. </p>
 
-<p>
-Greets,<br>
-<i>Ludmian Sedai</i>
-</p>
+<hr>
 
-<p>Okay, and now &mdash; last but not least &mdash; the time has come to comply with Henry Blackball's request which he had uttered earlier on in his account and to <i>give proof</i> to him - all our regular readers certainly will not have questioned the fact - that there is more than just a grain of truth in the book by William Whiteball, and that <i>Jacob, the Builder</i>, of course really exists! Some days ago we received some words by him in which he describes further details about the construction of this masterpiece, which &mdash; not too surprisingly &mdash; sound a bit different from Henry's tale.</p>
+<div class="quote">
+Okay, and now &mdash; last but not least &mdash; the time has come to comply
+with Henry Blackball's request which he had uttered earlier on in his account
+and to <i>give proof</i> to him - all our regular readers certainly will not
+have questioned the fact - that there is more than just a grain of truth in the
+book by William Whiteball, and that <i>Jacob, the Builder</i>, of course really
+exists! Some days ago we received a writing by him in which he describes
+further details about the construction of this masterpiece, which &mdash; not
+too surprisingly &mdash; sound a bit different from Henry's tale.
+</div>
 
-<p>But very much to our surprise, <i>Jacob the Builder</i> seems to have met Henry Blackball at a later time somewhere on his journeys through the worlds of Enigma (probably in one of his own creations), at least the final sentence of his reflection on <i>Elegance</i> &mdash; which can be found on the <i>Yang</i> side &mdash; leads us to assume so.</p>
+<div class="quote">
+But very much to our surprise, <i>Jacob the Builder</i> seems to have met Henry
+Blackball at a later time somewhere on his journeys through the worlds of
+Enigma (probably in one of his own creations), at least the final sentence of
+his reflections on <i>Elegance</i> &mdash; which can be found on the <i>Yang</i>
+side &mdash; leads us to assume so.
+</div>
 
+<hr>
+
 <h4>&quot;Plan Ahead&quot; is actually one of my more recent levels.</h4>
 
-<div class="quote">
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200904_s.png" alt="Level of the Month" border="0">
+<div class="imagetitle">Seed Puzzle</div>
+</div>
+
+<p>
 I designed it kind of in the spirit of my &quot;Seed Puzzle&quot; (and related) levels, but with
 a little twist: now there are two marbles to control, but only one
 yin-yang. As much as I enjoyed creating the &quot;Seed Puzzle&quot; levels (and
@@ -356,14 +413,9 @@
 rather involves interacting with a bunch of different items. This may
 not increase the difficulty of the puzzle at all, but I think it
 certainly makes it more interesting.
-</div>
+</p>
 
-<div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200904_s.png" alt="Level of the Month" border="0">
-<div class="imagetitle">Seed Puzzle</div>
-</div>
-
-<div class="quote">
+<p>
 Looking back, &quot;Plan Ahead&quot; seems to contrast significantly with most of
 the other puzzle levels I've designed. The majority of them tend to
 involve either searching around some sort of labyrinth (like &quot;Labyrinth
@@ -378,17 +430,17 @@
 take on the theme of seed puzzles, this time set in a colorful and
 peaceful world that will challenge but reward all adventurers who choose
 to play within it.
-</div>
+</p>
 
-<div class="author">Jacob Scott</div>
+<p><i>Jacob Scott</i></p>
 
 <hr>
 <table>
 <tr><td>
-You are currently on the Yin side of this article. The Yang side is here: 
+You are currently on the Yin side of this article. The Yang side is here:
 </td><td>
-<a href="$$lotm_200904_yang$$"> 
-<img src="$$imagedir$$/lotm/lotm_200904_yin.png" 
+<a href="$$lotm_200904_yang$$">
+<img src="$$imagedir$$/lotm/lotm_200904_yin.png"
 alt="The magical yin-yang stone" border="0">
 </a>
 </td></tr>
@@ -396,15 +448,27 @@
 <hr>
 
 <!--<p>Dear reader, we have a constant need for articles from you about Enigma's
-great levels. Please, send us any articles, even comments, you write to:</p>
+great levels. </p>
+<p>We're particularly interested in articles about the following levels
+<br> &mdash; which are the 10 levels with the highest rating after our previous 20 Lotms:</p>
+<ul>
+<li>&quot;Doors forever&quot; by JuSt</li>
+<li>&quot;Cold Meditation&quot; by Ronald Lamprecht</li>
+<li>&quot;A Cooler Spot in Hell&quot; by Andreas Lochmann</li>
+<li>&quot;Gods of Enigma&quot; by moonpearl</li>
+<li>&quot;How Many Spirals?&quot; by Nat Pryce</li>
+<li>&quot;Don't Be Greedy&quot; by Jacob Scott </li>
+<li>&quot;Teamwork&quot; by Jacob Scott</li>
+<li>&quot;Prepare Your Defense&quot; by Jacob Scott</li>
+<li>&quot;Changing Positions&quot; by Lukas Sch?ller</li>
+<li>&quot;Little Puzzles&quot; by Jon 'WB' Sneyers</li>
+</ul>
+<p>Feel free to choose your favorite from these excellencies,
+<br>and send your reflections, reports, essays, poetry, inquiries, homeworks, diplomas to:
 <pre>
 <a href="mailto:enigma-devel at nongnu.org">enigma-devel at nongnu.org</a>
 </pre>
-<p>We're particularly interested in articles about the following levels:
 </p>
-<ul>
-<li>&quot;Little Puzzles&quot; by Jon 'WB' Sneyers</li>
-</ul>
 <p>Many thanks in advance, only your help can keep the LotM alive!</p>
 
 <p><i>Your Enigma Team</i></p>-->

Modified: homepage/input/lotm/lotm_200904_de.html
===================================================================
--- homepage/input/lotm/lotm_200904_de.html	2009-05-04 22:24:53 UTC (rev 1661)
+++ homepage/input/lotm/lotm_200904_de.html	2009-05-05 17:29:59 UTC (rev 1662)
@@ -36,7 +36,7 @@
 </div>
 
 <table cellpadding="0" cellspacing="1" class="statistics">
-<caption class="normalcaption">Einige Rekorde vom Februar 2009 (Yin Mode)</caption>
+<caption class="normalcaption">Einige Rekorde vom Februar 2009 <br>(Yin Mode)</caption>
 <colgroup>
 <col width="80">
 <col width="160">
@@ -300,6 +300,12 @@
 href="#note4"><sup><small>4</small></sup></a>.
 </p> 
 
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200904_c.png" alt="Level of the Month" border="0">
+<div class="imagetitle">&quot;Herr Blackball, Sie haben <br>nicht zuf&auml;llig noch einen 
+<br>von diesen Schirmen <br>aus Bizzaro World dabei?&quot;</div>
+</div>
+
 <p> Die Tasche bei Montag zur&uuml;cklassend, rollte ich hinunter zu der
 Dynamitstange hinter einem schwarzen Gleichrichter. Auf einmal h&ouml;rte ich
 etwas klicken. G&uuml;tige G&ouml;tter von Enigma! Ein unsichtbarer
@@ -321,11 +327,6 @@
 langsam, und sie w&uuml;rden mich in Einzelteile zerlegen. Ein wenig zu schnell,
 und sie w&uuml;rden mich aus den Augen verlieren. </p>
 
-<div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200904_c.png" alt="Level of the Month" border="0">
-<div class="imagetitle">Montag: Um Haaresbreite <br>seinem Schicksal entkommen.</div>
-</div>
-
 <p>Hier ist er! Der Abyss! Ich machte einen raschen Schwenker nach links, rollte
 im Bogen um den Abgrund herum und machte mich dann davon, so schnell ich konnte.
 Die gl&uuml;cklicherweise etwas begriffsstutzigen Kreaturen bemerkten nicht,
@@ -346,6 +347,12 @@
 G&ouml;ttern Enigmas, dass es sich nicht wieder umdrehen w&uuml;rde, bis wir mit
 dem &Ouml;ffnen der Oxyds fertig w&auml;ren. </p>
 
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200904_d.png" alt="Level of the Month" border="0">
+<div class="imagetitle">&quot;Entschuldigung, k&ouml;nnten 
+<br>Sie mir bitte sagen,<br> wie sp&auml;t es ist &hellip;&quot;</div>
+</div>
+
 <p>Ich nahm die Dynamitstange an mich und rannte zur&uuml;ck zu meiner Seite des
 Raums, und konnte h&ouml;ren, wie auch hier der br&uuml;chige Boden hinter mir
 zerfiel. Pl&ouml;tzlich vernahm ich ein weiteres Ger&auml;usch. Ich drehte mich
@@ -375,6 +382,8 @@
 n&auml;chste Welt beschaffen sein w&uuml;rde &mdash; welche entz&uuml;ckenden
 oder grauenhaften Dinge wohl dort auf uns warteten. </p>
 
+<p><i>Ludmian Sedai</i></p>
+
 <h3>Anmerkungen des Herausgebers: </h3>
 
 <div class="lotmpic">
@@ -383,13 +392,14 @@
 alt="Zur&uuml;ck" border="0">
 </a>
 </div>
+
 <p><a name="note1"><b>1)</b></a> Eine wei&szlig;e Murmel, die Henry auf einer
 seiner Reisen traf. Sein richtiger Name war Jeremy Whitebrush. Mit Henry
 unternahm er zahlreiche Reisen und war diesem eine gro&szlig;e Hilfe bei vielen
 seiner Abenteuer. Niemand wei&szlig;, warum Henry ihn Montag nannte. Als man
 Henry in einem Interview darauf ansprach, antwortete er: &quot;Ich nannte ihn
 Montag, weil ich ihn das erste Mal an einem Donnerstag traf&quot;. Das ist die
-einzige uns verf&uuml;gbare Information.  </p>
+einzige uns verf&uuml;gbare Information.</p>
 
 <div class="lotmpic">
 <a href="#back2">
@@ -397,6 +407,7 @@
 alt="Zur&uuml;ck" border="0">
 </a>
 </div>
+
 <p><a name="note2"><b>2)</b></a> Wahrscheinlich der ber&uuml;hmteste Gelehrte
 seiner Zeit. Seine Arbeiten, darunter die ma&szlig;gebliche Abhandlung
 &quot;&Uuml;ber die vielfachen Welten Enigmas&quot;, der fragebogenartige
@@ -412,7 +423,7 @@
 B&uuml;cher auf dem Boden verstreut lagen. Ihr Besitzer wurde seither nie wieder
 gesehen. Einige Murmeln behaupten zwar, dass sie ihn an einigen entfernten Ecken
 des Enigma-Universums zu Gesicht bekommen h&auml;tten, aber die
-Glaubw&uuml;rdigkeit dieser Aussagen wird weitgehend angezweifelt.  </p>
+Glaubw&uuml;rdigkeit dieser Aussagen wird weitgehend angezweifelt.</p>
 
 <div class="lotmpic">
 <a href="#back3">
@@ -420,6 +431,7 @@
 alt="Zur&uuml;ck" border="0">
 </a>
 </div>
+
 <p><a name="note3"><b>3)</b></a> Vergeben wir Henry seine Vorurteile. Er war
 eine Murmel seiner Zeit und in dem Zeitalter, als das Buch geschrieben wurde,
 hatte der Kampf gegen Diskriminierung jeglicher Art erst zu sprie&szlig;en
@@ -434,17 +446,16 @@
 alt="Zur&uuml;ck" border="0">
 </a>
 </div>
+
 <p><a name="note4"><b>4)</b></a> Wie Jeremy Whitebrush sp&auml;ter in einem
 Interview erkl&auml;rte, habe er eigentlich schon lange vorher einen Ausweg
 gefunden und nur darauf gewartet, dass Henry sich herablasse, mit ihm zu
 sprechen.  </p>
 
-<p>
-Sch&ouml;ne Gr&uuml;&szlig;e,<br>
-<i>Ludmian Sedai</i>
-</p>
+<hr>
 
-<p>Okay, und nun zu guter Letzt ist die Zeit gekommen, eine Frage zu
+<div class="quote">
+Okay, und nun zu guter Letzt ist die Zeit gekommen, eine Frage zu
 kl&auml;ren, die Henry Blackball zu Beginn seiner Erz&auml;hlung aufgeworfen hat
 (&quot;Welcher Gott hat diese besondere Welt erschaffen?&quot;, Frage 39), und
 den Nachweis daf&uuml;r zu liefern, dass tats&auml;chlich mehr als nur ein
@@ -454,17 +465,28 @@
 wirklich existiert! Vor einigen Tagen erreichte uns eine Nachricht von ihm, in
 der er Einzelheiten zur Entstehungsgeschichte seines Meisterwerkes preisgibt
 &mdash; und nicht allzu &uuml;berraschend &mdash; h&ouml;rt sich das Ganze etwas
-anders an, als das von Henry Geschilderte. </p>
+anders an, als das von Henry Geschilderte.
+</div>
 
-<p>Allerdings scheint Jacob &mdash; sehr zu unserer &Uuml;berraschung &mdash; zu
+<div class="quote">
+Allerdings scheint Jacob &mdash; sehr zu unserer &Uuml;berraschung &mdash; zu
 einer sp&auml;teren Zeit doch pers&ouml;nlich Bekanntschaft mit Henry Blackball
 gemacht zu haben, auf einer seiner Reisen durch die Welten Enigmas
 (m&ouml;glicherweise in einer der von ihm selbst geschaffenen); zumindest wagen
 wir, diese Vermutung aus dem Schlusssatz seiner Betrachtung &quot;&Uuml;ber
 Eleganz im Leveldesign&quot; zu entnehmen &mdash; diese befindet sich auf der
-<i>Yang</i> Seite unseres Artikels. </p>  <h4>Bei &quot;Plan Ahead&quot; handelt
-es sich eigentlich um eines meiner neueren Levels.</h4> 
+<i>Yang</i> Seite unseres Artikels.
+</div>
 
+<hr>
+
+<h4>Bei &quot;Plan Ahead&quot; handelt es sich eigentlich um eines meiner neueren Levels.</h4> 
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200904_s.png" alt="Level des Monats" border="0">
+<div class="imagetitle">Seed Puzzle</div>
+</div>
+
 <p>Entworfen im Geist meiner beiden &quot;Seed Puzzle&quot; (und &auml;hnlicher
 Levels) besitzt es aber eine kleine Wendung: zwei Murmeln sind zu kontrollieren,
 allerdings steht nur ein Yin-Yang zur Verf&uuml;gung. Den gleichen Spa&szlig;,
@@ -485,12 +507,7 @@
 mag die Schwierigkeit des Puzzles als Ganzes nicht erh&ouml;hen, aber sicherlich
 macht es die Sache interessanter, wie ich meine. </p>
 
-<div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200904_s.png" alt="Level des Monats" border="0">
-<div class="imagetitle">Seed Puzzle</div>
-</div>
-
-<div class="quote">Zur&uuml;ckblickend scheint &quot;Plan Ahead&quot; mit den
+<p>Zur&uuml;ckblickend scheint &quot;Plan Ahead&quot; mit den
 meisten anderen von mir entworfenen Puzzle-Levels erheblich zu kontrastieren. In
 der Mehrzahl von ihnen geht es entweder um die Erforschung einer Art von
 Labyrinth (wie z.B. &quot;Labyrinth of Puzzles&quot; oder &quot;Almost
@@ -506,9 +523,9 @@
 widerspiegelt. &quot;Plan Ahead&quot;, hoffe ich, sorgt damit f&uuml;r eine
 erfrischende Neuauflage des Seed-Puzzle-Themas: in diesem Fall in einem
 farbenfrohen und beruhigenden Umfeld, das alle Spieler, die bereit sind, in
-diese Welt einzutauchen, herausfordert &mdash; aber auch belohnt. </div>
+diese Welt einzutauchen, herausfordert &mdash; aber auch belohnt. </p>
 
-<div class="author">Jacob Scott</div>
+<p><i>Jacob Scott</i></p>
 
 <hr>
 <table>
@@ -523,4 +540,32 @@
 </table>
 <hr>
 
+<!--<p>Liebe Leserin, lieber Leser, wir haben ein st&auml;ndiges Bed&uuml;rfnis nach<br>
+Ihren Artikeln &uuml;ber Enigmas herausragende Levels. </p>
+<p>Wir sind besonders interessiert an Artikeln &uuml;ber die folgenden Levels<br>
+&mdash; welches die 10 Levels mit der h&ouml;chsten Bewertung sind, nach unseren bisherigen 20 LdMs:</p>
+<ul>
+<li>&quot;Doors forever&quot; von JuSt</li>
+<li>&quot;Cold Meditation&quot; von Ronald Lamprecht</li>
+<li>&quot;A Cooler Spot in Hell&quot; von Andreas Lochmann</li>
+<li>&quot;Gods of Enigma&quot; von moonpearl</li>
+<li>&quot;How Many Spirals?&quot; von Nat Pryce</li>
+<li>&quot;Don't Be Greedy&quot; von Jacob Scott </li>
+<li>&quot;Teamwork&quot; von Jacob Scott</li>
+<li>&quot;Prepare Your Defense&quot; von Jacob Scott</li>
+<li>&quot;Changing Positions&quot; von Lukas Sch&uuml;ller</li>
+<li>&quot;Little Puzzles&quot; von Jon 'WB' Sneyers</li>
+</ul>
+<p>Suchen sich ihren Liebkingslevel aus diesen 10 Kandidaten heraus,<br>
+und senden Sie ihre Betrachtungen, Berichte, Analysen, Untersuchungen, Erz&auml;hlungen, <br>
+Dichtungen, Briefromane, Notizen, Liebesbriefe, Tagebucheintr&auml;ge, Hausarbeiten, <br>
+Diploma, Schriftst&uuml;cke jeder Art an: 
+<pre>
+<a href="mailto:enigma-devel at nongnu.org">enigma-devel at nongnu.org</a>
+</pre>
+</p>
+<p>Vielen Dank im voraus, nur Ihre Mithilfe kann den LdM am Leben erhalten!
+</p>
+<p><i>Ihr Enigma-Team</i></p>-->
+
 </div>

Modified: homepage/input/lotm/lotm_200904_yang.html
===================================================================
--- homepage/input/lotm/lotm_200904_yang.html	2009-05-04 22:24:53 UTC (rev 1661)
+++ homepage/input/lotm/lotm_200904_yang.html	2009-05-05 17:29:59 UTC (rev 1662)
@@ -2,8 +2,8 @@
 $$lotm_header$$
 
 <h3 class="lotm">
-    <span class="date">April 2009: </span>
-    &quot;Plan Ahead&quot; by Jacob Scott
+<span class="date">April 2009: </span>
+&quot;Plan Ahead&quot; by Jacob Scott
 </h3>
 
 <hr>
@@ -12,21 +12,42 @@
 You are currently on the Yang side of this article. The Yin side is here:
 </td><td>
 <a href="$$lotm_200904$$">
-<img src="$$imagedir$$/lotm/lotm_200904_yin.png" 
+<img src="$$imagedir$$/lotm/lotm_200904_yin.png"
 alt="The magical yin-yang stone" border="0">
 </a>
 </td></tr>
 </table>
 <hr>
 
-<p>In October 2008 we presented the first contribution in the classic one-screen format as the &quot;Level of the Month&quot;: &quot;Industrial Puzzles&quot; by Raoul Bourquin (LotM 10/08). Then in December the second one-screener has been voted to join its companions on the Mount Olympus of excellent Enigma level productions: &quot;Procrustes&quot; by Andreas Lochmann (LotM 12/08). This month another level in the &quot;handy&quot; one-screen format will be awarded. But that surely doesn't mean, epic big adventures and long expeditions of discovery are out of fashion. Apparently the little chamber puzzle suites are showing that there's something rich about them, and that they're more than just a caprice, to be taken less seriously. 
+<p>In October 2008 we presented the first contribution in the classic one-screen
+format as the &quot;Level of the Month&quot;: &quot;Industrial Puzzles&quot; by
+Raoul Bourquin (LotM 10/08). Then in December the second one-screener has been
+voted to join its companions on the Mount Olympus of excellent Enigma level
+productions: &quot;Procrustes&quot; by Andreas Lochmann (LotM 12/08). This month
+another level in the &quot;handy&quot; one-screen format will be awarded. But
+that surely doesn't mean, epic big adventures and long expeditions of discovery
+are out of fashion. Apparently the little chamber puzzle suites are showing that
+there's something rich about them, and that they're more than just a caprice to
+be taken less seriously.
 </p>
 
-<p>One of these levels is riddled with mirrors and mysteries, laserbeams are whizzing by in this industrial brick building, so that it's hard to believe, that it will work out well. Somewhere else a conflagration is blazing, inside an ancient inn, a &quot;welcome&quot; game strangely attractive in its own way: Procrustes himself had invited. There's nothing blazing in Jacob Scott's &quot;Plan Ahead&quot;, everything seems so strangely quiet, static, and the two actors give the impression that the whole level is supposed to be a mathematical equation, calling for balance, transformation, elimination:
+<p>One of these levels is riddled with mirrors and mysteries; laserbeams are
+whizzing by in this industrial brick building, so that it's hard to believe
+that it will work out well. Somewhere else a conflagration is blazing inside
+an ancient inn, a &quot;welcome&quot; game strangely attractive in its own way:
+An invitation from Procrustes himself. There's nothing blazing in Jacob Scott's
+&quot;Plan Ahead&quot;, everything seems so strangely quiet and still, and the
+two actors give the impression that the whole level is supposed to be a
+mathematical equation, calling for balance, transformation, elimination:
 </p>
 <p>White marble + 2 dynamites + y oxyds = Black marble + x seeds + bag + y oxyds (?)
 </p>
-<p>This level creation is everything but a wild action level, action with deliberation is asked from the player. Metaphorically speaking it resembles a symmetric baroque style dungeon housing two inmates who are enjoying more or less freedom of movement, and who know: Only when all oxyds are shining, they have succeeded in escaping from this dungeon level &mdash; and only then the silver or the gold medal is bestowed upon the player. :-)
+<p>This level creation is everything but a wild action level; it calls for
+action with deliberation from the player. Metaphorically speaking it resembles
+a symmetric baroque-style dungeon housing two inmates who are enjoying
+more-or-less freedom of movement, and who know: Only when all oxyds are shining,
+they have succeeded in escaping from this dungeon level &mdash; and only then
+the silver or the gold medal is bestowed upon the player. :-)
 </p>
 
 <div class="lotmpic">
@@ -35,116 +56,140 @@
 </div>
 
 <table cellpadding="0" cellspacing="1" class="statistics">
-<caption class="normalcaption">Some record of February 2009 (Yang mode)</caption>
+<caption class="normalcaption">Some record of February 2009 <br>(Yang mode)</caption>
 <colgroup>
-    <col width="80">
-    <col width="160">
+<col width="80">
+<col width="160">
 </colgroup>
 <tbody>
-    <tr><td class="num">0:47</td>
-        <td class="left">Moneymaker</td></tr>
-    <tr><td class="num">0:50</td>
-        <td class="left">Stupid</td></tr>
-    <tr><td class="num">0:58</td>
-        <td class="left">daydreamer</td></tr>
-    <tr><td class="num">1:10</td>
-        <td class="left">Daisy</td></tr>
-    <tr><td class="num">1:11</td>
-        <td class="left">Mentist</td></tr>
-    <tr><td class="num">1:12</td>
-        <td class="left">ryujun</td></tr>
-    <tr><td class="num">1:15</td>
-        <td class="left">Ronald</td></tr>
-    <tr><td class="num">1:16</td>
-        <td class="left">Jinajon</td></tr>
-    <tr><td class="num">1:17</td>
-        <td class="left">Django+dev0</td></tr>
-    <tr><td class="num">1:21</td>
-        <td class="left">B-Huff+Malla</td></tr>
-    <tr><td class="num">1:25</td>
-        <td class="left">Dime</td></tr>
-    <tr><td class="num">1:26</td>
-        <td class="left">Gloop+Safalra</td></tr>
-    <tr><td class="num">1:30</td>
-        <td class="left">Emmanuel+mecke</td></tr>
-    <tr><td class="num">1:31</td>
-        <td class="left">Alexandros</td></tr>
-    <tr><td class="num">1:33</td>
-        <td class="left">Freshman</td></tr>
-    <tr><td class="num">1:34</td>
-        <td class="left">Alex</td></tr>
-    <tr><td class="num">1:35</td>
-        <td class="left">U-Punkt</td></tr>
-    <tr><td class="num">1:39</td>
-        <td class="left">Taztunes</td></tr>
-    <tr><td class="num">1:40</td>
-        <td class="left">ABS</td></tr>
-    <tr><td class="num">1:42</td>
-        <td class="left">Craven</td></tr>
-    <tr><td class="num">1:43</td>
-        <td class="left">Tobias+Ludmian</td></tr>
-    <tr><td class="num">1:45</td>
-        <td class="left">para_doks</td></tr>
-    <tr><td class="num">1:51</td>
-        <td class="left">JuSt</td></tr>
-    <tr><td class="num">1:58</td>
-        <td class="left">mrduke</td></tr>
-    <tr><td class="num">1:59</td>
-        <td class="left">Ale+Raoul</td></tr>
-    <tr><td class="num">2:03</td>
-        <td class="left">shoki</td></tr>
-    <tr><td class="num">2:09</td>
-        <td class="left">biotopa</td></tr>
-    <tr><td class="num">2:17</td>
-        <td class="left">Hans-HD</td></tr>
-    <tr><td class="num">2:31</td>
-        <td class="left">Mark P.</td></tr>
-    <tr><td class="num">2:36</td>
-        <td class="left">WP319</td></tr>
-    <tr><td class="num">2:37</td>
-        <td class="left">gringer</td></tr>
-    <tr><td class="num">2:38</td>
-        <td class="left">H-J.Epting</td></tr>
-    <tr><td class="num">2:54</td>
-        <td class="left">Melanie</td></tr>
-    <tr><td class="num">3:14</td>
-        <td class="left">Andy</td></tr>
-    <tr><td class="num">4:38</td>
-        <td class="left">AlephD</td></tr>
-    <tr><td class="num">8:10</td>
-        <td class="left">brynn</td></tr>
+<tr><td class="num">0:47</td>
+	<td class="left">Moneymaker</td></tr>
+<tr><td class="num">0:50</td>
+	<td class="left">Stupid</td></tr>
+<tr><td class="num">0:58</td>
+	<td class="left">daydreamer</td></tr>
+<tr><td class="num">1:10</td>
+	<td class="left">Daisy</td></tr>
+<tr><td class="num">1:11</td>
+	<td class="left">Mentist</td></tr>
+<tr><td class="num">1:12</td>
+	<td class="left">ryujun</td></tr>
+<tr><td class="num">1:15</td>
+	<td class="left">Ronald</td></tr>
+<tr><td class="num">1:16</td>
+	<td class="left">Jinajon</td></tr>
+<tr><td class="num">1:17</td>
+	<td class="left">Django+dev0</td></tr>
+<tr><td class="num">1:21</td>
+	<td class="left">B-Huff+Malla</td></tr>
+<tr><td class="num">1:25</td>
+	<td class="left">Dime</td></tr>
+<tr><td class="num">1:26</td>
+	<td class="left">Gloop+Safalra</td></tr>
+<tr><td class="num">1:30</td>
+	<td class="left">Emmanuel+mecke</td></tr>
+<tr><td class="num">1:31</td>
+	<td class="left">Alexandros</td></tr>
+<tr><td class="num">1:33</td>
+	<td class="left">Freshman</td></tr>
+<tr><td class="num">1:34</td>
+	<td class="left">Alex</td></tr>
+<tr><td class="num">1:35</td>
+	<td class="left">U-Punkt</td></tr>
+<tr><td class="num">1:39</td>
+	<td class="left">Taztunes</td></tr>
+<tr><td class="num">1:40</td>
+	<td class="left">ABS</td></tr>
+<tr><td class="num">1:42</td>
+	<td class="left">Craven</td></tr>
+<tr><td class="num">1:43</td>
+	<td class="left">Tobias+Ludmian</td></tr>
+<tr><td class="num">1:45</td>
+	<td class="left">para_doks</td></tr>
+<tr><td class="num">1:51</td>
+	<td class="left">JuSt</td></tr>
+<tr><td class="num">1:58</td>
+	<td class="left">mrduke</td></tr>
+<tr><td class="num">1:59</td>
+	<td class="left">Ale+Raoul</td></tr>
+<tr><td class="num">2:03</td>
+	<td class="left">shoki</td></tr>
+<tr><td class="num">2:09</td>
+	<td class="left">biotopa</td></tr>
+<tr><td class="num">2:17</td>
+	<td class="left">Hans-HD</td></tr>
+<tr><td class="num">2:31</td>
+	<td class="left">Mark P.</td></tr>
+<tr><td class="num">2:36</td>
+	<td class="left">WP319</td></tr>
+<tr><td class="num">2:37</td>
+	<td class="left">gringer</td></tr>
+<tr><td class="num">2:38</td>
+	<td class="left">H-J.Epting</td></tr>
+<tr><td class="num">2:54</td>
+	<td class="left">Melanie</td></tr>
+<tr><td class="num">3:14</td>
+	<td class="left">Andy</td></tr>
+<tr><td class="num">4:38</td>
+	<td class="left">AlephD</td></tr>
+<tr><td class="num">8:10</td>
+	<td class="left">brynn</td></tr>
 </tbody>
 </table>
 
 <h4>Welcome to the dungeon of Yin and Yang</h4>
 
-<p>No guards are left inside this prison to upset our marbles' plans, <i>Black</i> and <i>White</i> are left to their own devices. In peaceful seclusion both inmates can think about a solution to escape their fate. A &quot;dialogue of thoughts&quot; arises.
+<p>No guards are left inside this prison to upset our marbles' plans,
+<i>Black</i> and <i>White</i> are left to their own devices. In peaceful
+seclusion both inmates can think about a solution to escape their fate. A
+&quot;dialogue of thoughts&quot; arises.
 </p>
-<p><i>White</i> whispers to <i>Black</i>: &quot;Hey you, over there! Come over here to my side. But watch the brittle floor, it can only be stepped on once, before it crumbles into the abyss. You've got these five seeds, put them into the bag and take it with you. This might be our last meal.&quot; <i>White</i> looks at his watch and notices that time goes, his stomach gives a rumble and then he continues to speak: &quot;Hey, over here on my side the guards have left 2 dynamites in 2 siderooms, before they got away and abandoned us to our fate.&quot;
+<p><i>White</i> whispers to <i>Black</i>: &quot;Hey you, over there! Come over
+here to my side. But watch the brittle floor, it can only be stepped on once,
+before it crumbles into the abyss. You've got these five seeds. Put them into
+the bag and take it with you. This might be our last meal.&quot; <i>White</i>
+looks at his watch and notices the passing time. His stomach gives a rumble
+and then he continues to speak: &quot;Hey, over here on my side the guards have
+left two sticks of dynamite in the storerooms, before they got away and
+abandoned us to our fate.&quot;
 </p>
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200904_p.png" alt="Level of the Month" border="0">
-<div class="imagetitle">Yang, we're getting closer! <br>We're only one seed <br>short this time.<br></div>
+<div class="imagetitle">Yang, we're getting closer!
+<br>We're only one seed <br>short this time.</div>
 </div>
 
-<p>Spitefully they howled: &quot;We grant our guests one last chance to escape their fate to die of starvation. With the dynamites the two damned may blast the walls next to the pool, to take a refreshing bath in the cosy and warm waters of caustic soda.&quot; BWAHAHA!! 
+<p>Spitefully they howled: &quot;We grant our guests one last chance to escape
+their fate to die of starvation. With the dynamite the two may damned-well blast
+the walls next to the pool, to take a refreshing bath in the cosy and warm
+waters of caustic soda.&quot; BWAHAHA!!
 </p>
 <p>From our fountain of youth, no one returns,<br>
-oh this water, like fire it burns.<br> 
-In our spa the infirmities of age,<br>
+oh this water, like fire it burns.<br>
+In our spa, the infirmities of age,<br>
 all are cured, thanks to Na-O-H.<br>
 </p>
 <p>BWAHAHA!! BWAHAHA!!
 </p>
-<p>Black thinks about it carefully, then cries out hysterically: &quot;I know the constructor of this dungeon! 'Duffy' he calls himself. Many of his buildings seem to be impossible to solve, but however hopelessly the situation appears to be, he always provides the visitor with a solution, although it may be well concealed. So there must be a way &mdash; no, there is a way &mdash; to open all oxyds and to survive this challenge unscathed. Let's think it over.&quot; 
+<p>Black thinks about it carefully, then cries out hysterically: &quot;I know
+the architect of this dungeon! 'Duffy' he calls himself. Many of his buildings
+seem to be impossible to escape, but however hopelessly the situation appears
+to be, he always provides the visitor with a solution, although it may be well
+concealed. So there must be a way &mdash; no, there is a way &mdash; to open
+all oxyds and to survive this challenge unscathed. Let's think it over.&quot;
 </p>
-<p>Ahead &hellip; Look ahead &hellip; 
-</p>
-<h4>Welcome to Jacob Scott's (aka Duffy) &quot;Plan Ahead&quot;! :-)</h4>
+<p>Ahead &hellip; Look ahead &hellip; </p>
 
-<h4>1. Here, there and back again</h4> 
+<h3>Welcome to Jacob Scott's (aka Duffy) &quot;Plan Ahead&quot;! :-)</h3>
 
-<p><i>Black</i> inspects her opportunities and thinks: Once I can get around the pool, over to <i>White</i> and back again, following the arrow signs &mdash; but only once, then the path has crumbled away. I'll have to seize this opportunity with both hands. I must use it to make a permanent connection, right-left, East-West, which ideally can be used by my <i>white</i> partner, to open the one oxyd here on my side, which is only accessible to <i>White</i>.
+<h4>1. Here, there and back again</h4>
+
+<p><i>Black</i> inspects her opportunities and thinks: &quot;I can get around
+the pool once; over to <i>White</i> and back again, following the arrow signs
+&mdash; but only once, then the path will have crumbled away. I'll have to seize
+this opportunity with both hands. I must make a permanent connection, right-left,
+east-west, which ideally can be used by my <i>white</i> partner, to open the
+one oxyd here on my side, which is only accessible to <i>White</i>.&quot;
 </p>
 <h4>2. A game of Yin and Yang</h4>
 
@@ -153,26 +198,41 @@
 <div class="imagetitle">White dreams - <br>Black ways</div>
 </div>
 
-<p><i>White</i> murmurs: Why is the one of us allowed to do things, which are forbidden to the other one? Which creator defined me to be <i>white</i>? And why shouldn't I be allowed to stroll along a <i>black</i> arcade, gracious Gods of Enigma? How much easier life would be, if I'd be able to do everything &mdash; if I were allowed to do anything I'd like to do &hellip; And that also should apply to my dear partner Yin over there! Then I wouldn't need to wait until she finds a way to get to me &mdash; and Duffy, the constructor, couldn't stop me, Yang, from going <i>black</i> ways.
+<p><i>White</i> murmurs: &quot;Why is the one of us allowed to do things, which
+are forbidden to the other one? Which creator defined me to be <i>white</i>?
+And why shouldn't I be allowed to stroll along a <i>black</i> arcade, gracious
+Gods of Enigma? How much easier life would be, if I were able to do everything
+&mdash; if I were allowed to do anything I'd like to do &hellip; And that also
+should apply to my dear partner Yin over there! Then I wouldn't need to wait
+until she finds a way to get to me &mdash; and Duffy, the architect, couldn't
+stop me, Yang, from going <i>black</i> ways.&quot;
 </p>
 <h4>3. Divided world</h4>
 
 <p>Both are shouting in chorus: &quot;Duffy, what have you done to us?
 Incarcerated in this joyless world, separated from each other &mdash; with all
-these odd items: dynamites, birdseed and an empty bag.&quot; And it starts
-dawning on both of them: &quot;With the two dynamites blast holes into the walls
+these odd items: dynamite sticks, birdseed and an empty bag.&quot; And it starts
+dawning on both of them: &quot;With the two dynamite sticks we can blast holes into the walls
 to the right and the left of the pool, and then build a bridge across Duffy's
 'dishwater' by means of the special properties of the seeds. That
 should work. And then find a way to make the black and white arcades passable
 for the marble of the opposite color &mdash; and to get out of the
-'dynamite alcoves' again, by transforming the 'one-ways'
+'ammunition depots' again, by transforming the 'one-ways'
 into 'two-ways', or whatever.&quot;
 </p>
 <p>They're getting closer to the solution &mdash; together they can work it out!
 </p>
-<h4>4. Gaining extra-space within the own inventory &mdash; About the metamorphosis of a seed</h4>
+<h4>4. Gaining extra-space within one's own inventory &mdash;
+About the metamorphosis of a seed</h4>
 
-<p><i>Black</i> understands: She must bring seeds to Yang, the white marble, on her &quot;one-way&quot; tour around the pool &mdash; but how? In the story of the Creation the Gods of Enigma implanted a very special quality in the seeds, which is of particular relevance: A &quot;planted&quot; seed grows into a movable wooden box, the Gods named it &quot;st_box&quot;. Player, make the most of this quality! But watch out! If Yin picks up a seed, betakes herself over to Yang and rashly &quot;presents&quot; her gift to him, well then &hellip; it's time to &quot;unwrap&quot; another gift from the Gods: F3 :-(
+<p><i>Black</i> understands: She must bring seeds to Yang, the <i>white</i> marble,
+on her &quot;one-way&quot; tour around the pool &mdash; but how? In the story of
+the Creation the Gods of Enigma implanted a very special quality in the seeds,
+which is of particular relevance: A &quot;planted&quot; seed grows into a movable
+wooden box, the Gods renamed it &quot;st_box&quot;. Player, make the most of this
+attribute! But watch out! If Yin picks up a seed, runs over to Yang and rashly
+&quot;presents&quot; her gift to him, well then &hellip; it's time to &quot;unwrap&quot;
+another gift from the Gods: Shift-F3 :-(
 </p>
 <p>The bag! Player, make use of the bag!<br>
 Open brackets / close brackets = Open bag / close bag<br>
@@ -185,11 +245,22 @@
 <div class="imagetitle">Delivery - <br>what's inside the bag?</div>
 </div>
 
-<p>First Yin is the active marble, if she switches to Yang using her yin-yang-item and transmits the power on him, her partner isn't capable of bringing her back into the game, however much he'd like to &mdash; Yin stays passive for a very long time &mdash; in difficult mode forever. Player! Be careful that you &quot;hand over&quot; at the right moment! At long last both of the marbles will thank you for doing so. :-)
+<p>First Yin is the active marble, if she switches to Yang using her
+yin-yang-item and transmits the power on him, her partner isn't capable of
+bringing her back into the game, however much he'd like to &mdash; Yin stays
+passive for a very long time &mdash; in difficult mode forever. Player! Be
+careful that you &quot;make the transfer&quot; at the right moment!
+Ultimately both of the marbles will thank you for doing so. :-)
 </p>
 <h4>Conclusion:</h4>
 
-<p>This onescreener is completely different from &quot;Industrial Puzzles&quot; for instance, it's a yin-yang level, with a plain symmetrical structure, everything's revealed right from the start &mdash; WYSIWYG. That such a small and clear level can cause so much &quot;trouble&quot;: many thanks to Jacob Scott for this &quot;fugue&quot; of inspiration. At the beginning one wouldn't really expect it to require so much knowledge, timing and precision &mdash; and &quot;planning ahead&quot;. 
+<p>This onescreener is completely different from &quot;Industrial Puzzles&quot;
+for instance, it's a yin-yang level, with a plain symmetrical structure,
+everything's revealed right from the start &mdash; WYSIWYG. That such a small
+and clear level can cause so much &quot;trouble&quot;: many thanks to Jacob Scott
+for this &quot;fugue&quot; of inspiration. At the beginning one wouldn't really
+expect it to require so much knowledge, timing and precision &mdash; and
+&quot;planning ahead&quot;.
 </p>
 
 <p>Yin and Yang, symbolized by different colors, separated in time and space by
@@ -198,21 +269,43 @@
 the level. Teamwork and faith in each other have been the secret of their
 success: <i>Who</i> switches <i>when</i> to <i>whom</i>, and <i>where</i> does
 <i>who</i> use <i>what</i> and <i>when</i>? Duffy's order of things has to be
-broken to establish a physical connection. Within the beautifully dusted <a
+solved to establish a physical connection. Within the beautifully dusted <a
 href="$$lotm_200810$$">factory hall</a> order had to be reestablished to get the
-production going again. Easy answers unwelcome. Like in everyday life. ;-)
+production going again. Easy answers are unwelcome. Like in everyday life. ;-)
 </p>
 
-<p>I'd like to spare myself further hymns of praise: &quot;Plan Ahead&quot; is a precious piece of &quot;chamber&quot; music of the level author, who has composed such lovely symphonies like &quot;Island Labyrinth&quot;, and who's given so much pleasure to the enthusiasts of Enigma &mdash; and so he has done again with this composition. Thank you very much! Well, and I'd like to &quot;look ahead&quot; and give expression to my hopes, that the next excellent Duffy levels will be coming soon. Plan it again, Duffy! :-)
+<p>I'd like to spare myself further hymns of praise: &quot;Plan Ahead&quot; is
+a precious piece of &quot;chamber&quot; music by the level author, who has
+composed such lovely symphonies like &quot;Island Labyrinth&quot;, and who's
+given so much pleasure to the enthusiasts of Enigma &mdash; and so he has done
+again with this composition. Thank you very much! Well, I'd like to
+&quot;look ahead&quot; and express my hope that more excellent Duffy levels will
+be coming soon. Plan it again, Duffy! :-)
 </p>
 
-<p>Greets,<br>
-<i>Mecke</i></p>
+<p><i>Mecke</i></p>
 
-<p>Many thanks for your inspiring words, Dear Mecke. We can reassure you and all our readers as well as all Enigma players and Duffy fans: There'll definitely be &quot;several&quot; excellent creations by Jacob Scott among the levels in the next release of Enigma, although no new compositions &mdash; the creator of countless Enigma worlds is currently celebrating his well-earned &quot;seventh day&quot;. But some of these &quot;new old&quot; works are really remarkable, and possibly we will encounter some of them here again in the near future.</p>
+<hr>
 
-<p>Besides the inquiry on his level of the month &mdash; which can be found on the Yin side of the article &mdash; we also received some reflections on level designing in general from the author, which will make a worthy final movement of our Yin-Yang article composition. Most of what is said in these sentences not only applies to &quot;Plan Ahead&quot;, but to many other excellent creations by Jacob &mdash; and to many others of our &quot;Levels of the Month&quot;.</p>
+<div class="quote">Many thanks for your inspiring words, Dear Mecke. We can
+reassure you and all our readers as well as all Enigma players and Duffy fans:
+There'll definitely be &quot;several&quot; excellent creations by Jacob Scott
+among the levels in the next release of Enigma, although no new compositions &mdash;
+the creator of countless Enigma worlds is currently celebrating his well-earned
+&quot;seventh day&quot;. But some of these &quot;new old&quot; works are really
+remarkable, and possibly we will encounter some of them here again in the near
+future.</div>
 
+<div class="quote">Besides the inquiry on his level of the month &mdash; which
+can be found on the Yin side of the article &mdash; we also received some
+reflections on level designing in general from the author, which will make a
+worthy final movement of our Yin-Yang article composition. Most of what is said
+in these sentences not only applies to &quot;Plan Ahead&quot;, but to many other
+excellent creations by Jacob &mdash; and to many others of our &quot;Levels of
+the Month&quot;.</div>
+
+<hr>
+
 <h4>About elegance in level design</h4>
 
 <div class="lotmpic">
@@ -220,7 +313,7 @@
 <div class="imagetitle">Versailles</div>
 </div>
 
-<div class="quote">
+<p>
 I would like to make a couple of general comments about Enigma levels,
 and by extension game levels in general, concerning what it means to be
 &quot;elegant&quot;. In my opinion &quot;a level is elegant&quot; means first that no part
@@ -243,9 +336,9 @@
 case for &quot;Plan Ahead&quot; and that &quot;Plan Ahead&quot; provides a refreshing trip
 to a small lake, almost impassable except through Henry Blackball's
 careful planning ahead.
-</div>
+</p>
 
-<div class="author">Jacob Scott</div>
+<p><i>Jacob Scott</i></p>
 
 <hr>
 <table>
@@ -253,7 +346,7 @@
 You are currently on the Yang side of this article. The Yin side is here:
 </td><td>
 <a href="$$lotm_200904$$">
-<img src="$$imagedir$$/lotm/lotm_200904_yang.png" 
+<img src="$$imagedir$$/lotm/lotm_200904_yang.png"
 alt="The magical yin-yang stone" border="0">
 </a>
 </td></tr>
@@ -261,15 +354,27 @@
 <hr>
 
 <!--<p>Dear reader, we have a constant need for articles from you about Enigma's
-great levels. Please, send us any articles, even comments, you write to:</p>
+great levels. </p>
+<p>We're particularly interested in articles about the following levels
+<br> &mdash; which are the 10 levels with the highest rating after our previous 20 Lotms:</p>
+<ul>
+<li>&quot;Doors forever&quot; by JuSt</li>
+<li>&quot;Cold Meditation&quot; by Ronald Lamprecht</li>
+<li>&quot;A Cooler Spot in Hell&quot; by Andreas Lochmann</li>
+<li>&quot;Gods of Enigma&quot; by moonpearl</li>
+<li>&quot;How Many Spirals?&quot; by Nat Pryce</li>
+<li>&quot;Don't Be Greedy&quot; by Jacob Scott </li>
+<li>&quot;Teamwork&quot; by Jacob Scott</li>
+<li>&quot;Prepare Your Defense&quot; by Jacob Scott</li>
+<li>&quot;Changing Positions&quot; by Lukas Sch?ller</li>
+<li>&quot;Little Puzzles&quot; by Jon 'WB' Sneyers</li>
+</ul>
+<p>Feel free to choose your favorite from these excellencies,
+<br>and send your reflections, reports, essays, poetry, inquiries, homeworks, diplomas to:
 <pre>
 <a href="mailto:enigma-devel at nongnu.org">enigma-devel at nongnu.org</a>
 </pre>
-<p>We're particularly interested in articles about the following levels:
 </p>
-<ul>
-<li>&quot;Little Puzzles&quot; by Jon 'WB' Sneyers</li>
-</ul>
 <p>Many thanks in advance, only your help can keep the LotM alive!</p>
 
 <p><i>Your Enigma Team</i></p>-->

Modified: homepage/input/lotm/lotm_200904_yang_de.html
===================================================================
--- homepage/input/lotm/lotm_200904_yang_de.html	2009-05-04 22:24:53 UTC (rev 1661)
+++ homepage/input/lotm/lotm_200904_yang_de.html	2009-05-05 17:29:59 UTC (rev 1662)
@@ -20,11 +20,10 @@
 <hr>
 
 <p>Im Oktober 2008 wurde als erster Beitrag im klassischen One-Screen-Format
-&quot;Industrial Puzzles&quot; von Raoul Bourquin als Level des Monats (LdM
-10/08) pr&auml;sentiert. Dann wurde mit &quot;Procrustes&quot; von Andreas
+&quot;Industrial Puzzles&quot; von Raoul Bourquin als Level des Monats (<a href="$$lotm_200810$$">LdM 10/2008</a>) pr&auml;sentiert. Dann wurde mit &quot;Procrustes&quot; von Andreas
 Lochmann ein weiterer &quot;Onescreener&quot; im Dezember zum &quot;Olymp&quot;
-der &quot;ausgezeichneten&quot; Enigma-Level-Produktionen hinzugew&auml;hlt (LdM
-12/08). Diesen Monat werden wir einen weiteren Level im &quot;handlichen&quot;
+der &quot;ausgezeichneten&quot; Enigma-Level-Produktionen hinzugew&auml;hlt (<a href="$$lotm_200812$$">LdM 12/2008</a>).
+Diesen Monat werden wir einen weiteren Level im &quot;handlichen&quot;
 One-Screen-Format w&uuml;rdigen. Soll aber nicht hei&szlig;en, epische
 gro&szlig;e Abenteuer und lange Entdeckungsreisen seien out. Vielmehr zeigen
 anscheinend auch die kleineren &quot;Kammersuiten&quot;, dass sie es in sich
@@ -56,7 +55,7 @@
 </div>
 
 <table cellpadding="0" cellspacing="1" class="statistics">
-<caption class="normalcaption">Einige Rekorde vom Februar, Yang mode</caption>
+<caption class="normalcaption">Einige Rekorde vom Februar <br>(Yang mode)</caption>
 <colgroup>
 <col width="80">
 <col width="160">
@@ -174,7 +173,7 @@
 <p>Vorausschauend &hellip; Vorausschauend planen &hellip;
 </p>
 
-<h4>Willkommen in Jacob Scotts (aka Duffy) Plan Ahead :-)</h4>
+<h3>Willkommen in Jacob Scotts (aka Duffy) Plan Ahead :-)</h3>
 
 <h4>1. Der Rundgang</h4>
 
@@ -230,8 +229,8 @@
 geht und ihm das wertvolle Geschenk vorschnell &uuml;bergibt, tja dann &hellip;
 ist die Zeit f&uuml;r eine andere Gabe der G&ouml;tter gekommen: F3 :-( </p>
 
-<p>Die Tasche!! &mdash; Spieler, nutze die Tasche!
-Klammer auf / Klammer zu = Tasche auf / Tasche zu.
+<p>Die Tasche!! &mdash; Spieler, nutze die Tasche!<br>
+Klammer auf / Klammer zu = Tasche auf / Tasche zu.<br>
 Mehr wird nicht verraten.
 </p>
 
@@ -239,7 +238,7 @@
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200904_l.png" alt="Level of the Month" border="0">
-<div class="imagetitle">&Uuml;bergabe &mdash; <br>was wohl in der Tasche ist?</div>
+<div class="imagetitle">&Uuml;bergabe &mdash; <br>Was wohl in der Tasche ist?</div>
 </div>
 
 <p>Zuerst ist Yin die aktiv geschaltete Murmel, wechselt sie mit ihrem
@@ -267,7 +266,7 @@
 <i>wann</i> auf <i>wen</i>, und <i>wo</i> setzt <i>wer</i> <i>wann</i>
 <i>was</i> ein. Duffys Ordnung muss kaputt gemacht werden, damit die
 r&auml;umliche Verbindung geschaffen werden kann. In der sch&ouml;n-verstaubten
-Industriehalle (vgl. LotM 10/08) muss die Ordnung wieder hergestellt werden,
+Industriehalle (vgl. <a href="$$lotm_200810$$">LdM 10/2008</a>) muss die Ordnung wieder hergestellt werden,
 damit wieder produziert werden kann. Patentrezepte unerw&uuml;nscht. Und damit
 wie im t&auml;glichen Leben. ;-) </p>
 
@@ -278,11 +277,11 @@
 Und, ich will mal &quot;vorausschauen&quot;, und hoffen: Dass die n&auml;chsten
 sch&ouml;nen Duffy-Level bald erscheinen werden. Plan it again, Duffy! :-) </p>
 
-<p>Sch&ouml;e Gr&uuml;&szlig;e,<br>
-<i>Mecke</i>
-</p>
+<p><i>Mecke</i></p>
 
-<p>Vielen Dank f&uuml;r deine inspirierenden Worte, lieber Mecke. Wir
+<hr>
+
+<div class="quote">Vielen Dank f&uuml;r deine inspirierenden Worte, lieber Mecke. Wir
 k&ouml;nnen dich und alle unsere Ldm Leser und Leserinnen, sowie alle Enigma
 Spieler und &quot;Duffy&quot;-Fans beruhigen: Auch in der n&auml;chsten Ausgabe
 von Enigma werden selbstverst&auml;ndlich wieder &quot;einige&quot; exzellente
@@ -291,17 +290,19 @@
 einiger Zeit seinen wohlverdienten &quot;siebten Tag&quot;. Aber einige dieser
 &quot;neuen alten&quot; Werke haben es wahrhaft in sich, und vielleicht wird uns
 das eine oder andere davon noch hier an diesem Ort begegnen, soviel sei an
-dieser Stelle schon einmal gesagt. </p>
+dieser Stelle schon einmal gesagt.</div>
 
-<p>Abgesehen von den Ausf&uuml;hrungen zu seinem Level des Monats &mdash; der
+<div class="quote">Abgesehen von den Ausf&uuml;hrungen zu seinem Level des Monats &mdash; der
 auf der Yin-Seite des Artikels zu finden ist &mdash; haben wir auch eine kurze
 allgemeine Betrachtung &uuml;ber &quot;Eleganz im Leveldesign&quot; vom Autor
 erhalten, die einen w&uuml;rdigen Schluss-Satz unserer ersten Yin-Yang Artikel
 Komposition darstellt. Das meiste, das in diesen S&auml;tzen gesagt wird, gilt
 nicht nur f&uuml;r &quot;Plan Ahead&quot;, sondern auch f&uuml;r zahlreiche
 andere exzellente Level von Jacob &mdash; und f&uuml;r viele unserer bisherigen
-Levels des Monats. </p>
+Levels des Monats.</div>
 
+<hr>
+
 <h4>&Uuml;ber Eleganz im Leveldesign</h4>
 
 <div class="lotmpic">
@@ -309,7 +310,7 @@
 <div class="imagetitle">Versailles</div>
 </div>
 
-<div class="quote">An dieser Stelle m&ouml;chte ich noch einige allgemeine
+<p>An dieser Stelle m&ouml;chte ich noch einige allgemeine
 &Uuml;berlegungen zu Enigma Levels anstellen - und diese Betrachtungen auch auf
 Spiele-Levels generell ausdehnen - und zwar dar&uuml;ber, was es bedeutet,
 &quot;elegant&quot; zu sein. M.E. bedeutet die Aussage &quot;ein Level ist
@@ -334,7 +335,7 @@
 Erfolg am meisten. Ich hoffe, dass dies auch auf &quot;Plan Ahead&quot;
 zutrifft, und dass &quot;Plan Ahead&quot; sich als anregender Ausflug darstellt
 &mdash; zu einem kleinen See, beinahe un&uuml;berwindbar, au&szlig;er durch
-Henry Blackballs sorgf&auml;ltige Vorausplanung. </div>
+Henry Blackballs sorgf&auml;ltige Vorausplanung. </p>
 
 <p><i>Jacob Scott</i></p>
 
@@ -351,4 +352,32 @@
 </table>
 <hr>
 
+<!--<p>Liebe Leserin, lieber Leser, wir haben ein st&auml;ndiges Bed&uuml;rfnis nach<br>
+Ihren Artikeln &uuml;ber Enigmas herausragende Levels. </p>
+<p>Wir sind besonders interessiert an Artikeln &uuml;ber die folgenden Levels<br>
+&mdash; welches die 10 Levels mit der h&ouml;chsten Bewertung sind, nach unseren bisherigen 20 LdMs:</p>
+<ul>
+<li>&quot;Doors forever&quot; von JuSt</li>
+<li>&quot;Cold Meditation&quot; von Ronald Lamprecht</li>
+<li>&quot;A Cooler Spot in Hell&quot; von Andreas Lochmann</li>
+<li>&quot;Gods of Enigma&quot; von moonpearl</li>
+<li>&quot;How Many Spirals?&quot; von Nat Pryce</li>
+<li>&quot;Don't Be Greedy&quot; von Jacob Scott </li>
+<li>&quot;Teamwork&quot; von Jacob Scott</li>
+<li>&quot;Prepare Your Defense&quot; von Jacob Scott</li>
+<li>&quot;Changing Positions&quot; von Lukas Sch&uuml;ller</li>
+<li>&quot;Little Puzzles&quot; von Jon 'WB' Sneyers</li>
+</ul>
+<p>Suchen sich ihren Lieblingslevel aus diesen 10 Kandidaten heraus,<br>
+und senden Sie ihre Betrachtungen, Berichte, Analysen, Untersuchungen, Erz&auml;hlungen, <br>
+Dichtungen, Briefromane, Notizen, Liebesbriefe, Tagebucheintr&auml;ge, Hausarbeiten, <br>
+Diploma, Schriftst&uuml;cke jeder Art an: 
+<pre>
+<a href="mailto:enigma-devel at nongnu.org">enigma-devel at nongnu.org</a>
+</pre>
+</p>
+<p>Vielen Dank im voraus, nur Ihre Mithilfe kann den LdM am Leben erhalten!
+</p>
+<p><i>Ihr Enigma-Team</i></p>-->
+
 </div>



From ral at mail.berlios.de  Wed May  6 00:36:33 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Wed, 6 May 2009 00:36:33 +0200
Subject: [Enigma-game-svn] r1663 - trunk/src
Message-ID: <200905052236.n45MaXn8022328@sheep.berlios.de>

Author: ral
Date: 2009-05-06 00:36:31 +0200 (Wed, 06 May 2009)
New Revision: 1663

Modified:
   trunk/src/lua.cc
Log:
Trunk 1.1:
- object:set() - improve argument checks
- grp(group) - clean group from invalid objects
- assert api2 levels declared with 1.10++ compatibility


Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2009-05-05 17:29:59 UTC (rev 1662)
+++ trunk/src/lua.cc	2009-05-05 22:36:31 UTC (rev 1663)
@@ -1311,6 +1311,10 @@
         throwLuaError(L, "Syntax error - usage of '.' instead of ':'");
         return 0;        
     }
+    if (lua_gettop(L) < 2 || !is_table(L, -1)) {
+        throwLuaError(L, "Multiple set of object attributes requires a table as argument.");
+        return 0;        
+    }
     Object *obj = to_object(L, 1);
     lua_rawgeti(L, -1, 1);  // check if any unnamed attribute exists
     if (!lua_isnil(L, -1)) {
@@ -1625,7 +1629,7 @@
 
 
 static int newGroup(lua_State *L) {
-    // (table | (obj[,obj]))
+    // (table | grp | (obj[,obj]))
     std::list<Object *> objects;
     if (is_table(L, 1)) {
        if (lua_gettop(L) > 1) {
@@ -1638,6 +1642,8 @@
            objects.push_back(to_object(L, -1));
            lua_pop(L, 1);  // remove value; keep key for next iteration
        }
+    } else if (is_group(L, 1)) {
+        objects = toObjectList(L, -1);
     } else if (is_object(L, 1)) {
         for (int i = 1; i <= lua_gettop(L); i++) {
             objects.push_back(to_object(L, i));
@@ -2924,6 +2930,10 @@
 
 static int dispatchTilesWriteAccess(lua_State *L) {
 //    Log << "Tiles write key - " << lua_tostring(L, 2) << "\n";
+    if (server::EnigmaCompatibility < 1.10) {
+        throwLuaError(L, "Mismatch of new API 2 syntax with level compatibility < 1.10");
+        return 0;
+    }
     if (!lua_isstring(L, 2)) {     // sideeffect: numbers are converted to string
         throwLuaError(L, "Tiles: key is not a string");
         return 0;



From raoul at mail.berlios.de  Thu May  7 22:43:54 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Thu, 7 May 2009 22:43:54 +0200
Subject: [Enigma-game-svn] r1664 - in trunk: attic/images-stones data
	data/gfx16 data/gfx32 data/gfx40 data/gfx48 data/gfx64
Message-ID: <200905072043.n47KhsXo020836@sheep.berlios.de>

Author: raoul
Date: 2009-05-07 22:43:47 +0200 (Thu, 07 May 2009)
New Revision: 1664

Added:
   trunk/attic/images-stones/sh_rawglass_quad_gfx32.xcf
   trunk/attic/images-stones/sh_rawglass_quad_gfx40.xcf
   trunk/attic/images-stones/sh_rawglass_quad_gfx48.xcf
   trunk/attic/images-stones/st_ice_break_gfx16.xcf
   trunk/attic/images-stones/st_ice_break_gfx32.xcf
   trunk/attic/images-stones/st_ice_break_gfx40.xcf
   trunk/attic/images-stones/st_ice_break_gfx48.xcf
   trunk/attic/images-stones/st_ice_break_gfx64.xcf
   trunk/attic/images-stones/st_ice_gfx16.xcf
   trunk/attic/images-stones/st_ice_gfx32.xcf
   trunk/attic/images-stones/st_ice_gfx40.xcf
   trunk/attic/images-stones/st_ice_gfx48.xcf
   trunk/attic/images-stones/st_ice_gfx64.xcf
   trunk/data/gfx16/st_ice.png
   trunk/data/gfx16/st_ice_break.png
   trunk/data/gfx32/sh_rawglass_quad.png
   trunk/data/gfx32/st_ice.png
   trunk/data/gfx32/st_ice_break.png
   trunk/data/gfx32/st_rawglass_quad.png
   trunk/data/gfx40/sh_rawglass_quad.png
   trunk/data/gfx40/st_ice.png
   trunk/data/gfx40/st_ice_break.png
   trunk/data/gfx40/st_rawglass_quad.png
   trunk/data/gfx48/sh_rawglass_quad.png
   trunk/data/gfx48/st_ice.png
   trunk/data/gfx48/st_ice_break.png
   trunk/data/gfx48/st_rawglass_quad.png
   trunk/data/gfx64/st_ice.png
   trunk/data/gfx64/st_ice_break.png
Modified:
   trunk/data/models-2d.lua
Log:
-> New models for:
--> st_rawglass_quad
--> st_ice

TODO:
- Decide about grey value of glass shadows
- Test ice_break in different contexts (to much fl_ice in the gfx?)



Added: trunk/attic/images-stones/sh_rawglass_quad_gfx32.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/sh_rawglass_quad_gfx32.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/sh_rawglass_quad_gfx40.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/sh_rawglass_quad_gfx40.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/sh_rawglass_quad_gfx48.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/sh_rawglass_quad_gfx48.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_break_gfx16.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_break_gfx16.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_break_gfx32.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_break_gfx32.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_break_gfx40.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_break_gfx40.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_break_gfx48.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_break_gfx48.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_break_gfx64.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_break_gfx64.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_gfx16.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_gfx16.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_gfx32.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_gfx32.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_gfx40.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_gfx40.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_gfx48.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_gfx48.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_ice_gfx64.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_ice_gfx64.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/data/gfx16/st_ice.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx16/st_ice.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx16/st_ice_break.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx16/st_ice_break.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/sh_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/sh_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_ice.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_ice.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_ice_break.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_ice_break.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/sh_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/sh_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_ice.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_ice.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_ice_break.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_ice_break.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/sh_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/sh_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/st_ice.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_ice.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/st_ice_break.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_ice_break.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/st_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx64/st_ice.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx64/st_ice.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx64/st_ice_break.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx64/st_ice_break.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-05 22:36:31 UTC (rev 1663)
+++ trunk/data/models-2d.lua	2009-05-07 20:43:47 UTC (rev 1664)
@@ -771,6 +771,7 @@
     DefImage("sh_grate_framed")
     DefImage("sh_portal_horse")
     DefImage("sh-glass")
+    DefImage("sh_rawglass_quad")
     DefImage("sh-white4")
     DefImage("sh-puzzle1")
     DefImage("sh-brake")
@@ -802,7 +803,8 @@
     DefStone("st-floppy0", "sh-round", {filename="st-floppy1"})
     DefStone("st-floppy1", "sh-round", {filename="st-floppy2"})
     DefStone("st-flrock")
-    DefStone("st_rawglass", "sh-glass");
+    DefStone("st_rawglass", "sh-glass")
+    DefStone("st_rawglass_quad", "sh_rawglass_quad")
     DefStone("st_lightglass", "sh-glass")
     DefStone("st_darkglass", "sh-glass")
     DefStone("st_redfiber", "sh-glass")
@@ -1014,21 +1016,21 @@
 
 -- st-fourswitch --
 do
-   DefSubimages("st-fourswitch",{h=4})
-   DefShModel("st-fourswitch-n", "st-fourswitch1", "sh-round")
-   DefShModel("st-fourswitch-e", "st-fourswitch2", "sh-round")
-   DefShModel("st-fourswitch-s", "st-fourswitch3", "sh-round")
-   DefShModel("st-fourswitch-w", "st-fourswitch4", "sh-round")
+    DefSubimages("st-fourswitch",{h=4})
+    DefShModel("st-fourswitch-n", "st-fourswitch1", "sh-round")
+    DefShModel("st-fourswitch-e", "st-fourswitch2", "sh-round")
+    DefShModel("st-fourswitch-s", "st-fourswitch3", "sh-round")
+    DefShModel("st-fourswitch-w", "st-fourswitch4", "sh-round")
 end
 
 -- st_ice --
 do
-    DefAlias("st_ice", "st_rawglass")
-    DefAlias("st_ice_breaking", "it_debris_water")
---    local images = DefSubimages("st_ice_break", {h=3})
---    local frames = BuildFrames(images,50)
---    DefAnim("st_ice_break-anim", frames)
---    DefShModel("st_ice_breaking", "st_ice_break-anim", "sh-glass")
+    DefStone("st_ice", "sh-glass")
+
+    local images = DefSubimages("st_ice_break", {h=5})
+    local frames = BuildFrames(images,50)
+    DefAnim("st_ice_break-anim", frames)
+    DefShModel("st_ice_breaking", "st_ice_break-anim", "sh-glass")
 end
 
 -- st-knight --



From ral at mail.berlios.de  Fri May  8 00:49:03 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Fri, 8 May 2009 00:49:03 +0200
Subject: [Enigma-game-svn] r1665 - trunk/doc/reference
Message-ID: <200905072249.n47Mn3Le018189@sheep.berlios.de>

Author: ral
Date: 2009-05-08 00:48:54 +0200 (Fri, 08 May 2009)
New Revision: 1665

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
- Chapter 5 Lua API additions for datatypes object and group



Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-05-07 20:43:47 UTC (rev 1664)
+++ trunk/doc/reference/enigma-ref.texi	2009-05-07 22:48:54 UTC (rev 1665)
@@ -4156,6 +4156,8 @@
 @node Position Tasks
 @subsection Position Tasks
 
+For reference details @pxref{Position}.
+
 @table @asis
 @item @b{Creating Positions:}
 @example
@@ -4239,6 +4241,8 @@
 @node Attribute Tasks
 @subsection Attribute Tasks
 
+For reference details @pxref{Object}.
+
 @table @asis
 
 @item @b{Single Attribute Setting:}
@@ -4282,6 +4286,8 @@
 @node Object Tasks
 @subsection Object Tasks
 
+For reference details @pxref{Object}.
+
 @table @asis
 @item @b{Creating Objects:}
 @example
@@ -4398,6 +4404,8 @@
 @node Group Tasks
 @subsection Group Tasks
 
+For reference details @pxref{Group}.
+
 @table @asis
 @item @b{Creating Groups:}
 
@@ -4447,6 +4455,7 @@
 @example
 @var{count} = #@var{mygroup}        -- number of objects in the group
 @var{obj}   = @var{mygroup}[@var{5}]     -- 5th object of the group
+ at var{obj}   = @var{mygroup}[@var{-1}]    -- last object of the group
 for @var{i} = @var{1}, #@var{mygroup} do @var{obj} = @var{mygroup}[@var{i}] ... end
 for @var{obj} in @var{mygroup} do ... end
 @end example
@@ -4462,6 +4471,32 @@
 @end example
 Every group returns a shuffled group with the same members when receiving the
 message @code{"shuffle"}.
+
+ at item @b{Sorted Group:}
+ at example
+ at var{sorted_group} = @var{group}:@b{sort}("@b{linear}", po(@var{2}, @var{1}))
+ at var{sorted_group} = @var{group}:@b{sort}("@b{linear}")
+ at var{sorted_group} = @var{group}:@b{sort}("@b{circular}")
+ at var{sorted_group} = @var{group}:@b{sort}()
+ at end example
+Sort group objects in linear order according to given direction vector, or
+direction determined by the first two objects. Or order objects cicular around
+their center. If no argument is given order objects lexically.
+
+ at item @b{Subset Group:}
+ at example
+ at var{sub_group} = @var{group}:@b{sub}(@var{2})   -- first two objects
+ at var{sub_group} = @var{group}:@b{sub}(@var{-2})  -- last two objects
+ at var{sub_group} = @var{group}:@b{sub}(@var{2}, @var{4}) -- objects from 2 to 4
+ at var{sub_group} = @var{group}:@b{sub}(@var{2}, @var{-2}) -- two objects starting with 2
+ at end example
+Build subgroup with given indices and numbers.
+
+ at item @b{Nearest Object:}
+ at example
+ at var{object} = @var{group}:@b{nearest}(@var{reference})
+ at end example
+Search object in group that is nearest to the given reference object.
 @end table
 
 @c ----------------- Tiles and World Tasks --------------------
@@ -5229,6 +5264,8 @@
 handle allows you to retrieve existing named positions, too. Furtheron positions
 are implicitly created as return values of many operations.
 
+For task driven samples @pxref{Position Tasks}.
+
 Let us look at the supported operators:
 
 @table @asis
@@ -5250,10 +5287,10 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{newpos} = @i{po}(3, 4) + @{1, 2@}              -- = po(4, 6)
- at var{newpos} = @var{myobject} - @i{po}(1, 5)
- at var{newpolist} = @i{po}(2, 3) + @var{NEIGHBORS_4}      -- po(1, 3) .. po(2, 4) .. po(3, 3) .. po(2, 2)
- at var{newpolist} = @i{po}["@var{myfloor}#*"] - @i{po}(3, 0)
+ at var{newpos} = @i{po}(@var{3}, @var{4}) + @{@var{1}, @var{2}@}              -- = po(4, 6)
+ at var{newpos} = @var{myobject} - @i{po}(@var{1}, @var{5})
+ at var{newpolist} = @i{po}(@var{2}, @var{3}) + @var{NEIGHBORS_4}      -- po(1, 3) .. po(2, 4) .. po(3, 3) .. po(2, 2)
+ at var{newpolist} = @i{po}["@var{myfloor}#*"] - @i{po}(@var{3}, @var{0})
 @end example
 @end table
 
@@ -5271,8 +5308,8 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{newpos} = 3 * @i{po}(3, 4)   -- = po(9, 12)
- at var{newpos} = @i{po}(2, 3) / 2   -- = po(1, 1.5)
+ at var{newpos} = @var{3} * @i{po}(@var{3}, @var{4})   -- = po(9, 12)
+ at var{newpos} = @i{po}(@var{2}, @var{3}) / @var{2}   -- = po(1, 1.5)
 @end example
 @end table
 
@@ -5287,7 +5324,7 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{newpos} = - at i{po}(3, 4)   -- = po(-3, -4)
+ at var{newpos} = - at i{po}(@var{3}, @var{4})   -- = po(-3, -4)
 @end example
 @end table
 
@@ -5302,7 +5339,7 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{newpos} = #@i{po}(3, 4)   -- = po(3.5, 4.5)
+ at var{newpos} = #@i{po}(@var{3}, @var{4})   -- = po(3.5, 4.5)
 @end example
 @end table
 
@@ -5320,9 +5357,9 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{bool} = @i{po}(3, 4) == @i{po}(@{3, 4@})  -- = true
- at var{bool} = @i{po}(3, 4) == @i{po}(4, 3)    -- = false
- at var{bool} = @i{po}(3, 4) ~= @i{po}(4, 3)    -- = true
+ at var{bool} = @i{po}(@var{3}, @var{4}) == @i{po}(@{@var{3}, @var{4}@})  -- = true
+ at var{bool} = @i{po}(@var{3}, @var{4}) == @i{po}(@var{4}, @var{3})    -- = false
+ at var{bool} = @i{po}(@var{3}, @var{4}) ~= @i{po}(@var{4}, @var{3})    -- = true
 @end example
 @end table
 
@@ -5339,7 +5376,7 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{newpolist} = @i{po}(3, 4) .. @i{po}(4, 4)
+ at var{newpolist} = @i{po}(@var{3}, @var{4}) .. @i{po}(@var{4}, @var{4})
 @end example
 @end table
 
@@ -5361,11 +5398,11 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{number} = @i{po}(3, 4)["x"]            -- = 3
- at var{number} = @i{po}(3, 4).x               -- = 3
- at var{number} = @i{po}(3, 4)["y"]            -- = 4
- at var{number} = @i{po}(3, 4).y               -- = 4
- at var{number1}, @var{number2} = @i{po}(3, 4):xy()  -- = 3, 4
+ at var{number} = @i{po}(@var{3}, @var{4})["@b{x}"]            -- = 3
+ at var{number} = @i{po}(@var{3}, @var{4}). at b{x}               -- = 3
+ at var{number} = @i{po}(@var{3}, @var{4})["@b{y}"]            -- = 4
+ at var{number} = @i{po}(@var{3}, @var{4}). at b{y}               -- = 4
+ at var{number1}, @var{number2} = @i{po}(@var{3}, @var{4}):@b{xy}()  -- = 3, 4
 @end example
 @end table
 
@@ -5380,8 +5417,8 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{newpos} = @i{po}(3.2, 4.7):grid()    -- = 3, 4
- at var{newpos} = @i{po}(-2.4, -5.0):grid()  -- = -3, -5
+ at var{newpos} = @i{po}(@var{3.2}, @var{4.7}):@b{grid}()    -- = 3, 4
+ at var{newpos} = @i{po}(@var{-2.4}, @var{-5.0}):@b{grid}()  -- = -3, -5
 @end example
 @end table
 
@@ -5403,7 +5440,7 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{boolean} = @i{po}(3.2, 4.7):exists()
+ at var{boolean} = @i{po}(@var{3.2}, @var{4.7}):@b{exists}()
 @end example
 @end table
 @end table
@@ -5414,16 +5451,647 @@
 @node Object
 @section Object
 
+This datatype handels all world participating objects as described in
+ at ref{Object Layers}. When you request an object you get a reference to this
+object and not the object itself. You can modify the object, but the object
+can be modified by user actions, too. Deleting your reference by assigning
+another value to your variable does not delete the object itself.
+
+On the other hand an object can cease to exist due to user actions while you
+still have a reference assigned to a Lua variable. Of course this reference
+gets invalid when the referenced object is deleted. But such an invalid
+reference, which we call a @samp{NULL} reference, is no longer fatal with the
+new API. Any write accesses on such references are simply ignored. Thus you can
+send messages to object references independently of their validity. Just on
+read accesses you may want to prior check the existance of an object as you
+would get @samp{nil} values on access of @samp{NULL} references.
+
+Objects take attributes that you access by Lua index methods. Additional to
+the object specific attributes you are free to store your own customer 
+attributes on any object. Customer attributes are any indices starting with an
+underscore @samp{_} as prefix to their name.
+
+The real world objects are created by assigning a @ref{Tile} declaration to
+a @ref{World} position. You retrieve a corresponding object reference either
+by the @ref{NamedObjects} repository, by @ref{Functions} or other methods that
+return single object references.
+
+Objects provide most methods of a @ref{Position} and can in most cases be 
+directly used as a position without explicit conversion. Just special methods
+like existence differ on both datatypes. Of course all objects placed in the
+world are limited to positions within the world. But be aware that portable 
+ at ref{Items} can well be part of a player's inventory and thus report a position 
+outside of the world. Actors will always report positions rounded to the
+containing grid. This feature is legacy. As Lua code is anyway unapropriate to
+handle actor movements we maintained this rounding feature.
+
+Objects support standard set operators of @ref{Groups}, too, as long as one
+operand is a group and the other an object.
+
+For task driven samples @pxref{Object Tasks} and @ref{Attribute Tasks}.
+
+
+ at table @asis
+ at item @b{Attribute Access:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj}["attributename"]
+
+ at i{obj}["attributename"] = value
+
+ at i{obj}:set(@{attributename1=value1, attributename2=value2,...@})
+
+ at item @b{Details:}
+Read or write object attributes as described in the following chapters or
+custom attributes. The @samp{set} method allows you to set multiple attributes
+at once. Attribute writes are ignored if the object reference is invalid.
+Attribute reads require a valid object reference. Otherwise they return
+ at samp{nil}.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{value} = @var{obj}["@b{color}"]
+ at var{value} = @var{obj}. at b{color}
+ at var{obj}["@b{color}"] = @var{BLACK}
+ at var{obj}. at b{color} = @var{BLACK}
+ at var{obj}:@b{set}(@{@b{target}=@var{mydoor}, @b{action}="@b{open}"@})
+ at end example
+ at end table
+
+ at item @b{Messaging:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj}:message("msg", value)
+
+result = @i{obj}:msg(value)
+
+ at item @b{Details:}
+Send a message with a given value or @samp{nil} to the object. Every message
+can be sent directly as a method with the given message name. When the object
+reference is invalid the message is simply ignored.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{value} = @var{obj}:@b{message}("@b{open}")
+ at var{value} = @var{obj}:@b{open}()
+ at var{value} = @var{obj}:@b{message}("@b{signal}", @var{1})
+ at var{value} = @var{obj}:@b{signal}(@var{1})
+ at end example
+ at end table
+
+ at item @b{Equality/Inequality:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj1} <==|~=> @i{obj2}
+
+ at item @b{Details:}
+A comparison of two object values. Two objects values are equal if both
+reference the same, still existing world object. Otherwise they are unequal.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{bool} = @var{obj1} == @var{obj1}  -- = true
+ at var{bool} = @var{obj1} == @var{obj2}  -- = false, if two different objects
+ at var{bool} = @var{obj1} ~= @var{obj2}  -- = true, if two different objects
+ at end example
+ at end table
+
+ at item @b{Existence:}
+ at table @asis
+ at item @b{Syntax:}
+result = - at i{obj}
+
+result = @i{obj}:exists()
+
+ at item @b{Details:}
+Checks whether an object reference is still valid. Returns true if the object
+still exists, otherwise false is returned.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{bool} = - at var{obj}
+ at var{bool} = @var{obj}:@b{exists}()
+ at end example
+ at end table
+
+ at item @b{Kill:}
+ at table @asis
+ at item @b{Syntax:}
+ at i{obj}:kill()
+
+ at item @b{Details:}
+Kills the object at once. Note that you should never kill a sender object
+within a callback action. If you have need of killing the sender then add
+the attribute @ref{safeaction} as explained in @ref{Target - Action }.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{obj}:@b{kill}()
+ at end example
+ at end table
+
+ at item @b{Kind Checks:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj}:is("kind")
+
+result = @i{obj}:kind()
+
+ at item @b{Details:}
+These methods allow you to check or retrieve the @ref{Object Kind}.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{bool} = @var{obj}:@b{is}("@b{st_chess}")
+ at var{string} = @var{obj}:@b{kind}()
+ at end example
+ at end table
+
+ at item @b{Coordinate Access:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj}["x"]
+
+result = @i{obj}["y"]
+
+result1, result2 = @i{obj}:xy()
+
+ at item @b{Details:}
+The single position coordinates of an object can be read anytime. You can
+retrieve single coordinates by Lua square bracket index access. Of course you
+can use the Lua alternative dot index access syntax, too (see examples). If you
+want to evaluate both coordinates, you can make use of the method @samp{xy()},
+that returns both numbers at once in a Lua multiple assignment. Anyway the
+coordinates of an object are read only. You can not reposition an object by
+changing its coordinates.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{number} = @var{obj}["@b{x}"]
+ at var{number} = @var{obj}. at b{x}
+ at var{number} = @var{obj}["@b{y}"]
+ at var{number} = @var{obj}. at b{y}
+ at var{number1}, @var{number2} = @var{obj}:@b{xy}()
+ at end example
+ at end table
+
+ at item @b{Addition/Subtraction:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj} <@b{+}|@b{-}> <@i{pos} | @i{obj} | @i{cpos} | @i{polist}>
+
+result = <@i{pos} | @i{obj} | @i{cpos} | @i{polist}> <@b{+}|@b{-}> @i{obj}
+
+ at item @b{Details:}
+When an object is added to or subtracted from another position or data 
+convertable to a position the result is the position value representing the 
+vectorial addition or difference of both positions.
+
+If an object is added to subtracted from a position list a new list is created
+with the positions representing the sum or difference of the position with every
+member of the supplied position list.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpos} = @var{obj} + @{@var{1}, @var{2}@}
+ at var{newpos} = @var{myobject} - @var{obj}
+ at var{newpolist} = @var{obj} + @var{NEIGHBORS_4}
+ at var{newpolist} = @i{po}["@var{myfloor}#*"] - @var{obj}
+ at end example
+ at end table
+
+ at item @b{Center:}
+ at table @asis
+ at item @b{Syntax:}
+result = #@i{obj}
+
+ at item @b{Details:}
+A rounding of an objects position vector to the center of the grid. A new 
+position value with coordinates of the center of the containing grid position 
+is returned.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpos} = #@var{obj}   -- e.g. po(3.5, 4.5)
+ at end example
+ at end table
+
+ at item @b{Join:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj} + @i{group}
+
+result = @i{group} + @i{obj}
+
+ at item @b{Details:}
+A new set containg the objects of the group plus the single object is returned.
+The object sequence is maintained. If the object is already member of the group
+the new group will contain just one object reference, namely the first one in
+sequence.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @var{obj1} + @i{grp}(@var{obj2}, @var{obj3}, @var{obj1})   -- = grp(obj1, obj2, obj3)
+ at var{newgroup} = @i{grp}(@var{obj2}, @var{obj3}) + @var{obj1}         -- = grp(obj2, obj3, obj1)
+ at end example
+ at end table
+
+ at item @b{Intersection:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj} * @i{group}
+
+result = @i{group} * @i{obj}
+
+ at item @b{Details:}
+A new set cointaing just the object iteself, in case it is part of the group, 
+too, or an empty group returned.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @var{obj1} * @i{grp}(@var{obj1}, @var{obj2})  -- = grp(obj1)
+ at var{newgroup} = @i{grp}(@var{obj2}) * @var{obj1}         -- = grp()
+ at end example
+ at end table
+
+ at item @b{Difference:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj} - @i{group}
+
+result = @i{group} - @i{obj}
+
+ at item @b{Details:}
+In the first case a new set containg just the object itself, if it is not part
+of the group, too, or an empty group returned. In the second case the new group
+contains all members of the old group without the object. The sequence of
+objects remains untouched.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @var{obj1} - @i{grp}(@var{obj2}, @var{obj1})  -- = grp()
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}) - @var{obj1}  -- = grp(obj2)
+ at end example
+ at end table
+
+ at item @b{Sound:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{obj}:sound("name", volume)
+
+ at item @b{Details:}
+Play a sound of given name at the position of the object. The volume defaults
+to @samp{1}.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{obj}:@b{sound}("@b{quake}")
+ at var{obj}:@b{sound}("@b{quake}", @var{2})
+ at end example
+ at end table
+ at end table
+
+
 @c ----------------- Group --------------------
 
 @node Group
 @section Group
 
+A group is a sorted set of @ref{Object}s. Every object can be contained just
+in one instance in the group. In contrast to a Lua table the group is a constant
+value datatype. Once you retrieved a group it can not be modified. But you can
+calculate and and apply operators like join, intersection and difference on
+groups and generate thereby other group values as results.
+
+Even though groups as values are long living you should be carefully in keeping
+a group longer than a callback evaluation. Groups contain object references and
+objects can be killed. Thus a prior retrieved group may contain invalid
+object references on a subsequent callback evaluation. This may be uncritical
+if you just send a message to a group, but in other cases you may need to
+clean the group from invalid members (see below).
+
+You create a group by listing the contained objects as arguments to the 
+ at samp{grp()} @ref{Functions}, by retrieving objects from the @ref{NamedObjects}
+repository or as result of other methods and calculations.
+
+As groups are constant the sequence of contained objects is stable. All 
+operations that generate resulting new groups maintain this sequence as far
+as possible. E.g. a join of two groups takes the objects of the first group
+in the given sequence and appends the additional objects of the second group
+in the sequence they appear in the second group.
+
+All group operations that return new groups clean their results from any
+meanwhile invalid @samp{NULL} object references. You can use this feature
+to clean a group by the function @samp{grp()}.
+
+Any message sent to a group will be forwarded to all its members in sequence.
+An attribute write access to a group results in series of attribute writes
+on every group member in sequence, too.
+
+But of course you can iterate over a group and access every member by index
+access. Several special methods for common group evaluations like shuffling,
+subgroup, sort, etc. are supported, too.
+
+For task driven samples @pxref{Group Tasks}.
+
+ at table @asis
+ at item @b{Messaging:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{group}:message("msg", value)
+
+result = @i{group}:msg(value)
+
+ at item @b{Details:}
+Send a message with a given value or @samp{nil} to all objects in the group.
+Every message can be sent directly as a method with the given message name.
+When an object reference is invalid the message is simply ignored. You are
+even allowed to send a @samp{kill()} message to all objects in a group. The
+objects will be killed, but the group remains filled with invalid @samp{NULL}
+object references.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{value} = @var{group}:@b{message}("@b{open}")
+ at var{value} = @var{group}:@b{open}()
+ at var{value} = @var{group}:@b{message}("@b{signal}", @var{1})
+ at var{value} = @var{group}:@b{signal}(@var{1})
+ at var{value} = @var{group}:@b{kill}()
+ at end example
+ at end table
+
+ at item @b{Attribute Write:}
+ at table @asis
+ at item @b{Syntax:}
+ at i{group}["attributename"] = value
+
+ at i{group}:set(@{attributename1=value1, attributename2=value2,...@})
+
+ at item @b{Details:}
+Set attributes as described in the following chapters or custom attributes on
+all objects of the group. The @samp{set} method allows you to set multiple
+attributes at once. Attribute writes are ignored if an object reference is
+invalid. Attribute read on groups in not allowed - the group index read is
+overloaded as a group member access.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{group}["@b{color}"] = @var{BLACK}
+ at var{group}. at b{color} = @var{BLACK}
+ at var{group}:@b{set}(@{@b{target}=@var{mydoor}, @b{action}="@b{open}"@})
+ at end example
+ at end table
+
+ at item @b{Equality/Inequality:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{group1} <==|~=> @i{group2}
+
+ at item @b{Details:}
+A comparison of two groups. Two groups are equal if both contain the same set
+of objects independent of their sequence within both groups. Otherwise they are
+unequal.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{bool} = @i{grp}(@var{obj1}, @var{obj2}) == @i{grp}(@var{obj2}, @var{obj1})  -- = true
+ at var{bool} = @i{grp}(@var{obj1}, @var{obj2}) == @i{grp}(@var{obj1}, @var{obj3})  -- = false, if different object contents
+ at var{bool} = @i{grp}(@var{obj1}) ~= @i{grp}(@var{obj2}, @var{obj1})        -- = true, if different object contents
+ at end example
+ at end table
+
+ at item @b{Length:}
+ at table @asis
+ at item @b{Syntax:}
+result = #@i{group}
+
+ at item @b{Details:}
+Number of objects contained in the group. Invalid @samp{NULL} object references
+are counted, too.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{number} = #@i{grp}(@var{obj1}, @var{obj2})         -- = 2
+for @var{i} = @var{1}, #@var{group} do @var{obj} = @var{group}[@var{i}] ... end
+ at end example
+ at end table
+
+ at item @b{Member Access:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{group}[@i{index}]
+
+result = @i{group}[@i{obj}]
+
+ at item @b{Details:}
+An index like read access with an index number between 1 and #@i{group} returns
+the object in the related group sequence position. Negative indices between
+-#@i{group} and -1 give the same objects. Thus you can always access the last
+object at index -1. All other index positions return an invalid @samp{NULL}
+object - not @samp{nil} as tables do! Thus you are always able to send messages
+to returned object references.
+
+An index like read access with an object as index returns the sequence position
+number, the number index, of the object if it is contained in the group or 
+ at samp{nil} if it is not contained.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{object} = @i{grp}(@var{obj1}, @var{obj2})[2]     -- = obj2
+ at var{object} = @i{grp}(@var{obj1}, @var{obj2})[-1]    -- = obj2
+ at var{object} = @i{grp}(@var{obj1}, @var{obj2})[0]     -- = NULL object
+for @var{i} = @var{1}, #@var{group} do @var{obj} = @var{group}[@var{i}] ... end
+ at var{number} = @i{grp}(@var{obj1}, @var{obj2})[@var{obj2}]  -- = 2
+ at var{number} = @i{grp}(@var{obj1}, @var{obj2})[@var{obj3}]  -- = nil
+ at end example
+ at end table
+
+ at item @b{Loop:}
+ at table @asis
+ at item @b{Syntax:}
+for @i{obj} in @i{group} do ... end
+
+ at item @b{Details:}
+Looping over all objects contained in a group. The loop occurs in the sequence
+of the contained objects and includes all objects, even invalid @samp{NULL}
+object references.
+
+ at item @b{Syntax Samples:}
+ at example
+for @var{obj} in @var{group} do @var{obj}:@b{toggle}() end
+ at end example
+ at end table
+
+
+ at item @b{Join:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{group} + <@i{obj}|@i{group}>
+
+result = <@i{obj}|@i{group}> + @i{group}
+
+
+ at item @b{Details:}
+A new set containg any object of of both arguments just once, is returned. The
+object sequence is maintained. If an object is member of both arguments the new
+group will contain just one object reference, namely the first one in sequence.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @var{obj1} + @i{grp}(@var{obj2}, @var{obj3}, @var{obj1})   -- = grp(obj1, obj2, obj3)
+ at var{newgroup} = @i{grp}(@var{obj2}, @var{obj3}) + @i{grp}(@var{obj1}, @var{obj3})   -- = grp(obj2, obj3, obj1)
+ at end example
+ at end table
+
+ at item @b{Intersection:}
+ at table @asis
+ at item @b{Syntax:}
+result = <@i{obj}|@i{group}> * @i{group}
+
+result = @i{group} * <@i{obj}|@i{group}>
+
+ at item @b{Details:}
+A new set cointaing just those objects that a contained in both arguments. The
+objects are returned in the same sequence as they appear in the first argument.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @var{obj1} * @i{grp}(@var{obj2}, @var{obj1})  -- = grp(obj1)
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}) * @i{grp}(@var{obj2}, @var{obj1}, @var{obj3})  -- = grp(obj1, obj2)
+ at end example
+ at end table
+
+ at item @b{Difference:}
+ at table @asis
+ at item @b{Syntax:}
+result = <@i{obj}|@i{group}> - @i{group}
+
+result = @i{group} - <@i{obj}|@i{group}>
+
+ at item @b{Details:}
+A new set containg just those objects of the first argument, that are not
+contained in the second argument is returned. The sequence of the objects
+in the new group is the same as in the first argument.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @var{obj1} - @i{grp}(@var{obj2}, @var{obj1})  -- = grp()
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}) - @i{grp}(@var{obj2}, @var{obj4})  -- = grp(obj1, obj3)
+ at end example
+ at end table
+
+ at item @b{Shuffle:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{group}:shuffle()
+
+ at item @b{Details:}
+Returns a new group with the same objects in another random sequence. Note that
+all invalid @samp{NULL} object reference are removed in the resulting group by
+this method call.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2})
+ at end example
+ at end table
+
+ at item @b{Sorting:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{group}:sort("circular")
+
+result = @i{group}:sort("linear" <, @i{direction}>)
+
+result = @i{group}:sort()
+
+ at item @b{Details:}
+Returns a new group with the same objects in another sorted sequence. Note that
+all invalid @samp{NULL} object reference are removed in the resulting group by
+this method call.
+
+With a string argument @code{"circular"} the objects are aranged arround their
+center by their angle. The distance from this center has no influence.
+
+With a string argument @code{"linear"} the objects are aranged in a linear 
+fashion. You either supply a @ref{Position} as sorting direction vector, or
+the first two objects of the group will define the sorting direction as default.
+
+If no sorting argument is supplied the objects will be sorted by their name
+in lexical order.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}):sort("linear", po(2,1))
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}):sort("circular")
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}):sort()
+ at end example
+ at end table
+
+ at item @b{Subset:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{group}:sub(@i{number})
+
+result = @i{group}:sub(@i{start}, @i{end})
+
+result = @i{group}:sub(@i{start}, - at i{number})
+
+ at item @b{Details:}
+Returns a new group with a subset of the contained objects. The sequence of
+objects in the new group is identical to the sequence in the originating group.
+Note that all invalid @samp{NULL} object reference are removed in the resulting
+group by this method call after determination of the sub set candidate objects.
+
+With a number as argument you determine the number of requested objects. A
+positive number returns the amount of objects starting with the first object
+of the group. Whereas a negative number returns objects from the tail of the
+group. In this case the absolute value determines the number of selected objects
+counted backwards from the last one in sequence.
+
+With two positive numbers as arguements you define the first and the last sequence
+index of the requested subset.
+
+With two numbers, but the second one being negative, you define the first object
+and the with the absolute value of the second number you define the amount of
+objects you want in your subset.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}, @var{obj4}):sub(2)     -- = grp(obj1, obj2)
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}, @var{obj4}):sub(-2)    -- = grp(obj3, obj4)
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}, @var{obj4}):sub(2, 4)  -- = grp(obj2, obj3, obj4)
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}, @var{obj4}):sub(2, -2) -- = grp(obj2, obj3)
+ at end example
+ at end table
+
+ at item @b{Nearest Object:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{group}:nearest(@i{obj})
+
+ at item @b{Details:}
+Returns the object contained in the group that is nearest to the given reference
+object. The distances are calculated exactly without rounding actor positions.
+In case two object have the same distance from the reference object one is
+chosen by chance as the result.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newobject} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}):sub(@var{obj4})
+ at end example
+ at end table
+
+ at end table
+
+
 @c ----------------- NamedObjects --------------------
 
 @node NamedObjects
 @section NamedObjects
 
+Repository
+
 @c ----------------- PositionList --------------------
 
 @node PositionList



From raoul at mail.berlios.de  Sat May  9 15:24:08 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 9 May 2009 15:24:08 +0200
Subject: [Enigma-game-svn] r1666 - in trunk: attic/images-stones data
	data/gfx40 src/stones
Message-ID: <200905091324.n49DO8Wh030961@sheep.berlios.de>

Author: raoul
Date: 2009-05-09 15:24:06 +0200 (Sat, 09 May 2009)
New Revision: 1666

Added:
   trunk/attic/images-stones/st_spitter-gfx40.xcf
   trunk/data/gfx40/st_spitter_breaking.png
   trunk/data/gfx40/st_spitter_idle.png
   trunk/data/gfx40/st_spitter_loading.png
   trunk/data/gfx40/st_spitter_spitting.png
Modified:
   trunk/data/models-2d.lua
   trunk/src/stones/SimpleStones.cc
Log:
-> Gfx for new animations of st_spitter (currently only gfx40, others will come soon)



Added: trunk/attic/images-stones/st_spitter-gfx40.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_spitter-gfx40.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/data/gfx40/st_spitter_breaking.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_spitter_breaking.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_spitter_idle.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_spitter_idle.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_spitter_loading.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_spitter_loading.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_spitter_spitting.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_spitter_spitting.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-07 22:48:54 UTC (rev 1665)
+++ trunk/data/models-2d.lua	2009-05-09 13:24:06 UTC (rev 1666)
@@ -1685,9 +1685,27 @@
 
 -- st-spitter --
 do
-    DefAlias ("st_spitter", "st-timeswitch")
-    DefAlias ("st_spitter_loading", "st_quaking")
-    DefAlias ("st_spitter_spitting", "st_quaking")
+     local images = DefSubimages("st_spitter_idle", {h=6})
+     local frames = BuildFrames(images,150)
+     DefAnim("st_spitter_idle", frames, true)
+     DefShModel("st_spitter_idle", "st_spitter_idle", "sh-round")
+
+     local images = DefSubimages("st_spitter_spitting", {h=6})
+     local frames = BuildFrames(images,175)
+     DefAnim("st_spitter_spitting", frames)
+     DefShModel("st_spitter_spitting", "st_spitter_spitting", "sh-round")
+
+     local images = DefSubimages("st_spitter_loading", {h=6})
+     local frames = BuildFrames(images,100)
+     frames[6][2] = 50
+     DefAnim("st_spitter_loading", frames)
+     DefShModel("st_spitter_loading", "st_spitter_loading", "sh-round")
+
+     local images = DefSubimages("st_spitter_breaking", {h=6})
+     local frames = BuildFrames(images,150)
+     DefAnim("st_spitter_breaking", frames, true)
+     DefShModel("st_spitter_breaking", "st_spitter_breaking", "sh-round")
+
 end
 
 ---------------------------

Modified: trunk/src/stones/SimpleStones.cc
===================================================================
--- trunk/src/stones/SimpleStones.cc	2009-05-07 22:48:54 UTC (rev 1665)
+++ trunk/src/stones/SimpleStones.cc	2009-05-09 13:24:06 UTC (rev 1666)
@@ -282,13 +282,13 @@
     
     void SpitterStone::init_model() {
         if (state == IDLE)
-            set_model("st_spitter");
+            set_anim("st_spitter_idle");
         else if (state == LOADING)
             set_anim("st_spitter_loading");
         else if (state == SPITTING)
             set_anim("st_spitter_spitting");
         else
-            set_anim("st_break_plain-anim");
+            set_anim("st_spitter_breaking");
     }
     
     void SpitterStone::animcb() {



From raoul at mail.berlios.de  Sat May  9 19:31:46 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 9 May 2009 19:31:46 +0200
Subject: [Enigma-game-svn] r1667 - in trunk/data: gfx16 gfx64
Message-ID: <200905091731.n49HVk4Y019567@sheep.berlios.de>

Author: raoul
Date: 2009-05-09 19:31:42 +0200 (Sat, 09 May 2009)
New Revision: 1667

Added:
   trunk/data/gfx16/sh-glass.png
   trunk/data/gfx16/sh_rawglass_quad.png
   trunk/data/gfx16/st_rawglass.png
   trunk/data/gfx16/st_rawglass_quad.png
   trunk/data/gfx64/sh-glass.png
   trunk/data/gfx64/sh_rawglass_quad.png
   trunk/data/gfx64/st_rawglass.png
   trunk/data/gfx64/st_rawglass_quad.png
Log:
-> Models and shadows for st_rawglass and st_rawglass_quad for gfx{16,64}



Added: trunk/data/gfx16/sh-glass.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx16/sh-glass.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx16/sh_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx16/sh_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx16/st_rawglass.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx16/st_rawglass.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx16/st_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx16/st_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx64/sh-glass.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx64/sh-glass.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx64/sh_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx64/sh_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx64/st_rawglass.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx64/st_rawglass.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx64/st_rawglass_quad.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx64/st_rawglass_quad.png
___________________________________________________________________
Name: svn:mime-type
   + image/png



From raoul at mail.berlios.de  Sun May 10 00:46:43 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sun, 10 May 2009 00:46:43 +0200
Subject: [Enigma-game-svn] r1668 - in trunk: attic/images-stones data/gfx32
	data/gfx48
Message-ID: <200905092246.n49Mkh70009026@sheep.berlios.de>

Author: raoul
Date: 2009-05-10 00:46:23 +0200 (Sun, 10 May 2009)
New Revision: 1668

Added:
   trunk/attic/images-stones/st_spitter-gfx32.xcf
   trunk/attic/images-stones/st_spitter-gfx48.xcf
   trunk/data/gfx32/st_spitter_breaking.png
   trunk/data/gfx32/st_spitter_idle.png
   trunk/data/gfx32/st_spitter_loading.png
   trunk/data/gfx32/st_spitter_spitting.png
   trunk/data/gfx48/st_spitter_breaking.png
   trunk/data/gfx48/st_spitter_idle.png
   trunk/data/gfx48/st_spitter_loading.png
   trunk/data/gfx48/st_spitter_spitting.png
Modified:
   trunk/attic/images-stones/st_spitter-gfx40.xcf
Log:
-> Animations for st_spitter for gfx{32,48}
-> GIMP source files for all spitter images

TODO: images for gfx{16,64}



Added: trunk/attic/images-stones/st_spitter-gfx32.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_spitter-gfx32.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Modified: trunk/attic/images-stones/st_spitter-gfx40.xcf
===================================================================
(Binary files differ)

Added: trunk/attic/images-stones/st_spitter-gfx48.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_spitter-gfx48.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/data/gfx32/st_spitter_breaking.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_spitter_breaking.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_spitter_idle.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_spitter_idle.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_spitter_loading.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_spitter_loading.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_spitter_spitting.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_spitter_spitting.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/st_spitter_breaking.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_spitter_breaking.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/st_spitter_idle.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_spitter_idle.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/st_spitter_loading.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_spitter_loading.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/st_spitter_spitting.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_spitter_spitting.png
___________________________________________________________________
Name: svn:mime-type
   + image/png



From ral at mail.berlios.de  Sun May 10 01:03:50 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 10 May 2009 01:03:50 +0200
Subject: [Enigma-game-svn] r1669 - in trunk: data data/schemas src src/stones
Message-ID: <200905092303.n49N3okn028865@sheep.berlios.de>

Author: ral
Date: 2009-05-10 01:03:48 +0200 (Sun, 10 May 2009)
New Revision: 1669

Added:
   trunk/src/stones/SpitterStone.cc
   trunk/src/stones/SpitterStone.hh
Modified:
   trunk/data/models-2d.lua
   trunk/data/schemas/objects.xml
   trunk/src/Makefile.am
   trunk/src/stones.hh
   trunk/src/stones/GlassStones.cc
   trunk/src/stones/GlassStones.hh
   trunk/src/stones/IceBlock.cc
   trunk/src/stones/IceBlock.hh
   trunk/src/stones/PlasterStone.cc
   trunk/src/stones/PlasterStone.hh
   trunk/src/stones/SimpleStones.cc
   trunk/src/stones/SimpleStones.hh
Log:
Trunk 1.1:
- st_ice: no longer movable while breaking
- st_plaster_movebreakable: no longer movable while breaking
- st_rawglass: add texture st_rawglass_quad - static version only
- st_spitter:
  - extracted to own hh/cc files
  - added attribute state: IDLE, ACTIVE = default
  - IDLE spitter does not allow spitting
  - fixed break anim: single anim run, spead up
  - fixed spitter/swap interaction: reset anim after swap
Note:
- some images are currently just available for 800x600 resolution!


Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/data/models-2d.lua	2009-05-09 23:03:48 UTC (rev 1669)
@@ -1687,8 +1687,9 @@
 do
      local images = DefSubimages("st_spitter_idle", {h=6})
      local frames = BuildFrames(images,150)
-     DefAnim("st_spitter_idle", frames, true)
-     DefShModel("st_spitter_idle", "st_spitter_idle", "sh-round")
+     DefAnim("st_spitter_active", frames, true)
+     DefShModel("st_spitter_active", "st_spitter_active", "sh-round")
+     DefShModel("st_spitter_idle", "st_spitter_idle1",  "sh-round")
 
      local images = DefSubimages("st_spitter_spitting", {h=6})
      local frames = BuildFrames(images,175)
@@ -1702,8 +1703,8 @@
      DefShModel("st_spitter_loading", "st_spitter_loading", "sh-round")
 
      local images = DefSubimages("st_spitter_breaking", {h=6})
-     local frames = BuildFrames(images,150)
-     DefAnim("st_spitter_breaking", frames, true)
+     local frames = BuildFrames(images,100)
+     DefAnim("st_spitter_breaking", frames)
      DefShModel("st_spitter_breaking", "st_spitter_breaking", "sh-round")
 
 end

Modified: trunk/data/schemas/objects.xml
===================================================================
--- trunk/data/schemas/objects.xml	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/data/schemas/objects.xml	2009-05-09 23:03:48 UTC (rev 1669)
@@ -1696,6 +1696,7 @@
       <msg name="_trigger"/>
     </object>
     <object name="st_rawglass"/>
+    <object name="st_rawglass_quad"  init="true"/>
     <object name="st_rawglass_movable">
       <attr name="movable" value="true"/>
     </object>

Modified: trunk/src/Makefile.am
===================================================================
--- trunk/src/Makefile.am	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/Makefile.am	2009-05-09 23:03:48 UTC (rev 1669)
@@ -391,6 +391,8 @@
 	stones/ShogunStone.hh	\
 	stones/SimpleStones.cc	\
 	stones/SimpleStones.hh	\
+	stones/SpitterStone.cc	\
+	stones/SpitterStone.hh	\
 	stones/StandardStones.cc	\
 	stones/StandardStones.hh	\
 	stones/StoneImpulse.cc	\

Modified: trunk/src/stones/GlassStones.cc
===================================================================
--- trunk/src/stones/GlassStones.cc	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/GlassStones.cc	2009-05-09 23:03:48 UTC (rev 1669)
@@ -24,12 +24,14 @@
 #include "main.hh"
 
 namespace enigma {
-    GlassStone::GlassStone(int type, bool hollow, bool movable, bool cloth) {
+    GlassStone::GlassStone(int type, bool hollow, bool movable, bool quad, bool cloth) {
         state = type;
         if (hollow)
             objFlags |= OBJBIT_HOLLOW;
         if (movable)
             objFlags |= OBJBIT_MOVABLE;
+        if (quad)
+            objFlags |= OBJBIT_QUAD;
         if (cloth)
             objFlags |= OBJBIT_CLOTH;
     }
@@ -72,7 +74,7 @@
         if (objFlags & OBJBIT_GLASSES)
             set_model("invisible");
         else
-            set_model(getClass());
+            set_model(ecl::strf("%s%s", getClass().c_str(), (objFlags & OBJBIT_QUAD) ? "_quad" : ""));
     }
     
     bool GlassStone::is_floating() const {
@@ -115,6 +117,7 @@
     
     BOOT_REGISTER_START
         BootRegister(new GlassStone(0, false, false), "st_rawglass");
+        BootRegister(new GlassStone(0, false, false, true), "st_rawglass_quad");
         BootRegister(new GlassStone(1, false, true),  "st_rawglass_movable");
         BootRegister(new GlassStone(2, false, false), "st_lightglass");
         BootRegister(new GlassStone(2, true, false),  "st_lightglass_hollow");

Modified: trunk/src/stones/GlassStones.hh
===================================================================
--- trunk/src/stones/GlassStones.hh	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/GlassStones.hh	2009-05-09 23:03:48 UTC (rev 1669)
@@ -61,11 +61,12 @@
             OBJBIT_MOVABLE  =   1<<24,    ///<  
             OBJBIT_HOLLOW   =   1<<25,    ///< 
             OBJBIT_GLASSES  =   1<<26,    ///< invisible due to glasses
-            OBJBIT_CLOTH    =   1<<27     ///< collision sound cloth instead of standard stone
+            OBJBIT_QUAD     =   1<<27,    ///< quad texture
+            OBJBIT_CLOTH    =   1<<28     ///< collision sound cloth instead of standard stone
         };
         
     public:
-        GlassStone(int type, bool hollow, bool movable, bool cloth = false);
+        GlassStone(int type, bool hollow, bool movable, bool quad = false, bool cloth = false);
         
         // Object interface
         virtual std::string getClass() const;        

Modified: trunk/src/stones/IceBlock.cc
===================================================================
--- trunk/src/stones/IceBlock.cc	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/IceBlock.cc	2009-05-09 23:03:48 UTC (rev 1669)
@@ -34,6 +34,7 @@
     Value IceBlock::message(const Message &m) {
         if (m.message == "_explosion" || m.message == "ignite") {
             if (isDisplayable()) {
+                state = BREAKING;
                 set_anim("st_ice_breaking");
             }
             return Value();
@@ -66,6 +67,10 @@
         return true;
     }
     
+    bool IceBlock::is_movable() const {
+        return (state != BREAKING) ? Stone::is_movable() : false;
+    }
+    
     bool IceBlock::on_move(const GridPos &origin) {
         bool isFrozenBomb = false;
         Item *itf = GetItem(origin);

Modified: trunk/src/stones/IceBlock.hh
===================================================================
--- trunk/src/stones/IceBlock.hh	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/IceBlock.hh	2009-05-09 23:03:48 UTC (rev 1669)
@@ -52,6 +52,7 @@
         
         // Stone interface
         virtual bool is_transparent(Direction d) const;
+        virtual bool is_movable() const;
         virtual bool on_move(const GridPos &origin);
         
     private:

Modified: trunk/src/stones/PlasterStone.cc
===================================================================
--- trunk/src/stones/PlasterStone.cc	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/PlasterStone.cc	2009-05-09 23:03:48 UTC (rev 1669)
@@ -93,6 +93,10 @@
         return objFlags & OBJBIT_HOLLOW;
     }
 
+    bool PlasterStone::is_movable() const {
+        return (state != BREAKING) ? Stone::is_movable() : false;
+    }
+    
     StoneResponse PlasterStone::collision_response(const StoneContact &sc) {
         if (objFlags & OBJBIT_HOLLOW)
             return STONE_PASS;

Modified: trunk/src/stones/PlasterStone.hh
===================================================================
--- trunk/src/stones/PlasterStone.hh	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/PlasterStone.hh	2009-05-09 23:03:48 UTC (rev 1669)
@@ -63,6 +63,7 @@
         
         // Stone interface
         virtual bool is_floating() const;
+        virtual bool is_movable() const;
         virtual StoneResponse collision_response(const StoneContact &sc);
         virtual const char *collision_sound();
         virtual void actor_hit(const StoneContact &sc);

Modified: trunk/src/stones/SimpleStones.cc
===================================================================
--- trunk/src/stones/SimpleStones.cc	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/SimpleStones.cc	2009-05-09 23:03:48 UTC (rev 1669)
@@ -22,7 +22,7 @@
 #include "stones/SimpleStones.hh"
 #include "client.hh"
 #include "errors.hh"
-#include "Inventory.hh"
+//#include "Inventory.hh"
 #include "main.hh"
 #include "player.hh"
 #include "server.hh"
@@ -239,106 +239,6 @@
     
     DEF_TRAITSM(PlopStone, "st_plop", st_plop, MOVABLE_STANDARD);
 
-/* -------------------- SpitterStone -------------------- */
-
-    SpitterStone::SpitterStone() {
-    }
-    
-    void SpitterStone::setState(int extState) {
-        // block any calls
-    }
-    
-    Value SpitterStone::message(const Message &m) {
-        if (m.message == "_cannonball") {
-            if (!getAttr("secure").to_bool() || server::GameCompatibility == enigma::GAMET_PEROXYD) {
-                state = BREAKING;
-                init_model();
-            }
-            return Value();
-        } else if (m.message == "spit" && state == IDLE && isDisplayable()) {
-            ecl::V2 dest = m.value;
-            if (!IsInsideLevel(dest)) {
-                int idx = getDefaultedAttr("$hitdestindex", 0);
-                if (!getDestinationByIndex(idx++, dest)) {
-                    if (idx != 1) {
-                        idx = 0;
-                        if (!getDestinationByIndex(idx++, dest))
-                            return Value();
-                    } else
-                        return Value();
-                }
-                setAttr("$hitdestindex", idx);
-                if (!IsInsideLevel(dest))
-                    return Value();
-            }
-            ecl::V2 vel = (GridPos(dest).center() - get_pos().center()) /0.55;
-            setAttr("$ball_velocity", vel);
-            state = LOADING;
-            init_model();
-            return Value();
-        }
-        return Stone::message(m);
-    }
-    
-    void SpitterStone::init_model() {
-        if (state == IDLE)
-            set_anim("st_spitter_idle");
-        else if (state == LOADING)
-            set_anim("st_spitter_loading");
-        else if (state == SPITTING)
-            set_anim("st_spitter_spitting");
-        else
-            set_anim("st_spitter_breaking");
-    }
-    
-    void SpitterStone::animcb() {
-        switch (state) {
-            case IDLE :
-                ASSERT(false, XLevelRuntime, "SpitterStone: animcb called with inconsistent state"); 
-            case LOADING : {
-                Other *cb = dynamic_cast<Other *>(MakeObject("ot_cannonball"));
-                ecl::V2 center  = get_pos().center();
-                cb->setAttr("$position", center);
-                cb->setAttr("$ball_velocity", getAttr("$ball_velocity"));
-                AddOther(cb);
-                
-                state = SPITTING;
-                init_model();
-                break;
-            }
-            case SPITTING : 
-                state = IDLE;
-                init_model();
-                break;
-            case BREAKING :
-                SetItem(get_pos(), MakeItem("it_meditation"));
-                KillStone(get_pos());
-                break;
-        }
-    }
-
-    void SpitterStone::actor_hit (const StoneContact &sc) {
-        if (state != IDLE)
-            return;
-    
-        if (enigma::Inventory *inv = player::GetInventory(sc.actor)) {
-            int lifepos = inv->find("it_extralife");
-            if (lifepos != -1) {
-                delete inv->yield_item(lifepos);
-                player::RedrawInventory (inv);
-                ecl::V2 vel = distortedVelocity(sc.actor->get_vel(), 1.0);
-                double maxvel = (double)getAttr("range")/0.56;
-                if (maxvel * maxvel < square(vel))
-                    vel = maxvel * normalize(vel);
-                setAttr("$ball_velocity", vel);
-                state = LOADING;
-                init_model();
-            }
-        }
-    }
-
-    DEF_TRAITSM(SpitterStone, "st_spitter", st_yinyang, MOVABLE_PERSISTENT);
-
 /* -------------------- Yinyang stone -------------------- */
     YinyangStone::YinyangStone(int initState, bool isInstant) : Stone () {
         state = initState;
@@ -433,7 +333,6 @@
         BootRegister(new GrateStone(1), "st_grate_framed");
         BootRegister(new PlopStone(), "st_plop");
         BootRegister(new PlopStone(), "st_plop_slate");
-        BootRegister(new SpitterStone(), "st_spitter");
         BootRegister(new YinyangStone(0), "st_yinyang");
         BootRegister(new YinyangStone(0, true), "st_yinyang_instant");
         BootRegister(new YinyangStone(1), "st_yinyang_active");

Modified: trunk/src/stones/SimpleStones.hh
===================================================================
--- trunk/src/stones/SimpleStones.hh	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/SimpleStones.hh	2009-05-09 23:03:48 UTC (rev 1669)
@@ -159,38 +159,7 @@
         virtual void on_floor_change();
     };
    
-    /** 
-     * SpitterStone
-     */
-    class SpitterStone : public Stone {
-        CLONEOBJ(SpitterStone);
-        DECL_TRAITS;
-    private:
-        enum iState {
-            IDLE, 
-            LOADING,
-            SPITTING,
-            BREAKING
-        };
-
-    public:
-        SpitterStone ();
-        
-        // StateObject interface
-        virtual void setState(int extState);
-        virtual Value message(const Message &m);
-
-        // GridObject interface
-        virtual void init_model();
-        
-        // ModelCallback interface  - Animation callback
-        virtual void animcb();
-
-        // Stone interface
-        virtual void actor_hit(const StoneContact &sc);
-    };
-    
-    /** 
+     /** 
      * Yinyang 
      */
     class YinyangStone : public Stone {

Added: trunk/src/stones/SpitterStone.cc
===================================================================
--- trunk/src/stones/SpitterStone.cc	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/SpitterStone.cc	2009-05-09 23:03:48 UTC (rev 1669)
@@ -0,0 +1,148 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2008 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include "stones/SpitterStone.hh"
+#include "errors.hh"
+#include "Inventory.hh"
+#include "player.hh"
+#include "server.hh"
+#include "world.hh"
+//#include "main.hh"
+
+namespace enigma {
+    SpitterStone::SpitterStone() {
+        state = ACTIVE;
+    }
+    
+    Value SpitterStone::message(const Message &m) {
+        if (m.message == "_cannonball") {
+            if (!getAttr("secure").to_bool() || server::GameCompatibility == enigma::GAMET_PEROXYD) {
+                state = BREAKING;
+                init_model();
+            }
+            return Value();
+        } else if (m.message == "spit" && state == ACTIVE && isDisplayable()) {
+            ecl::V2 dest = m.value;
+            if (!IsInsideLevel(dest)) {
+                int idx = getDefaultedAttr("$hitdestindex", 0);
+                if (!getDestinationByIndex(idx++, dest)) {
+                    if (idx != 1) {
+                        idx = 0;
+                        if (!getDestinationByIndex(idx++, dest))
+                            return Value();
+                    } else
+                        return Value();
+                }
+                setAttr("$hitdestindex", idx);
+                if (!IsInsideLevel(dest))
+                    return Value();
+            }
+            ecl::V2 vel = (GridPos(dest).center() - get_pos().center()) /0.55;
+            setAttr("$ball_velocity", vel);
+            state = LOADING;
+            init_model();
+            return Value();
+        } else if (m.message == "_model_reanimated") {
+            if (state == LOADING)
+                state = SPITTING;   // abort - position, velocity are bogus anyway
+            init_model();  // replace bogus model - state may have changed
+        }
+        return Stone::message(m);
+    }
+    
+    int SpitterStone::externalState() const {
+        return state == IDLE ? 0 : 1;
+    }
+    
+    void SpitterStone::setState(int extState) {
+        if (state != extState) {
+            state = (extState == 0) ? IDLE : ACTIVE;
+            if (isDisplayable())
+                init_model();
+        }
+    }
+    
+    void SpitterStone::init_model() {
+        if (state == IDLE)
+            set_model("st_spitter_idle");
+        else if (state == ACTIVE)
+            set_anim("st_spitter_active");
+        else if (state == LOADING)
+            set_anim("st_spitter_loading");
+        else if (state == SPITTING)
+            set_anim("st_spitter_spitting");
+        else
+            set_anim("st_spitter_breaking");
+    }
+    
+    void SpitterStone::animcb() {
+        switch (state) {
+            case ACTIVE :
+                ASSERT(false, XLevelRuntime, "SpitterStone: animcb called with inconsistent state"); 
+            case LOADING : {
+                Other *cb = dynamic_cast<Other *>(MakeObject("ot_cannonball"));
+                ecl::V2 center  = get_pos().center();
+                cb->setAttr("$position", center);
+                cb->setAttr("$ball_velocity", getAttr("$ball_velocity"));
+                AddOther(cb);
+                
+                state = SPITTING;
+                init_model();
+                break;
+            }
+            case SPITTING : 
+                state = ACTIVE;
+                init_model();
+                break;
+            case BREAKING :
+                SetItem(get_pos(), MakeItem("it_meditation"));
+                KillStone(get_pos());
+                break;
+        }
+    }
+
+    void SpitterStone::actor_hit (const StoneContact &sc) {
+        if (state != ACTIVE)
+            return;
+    
+        if (enigma::Inventory *inv = player::GetInventory(sc.actor)) {
+            int lifepos = inv->find("it_extralife");
+            if (lifepos != -1) {
+                delete inv->yield_item(lifepos);
+                player::RedrawInventory (inv);
+                ecl::V2 vel = distortedVelocity(sc.actor->get_vel(), 1.0);
+                double maxvel = (double)getAttr("range")/0.56;
+                if (maxvel * maxvel < square(vel))
+                    vel = maxvel * normalize(vel);
+                setAttr("$ball_velocity", vel);
+                state = LOADING;
+                init_model();
+            }
+        }
+    }
+
+    DEF_TRAITSM(SpitterStone, "st_spitter", st_spitter, MOVABLE_PERSISTENT);
+
+    
+    BOOT_REGISTER_START
+        BootRegister(new SpitterStone(), "st_spitter");
+    BOOT_REGISTER_END
+
+} // namespace enigma


Property changes on: trunk/src/stones/SpitterStone.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/stones/SpitterStone.hh
===================================================================
--- trunk/src/stones/SpitterStone.hh	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones/SpitterStone.hh	2009-05-09 23:03:48 UTC (rev 1669)
@@ -0,0 +1,64 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2009 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef SPITTERSTONE_HH
+#define SPITTERSTONE_HH
+
+#include "stones.hh"
+
+#include "stones_internal.hh"
+
+namespace enigma {
+
+    /** 
+     * SpitterStone
+     */
+    class SpitterStone : public Stone {
+        CLONEOBJ(SpitterStone);
+        DECL_TRAITS;
+    private:
+        enum iState {
+            IDLE,
+            ACTIVE,
+            LOADING,
+            SPITTING,
+            BREAKING
+        };
+
+    public:
+        SpitterStone ();
+        
+        // StateObject interface
+        virtual int externalState() const;
+        virtual void setState(int extState);
+        virtual Value message(const Message &m);
+
+        // GridObject interface
+        virtual void init_model();
+        
+        // ModelCallback interface  - Animation callback
+        virtual void animcb();
+
+        // Stone interface
+        virtual void actor_hit(const StoneContact &sc);
+    };
+
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/stones/SpitterStone.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/src/stones.hh
===================================================================
--- trunk/src/stones.hh	2009-05-09 22:46:23 UTC (rev 1668)
+++ trunk/src/stones.hh	2009-05-09 23:03:48 UTC (rev 1669)
@@ -83,6 +83,7 @@
         st_rubberband,
         st_scissors,
         st_shogun,
+        st_spitter,
         st_standard,
         st_stoneimpulse,
         st_stoneimpulse_steady,
@@ -184,7 +185,7 @@
         virtual StoneResponse collision_response(const StoneContact &sc);
 
         /*! Is this stone movable? Affects impulse-stones, fire, ordinary pushes... */
-        bool   is_movable() const {
+        virtual bool is_movable() const {
             return get_traits().movable >= MOVABLE_STANDARD;
         }
 



From ral at mail.berlios.de  Sun May 10 01:12:44 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sun, 10 May 2009 01:12:44 +0200
Subject: [Enigma-game-svn] r1670 - team_levelpacks/team_test_new_api
Message-ID: <200905092312.n49NCiIg006275@sheep.berlios.de>

Author: ral
Date: 2009-05-10 01:12:27 +0200 (Sun, 10 May 2009)
New Revision: 1670

Modified:
   team_levelpacks/team_test_new_api/ralT061_1.xml
   team_levelpacks/team_test_new_api/ralT075_1.xml
   team_levelpacks/team_test_new_api/ralT079_1.xml
   team_levelpacks/team_test_new_api/ralT086_1.xml
   team_levelpacks/team_test_new_api/raoulT09_1.xml
Log:
Test Level new API:
- updates for spitter and other recent additions


Modified: team_levelpacks/team_test_new_api/ralT061_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT061_1.xml	2009-05-09 23:03:48 UTC (rev 1669)
+++ team_levelpacks/team_test_new_api/ralT061_1.xml	2009-05-09 23:12:27 UTC (rev 1670)
@@ -7,7 +7,7 @@
       <el:author  el:name="Ronald Lamprecht" el:email="ral at users.berlios.de"/>
       <el:copyright>Copyright ? 2008 Ronald Lamprecht</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
+      <el:compatibility el:enigma="1.00">
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
       <el:comments>

Modified: team_levelpacks/team_test_new_api/ralT075_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT075_1.xml	2009-05-09 23:03:48 UTC (rev 1669)
+++ team_levelpacks/team_test_new_api/ralT075_1.xml	2009-05-09 23:12:27 UTC (rev 1670)
@@ -95,7 +95,6 @@
 wo:add(no["bag"], ti["7"] .. {"it_cherry"} .. ti["m"])
 wo:add(no["bag2"], ti["8"] .. {"it_coin_s"})
 
-no["bag"]["liftable"] = false
   ]]></el:luamain>
     <el:i18n>
 	 <el:string el:key="title">

Modified: team_levelpacks/team_test_new_api/ralT079_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT079_1.xml	2009-05-09 23:03:48 UTC (rev 1669)
+++ team_levelpacks/team_test_new_api/ralT079_1.xml	2009-05-09 23:12:27 UTC (rev 1670)
@@ -47,10 +47,13 @@
 
 ti["L"] = {"st_laser_s", state=ON}
 ti["P"] = {"st_polarswitch"}
+ti["r"] = {"st_swap"}
 ti["I"] = {"st_stoneimpulse"}
 
 ti["O"] = {"st_spitter", range=4}
 ti["o"] = {"st_spitter", "spitter", secure=true}
+ti["q"] = {"st_spitter", "idlespitter", state=IDLE}
+ti["Q"] = {"st_switch", target="idlespitter"}
 ti["W"] = {"st_window_w"}
 ti["B"] = {"st_brownpyramide"}
 
@@ -82,8 +85,8 @@
 "4d         c        ",
 "b              .. ~~",
 "  Y y   z  Z   .. ~~",
-"      k             ",
-"+++++++       v     ",
+"      k            Q",
+"+++++++     v  rq   ",
 "+++++++             ",
 "v++++++       L    v",
 "+++++++       P     ",

Modified: team_levelpacks/team_test_new_api/ralT086_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT086_1.xml	2009-05-09 23:03:48 UTC (rev 1669)
+++ team_levelpacks/team_test_new_api/ralT086_1.xml	2009-05-09 23:12:27 UTC (rev 1670)
@@ -21,6 +21,7 @@
 ti["_"] = {"fl_abyss"}
 ti["~"] = {"fl_water"}
 ti["*"] = {"st_ice"}
+ti["#"] = {"st_rawglass_movable"}
 
 ti["c"] = {"it_coffee"}
 ti["."] = {"it_seed"}
@@ -59,7 +60,7 @@
 " s   t    *    :  b ",
 "                    ",
 " S   ' @  e    i   D",
-"                    ",
+"  #                 ",
 "     %    d    W   E",
 "   z                ",
 " Z       ~~~~~~~B   ",

Modified: team_levelpacks/team_test_new_api/raoulT09_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/raoulT09_1.xml	2009-05-09 23:03:48 UTC (rev 1669)
+++ team_levelpacks/team_test_new_api/raoulT09_1.xml	2009-05-09 23:12:27 UTC (rev 1670)
@@ -17,6 +17,7 @@
     <el:luamain><![CDATA[
 ti[" "] = {"fl_sahara"}
 ti["#"] = {"st_rawglass"}
+ti["4"] = {"st_rawglass_quad"}
 ti["a"] = {"st_lightglass"}
 ti["b"] = {"st_darkglass"}
 ti["c"] = {"st_redfiber"}
@@ -35,7 +36,7 @@
 ti["@"] = {"#ac_marble"}
 
 w, h = wo(ti, " ", {
-"####################",
+"#####44##44##4#4####",
 "#                  #",
 "LP BBB hhh HHH wwwPR",
 "#                  #",
@@ -43,11 +44,11 @@
 "LP MMM 111 222 PPPPR",
 "#                  #",
 "#                  #",
-"LP ### aaa bbb cccPR",
+"LP ##4 aaa bbb cccPR",
 "#                  #",
-"#@CCCCCCCCCCCCCCCC #",
+"4 at CCCCCCCCCCCCCCCC #",
 "# UUUUUUUUUUUUUUUU #",
-"####################"
+"###4################"
 })
 
 wo:shuffleOxyd()



From raoul at mail.berlios.de  Sun May 10 15:42:11 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sun, 10 May 2009 15:42:11 +0200
Subject: [Enigma-game-svn] r1672 - in trunk/data: . gfx32 gfx40 gfx48
	levels/enigma_experimental
Message-ID: <200905101342.n4ADgBMq031655@sheep.berlios.de>

Author: raoul
Date: 2009-05-10 15:42:10 +0200 (Sun, 10 May 2009)
New Revision: 1672

Added:
   trunk/data/gfx32/sh_passage_slash.png
   trunk/data/gfx40/sh_passage_slash.png
   trunk/data/gfx48/sh_passage_slash.png
Modified:
   trunk/data/gfx40/sh-white4.png
   trunk/data/gfx48/sh-white4.png
   trunk/data/levels/enigma_experimental/stones_1.xml
   trunk/data/models-2d.lua
Log:
-> New shadow for st_passage_slash
-> Fix shadow for st_passage_frame: pixel bugs
-> Fix shadow for st_passage_square: round shadows
-> stones testlevel with rawglass_quad



Added: trunk/data/gfx32/sh_passage_slash.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/sh_passage_slash.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/gfx40/sh-white4.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx40/sh_passage_slash.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/sh_passage_slash.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/gfx48/sh-white4.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx48/sh_passage_slash.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/sh_passage_slash.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/levels/enigma_experimental/stones_1.xml
===================================================================
--- trunk/data/levels/enigma_experimental/stones_1.xml	2009-05-10 13:21:24 UTC (rev 1671)
+++ trunk/data/levels/enigma_experimental/stones_1.xml	2009-05-10 13:42:10 UTC (rev 1672)
@@ -472,6 +472,7 @@
 --{"st_quake", state=BREAKING, _text="st_quake, state=BREAKING"},
 
 {"st_rawglass", _text="st_rawglass"},
+{"st_rawglass_quad", _text="st_rawglass_quad"},
 {"st_rawglass_movable", _text="st_rawglass, movable=true"}, -- flavor attributes?
 
 {"st_redfiber", _text="st_redfiber"},

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-10 13:21:24 UTC (rev 1671)
+++ trunk/data/models-2d.lua	2009-05-10 13:42:10 UTC (rev 1672)
@@ -773,6 +773,7 @@
     DefImage("sh-glass")
     DefImage("sh_rawglass_quad")
     DefImage("sh-white4")
+    DefImage("sh_passage_slash")
     DefImage("sh_passage_cross")
     DefImage("sh-puzzle1")
     DefImage("sh-brake")
@@ -785,8 +786,8 @@
 -------------------
 do
     DefStone("st_beads", "sh-glass")
-    DefStone("st-black1")
-    DefStone("st-black2")
+    DefStone("st-black1", "sh-round")
+    DefStone("st-black2", "sh_passage_slash")
     DefStone("st-black3", "sh_passage_cross")
     DefStone("st-black4", "sh-white4")
     DefStone("st_jamb_black")
@@ -834,8 +835,8 @@
     DefStone("st_brownpyramide")
     DefStone("st_redmarble")
     DefStone("st_surprise")
-    DefStone("st-white1")
-    DefStone("st-white2")
+    DefStone("st-white1", "sh-round")
+    DefStone("st-white2", "sh_passage_slash")
     DefStone("st-white3", "sh_passage_cross")
     DefStone("st-white4", "sh-white4")
     DefStone("st_jamb_white")



From raoulb at bluewin.ch  Sun May 10 15:47:06 2009
From: raoulb at bluewin.ch (Raoul)
Date: Sun, 10 May 2009 15:47:06 +0200
Subject: [Enigma-game-svn] rev 1671
Message-ID: <20090510154706.15ebc817@loipc.loinet.home>

-> st_spitter models and GIMP files for gfx{16,64}
-> st_spitter iris svg
-> Fix for sh-glass in gfx48
-> For for shadow of st_passage_cross


From ral at mail.berlios.de  Sun May 10 16:14:13 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sun, 10 May 2009 16:14:13 +0200
Subject: [Enigma-game-svn] r1673 - trunk/doc/reference
Message-ID: <200905101414.n4AEEDjD003075@sheep.berlios.de>

Author: ral
Date: 2009-05-10 16:14:05 +0200 (Sun, 10 May 2009)
New Revision: 1673

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
- Chapter 5 Lua API additions for datatypes NamedObjects, PositionList, Positions



Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-05-10 13:42:10 UTC (rev 1672)
+++ trunk/doc/reference/enigma-ref.texi	2009-05-10 14:14:05 UTC (rev 1673)
@@ -4553,6 +4553,8 @@
 @node Named Positions Tasks
 @subsection Named Positions Tasks
 
+For reference details @pxref{PositionList}.
+
 @table @asis
 @item @b{Named Position Usage:}
 @example
@@ -5363,7 +5365,7 @@
 @end example
 @end table
 
- at item @b{Join:}
+ at item @b{Concatenation:}
 @table @asis
 @item @b{Syntax:}
 result = @i{pos1} .. <@i{pos2} | @i{polist}> 
@@ -5371,8 +5373,10 @@
 result = <@i{pos1} | @i{polist}> .. @i{pos2}
 
 @item @b{Details:}
-Joins two positions or a position with an exting @ref{PositionList} to a new
-PositionList containing all positions in the given order.
+Concatenates two positions or a position with an existing @ref{PositionList} to a 
+new PositionList containing all positions in the given order.  Note that this
+operation is associative, that means it does not matter if you use braces in
+multiple concatenations or not.
 
 @item @b{Syntax Samples:}
 @example
@@ -6090,23 +6094,321 @@
 @node NamedObjects
 @section NamedObjects
 
-Repository
+The datatyp NamedObjects is used by just one object, the singleton repository
+of named objects. Whenever you name an object, @xref{Object Naming}, this
+repository registers its name and allows you to retrieve the object lateron
+by providing its name.
 
+Being a singleton you can not create new NamedObjets. The singleton is stored
+at the global variable @samp{no} on level load.
+
+ at table @asis
+
+ at item @b{Repository Request:}
+ at table @asis
+ at item @b{Syntax:}
+result = no["@i{name}"]
+
+ at item @b{Details:}
+Request of one or several objects from the repository. If no wildcard 
+characters are used in the name an @ref{Object} value is returned. It is either
+the unique object with the given name, or an invalid @samp{NULL} object if no
+object exists with the given name.
+
+If the requested name contains a wildcard character, either an asterix @samp{*}
+or a question mark @samp{?}, a @ref{Group} containing all objects with matching
+names is returned. An asterix matches one or several arbitrary characters. A
+question mark matches a single arbitrary character. Both wildcard charchters
+can be used anywhere in the string and in arbitrary multiplicity. Anyway the
+result is always returned as a @ref{Group}. The group may contain multiple
+objects, just a single object, or even no objects at all when no existing object
+matches your name pattern.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{obj} = @i{no}["@var{mydoor}"]       -- exakte name match
+ at var{group} = @i{no}["@var{mydoors#*}"]  -- any suffix
+ at var{group} = @i{no}["@var{mydoor?}"]    -- just one char suffix
+ at var{group} = @i{no}["@var{mydoors?#*}"] -- matches e.g. "mydoorsA#123435", "mydoorsB#1213"
+ at end example
+ at end table
+
+ at item @b{Object Naming:}
+ at table @asis
+ at item @b{Syntax:}
+no["@i{name}"] = @i{obj}
+
+ at item @b{Details:}
+Index write accesses to the singleton allows you to name or rename objects. Note
+that you can name or rename objects by @ref{Object} attribute writes, too.
+The objects name is stored as attribute @code{"name"}. Both ways of naming
+an object are totally equivalent.
+
+ at item @b{Syntax Samples:}
+ at example
+ at i{no}["@var{myobject}"] = @var{obj}
+ at end example
+ at end table
+
+ at end table
+
+
 @c ----------------- PositionList --------------------
 
 @node PositionList
 @section PositionList
 
+A PositionList is a sorted set of @ref{Position}s. Like a @ref{Group} this
+container is a constant datatype, that can not be modified. But you can easily
+compose new position lists by concatenation of existing lists and single 
+positions.
+
+An important difference to a group is the ability of a position list to store
+a position multiple times at different locations in its sequence. Thus a
+position list is suited to describe paths, even paths that are closed or
+cross itself.
+
+As @ref{Position}s are values that never become invalid, position lists once
+created will never change or get invalid. They are true values themselves. Thus
+they are the containers of choice for longterm storage.
+
+You can easily transform a group into a position list by the @ref{Positions} 
+singleton by the simple expression @samp{po(group)}. And you can retrieve all
+ at ref{Position}s of a basic object kind located along a position list path by
+ at ref{Functions} like @samp{st(polist)}, @samp{it(polist)} and @samp{fl(polist)}.
+
+As a unique floor object is guaranteed to be on every grid position, you can
+convert a given list of unique grid positions to a group of floors without
+loosing any information. Now you can apply all group methods on the floors, like
+shuffling, sorting, subgrouping, etc.. Finally you can convert the resulting
+group back to a persistent position list. Of course the convertions preserve
+the sequence of members.
+
+Some additional position specific operators are supplied to allow simple
+translations and stretchings of position lists.
+
+Note that in contrast to a @ref{Group} this datatype can not directly be stored
+in an @ref{Object} attribute. But you can always store a @ref{Group} of floors
+in an attribute. In case floors can be destroyed you may need to name these
+floors as discussed in @ref{Named Positions}.
+
+For task driven samples @pxref{Named Positions Tasks}. 
+
+ at table @asis
+ at item @b{Length:}
+ at table @asis
+ at item @b{Syntax:}
+result = #@i{polist}
+
+ at item @b{Details:}
+Number of positions contained in the list.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{number} = #@var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7})) -- = 2
+for @var{i} = @var{1}, #@var{polist} do @var{pos} = @var{polist}[@var{i}] ... end
+ at end example
+ at end table
+
+ at item @b{Member Access:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{group}[@i{index}]
+
+ at item @b{Details:}
+An index like read access with an index number between 1 and #@i{polist} returns
+the position in the related position list position. Negative indices between
+-#@i{polist} and -1 give the same positions. Thus you can always access the last
+position at index -1. All other indices return a Lua @samp{nil} value like 
+tables.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{pos} = @var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7}))[2]     -- = po(5,7)
+ at var{pos} = @var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7}))[-1]    -- = po(5,7)
+ at var{pos} = @var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7}))[0]     -- = nil
+for @var{i} = @var{1}, #@var{polist} do @var{pos} = @var{polist}[@var{i}] ... end
+ at end example
+ at end table
+
+ at item @b{Concatenation:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{polist1} .. <@i{pos} | @i{polist2}> 
+
+result = <@i{pos} | @i{polist1}> .. @i{polist2}
+
+ at item @b{Details:}
+Concatenates two position lists or a position with a position list to a 
+new PositionList containing all positions in the given order. Note that this
+operation is associative, that means it does not matter if you use braces in
+multiple concatenations or not.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpolist} = @var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7})) .. @i{po}(@var{4}, @var{4}) -- = (2,3),(5,7),(4,4)
+ at end example
+ at end table
+
+ at item @b{Translation:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{polist} <@b{+}|@b{-}> <@i{pos} | @i{obj} | @i{cpos}>
+
+result = <@i{pos} | @i{obj} | @i{cpos}> <@b{+}|@b{-}> @i{polist}
+
+ at item @b{Details:}
+If a position or data convertable to a position is added to or subtracted from 
+a position list a new list is created with the positions representing the sum or
+difference of the position with every member of the position list. In total the
+position list is shifted by the position as a vector.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpolist} = @i{po}(@var{2}, @var{3}) + @var{NEIGHBORS_4}      -- po(1, 3) .. po(2, 4) .. po(3, 3) .. po(2, 2)
+ at var{newpolist} = @i{po}["@var{myfloor}#*"] - @i{po}(@var{3}, @var{0})
+ at end example
+ at end table
+
+ at item @b{Stretching:}
+ at table @asis
+ at item @b{Syntax:}
+result = @i{polist} @b{*} @i{number}
+
+result = @i{number} @b{*} @i{polist}
+
+ at item @b{Details:}
+A scalar multiplication or division of all positions in a position list. All
+position values are multiplicated or divided by the given number in both
+coordinate values. In total the position list is stretched by a scalar factor.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newpolist} = @var{2} * @var{NEIGHBORS_4}       -- = po(9, 12)
+ at var{newpolist} = @var{polist}(@i{po}(@var{2}, at var{4}), @i{po}(@var{6}, at var{7})) * @var{1/2}   -- = (1, 2), (3, 3.5)
+ at end example
+ at end table
+
+ at end table
+
+
 @c ----------------- Positions --------------------
 
 @node Positions
 @section Positions
 
+The Positions datatyp is just used by a single instance, the singleton 
+repository of named positions. Besides the management of named positions it
+provides useful conversions of other datatypes to position based types.
+
+Being a singleton you can not create new Positions. The singleton is stored
+at the global variable @samp{po} on level load.
+
+The position repository is an extension of the @ref{NamedObjects} repository.
+Whenever you name an object, @xref{Object Naming}, this repository registers
+its name and allows you to retrieve lateron the current object's position by
+providing its name. But even when a floor object gets killed, its position
+entry remains stored as @ref{Named Positions}. Of course you can name positions
+yourself, but positions of existing named objects will always override plane
+named positions on name clashes.
+
+For task driven samples @pxref{Named Positions Tasks}. 
+
+ at table @asis
+
+ at item @b{Repository Request:}
+ at table @asis
+ at item @b{Syntax:}
+result = po["@i{name}"]
+
+ at item @b{Details:}
+Request of one or several positions from the repository. If no wildcard 
+characters are used in the name the @ref{Position} value of the unique object
+with the given name, if existant, is returned. It no object exists with the 
+name, the last position stored with the same name is returned. If no position
+exists the value @samp{nil} is returned.
+
+If the requested name contains a wildcard character, either an asterix @samp{*}
+or a question mark @samp{?}, a @ref{PositionList} containing all positions with
+matching names is returned. An asterix matches one or several arbitrary 
+characters. A question mark matches a single arbitrary character. Both wildcard
+charchters can be used anywhere in the string and in arbitrary multiplicity.
+Anyway the result is always returned as a @ref{PositionList}. The list may
+contain multiple positions, just a single position, or even no position at all
+when no existing position matches your name pattern.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{pos} = @i{po}["@var{mydoor}"]        -- exakte name match
+ at var{polist} = @i{po}["@var{mydoors#*}"]  -- any suffix
+ at var{polist} = @i{po}["@var{mydoor?}"]    -- just one char suffix
+ at var{polist} = @i{po}["@var{mydoors?#*}"] -- matches e.g. "mydoorsA#123435", "mydoorsB#1213"
+ at end example
+ at end table
+
+ at item @b{Repository Storage:}
+ at table @asis
+ at item @b{Syntax:}
+po["@i{name}"] = @i{obj}
+
+ at item @b{Details:}
+Index write accesses to the singleton allows you to name or rename positions.
+Note that can not assign a new position to a name that currently references
+an existing @ref{Object}. Such write access are silently ignored.
+
+ at item @b{Syntax Samples:}
+ at example
+ at i{po}["@var{mypos}"] = @var{pos}
+ at end example
+ at end table
+
+ at item @b{Position Convertion:}
+ at table @asis
+ at item @b{Syntax:}
+result = po(<@i{obj}|@i{pos}|@{@var{x}, @var{y}@}|@var{x}, @var{y})
+
+ at item @b{Details:}
+Converts its argument to a new position value.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{pos} = @i{po}(@var{pos2})
+ at var{pos} = @i{po}(@var{obj})
+ at var{pos} = @i{po}(@{@var{2}, @var{4}@})
+ at var{pos} = @i{po}(@var{3}, @var{7})
+ at end example
+ at end table
+
+ at item @b{PositionList Convertion:}
+ at table @asis
+ at item @b{Syntax:}
+result = po(@i{group})
+
+ at item @b{Details:}
+Converts the given group to a new @ref{PositionList} value, that contains
+the positions of all valid group @ref{Object}s in the same sequence.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{polist} = @i{po}(@var{group})
+ at end example
+ at end table
+
+ at end table
+
 @c ----------------- Functions --------------------
 
 @node Functions
 @section Functions
 
+fl
+it
+st
+grp
+usertype
+random
+cond
+
 @c ----------------- Tile --------------------
 
 @node Tile



From ral at mail.berlios.de  Wed May 13 23:45:30 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Wed, 13 May 2009 23:45:30 +0200
Subject: [Enigma-game-svn] r1674 - trunk/doc/reference
Message-ID: <200905132145.n4DLjU9m014450@sheep.berlios.de>

Author: ral
Date: 2009-05-13 23:45:16 +0200 (Wed, 13 May 2009)
New Revision: 1674

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
- Chapter 5 Lua API additions for datatypes Tile, Tiles, World and global functions.html
- Chapter 13 started for Guidlines and Hints

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-05-10 14:14:05 UTC (rev 1673)
+++ trunk/doc/reference/enigma-ref.texi	2009-05-13 21:45:16 UTC (rev 1674)
@@ -12,6 +12,7 @@
 @author Ralf Westram
 @author Ronald Lamprecht
 @author Andreas Lochmann
+ at author Andreas Abraham
 @end titlepage
 
 @defindex ob
@@ -44,6 +45,7 @@
 * Libraries::                   Advanced tools
 * Advanced Features::           Fire, ...
 * Extension Development::       Resolver, Library Development
+* Guidelines and Hints::        Tips and Recommendations for Levels to be included in Enigma
 * Old API - Objects::           Description of all objects in Enigma
 * Old API - Variables::         Lua variables that influence the game
 * Old API - Functions::         Predefined functions
@@ -52,7 +54,7 @@
 * Message Index::
 * Function Index::
 * Concept Index::
-* Renaming Index::
+* Renaming Index::              Old API to new API translation hints
 @end menu
 
 @node  Running Enigma
@@ -3653,8 +3655,6 @@
 specific API part as you can expect it for a reference manual. Please note
 that additional @ref{Advanced Features} are described in a separate chapter.
 
-Until this chapter is finished please read the API Concept Draft, too!
-
 @menu
 * Basic Lua Examples::
 * API 2 Overview::
@@ -3665,13 +3665,11 @@
 * Group::
 * NamedObjects::
 * PositionList::
-* Positions::
+* Positions Repository::
+* Tile and Object Declaration::
+* Tiles Repository::
+* World::
 * Functions::
-* Tile::
-* Tiles::
-* World::
-* World Creation and Resolver Chaining::
-* Custom Resolver::
 
 @end menu
 
@@ -4503,6 +4501,9 @@
 @node Tiles and World Tasks
 @subsection Tiles and World Tasks
 
+For reference details @pxref{Tile and Object Declaration}, @ref{Tiles Repository}
+and @ref{World}.
+
 @table @asis
 
 @item @b{Tiles:}
@@ -4538,7 +4539,7 @@
   @})
 @end example
 The world is initialized by the @samp{wo()} call that is explained in details
-at @ref{World Creation and Resolver Chaining}. In the simple form you supply
+at @ref{World Creation}. In the simple form you supply
 the @samp{ti} handle as the first argument. The second argument is the key of
 the default tile definition that defines the default floor to be set if a tile
 does not contain another floor object. At the same time this key defines by its
@@ -5003,7 +5004,7 @@
 @end example
 Up to now we did look up the keys used in the map from our tiles repository
 @samp{ti} that was the first argument of the world initialization call. But
-now we use a @ref{Custom Resolver} (@pxref{World Creation and Resolver Chaining}).
+now we use a @ref{Custom Resolver}.
 The function starting in line 22 is called on every tile to be resolved. It has
 the task of delivering the appropriate tile.
 
@@ -5261,10 +5262,10 @@
 can take every positive or negative number and zero, too. Thus you can calculate
 with positions and use them to express offsets between two other positions.
 
-Positions are are created by the @ref{Positions} singleton handle, that allows
-you to convert coordinates, objects, position constants into positions. The
-handle allows you to retrieve existing named positions, too. Furtheron positions
-are implicitly created as return values of many operations.
+Positions are are created by the @ref{Positions Repository} singleton handle, 
+that allows you to convert coordinates, objects, position constants into 
+positions. The handle allows you to retrieve existing named positions, too. 
+Furtheron positions are implicitly created as return values of many operations.
 
 For task driven samples @pxref{Position Tasks}.
 
@@ -5475,7 +5476,7 @@
 attributes on any object. Customer attributes are any indices starting with an
 underscore @samp{_} as prefix to their name.
 
-The real world objects are created by assigning a @ref{Tile} declaration to
+The real world objects are created by assigning a tile declaration to
 a @ref{World} position. You retrieve a corresponding object reference either
 by the @ref{NamedObjects} repository, by @ref{Functions} or other methods that
 return single object references.
@@ -5569,7 +5570,7 @@
 
 @item @b{Details:}
 Checks whether an object reference is still valid. Returns true if the object
-still exists, otherwise false is returned.
+still exists, otherwise false is returned for @samp{NULL} object references.
 
 @item @b{Syntax Samples:}
 @example
@@ -6172,7 +6173,7 @@
 created will never change or get invalid. They are true values themselves. Thus
 they are the containers of choice for longterm storage.
 
-You can easily transform a group into a position list by the @ref{Positions} 
+You can easily transform a group into a position list by the @ref{Positions Repository} 
 singleton by the simple expression @samp{po(group)}. And you can retrieve all
 @ref{Position}s of a basic object kind located along a position list path by
 @ref{Functions} like @samp{st(polist)}, @samp{it(polist)} and @samp{fl(polist)}.
@@ -6292,10 +6293,10 @@
 @end table
 
 
- at c ----------------- Positions --------------------
+ at c ----------------- Positions Repository --------------------
 
- at node Positions
- at section Positions
+ at node Positions Repository
+ at section Positions Repository
 
 The Positions datatyp is just used by a single instance, the singleton 
 repository of named positions. Besides the management of named positions it
@@ -6396,54 +6397,228 @@
 
 @end table
 
- at c ----------------- Functions --------------------
+ at c ----------------- Tile and Object Declaration --------------------
 
- at node Functions
- at section Functions
+ at node Tile and Object Declaration
+ at section Tile and Object Declaration
 
-fl
-it
-st
-grp
-usertype
-random
-cond
+A tile is the description of one or several objects that should be positioned
+on the same grid position. A single object can be set up by a straight
+object declaration, an anonymous Lua table with entries for the object kind
+and all attributes. The object declaration comes in three minor variations:
 
- at c ----------------- Tile --------------------
+ at example
+@{"@b{st_chess}", @b{name}="@var{jumper}", @b{color}=@var{WHITE}@}
+@{"@b{st_chess_white}", "@var{jumper}", @var{_myattr}=@var{5}@}
+@{"@b{ac_marble}", 0.2, 0.6, @b{name}="@var{blacky}"@}
+ at end example
 
- at node Tile
- at section Tile
+The first entry, the one stored at table position @samp{1}, has always to be
+the kind name of an supported Enigma object. In the first example all other
+table entries are key value pairs with the key being the attribute name. The
+second example uses the shortcut of specifying the name attribute value as
+second table entry, that will be stored at table position @samp{2}. It has to
+be a string value. The third variation, that is useful for actor declarations,
+stores the grid offsets in x and y direction in the table postions @samp{2} and
+ at samp{3}. Of course you can not use the name attribute shortcut in the same
+declaration.
 
- at c ----------------- Tiles --------------------
+These table driven object declarations are always suffcient if you just want to
+set a single object at once. But tiles do often take an item or a stone besides
+a floor. So we need an Enigma data type being able to handle these multiple
+declarations. This is the @samp{tile} data type. It can take just one object
+declaration or an arbitrary list of declarations. You convert a table object
+declaration into a tile by the @ref{Tiles Repository} handle. Once you have a
+tile you can concat other tiles or table object declarations to set up new
+tiles.
 
- at node Tiles
- at section Tiles
+Enigma guarantees that the objects will be set to the world in the sequence
+of declarations in the tile.
 
+For task driven samples @pxref{Tiles and World Tasks}. 
+
+ at menu
+* Tile concat::     Compose a new tile as concatenation of two other
+ at end menu
+
+ at c ----------------- Tile concat --------------------
+
+ at node Tile concat
+ at subsection Tile concat
+
+ at table @asis
+ at item @b{Syntax:}
+result = @i{tile} .. <@i{tile} | @i{odecl}>
+
+result = <@i{tile} | @i{odecl}> .. @i{tile}
+
+ at item @b{Details:}
+Compose a new tile by concatenation of a tile with another tile or a table
+object declaration. In a concatenated chain of tiles and object declarations
+one of the first two evaluated arguments needs to be a tile as two Lua tables
+do not know how to concat. 
+
+Note that Lua does evaluate the @samp{..} operatorfrom right to left! Thus you
+need either use proper braces or you need to guarantee that at least one of the
+two rightmost tokens is a tile.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newtile} = @i{ti}@{@b{st_chess}"@} .. @{"@b{fl_sahara}"@}
+ at var{newtile} = @i{ti}@{@b{st_chess}"@} .. @{"@b{fl_sahara}"@} .. @{"@b{it_cherry}"@}   -- Lua error due to right to left evaluation
+ at var{newtile} = (@i{ti}@{@b{st_chess}"@} .. @{"@b{fl_sahara}"@}) .. @{"@b{it_cherry}"@} -- evaluation order fixed
+ at var{newtile} = @i{ti}@{@b{st_chess}"@} .. @{"@b{fl_sahara}"@} .. @i{ti}@{"@b{it_cherry}"@} -- converted one of the two critical declarations
+ at end example
+
+ at end table
+
+
+ at c ----------------- Tiles Repository --------------------
+
+ at node Tiles Repository
+ at section Tiles Repository
+
+The Tiles datatyp is just used by a single instance, the singleton repository of
+ at ref{Tile and Object Declaration}s. Besides the management of tiles it provides
+useful conversions of table based object declarations to tiles.
+
+Being a singleton you can not create a new Tiles repository. The singleton is
+stored at the global variable @samp{ti} on level load.
+
+The repositories stores tiles for given string keys. The key strings can be
+of any length. Due to Lua limitations they need to be composed of printable
+7-bit ASCII characters. 
+
+You can assign a tile to every key just once. A reassign causes an error. On
+one hand this allow internal implementation optimization, but on the other hand
+an unforerseen key reassignement is the most common level coding error that 
+needs to be reported.
+
+For task driven samples @pxref{Tiles and World Tasks}. 
+
+ at menu
+* Tiles Storage::     Store a tile for a key
+* Tiles Request::     Retrieve a tile for a key
+* Tile Convertion::   Convert an object declartion into a tile
+ at end menu
+
+ at c ----------------- Tiles Storage --------------------
+
+ at node Tiles Storage
+ at subsection Tiles Storage
+
+ at table @asis
+ at item @b{Syntax:}
+ti["@i{key}"] = <@i{tile}|@i{odecl}>
+
+ at item @b{Details:}
+Index write accesses to the singleton allows you to assign a tile or an table
+based object declaration, that is autoconverted to a tile, to a given key. The
+key must be a unique string. Unique in the sense that you can not reassign a
+new tile to key to which previously another tile has been assigned.
+
+ at item @b{Syntax Samples:}
+ at example
+ at i{ti}["@var{#}"] = @var{tile}
+ at i{ti}["@var{$}"] = @{@b{st_chess}"@}
+ at i{ti}["@var{$}"] = @{@b{st_switch}"@}   -- error of key reassignment
+ at i{ti}["@var{anykey}"] = @{@b{st_chess}"@}
+ at end example
+ at end table
+
+
+ at c ----------------- Tiles Request --------------------
+
+ at node Tiles Request
+ at subsection Tiles Request
+
+ at table @asis
+ at item @b{Syntax:}
+result = ti["@i{key}"]
+
+ at item @b{Details:}
+Request of the tile that has been assigned to the given key. If no tile has yet
+been stored for the key a Lua @samp{nil} value is returned. Note that this
+tiles repository does not use wildcard characters as the named objects and
+postions repositories do. The asterix @samp{*} and question mark @samp{?} are
+just keys as any other characters.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{tile} = @i{ti}["@var{#}"]
+ at end example
+ at end table
+
+ at c ----------------- Tile Convertion --------------------
+
+ at node Tile Convertion
+ at subsection Tile Convertion
+
+ at table @asis
+ at item @b{Syntax:}
+result = ti(@i{odecl})
+
+ at item @b{Details:}
+Converts an table based object declaration to a new tile value.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{tile} = @i{ti}(@{@b{st_chess}"@})
+ at var{tile} = @i{ti}@{@b{st_chess}"@}   -- Lua syntax equivalence
+ at end example
+ at end table
+
+
 @c ----------------- World --------------------
 
 @node World
 @section World
 
- at c ----------------- World Creation and Resolver Chaining --------------------
+The World datatype is just used by a single instance, another singleton object.
+A reference to this singleton is stored at the Lua global variable @samp{wo} on
+level load. Being a singleton you can not instanciate another World object.
 
- at node World Creation and Resolver Chaining
- at section World Creation and Resolver Chaining
+But even though the singleton @samp{wo} already exists on load of a level the
+world is still undefined in all aspects. From the first line of Lua code you
+can access the @ref{Global Attributes}. But the world gets really set up with
+the @ref{World Creation}. After this call the world has a well defined size
+and is filled with an inital set of objects that you can access and modify
+from this moment on.
 
+ at menu
+* World Creation::   Set up world with objects
+* add::              Add single objects to the world or an inventory
+* drawBorder::       Draw a rectangular border with a tile
+* drawMap::          Draw objects given by a map of tile keys
+* drawRect::         Fill a complete rectangle with a tile
+* world floor::      Retrieval of floor objects
+* world item::       Retrieval of item objects
+* shuffleOxyd::      Oxyd Shuffling Rules
+* world stone::      Retrieval of stone objects
+ at end menu
+
+ at c ----------------- World Creation --------------------
+
+ at node World Creation
+ at subsection World Creation
+
 Once all parameters have been set and all tiles have been declared it is time
 to create the level world with all its objects. This is done by the following
-constructor that appears in two variations.
+constructor that appears in three variations.
 
 @table @asis
 @item @b{Syntax:}
 width, height = @b{wo}(@i{topresolver}, @i{defaultkey}, @i{map})
 
+width, height = @b{wo}(@i{topresolver}, @i{libmap})
+
 width, height = @b{wo}(@i{topresolver}, @i{defaultkey}, @i{width}, @i{height})
 
 @table @asis
 @item @i{topresolver} = @code{ti} | @i{resolver} | @i{localresolver}
 Every tile in the world is given by a key that needs to be resolved to its
-declaration. This can be done either by the tiles repository @samp{ti}, or
-by given library @ref{Resolvers} or by local @ref{Custom Resolver} function.
+declaration. This can be done either by the @ref{Tiles Repository} @samp{ti}, or
+by given library @ref{Resolvers} or by a local @ref{Custom Resolver} function.
 This argument takes the top resolver that is requested first.
 @item @i{defaultkey}
 A string that defines the key that should be taken as default. It is taken
@@ -6453,6 +6628,8 @@
 A table of strings. Each string describes a row of tiles by its tile keys.
 If a map is given, the world size is determined from the longest string and
 the number of rows.
+ at item @i{libmap}
+A map of the library @ref{libmap}
 @item @i{width}
 As an argument that is given instead of a map it describes the width of the
 desired world.
@@ -6468,6 +6645,7 @@
        "                    ",
        ...
        "                    "@})
+w, h = wo(ti, mylibmap)
 @end example
 
 @item @b{Details:}
@@ -6483,108 +6661,170 @@
 Every key is resolved to its tile declaration via the given resolver chain.
 The top resolver is given to this call as a parameter. If it is @samp{ti} the
 chain consists just of one element and the tile declaration stored in the tiles
-repository at the given key is taken. But there exist several useful
- at ref{Resolvers} that may simplify the task of level writing or provide dynamic
-features like randomness, mazes, etc. If you like to use one or several of them
-you provide the instance of the resolver to be requested first in this
-constructor. The instance that should be requested next is set in the top
-resolver as first argument, and so on. The last library resolver takes usually
- at samp{ti} as its subresolver. For even more flexibility you can provide an
-own @ref{Custom Resolver} function within the level to take influence on the key
-interpretation. This function has to be the last resolver in the chain.
+repository at the given key is taken. Otherwise the resolvers will be evaluated
+as explained in @ref{Resolver Chaining}.
 
- at item @b{Example:}
- at example
-ti["~"] = @{"fl_water"@}
-ti["s"] = @{"fl_sahara"@}
-ti["t"] = @{"fl_tigris"@}
-ti["1"] = @{"ac-blackball", 0, 0.5@}
+ at end table
 
-ti["template_trigger"] = @{"it_trigger", target="myoxyd%%", action="open"@}
-ti["template_oxyd"]    = ti["~"] .. @{"st_oxyd", "myoxyd%%"@}
+ at c ----------------- add --------------------
+ at node add
+ at subsection add
 
-myrandom = res.random(ti, " ", @{"s", "t"@})
+Add @ref{Other Objects} to the world or a portable item to an inventory or
+other container object.
 
-myautotile = res.autotile(myrandom, @{"a", "h", "template_trigger"@},
-                              @{"A", "H", "template_oxyd"@})
+ at table @asis
+ at item @b{Syntax:}
+ at b{wo:add}(@i{tile_declarations})
 
-w, h = wo(myautotile, " ", @{
-"A~                ~E",
-"~~                ~~",
-"~~   h        b   ~~",
-"~~                ~~",
-"B~     c    d     ~F",
-"~~                ~~",
-"~~        1       ~~",
-"~~                ~~",
-"C~     f    e     ~G",
-"~~                ~~",
-"~~   g        a   ~~",
-"~~                ~~",
-"D~                ~H"
-@})
+ at b{wo:add}(@i{target}, @i{tile_declarations})
 
-wo:shuffleOxyd()
+ at table @asis
+ at item @i{tile_declarations}
+One or many other object declarations given as tiles or anonymous tables.
+ at item @i{target}
+ at samp{YIN}, @samp{YANG} or valid @ref{Object Reference}
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+wo:add(@{"ot_rubberband", anchor1="a1", anchor2="w", length=2, strength=80, threshold=0@})
+wo:add(ti["r"] .. @{"ot_wire", anchor1="w1", anchor2="w2"@})
+wo:add(YIN, @{"it_magicwand@})
+wo:add(no["mybag"], @{"it_magicwand@} .. ti["h"] .. ti["c"])
 @end example
+
+ at item @b{Details:}
+Just @ref{Other Objects} can be directly added to the world. Just portable
+ at ref{Items} can be added to the player's inventories @samp{YIN} and @samp{YANG}
+and to @ref{it_bag}s. No other targets do currently add objects by this method.
+
 @end table
 
- at c ----------------- Custom Resolver --------------------
+ at c ----------------- drawBorder --------------------
+ at node drawBorder
+ at subsection drawBorder
 
- at node Custom Resolver
- at section Custom Resolver
+Draw a border around a rectangle out of given tiles.
 
-A customer resolver is a function in the level that allows a dynamic remapping
-of tiles. When this function is registered in the resolver chain it is called
-once for every tile to be set. The tile that this function return will be set.
+ at table @asis
+ at item @b{Syntax:}
+ at b{wo:drawBorder}(@i{upperleft_edge}, @i{lowerright_edge}, @i{tile})
 
-Typical use cases are design patterns that are easy to calculate, but tedious
-to draw in the map and dynamic generated levels that differ slightly on every
-restart.
+ at b{wo:drawBorder}(@i{upperleft_edge}, @i{width}, @i{height}, @i{tile})
 
 @table @asis
+ at item @i{upperleft_edge}
+Upper left anchor position of the rectangle.
+ at item @i{lowerright_edge}
+Lower right end position of the rectangle.
+ at item @i{width}
+Width of the rectangle.
+ at item @i{height}
+Height of the rectangle.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+wo:drawBorder(po(0, 0), wo["Width"], wo["Height"], ti["#"])
+wo:drawBorder(no["myRectUL"], no["myRectLR"], @{"st_grate1"@})
+ at end example
+
+ at item @b{Details:}
+The rectangle as four one grid thick lines is drawn with the given tile. That
+means on every position of the rectangle itself an instance of every object of
+the tile declaration is set. The rectangle may degenerate to a single line.
+
+ at end table
+
+ at c ----------------- drawMap --------------------
+ at node drawMap
+ at subsection drawMap
+
+Even if the world is initialized by a map on creation of the world
+(@pxref{World Creation}), it is sometime useful to
+be able to draw smaller submaps either as part of the initialization or as
+dynamic level changes within @ref{Callback Function}. Of course the main purpose
+of @samp{drawMap} is the drawing of repeating patterns.
+
+ at table @asis
 @item @b{Syntax:}
-tile = @b{myresolver}(@i{key}, @i{x}, @i{y})
 
+ at b{wo:drawMap}(@i{resolver}, @i{anchor}, @i{ignore}, @i{map}, [@i{readdir}])
+
+ at b{wo:drawMap}(@i{resolver}, @i{anchor}, @i{libmap-map}, [@i{readdir}])
+
 @table @asis
- at item @i{key}
-String that contains the tile key to be resolved.
- at item @i{x}
-The world x coordinate of the tile.
- at item @i{y}
-The world y coordinate of the tile.
+ at item @i{subresolver}
+Resolver to which unresolved requests should be forwarded. May be @samp{ti}
+as the final resolver of the resolver chain.
+ at item @i{anchor}
+The anchor position where the upper left tile of the map should be drawn.
+ at item @i{ignore}
+A tile key string that should be ignored. This key string is mandatory, even
+if it not used within the map.
+ at item @i{map}
+A table of strings. Each string describes a row of tiles by its tile keys.
+ at item @i{libmap-map}
+If the map used is created via @ref{libmap}, the @samp{ignore}-string can
+be omitted. The map's default key will then be ignored instead.
+ at item @i{readdir}
+An optional argument to modify the direction of the map relative to the world.
+This argument can be any of the constants described in @ref{Rotating and
+Mirroring Maps}.
 @end table
 
+ at item @b{Syntax Samples:}
+ at example
+wo:drawMap(ti, po(5, 7), "-", @{"abcabc"@})
+wo:drawMap(ti, anchor_object, "--", @{"--##--##","##--##"@})
+wo:drawMap(ti, @{12, 5@}, " ", @{"122  221"@}, MAP_ROT_CW)
+ at end example
+
 @item @b{Details:}
-A custom resolver function is the last resolver that is called in the chain.
-It has to return the final tile that should be drawn at the given position.
-This can be done by statement @samp{return ti["k"]}, which references the tile
-already declared in the tiles map.
+The syntax is similar to the world creation call. But there are two essential
+differences you need to be aware of. First the map is drawn in the already
+existing world. Thus we need to define the position. This is done via the
+anchor position, which can be an already existing object, too.
 
-If no suited tile is already declared you can alternatively return a new tile
-like @samp{return ti(@{"st_switch", state=ON@})}.
+The second difference is in the definition of a tile key string for tiles in
+the map that should be ignored. Remember that the world initialization requested
+a default tile key string. This default is still valid. But with the given
+ignore key string we can draw arbitrary shaped patterns by filling unused
+grids in the map with this key.
 
-If you decide not to draw any tile at all, you must return an empty tile
-declaration: @samp{return ti(@{@})}.
+The length of the ignore key defines the map key length. It is strongly
+recommended to use the same key length as in the world map.
 
- at samp{return nil} indicates an error of usage of an unknown tile key.
+The rows of the supplied map are drawn from the anchor position. The rows may
+be of different length and may start with ignore tile keys. The anchor must be
+the position composed of the smallest x and smallest y coordinate within the
+pattern.
 
- at item @b{Example:}
+You can use drawMap anywhere after the world creation. You are even allowed to
+use it within the world creation in a resolver.
+
+ at item @b{Full Example:}
 @example
-ti["r"] = @{"fl_rough_red"@}
-ti["b"] = @{"fl_rough_blue"@}
-ti["1"] = @{"#ac-blackball"@}
+ti[" "] = @{"fl_plank"@}
+ti["X"] = @{"st_oxyd"@}
+ti["B"] = @{"st_passage_black", flavor="frame"@}
+ti["W"] = @{"st_passage_white", flavor="frame"@}
+ti["y"] = @{"it_yinyang"@}
+ti["1"] = ti["y"] .. @{"#ac_marble_black"@}
+ti["2"] = ti["y"] .. @{"#ac_marble_white"@}
 
-ti["x"] = @{"it_cross"@}
-
 function myresolver(key, x, y)
-    if key == " " then
-        local center = ((x%3) * (y%3))%2
-        local checker = ((math.modf(x/3) %2) + (math.modf(y/3) %2))%2
-        if center + checker == 1 then
-            return ti["r"]
-        else
-            return ti["b"]
-        end
+    if key == "w" then
+        wo:drawMap(ti, po(x-1, y-1), "-", @{"-W-",
+                                           "WXW",
+                                           "-W-"@})
+        return ti(@{@})
+    elseif key == "b" then
+        wo:drawMap(ti, po(x-1, y-1), "-", @{"-B",
+                                           "BXB",
+                                           "-B"@})
+        return ti(@{@})
     else
         return ti[key]
     end
@@ -6592,22 +6832,767 @@
 
 w, h = wo(myresolver, " ", @{
 "                    ",
+"  b         b       ",
+"       w       w    ",
 "                    ",
 "                    ",
-"      x x           ",
-"       x            ",
-"      x x           ",
-"                    ",
-"          1         ",
-"                    ",
-"                    ",
-"                    ",
-"                    ",
+"   w                ",
+"         12      b  ",
+"              w     ",
+"         w          ",
+"      b             ",
+"   w           b    ",
+"         b          ",
 "                    "
 @})
+wo:shuffleOxyd()
 @end example
 @end table
 
+ at c ----------------- drawRect --------------------
+ at node drawRect
+ at subsection drawRect
+
+Fill a rectangle with a given tile.
+
+ at table @asis
+ at item @b{Syntax:}
+ at b{wo:drawRect}(@i{upperleft_edge}, @i{lowerright_edge}, @i{tile})
+
+ at b{wo:drawRect}(@i{upperleft_edge}, @i{width}, @i{height}, @i{tile})
+
+ at table @asis
+ at item @i{upperleft_edge}
+Upper left anchor position of the rectangle.
+ at item @i{lowerright_edge}
+Lower right end position of the rectangle.
+ at item @i{width}
+Width of the rectangle.
+ at item @i{height}
+Height of the rectangle.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+wo:drawRect(po(0, 0), wo["Width"], wo["Height"], ti[" "])
+wo:drawRect(no["myRectUL"], no["myRectLR"], @{"fl_water"@})
+ at end example
+
+ at item @b{Details:}
+The complete rectangle is filled with the given tile. That means on every
+position of the rectangle and its interior an instance of every object of
+the tile declaration is set. The rectangle may degenerate to a single line.
+
+ at end table
+
+ at c ----------------- world floor --------------------
+ at node world floor
+ at subsection world floor
+
+Retrieves the floor objects for the given position or positions.
+
+ at table @asis
+ at item @b{Syntax:}
+result = @b{wo}:@b{fl}(<@i{pos}| @{@i{x}, @i{y}@}|@i{x}, @i{y}| @i{obj} | @i{group}| @i{polist}>)
+
+ at item @b{Details:}
+This world method is identical to the global function @ref{fl}.
+
+ at end table
+
+ at c ----------------- world item --------------------
+ at node world item
+ at subsection world item
+
+Retrieves the item objects for the given position or positions.
+
+ at table @asis
+ at item @b{Syntax:}
+result = @b{wo}:@b{it}(<@i{pos}| @{@i{x}, @i{y}@}|@i{x}, @i{y}| @i{obj} | @i{group}| @i{polist}>)
+
+ at item @b{Details:}
+This world method is identical to the global function @ref{it}.
+
+ at end table
+
+ at c ----------------- shuffleOxyd --------------------
+ at node shuffleOxyd
+ at subsection shuffleOxyd
+
+Shuffling the color distribution of the @ref{st_oxyd} makes every level, that
+is no meditation, a bit generic. On every level start the level looks a little
+bit different and the user has to solve a modified level. This provides long
+term amusement. Thus the call of this method is part of most levels.
+
+Many levels just call this method without any arguments. This results in a
+shuffling of all @ref{st_oxyd} that are not excluded by a @samp{noshuffle}
+attribute.
+
+But sometimes levels need to influence the shuffling, either for ensuring that
+the level remains solvable, or simply to ensure fairness. Imagine a level that
+has two @ref{st_oxyd}s in every corner. If by chance a user gets a distribution
+where he has in each corner a pair of same colored oxyds, the level might be
+trivial. Another level may have a passage that the marble can pass just a few
+times. With 5 or more oxyds on each side of the passage you need to ensure that
+the marble never needs to pass the passage more often than possible. Both
+situations can be handled by providing proper rules as arguments to this method.
+
+ at table @asis
+ at item @b{Syntax:}
+
+ at b{wo:shuffleOxyd}(@i{rules})
+
+ at table @asis
+ at item @i{rules} = @i{rule}, @i{rule},...
+No rule or as many as you like, all separated by a comma.
+ at item @i{rule} = @{@i{group1}, @i{group2}, @i{maxrule}, @i{minrule}, @i{circularrule}, @i{linearrule}, @i{log}@}
+Each rule is a table with a subset of the listed entries. The @i{group1} entry
+is mandatory. All other entries are optional and can be added in any combination.
+ at item @i{group1} = @i{group} | @i{objectreference} | @i{objectspecifier}
+A description of oxyd objects that are part of the first rule group. Either
+a group or a single object reference or a string specifier that resolves to a
+single or via wildcard to several oxyd objects are legal descriptors.
+ at item @i{group2} = @i{group} | @i{objectreference} | @i{objectspecifier}
+A description of oxyd objects that are part of the second rule group. Either
+a group or a single object reference or a string specifier that resolves to a
+single or via wildcard to several oxyd objects are legal descriptors.
+ at item @i{maxrule} = @code{max = }@i{number}
+The maximum number of oxyd pairs.
+ at item @i{minrule} = @code{min = }@i{number}
+The minimum number of oxyd pairs.
+ at item @i{circularrule} = @code{circular = true}
+Avoid any pair of neighboring oxyds in group1. Avoid an oxyd pair of first and
+last oxyd in group1, too.
+ at item @i{linearrule} = @code{linear = true}
+Avoid any pair of neighboring oxyds in group1.
+ at item @i{log} = @code{log = } @ @  @code{"solution"} |@code{"count"} |@code{"all"}
+Log additional information to the log stream for debugging purposes and
+security checks by the level author.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+wo:shuffleOxyd()
+wo:shuffleOxyd(@{no["borderoxyds#*"]:sort("circular"), circular=true@})
+wo:shuffleOxyd(@{"leftoxyds#*","rightoxyds#*", min=3@}, @{"islandoxyds#*", max=0@})
+ at end example
+
+ at item @b{Details:}
+
+Any call of @samp{wo:shuffleOxyd()} must occur after all @ref{st_oxyd} have been
+set. That means that it must follow the standard world initialization
+(@pxref{World Creation}). As a side effect shuffleOxyd
+will assign colors to all @samp{OXYD_AUTO} colored @ref{st_oxyd}.
+
+Once called the given shuffling rules remain valid. Any further reshuffling
+must be done by messages @samp{closeall} and @samp{shuffle} to one arbitrary
+ at ref{st_oxyd} instance. No addition of an @ref{st_oxyd} or subsequent
+ at samp{wo:shuffleOxyd()} calls are possible without disturbing and deleting the
+given rules.
+
+Rule based shuffling is limited to a maximum of one pair of each standard oxyd
+color plus any combination of additional special fake, quake or bold oxyds
+summing up to a maximum of 32 oxyds. If more than 32 oxyds or 2 or more pairs
+of a single standard color are set, all oxyds will be shuffled by random
+ignoring any provided rules.
+
+There are basically two different types of rules. Those with one group and those
+with two groups of oxyds (Note that group is the general API expression for
+a set of oxyds and not a mathematical group). For a single group the rules apply
+to the oxyd instances within this group. For two groups the rules apply to oxyd
+pairs with one oxyd in the first group and the other in the second group.
+
+E.g. @samp{@{"islandoxyds#*", max=0@}} requests that there is no pair within
+this group of oxyds. Whereas @samp{@{"leftoxyds#*","rightoxyds#*", min=3@}}
+requests that there are 3 different oxyd pairs, each with one oxyd out of the
+leftoxyd group and the second out of the rightoxyd group.
+
+Linear and circular rules can only be applied to a single group. They are
+shortcuts for the most common rules that are applied to oxyds arranged on a
+line or a circle. In both cases they avoid pairs of neighboring oxyds. They
+are equivalent to @samp{n-1} res. @samp{n} rules with all possible neighboring
+oxyd pairs as two groups and a rule of @samp{max=0}.
+
+Note that you can apply several rules at once to given groups. E.g. you can
+apply a minrule and a maxrule within one rule!
+
+The shuffling process consists always of two stages. The most important first
+stage generates a valid oxyd pair distribution. That means that we settle which
+pairs will have the same color. But the color itself is assigned in an
+independent second stage. As for the examination of given rules just the pair
+distribution is relevant, we do just count and log these different distributions
+ignoring the colors.
+
+With 16 oxyds of 8 different colors and no restricting rules you have 2027025
+(15 * 13 * 11 * 9 * 7 * 5 * 3) different valid distributions. Keep in mind
+that useful rules should always keep hundreds or thousands of different valid
+distributions for a level.
+
+For debugging purposes you can add a log parameter to one of the rules (it does
+not matter to which one). If you request the log of @samp{solution} the
+pair distribution will be printed to the log stream.
+
+In case of @samp{count} the number of different oxyd distributions will be
+counted and logged. It is recommended to check the count on complex rules to
+ensure that enough distributions remain for a varying game. But be careful
+applying count on trivial rules. With 16 oxyds there may be as many as
+2027025 distributions and it may take a standard PC up to 30 seconds to count
+them - add a factor of 17*19 for 20 oxyds!
+
+Be very, very cautious in usage of logging @samp{all}. This call tries to print
+all solutions. It takes ages if there are too many solutions. First check the
+count before trying to log the solutions.
+
+ at item @b{Full Example:}
+ at example
+wo["ConserveLevel"] = false
+
+ti["~"] = @{"fl_water"@}
+ti[" "] = @{"fl_plank"@}
+ti["c"] = @{"it_crack_l", brittleness=0@}
+ti["^"] = @{"st_oneway_n"@}
+ti["1"] = @{"ac_marble_black", 0, 0.5@}
+
+ti["x"] = @{"st_oxyd", "island#"@}
+ti["y"] = @{"st_oxyd", "left#"@}
+ti["z"] = @{"st_oxyd", "right#"@}
+
+w, h = wo(ti, " ", @{
+"~~x  x  x  x  x  x~~",
+"~~                ~~",
+"~~~~^~~~~~~~~~~^~~~~",
+"y       ~~~~       z",
+"~       cccc       ~",
+"y       ~~~~       z",
+"~       cccc       ~",
+"y       ~~~~       z",
+"~       cccc       ~",
+"y       ~~~~       z",
+"~~~~c~~~~~~~~~~c~~~~",
+"~~                ~~",
+"~~        1       ~~"
+@})
+
+wo:shuffleOxyd(@{"island#*", min=3, linear=true@}, @{"left#*","right#*", max=2, min=2@})
+ at end example
+
+This level uses 14 oxyds. The 6 oxyds in the upper row are on an island that
+can not be left once the marble entered it through one of the oneways. Thus
+we need 3 pairs of oxyds on this island, which are enforced by the min rule.
+To avoid trivial neighboring pairs on the island, we do add a linear rule, too.
+The marble can pass just three times between the left and right islands. This
+allows a first look on the color oxyds with one pass and opening one pair on
+each of the two following passes. Thus we limit the number of pairs by a max
+rule to 2. To avoid trivial oxyd pair distributions, like two pairs on the left
+and two pairs on the right side, we do add a min rule that enforces that two
+shared pairs of oxyds do exist.
+ at end table
+
+ at c ----------------- world stone --------------------
+ at node world stone
+ at subsection world stone
+
+Retrieves the stone objects for the given position or positions.
+
+ at table @asis
+ at item @b{Syntax:}
+result = @b{wo}:@b{st}(<@i{pos}| @{@i{x}, @i{y}@}|@i{x}, @i{y}| @i{obj} | @i{group}| @i{polist}>)
+
+ at item @b{Details:}
+This world method is identical to the global function @ref{st}.
+
+ at end table
+
+
+ at c ----------------- Functions --------------------
+
+ at node Functions
+ at section Functions
+
+Besides all the features strongly related to a value as context and thus
+implemented as operators or methods of these datatypes, a few other tasks 
+remain. These are either context free or take at least in one variation just a 
+standard Lua datatype, that does not supply a context. Thus these tasks are
+implemented as simple functions.
+
+ at menu
+* assert_bool::     Throws an error if a condition doesn't hold.
+* assert_type::     Throws an error if a variable is not of a given type.
+* cond::            A ternary operator, wrapper for if-then-else.
+* etype::           An advanced function to return normal and user data types.
+* fl::              Floor retrieval
+* grp::             Create a group out of the argument objects
+* it::              Item retrieval
+* random::          Random number generator
+* st::              Stone retrieval
+* usertype::        Type info for Enigma userdata types 
+ at end menu
+
+ at c ----------------- assert_bool --------------------
+
+ at node assert_bool
+ at subsection assert_bool
+
+The function @samp{assert_bool} throws an error if a given condition doesn't hold.
+
+ at table @asis
+ at item @b{Syntax:}
+ at b{assert_bool}(@i{condition}, @i{message}, @i{level})
+
+ at table @asis
+ at item @i{condition}
+A boolean expression or anything else. If it is @code{false} or @code{nil}, an
+error will be thrown.
+
+ at item @i{message}
+A string, holding the error message. If @code{message} is nil or empty, an
+"anonymous assertion" will be thrown, but it's always better to provide a
+meaningful error message.
+
+ at item @i{level}
+ at code{level} specifies the error position in the same way as does Lua's
+ at samp{error}-function. Default is 1.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+ at i{assert_bool}(@i{no}["@var{mystone}"]:@b{exists}(), "@var{Stone 'mystone' has disappeared.}")
+ at end example
+
+ at item @b{Details:}
+Assertions help you to detect coding errors. They are heavily used on argument
+checks of library functions and resolver implementations. As the assertions
+should not lead to performance penalties during runtime they are just evaluated
+when the level's @samp{status} is declared in the XML header element @ref{<version>}
+with a value of either @code{"test"} or @code{"experimental"}. For @code{"stable"} 
+and @code{"released"} levels assert statements are simply skipped on compilation
+like Lua comments.
+
+Similar to @ref{cond}, all side effects within the evaluation of @samp{message}
+and @samp{level} will appear.
+
+See Lua's manual for more detailed information about the @samp{error}-function.
+
+ at end table
+
+ at c ----------------- assert_type --------------------
+
+ at node assert_type
+ at subsection assert_type
+
+The function @samp{assert_type} throws an error if the first argument is not of one of the
+specified types.
+
+ at table @asis
+ at item @b{Syntax:}
+ at b{assert_type}(@i{var}, @i{vardescription}, @i{level}, @i{type1}, @i{type2}, ...)
+
+ at table @asis
+ at item @i{var}
+Any kind of variable.
+
+ at item @i{vardescription}
+If @samp{var} is not of one of the types @samp{type1}, @samp{type2} ...,
+then an error message will be thrown which includes the actual type of
+ at samp{var} and the desired types. @samp{vardescription} is a string which
+holds additional information for the error message. It should be a lower-case
+not-too-short description of @samp{var} (a name, as it is), additional
+details should be added in brackets.
+
+ at item @i{level}
+ at code{level} specifies the error position in the same way as does Lua's
+ at samp{error}-function. Can't be omitted, use @samp{1} if in doubt.
+
+ at item @i{type1}, @i{type2}, ...
+A sequence of strings. If @samp{var} is none of these types, the error will
+be thrown. See details below for type descriptors.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+ at i{assert_type}(@var{arg1}, "@var{mygreatfunction first argument (level width)}", @var{1}, "@b{nil}", "@b{positive integer}", "@b{position}")
+ at end example
+
+ at item @b{Details:}
+Assertions help you to detect coding errors. They are heavily used on argument
+checks of library functions and resolver implementations. As the assertions
+should not lead to performance penalties during runtime they are just evaluated
+when the level's @samp{status} is declared in the XML header element @ref{<version>}
+with a value of either @code{"test"} or @code{"experimental"}. For @code{"stable"} 
+and @code{"released"} levels assert statements are simply skipped on compilation
+like Lua comments.
+
+Possible types are all Lua types (like @code{"nil"}, @code{"number"},
+ at code{"boolean"}, @code{"string"}, @code{"table"}, @code{"function"}) except
+ at code{"userdata"}, all Enigma-own user types (@code{"object"},
+ at code{"position"}, @code{"tile"}, @code{"tiles"}, @code{"group"},
+ at code{"world"}, @code{"polist"}, @code{"unknown"}), and
+types defined inside metatables (@code{"map"} from @ref{libmap}), see
+ at ref{etype}. In addition, the following type descriptors are recognized:
+ at table @asis
+ at item @code{"integer"}
+Any integer number (..., -2, -1, 0, 1, 2, ...)
+ at item @code{"positive"}
+Any number which is positive and not zero.
+ at item @code{"non-negative"}
+Any number which is not negative, i.e. which is positive or zero.
+ at item @code{"natural"}
+Any non-negative integer number (0, 1, 2, ...).
+ at item @code{"positive integer"}
+Any positive integer number (1, 2, 3, ...).
+ at item @code{"non-empty string"}
+Any string other than the empty string @code{""}.
+ at item @code{"any table"}
+If @samp{var} is a table, the @samp{_type}-attribute of its metatable will
+be used as its @ref{etype}. In particular, it won't be accepted as a
+ at code{"table"} anymore, if this @samp{_type}-attribute exists. For example,
+ at example
+assert_type(mytable, "large table", 1, "table")
+ at end example
+will throw an assertion when @samp{mytable} is a @code{"map"}, although,
+technically, a @code{"map"} always is a @code{"table"}. You can use
+ at code{"any table"} as type to allow for any table, regardless of its metatable.
+ at item @code{"valid object"}
+Any valid object.
+ at end table
+
+Similar to @ref{cond}, all side effects within the evaluation of
+ at samp{vardescription}, @samp{level} and any type descriptor will apply.
+
+See Lua's manual for more detailed information about the @samp{error}-function.
+
+ at item @b{Full Example:}
+ at example
+function paint_lawn(pos)
+    assert_type(pos, "paint_lawn first argument", 2, "position", "object", "polist", "group", "table")
+    if etype(pos) == "object" then
+        assert_bool(-pos, "paint_lawn: Object not existing.", 2)
+    end
+    wo[pos] = ti["lawn"]
+end
+paint_lawn(no["mystone"])
+paint_lawn("myotherstone")
+ at end example
+If @samp{mystone} doesn't exist, @code{no["mystone"]} will still be of etype
+ at code{"object"}, an invalid object. Hence @code{assert_type} will not trigger,
+but @code{assert_bool} will.
+
+If @samp{mystone} exists, the second @samp{paint_lawn} will throw an error via
+ at samp{assert_type}, as @code{pos} now is a @code{"string"}. The error message
+will be:
+ at example
+Wrong type for paint_lawn first argument, is string, must be one of position,
+object, polist, group, table.
+ at end example
+ at end table
+
+ at c ----------------- cond --------------------
+
+ at node cond
+ at subsection cond
+
+ at samp{cond} is a conditional assignment, a substitution for the ternary
+ at samp{?:} operator of C-like languages. Note however, that it is not a 
+equivalent substitution but just a workaround with some subtle side effects. 
+
+ at table @asis
+ at item @b{Syntax:}
+ at b{cond}(@i{condition}, @i{iftrue}, @i{iffalse})
+
+ at table @asis
+ at item @i{condition}
+A boolean expression.
+
+ at item @i{iftrue}
+The expression to be returned if @samp{condition} is true.
+
+ at item @i{iffalse}
+The expression to be returned if @samp{condition} is false.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+ at i{ti}["@var{x}"] = @i{cond}(@i{wo}["@b{IsDifficult}"], @{"@b{st_death}"@}, @i{ti}["@var{#}"])
+ at end example
+
+ at item @b{Details:}
+ at samp{cond} always evaluates both expressions @samp{iftrue} and
+ at samp{iffalse}, regardless of @samp{condition}. Hence,
+ at example
+ at var{mytable} = @{@var{1}, at var{2}, at var{3}, at var{4}, at var{5}, at var{6}, at var{7}, at var{8}, at var{9}, at var{0}@}
+ at var{removed_element} = @i{cond}(@var{i} < @var{5}, @i{table}. at i{remove}(@var{mytable}, @var{i}), @i{table}. at i{remove}(@var{mytable}, @var{5}))
+ at end example
+will always remove two elements. With @samp{i=2} the @samp{2} will be returned
+but @samp{mytable} will result in @samp{@{1,3,4,5,7,8,9,0@}}, and with @samp{i=6}
+you get the @samp{5} but mytable will be @samp{@{1,2,3,4,7,8,9,0@}}.
+
+Another Enigma example that will cause errors is:
+ at example
+ at var{w}, at var{h} = @i{cond}(@i{wo}["@b{IsDifficult}"], @i{wo}(@i{ti}, " ", @var{map1}), @i{wo}(@i{ti}, " ", @var{map2}))
+ at end example
+Both, the second and the third argument will be evaluate. Thus two contradicting
+attempts to create a new world will be made causing the second one to fail. Use
+the following statement instead:
+ at example
+ at var{w}, at var{h} = @i{wo}(@i{ti}, " ", @i{cond}(@i{wo}["@b{IsDifficult}"], @var{map1}, @var{map2}))
+ at end example
+However, in most cases @samp{cond} is used anyway with static expressions for
+ at samp{iftrue} and @samp{iffalse} (e.g. strings or variables) and no side effects
+will occur.
+
+ at end table
+
+ at c ----------------- etype --------------------
+ at node etype
+ at subsection etype
+
+The function @samp{etype()} returns the advanced type of its argument.
+
+ at table @asis
+ at item @b{Syntax:}
+ at b{etype}(@i{var})
+
+ at table @asis
+ at item @i{var}
+Any kind of variable.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{argtype} = @i{etype}(@var{value})
+ at end example
+
+ at item @b{Details:}
+Lua types are @code{"nil"}, @code{"number"}, @code{"boolean"}, @code{"string"},
+ at code{"table"}, @code{"function"}, @code{"userdata"}, and @code{"thread"}. You
+can use Lua's @samp{type}-function to query the type of any variable. However,
+Enigma defines more types through various means, and these types can be queried
+via @samp{etype}. @samp{etype} will return its argument's Lua type as usual,
+with the following two exceptions:
+ at table @asis
+ at item @i{"userdata"}
+Instead of @code{"userdata"}, Enigma's special types will be returned. These
+special types are @code{"object"}, @code{"position"}, @code{"tile"},
+ at code{"tiles"}, @code{"group"}, @code{"world"}, @code{"polist"} and 
+ at code{"default"}. If an unknown userdata is encountered, @code{"unknown"} will
+be returned.
+
+ at item @i{"table"}
+If @code{var} is a table, it's metatable will be queried. If there is an entry
+ at samp{_type}, this entry will be used as @code{etype}. Most important examples
+of this kind are @ref{libmap}-maps and @ref{res.maze} with its mazes and cells.
+So @samp{etype} will return @code{"map"}, @code{"maze"} and @code{"cell"}, too.
+You may access the @code{etype}-system through @samp{_type} whenever you use
+metatables on your own.
+ at end table
+
+ at end table
+
+ at c ----------------- fl --------------------
+ at node fl
+ at subsection fl
+
+The function @samp{fl()} retrieves the floor objects for the given position or
+positions.
+
+ at table @asis
+ at item @b{Syntax:}
+result = @b{fl}(<@i{pos}| @{@i{x}, @i{y}@}|@i{x}, @i{y}| @i{obj} | @i{group}| @i{polist}>)
+
+ at item @b{Details:}
+If the argument describes a single position, the floor object at this position 
+is returned. When this single position is outside of the world an invalid
+ at samp{NULL} @ref{Object} reference is returned.
+
+If the argument is either a @ref{Group} or @ref{PositionList} all floor objects
+of the related positions are retrieved and added in the same sequence to a new
+result group. Invalid positions will be skipped without adding an object to the
+group.
+
+In any case you can send messages to the result value.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{floor} = @i{fl}(@i{po}(@var{3}, @var{5}))
+ at var{floor} = @i{fl}(@{@var{3}, @var{5}@})
+ at var{floor} = @i{fl}(@var{3}, @var{5})
+ at var{floor} = @i{fl}@{@var{3}, @var{5}@}     -- by Lua syntax equivalence
+ at var{floor} = @i{fl}(@var{mystone})
+ at var{group} = @i{fl}(@i{no}["door#*"])
+ at var{group} = @i{fl}(@i{po}(@var{3}, @var{5}).. at i{po}(@var{4}, @var{2}))
+ at end example 
+
+ at end table
+
+ at c ----------------- grp --------------------
+ at node grp
+ at subsection grp
+
+The function @samp{grp()} builds a @ref{Group} out of its argument @ref{Object}s.
+
+ at table @asis
+ at item @b{Syntax:}
+ at b{grp}(<@{@i{obj1}, at i{obj2},...@}| @i{obj1}, at i{obj2},... |@i{group}>)
+
+ at item @b{Details:}
+Returns a new @ref{Group} that is build up by the objects listed by the 
+arguements. The contents objects must be either listed in a Lua table, given
+as multiple single object arguments or an existing group. In all cases the
+sequence of objects is maintained in the returned new group, but all invalid
+ at samp{NULL} objects are omitted. In case one object is listed multiple times
+just the first instance will occur in the group and subsequent instances will
+be omitted.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{newgroup} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3})
+ at var{newgroup} = @i{grp}(@{@var{obj1}, at var{obj2}@})
+ at var{newgroup} = @i{grp}@{@var{obj1}, at var{obj2}@}   -- Lua syntax equivalence
+ at var{newgroup} = @i{grp}@{@}            -- empty group
+ at var{newgroup} = @i{grp}(@var{group})       -- a copy of group cleaned of invalid @samp{NULL} objects
+ at end example
+
+ at end table
+
+ at c ----------------- it --------------------
+ at node it
+ at subsection it
+
+The function @samp{it()} retrieves the item objects for the given position or
+positions.
+
+ at table @asis
+ at item @b{Syntax:}
+result = @b{it}(<@i{pos}| @{@i{x}, @i{y}@}|@i{x}, @i{y}| @i{obj} | @i{group}| @i{polist}>)
+
+ at item @b{Details:}
+If the argument describes a single position, the item object at this position 
+is returned. When no item is located at the given single position or this 
+position is outside of the world an invalid @samp{NULL} @ref{Object} reference
+is returned.
+
+If the argument is either a @ref{Group} or @ref{PositionList} all item objects
+of the related positions are retrieved and added in the same sequence to a new
+result group. Invalid positions or positions without items will be skipped 
+without adding an object to the group.
+
+In any case you can send messages to the result value.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{item} = @i{it}(@i{po}(@var{3}, @var{5}))
+ at var{item} = @i{it}(@{@var{3}, @var{5}@})
+ at var{item} = @i{it}(@var{3}, @var{5})
+ at var{item} = @i{it}@{@var{3}, @var{5}@}     -- by Lua syntax equivalence
+ at var{item} = @i{it}(@var{mystone})
+ at var{group} = @i{it}(@i{no}["door#*"])
+ at var{group} = @i{it}(@i{po}(@var{3}, @var{5}).. at i{po}(@var{4}, @var{2}))
+ at end example 
+
+ at end table
+
+ at c ----------------- random --------------------
+ at node random
+ at subsection random
+
+The function @samp{random()} is a syntax compatible replacement for the standard
+Lua function @samp{math.random()}. Both names refer to the same Enigma random
+implementation.
+
+ at table @asis
+ at item @b{Syntax:}
+result = @b{random}(<|@var{n}|@var{l}, at var{u}>)
+
+ at item @b{Details:}
+When called without arguments, math.random returns a pseudo-random real number
+in the range [0,1). When called with a number n, math.random returns a 
+pseudo-random integer in the range [1,n]. When called with two arguments, l and
+u, math.random returns a pseudo-random integer in the range [l,u].
+
+The only difference from the Lua implementation is the random generator itself.
+Enigma uses an own implementation that guarantees the same pseudo-random
+number sequence on any operating system and any processor for a given seed.
+This feature will be important for future Enigma versions and thus the 
+randomseed can not be modified by the level itself.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{float} = @i{random}()          -- e.g. 0.402834
+ at var{integer} = @i{random}(20)      -- e.g. 13
+ at var{integer} = @i{random}(5, 10)   -- e.g. 5
+ at end example 
+
+ at end table
+ at c ----------------- st --------------------
+ at node st
+ at subsection st
+
+The function @samp{st()} retrieves the stone objects for the given position or
+positions.
+
+ at table @asis
+ at item @b{Syntax:}
+result = @b{st}(<@i{pos}| @{@i{x}, @i{y}@}|@i{x}, @i{y}| @i{obj} | @i{group}| @i{polist}>)
+
+ at item @b{Details:}
+If the argument describes a single position, the stone object at this position 
+is returned. When no stone is located at the given single position or this 
+position is outside of the world an invalid @samp{NULL} @ref{Object} reference
+is returned.
+
+If the argument is either a @ref{Group} or @ref{PositionList} all stone objects
+of the related positions are retrieved and added in the same sequence to a new
+result group. Invalid positions or positions without stone will be skipped 
+without adding an object to the group.
+
+In any case you can send messages to the result value.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{stone} = @i{st}(@i{po}(@var{3}, @var{5}))
+ at var{stone} = @i{st}(@{@var{3}, @var{5}@})
+ at var{stone} = @i{st}(@var{3}, @var{5})
+ at var{stone} = @i{st}@{@var{3}, @var{5}@}     -- by Lua syntax equivalence
+ at var{stone} = @i{st}(@var{myfloor})
+ at var{group} = @i{st}(@i{no}["cherry#*"])
+ at var{group} = @i{st}(@i{po}(@var{3}, @var{5}).. at i{po}(@var{4}, @var{2}))
+ at end example 
+
+ at end table
+
+ at c ----------------- usertype --------------------
+ at node usertype
+ at subsection usertype
+
+The function @samp{usertype()} returns type info for Enigma data types.
+
+ at table @asis
+ at item @b{Syntax:}
+ at b{usertype}(@i{var})
+
+ at table @asis
+ at item @i{var}
+Any kind of variable.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{argtype} = @i{usertype}(@var{value})
+ at end example
+
+ at item @b{Details:}
+Just for Lua type @code{"userdata"} Enigma's special type info will be returned.
+These special types are @code{"object"}, @code{"position"}, @code{"tile"},
+ at code{"tiles"}, @code{"group"}, @code{"world"}, @code{"polist"} and 
+ at code{"default"}. If another data type is encountered, @code{"unknown"} will
+be returned.
+
+The function @ref{etype} provides a more general type evaluation for arbitrary
+data types and is partially based on this function.
+
+ at end table
+
+
 @c ===================  Commons  =======================
 @node Common Attributes and Messages
 @chapter Common Attributes and Messages
@@ -7668,7 +8653,7 @@
 
 A global read only variable reports the height of the world in grid units.
 This is set by the initial world constructor call
-(@pxref{World Creation and Resolver Chaining}).
+(@pxref{World Creation}).
 
 @table @asis
 @item @b{Type:} @ @ number
@@ -7760,7 +8745,7 @@
 A global variable that causes two @ref{it_extralife}s to be added to both player
 inventories on start of a new level. Set it to @samp{false} if a gamer could
 misuse these items. It is important to set this attribute before the world is
-created (@pxref{World Creation and Resolver Chaining}).
+created (@pxref{World Creation}).
 
 @table @asis
 @item @b{Type:} @ @ bool
@@ -7867,7 +8852,7 @@
 
 A global read only variable reports the width of the world in grid units.
 This is set by the initial world constructor call
-(@pxref{World Creation and Resolver Chaining}).
+(@pxref{World Creation}).
 
 @table @asis
 @item @b{Type:} @ @ number
@@ -12953,6 +13938,7 @@
 * st_ghost::           Invisible Transforming Stone
 * st_grate::           Hovering metal Grate
 * st_greenbrown::      Mainly brown seedable stone
+* st_ice::             Item and Floor freezing Ice block
 * st_jamb::            Colored Door Jamb
 * st_key::             Key Driven Switch
 * st_knight::          Sword Bearing Knight Stone
@@ -14289,6 +15275,33 @@
 @end table
 @end table
 
+ at c ----------------- Ice Stone --------------------
+ at node st_ice
+ at subsection st_ice
+ at obindex st_ice
+
+A block of ice is a movable stone that freezes some items when being pushed
+over them. Of course a floor of @ref{fl_water} will freeze, too, when ice is
+being pushed over it. But a block of ice can be destroyed by explosions and by
+heating fire leaving either @ref{fl_ice} or @ref{fl_water}.
+
+Note some minor details of st_ice are not yet stable - especially the fire
+interactions may still change.
+
+ at table @asis
+ at item @b{Messages:}
+
+ at table @asis
+ at item @b{ignite} @ @ @xref{ignite}
+ at item @b{heat} @ @ @xref{heat}
+ at end table
+
+ at item @b{Variants:}
+ at table @asis
+ at item @b{st_ice}
+ at end table
+ at end table
+
 @c ----------------- Jamb Stone --------------------
 @node st_jamb
 @subsection st_jamb
@@ -15536,8 +16549,8 @@
 very nature transparent to laser light. Like other @ref{Transparent Stones} it
 is passable for invisible actors.
 
-This stone looks identical to @ref{st_ice}, but differs of course in its
-features.
+This stone comes in a second texture variant that looks like being composed
+of 4 small rawglasses. This @samp{quad} variant is not movable.
 
 @table @asis
 @item @b{Attributes:}
@@ -15552,6 +16565,7 @@
 
 @table @asis
 @item @b{st_rawglass}: movable = @code{false}
+ at item @b{st_rawglass_quad}: movable = @code{false}
 @item @b{st_rawglass_movable}: movable = @code{true}
 @end table
 
@@ -15773,6 +16787,9 @@
 @obindex st_spitter
 
 A stone that spits @ref{ot_cannonball}s on actor hits and on proper messages.
+The standard spitter is @samp{ACTIVE} showing a slow rotating animation. In
+this @samp{state} the spitter reacts on actor hits, while being @samp{IDLE}
+it is steady and will spit just on messages.
 
 On an actor hit the spitter checks the owner's inventory for an existing
 @ref{it_extralife}. If one exists that is not stuffed in a @ref{it_bag}, it
@@ -15831,6 +16848,9 @@
 @item @b{Attributes:}
 
 @table @asis
+ at item @b{state}, @ @ @i{values}: @code{IDLE}, @code{ACTIVE}; @ @ @i{default}: @code{ACTIVE} @ @ @xref{state}
+An @samp{ACTIVE} spitter is animated and reacts on actor hits while an @samp{IDLE}
+looks steady and does not spit on actor hits.
 @item @b{hit_strength} @ @ @i{values}: floating point numbers; @ @ @i{default}: @code{1.0}; @ @ @xref{hit_*}
 @item @b{hit_distortion_xx} @ @ @i{values}: floating point numbers; @ @ @i{default}: @code{1.0}; @ @ @xref{hit_*}
 @item @b{hit_distortion_xy} @ @ @i{values}: floating point numbers; @ @ @i{default}: @code{0.0}; @ @ @xref{hit_*}
@@ -15850,7 +16870,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{st_spitter}: secure = @code{false}
+ at item @b{st_spitter}: secure = @code{false}, state = @code{ACTIVE}
 @end table
 
 @end table
@@ -17498,264 +18518,7 @@
 @uref{http://www.lua.org/manual/5.0/, Lua 5.0} and 
 @uref{http://www.lua.org/manual/5.1/, Lua 5.1} for more detailed information.
 
-In addition to the usual Lua functions, Enigma provides the @ref{cond}-function,
-which can be used to abbreviate simple if-then-else-constructions, and two
- at samp{assert}-kind functions.
 
- at menu
-* assert_bool::     Throws an error if a condition doesn't hold.
-* assert_type::     Throws an error if a variable is not of a given type.
-* cond::            A ternary operator, wrapper for if-then-else.
-* etype::           An advanced function to return normal and user data types.
- at end menu
-
- at c ----------------- assert_bool --------------------
-
- at node assert_bool
- at subsection assert_bool
-
- at samp{assert_bool} throws an error if a given condition doesn't hold.
-
- at table @asis
- at item @b{Syntax:}
- at b{assert_bool}(@i{condition}, @i{message}, @i{level})
-
- at table @asis
- at item @i{condition}
-A boolean expression or anything else. If it is @code{false} or @code{nil}, an
-error will be thrown.
-
- at item @i{message}
-A string, holding the error message. If @code{message} is nil or empty, an
-"anonymous assertion" will be thrown, but it's always better to provide a
-meaningful error message.
-
- at item @i{level}
- at code{level} specifies the error position in the same way as does Lua's
- at samp{error}-function. Default is 1.
- at end table
-
- at item @b{Syntax Samples:}
- at example
-assert_bool(no["mystone"], "Stone 'mystone' has disappeared.")
- at end example
-
- at item @b{Details:}
-Similar to @ref{cond}, all side effects within the evaluation of @samp{message}
-and @samp{level} will appear.
-
-See Lua's manual for more detailed information about the @samp{error}-function.
-
- at item @b{Full Example:}
- at example
- at end example
- at end table
-
- at c ----------------- assert_type --------------------
-
- at node assert_type
- at subsection assert_type
-
- at samp{assert_type} throws an error if the first argument is not of one of the
-specified types.
-
- at table @asis
- at item @b{Syntax:}
- at b{assert_type}(@i{var}, @i{vardescription}, @i{level}, @i{type1}, @i{type2}, ...)
-
- at table @asis
- at item @i{var}
-Any kind of variable.
-
- at item @i{vardescription}
-If @samp{var} is not of one of the types @samp{type1}, @samp{type2} ...,
-then an error message will be thrown which includes the actual type of
- at samp{var} and the desired types. @samp{vardescription} is a string which
-holds additional information for the error message. It should be a lower-case
-not-too-short description of @samp{var} (a name, as it is), additional
-details should be added in brackets.
-
- at item @i{level}
- at code{level} specifies the error position in the same way as does Lua's
- at samp{error}-function. Can't be omitted, use @samp{1} if in doubt.
-
- at item @i{type1}, @i{type2}, ...
-A sequence of strings. If @samp{var} is none of these types, the error will
-be thrown. See details below for type descriptors.
- at end table
-
- at item @b{Syntax Samples:}
- at example
-assert_type(arg1, "mygreatfunction first argument (level width)", 1, "nil", "positive integer", "position")
- at end example
-
- at item @b{Details:}
-Possible types are all Lua types (like @code{"nil"}, @code{"number"},
- at code{"boolean"}, @code{"string"}, @code{"table"}, @code{"function"}) except
- at code{"userdata"}, all Enigma-own user types (@code{"object"},
- at code{"position"}, @code{"tile"}, @code{"tiles"}, @code{"group"},
- at code{"world"}, @code{"polist"}, @code{"unknown"}), and
-types defined inside metatables (@code{"map"} from @ref{libmap}), see
- at ref{etype}. In addition, the following type descriptors are recognized:
- at table @asis
- at item @code{"integer"}
-Any integer number (..., -2, -1, 0, 1, 2, ...)
- at item @code{"positive"}
-Any number which is positive and not zero.
- at item @code{"non-negative"}
-Any number which is not negative, i.e. which is positive or zero.
- at item @code{"natural"}
-Any non-negative integer number (0, 1, 2, ...).
- at item @code{"positive integer"}
-Any positive integer number (1, 2, 3, ...).
- at item @code{"non-empty string"}
-Any string other than the empty string @code{""}.
- at item @code{"any table"}
-If @samp{var} is a table, the @samp{_type}-attribute of its metatable will
-be used as its @ref{etype}. In particular, it won't be accepted as a
- at code{"table"} anymore, if this @samp{_type}-attribute exists. For example,
- at example
-assert_type(mytable, "large table", 1, "table")
- at end example
-will throw an assertion when @samp{mytable} is a @code{"map"}, although,
-technically, a @code{"map"} always is a @code{"table"}. You can use
- at code{"any table"} as type to allow for any table, regardless of its metatable.
- at item @code{"valid object"}
-Any valid object.
- at end table
-
-Similar to @ref{cond}, all side effects within the evaluation of
- at samp{vardescription}, @samp{level} and any type descriptor will apply.
-
-See Lua's manual for more detailed information about the @samp{error}-function.
-
- at item @b{Full Example:}
- at example
-function paint_lawn(pos)
-    assert_type(pos, "paint_lawn first argument", 2, "position", "object", "polist", "group", "table")
-    if etype(pos) == "object" then
-        assert_bool(-pos, "paint_lawn: Object not existing.", 2)
-    end
-    wo[pos] = ti["lawn"]
-end
-paint_lawn(no["mystone"])
-paint_lawn("myotherstone")
- at end example
-If @samp{mystone} doesn't exist, @code{no["mystone"]} will still be of etype
- at code{"object"}, an invalid object. Hence @code{assert_type} will not trigger,
-but @code{assert_bool} will.
-
-If @samp{mystone} exists, the second @samp{paint_lawn} will throw an error via
- at samp{assert_type}, as @code{pos} now is a @code{"string"}. The error message
-will be:
- at example
-Wrong type for paint_lawn first argument, is string, must be one of position,
-object, polist, group, table.
- at end example
- at end table
-
- at c ----------------- cond --------------------
-
- at node cond
- at subsection cond
-
- at samp{cond} is a conditional assignment, a ternary operator very
-similar (but not equal to) the @samp{?:}-expression in C-like languages. Note
-however, that there are caveats, see details.
-
- at table @asis
- at item @b{Syntax:}
- at b{cond}(@i{condition}, @i{iftrue}, @i{iffalse})
-
- at table @asis
- at item @i{condition}
-A boolean expression.
-
- at item @i{iftrue}
-The expression to be returned if @samp{condition} is true.
-
- at item @i{iffalse}
-The expression to be returned if @samp{condition} is false.
- at end table
-
- at item @b{Syntax Samples:}
- at example
-cond(wo["IsDifficult"], @{"st_death"@}, ti["#"])
- at end example
-
- at item @b{Details:}
- at samp{cond} evaluates both expressions @samp{iftrue} and
- at samp{iffalse}, regardless of @samp{condition}. Hence,
- at example
-cond(t == 0, 1/t, error("Division by zero"))
- at end example
-will always raise an error: All side effects will happen.
-Another example which will not work:
- at example
-w,h = cond(wo["IsDifficult"], wo(ti, " ", map1), wo(ti, " ", map2))
- at end example
-Use this instead:
- at example
-w,h = wo(ti, " ", cond(wo["IsDifficult"], map1, map2))
- at end example
-However, in most cases @samp{cond} is used with static expressions for
- at samp{iftrue} and @samp{iffalse} (e.g. strings or variables), when no
-side effects are possible.
-
- at item @b{Full Example:}
- at example
- at end example
- at end table
-
- at c ----------------- etype --------------------
-
- at node etype
- at subsection etype
-
- at samp{etype} returns an advanced type of its argument.
-
- at table @asis
- at item @b{Syntax:}
- at b{etype}(@i{var})
-
- at table @asis
- at item @i{var}
-Any kind of variable.
- at end table
-
- at item @b{Syntax Samples:}
- at example
-local argtype = etype(firstargument)
- at end example
-
- at item @b{Details:}
-Lua types are @code{"nil"}, @code{"number"}, @code{"boolean"}, @code{"string"},
- at code{"table"}, @code{"function"}, @code{"userdata"}, and @code{"thread"}. You
-can use Lua's @samp{type}-function to query the type of any variable. However,
-Enigma defines more types through various means, and these types can be queried
-via @samp{etype}. @samp{etype} will return its argument's Lua type as usual,
-with the following two exceptions:
- at table @asis
- at item @i{"userdata"}
-Instead of @code{"userdata"}, Enigma's special types will be returned. These
-special types are @code{"object"}, @code{"position"}, @code{"tile"},
- at code{"tiles"}, @code{"group"}, @code{"world"}, and @code{"polist"}. If an unknown
-userdata is encountered, @code{"unknown"} will be returned.
-
- at item @i{"table"}
-If @code{var} is a table, it's metatable will be queried. If there is an entry
- at samp{_type}, this entry will be used as @code{etype}. Most important examples
-of this kind are @ref{libmap}-maps, so @samp{etype} will return @code{"map"}.
-You may access the @code{etype}-system through @samp{_type} whenever you use
-metatables on your own.
- at end table
-
- at item @b{Full Example:}
- at example
- at end example
- at end table
-
-
 @node liblua
 @section liblua
 
@@ -18454,8 +19217,8 @@
 @section libmap
 
 The @samp{libmap} gives the author more possibilities to work with API 2-maps. 
-Up to now, a map just is a table of strings, as described in @ref{World Creation
-and Resolver Chaining}. With @samp{libmap}, you can utilize maps in a more
+Up to now, a map just is a table of strings, as described in 
+ at ref{World Creation}. With @samp{libmap}, you can utilize maps in a more
 advanced way.
 
 This library is described as of release 1. 
@@ -19184,185 +19947,157 @@
 @chapter Advanced Features
 
 @menu
-* World Advanced Methods::  Additional features provided by the world
 * Resolvers::               Standard tools for interpretation of tile maps
 * General Features::        Special features like scrolling, flood, fire,...
 * Tips and Tricks::         Simple patterns that are valuable like a feature
 @end menu
 
- at node World Advanced Methods
- at section World Advanced Methods
+ at node Resolvers
+ at section Resolvers
 
 @menu
-* add::          Add @ref{Other Objects} to the world
-* drawBorder::
-* drawMap::
-* drawRect::
-* shuffleOxyd::  Oxyd Shuffling Rules
+* Resolver Chaining::  
+* Custom Resolver::    
+* res.autotile::       Generate tiles from given template declarations
+* res.composer::       Compose tiles from given base tiles
+* res.maze::           Generate arbitrarily shaped mazes
+* res.puzzle::         Generate puzzle tiles and shuffle resulting puzzle clusters
+* res.random::         Choosing random tiles in a given distribution
 @end menu
 
- at c ----------------- add --------------------
- at node add
- at subsection add
+ at c ----------------- Resolver Chaining --------------------
 
-Add @ref{Other Objects} to the world.
+ at node Resolver Chaining
+ at subsection Resolver Chaining
 
+Once all parameters have been set and all tiles have been declared it is time
+to create the level world with all its objects. This is done by the following
+constructor that appears in two variations.
+
+ at ref{World Creation}
+
 @table @asis
 @item @b{Syntax:}
- at b{wo:add}(@i{tile_declarations})
+width, height = @b{wo}(@i{topresolver}, ...)
 
- at b{wo:add}(@i{target}, @i{tile_declarations})
 
 @table @asis
- at item @i{tile_declarations}
-One or many other object declarations given as tiles or anonymous tables.
- at item @i{target}
- at samp{YIN}, @samp{YANG} or valid @ref{Object Reference}
+ at item @i{topresolver} = @code{ti} | @i{resolver} | @i{localresolver}
+Every tile in the world is given by a key that needs to be resolved to its
+declaration. This can be done either by the @ref{Tiles Repository} @samp{ti}, or
+by given library @ref{Resolvers} or by local @ref{Custom Resolver} function.
+This argument takes the top resolver that is requested first.
 @end table
 
- at item @b{Syntax Samples:}
- at example
-wo:add(@{"ot_rubberband", anchor1="a1", anchor2="w", length=2, strength=80, threshold=0@})
-wo:add(ti["r"] .. @{"ot_wire", anchor1="w1", anchor2="w2"@})
-wo:add(YIN, @{"it_magicwand@})
-wo:add(no["mybag"], @{"it_magicwand@} .. ti["h"] .. ti["c"])
- at end example
-
 @item @b{Details:}
-Just @ref{Other Objects} can be directly added to the world. Just non static
- at ref{Items} can be added to the player's inventories @samp{YIN} and @samp{YANG}
-and to @ref{it_bag}s. No other targets do currently add objects by this method.
+Every key is resolved to its tile declaration via the given resolver chain.
+The top resolver is given to this call as a parameter. If it is @samp{ti} the
+chain consists just of one element and the tile declaration stored in the tiles
+repository at the given key is taken. Otherwise the resolvers will be evaluated
+as explained in @ref{Resolver Chaining}.
 
- at item @b{Full Example:}
+But there exist several useful
+ at ref{Resolvers} that may simplify the task of level writing or provide dynamic
+features like randomness, mazes, etc. If you like to use one or several of them
+you provide the instance of the resolver to be requested first in this
+constructor. The instance that should be requested next is set in the top
+resolver as first argument, and so on. The last library resolver takes usually
+ at samp{ti} as its subresolver. For even more flexibility you can provide an
+own @ref{Custom Resolver} function within the level to take influence on the key
+interpretation. This function has to be the last resolver in the chain.
+
+ at item @b{Example:}
 @example
- at end example
- at end table
+ti["~"] = @{"fl_water"@}
+ti["s"] = @{"fl_sahara"@}
+ti["t"] = @{"fl_tigris"@}
+ti["1"] = @{"ac-blackball", 0, 0.5@}
 
- at c ----------------- drawBorder --------------------
- at node drawBorder
- at subsection drawBorder
+ti["template_trigger"] = @{"it_trigger", target="myoxyd%%", action="open"@}
+ti["template_oxyd"]    = ti["~"] .. @{"st_oxyd", "myoxyd%%"@}
 
-Draw a border around a rectangle out of given tiles.
+myrandom = res.random(ti, " ", @{"s", "t"@})
 
- at table @asis
- at item @b{Syntax:}
- at b{wo:drawBorder}(@i{upperleft_edge}, @i{lowerright_edge}, @i{tile})
+myautotile = res.autotile(myrandom, @{"a", "h", "template_trigger"@},
+                              @{"A", "H", "template_oxyd"@})
 
- at b{wo:drawBorder}(@i{upperleft_edge}, @i{width}, @i{height}, @i{tile})
+w, h = wo(myautotile, " ", @{
+"A~                ~E",
+"~~                ~~",
+"~~   h        b   ~~",
+"~~                ~~",
+"B~     c    d     ~F",
+"~~                ~~",
+"~~        1       ~~",
+"~~                ~~",
+"C~     f    e     ~G",
+"~~                ~~",
+"~~   g        a   ~~",
+"~~                ~~",
+"D~                ~H"
+@})
 
- at table @asis
- at item @i{upperleft_edge}
-Upper left anchor position of the rectangle.
- at item @i{lowerright_edge}
-Lower right end position of the rectangle.
- at item @i{width}
-Width of the rectangle.
- at item @i{height}
-Height of the rectangle.
+wo:shuffleOxyd()
+ at end example
 @end table
 
- at item @b{Syntax Samples:}
- at example
-wo:drawBorder(po(0, 0), wo["Width"], wo["Height"], ti["#"])
-wo:drawBorder(no["myRectUL"], no["myRectLR"], @{"st_grate1"@})
- at end example
+ at c ----------------- Custom Resolver --------------------
 
- at item @b{Details:}
+ at node Custom Resolver
+ at subsection Custom Resolver
 
+A customer resolver is a function in the level that allows a dynamic remapping
+of tiles. When this function is registered in the resolver chain it is called
+once for every tile to be set. The tile that this function return will be set.
 
- at item @b{Full Example:}
- at example
- at end example
- at end table
+Typical use cases are design patterns that are easy to calculate, but tedious
+to draw in the map and dynamic generated levels that differ slightly on every
+restart.
 
- at c ----------------- drawMap --------------------
- at node drawMap
- at subsection drawMap
-
-Even if the world is initialized by a map on creation of the world
-(@pxref{World Creation and Resolver Chaining}), it is sometime useful to
-be able to draw smaller submaps either as part of the initialization or as
-dynamic level changes within @ref{Callback Function}. Of course the main purpose
-of @samp{drawMap} is the drawing of repeating patterns.
-
 @table @asis
 @item @b{Syntax:}
+tile = @b{myresolver}(@i{key}, @i{x}, @i{y})
 
- at b{wo:drawMap}(@i{resolver}, @i{anchor}, @i{ignore}, @i{map}, [@i{readdir}])
-
- at b{wo:drawMap}(@i{resolver}, @i{anchor}, @i{libmap-map}, [@i{readdir}])
-
 @table @asis
- at item @i{subresolver}
-Resolver to which unresolved requests should be forwarded. May be @samp{ti}
-as the final resolver of the resolver chain.
- at item @i{anchor}
-The anchor position where the upper left tile of the map should be drawn.
- at item @i{ignore}
-A tile key string that should be ignored. This key string is mandatory, even
-if it not used within the map.
- at item @i{map}
-A table of strings. Each string describes a row of tiles by its tile keys.
- at item @i{libmap-map}
-If the map used is created via @ref{libmap}, the @samp{ignore}-string can
-be omitted. The map's default key will then be ignored instead.
- at item @i{readdir}
-An optional argument to modify the direction of the map relative to the world.
-This argument can be any of the constants described in @ref{Rotating and
-Mirroring Maps}.
+ at item @i{key}
+String that contains the tile key to be resolved.
+ at item @i{x}
+The world x coordinate of the tile.
+ at item @i{y}
+The world y coordinate of the tile.
 @end table
 
- at item @b{Syntax Samples:}
- at example
-wo:drawMap(ti, po(5, 7), "-", @{"abcabc"@})
-wo:drawMap(ti, anchor_object, "--", @{"--##--##","##--##"@})
-wo:drawMap(ti, @{12, 5@}, " ", @{"122  221"@}, MAP_ROT_CW)
- at end example
-
 @item @b{Details:}
-The syntax is similar to the world creation call. But there are two essential
-differences you need to be aware of. First the map is drawn in the already
-existing world. Thus we need to define the position. This is done via the
-anchor position, which can be an already existing object, too.
+A custom resolver function is the last resolver that is called in the chain.
+It has to return the final tile that should be drawn at the given position.
+This can be done by statement @samp{return ti["k"]}, which references the tile
+already declared in the tiles map.
 
-The second difference is in the definition of a tile key string for tiles in
-the map that should be ignored. Remember that the world initialization requested
-a default tile key string. This default is still valid. But with the given
-ignore key string we can draw arbitrary shaped patterns by filling unused
-grids in the map with this key.
+If no suited tile is already declared you can alternatively return a new tile
+like @samp{return ti(@{"st_switch", state=ON@})}.
 
-The length of the ignore key defines the map key length. It is strongly
-recommended to use the same key length as in the world map.
+If you decide not to draw any tile at all, you must return an empty tile
+declaration: @samp{return ti(@{@})}.
 
-The rows of the supplied map are drawn from the anchor position. The rows may
-be of different length and may start with ignore tile keys. The anchor must be
-the position composed of the smallest x and smallest y coordinate within the
-pattern.
+ at samp{return nil} indicates an error of usage of an unknown tile key.
 
-You can use drawMap anywhere after the world creation. You are even allowed to
-use it within the world creation in a resolver.
-
- at item @b{Full Example:}
+ at item @b{Example:}
 @example
-ti[" "] = @{"fl_plank"@}
-ti["X"] = @{"st_oxyd"@}
-ti["B"] = @{"st_passage_black", flavor="frame"@}
-ti["W"] = @{"st_passage_white", flavor="frame"@}
-ti["y"] = @{"it_yinyang"@}
-ti["1"] = ti["y"] .. @{"#ac_marble_black"@}
-ti["2"] = ti["y"] .. @{"#ac_marble_white"@}
+ti["r"] = @{"fl_rough_red"@}
+ti["b"] = @{"fl_rough_blue"@}
+ti["1"] = @{"#ac-blackball"@}
 
+ti["x"] = @{"it_cross"@}
+
 function myresolver(key, x, y)
-    if key == "w" then
-        wo:drawMap(ti, po(x-1, y-1), "-", @{"-W-",
-                                           "WXW",
-                                           "-W-"@})
-        return ti(@{@})
-    elseif key == "b" then
-        wo:drawMap(ti, po(x-1, y-1), "-", @{"-B",
-                                           "BXB",
-                                           "-B"@})
-        return ti(@{@})
+    if key == " " then
+        local center = ((x%3) * (y%3))%2
+        local checker = ((math.modf(x/3) %2) + (math.modf(y/3) %2))%2
+        if center + checker == 1 then
+            return ti["r"]
+        else
+            return ti["b"]
+        end
     else
         return ti[key]
     end
@@ -19370,241 +20105,22 @@
 
 w, h = wo(myresolver, " ", @{
 "                    ",
-"  b         b       ",
-"       w       w    ",
 "                    ",
 "                    ",
-"   w                ",
-"         12      b  ",
-"              w     ",
-"         w          ",
-"      b             ",
-"   w           b    ",
-"         b          ",
+"      x x           ",
+"       x            ",
+"      x x           ",
+"                    ",
+"          1         ",
+"                    ",
+"                    ",
+"                    ",
+"                    ",
 "                    "
 @})
-wo:shuffleOxyd()
 @end example
 @end table
 
- at c ----------------- drawRect --------------------
- at node drawRect
- at subsection drawRect
-
- at table @asis
- at item @b{Syntax:}
- at b{wo:drawRect}(@i{upperleft_edge}, @i{lowerright_edge}, @i{tile})
-
- at b{wo:drawRect}(@i{upperleft_edge}, @i{width}, @i{height}, @i{tile})
-
- at table @asis
- at item @i{upperleft_edge}
-Upper left anchor position of the rectangle.
- at item @i{lowerright_edge}
-Lower right end position of the rectangle.
- at item @i{width}
-Width of the rectangle.
- at item @i{height}
-Height of the rectangle.
- at end table
-
- at item @b{Syntax Samples:}
- at example
-wo:drawRect(po(0, 0), wo["Width"], wo["Height"], ti[" "])
-wo:drawRect(no["myRectUL"], no["myRectLR"], @{"fl_water"@})
- at end example
-
- at item @b{Details:}
- at item @b{Full Example:}
- at example
- at end example
- at end table
-
-
- at c ----------------- shuffleOxyd --------------------
- at node shuffleOxyd
- at subsection shuffleOxyd
-
-Shuffling the color distribution of the @ref{st_oxyd} makes every level, that
-is no meditation, a bit generic. On every level start the level looks a little
-bit different and the user has to solve a modified level. This provides long
-term amusement. Thus the call of this method is part of most levels.
-
-Many levels just call this method without any arguments. This results in a
-shuffling of all @ref{st_oxyd} that are not excluded by a @samp{noshuffle}
-attribute.
-
-But sometimes levels need to influence the shuffling, either for ensuring that
-the level remains solvable, or simply to ensure fairness. Imagine a level that
-has two @ref{st_oxyd}s in every corner. If by chance a user gets a distribution
-where he has in each corner a pair of same colored oxyds, the level might be
-trivial. Another level may have a passage that the marble can pass just a few
-times. With 5 or more oxyds on each side of the passage you need to ensure that
-the marble never needs to pass the passage more often than possible. Both
-situations can be handled by providing proper rules as arguments to this method.
-
- at table @asis
- at item @b{Syntax:}
-
- at b{wo:shuffleOxyd}(@i{rules})
-
- at table @asis
- at item @i{rules} = @i{rule}, @i{rule},...
-No rule or as many as you like, all separated by a comma.
- at item @i{rule} = @{@i{group1}, @i{group2}, @i{maxrule}, @i{minrule}, @i{circularrule}, @i{linearrule}, @i{log}@}
-Each rule is a table with a subset of the listed entries. The @i{group1} entry
-is mandatory. All other entries are optional and can be added in any combination.
- at item @i{group1} = @i{group} | @i{objectreference} | @i{objectspecifier}
-A description of oxyd objects that are part of the first rule group. Either
-a group or a single object reference or a string specifier that resolves to a
-single or via wildcard to several oxyd objects are legal descriptors.
- at item @i{group2} = @i{group} | @i{objectreference} | @i{objectspecifier}
-A description of oxyd objects that are part of the second rule group. Either
-a group or a single object reference or a string specifier that resolves to a
-single or via wildcard to several oxyd objects are legal descriptors.
- at item @i{maxrule} = @code{max = }@i{number}
-The maximum number of oxyd pairs.
- at item @i{minrule} = @code{min = }@i{number}
-The minimum number of oxyd pairs.
- at item @i{circularrule} = @code{circular = true}
-Avoid any pair of neighboring oxyds in group1. Avoid an oxyd pair of first and
-last oxyd in group1, too.
- at item @i{linearrule} = @code{linear = true}
-Avoid any pair of neighboring oxyds in group1.
- at item @i{log} = @code{log = } @ @  @code{"solution"} |@code{"count"} |@code{"all"}
-Log additional information to the log stream for debugging purposes and
-security checks by the level author.
- at end table
-
- at item @b{Syntax Samples:}
- at example
-wo:shuffleOxyd()
-wo:shuffleOxyd(@{no["borderoxyds#*"]:sort("circular"), circular=true@})
-wo:shuffleOxyd(@{"leftoxyds#*","rightoxyds#*", min=3@}, @{"islandoxyds#*", max=0@})
- at end example
-
- at item @b{Details:}
-
-Any call of @samp{wo:shuffleOxyd()} must occur after all @ref{st_oxyd} have been
-set. That means that it must follow the standard world initialization
-(@pxref{World Creation and Resolver Chaining}). As a side effect shuffleOxyd
-will assign colors to all @samp{OXYD_AUTO} colored @ref{st_oxyd}.
-
-Once called the given shuffling rules remain valid. Any further reshuffling
-must be done by messages @samp{closeall} and @samp{shuffle} to one arbitrary
- at ref{st_oxyd} instance. No addition of an @ref{st_oxyd} or subsequent
- at samp{wo:shuffleOxyd()} calls are possible without disturbing and deleting the
-given rules.
-
-Rule based shuffling is limited to a maximum of one pair of each standard oxyd
-color plus any combination of additional special fake, quake or bold oxyds
-summing up to a maximum of 32 oxyds. If more than 32 oxyds or 2 or more pairs
-of a single standard color are set, all oxyds will be shuffled by random
-ignoring any provided rules.
-
-There are basically two different types of rules. Those with one group and those
-with two groups of oxyds (Note that group is the general API expression for
-a set of oxyds and not a mathematical group). For a single group the rules apply
-to the oxyd instances within this group. For two groups the rules apply to oxyd
-pairs with one oxyd in the first group and the other in the second group.
-
-E.g. @samp{@{"islandoxyds#*", max=0@}} requests that there is no pair within
-this group of oxyds. Whereas @samp{@{"leftoxyds#*","rightoxyds#*", min=3@}}
-requests that there are 3 different oxyd pairs, each with one oxyd out of the
-leftoxyd group and the second out of the rightoxyd group.
-
-Linear and circular rules can only be applied to a single group. They are
-shortcuts for the most common rules that are applied to oxyds arranged on a
-line or a circle. In both cases they avoid pairs of neighboring oxyds. They
-are equivalent to @samp{n-1} res. @samp{n} rules with all possible neighboring
-oxyd pairs as two groups and a rule of @samp{max=0}.
-
-Note that you can apply several rules at once to given groups. E.g. you can
-apply a minrule and a maxrule within one rule!
-
-The shuffling process consists always of two stages. The most important first
-stage generates a valid oxyd pair distribution. That means that we settle which
-pairs will have the same color. But the color itself is assigned in an
-independent second stage. As for the examination of given rules just the pair
-distribution is relevant, we do just count and log these different distributions
-ignoring the colors.
-
-With 16 oxyds of 8 different colors and no restricting rules you have 2027025
-(15 * 13 * 11 * 9 * 7 * 5 * 3) different valid distributions. Keep in mind
-that useful rules should always keep hundreds or thousands of different valid
-distributions for a level.
-
-For debugging purposes you can add a log parameter to one of the rules (it does
-not matter to which one). If you request the log of @samp{solution} the
-pair distribution will be printed to the log stream.
-
-In case of @samp{count} the number of different oxyd distributions will be
-counted and logged. It is recommended to check the count on complex rules to
-ensure that enough distributions remain for a varying game. But be careful
-applying count on trivial rules. With 16 oxyds there may be as many as
-2027025 distributions and it may take a standard PC up to 30 seconds to count
-them - add a factor of 17*19 for 20 oxyds!
-
-Be very, very cautious in usage of logging @samp{all}. This call tries to print
-all solutions. It takes ages if there are too many solutions. First check the
-count before trying to log the solutions.
-
- at item @b{Full Example:}
- at example
-wo["ConserveLevel"] = false
-
-ti["~"] = @{"fl_water"@}
-ti[" "] = @{"fl_plank"@}
-ti["c"] = @{"it_crack_l", brittleness=0@}
-ti["^"] = @{"st_oneway_n"@}
-ti["1"] = @{"ac_marble_black", 0, 0.5@}
-
-ti["x"] = @{"st_oxyd", "island#"@}
-ti["y"] = @{"st_oxyd", "left#"@}
-ti["z"] = @{"st_oxyd", "right#"@}
-
-w, h = wo(ti, " ", @{
-"~~x  x  x  x  x  x~~",
-"~~                ~~",
-"~~~~^~~~~~~~~~~^~~~~",
-"y       ~~~~       z",
-"~       cccc       ~",
-"y       ~~~~       z",
-"~       cccc       ~",
-"y       ~~~~       z",
-"~       cccc       ~",
-"y       ~~~~       z",
-"~~~~c~~~~~~~~~~c~~~~",
-"~~                ~~",
-"~~        1       ~~"
-@})
-
-wo:shuffleOxyd(@{"island#*", min=3, linear=true@}, @{"left#*","right#*", max=2, min=2@})
- at end example
-
-This level uses 14 oxyds. The 6 oxyds in the upper row are on an island that
-can not be left once the marble entered it through one of the oneways. Thus
-we need 3 pairs of oxyds on this island, which are enforced by the min rule.
-To avoid trivial neighboring pairs on the island, we do add a linear rule, too.
-The marble can pass just three times between the left and right islands. This
-allows a first look on the color oxyds with one pass and opening one pair on
-each of the two following passes. Thus we limit the number of pairs by a max
-rule to 2. To avoid trivial oxyd pair distributions, like two pairs on the left
-and two pairs on the right side, we do add a min rule that enforces that two
-shared pairs of oxyds do exist.
- at end table
-
- at node Resolvers
- at section Resolvers
-
- at menu
-* res.autotile::  Generate tiles from given template declarations
-* res.composer::  Compose tiles from given base tiles
-* res.maze::      Generate arbitrarily shaped mazes
-* res.puzzle::    Generate puzzle tiles and shuffle resulting puzzle clusters
-* res.random::    Choosing random tiles in a given distribution
- at end menu
-
 @c ----------------- Autotile Resolver --------------------
 
 @node res.autotile
@@ -20684,6 +21200,47 @@
 The finalizer does neither call its subresolver nor does it return a value.
 @end table
 
+ at c ==================  Guidelines and Hints  =======================
+
+ at node Guidelines and Hints
+ at chapter Guidelines and Hints
+
+Up to now we described all features in their full extend. Of course you are
+free to use them all without any restrictions for your private levels. We are
+committed to maintain all features in future versions of Enigma.
+
+But for inclusion of your levels into the Enigma project we would like to
+recommend conformance to some common standards. These few points gurantee that
+your levels can easily be processed by our administration tools, the players
+can talk about your level and your level remains editable by the project
+maintainers in case of urgent need.
+
+Additionally we like to give you some hints how to write good levels by means
+of proper strategy.
+
+ at menu
+* Filename Recommendation::
+* Title Recommendation::
+* Tile Key Recommendation::
+* Easy Mode Hints::
+ at end menu
+
+ at node Filename Recommendation
+ at section Filename Recommendation
+No space for spaces
+
+ at node Title Recommendation
+ at section Title Recommendation
+English - no translation - use subtitle, too
+
+ at node Tile Key Recommendation
+ at section Tile Key Recommendation
+space for default
+
+ at node Easy Mode Hints
+ at section Easy Mode Hints
+write easy first, floor friction,...
+
 @c ===================  Old API - Objects  =======================
 
 @node Old API - Objects



From ral at mail.berlios.de  Mon May 18 00:45:04 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Mon, 18 May 2009 00:45:04 +0200
Subject: [Enigma-game-svn] r1675 - trunk/doc/reference
Message-ID: <200905172245.n4HMj423018201@sheep.berlios.de>

Author: ral
Date: 2009-05-18 00:44:53 +0200 (Mon, 18 May 2009)
New Revision: 1675

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
- Section 5.5 position: formatting update
- Section 5.9 positionlist: sample fixes
- Section 13.1.1 resolver chaining: updates
- Section 13.1.5 maze: introduction and main syntax

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-05-13 21:45:16 UTC (rev 1674)
+++ trunk/doc/reference/enigma-ref.texi	2009-05-17 22:44:53 UTC (rev 1675)
@@ -4114,7 +4114,7 @@
 @table @asis
 @item @b{position:}@ @ @xref{Position}
 A position within the world that can be described by an x and y coordinate.
- at item @b{positions:} @i{preset variable:} @code{@b{po}}; @ @ @xref{Positions}
+ at item @b{positions:} @i{preset variable:} @code{@b{po}}; @ @ @xref{Positions Repository}
 The singleton type of the repository of all named positions.
 @item @b{object:}@ @ @xref{Object}
 An Enigma object like a stone, item, floor, other. Any object is a position, too.
@@ -4125,10 +4125,10 @@
 @item @b{default:} @i{preset variable:} @code{@b{DEFAULT}}; @ @ @xref{Object Attributes}
 The singleton type of default values that can be used instead of Lua's @samp{nil}
 in anonymous table tile definitions.
- at item @b{tile:}@ @ @xref{Tile}
+ at item @b{tile:}@ @ @xref{Tile and Object Declaration	}
 A description of one or several objects for a common grid position (floor, item,
 stone, actor)
- at item @b{tiles:} @i{preset variable:} @code{@b{ti}}; @ @ @xref{Tiles}
+ at item @b{tiles:} @i{preset variable:} @code{@b{ti}}; @ @ @xref{Tiles Repository}
 The singleton type of the repository of all tile instances.
 @item @b{world:} @i{preset variable:} @code{@b{wo}}; @ @ @xref{World}
 The singleton type of the world that contains all objects.
@@ -5095,7 +5095,7 @@
 64              @b{anchor2} = @var{woods}[@var{wire_p}[@var{j}%@var{3} + @var{1}]]@})
 @end example
 Finally we need to add the @ref{ot_wire} between our movable stones. This can
-not be done within the map. We need to use the @ref{World Advanced Methods}
+not be done within the map. We need to use the @ref{World} method 
 @samp{wo:add()}, which takes the two connected stones as two anchor attributes.
 We select the first 3 stones of our wood group as stones to be connected with
 3 other stones of the indices 4 to 12. Thus we take in every loop as the first
@@ -5271,9 +5271,24 @@
 
 Let us look at the supported operators:
 
+ at menu
+* Position Addition and Subtraction::     Operators @samp{+} and @samp{-} 
+* Position Multiplication and Division::  Operators @samp{*} and @samp{/}
+* Position Sign::                         Unary Operator @samp{-}
+* Position Center::                       Operator @samp{#}
+* Position Comparison::                   Equality @samp{==} and Inequality @samp{~=}
+* Position Concatenation::                Operator @samp{..}
+* Position Coordinate Access::            Index Operators
+* Position Grid Rounding::                Method @samp{grid()}
+* Position Existence::                    Method @samp{exists()}
+ at end menu
+
+ at c ----------------- Position Addition and Subtraction --------------------
+
+ at node Position Addition and Subtraction
+ at subsection Position Addition and Subtraction
+
 @table @asis
- at item @b{Addition/Subtraction:}
- at table @asis
 @item @b{Syntax:}
 result = @i{pos} <@b{+}|@b{-}> <@i{pos} | @i{obj} | @i{cpos} | @i{polist}>
 
@@ -5297,7 +5312,11 @@
 @end example
 @end table
 
- at item @b{Multiplication/Division:}
+ at c ----------------- Position Multiplication and Division --------------------
+
+ at node Position Multiplication and Division
+ at subsection Position Multiplication and Division
+
 @table @asis
 @item @b{Syntax:}
 result = @i{pos} <@b{*}|@b{/}> @i{number}
@@ -5316,7 +5335,11 @@
 @end example
 @end table
 
- at item @b{Sign:}
+ at c ----------------- Position Sign --------------------
+
+ at node Position Sign
+ at subsection Position Sign
+
 @table @asis
 @item @b{Syntax:}
 result = - at i{pos}
@@ -5331,7 +5354,11 @@
 @end example
 @end table
 
- at item @b{Center:}
+ at c ----------------- Position Center --------------------
+
+ at node Position Center
+ at subsection Position Center
+
 @table @asis
 @item @b{Syntax:}
 result = #@i{pos}
@@ -5346,7 +5373,13 @@
 @end example
 @end table
 
- at item @b{Equality/Inequality:}
+ at c ----------------- Position Comparison --------------------
+
+ at node Position Comparison
+ at subsection Position Comparison
+
+Equality and Inequality.
+
 @table @asis
 @item @b{Syntax:}
 result = @i{pos1} <==|~=> @i{pos2}
@@ -5366,7 +5399,11 @@
 @end example
 @end table
 
- at item @b{Concatenation:}
+ at c ----------------- Position Concatenation --------------------
+
+ at node Position Concatenation
+ at subsection Position Concatenation
+
 @table @asis
 @item @b{Syntax:}
 result = @i{pos1} .. <@i{pos2} | @i{polist}> 
@@ -5385,7 +5422,11 @@
 @end example
 @end table
 
- at item @b{Coordinate Access:}
+ at c ----------------- Position Coordinate Access --------------------
+
+ at node Position Coordinate Access
+ at subsection Position Coordinate Access
+
 @table @asis
 @item @b{Syntax:}
 result = @i{pos}["x"]
@@ -5411,7 +5452,11 @@
 @end example
 @end table
 
- at item @b{Grid Rounding:}
+ at c ----------------- Position Grid Rounding --------------------
+
+ at node Position Grid Rounding
+ at subsection Position Grid Rounding
+
 @table @asis
 @item @b{Syntax:}
 result = @i{pos}:grid()
@@ -5427,7 +5472,11 @@
 @end example
 @end table
 
- at item @b{Existence:}
+ at c ----------------- Position Existence --------------------
+
+ at node Position Existence
+ at subsection Position Existence
+
 @table @asis
 @item @b{Syntax:}
 result = @i{pos}:exists()
@@ -5448,7 +5497,6 @@
 @var{boolean} = @i{po}(@var{3.2}, @var{4.7}):@b{exists}()
 @end example
 @end table
- at end table
 
 
 @c ----------------- Object --------------------
@@ -5490,7 +5538,7 @@
 containing grid. This feature is legacy. As Lua code is anyway unapropriate to
 handle actor movements we maintained this rounding feature.
 
-Objects support standard set operators of @ref{Groups}, too, as long as one
+Objects support standard set operators of @ref{Group}s, too, as long as one
 operand is a group and the other an object.
 
 For task driven samples @pxref{Object Tasks} and @ref{Attribute Tasks}.
@@ -6206,7 +6254,7 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{number} = #@var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7})) -- = 2
+ at var{number} = #(@i{po}(@var{2}, at var{3}) .. @i{po}(@var{5}, at var{7})) -- = 2
 for @var{i} = @var{1}, #@var{polist} do @var{pos} = @var{polist}[@var{i}] ... end
 @end example
 @end table
@@ -6225,9 +6273,9 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{pos} = @var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7}))[2]     -- = po(5,7)
- at var{pos} = @var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7}))[-1]    -- = po(5,7)
- at var{pos} = @var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7}))[0]     -- = nil
+ at var{pos} = (@i{po}(@var{2}, at var{3}) .. @i{po}(@var{5}, at var{7}))[2]     -- = po(5,7)
+ at var{pos} = (@i{po}(@var{2}, at var{3}) .. @i{po}(@var{5}, at var{7}))[-1]    -- = po(5,7)
+ at var{pos} = (@i{po}(@var{2}, at var{3}) .. @i{po}(@var{5}, at var{7}))[0]     -- = nil
 for @var{i} = @var{1}, #@var{polist} do @var{pos} = @var{polist}[@var{i}] ... end
 @end example
 @end table
@@ -6247,7 +6295,7 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{newpolist} = @var{polist}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7})) .. @i{po}(@var{4}, @var{4}) -- = (2,3),(5,7),(4,4)
+ at var{newpolist} = @i{po}(@i{po}(@var{2}, at var{3}), @i{po}(@var{5}, at var{7})) .. @i{po}(@var{4}, @var{4}) -- = (2,3),(5,7),(4,4)
 @end example
 @end table
 
@@ -6286,7 +6334,7 @@
 @item @b{Syntax Samples:}
 @example
 @var{newpolist} = @var{2} * @var{NEIGHBORS_4}       -- = po(9, 12)
- at var{newpolist} = @var{polist}(@i{po}(@var{2}, at var{4}), @i{po}(@var{6}, at var{7})) * @var{1/2}   -- = (1, 2), (3, 3.5)
+ at var{newpolist} = (@i{po}(@var{2}, at var{4}) .. @i{po}(@var{6}, at var{7})) * @var{1/2}   -- = (1, 2), (3, 3.5)
 @end example
 @end table
 
@@ -6559,7 +6607,7 @@
 result = ti(@i{odecl})
 
 @item @b{Details:}
-Converts an table based object declaration to a new tile value.
+Converts a table based object declaration to a new tile value.
 
 @item @b{Syntax Samples:}
 @example
@@ -8168,7 +8216,7 @@
 @node oxyd colors
 @subsection oxyd colors
 
-Number constants for @ref{st_oxyd} attribute @ref{oxydcolor}. Please choose the 
+Number constants for @ref{st_oxyd} attribute @samp{oxydcolor}. Please choose the 
 constant that is appropriate for an object and do avoid using numbers. 
 
 @itemize @bullet
@@ -8194,7 +8242,7 @@
 @node orientations
 @subsection orientations
 
-Number constants for actor attributes @ref{orientation} or @ref{slope}. Please
+Number constants for attributes @samp{orientation} or @samp{slope}. Please
 choose the constant that is appropriate for an object and do avoid using numbers.
 
 @itemize @bullet
@@ -19952,12 +20000,21 @@
 * Tips and Tricks::         Simple patterns that are valuable like a feature
 @end menu
 
+ at c ----------------- Resolvers --------------------
 @node Resolvers
 @section Resolvers
 
+Every tile in the world is defined by a key that needs to be resolved to its 
+declaration. This can be done either by the @ref{Tiles Repository} @samp{ti} 
+alone, or by additionally chained resolvers. In the chapter @ref{Lua API} we
+learned how to set up a @ref{World} by static @ref{Tile and Object Declaration}s.
+Now it is time to explore the capabilities of resolvers. In the 
+ at ref{World Creation} you had to supply a top resolver as an argument. Let us
+look which types of resolvers are available and how you can chain these resolvers. 
+
 @menu
-* Resolver Chaining::  
-* Custom Resolver::    
+* Resolver Chaining::  Linking resolvers and the tiles repository
+* Custom Resolver::    Writing simplified own resolvers
 * res.autotile::       Generate tiles from given template declarations
 * res.composer::       Compose tiles from given base tiles
 * res.maze::           Generate arbitrarily shaped mazes
@@ -19970,43 +20027,42 @@
 @node Resolver Chaining
 @subsection Resolver Chaining
 
-Once all parameters have been set and all tiles have been declared it is time
-to create the level world with all its objects. This is done by the following
-constructor that appears in two variations.
+There exist several useful resolvers that may simplify the task of level writing
+or provide dynamic features like randomness, mazes, etc. Each of them handles
+just some keys out of your world map. For the other keys the resolver has no
+idea how to resolve them to object declarations. Thus each resolver has to be
+linked to a so called @samp{subresolver}. The resolver just forwards all key
+request that it can not handle itself to its subresolver. Indeed it will in
+most cases even forward modified key requests to its subresolver that are 
+required by the process of handling its own keys.
 
- at ref{World Creation}
+The last resolver in the chain will either use the @ref{Tiles Repository} 
+ at samp{ti} as its subresolver or a @ref{Custom Resolver} function, which will be
+ at samp{ti} based, too
+.
+A typical resolver chain will look like:
 
- at table @asis
- at item @b{Syntax:}
-width, height = @b{wo}(@i{topresolver}, ...)
 
-
 @table @asis
- at item @i{topresolver} = @code{ti} | @i{resolver} | @i{localresolver}
-Every tile in the world is given by a key that needs to be resolved to its
-declaration. This can be done either by the @ref{Tiles Repository} @samp{ti}, or
-by given library @ref{Resolvers} or by local @ref{Custom Resolver} function.
-This argument takes the top resolver that is requested first.
- at end table
+ at item @b{Syntax Sample:}
+ at example
+ at var{subresolver} = @i{res}. at i{random}(@i{ti}, ...)
+ at var{topresolver} = @i{res}. at i{composer}(@var{subresolver})
+width, height = @i{wo}(@var{topresolver}, ...)
+ at end example
 
 @item @b{Details:}
-Every key is resolved to its tile declaration via the given resolver chain.
-The top resolver is given to this call as a parameter. If it is @samp{ti} the
-chain consists just of one element and the tile declaration stored in the tiles
-repository at the given key is taken. Otherwise the resolvers will be evaluated
-as explained in @ref{Resolver Chaining}.
+The call of every resolver returns a context reference handle, that must be
+supplied to the upward resolver in the chain. Thus you need to start with the
+lowest resolver in your level code. The @ref{World Creation} takes the top most
+resolver context handle.
 
-But there exist several useful
- at ref{Resolvers} that may simplify the task of level writing or provide dynamic
-features like randomness, mazes, etc. If you like to use one or several of them
-you provide the instance of the resolver to be requested first in this
-constructor. The instance that should be requested next is set in the top
-resolver as first argument, and so on. The last library resolver takes usually
- at samp{ti} as its subresolver. For even more flexibility you can provide an
-own @ref{Custom Resolver} function within the level to take influence on the key
-interpretation. This function has to be the last resolver in the chain.
+There is no limit to the number of chained resolvers. But the order of resolvers
+may sometimes be critical. Please read carefully the resolver notes for usage,
+restrictions and caveats.
 
- at item @b{Example:}
+ at item @b{Full Example:}
+The level "Demo Resolver Chain" of levelpack "Demolevels":
 @example
 ti["~"] = @{"fl_water"@}
 ti["s"] = @{"fl_sahara"@}
@@ -20082,6 +20138,7 @@
 @samp{return nil} indicates an error of usage of an unknown tile key.
 
 @item @b{Example:}
+The level "Demo User Resolver" of levelpack "Demolevels":
 @example
 ti["r"] = @{"fl_rough_red"@}
 ti["b"] = @{"fl_rough_blue"@}
@@ -20397,10 +20454,161 @@
 @end table
 
 
+ at c ----------------- Maze Resolver --------------------
 @node res.maze
 @subsection res.maze
 
+The maze resolver supports you in the creation of quite arbitrary mazes. The
+shape is no longer limited to boring rectangular areas of one grid thick walls
+leaving the player just a one grid path uniquely connecting all parts of the maze.
 
+This second generation maze generator lets you fill mazes in arbitrarily shaped
+areas, mazes with thick walls or chasms, or thin walls of just a sheet of window
+glass, mazes with cells of single grid, cells that are whole islands or mazes
+based on @ref{it_strip} that have cells of no extent and consist of connections
+only. The maze cells may be aligned strictly rectangular or shifted in one
+direction, they may be just connected to its 4 neighbors or to 6 neighbors in
+hexagonal mazes or three dimensional mazes. You can write and plug in your own
+maze generation and rendering algorithms. And finally you can analyse,
+postprocess and even modify your maze even after the inital creation.
+
+From the mathematical point of view we provide the basic structures for
+generation of quite arbitrary directed graphs. Our maze consists of cells, the
+vertices of a graph. Every cell can be connected to a given number of neighbor
+cells.  But these connections, that are the passages from one cell to another,
+can even be direction dependent. This allows you to use window panes on either
+side of a connection or to use oneways for your connections, too. These passages
+from one cell to another are the edges of our graph and as they may be directed
+we have a directed graph. But for most mazed the support of directions is 
+irrelevant and transparent, and you do not really need to know anything about
+graphs at all. Thus we called the resolver just a maze resolver.
+
+Of course such a versatile resolver needs some configuration. As the parameters
+exceed the number of arguments, that you can reasonably supply to a function
+just by enlisting them, we decided to group the parameters for specific 
+tasks and to use a table with named attributes for the configuration. This 
+sounds more complex than it is. But watch out carefully for the table curly
+braces as they are necessary and can not be omitted.
+
+In a big level you may want to generate two or even more completely independent
+mazes. You can do this by using multiple instances of this resolver. The 
+resolver handle returned on the configuration is a unique reference pointer for
+the maze for subsequent requests. Store it and link all the maze resolvers as
+explained in @ref{Resolver Chaining}.
+
+ at table @asis
+ at item @b{Location:}
+This resolver is part of the library @samp{libmaze} as of release 2. You can
+use it by adding the following dependency to your level @ref{<compatibility>}
+declaration:
+ at example
+  <@i{el}:@b{dependency} @i{el}:@b{path}="@var{lib/libmaze}" @i{el}:@b{id}="@var{lib/libmaze}" @i{el}:@b{release}="@var{2}" @i{el}:@b{preload}="@var{true}"/>
+ at end example
+
+The library @ref{libmap} is automatically preloaded by this resolver.
+
+ at item @b{Syntax:}
+
+ at i{themaze} = @b{res.maze}(@i{subresolver}, @i{attributes})
+
+ at table @asis
+ at item @i{subresolver}
+Resolver to which unresolved requests should be forwarded. May be @samp{ti}
+as the final resolver of the resolver chain.
+ at item @i{attributes} = @{@i{keyvalue}, @i{keyvalue},...@}
+An anonymous table with one or many attributes given as key value pairs, 
+separated by a comma.
+ at item @i{keyvalue} = <area=@i{area_value} | render = @i{render_value} | kernel = @i{kernel_value} | spacing = @i{spacing_value} | persistent=@i{persistence}>
+Values for given keys that may occur in any sequence in the anonymous table.
+ at item @i{area_value} = @{<@i{rectangular_area} | @i{marked_area}>@}
+The maze area specification, that is either defined as an rectangluar area
+or an area marked in the the world's map.
+ at item @i{rectangular_area} = @i{anchor}, @i{width}, @i{height}
+An rectangular area that is given by an anchor position within the world and
+two numbers for the width and height measured in maze cells.
+ at item @i{anchor}
+Anything that is convertable to a @ref{Position} that denotes the upper left
+edge of the rectangular maze area. Besides a position value, an object reference
+or a name string of an object or position are supported value types.
+ at item @i{marked_area}
+One or multiple strings separated by a comma as simple entries in the anonymous
+table. Every string does either specify a key match, a key prefix or an object
+name. All these strings can be used at the same time for marking an area. The
+strings can occur in any sequence and multiplicity.
+ at item @i{kernel_value} = @{kernel_width, kernel_height@}
+The size of the kernel of a cell given by width and height in number of grids.
+ at item @i{spacing_value} = @{spacing_x, spacing_y@}
+The distance of the kernel of one cell to its neighbor in x and y direction
+measured in number of grids.
+ at item @i{render_value} = @{<@i{std_renderer_args} | @i{other_renderer}>@}
+The specification for drawing the maze. In case of a missing specification
+no drawing will be done at all. If the default standard renderer should be used
+its parameters can be directly supplied, other renderers need a type 
+specification plus the necesssary configuration information.
+ at item @i{std_renderer_args} = @i{passage_keys} [, <@i{wall_key} [, @i{kernel_key}] | @i{cell_map}>]]
+The standard renderer takes info about tile keys to be used for the passages,
+and either a cell map, or additional tile keys for the wall and optionally the
+kernel of a cell.
+ at item @i{passage_keys} = <@i{passage_key} | @{@i{passage_open}, @i{passage_closed}@}>
+Usually you just give a tile key for open maze passages. Closed passages appear
+like walls and use the same tile key. But in case you want to use special tile
+keys for open and for closed passages you can supply two strings in an 
+anonymous table. If you give no wall key you may need to include an 
+ at samp{st_nil} in your open passage tile declaration to kill a wall stone drawn
+by your world map.
+ at item @i{wall_key}
+The tile key to be used for drawing walls. If it is omitted no wall is drawn
+and the resolver relies on all possible wall tiles to be drawn by the world
+map itself.
+ at item @i{kernel_key}
+In most cases the cell kernel will be drawn by the world map. But if not you
+can supply a tile key that will be drawn on every cell kernel grid.
+ at item @i{cell_map}
+Instead of kernel and wall tile keys you can supply a @ref{libmap} map of a
+complete cell. The map can provide arbitrary tiles for cell kernels larger than
+a single grid. The walls can differ on the south and east side, too.
+ at item @i{other_renderer} = @i{renderer}  [, @i{other_renderer_args}]
+Enlisting of a a renderer function followed by its specific arguments.
+ at item @i{renderer}
+The function that does the rendering. By default it is 
+ at samp{lib.maze.renderer_standard} with the above given arguments. Other supplied
+renederers are @samp{lib.maze.renderer_window} and 
+ at samp{lib.maze.renderer_strip}
+
+ at item @i{persistence}
+A boolean flag that default to @samp{false}. You nees to set it to @samp{true}
+if you want to access the maze or any of its cells after the level 
+initialization. Otherwise the maze reference handle with all its data may get
+invalid due to memory garbage collection. This is no problem for most mazes,
+that will be directly rendered and have no need of further evaluation or changes
+during runtime.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+maze1 = res.maze(ti, @{area =@{"anchor1", 4, 5@}, render = @{" ", "-", " "@}@})
+maze2 = res.maze(ti, @{area =@{"."@}, kernel=@{1,1@}, render = @{"!", "~", "-"@}@})
+maze3 = res.maze(ti, @{area =@{"amaze#*"@}, render = @{@{".","+"@}, "~", "-"@}@})
+maze4 = res.maze(ti, @{area =@{po(2, 12), 5, 5@}, kernel=@{3,2@}, 
+                   render = @{".", wo:newMap(" ", @{"!!!~","--!~","~~~~"@})@}@})
+ at end example
+
+ at item @b{Details:}
+
+
+
+ at item @b{Full Example:}
+ at example
+ti[" "] = @{"fl_sahara"@}
+
+w, h = wo(resolver, " ", @{
+"                                        ",
+"                                        ",
+"                                        "
+@})
+ at end example
+ at end table
+
 @c ----------------- Puzzle Resolver --------------------
 
 @node res.puzzle



From raoul at mail.berlios.de  Mon May 18 19:06:40 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Mon, 18 May 2009 19:06:40 +0200
Subject: [Enigma-game-svn] r1676 - in trunk: . data/levels
	data/levels/enigma_cross data/levels/enigma_experimental
	data/levels/enigma_i data/levels/enigma_ii
	data/levels/enigma_iii data/levels/enigma_oxyd
	data/levels/enigma_pentomino data/levels/enigma_v
	data/levels/enigma_vi data/levels/enigma_vii data/levels/enigma_viii
Message-ID: <200905181706.n4IH6eec030910@sheep.berlios.de>

Author: raoul
Date: 2009-05-18 19:06:37 +0200 (Mon, 18 May 2009)
New Revision: 1676

Added:
   trunk/data/levels/enigma_ii/nat27_2.xml
   trunk/data/levels/enigma_iii/nat36_2.xml
   trunk/data/levels/enigma_pentomino/
   trunk/data/levels/enigma_pentomino/Makefile.am
   trunk/data/levels/enigma_pentomino/index.xml
   trunk/data/levels/enigma_pentomino/pento06_1.xml
   trunk/data/levels/enigma_pentomino/pento07_1.xml
   trunk/data/levels/enigma_pentomino/pento08_1.xml
   trunk/data/levels/enigma_pentomino/pento09_1.xml
   trunk/data/levels/enigma_pentomino/pento10_1.xml
   trunk/data/levels/enigma_pentomino/pento11_1.xml
   trunk/data/levels/enigma_pentomino/pento12_1.xml
   trunk/data/levels/enigma_pentomino/pento13_1.xml
   trunk/data/levels/enigma_pentomino/pento14_1.xml
   trunk/data/levels/enigma_pentomino/pento15_1.xml
   trunk/data/levels/enigma_pentomino/pento16_1.xml
   trunk/data/levels/enigma_v/nat33_2.xml
   trunk/data/levels/enigma_vi/ralf07_3.xml
   trunk/data/levels/enigma_viii/ais01_1.xml
   trunk/data/levels/enigma_viii/ais02_1.xml
   trunk/data/levels/enigma_viii/ais03_1.xml
   trunk/data/levels/enigma_viii/ais04_1.xml
   trunk/data/levels/enigma_viii/devnull32_1.xml
Removed:
   trunk/data/levels/enigma_ii/nat27_1.xml
   trunk/data/levels/enigma_iii/nat36_1.xml
   trunk/data/levels/enigma_v/nat33_1.xml
   trunk/data/levels/enigma_vi/ralf07_2.xml
   trunk/data/levels/enigma_viii/pento06_1.xml
   trunk/data/levels/enigma_viii/pento07_1.xml
   trunk/data/levels/enigma_viii/pento08_1.xml
   trunk/data/levels/enigma_viii/pento09_1.xml
   trunk/data/levels/enigma_viii/pento10_1.xml
   trunk/data/levels/enigma_viii/pento11_1.xml
   trunk/data/levels/enigma_viii/pento12_1.xml
   trunk/data/levels/enigma_viii/pento13_1.xml
   trunk/data/levels/enigma_viii/pento14_1.xml
   trunk/data/levels/enigma_viii/pento15_1.xml
   trunk/data/levels/enigma_viii/pento16_1.xml
Modified:
   trunk/configure.ac
   trunk/data/levels/Makefile.am
   trunk/data/levels/enigma_cross/enigma0_92_1.xml
   trunk/data/levels/enigma_cross/enigma0_92_2.xml
   trunk/data/levels/enigma_cross/newlevels.xml
   trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
   trunk/data/levels/enigma_experimental/demo_simple.xml
   trunk/data/levels/enigma_i/nat32_1.xml
   trunk/data/levels/enigma_ii/index.xml
   trunk/data/levels/enigma_iii/index.xml
   trunk/data/levels/enigma_oxyd/index.xml
   trunk/data/levels/enigma_v/index.xml
   trunk/data/levels/enigma_vi/index.xml
   trunk/data/levels/enigma_vii/huesing01_1.xml
   trunk/data/levels/enigma_vii/index.xml
   trunk/data/levels/enigma_viii/index.xml
   trunk/data/levels/enigma_viii/ral32_1.xml
   trunk/data/levels/enigma_viii/ral33_1.xml
   trunk/data/levels/enigma_viii/raywick05_1.xml
Log:
-> A few new levels from devnull, ais
-> moved pentominoes into own levelpack (for the moment located under "Sokoban")
-> Levelrewrites of some maze levels
-> A few other levelupdates/bugfixes



Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/configure.ac	2009-05-18 17:06:37 UTC (rev 1676)
@@ -380,6 +380,7 @@
            data/levels/enigma_sokoban/Makefile
            data/levels/enigma_microban/Makefile
            data/levels/enigma_mas_microban/Makefile
+           data/levels/enigma_pentomino/Makefile
            data/levels/lib/Makefile
            data/levels/patches/Makefile
            data/fonts/Makefile

Modified: trunk/data/levels/Makefile.am
===================================================================
--- trunk/data/levels/Makefile.am	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/Makefile.am	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,8 +1,8 @@
 SUBDIRS = enigma_tutorial enigma_i enigma_ii enigma_iii enigma_iv enigma_v \
 	enigma_vi enigma_vii enigma_viii \
-	enigma_esprit enigma_oxyd enigma_peroxyd enigma_oxydmagnum \
-	enigma_oxydextra \
+	enigma_esprit enigma_oxyd enigma_peroxyd enigma_oxydmagnum enigma_oxydextra \
 	enigma_sokoban enigma_microban enigma_mas_microban \
+	enigma_pentomino \
 	enigma_experimental enigma_demolevels \
 	enigma_cross \
     patches lib

Modified: trunk/data/levels/enigma_cross/enigma0_92_1.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="27" title="Enigma 0.92 - 1"/>
+  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="28" title="Enigma 0.92 - 1"/>
 
   <attributes/>
 
@@ -93,7 +93,7 @@
     <level _seq="85" _title="No Trespassing" _xpath="enigma_peroxyd/peroxydlink65_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7c" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="86" _title=".J.U.M.P." _xpath="enigma_i/martin60_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin60" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="87" _title="Walk The Plank" _xpath="enigma_v/nat04_1" author="Nat Pryce" ctrl="force" easy="false" id="nat4" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="88" _title="Shipwreck" _xpath="enigma_v/nat33_1" author="Nat Pryce" ctrl="force" easy="false" id="natmaze2" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="88" _title="Shipwreck" _xpath="enigma_v/nat33_2" author="Nat Pryce" ctrl="force" easy="false" id="natmaze2" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="89" _title="- Meditation -" _xpath="enigma_ii/ant16_2" author="Petr Machata" ctrl="force" easy="false" id="ant16" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="90" _title="Dancers" _xpath="enigma_ii/ant14_2" author="Petr Machata" ctrl="force" easy="false" id="ant14" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="91" _title="Running Stone" _xpath="enigma_iv/christophanita01_1" author="Christoph &amp; Anita" ctrl="force" easy="false" id="christophanita_runningstone" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -113,7 +113,7 @@
     <level _seq="105" _title="Laser Spiral" _xpath="enigma_ii/duffy03_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy3" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="106" _title="Everhungry" _xpath="enigma_iii/ant32_1" author="Petr Machata" ctrl="force" easy="false" id="ant32" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="107" _title="The Turtle" _xpath="enigma_iii/ant05_1" author="Petr Machata" ctrl="force" easy="false" id="ant05" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="108" _title="Grow Your Own" _xpath="enigma_iii/nat36_1" author="Nat Pryce" ctrl="force" easy="false" id="natmaze5" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="108" _title="Grow Your Own" _xpath="enigma_iii/nat36_2" author="Nat Pryce" ctrl="force" easy="false" id="natmaze5" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="109" _title="- Meditation -" _xpath="enigma_ii/siegfried37_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation16" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="110" _title="Draggers" _xpath="enigma_v/ant21_2" author="Petr Machata" ctrl="force" easy="true" id="ant21" rel="2" rev="5" score="1" target="time" unit="duration"/>
     <level _seq="111" _title="The Disappearing Block" _xpath="enigma_ii/duffy02_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy2" rel="1" rev="2" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/enigma0_92_2.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_2.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_cross/enigma0_92_2.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15200" network="false" owner="Enigma Team" release="1" revision="35" title="Enigma 0.92 - 2"/>
+  <info enigma="1.00" group="Facets" location="15200" network="false" owner="Enigma Team" release="1" revision="36" title="Enigma 0.92 - 2"/>
 
   <attributes/>
 
@@ -26,7 +26,7 @@
     <level _seq="18" _title="Enigris" _xpath="enigma_v/ralf04_1" author="Ralf Westram" ctrl="force" easy="false" id="ralf04" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="19" _title="Gateway" _xpath="enigma_ii/martin85_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin85" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="20" _title="- No Meditation -" _xpath="enigma_iv/ralf08_2" author="Ralf Westram" ctrl="force" easy="false" id="ralf08" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="21" _title="Im-pull-se" _xpath="enigma_vi/ralf07_2" author="Ralf Westram" ctrl="force" easy="false" id="ralf07" rel="2" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="21" _title="Im-pull-se" _xpath="enigma_vi/ralf07_3" author="Ralf Westram" ctrl="force" easy="false" id="ralf07" rel="3" rev="2" score="3" target="time" unit="duration"/>
     <level _seq="22" _title="Simon Says" _xpath="enigma_i/nat12_1" author="Nat Pryce" ctrl="force" easy="false" id="nat12" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="23" _title="Deadly Cross" _xpath="enigma_i/martin84_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin84" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="24" _title="Easy Shifting.." _xpath="enigma_ii/ralf01_1" author="Ralf Westram" ctrl="force" easy="false" id="ralf01" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_cross/newlevels.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="42" title="Enigma 1.00 new"/>
+  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="43" title="Enigma 1.00 new"/>
 
   <attributes/>
 
@@ -50,7 +50,7 @@
     <level _seq="42" _title="Buridan" _xpath="enigma_ii/alain01_1" author="Alain Busser" ctrl="force" easy="false" id="alain01" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="43" _title="Moure-Switches" _xpath="enigma_ii/andreas10_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas10" rel="2" rev="5" score="1" target="time" unit="duration"/>
     <level _seq="44" _title="Turn Around" _xpath="enigma_ii/andreas07_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas07" rel="2" rev="5" score="1" target="time" unit="duration"/>
-    <level _seq="45" _title="Shoals" _xpath="enigma_ii/nat27_1" author="Nat Pryce" ctrl="force" easy="false" id="nat27" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="45" _title="Shoals" _xpath="enigma_ii/nat27_2" author="Nat Pryce" ctrl="force" easy="false" id="nat27" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="46" _title="Shifting Shoals" _xpath="enigma_ii/nat28_1" author="Nat Pryce" ctrl="force" easy="false" id="nat28" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="47" _title="Dirt Clod" _xpath="enigma_ii/xerxes02_1" author="Xerxes M. Dynatos" ctrl="force" easy="false" id="xerxes02" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="48" _title="Friend or Foe?" _xpath="enigma_ii/andreas05_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas05" rel="2" rev="3" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="49" title="Enigma 1.1 new"/>
+  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="50" title="Enigma 1.1 new"/>
 
   <attributes/>
 
@@ -70,7 +70,7 @@
     <level _seq="62" _title="Bold Boulder" _xpath="enigma_vii/ral14_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20061124ral279" rel="1" rev="127" score="1" target="time" unit="duration"/>
     <level _seq="63" _title="Tinker, Tailor" _xpath="enigma_vii/andreas46_3" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas46" rel="4" rev="12" score="2" target="time" unit="duration"/>
     <level _seq="64" _title="Elbow Society" _xpath="enigma_vii/andreas45_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas45" rel="2" rev="6" score="2" target="time" unit="duration"/>
-    <level _seq="65" _title="Watchmaker" _xpath="enigma_vii/huesing01_1" author="Johannes H?sing" ctrl="force" easy="false" id="huesing01" rel="1" rev="6" score="1" target="time" unit="duration"/>
+    <level _seq="65" _title="Watchmaker" _xpath="enigma_vii/huesing01_1" author="Johannes H?sing" ctrl="force" easy="false" id="huesing01" rel="1" rev="7" score="1" target="time" unit="duration"/>
     <level _seq="66" _title="Map it out II" _xpath="enigma_vii/manuel01_1" author="Manuel Eisentraut" ctrl="force" easy="true" id="manuel01" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="67" _title="Underground Temple" _xpath="enigma_vii/joe12_2" author="Joseph Dunne" ctrl="force" easy="true" id="joe_12" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="68" _title="Mountain Climbing III" _xpath="enigma_vii/joe26_1" author="Joseph Dunne" ctrl="force" easy="true" id="joe26" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -95,7 +95,7 @@
     <level _seq="87" _title="The Green Hell" _xpath="enigma_viii/mecke22_2" author="mecke" ctrl="force" easy="true" id="mecke22" rel="2" rev="85" score="1" target="time" unit="duration"/>
     <level _seq="88" _title="Tilt Board" _xpath="enigma_viii/ulf06_2" author="Ulf Stegemann" ctrl="force" easy="true" id="20080529ulf118" rel="2" rev="116" score="2" target="time" unit="duration"/>
     <level _seq="89" _title="4 - 8 - 4" _xpath="enigma_viii/dpl03_3" author="Dominik Leipold" ctrl="force" easy="true" id="20070821dpl003" rel="3" rev="5" score="3" target="time" unit="duration"/>
-    <level _seq="90" _title="Impulsive Order" _xpath="enigma_viii/raywick05_1" author="Ray Wick" ctrl="force" easy="true" id="raywick5" rel="1" rev="13" score="1" target="time" unit="duration"/>
+    <level _seq="90" _title="Impulsive Order" _xpath="enigma_viii/raywick05_1" author="Ray Wick" ctrl="force" easy="true" id="raywick5" rel="1" rev="14" score="1" target="time" unit="duration"/>
     <level _seq="91" _title="Cross Mail" _xpath="enigma_viii/johann03_1" author="Johann Freymuth" ctrl="force" easy="false" id="johann03" rel="1" rev="9" score="1" target="time" unit="duration"/>
     <level _seq="92" _title="Color Maze" _xpath="enigma_viii/pulley16_3" author="Mark Pulley" ctrl="force" easy="false" id="pulley16" rel="3" rev="10" score="3" target="time" unit="duration"/>
     <level _seq="93" _title="Earthlink" _xpath="enigma_viii/pulley15_1" author="Mark Pulley" ctrl="force" easy="true" id="pulley15" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -151,8 +151,8 @@
     <level _seq="143" _title="5 Days and 5 Nights" _xpath="enigma_viii/andreas56_1" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas56" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="144" _title="Babylon" _xpath="enigma_viii/mecke27_1" author="mecke" ctrl="force" easy="true" id="mecke27" rel="1" rev="27" score="1" target="time" unit="duration"/>
     <level _seq="145" _title="Two Is A Company III" _xpath="enigma_viii/devnull27_1" author="/dev/null" ctrl="force" easy="false" id="devnull27" rel="1" rev="3" score="1" target="time" unit="duration"/>
-    <level _seq="146" _title="Panelled Puzzle I" _xpath="enigma_viii/ral32_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20080820ral639" rel="1" rev="166" score="1" target="time" unit="duration"/>
-    <level _seq="147" _title="Panelled Puzzle II" _xpath="enigma_viii/ral33_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090308ral237" rel="1" rev="166" score="1" target="time" unit="duration"/>
+    <level _seq="146" _title="Panelled Puzzle I" _xpath="enigma_viii/ral32_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20080820ral639" rel="1" rev="177" score="1" target="time" unit="duration"/>
+    <level _seq="147" _title="Panelled Puzzle II" _xpath="enigma_viii/ral33_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090308ral237" rel="1" rev="177" score="1" target="time" unit="duration"/>
     <level _seq="148" _title="The Gordian Knot" _xpath="enigma_viii/ral15_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090312ral718" rel="1" rev="167" score="1" target="time" unit="duration"/>
     <level _seq="149" _title="Inverse Maze" _xpath="enigma_viii/ral44_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090325ral180" rel="1" rev="163" score="1" target="time" unit="duration"/>
     <level _seq="150" _title="Inverse Maze II" _xpath="enigma_viii/ral45_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090327ral218" rel="1" rev="170" score="1" target="time" unit="duration"/>
@@ -160,18 +160,12 @@
     <level _seq="152" _title="Fight of Elements" _xpath="enigma_viii/ral48_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090403ral538" rel="1" rev="172" score="1" target="time" unit="duration"/>
     <level _seq="153" _title="New York'Jungle" _xpath="enigma_viii/mecke32_1" author="mecke" ctrl="force" easy="false" id="mecke32" rel="1" rev="21" score="1" target="time" unit="duration"/>
     <level _seq="154" _title="Push? Pull? Rotate!" _xpath="enigma_viii/raoul33_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul33" rel="1" rev="3" score="1" target="time" unit="duration"/>
-    <level _seq="155" _title="Pentomino VI" _xpath="enigma_viii/pento06_1" author="Enigma Team" ctrl="force" easy="false" id="pento6" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="156" _title="Pentomino VII" _xpath="enigma_viii/pento07_1" author="Enigma Team" ctrl="force" easy="false" id="pento7" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="157" _title="Pentomino VIII" _xpath="enigma_viii/pento08_1" author="Enigma Team" ctrl="force" easy="false" id="pento8" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="158" _title="Pentomino IX" _xpath="enigma_viii/pento09_1" author="Enigma Team" ctrl="force" easy="false" id="pento9" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="159" _title="Pentomino X" _xpath="enigma_viii/pento10_1" author="Enigma Team" ctrl="force" easy="false" id="pento10" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="160" _title="Pentomino XI" _xpath="enigma_viii/pento11_1" author="Enigma Team" ctrl="force" easy="false" id="pento11" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="161" _title="Pentomino XII" _xpath="enigma_viii/pento12_1" author="Enigma Team" ctrl="force" easy="false" id="pento12" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="162" _title="Pentomino XIII" _xpath="enigma_viii/pento13_1" author="Enigma Team" ctrl="force" easy="false" id="pento13" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="163" _title="Pentomino XIV" _xpath="enigma_viii/pento14_1" author="Enigma Team" ctrl="force" easy="false" id="pento14" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="164" _title="Pentomino XV" _xpath="enigma_viii/pento15_1" author="Enigma Team" ctrl="force" easy="false" id="pento15" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="165" _title="Pentomino XVI" _xpath="enigma_viii/pento16_1" author="Enigma Team" ctrl="force" easy="false" id="pento16" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="166" _title="2 + 2" _xpath="enigma_viii/devnull11_1" author="/dev/null" ctrl="force" easy="true" id="devnull11" rel="1" rev="6" score="1" target="time" unit="duration"/>
+    <level _seq="155" _title="2 + 2" _xpath="enigma_viii/devnull11_1" author="/dev/null" ctrl="force" easy="true" id="devnull11" rel="1" rev="6" score="1" target="time" unit="duration"/>
+    <level _seq="156" _title="Afraid of water" _xpath="enigma_viii/devnull32_1" author="/dev/null" ctrl="force" easy="true" id="devnull32" rel="1" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="157" _title="Deathbridge" _xpath="enigma_viii/ais01_1" author="Alex Smith" ctrl="force" easy="true" id="20090416ais523003" rel="1" rev="9" score="1" target="time" unit="duration"/>
+    <level _seq="158" _title="Danger Flag" _xpath="enigma_viii/ais02_1" author="Alex Smith" ctrl="force" easy="true" id="20090338ais523002" rel="1" rev="11" score="1" target="time" unit="duration"/>
+    <level _seq="159" _title="Three Times Through" _xpath="enigma_viii/ais03_1" author="Alex Smith" ctrl="force" easy="true" id="20090316ais523001" rel="1" rev="8" score="1" target="time" unit="duration"/>
+    <level _seq="160" _title="From Six To Twenty-Six" _xpath="enigma_viii/ais04_1" author="Alex Smith" ctrl="force" easy="false" id="20090427ais523001" rel="1" rev="8" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: trunk/data/levels/enigma_experimental/demo_simple.xml
===================================================================
--- trunk/data/levels/enigma_experimental/demo_simple.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_experimental/demo_simple.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -3,26 +3,27 @@
   <el:protected >
     <el:info el:type="level">
       <el:identity el:title="Demo Simple" el:id="20060210ral001"/>
-      <el:version el:score="1" el:release="1" el:revision="1" el:status="stable"/>
+      <el:version el:score="1" el:release="1" el:revision="2" el:status="stable"/>
       <el:author  el:name="Ronald Lamprecht"/>
-      <el:copyright>Copyright ? 2006 Ronald Lamprecht</el:copyright>
+      <el:copyright>Copyright ? 2006,2009 Ronald Lamprecht</el:copyright>
       <el:license el:type="GPL2" el:open="true">GPL v2.0 or above</el:license>
-      <el:compatibility el:enigma="0.92"/>
+      <el:compatibility el:enigma="1.10"/>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
       <el:score el:easy="-" el:difficult="-"/>
     </el:info>
     <el:luamain><![CDATA[
-levelw = 20
-levelh = 13
+ti[" "] = {"fl_lawn_b"}
+ti["#"] = {"st_box"}
+ti["o"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble"}
 
-create_world( levelw, levelh)
-draw_border("st-wood")
-fill_floor("fl-leavesb", 0,0,levelw,levelh)
-
-oxyd( 4,4)
-oxyd( 14,4)
-
-set_actor("ac-blackball", 4, 11)
+wo(ti, " ", {
+    "####################",
+    "#                  #",
+    "#  o      @     o  #",
+    "#                  #",
+    "####################",
+})
     ]]></el:luamain>
     <el:i18n/>
   </el:protected>

Modified: trunk/data/levels/enigma_i/nat32_1.xml
===================================================================
--- trunk/data/levels/enigma_i/nat32_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_i/nat32_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -20,7 +20,7 @@
 tight_maze( new_kruskal_maze(38,24), "fl-sand", nil, "st-greenbrown" )
 oxyd_shuffle()
 
-display.SetFollowMode(display.FOLLOW_SCROLLING)
+--display.SetFollowMode(display.FOLLOW_SCROLLING)
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Modified: trunk/data/levels/enigma_ii/index.xml
===================================================================
--- trunk/data/levels/enigma_ii/index.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_ii/index.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10300" network="false" owner="Enigma Team" release="1" revision="25" title="Enigma II"/>
+  <info enigma="1.00" group="Enigma" location="10300" network="false" owner="Enigma Team" release="1" revision="26" title="Enigma II"/>
 
   <attributes/>
 
@@ -89,7 +89,7 @@
     <level _seq="81" _title="Pentomino I" _xpath="./ralf16_1" author="Ralf Westram" ctrl="force" easy="false" id="ralf_pento1" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="82" _title="Indoor Pool" _xpath="./nat01_2" author="Nat Pryce" ctrl="force" easy="false" id="nat1" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="83" _title="Pentomino II" _xpath="./pento02_1" author="Enigma Team" ctrl="force" easy="false" id="ralf_pento2" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="84" _title="Shoals" _xpath="./nat27_1" author="Nat Pryce" ctrl="force" easy="false" id="nat27" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="84" _title="Shoals" _xpath="./nat27_2" author="Nat Pryce" ctrl="force" easy="false" id="nat27" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="85" _title="Pentomino III" _xpath="./pento03_1" author="Enigma Team" ctrl="force" easy="false" id="ralf_pento3" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="86" _title="Slalom Skiing" _xpath="./martin93_1" author="Martin Hawlisch" ctrl="force" easy="true" id="martin93" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="87" _title="Pentomino IV" _xpath="./pento04_1" author="Enigma Team" ctrl="force" easy="false" id="ralf_pento4" rel="2" rev="2" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_ii/nat27_1.xml
===================================================================
--- trunk/data/levels/enigma_ii/nat27_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_ii/nat27_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,111 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Shoals" el:subtitle="" el:id="nat27"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Nat Pryce" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Nat Pryce</el:copyright>
-      <el:license el:type="GPL version 2" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/natmaze" el:id="lib/natmaze" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-maze_width = 19
-maze_height = 6
-
-function cellx_to_worldx( cellx )
-    return 2*cellx + 1
-end
-
-function celly_to_worldy( celly )
-    return 2*celly + 1
-end
-
-function maze_floor(x,y)
-    set_floor("fl-water", x, y)
-end
-
-function maze_wall(x,y)
-    set_floor("fl-sand", x, y)
-end
-
-function render_cell( maze, cellx, celly )
-    local x = cellx_to_worldx(cellx)
-    local y = celly_to_worldy(celly)
-    
-    maze_floor(x,y)
-    
-    if maze:can_go_east(cellx,celly) then
-        maze_floor(x+1,y)
-    elseif maze:contains_cell(cellx+1,celly) then
-        maze_wall(x+1,y)
-    end
-    
-    if maze:can_go_south(cellx,celly) then
-        maze_floor(x,y+1)
-    elseif maze:contains_cell(cellx,celly+1) then
-        maze_wall(x,y+1)
-    end
-    
-    if maze:contains_cell(cellx+1,celly+1) then
-        maze_wall(x+1,y+1)
-    end
-end
-
-function draw_maze()
-    render_maze( new_kruskal_maze(maze_width,maze_height), render_cell )
-end
-
-
-cells = {}
-
-function cell_is_clear(x,y)
-    for i = 1,getn(cells) do
-        cell = cells[i]
-        if cell[1] == x and cell[2] == y then
-            return nil
-        end
-    end
-    return 1
-end
-
-function random_safe_tile()
-    repeat
-        x = random(0,maze_width-2)
-        y = random(0,maze_height-2)
-    until cell_is_clear(x,y)
-    
-    tinsert(cells, {x,y})
-    return {cellx_to_worldx(x)+1,celly_to_worldy(y)+1}
-end
-
-
-create_world( 39, 13 )
-fill_floor("fl-water")
-draw_maze()
-
-for n = 1,8 do
-    p = random_safe_tile()
-    oxyd(p[1],p[2])
-end
-
-start = random_safe_tile()
-
-set_item("it-spring1", start[1], start[2])
-set_actor("ac-blackball", start[1]+0.5, start[2]+0.5, {player=0})
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_ii/nat27_2.xml (from rev 1675, trunk/data/levels/enigma_ii/nat27_1.xml)
===================================================================
--- trunk/data/levels/enigma_ii/nat27_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_ii/nat27_2.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,40 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Shoals" el:subtitle="" el:id="nat27"/>
+      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Nat Pryce" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Nat Pryce</el:copyright>
+      <el:license el:type="GPL version 2" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+        <el:dependency el:path="lib/libmaze" el:id="lib/libmaze" el:release="2" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti["~"] = {"fl_water"}
+ti["."] = {"fl_sand", name="corner#"}
+ti[":"] = {"fl_sand"}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"} .. ti({"it_spring_keep"})
+
+themaze = res.maze(ti, {area={po(1,1), 19, 6}, render={{"~", ":"}, ".", "~"}})
+wo(themaze, "~", 39, 13)
+
+oxyds = no["corner#*"]:shuffle():sub(8)
+wo[oxyds] = ti["O"]
+wo:shuffleOxyd()
+
+startpoint = (no["corner#*"]-oxyds):shuffle():sub(1)
+wo[startpoint] = ti["@"]
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_iii/index.xml
===================================================================
--- trunk/data/levels/enigma_iii/index.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_iii/index.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10400" network="false" owner="Enigma Team" release="1" revision="25" title="Enigma III"/>
+  <info enigma="1.00" group="Enigma" location="10400" network="false" owner="Enigma Team" release="1" revision="26" title="Enigma III"/>
 
   <attributes/>
 
@@ -31,7 +31,7 @@
     <level _seq="23" _title="Push the Hammer" _xpath="./martin79_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin79" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="24" _title="Lotsa Triggers" _xpath="./wb03_1" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb3" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="25" _title="Bomb Shelter" _xpath="./duffy88_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy88" rel="2" rev="1" score="2" target="time" unit="duration"/>
-    <level _seq="26" _title="Grow Your Own" _xpath="./nat36_1" author="Nat Pryce" ctrl="force" easy="false" id="natmaze5" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="26" _title="Grow Your Own" _xpath="./nat36_2" author="Nat Pryce" ctrl="force" easy="false" id="natmaze5" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="27" _title="Tricks &amp; Traps" _xpath="./siegfried04_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level2d" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="28" _title="Wells" _xpath="./ant19_2" author="Petr Machata" ctrl="force" easy="false" id="ant19" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="29" _title="Push? Pull!" _xpath="./siegfried01_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level1c" rel="1" rev="0" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_iii/nat36_1.xml
===================================================================
--- trunk/data/levels/enigma_iii/nat36_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_iii/nat36_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,94 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Grow Your Own" el:subtitle="" el:id="natmaze5"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Nat Pryce" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2002 Nat Pryce</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/natmaze" el:id="lib/natmaze" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-maze = new_kruskal_maze(38,24)   
-originx = 1
-originy = 1
-visited = {}
-
-function cell_to_level( cellx, celly )
-    return originx + cellx * 2, originy + celly * 2
-end
-
-function show_neighbours( cellx, celly )
-    local x, y = cell_to_level( cellx, celly )
-    
-    if maze:can_go_west( cellx, celly ) then
-        set_floor( "fl-gray", x-1, y )
-        show_cell( cellx-1, celly )
-    end
-    if maze:can_go_east( cellx, celly ) then
-        set_floor( "fl-gray", x+1, y )
-        show_cell( cellx+1, celly )
-    end
-    if maze:can_go_north( cellx, celly ) then
-        set_floor( "fl-gray", x, y-1 )
-        show_cell( cellx, celly-1 )
-    end
-    if maze:can_go_south( cellx, celly ) then
-        set_floor( "fl-gray", x, y+1 )
-        show_cell( cellx, celly+1 )
-    end
-end
-
-function show_cell( cellx, celly )
-    cell_id = maze:coords_to_cell(cellx,celly)
-    if visited[cell_id] then
-        return
-    end
-    
-    local x, y = cell_to_level( cellx, celly )
-    function_name = "trigger_"..cell_id
-    
-    function trigger_callback( on )
-        if on == 1 then
-            show_neighbours( cellx, celly )
-        end
-    end
-    setglobal( function_name, trigger_callback )
-    
-    set_floor( "fl-gray", x, y )
-    set_item( "it-trigger", x, y, {action="callback",target=function_name} )
-    
-    visited[cell_id] = 1
-end
-
-create_world( maze.width*2 + 2, maze.height*2 + 2 )
-fill_floor( "fl-abyss")
-
-oxyd(1,0)
-oxyd(2*maze.width-1,2*maze.height)
-oxyd(1,2*maze.height)
-oxyd(2*maze.width-1,0)
-
-local startx, starty = random(maze.width)-1, random(maze.height)-1
-local actorx, actory = cell_to_level( startx, starty )
-set_floor( "fl-gray", actorx, actory )
-show_neighbours( startx, starty )
-
-set_actor( "ac-blackball", actorx + 0.5, actory + 0.5 )
-display.SetFollowMode(display.FOLLOW_SCROLLING)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_iii/nat36_2.xml (from rev 1674, trunk/data/levels/enigma_iii/nat36_1.xml)
===================================================================
--- trunk/data/levels/enigma_iii/nat36_1.xml	2009-05-13 21:45:16 UTC (rev 1674)
+++ trunk/data/levels/enigma_iii/nat36_2.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,52 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Grow Your Own" el:subtitle="" el:id="natmaze5"/>
+      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Nat Pryce" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2002 Nat Pryce</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+        <el:dependency el:path="lib/libmaze" el:id="lib/libmaze" el:release="2" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_abyss"}
+ti["-"] = {"fl_abyss", name="path#"}
+ti["*"] = {"fl_abyss", name="hidden_trigger#"}
+ti["="] = {"fl_gray"}
+ti["t"] = ti["="] .. {"it_trigger", name="trigger#", action="callback", target="grow"}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+themaze = res.maze(ti, {area={po(1,1), 38, 24}, render={"-", " ", "*"}})
+wo(themaze, " ", 77, 49)
+wo[po(0,0) .. po(0,48) .. po(76,0) .. po(76,48)] = ti["O"]
+wo:shuffleOxyd()
+
+function grow(value, sender)
+    sender.target=DEFAULT
+    grow_maze(sender)
+end
+
+function grow_maze(pos)
+    mazeparts = po(fl(pos + NEIGHBORS_4) * no["path#*"])
+    wo[mazeparts] = ti["="]
+    wo[pos-2*(mazeparts-pos)] = ti["t"]
+end
+
+startpoint = no["hidden_trigger#*"]:shuffle()[1]
+grow_maze(startpoint)
+wo[startpoint] = ti["="] .. ti["@"]
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_oxyd/index.xml
===================================================================
--- trunk/data/levels/enigma_oxyd/index.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_oxyd/index.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="D?j?-vu" location="20200" network="false" owner="Enigma Team" release="1" revision="5" title="Oxyd"/>
+  <info enigma="1.00" group="D?j?-vu" location="20200" network="false" owner="Enigma Team" release="1" revision="6" title="Oxyd"/>
 
   <attributes/>
 
@@ -25,7 +25,7 @@
     <level _seq="17" _title="Bad Punball" _xpath="./oxyd22_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin59" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="18" _title="Twin Rooms" _xpath="./oxyd23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried71" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="19" _title="Proper Order" _xpath="./oxyd26_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried79" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="20" _title="Oxyd 28" _xpath="./oxyd28_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20070104ulf017" rel="1" rev="69" score="1" target="time" unit="duration"/>
+    <level _seq="20" _title="Oxyd 28" _xpath="./oxyd28_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20070104ulf017" rel="1" rev="70" score="1" target="time" unit="duration"/>
     <level _seq="21" _title="- Meditation -" _xpath="./oxyd30_1" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation9" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="22" _title="Oxyd 31" _xpath="./oxyd31_1" author="Ulf Stegemann" ctrl="force" easy="false" id="20061222ulf012" rel="1" rev="69" score="1" target="time" unit="duration"/>
     <level _seq="23" _title="Tunnel System" _xpath="./oxyd33_1" author="Siegfried Fennig" ctrl="force" easy="false" id="siegfried98" rel="1" rev="0" score="1" target="time" unit="duration"/>

Added: trunk/data/levels/enigma_pentomino/Makefile.am
===================================================================
--- trunk/data/levels/enigma_pentomino/Makefile.am	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_pentomino/Makefile.am	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,3 @@
+pkgdatadir = $(datadir)/@PACKAGE@/levels/enigma_pentomino
+pkgdata_DATA = $(wildcard $(srcdir)/*.png $(srcdir)/*.txt $(srcdir)/*.xml)
+EXTRA_DIST = $(pkgdata_DATA)


Property changes on: trunk/data/levels/enigma_pentomino/Makefile.am
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_pentomino/index.xml
===================================================================
--- trunk/data/levels/enigma_pentomino/index.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_pentomino/index.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
+
+  <info enigma="1.00" group="Sokoban" location="69000" network="false" owner="Enigma Team" release="1" revision="1" title="Pentomino"/>
+
+  <attributes/>
+
+  <levels>
+    <level _seq="1" _title="Pentomino II" _xpath="enigma_ii/pento02_1" author="Enigma Team" ctrl="force" easy="false" id="ralf_pento2" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="2" _title="Pentomino III" _xpath="enigma_ii/pento03_1" author="Enigma Team" ctrl="force" easy="false" id="ralf_pento3" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="3" _title="Pentomino IV" _xpath="enigma_ii/pento04_1" author="Enigma Team" ctrl="force" easy="false" id="ralf_pento4" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="4" _title="Pentomino V" _xpath="enigma_ii/pento05_1" author="Enigma Team" ctrl="force" easy="false" id="ralf_pento5" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="5" _title="Pentomino VI" _xpath="./pento06_1" author="Enigma Team" ctrl="force" easy="false" id="pento6" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="6" _title="Pentomino VII" _xpath="./pento07_1" author="Enigma Team" ctrl="force" easy="false" id="pento7" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="7" _title="Pentomino VIII" _xpath="./pento08_1" author="Enigma Team" ctrl="force" easy="false" id="pento8" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="8" _title="Pentomino IX" _xpath="./pento09_1" author="Enigma Team" ctrl="force" easy="false" id="pento9" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="9" _title="Pentomino X" _xpath="./pento10_1" author="Enigma Team" ctrl="force" easy="false" id="pento10" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="10" _title="Pentomino XI" _xpath="./pento11_1" author="Enigma Team" ctrl="force" easy="false" id="pento11" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="11" _title="Pentomino XII" _xpath="./pento12_1" author="Enigma Team" ctrl="force" easy="false" id="pento12" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="12" _title="Pentomino XIII" _xpath="./pento13_1" author="Enigma Team" ctrl="force" easy="false" id="pento13" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="13" _title="Pentomino XIV" _xpath="./pento14_1" author="Enigma Team" ctrl="force" easy="false" id="pento14" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="14" _title="Pentomino XV" _xpath="./pento15_1" author="Enigma Team" ctrl="force" easy="false" id="pento15" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="15" _title="Pentomino XVI" _xpath="./pento16_1" author="Enigma Team" ctrl="force" easy="false" id="pento16" rel="2" rev="2" score="1" target="time" unit="duration"/>
+  </levels>
+
+</index>


Property changes on: trunk/data/levels/enigma_pentomino/index.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Copied: trunk/data/levels/enigma_pentomino/pento06_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento06_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento07_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento07_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento08_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento08_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento09_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento09_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento10_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento10_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento11_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento11_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento12_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento12_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento13_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento13_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento14_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento14_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento15_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento15_1.xml)

Copied: trunk/data/levels/enigma_pentomino/pento16_1.xml (from rev 1674, trunk/data/levels/enigma_viii/pento16_1.xml)

Modified: trunk/data/levels/enigma_v/index.xml
===================================================================
--- trunk/data/levels/enigma_v/index.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_v/index.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10600" network="false" owner="Enigma Team" release="1" revision="36" title="Enigma V"/>
+  <info enigma="1.00" group="Enigma" location="10600" network="false" owner="Enigma Team" release="1" revision="37" title="Enigma V"/>
 
   <attributes/>
 
@@ -41,7 +41,7 @@
     <level _seq="33" _title="Pirates Island" _xpath="./alain07_1" author="Alain Busser" ctrl="force" easy="false" id="alain07" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="34" _title="Island of Safety" _xpath="./duffy27_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy27" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="35" _title="Tropical Island" _xpath="./andreas08_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas08" rel="2" rev="3" score="1" target="time" unit="duration"/>
-    <level _seq="36" _title="Shipwreck" _xpath="./nat33_1" author="Nat Pryce" ctrl="force" easy="false" id="natmaze2" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="36" _title="Shipwreck" _xpath="./nat33_2" author="Nat Pryce" ctrl="force" easy="false" id="natmaze2" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="37" _title="Ghost Islands" _xpath="./raoul15_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul15" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="38" _title="Reach the Dock" _xpath="./duffy119_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy119" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="39" _title="Mount Etna" _xpath="./duffy61_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy61" rel="1" rev="1" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_v/nat33_1.xml
===================================================================
--- trunk/data/levels/enigma_v/nat33_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_v/nat33_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,30 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Shipwreck" el:subtitle="" el:id="natmaze2"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Nat Pryce" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2002 Nat Pryce</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/natmaze" el:id="lib/natmaze" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-tight_maze( new_kruskal_maze(38,24), "fl-wood", "fl-water", nil )
-oxyd_shuffle()
-display.SetFollowMode(display.FOLLOW_SCROLLING)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_v/nat33_2.xml (from rev 1675, trunk/data/levels/enigma_v/nat33_1.xml)
===================================================================
--- trunk/data/levels/enigma_v/nat33_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_v/nat33_2.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,36 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Shipwreck" el:subtitle="" el:id="natmaze2"/>
+      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Nat Pryce" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2002 Nat Pryce</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+        <el:dependency el:path="lib/libmaze" el:id="lib/libmaze" el:release="2" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["FollowMethod"] = FOLLOW_SCROLL
+
+ti[" "] = {"fl_wood", name="path#*"}
+ti["~"] = {"fl_water"}
+
+themaze = res.maze(ti, {area={po(1,1), 37, 24}, render={" ", "~", " "}})
+
+wo(themaze, "~", 75, 49)
+wo[po(1,0) .. po(73,0) .. po(1,48) .. po(73,48)] = {"st_oxyd"}
+wo:shuffleOxyd()
+wo[no["path#*"]:shuffle()[1]] = {"#ac_marble_black"}
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>
\ No newline at end of file

Modified: trunk/data/levels/enigma_vi/index.xml
===================================================================
--- trunk/data/levels/enigma_vi/index.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_vi/index.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10700" network="false" owner="Enigma Team" release="1" revision="41" title="Enigma VI"/>
+  <info enigma="1.00" group="Enigma" location="10700" network="false" owner="Enigma Team" release="1" revision="42" title="Enigma VI"/>
 
   <attributes/>
 
@@ -14,7 +14,7 @@
     <level _seq="6" _title="Laser Splitting" _xpath="./luc29_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc29" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="7" _title="No Memory" _xpath="./edward01_1" author="Edward" ctrl="force" easy="false" id="edward01" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Orbitting" _xpath="./andreas26_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas26" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="9" _title="Im-pull-se" _xpath="./ralf07_2" author="Ralf Westram" ctrl="force" easy="false" id="ralf07" rel="2" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="9" _title="Im-pull-se" _xpath="./ralf07_3" author="Ralf Westram" ctrl="force" easy="false" id="ralf07" rel="3" rev="2" score="3" target="time" unit="duration"/>
     <level _seq="10" _title="Meditation Disturbance" _xpath="./ral04_2" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060429ral006" rel="2" rev="143" score="1" target="time" unit="duration"/>
     <level _seq="11" _title="Cold Way" _xpath="./raoul21_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul21" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="12" _title="Oxydmoron" _xpath="./raoul14_2" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul14" rel="2" rev="3" score="2" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_vi/ralf07_2.xml
===================================================================
--- trunk/data/levels/enigma_vi/ralf07_2.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_vi/ralf07_2.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,59 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Im-pull-se" el:subtitle="" el:id="ralf07"/>
-      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
-      <el:author  el:name="Ralf Westram" el:email="amgine at reallysoft.de" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Ralf Westram</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10"/>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-ti[" "] = ti({"fl_bluegreen", checkerboard=0}) .. {"fl_bluegray", checkerboard=1}
-ti["."] = {"fl_abyss"}
-ti["-"] = {"fl_sahara"}
-ti["#"] = {"st_lightglass"}
-ti["X"] = ti["-"] .. ti["#"]
-ti["*"] = ti["-"] .. {"st_lightglass", name="doors#"}
-ti["G"] = ti["-"] .. {"st_rawglass"}
-ti["I"] = {"st_stoneimpulse"}
-ti["J"] = ti["-"] .. ti["I"]
-ti["P"] = {"st_pull"}
-ti["t"] = {"it_trigger", target="counter", action="signal"}
-ti["R"] = ti["t"] .. ti["P"]
-ti["O"] = {"st_oxyd"}
-ti["@"] = {"#ac_marble_black"}
-
-wo(ti, " ", {
-    ".........O..........",
-    "........   .........",
-    "......###*###.......",
-    ".....#X     X#......",
-    ".....# RtJtR #......",
-    ".... # tGIGt # .....",
-    "...O * JI IJ * O....",
-    ".... # tGIGt # .....",
-    ".....# RtJtR #......",
-    ".....#X  @  X#......",
-    "......###*###.......",
-    "........   .........",
-    ".........O.........."})
-
-wo:add({"ot_counter", name="counter", state=4, target="open_doors", action_12="callback"})
-wo:shuffleOxyd()
-
-function open_doors(value, sender)
-    wo[no["doors#*"]] = ti["-"] .. ti["P"]
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_vi/ralf07_3.xml (from rev 1675, trunk/data/levels/enigma_vi/ralf07_2.xml)
===================================================================
--- trunk/data/levels/enigma_vi/ralf07_2.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_vi/ralf07_3.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,65 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Im-pull-se" el:subtitle="" el:id="ralf07"/>
+      <el:version el:score="3" el:release="3" el:revision="2" el:status="released"/>
+      <el:author  el:name="Ralf Westram" el:email="amgine at reallysoft.de" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Ralf Westram</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ConserveLevel"] = false
+
+ti[" "] = ti({"fl_bluegreen", checkerboard=0}) .. {"fl_bluegray", checkerboard=1}
+ti["."] = {"fl_abyss"}
+ti["-"] = {"fl_sahara"}
+ti["#"] = {"st_lightglass"}
+ti["X"] = ti["-"] .. ti["#"]
+ti["*"] = {"fl_sahara", name="doors#"} .. ti["#"]
+ti["G"] = ti["-"] .. {"st_rawglass"}
+ti["I"] = {"st_stoneimpulse"}
+ti["J"] = ti["-"] .. ti["I"]
+ti["P"] = {"st_pull"}
+ti["t"] = {"it_trigger", target="counter", action="signal"}
+ti["R"] = ti["t"] .. ti["P"]
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+    ".........O..........",
+    "........   .........",
+    "......###*###.......",
+    ".....#X     X#......",
+    ".....# RtJtR #......",
+    ".... # tGIGt # .....",
+    "...O * JI IJ * O....",
+    ".... # tGIGt # .....",
+    ".....# RtJtR #......",
+    ".....#X  @  X#......",
+    "......###*###.......",
+    "........   .........",
+    ".........O.........."})
+
+wo:add({"ot_counter", name="counter", state=4, target_11="close_doors", target_12="open_doors", action="callback"})
+wo:shuffleOxyd()
+
+function open_doors(value, sender)
+    wo[no["doors#*"]] = ti["P"]
+end
+
+function close_doors(value, sender)
+    wo[no["doors#*"]] = ti["*"]
+end
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_vii/huesing01_1.xml
===================================================================
--- trunk/data/levels/enigma_vii/huesing01_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_vii/huesing01_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,60 +1,64 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
   <el:protected>
-     <el:info el:type="level">
-       <el:identity el:title="Watchmaker" el:subtitle="Mend the clockwork" el:id="huesing01"/>
-       <el:version el:score="1" el:release="1" el:revision="6" el:status="released"/>
-       <el:author el:name="Johannes H?sing" el:email="hannes at ruhrau.de" el:homepage="http://derwisch.wikidot.com"/>
-       <el:copyright>Copyright ? 2008 Johannes H?sing </el:copyright>
-       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-       <el:compatibility el:enigma="1.10"/>
-       <el:modes el:easy="false" el:single="true" el:network="false"/>
-       <el:score el:easy="-" el:difficult="-"/>
-     </el:info>
+    <el:info el:type="level">
+      <el:identity el:title="Watchmaker" el:subtitle="Mend the clockwork" el:id="huesing01"/>
+      <el:version el:score="1" el:release="1" el:revision="7" el:status="released"/>
+      <el:author el:name="Johannes H?sing" el:email="hannes at ruhrau.de" el:homepage="http://derwisch.wikidot.com"/>
+      <el:copyright>Copyright ? 2008 Johannes H?sing </el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
     <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
+wo["ConserveLevel"] = false
 
 ti[" "] = {"fl_metal_4"}
 ti["-"] = {"fl_metal_2"}
-ti["+"] = {"fl_metal_3"}
+ti["="] = {"fl_metal_3"}
 ti["|"] = {"fl_metal_6"}
-ti["~"] = {"fl_water"}
 ti["#"] = {"st_metal"}
-ti["W"] = ti["+"] .. {"st_box_wood"}
-ti["X"] = {"st_oxyd"}
-ti[":"] = {"st_door","door#", flavor="d", faces="ew"}
-ti["A"] = ti["~"] .. {"st_boulder_n", "boulderA"}
+ti["+"] = ti["="] .. {"st_box_wood"}
+ti["^"] = ti({"fl_water"}) .. {"st_boulder_n", "boulderA"}
+ti["V"] = ti({"fl_water"}) .. {"st_boulder_s", "boulderB"}
 ti["a"] = {"it_trigger", target="boulderA", action_1="turn"}
-ti["B"] = ti["~"] .. {"st_boulder_s", "boulderB"}
 ti["b"] = {"it_trigger", target="boulderB", action_1="turn"}
-ti["1"] = {"it_trigger", target={"door#5","door#6"}, action_1={"open","close"}, action_0={"nope","nope"}}
-ti["2"] = {"it_trigger", target={"door#4","door#3"}, action_1={"open","close"}, action_0={"nope","nope"}}
-ti["3"] = {"it_trigger", target={"door#7","door#8"}, action_1={"open","close"}, action_0={"nope","nope"}}
-ti["4"] = {"it_trigger", target={"door#2","door#1"}, action_1={"open","close"}, action_0={"nope","nope"}}
-ti["5"] = {"it_trigger", target={"door#6","door#7"}, action_1={"open","close"}, action_0={"nope","nope"}}
-ti["6"] = {"it_trigger", target={"door#3","door#2"}, action_1={"open","close"}, action_0={"nope","nope"}}
-ti["7"] = {"it_trigger", target={"door#8","door#5"}, action_1={"open","close"}, action_0={"nope","nope"}}
-ti["8"] = {"it_trigger", target={"door#1","door#4"}, action_1={"open","close"}, action_0={"nope","nope"}}
-ti["D"] = ti["+"] .. {"it_document", text="text1"}
+ti["1"] = {"st_door","door#1", flavor="d", faces="ew"}
+ti["2"] = {"st_door","door#2", flavor="d", faces="ew"}
+ti["3"] = {"st_door","door#3", flavor="d", faces="ew"}
+ti["4"] = {"st_door","door#4", flavor="d", faces="ew"}
+ti["5"] = {"st_door","door#5", flavor="d", faces="ew"}
+ti["6"] = {"st_door","door#6", flavor="d", faces="ew"}
+ti["7"] = {"st_door","door#7", flavor="d", faces="ew"}
+ti["8"] = {"st_door","door#8", flavor="d", faces="ew"}
+ti["A"] = {"it_trigger", target={"door#5","door#6"}, action_1={"open","close"}, action_0={"nop","nop"}}
+ti["B"] = {"it_trigger", target={"door#4","door#3"}, action_1={"open","close"}, action_0={"nop","nop"}}
+ti["C"] = {"it_trigger", target={"door#7","door#8"}, action_1={"open","close"}, action_0={"nop","nop"}}
+ti["D"] = {"it_trigger", target={"door#2","door#1"}, action_1={"open","close"}, action_0={"nop","nop"}}
+ti["E"] = {"it_trigger", target={"door#6","door#7"}, action_1={"open","close"}, action_0={"nop","nop"}}
+ti["F"] = {"it_trigger", target={"door#3","door#2"}, action_1={"open","close"}, action_0={"nop","nop"}}
+ti["G"] = {"it_trigger", target={"door#8","door#5"}, action_1={"open","close"}, action_0={"nop","nop"}}
+ti["H"] = {"it_trigger", target={"door#1","door#4"}, action_1={"open","close"}, action_0={"nop","nop"}}
+ti["t"] = ti["="] .. {"it_document", text="text1"}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"ac_marble_black", 0.0, 0.5}
 
-ti["0"] = {"ac_marble_black", 0.0, 0.5}
-
-w, h = wo(ti, " ", {
+wo(ti, " ", {
     "####################",
-    "#X : : : :A        #",
+    "#O 1 2 3 4^        #",
     "###########        #",
     "#                  #",
-    "#   1-a-2  5-b-6   #",
-    "#   |+++|  |+++|   #",
-    "#   a+W+a 0b+W+b   #",
-    "#   |+D+|  |+++|   #",
-    "#   3-a-4  7-b-8   #",
+    "#   A-a-B  E-b-F   #",
+    "#   |===|  |===|   #",
+    "#   a=+=a @b=+=b   #",
+    "#   |=t=|  |===|   #",
+    "#   C-a-D  G-b-H   #",
     "#                  #",
     "#        ###########",
-    "#        B: : : : X#",
+    "#        V5 6 7 8 O#",
     "####################"})
-
-  ]]></el:luamain>
+ ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">
         <el:english el:translate="true"/>

Modified: trunk/data/levels/enigma_vii/index.xml
===================================================================
--- trunk/data/levels/enigma_vii/index.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_vii/index.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10800" network="false" owner="Enigma Team" release="1" revision="49" title="Enigma VII"/>
+  <info enigma="1.00" group="Enigma" location="10800" network="false" owner="Enigma Team" release="1" revision="50" title="Enigma VII"/>
 
   <attributes/>
 
@@ -94,7 +94,7 @@
     <level _seq="86" _title="Bold Boulder" _xpath="./ral14_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20061124ral279" rel="1" rev="127" score="1" target="time" unit="duration"/>
     <level _seq="87" _title="Tinker, Tailor" _xpath="./andreas46_3" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas46" rel="4" rev="12" score="2" target="time" unit="duration"/>
     <level _seq="88" _title="Elbow Society" _xpath="./andreas45_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas45" rel="2" rev="6" score="2" target="time" unit="duration"/>
-    <level _seq="89" _title="Watchmaker" _xpath="./huesing01_1" author="Johannes H?sing" ctrl="force" easy="false" id="huesing01" rel="1" rev="6" score="1" target="time" unit="duration"/>
+    <level _seq="89" _title="Watchmaker" _xpath="./huesing01_1" author="Johannes H?sing" ctrl="force" easy="false" id="huesing01" rel="1" rev="7" score="1" target="time" unit="duration"/>
     <level _seq="90" _title="Map it out II" _xpath="./manuel01_1" author="Manuel Eisentraut" ctrl="force" easy="true" id="manuel01" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="91" _title="Underground Temple" _xpath="./joe12_2" author="Joseph Dunne" ctrl="force" easy="true" id="joe_12" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="92" _title="Mountain Climbing III" _xpath="./joe26_1" author="Joseph Dunne" ctrl="force" easy="true" id="joe26" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -105,6 +105,7 @@
     <level _seq="97" _title="Audience in Venice" _xpath="./mecke09_2" author="mecke" ctrl="force" easy="true" id="mecke9" rel="2" rev="40" score="1" target="time" unit="duration"/>
     <level _seq="98" _title="Black Liberation" _xpath="./mecke11_2" author="mecke" ctrl="force" easy="true" id="mecke11" rel="2" rev="44" score="1" target="time" unit="duration"/>
     <level _seq="99" _title="Jack-Of-All-Trades" _xpath="./mecke12_2" author="mecke" ctrl="force" easy="true" id="mecke12" rel="2" rev="49" score="1" target="time" unit="duration"/>
+    <level _seq="100" _title="TODO" _xpath="lib/todo" author="Martin Hawlisch" ctrl="force" easy="false" id="todo" rel="1" rev="1" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Added: trunk/data/levels/enigma_viii/ais01_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/ais01_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/ais01_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,63 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Deathbridge" el:subtitle="" el:id="20090416ais523003"/>
+      <el:version el:score="1" el:release="1" el:revision="9" el:status="released"/>
+      <el:author  el:name="Alex Smith" el:email="ais523 at bham.ac.uk" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 Alex Smith</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:score el:easy="0:55" el:difficult="0:44"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ConserveLevel"] = false
+
+ti[" "] = {"fl_space", force_y=30}
+ti["."] = {"fl_rock", force_y=30}
+ti["#"] = ti["."] .. {"st_granite"}
+ti["!"] = {"st_death"}
+ti["^"] = ti["."] .. {"st_oneway_black", orientation=NORTH}
+ti["<"] = {"st_oneway_black", orientation=WEST}
+ti[">"] = {"st_oneway_black", orientation=EAST}
+ti["="] = {"st_rawglass_movable"} .. ti({"it_death"})
+ti["o"] = ti["."] .. {"st_oxyd_e", "leftoxyd_#"}
+ti["O"] = ti["."] .. {"st_oxyd_e", "rightoxyd_#"}
+ti["@"] = ti["."] .. {"#ac_marble"}
+if wo["IsDifficult"] then
+    ti["t"] = {"it_trigger", action="callback", target="growdeath"}
+else
+    ti["t"] = ti[" "]
+end
+
+wo(ti," ",{
+    "#####!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#####",
+    "#...   <                                          >   ...#",
+    "#^^^<  <                                          >  >^^^#",
+    "#@..<                                                >...#",
+    "#...<                                                >...#",
+    "#...<                                                >...#",
+    "#...<                                                >...#",
+    "#...<                                                >...#",
+    "o...<                                                >...O",
+    "o...<                                                >...O",
+    "o...<                                                >...O",
+    "o...<                                                >...O",
+    "#####================================================#####",
+    "#####tttttttttttttttttttttttttttttttttttttttttttttttt#####"})
+
+wo:shuffleOxyd({"leftoxyd_#*", "rightoxyd_#*", min=4})
+no["leftoxyd_#*"][1]:peepall()
+
+function growdeath(state,caller)
+    wo[caller + N] = ti["!"]
+end
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/ais01_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_viii/ais02_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/ais02_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/ais02_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,53 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Danger Flag" el:subtitle="" el:id="20090338ais523002"/>
+      <el:version el:score="1" el:release="1" el:revision="11" el:status="released"/>
+      <el:author  el:name="Alex Smith" el:email="ais523 at bham.ac.uk" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 Alex Smith</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:score el:easy="0:30" el:difficult="0:31"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ConserveLevel"] = true
+
+ti[" "] = {"fl_hay"}
+ti["#"] = {"st_panel", cluster=1}
+ti["G"] = {"st_rotator_ccw"}
+ti["g"] = {"st_rotator_cw"}
+ti["<"] = {"st_boulder_w"}
+ti[">"] = {"st_boulder_e"}
+ti["*"] = {"it_extralife"}
+ti["f"] = {"it_flag_black"}
+ti["O"] = {"st_oxyd_a"}
+if wo["IsDifficult"] then
+    ti["@"] = {"#ac_marble"}
+else
+    ti["@"] = ti["*"] .. {"#ac_marble"}
+end
+
+wo(ti, " ", {
+    "####################",
+    "O>                 G",
+    "#g################ #",
+    "g                 <#",
+    "# ################G#",
+    "#>                 G",
+    "#g################ #",
+    "g                 <#",
+    "# ################G#",
+    "#>                 G",
+    "#g################ #",
+    "O@*f              <#",
+    "##################G#"})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="true"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/ais02_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_viii/ais03_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/ais03_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/ais03_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,50 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Three Times Through" el:subtitle="" el:id="20090316ais523001"/>
+      <el:version el:score="1" el:release="1" el:revision="8" el:status="released"/>
+      <el:author  el:name="Alex Smith" el:email="ais523 at bham.ac.uk" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 Alex Smith</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:score el:easy="1:43" el:difficult="1:32"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_lawn"}
+ti["#"] = {"st_fake_oxyda"}
+ti["<"] = {"st_oneway", orientation=WEST}
+ti[">"] = {"st_oneway", orientation=EAST}
+ti["s"] = {"it_spoon"}
+ti["O"]={"st_oxyd_d"}
+ti["@"]={"#ac_marble"}
+if wo["IsDifficult"] then
+    ti["o"] = ti["O"]
+else
+    ti["o"] = ti["#"]
+end
+
+wo(ti," ",{
+    "####################",
+    "#        oo        #",
+    "# ###### ## ###### #",
+    "# #   >> >> >>   # #",
+    "# # #O##O##O##O# # #",
+    "# # #s<< << << < # #",
+    "# # #O##O##O##O# # #",
+    "# # < << << <<@# # #",
+    "# # #O##O##O##O# # #",
+    "# #   >> >> >>   # #",
+    "# ###### ## ###### #",
+    "#        oo        #",
+    "####################"})
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/ais03_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_viii/ais04_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/ais04_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/ais04_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,89 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="From Six To Twenty-Six" el:subtitle="" el:id="20090427ais523001"/>
+      <el:version el:score="1" el:release="1" el:revision="8" el:status="released"/>
+      <el:author  el:name="Alex Smith" el:email="ais523 at bham.ac.uk" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 Alex Smith</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="2:48"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ProvideExtralifes"] = false
+wo["FollowGrid"] = false
+wo["FollowMethod"] = FOLLOW_SCROLL
+
+ti[" "] = {"fl_redslab"}
+ti["."] = {"fl_blueslab"}
+ti["="] = {"st_rawglass"}
+ti["#"] = {"st_darkgray"}
+ti["Z"] = {"st_mirror_slab", state=EAST, transparent=true}
+ti["z"] = {"st_mirror_slab", state=EAST}
+ti["("] = {"st_puzzle_blue", connections="es"}
+ti["-"] = {"st_puzzle_blue", connections="ew", hollow=true}
+ti[")"] = {"st_puzzle_blue", connections="ws"}
+ti["1"] = {"st_puzzle_blue", connections="ns"}
+ti["2"] = {"st_puzzle_blue", connections="s", hollow=true}
+ti["3"] = {"st_puzzle_blue", connections="n", hollow=true}
+ti["4"] = {"st_puzzle_blue", connections="sn"}
+ti["["] = {"st_window_w", secure=true}
+ti["]"] = {"st_window_e", secure=true}
+ti["_"] = {"st_window_s", secure=true}
+ti["'"] = {"st_window_n", secure=true}
+ti[";"] = {"st_window_nw", secure=true}
+ti["/"] = {"st_window_es", secure=true}
+ti["|"] = {"st_window_ew", secure=true}
+ti["L"] = {"st_window_sw", secure=true}
+ti["`"] = {"st_window_ne", secure=true}
+ti["<"] = {"st_laser", "togglables_#", orientation=WEST}
+ti["v"] = {"st_laser", orientation=SOUTH}
+ti["X"] = {"st_mirror_sheets", "southmirrors_#", transparent=true, movable=true, orientation=SLASH}
+ti["K"] = {"st_mirror_slab", "southmirrors_#", movable=true, orientation=SLASH}
+ti["%"] = {"st_laserswitch", action_1="turn", action_0="turnback", target="@southmirrors_#*"}
+ti["D"] = {"st_door_d","togglables_#", state=CLOSED, faces="ew"}
+ti["I"] = {"st_switch", target="togglables_#*", instant=true}
+ti["O"] = {"st_oxyd_a"}
+ti["@"] = ti["["] .. {"#ac_marble"}
+
+function myresolver(k, x, y)
+    if x%2 ~= 0 then
+        return ti[k] .. ti["."]
+    else
+        return ti[k]
+    end
+end
+
+wo(myresolver, " ", {
+    "IZZZZZZZZZZZZZZZZZZZZZZZZZZ< ",
+    "[''''''''''''''''''''''''''` ",
+    "[()                        ] ",
+    "[(-)                       ] ",
+    "[(--)                      ] ",
+    "[(---)                     ] ",
+    "[(----)                    ] ",
+    "[(-----)                   ] ",
+    "[(------)                  ] ",
+    "[(-------)                 ] ",
+    "[(--------)                ] ",
+    "[(---------)               ] ",
+    "[(----------)              ] ",
+    "[(-----------)             ] ",
+    "[(------------)            /_",
+    "@__________________________D]",
+    "|%%%%%%%%%%%%%%%%%%%%%%%%%%#O",
+    "|KXXXXXXXXXXXXXXXXXXXXXXXXX<O",
+    "[''''''''''''''''''''''''''D]",
+    "[121212                    `'",
+    "[343434                    ] ",
+    "L__________________________/ "})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/ais04_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_viii/devnull32_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/devnull32_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/devnull32_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -0,0 +1,59 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Afraid of water" el:subtitle="" el:id="devnull32"/>
+      <el:version el:score="1" el:release="1" el:revision="3" el:status="released"/>
+      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2008 dev0</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:score el:easy="1:30" el:difficult="0:45"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ConserveLevel"] = false
+wo["ProvideExtralifes"] = false
+
+ti[" "] = {"fl_water"}
+ti[","] = {"fl_wood"}
+ti["+"] = {"it_crack_m", flavor = "water"}
+ti["~"] = {"it_crack_l", flavor = "water"}
+ti["."] = ti[","] .. ti["~"]
+ti["b"] = {"st_box_wood_v"}
+ti["B"] = ti["."] .. {"st_box_wood_h"}
+ti["R"] = ti[","] .. ti["+"]
+if wo["IsDifficult"] then
+    ti[":"] = ti["."]
+    ti["-"] = ti["~"]
+    ti["E"] = ti["B"]
+else
+    ti[":"] = ti[","] .. ti["+"]
+    ti["-"] = ti["+"]
+    ti["E"] = ti[":"] .. {"st_box_wood_h"}
+end
+ti["O"] = {"st_oxyd_d"}
+ti["@"] = ti["."] .. {"#ac_marble_black"}
+
+width, height = wo(ti, " ", {
+    "                    ",
+    " O  ~B:  .~BR.~B-.. ",
+    " R  . ..:.  :   b . ",
+    " ~b:R   b   b ..:.. ",
+    " ~  :.  -B~.- .     ",
+    " B  b.  .   ..::... ",
+    " :  -.  .   ~ b   . ",
+    " .. B   .   ~bR.... ",
+    "  ~b+...R::b~ .     ",
+    "  . b   b   . .     ",
+    "  :.~~B:~.  ~b:..   ",
+    " O       ....   ..@ ",
+    "                    "})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/devnull32_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/data/levels/enigma_viii/index.xml
===================================================================
--- trunk/data/levels/enigma_viii/index.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/index.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="44" title="Enigma VIII"/>
+  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="45" title="Enigma VIII"/>
 
   <attributes/>
 
@@ -21,7 +21,7 @@
     <level _seq="13" _title="The Green Hell" _xpath="./mecke22_2" author="mecke" ctrl="force" easy="true" id="mecke22" rel="2" rev="85" score="1" target="time" unit="duration"/>
     <level _seq="14" _title="Tilt Board" _xpath="./ulf06_2" author="Ulf Stegemann" ctrl="force" easy="true" id="20080529ulf118" rel="2" rev="116" score="2" target="time" unit="duration"/>
     <level _seq="15" _title="4 - 8 - 4" _xpath="./dpl03_3" author="Dominik Leipold" ctrl="force" easy="true" id="20070821dpl003" rel="3" rev="5" score="3" target="time" unit="duration"/>
-    <level _seq="16" _title="Impulsive Order" _xpath="./raywick05_1" author="Ray Wick" ctrl="force" easy="true" id="raywick5" rel="1" rev="13" score="1" target="time" unit="duration"/>
+    <level _seq="16" _title="Impulsive Order" _xpath="./raywick05_1" author="Ray Wick" ctrl="force" easy="true" id="raywick5" rel="1" rev="14" score="1" target="time" unit="duration"/>
     <level _seq="17" _title="Cross Mail" _xpath="./johann03_1" author="Johann Freymuth" ctrl="force" easy="false" id="johann03" rel="1" rev="9" score="1" target="time" unit="duration"/>
     <level _seq="18" _title="Color Maze" _xpath="./pulley16_3" author="Mark Pulley" ctrl="force" easy="false" id="pulley16" rel="3" rev="10" score="3" target="time" unit="duration"/>
     <level _seq="19" _title="Earthlink" _xpath="./pulley15_1" author="Mark Pulley" ctrl="force" easy="true" id="pulley15" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -77,8 +77,8 @@
     <level _seq="69" _title="5 Days and 5 Nights" _xpath="./andreas56_1" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas56" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="70" _title="Babylon" _xpath="./mecke27_1" author="mecke" ctrl="force" easy="true" id="mecke27" rel="1" rev="27" score="1" target="time" unit="duration"/>
     <level _seq="71" _title="Two Is A Company III" _xpath="./devnull27_1" author="/dev/null" ctrl="force" easy="false" id="devnull27" rel="1" rev="3" score="1" target="time" unit="duration"/>
-    <level _seq="72" _title="Panelled Puzzle I" _xpath="./ral32_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20080820ral639" rel="1" rev="166" score="1" target="time" unit="duration"/>
-    <level _seq="73" _title="Panelled Puzzle II" _xpath="./ral33_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090308ral237" rel="1" rev="166" score="1" target="time" unit="duration"/>
+    <level _seq="72" _title="Panelled Puzzle I" _xpath="./ral32_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20080820ral639" rel="1" rev="177" score="1" target="time" unit="duration"/>
+    <level _seq="73" _title="Panelled Puzzle II" _xpath="./ral33_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090308ral237" rel="1" rev="177" score="1" target="time" unit="duration"/>
     <level _seq="74" _title="The Gordian Knot" _xpath="./ral15_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090312ral718" rel="1" rev="167" score="1" target="time" unit="duration"/>
     <level _seq="75" _title="Inverse Maze" _xpath="./ral44_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090325ral180" rel="1" rev="163" score="1" target="time" unit="duration"/>
     <level _seq="76" _title="Inverse Maze II" _xpath="./ral45_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090327ral218" rel="1" rev="170" score="1" target="time" unit="duration"/>
@@ -86,18 +86,12 @@
     <level _seq="78" _title="Fight of Elements" _xpath="./ral48_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20090403ral538" rel="1" rev="172" score="1" target="time" unit="duration"/>
     <level _seq="79" _title="New York'Jungle" _xpath="./mecke32_1" author="mecke" ctrl="force" easy="false" id="mecke32" rel="1" rev="21" score="1" target="time" unit="duration"/>
     <level _seq="80" _title="Push? Pull? Rotate!" _xpath="./raoul33_1" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul33" rel="1" rev="3" score="1" target="time" unit="duration"/>
-    <level _seq="81" _title="Pentomino VI" _xpath="./pento06_1" author="Enigma Team" ctrl="force" easy="false" id="pento6" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="82" _title="Pentomino VII" _xpath="./pento07_1" author="Enigma Team" ctrl="force" easy="false" id="pento7" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="83" _title="Pentomino VIII" _xpath="./pento08_1" author="Enigma Team" ctrl="force" easy="false" id="pento8" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="84" _title="Pentomino IX" _xpath="./pento09_1" author="Enigma Team" ctrl="force" easy="false" id="pento9" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="85" _title="Pentomino X" _xpath="./pento10_1" author="Enigma Team" ctrl="force" easy="false" id="pento10" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="86" _title="Pentomino XI" _xpath="./pento11_1" author="Enigma Team" ctrl="force" easy="false" id="pento11" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="87" _title="Pentomino XII" _xpath="./pento12_1" author="Enigma Team" ctrl="force" easy="false" id="pento12" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="88" _title="Pentomino XIII" _xpath="./pento13_1" author="Enigma Team" ctrl="force" easy="false" id="pento13" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="89" _title="Pentomino XIV" _xpath="./pento14_1" author="Enigma Team" ctrl="force" easy="false" id="pento14" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="90" _title="Pentomino XV" _xpath="./pento15_1" author="Enigma Team" ctrl="force" easy="false" id="pento15" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="91" _title="Pentomino XVI" _xpath="./pento16_1" author="Enigma Team" ctrl="force" easy="false" id="pento16" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="92" _title="2 + 2" _xpath="./devnull11_1" author="/dev/null" ctrl="force" easy="true" id="devnull11" rel="1" rev="6" score="1" target="time" unit="duration"/>
+    <level _seq="81" _title="2 + 2" _xpath="./devnull11_1" author="/dev/null" ctrl="force" easy="true" id="devnull11" rel="1" rev="6" score="1" target="time" unit="duration"/>
+    <level _seq="82" _title="Afraid of water" _xpath="./devnull32_1" author="/dev/null" ctrl="force" easy="true" id="devnull32" rel="1" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="83" _title="Deathbridge" _xpath="./ais01_1" author="Alex Smith" ctrl="force" easy="true" id="20090416ais523003" rel="1" rev="9" score="1" target="time" unit="duration"/>
+    <level _seq="84" _title="Danger Flag" _xpath="./ais02_1" author="Alex Smith" ctrl="force" easy="true" id="20090338ais523002" rel="1" rev="11" score="1" target="time" unit="duration"/>
+    <level _seq="85" _title="Three Times Through" _xpath="./ais03_1" author="Alex Smith" ctrl="force" easy="true" id="20090316ais523001" rel="1" rev="8" score="1" target="time" unit="duration"/>
+    <level _seq="86" _title="From Six To Twenty-Six" _xpath="./ais04_1" author="Alex Smith" ctrl="force" easy="false" id="20090427ais523001" rel="1" rev="8" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Deleted: trunk/data/levels/enigma_viii/pento06_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento06_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento06_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino VI" el:subtitle="2 solutions" el:id="pento6"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%%%%%%#",
-    "%@            !Nesw%",
-    "% +++++       !!!!!%",
-    "% +++++            %",
-    "% +++++  ......... %",
-    "% +++++ ... . . ...#",
-    "% +++++ . ....... .#",
-    "%       ... . . ...#",
-    "%       . ....... .#",
-    "%       ... . . ...#",
-    "%        ......... %",
-    "%                  %",
-    "#%%%%%%%%%%%%%%%%%%#"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"nesw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento07_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento07_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento07_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino VII" el:subtitle="2170 solutions" el:id="pento7"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%%%%%%#",
-    "%@            !Nesw%",
-    "% +++++       !!!!!%",
-    "% +++++    ......  %",
-    "% +++++   ........ %",
-    "% +++++   ........ %",
-    "% +++++   ........ %",
-    "%         ........ %",
-    "%         ........ %",
-    "%         ........ %",
-    "%          ......  %",
-    "%                  %",
-    "#%%%%%%%%%%%%%%%%%%#"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"nesw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento08_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento08_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento08_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino VIII" el:subtitle="64 solutions" el:id="pento8"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%%%%%%#",
-    "%@            !Nesw%",
-    "% +++++       !!!!!%",
-    "% +++++   ... .... %",
-    "% +++++   ........ %",
-    "% +++++   ........ %",
-    "% +++++   .......  %",
-    "%          ....... %",
-    "%         ........ %",
-    "%         ........ %",
-    "%         .... ... %",
-    "%                  %",
-    "#%%%%%%%%%%%%%%%%%%#"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"nesw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento09_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento09_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento09_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino IX" el:subtitle="12 solutions" el:id="pento9"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%%%%%%#",
-    "%@            !Nesw%",
-    "% +++++       !!!!!%",
-    "% +++++   ........ %",
-    "% +++++   ........ %",
-    "% +++++   ........ %",
-    "% +++++   ...  ... %",
-    "%         ...  ... %",
-    "%         ........ %",
-    "%         ........ %",
-    "%         ........ %",
-    "%                  %",
-    "#%%%%%%%%%%%%%%%%%%#"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"nesw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento10_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento10_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento10_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino X" el:subtitle="188 solutions" el:id="pento10"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%%%%%%#",
-    "%@            !Nesw%",
-    "% +++++       !!!!!%",
-    "% +++++   ........ %",
-    "% +++++   . .... . %",
-    "% +++++   ........ %",
-    "% +++++   ........ %",
-    "%         ........ %",
-    "%         ........ %",
-    "%         . .... . %",
-    "%         ........ %",
-    "%                  %",
-    "#%%%%%%%%%%%%%%%%%%#"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"nesw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento11_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento11_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento11_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino XI" el:subtitle="21 solutions" el:id="pento11"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%%%%%%#",
-    "%@            !Nesw%",
-    "% +++++       !!!!!%",
-    "% +++++   ........ %",
-    "% +++++   ........ %",
-    "% +++++   .. .. .. %",
-    "% +++++   ........ %",
-    "%         ........ %",
-    "%         .. .. .. %",
-    "%         ........ %",
-    "%         ........ %",
-    "%                  %",
-    "#%%%%%%%%%%%%%%%%%%#"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"nesw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento12_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento12_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento12_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino XII" el:subtitle="8 solutions" el:id="pento12"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%%%%%%#",
-    "%@            !Nesw%",
-    "% +++++       !!!!!%",
-    "% +++++  ..    ..  %",
-    "% +++++ ...    ... %",
-    "% +++++ .......... %",
-    "% +++++ .......... %",
-    "%       .......... %",
-    "%       .......... %",
-    "%       ...    ... %",
-    "%        ..    ..  %",
-    "%                  %",
-    "#%%%%%%%%%%%%%%%%%%#"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"nesw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento13_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento13_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento13_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,76 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino XIII" el:subtitle="8 solutions" el:id="pento13"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["FollowMethod"] = FOLLOW_SCROLL
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%######",
-    "%@            .....#",
-    "% +++++      ......#",
-    "% +++++      ......#",
-    "% +++++    .....   #",
-    "% +++++   ......   #",
-    "% +++++   ......   #",
-    "%       .....      #",
-    "%      ......      #",
-    "%      ......      #",
-    "%      ...      !!!#",
-    "%      ...      !Ne#",
-    "%      ...      !sw#",
-    "#%%%%%%#############"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"ne","sw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento14_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento14_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento14_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino XIV" el:subtitle="14 solutions" el:id="pento14"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%########",
-    "%@          ...    #",
-    "%           ...    #",
-    "%           ...    #",
-    "% +++++    .....   #",
-    "% +++++ ...........#",
-    "% +++++ ..... .....#",
-    "% +++++ ...........#",
-    "% +++++    .....   #",
-    "%           ... !!!#",
-    "%           ... !Ne#",
-    "%           ... !sw#",
-    "#%%%%%%%%%%%########"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"ne","sw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento15_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento15_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento15_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,73 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino XV" el:subtitle="8 solutions" el:id="pento15"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%%%%%%#",
-    "%@            !N!! %",
-    "%            .!!e!!%",
-    "%           ...!!s!%",
-    "%          .....!!w%",
-    "% +++++   .......!!%",
-    "% +++++  ......... %",
-    "% +++++ ...........#",
-    "% +++++  ......... #",
-    "% +++++   .......  #",
-    "%          .....   #",
-    "%           ...    #",
-    "#%%%%%%%%%%%########"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"n"," e", "  s", "   w"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Deleted: trunk/data/levels/enigma_viii/pento16_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pento16_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/pento16_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -1,76 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected >
-    <el:info el:type="level">
-      <el:identity el:title="Pentomino XVI" el:subtitle="514 solutions" el:id="pento16"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
-      <el:author el:name="Enigma Team" el:email=""/>
-      <el:copyright>Copyright ? 2009 Enigma Team</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libpento" el:id="lib/libpento" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["FollowMethod"] = FOLLOW_SCROLL
-wo["ConserveLevel"] = true
-
-ti[" "] = {"fl_plank"}
-ti["+"] = {"fl_bluegreen", "source#"}
-ti["."] = {"fl_lawn", "target#"}
-ti["#"] = {"st_bluesand", cluster=1}
-ti["%"] = {"st_bluesand", name="oxyd#", cluster=2}
-ti["&"] = {"st_switch", target="pento.next"}
-ti["/"] = {"st_fourswitch", target="pento.rotate"}
-ti["|"] = {"st_switch", target="pento.mirror"}
-ti["*"] = {"st_oxyd"}
-ti["n"] = {"it_puller_n"}
-ti["e"] = {"it_puller_e"}
-ti["s"] = {"it_puller_s"}
-ti["w"] = {"it_puller_w"}
-ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
-ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
-ti["@"] = {"#ac_marble"}
-
-pento = res.pento(ti, "source", "target")
-
-wo(pento, " ", {
-    "##&#/#|#%%%%%%######",
-    "%@            .....#",
-    "% +++++       .....#",
-    "% +++++       .....#",
-    "% +++++       .....#",
-    "% +++++      ..... #",
-    "% +++++      ..... #",
-    "%            ..... #",
-    "%            ..... #",
-    "%           .....  #",
-    "%           .....  #",
-    "%!!!!!      .....  #",
-    "%Nesw!      .....  #",
-    "#%%%%%%%%%%%########"})
-
-wo:add({"ot_timer", interval=0.5, target="check"})
-
-function check(value, sender)
-    if pento.check() then
-        sender.state=OFF
-        wo[no["oxyd#*"]:shuffle():sub(12)] = ti["*"]
-        wo:shuffleOxyd()
-    end
-end
-
-function addpullers()
-    wo:drawMap(ti, no["pullers"], " ", {"nesw"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Modified: trunk/data/levels/enigma_viii/ral32_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/ral32_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/ral32_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -3,7 +3,7 @@
   <el:protected >
     <el:info el:type="level">
       <el:identity el:title="Panelled Puzzle I" el:subtitle="" el:id="20080820ral639"/>
-      <el:version el:score="1" el:release="1" el:revision="$Revision: 166 $" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 177 $" el:status="released"/>
       <el:author  el:name="Ronald Lamprecht" el:email="ral at users.berlios.de"/>
       <el:copyright>Copyright ? 2008,2009 Ronald Lamprecht</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -27,8 +27,7 @@
 ti["trigger"] = {"it_trigger", "tr%%", invisible=true, target="counter", action="signal"}
 
 ti["*"] = {"st_spitter", "spitter", secure=true}
-ti["|"] = {"st_break", "spitter"}
-ti["X"] = {"st_pull", "eastpull"} .. ti{"fl_redslab_framed"} .. ti{"it_trigger", invisible=true, target="endpos"}
+ti["X"] = {"st_pull", "eastpull"} .. ti{"fl_redslab_framed"} .. ti{"it_trigger", invisible=true, target="spitter"}
 ti["S"] = {"st_switch", target="balls"}
 ti["$"] = {"it_extralife"}
 
@@ -86,14 +85,6 @@
     end
 end
 
-function endpos(value)
-    if value then
-        wo[no["spitter"]] = ti["*"]
-    else
-        wo[no["spitter"]] = ti["|"]
-    end
-end
-
 function balls()
     -- we are currently missing an extralife dispenser
     wo:add(YIN, ti["$"]..ti["$"]..ti["$"]..ti["$"]..ti["$"])

Modified: trunk/data/levels/enigma_viii/ral33_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/ral33_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/ral33_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -3,7 +3,7 @@
   <el:protected >
     <el:info el:type="level">
       <el:identity el:title="Panelled Puzzle II" el:subtitle="" el:id="20090308ral237"/>
-      <el:version el:score="1" el:release="1" el:revision="$Revision: 166 $" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision: 177 $" el:status="released"/>
       <el:author  el:name="Ronald Lamprecht" el:email="ral at users.berlios.de"/>
       <el:copyright>Copyright ? 2009 Ronald Lamprecht</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -27,8 +27,7 @@
 ti["trigger"] = {"it_trigger", "tr%%", invisible=true, target="counter", action="signal"}
 
 ti["*"] = {"st_spitter", "spitter", secure=true}
-ti["|"] = {"st_break", "spitter"}
-ti["X"] = {"st_pull", "eastpull"} .. ti{"fl_redslab_framed"} .. ti{"it_trigger", invisible=true, target="endpos"}
+ti["X"] = {"st_pull", "eastpull"} .. ti{"fl_redslab_framed"} .. ti{"it_trigger", invisible=true, target="spitter"}
 ti["S"] = {"st_switch", target="balls"}
 ti["$"] = {"it_extralife"}
 
@@ -92,14 +91,6 @@
     wo[no["tr%"..i]] = {"st_puzzle", connections=connections[perm[i]]}
 end
 
-function endpos(value)
-    if value then
-        wo[no["spitter"]] = ti["*"]
-    else
-        wo[no["spitter"]] = ti["|"]
-    end
-end
-
 function balls()
     -- we are currently missing an extralife dispenser
     wo:add(YIN, ti["$"]..ti["$"]..ti["$"]..ti["$"]..ti["$"])

Modified: trunk/data/levels/enigma_viii/raywick05_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/raywick05_1.xml	2009-05-17 22:44:53 UTC (rev 1675)
+++ trunk/data/levels/enigma_viii/raywick05_1.xml	2009-05-18 17:06:37 UTC (rev 1676)
@@ -3,30 +3,26 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Impulsive Order" el:subtitle="" el:id="raywick5"/>
-      <el:version el:score="1" el:release="1" el:revision="13" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="14" el:status="released"/>
       <el:author  el:name="Ray Wick" el:email=""/>
       <el:copyright>Copyright ? 2008 Ray Wick</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-      </el:compatibility>
+      <el:compatibility el:enigma="1.10"/>
       <el:modes el:easy="true" el:single="true" el:network="false"/>
-      <el:comments>
-      </el:comments>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
       <el:score el:easy="-" el:difficult="-"/>
     </el:info>
     <el:luamain><![CDATA[
 wo["ConserveLevel"] = true
 
-ti["*"] = {"#ac_marble_black"}
-ti["@"] = {"st_oxyd"}
 ti["~"] = {"fl_water"}
 ti["."] = {"fl_swamp"}
+ti["-"] = {"fl_lawn"}
 ti[" "] = {"fl_marble"}
 ti["K"] = {"fl_abyss"}
-ti["#"] = {"st_redbrown"}
-ti["g"] = {"st_rawglass"}
+ti["#"] = {"st_rawglass"}
 ti["G"] = {"st_grate_framed"}
-ti["+"] = {"st_box_wood"}
+ti["+"] = {"st_box"}
 ti["v"] = {"st_oneway", orientation=SOUTH}
 ti[">"] = {"st_oneway", orientation=EAST}
 ti["<"] = {"st_oneway", orientation=WEST}
@@ -35,7 +31,8 @@
 ti["4"] = {"st_stoneimpulse"}
 ti["5"] = {"st_stoneimpulse", name="outer#"}
 ti["L"] = {"st_laser", name="laser1", orientation=SOUTH}
-ti["M"] = {"st_mirror", transparent=true, orientation=0}
+ti["M"] = {"st_mirror", transparent=true, orientation=BACKSLASH}
+ti["N"] = {"st_mirror", transparent=false, orientation=BACKSLASH}
 ti["Z"] = {"st_shogun_sml"}
 ti["x"] = {"it_bomb_black"}
 ti["s"] = ti["G"] .. {"it_spring_keep"}
@@ -45,50 +42,52 @@
 ti["E"] = {"it_trigger", action="toggle", target="laser1"}
 if wo["IsDifficult"] then
     ti["!"] = ti[" "]
-    ti[";"] = ti["."]
+    ti[","] = ti["~"]
 else
     ti["!"] = {"it_extralife"}
-    ti[";"] = {"fl_marble"}
+    ti[","] = ti[" "]
 end
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
 
 wo(ti, " ", {
     "####################",
-    "@.....;;~~~~;;.....@",
-    "#~~~~.~~~~~;;~~~~~.#",
-    "#....;;;....~~.....#",
-    "# ~~~~~~ ~~~~~ ~~~~#",
-    "@                  @",
-    "ggg4g4g4g4g4g4g4g gg",
-    "Lgg+g+g+g+g+g+g+g gg",
-    "Mg x x x x x x x x~g",
-    "Mg x x x x x x x x~@",
-    "Mg x x x x x x x x~g",
-    "#gvgggggggggggggg gg",
-    "ggEgggggg42gggggg gg",
-    "g   g   44 K   GGGGg",
-    "gvgvg  44  5g  g  Gg",
-    "gCgBg 44  44g  g  Gg",
-    "gvgvg 4  44gg  g  Gg",
-    "g g g   44 gg  g  Gg",
-    "g g gz 44  gg*Z4  Gg",
-    "g > g   44 gg  g  Gg",
-    "g < g 4  44gg  g  Gg",
-    "g g g 44  44g  g  Gg",
-    "g g g  44  5g  g  Gg",
-    "gvgvg   44 K   GGGGg",
-    "gCgBggggg42ggggg ggg",
-    "gvgvgggggggggggg ggg",
-    "g                1 @",
-    "ggggggggggggggggggsg",
-    "@!   ~~~~gg~~~~    @",
-    "#    ~~~~gg~~~~    #",
-    "#    ~~~~gg~~~~    #",
-    "#~~~~~~~    ~~~~~~~#",
-    "ggggg~~~    ~~~ggggg",
-    "#~~~~~~~    ~~~~~~~#",
-    "#    ~~~~gg~~~~    #",
-    "@!   ~~~~gg~~~~   !@",
-    "#########gg#########"})
+    "O.....--,,,,--.....O",
+    "#,,,,,.~~~~--,,,,,.#",
+    "#....---.....,.....#",
+    "# ~~~~ ,,,,,,,~~~~ #",
+    "O                  O",
+    "###4#4#4#4#4#4#4# ##",
+    "L##+#+#+#+#+#+#+# ##",
+    "M# x x x x x x x x~#",
+    "M# x x x x x x x x~O",
+    "N# x x x x x x x x~#",
+    "##v############## ##",
+    "##E######42###### ##",
+    "#   #   44 K   GGGG#",
+    "#v#v#  44  5#  #  G#",
+    "#C#B# 44  44#  #  G#",
+    "#v#v# 4  44##  #  G#",
+    "# # #   44 ##  #  G#",
+    "# # #z 44  ##@Z4  G#",
+    "# > #   44 ##  #  G#",
+    "# < # 4  44##  #  G#",
+    "# # # 44  44#  #  G#",
+    "# # #  44  5#  #  G#",
+    "#v#v#   44 K   GGGG#",
+    "#C#B#####42##### ###",
+    "#v#v############ ###",
+    "#                1 O",
+    "##################s#",
+    "O!   ~~~~##~~~~    O",
+    "#    ~~~~##~~~~    #",
+    "#    ~~~~##~~~~    #",
+    "#,,,,~~,    ,~~,,,,#",
+    "#####~~,    ,~~#####",
+    "#,,,,~~,    ,~~,,,,#",
+    "#    ~~~~##~~~~    #",
+    "O!   ~~~~##~~~~   !O",
+    "####################"})
 
 wo:shuffleOxyd()
  ]]></el:luamain>



From ral at mail.berlios.de  Tue May 19 23:54:35 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Tue, 19 May 2009 23:54:35 +0200
Subject: [Enigma-game-svn] r1677 - trunk/doc/reference
Message-ID: <200905192154.n4JLsZst026318@sheep.berlios.de>

Author: ral
Date: 2009-05-19 23:54:28 +0200 (Tue, 19 May 2009)
New Revision: 1677

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
- Chapter 5: fixes and formatting


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-05-18 17:06:37 UTC (rev 1676)
+++ trunk/doc/reference/enigma-ref.texi	2009-05-19 21:54:28 UTC (rev 1677)
@@ -5543,10 +5543,27 @@
 
 For task driven samples @pxref{Object Tasks} and @ref{Attribute Tasks}.
 
+ at menu
+* Object Attribute Access::           Index Operators @samp{[]}
+* Object Messaging::                  Method Operator @samp{:}
+* Object Comparison::                 Equality @samp{==} and Inequality @samp{~=}
+* Object Existence::                  Method @samp{exists()}
+* Object Kill::                       Method @samp{kill()}
+* Object Kind Check::                 Method @samp{kind()} and @samp{is()}
+* Object Coordinate Access::          Index Operators @samp{["x"]}, @samp{["y"]}
+* Object Addition and Subtraction::   Operators @samp{+}, @samp{-}
+* Object Center::                     Operator @samp{#}
+* Object Join::                       Operator @samp{+}
+* Object Intersection::               Operator @samp{*}
+* Object Difference::                 Operator @samp{-}
+* Object Sound::                      Method @samp{sound()}
+ at end menu
 
+ at c ----------------- Object Attribute Access --------------------
+ at node Object Attribute Access
+ at subsection Object Attribute Access
+
 @table @asis
- at item @b{Attribute Access:}
- at table @asis
 @item @b{Syntax:}
 result = @i{obj}["attributename"]
 
@@ -5571,7 +5588,10 @@
 @end example
 @end table
 
- at item @b{Messaging:}
+ at c ----------------- Object Messaging --------------------
+ at node Object Messaging
+ at subsection Object Messaging
+
 @table @asis
 @item @b{Syntax:}
 result = @i{obj}:message("msg", value)
@@ -5592,7 +5612,10 @@
 @end example
 @end table
 
- at item @b{Equality/Inequality:}
+ at c ----------------- Object Comparison --------------------
+ at node Object Comparison
+ at subsection Object Comparison
+
 @table @asis
 @item @b{Syntax:}
 result = @i{obj1} <==|~=> @i{obj2}
@@ -5609,7 +5632,10 @@
 @end example
 @end table
 
- at item @b{Existence:}
+ at c ----------------- Object Existence --------------------
+ at node Object Existence
+ at subsection Object Existence
+
 @table @asis
 @item @b{Syntax:}
 result = - at i{obj}
@@ -5627,7 +5653,10 @@
 @end example
 @end table
 
- at item @b{Kill:}
+ at c ----------------- Object Kill --------------------
+ at node Object Kill
+ at subsection Object Kill
+
 @table @asis
 @item @b{Syntax:}
 @i{obj}:kill()
@@ -5643,7 +5672,10 @@
 @end example
 @end table
 
- at item @b{Kind Checks:}
+ at c ----------------- Object Kind Check --------------------
+ at node Object Kind Check
+ at subsection Object Kind Check
+
 @table @asis
 @item @b{Syntax:}
 result = @i{obj}:is("kind")
@@ -5660,7 +5692,10 @@
 @end example
 @end table
 
- at item @b{Coordinate Access:}
+ at c ----------------- Object Coordinate Access --------------------
+ at node Object Coordinate Access
+ at subsection Object Coordinate Access
+
 @table @asis
 @item @b{Syntax:}
 result = @i{obj}["x"]
@@ -5688,7 +5723,10 @@
 @end example
 @end table
 
- at item @b{Addition/Subtraction:}
+ at c ----------------- Object Addition and Subtraction --------------------
+ at node Object Addition and Subtraction
+ at subsection Object Addition and Subtraction
+
 @table @asis
 @item @b{Syntax:}
 result = @i{obj} <@b{+}|@b{-}> <@i{pos} | @i{obj} | @i{cpos} | @i{polist}>
@@ -5713,7 +5751,10 @@
 @end example
 @end table
 
- at item @b{Center:}
+ at c ----------------- Object Center --------------------
+ at node Object Center
+ at subsection Object Center
+
 @table @asis
 @item @b{Syntax:}
 result = #@i{obj}
@@ -5729,7 +5770,10 @@
 @end example
 @end table
 
- at item @b{Join:}
+ at c ----------------- Object Join --------------------
+ at node Object Join
+ at subsection Object Join
+
 @table @asis
 @item @b{Syntax:}
 result = @i{obj} + @i{group}
@@ -5749,7 +5793,10 @@
 @end example
 @end table
 
- at item @b{Intersection:}
+ at c ----------------- Object Intersection --------------------
+ at node Object Intersection
+ at subsection Object Intersection
+
 @table @asis
 @item @b{Syntax:}
 result = @i{obj} * @i{group}
@@ -5767,7 +5814,10 @@
 @end example
 @end table
 
- at item @b{Difference:}
+ at c ----------------- Object Difference --------------------
+ at node Object Difference
+ at subsection Object Difference
+
 @table @asis
 @item @b{Syntax:}
 result = @i{obj} - @i{group}
@@ -5787,7 +5837,10 @@
 @end example
 @end table
 
- at item @b{Sound:}
+ at c ----------------- Object Sound --------------------
+ at node Object Sound
+ at subsection Object Sound
+
 @table @asis
 @item @b{Syntax:}
 result = @i{obj}:sound("name", volume)
@@ -5802,7 +5855,6 @@
 @var{obj}:@b{sound}("@b{quake}", @var{2})
 @end example
 @end table
- at end table
 
 
 @c ----------------- Group --------------------
@@ -5847,9 +5899,27 @@
 
 For task driven samples @pxref{Group Tasks}.
 
+ at menu
+* Group Messaging::                  Method Operator @samp{:}
+* Group Attribute Write::            Index Operators @samp{[]}
+* Group Comparison::                 Equality @samp{==} and Inequality @samp{~=}
+* Group Length::                     Operator @samp{#}
+* Group Member Access::              Index Operators @samp{[]}
+* Group Loop::                       @samp{for obj in group do ... end}
+* Group Join::                       Operator @samp{+}
+* Group Intersection::               Operator @samp{*}
+* Group Difference::                 Operator @samp{-}
+* Group Shuffle::                    Method @samp{shuffle()}
+* Group Sorting::                    Method @samp{sort()}
+* Group Subset::                     Method @samp{sub()}
+* Group Nearest Object::             Method @samp{nearest()}
+ at end menu
+
+ at c ----------------- Group Messaging --------------------
+ at node Group Messaging
+ at subsection Group Messaging
+
 @table @asis
- at item @b{Messaging:}
- at table @asis
 @item @b{Syntax:}
 result = @i{group}:message("msg", value)
 
@@ -5858,9 +5928,12 @@
 @item @b{Details:}
 Send a message with a given value or @samp{nil} to all objects in the group.
 Every message can be sent directly as a method with the given message name.
-When an object reference is invalid the message is simply ignored. You are
-even allowed to send a @samp{kill()} message to all objects in a group. The
-objects will be killed, but the group remains filled with invalid @samp{NULL}
+When an object reference is invalid the message is simply ignored. The result
+is the return value of the message to the last object in the group, or @samp{nil}
+for an empty group.
+
+You are even allowed to send a @samp{kill()} message to all objects in a group. 
+The objects will be killed, but the group remains filled with invalid @samp{NULL}
 object references.
 
 @item @b{Syntax Samples:}
@@ -5873,7 +5946,10 @@
 @end example
 @end table
 
- at item @b{Attribute Write:}
+ at c ----------------- Group Attribute Write --------------------
+ at node Group Attribute Write
+ at subsection Group Attribute Write
+
 @table @asis
 @item @b{Syntax:}
 @i{group}["attributename"] = value
@@ -5895,7 +5971,10 @@
 @end example
 @end table
 
- at item @b{Equality/Inequality:}
+ at c ----------------- Group Comparison --------------------
+ at node Group Comparison
+ at subsection Group Comparison
+
 @table @asis
 @item @b{Syntax:}
 result = @i{group1} <==|~=> @i{group2}
@@ -5913,7 +5992,10 @@
 @end example
 @end table
 
- at item @b{Length:}
+ at c ----------------- Group Length --------------------
+ at node Group Length
+ at subsection Group Length
+
 @table @asis
 @item @b{Syntax:}
 result = #@i{group}
@@ -5929,7 +6011,10 @@
 @end example
 @end table
 
- at item @b{Member Access:}
+ at c ----------------- Group Member Access --------------------
+ at node Group Member Access
+ at subsection Group Member Access
+
 @table @asis
 @item @b{Syntax:}
 result = @i{group}[@i{index}]
@@ -5959,7 +6044,10 @@
 @end example
 @end table
 
- at item @b{Loop:}
+ at c ----------------- Group Loop --------------------
+ at node Group Loop
+ at subsection Group Loop
+
 @table @asis
 @item @b{Syntax:}
 for @i{obj} in @i{group} do ... end
@@ -5976,7 +6064,10 @@
 @end table
 
 
- at item @b{Join:}
+ at c ----------------- Group Join --------------------
+ at node Group Join
+ at subsection Group Join
+
 @table @asis
 @item @b{Syntax:}
 result = @i{group} + <@i{obj}|@i{group}>
@@ -5996,7 +6087,10 @@
 @end example
 @end table
 
- at item @b{Intersection:}
+ at c ----------------- Group Intersection --------------------
+ at node Group Intersection
+ at subsection Group Intersection
+
 @table @asis
 @item @b{Syntax:}
 result = <@i{obj}|@i{group}> * @i{group}
@@ -6014,7 +6108,10 @@
 @end example
 @end table
 
- at item @b{Difference:}
+ at c ----------------- Group Difference --------------------
+ at node Group Difference
+ at subsection Group Difference
+
 @table @asis
 @item @b{Syntax:}
 result = <@i{obj}|@i{group}> - @i{group}
@@ -6033,7 +6130,10 @@
 @end example
 @end table
 
- at item @b{Shuffle:}
+ at c ----------------- Group Shuffle --------------------
+ at node Group Shuffle
+ at subsection Group Shuffle
+
 @table @asis
 @item @b{Syntax:}
 result = @i{group}:shuffle()
@@ -6049,7 +6149,10 @@
 @end example
 @end table
 
- at item @b{Sorting:}
+ at c ----------------- Group Sorting --------------------
+ at node Group Sorting
+ at subsection Group Sorting
+
 @table @asis
 @item @b{Syntax:}
 result = @i{group}:sort("circular")
@@ -6081,7 +6184,10 @@
 @end example
 @end table
 
- at item @b{Subset:}
+ at c ----------------- Group Subset --------------------
+ at node Group Subset
+ at subsection Group Subset
+
 @table @asis
 @item @b{Syntax:}
 result = @i{group}:sub(@i{number})
@@ -6118,7 +6224,10 @@
 @end example
 @end table
 
- at item @b{Nearest Object:}
+ at c ----------------- Group Nearest Object --------------------
+ at node Group Nearest Object
+ at subsection Group Nearest Object
+
 @table @asis
 @item @b{Syntax:}
 result = @i{group}:nearest(@i{obj})
@@ -6131,13 +6240,11 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{newobject} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}):sub(@var{obj4})
+ at var{newobject} = @i{grp}(@var{obj1}, @var{obj2}, @var{obj3}):nearest(@var{obj4})
 @end example
 @end table
 
- at end table
 
-
 @c ----------------- NamedObjects --------------------
 
 @node NamedObjects
@@ -6151,9 +6258,15 @@
 Being a singleton you can not create new NamedObjets. The singleton is stored
 at the global variable @samp{no} on level load.
 
- at table @asis
+ at menu
+* NamedObjects Repository Request::  Index Operator @samp{[]} read
+* NamedObjects Object Naming::       Index Operator @samp{[]} write
+ at end menu
 
- at item @b{Repository Request:}
+ at c ----------------- NamedObjects Repository Request --------------------
+ at node NamedObjects Repository Request
+ at subsection NamedObjects Repository Request
+
 @table @asis
 @item @b{Syntax:}
 result = no["@i{name}"]
@@ -6166,8 +6279,8 @@
 
 If the requested name contains a wildcard character, either an asterix @samp{*}
 or a question mark @samp{?}, a @ref{Group} containing all objects with matching
-names is returned. An asterix matches one or several arbitrary characters. A
-question mark matches a single arbitrary character. Both wildcard charchters
+names is returned. An asterix matches zero, one or several arbitrary characters. 
+A question mark matches a single arbitrary character. Both wildcard charchters
 can be used anywhere in the string and in arbitrary multiplicity. Anyway the
 result is always returned as a @ref{Group}. The group may contain multiple
 objects, just a single object, or even no objects at all when no existing object
@@ -6182,7 +6295,10 @@
 @end example
 @end table
 
- at item @b{Object Naming:}
+ at c ----------------- NamedObjects Object Naming --------------------
+ at node NamedObjects Object Naming
+ at subsection NamedObjects Object Naming
+
 @table @asis
 @item @b{Syntax:}
 no["@i{name}"] = @i{obj}
@@ -6199,18 +6315,16 @@
 @end example
 @end table
 
- at end table
 
-
 @c ----------------- PositionList --------------------
 
 @node PositionList
 @section PositionList
 
-A PositionList is a sorted set of @ref{Position}s. Like a @ref{Group} this
-container is a constant datatype, that can not be modified. But you can easily
-compose new position lists by concatenation of existing lists and single 
-positions.
+A PositionList is a sorted set, known as list, of @ref{Position}s. Like a 
+ at ref{Group} this container is a constant datatype, that can not be modified. But
+you can easily compose new position lists by concatenation of existing lists and
+single positions.
 
 An important difference to a group is the ability of a position list to store
 a position multiple times at different locations in its sequence. Thus a
@@ -6223,7 +6337,7 @@
 
 You can easily transform a group into a position list by the @ref{Positions Repository} 
 singleton by the simple expression @samp{po(group)}. And you can retrieve all
- at ref{Position}s of a basic object kind located along a position list path by
+ at ref{Object}s of a basic kind located along a position list path by
 @ref{Functions} like @samp{st(polist)}, @samp{it(polist)} and @samp{fl(polist)}.
 
 As a unique floor object is guaranteed to be on every grid position, you can
@@ -6243,9 +6357,19 @@
 
 For task driven samples @pxref{Named Positions Tasks}. 
 
+ at menu
+* PositionList Length::              Operator @samp{#}
+* PositionList Member Access::       Index Operators @samp{[]}
+* PositionList Concatenation::       Operator @samp{..}
+* PositionList Translation::         Operators @samp{+} and @samp{-}
+* PositionList Stretching::          Operators @samp{*} and @samp{/}
+ at end menu
+
+ at c ----------------- PositionList Length --------------------
+ at node PositionList Length
+ at subsection PositionList Length
+
 @table @asis
- at item @b{Length:}
- at table @asis
 @item @b{Syntax:}
 result = #@i{polist}
 
@@ -6259,7 +6383,10 @@
 @end example
 @end table
 
- at item @b{Member Access:}
+ at c ----------------- PositionList Member Access --------------------
+ at node PositionList Member Access
+ at subsection PositionList Member Access
+
 @table @asis
 @item @b{Syntax:}
 result = @i{group}[@i{index}]
@@ -6280,7 +6407,10 @@
 @end example
 @end table
 
- at item @b{Concatenation:}
+ at c ----------------- PositionList Concatenation --------------------
+ at node PositionList Concatenation
+ at subsection PositionList Concatenation
+
 @table @asis
 @item @b{Syntax:}
 result = @i{polist1} .. <@i{pos} | @i{polist2}> 
@@ -6299,7 +6429,10 @@
 @end example
 @end table
 
- at item @b{Translation:}
+ at c ----------------- PositionList Translation --------------------
+ at node PositionList Translation
+ at subsection PositionList Translation
+
 @table @asis
 @item @b{Syntax:}
 result = @i{polist} <@b{+}|@b{-}> <@i{pos} | @i{obj} | @i{cpos}>
@@ -6319,7 +6452,10 @@
 @end example
 @end table
 
- at item @b{Stretching:}
+ at c ----------------- PositionList Stretching --------------------
+ at node PositionList Stretching
+ at subsection PositionList Stretching
+
 @table @asis
 @item @b{Syntax:}
 result = @i{polist} @b{*} @i{number}
@@ -6333,14 +6469,12 @@
 
 @item @b{Syntax Samples:}
 @example
- at var{newpolist} = @var{2} * @var{NEIGHBORS_4}       -- = po(9, 12)
+ at var{newpolist} = @var{2} * @var{NEIGHBORS_4}              -- = po(9, 12)
 @var{newpolist} = (@i{po}(@var{2}, at var{4}) .. @i{po}(@var{6}, at var{7})) * @var{1/2}   -- = (1, 2), (3, 3.5)
 @end example
 @end table
 
- at end table
 
-
 @c ----------------- Positions Repository --------------------
 
 @node Positions Repository
@@ -6350,8 +6484,8 @@
 repository of named positions. Besides the management of named positions it
 provides useful conversions of other datatypes to position based types.
 
-Being a singleton you can not create new Positions. The singleton is stored
-at the global variable @samp{po} on level load.
+Being a singleton you can not create a new Positions Repository. The singleton
+that is available on level load is stored at the global variable @samp{po}.
 
 The position repository is an extension of the @ref{NamedObjects} repository.
 Whenever you name an object, @xref{Object Naming}, this repository registers
@@ -6363,9 +6497,17 @@
 
 For task driven samples @pxref{Named Positions Tasks}. 
 
- at table @asis
+ at menu
+* Positions Repository Request::  Index Operator @samp{[]} read
+* Positions Repository Storage::  Index Operator @samp{[]} write
+* Position Convertion::           Function @samp{po()}
+* PositionList Convertion::       Function @samp{po()}
+ at end menu
 
- at item @b{Repository Request:}
+ at c ----------------- Positions Repository Request --------------------
+ at node Positions Repository Request
+ at subsection Positions Repository Request
+
 @table @asis
 @item @b{Syntax:}
 result = po["@i{name}"]
@@ -6379,7 +6521,7 @@
 
 If the requested name contains a wildcard character, either an asterix @samp{*}
 or a question mark @samp{?}, a @ref{PositionList} containing all positions with
-matching names is returned. An asterix matches one or several arbitrary 
+matching names is returned. An asterix matches zero, one or several arbitrary 
 characters. A question mark matches a single arbitrary character. Both wildcard
 charchters can be used anywhere in the string and in arbitrary multiplicity.
 Anyway the result is always returned as a @ref{PositionList}. The list may
@@ -6395,7 +6537,10 @@
 @end example
 @end table
 
- at item @b{Repository Storage:}
+ at c ----------------- Positions Repository Storage --------------------
+ at node Positions Repository Storage
+ at subsection Positions Repository Storage
+
 @table @asis
 @item @b{Syntax:}
 po["@i{name}"] = @i{obj}
@@ -6411,10 +6556,13 @@
 @end example
 @end table
 
- at item @b{Position Convertion:}
+ at c ----------------- Position Convertion --------------------
+ at node Position Convertion
+ at subsection Position Convertion
+
 @table @asis
 @item @b{Syntax:}
-result = po(<@i{obj}|@i{pos}|@{@var{x}, @var{y}@}|@var{x}, @var{y})
+result = po(<@i{obj} | @i{pos} | @{@var{x}, @var{y}@} | @var{x}, @var{y} >)
 
 @item @b{Details:}
 Converts its argument to a new position value.
@@ -6428,7 +6576,10 @@
 @end example
 @end table
 
- at item @b{PositionList Convertion:}
+ at c ----------------- PositionList Convertion --------------------
+ at node PositionList Convertion
+ at subsection PositionList Convertion
+
 @table @asis
 @item @b{Syntax:}
 result = po(@i{group})
@@ -6443,8 +6594,6 @@
 @end example
 @end table
 
- at end table
-
 @c ----------------- Tile and Object Declaration --------------------
 
 @node Tile and Object Declaration
@@ -20479,7 +20628,7 @@
 can even be direction dependent. This allows you to use window panes on either
 side of a connection or to use oneways for your connections, too. These passages
 from one cell to another are the edges of our graph and as they may be directed
-we have a directed graph. But for most mazed the support of directions is 
+we have a directed graph. But for most mazes the support of directions is 
 irrelevant and transparent, and you do not really need to know anything about
 graphs at all. Thus we called the resolver just a maze resolver.
 



From ral at mail.berlios.de  Sat May 23 01:04:49 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sat, 23 May 2009 01:04:49 +0200
Subject: [Enigma-game-svn] r1678 - in trunk: data data/gfx32 data/gfx40
	data/gfx48 data/levels/lib data/schemas src src/stones
Message-ID: <200905222304.n4MN4nSG030699@sheep.berlios.de>

Author: ral
Date: 2009-05-23 01:04:42 +0200 (Sat, 23 May 2009)
New Revision: 1678

Added:
   trunk/data/gfx32/it_death.png
   trunk/data/gfx32/st_death.png
   trunk/data/gfx32/st_death_light.png
   trunk/data/gfx40/it_death.png
   trunk/data/gfx40/st_death.png
   trunk/data/gfx40/st_death_light.png
   trunk/data/gfx48/it_death.png
   trunk/data/gfx48/st_death.png
   trunk/data/gfx48/st_death_light.png
Removed:
   trunk/data/gfx32/it-death.png
   trunk/data/gfx32/st-death.png
   trunk/data/gfx40/it-death.png
   trunk/data/gfx40/st-death.png
   trunk/data/gfx48/it-death.png
   trunk/data/gfx48/st-death.png
Modified:
   trunk/data/levels/lib/libmaze_2.xml
   trunk/data/models-2d.lua
   trunk/data/schemas/objects.xml
   trunk/src/lua.cc
   trunk/src/stones.hh
   trunk/src/stones/DeathStone.cc
   trunk/src/stones/DeathStone.hh
Log:
Trunk 1.1:
- st_death add new subkind "st_death_movable":
  - can be pushed by protected and death proven actors, per wire and all
    stoneimpulses like rotator, lightpassenger,...
  - new attribute "interval", default 10 seconds, defines the average time
    interval between two animations - this allows user to locate movable death,
    value of 0.0 switches the anim off
  - movable death will show in lighter gray when seen through glasses.
  - death can be moved by pushing st_boulder, too
- identify Lua datatypes "default", "maze" and "cell"

Deleted: trunk/data/gfx32/it-death.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/it_death.png (from rev 1677, trunk/data/gfx32/it-death.png)

Deleted: trunk/data/gfx32/st-death.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/st_death.png (from rev 1677, trunk/data/gfx32/st-death.png)

Added: trunk/data/gfx32/st_death_light.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_death_light.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Deleted: trunk/data/gfx40/it-death.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/it_death.png (from rev 1677, trunk/data/gfx40/it-death.png)

Deleted: trunk/data/gfx40/st-death.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/st_death.png (from rev 1677, trunk/data/gfx40/st-death.png)

Added: trunk/data/gfx40/st_death_light.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_death_light.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Deleted: trunk/data/gfx48/it-death.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/it_death.png (from rev 1677, trunk/data/gfx48/it-death.png)

Deleted: trunk/data/gfx48/st-death.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/st_death.png (from rev 1677, trunk/data/gfx48/st-death.png)

Added: trunk/data/gfx48/st_death_light.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_death_light.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/levels/lib/libmaze_2.xml
===================================================================
--- trunk/data/levels/lib/libmaze_2.xml	2009-05-19 21:54:28 UTC (rev 1677)
+++ trunk/data/levels/lib/libmaze_2.xml	2009-05-22 23:04:42 UTC (rev 1678)
@@ -76,6 +76,7 @@
             maze:renderer(context.renderer_args)
         end
     setmetatable(context,{
+          _type = "maze",
           __index = function (context, key)
                   if type(key) == "number" and key >= 99 then
                       return rawget(context, "cells")[key]
@@ -89,7 +90,7 @@
               end,
           __newindex = function (context, key, value)
                   if type(key) == "number" and key >= 100 then
-                      assert_type(value, "maze value (illegal set)", 2, "table")
+                      assert_type(value, "maze value (illegal set)", 2, "cell")
                       local cellmeta = getmetatable(value)
                       assert_bool(cellmeta ~= nil and cellmeta.maze == context, "Maze expected unassigned cell set but got something else")
                       local cells = rawget(context, "cells")
@@ -119,6 +120,7 @@
               end
         })
     context.cellmeta = {
+          _type = "cell",
           __index = function (cell, key)
                   if type(key) == "number" then
                       return rawget(cell, key)

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-19 21:54:28 UTC (rev 1677)
+++ trunk/data/models-2d.lua	2009-05-22 23:04:42 UTC (rev 1678)
@@ -661,9 +661,9 @@
 
 end
 
--- it-death --
+-- it_death --
 do
-    local images = DefSubimages("it-death", {h=4})
+    local images = DefSubimages("it_death", {h=4})
     DefAlias("it_death", images[1])
     DefAnim("it_death_anim", BuildFrames(images, 100))
 end
@@ -987,9 +987,10 @@
     DefTiles("st-disco", {"st_disco0","st_disco1","st_disco2"})
 end
 
--- st-death --
+-- st_death --
 do
-    DefRoundStoneWithAnim ("st-death", 3, 140)
+    DefRoundStoneWithAnim ("st_death", 3, 140)
+    DefRoundStoneWithAnim ("st_death_light", 3, 140)
 end
 
 -- st_yinyang --
@@ -1852,7 +1853,7 @@
 -- Invisible stones --
 do
     DefAlias("st-actorimpulse_invisible", "invisible")
-    DefAlias("st-death_invisible", "invisible")
+    DefAlias("st_death_invisible", "invisible")
     DefAlias("st_invisible", "invisible")
 end
 

Modified: trunk/data/schemas/objects.xml
===================================================================
--- trunk/data/schemas/objects.xml	2009-05-19 21:54:28 UTC (rev 1677)
+++ trunk/data/schemas/objects.xml	2009-05-22 23:04:42 UTC (rev 1678)
@@ -1218,11 +1218,15 @@
     </object>
     <object name="st_death">
       <attr name="invisible"/>
+      <attr name="interval" default="10"/>
       <msg name="_model_reanimated"/>
     </object>
     <object name="st_death_invisible">
       <attr name="invisible" value="true"/>
     </object>
+    <object name="st_death_movable">
+      <attr name="movable" value="true"/>
+    </object>
     <object name="st_disco">
       <msg name="lighten"/>
       <msg name="darken"/>

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2009-05-19 21:54:28 UTC (rev 1677)
+++ trunk/src/lua.cc	2009-05-22 23:04:42 UTC (rev 1678)
@@ -213,6 +213,7 @@
     else if (is_group(L, -1)) type = "group";
     else if (is_world(L, -1)) type = "world";
     else if (is_polist(L, -1)) type = "polist";
+    else if (is_default(L, -1)) type = "default";
     
     lua_pushstring(L, type.c_str());
     return 1;

Modified: trunk/src/stones/DeathStone.cc
===================================================================
--- trunk/src/stones/DeathStone.cc	2009-05-19 21:54:28 UTC (rev 1677)
+++ trunk/src/stones/DeathStone.cc	2009-05-22 23:04:42 UTC (rev 1678)
@@ -21,16 +21,22 @@
 #include "stones/DeathStone.hh"
 
 #include "items/GlassesItem.hh"
-//#include "main.hh"
+#include "main.hh"
 
 namespace enigma {
-    DeathStone::DeathStone(bool isInvisible) : Stone () {
+    DeathStone::DeathStone(bool isInvisible, bool isMovable) : Stone () {
         if (isInvisible)
             objFlags |= OBJBIT_INVISIBLE;
+        if (isMovable)
+            objFlags |= OBJBIT_MOVABLE;
             
         state = IDLE;
     }
 
+    DeathStone::~DeathStone() {
+        GameTimer.remove_alarm(this);
+    }
+    
     std::string DeathStone::getClass() const {
         return "st_death";
     }
@@ -43,6 +49,20 @@
                 if (isDisplayable())
                     init_model();
             }
+            if ((objFlags & OBJBIT_INVISIBLE) && (objFlags & OBJBIT_INVISIBLE))
+                objFlags &= ~OBJBIT_MOVABLE;    // there is no invisible movable death
+        } else if (key == "movable") {
+            GameTimer.remove_alarm(this);
+            if (val.to_bool()) {
+                objFlags |= OBJBIT_MOVABLE;
+                if (objFlags & OBJBIT_INVISIBLE)  // there is no invisible movable death
+                    objFlags &= ~OBJBIT_INVISIBLE;
+                if (isDisplayable())
+                    setAlarm();
+            } else
+                objFlags &= ~OBJBIT_MOVABLE;
+            if (isDisplayable())
+                init_model();
         } else
             Stone::setAttr(key, val);
     }
@@ -50,6 +70,8 @@
     Value DeathStone::getAttr(const std::string &key) const {
         if (key == "invisible") {
             return (objFlags & OBJBIT_INVISIBLE) != 0;
+        } else if (key == "movable") {
+            return (bool)(objFlags & OBJBIT_MOVABLE);
         } else
             return Stone::getAttr(key);
     }
@@ -59,8 +81,16 @@
             state = IDLE;   // reset any running anim, be ready to bump again on new grid
             init_model();   // visibility might have changed
         } else if (m.message == "_glasses") {
-            init_model();
+            if (state == IDLE)   // avoid restart of animations
+                init_model();
             return Value();
+        } else if (m.message == "_trigger" && !m.value.to_bool()) {
+            Direction incoming = NODIR;
+            if (m.sender != NULL)
+                incoming = direction_fromto(dynamic_cast<GridObject *>(m.sender)->get_pos(), get_pos());
+            if (incoming != NODIR)
+                move_stone(incoming);
+            return Value();
         }
         return Stone::message(m);
     }
@@ -76,12 +106,32 @@
         if (state == IDLE) {
             if ((objFlags & OBJBIT_INVISIBLE) && ((server::GlassesVisibility & Glasses::DEATH) == 0))
                 set_model("invisible");
+            else if ((objFlags & OBJBIT_MOVABLE) && ((server::GlassesVisibility & Glasses::DEATH) != 0))
+                set_model("st_death_light");
             else
-                set_model("st-death");
+                set_model("st_death");
+        } else {
+            if ((objFlags & OBJBIT_MOVABLE) && ((server::GlassesVisibility & Glasses::DEATH) != 0))
+                set_anim("st_death_light-anim");
+            else
+                set_anim("st_death-anim");
         }
         // PULSING anim is always visible and should continue independent on init_model calls
     }
     
+    void DeathStone::on_creation (GridPos p) {
+        if (objFlags & OBJBIT_MOVABLE)
+            setAlarm();
+
+        Stone::on_creation(p);    // init the model
+    }
+    
+    void DeathStone::on_removal(GridPos p) {
+        if (objFlags & OBJBIT_MOVABLE)
+            GameTimer.remove_alarm(this);
+        Stone::on_removal(p);
+    }
+    
     void DeathStone::animcb() {
         if (state == PULSING) {
             state = IDLE;
@@ -90,31 +140,49 @@
     }
     
     void DeathStone::actor_hit(const StoneContact &sc) {
+        actor_touch(sc);
+        Stone::actor_hit(sc);
+    }
+
+    void DeathStone::actor_touch(const StoneContact &sc) {
+        // even a slight touch should shatter the actor: 
         SendMessage(sc.actor, "_shatter");
         if (state == IDLE) {
             state = PULSING;
-            set_anim("st-death-anim");
+            init_model();
         }
     }
+    
+    void DeathStone::alarm() {
+        if (state == IDLE) {
+            state = PULSING;
+            init_model();
+        }
+        setAlarm();
+    }
 
-    void DeathStone::actor_touch(const StoneContact &sc) {
-        // even a slight touch should shatter the actor: 
-         actor_hit(sc);
+    void DeathStone::setAlarm() {
+        double dt = (double)getAttr("interval");
+        if (dt > 0) {
+            dt *= DoubleRand(0.8, 1.2);
+            GameTimer.set_alarm(this, dt, false);
+        }
     }
-
+    
     int DeathStone::traitsIdx() const {
-        return (objFlags & OBJBIT_INVISIBLE) ? 1 : 0;
+        return (objFlags & OBJBIT_INVISIBLE) ? 1 : ((objFlags & OBJBIT_MOVABLE) ? 2 : 0);
     }
-
     
-    StoneTraits DeathStone::traits[2] = {
+    StoneTraits DeathStone::traits[3] = {
         {"st_death", st_death, stf_none, material_stone, 1.0, MOVABLE_PERSISTENT},
         {"st_death_invisible", st_death_invisible, stf_none, material_stone, 1.0, MOVABLE_PERSISTENT},
+        {"st_death_movable", st_death_movable, stf_none, material_stone, 1.0, MOVABLE_STANDARD},
     };
     
     BOOT_REGISTER_START
         BootRegister(new DeathStone(false), "st_death");
         BootRegister(new DeathStone(true), "st_death_invisible");
+        BootRegister(new DeathStone(false, true), "st_death_movable");
     BOOT_REGISTER_END
 
 } // namespace enigma

Modified: trunk/src/stones/DeathStone.hh
===================================================================
--- trunk/src/stones/DeathStone.hh	2009-05-19 21:54:28 UTC (rev 1677)
+++ trunk/src/stones/DeathStone.hh	2009-05-22 23:04:42 UTC (rev 1678)
@@ -29,9 +29,9 @@
     /** 
      * 
      */
-    class DeathStone : public Stone {
+    class DeathStone : public Stone, public TimeHandler {
         CLONEOBJ(DeathStone);
-        DECL_TRAITS_ARRAY(2, traitsIdx());
+        DECL_TRAITS_ARRAY(3, traitsIdx());
     private:
         enum iState {
             IDLE,     ///< 
@@ -40,9 +40,11 @@
         
         enum ObjectPrivatFlagsBits {
             OBJBIT_INVISIBLE   =   1<<24,  ///< Object is invisible 
+            OBJBIT_MOVABLE     =   1<<25,  ///< Object is movable 
         };
     public:
-        DeathStone(bool isInvisible);
+        DeathStone(bool isInvisible, bool isMovable =false);
+        ~DeathStone();
         
         // Object interface
         virtual std::string getClass() const;
@@ -55,6 +57,8 @@
 
         // GridObject interface
         virtual void init_model();
+        virtual void on_creation(GridPos p);
+        virtual void on_removal(GridPos p);
         
         // ModelCallback interface
         virtual void animcb();
@@ -63,7 +67,11 @@
         virtual void actor_hit(const StoneContact &sc);
         virtual void actor_touch (const StoneContact &sc);
 
+        // TimeHandler interface
+        virtual void alarm();
+
     private:
+        void setAlarm();
         int traitsIdx() const;
     };
 

Modified: trunk/src/stones.hh
===================================================================
--- trunk/src/stones.hh	2009-05-19 21:54:28 UTC (rev 1677)
+++ trunk/src/stones.hh	2009-05-22 23:04:42 UTC (rev 1678)
@@ -57,6 +57,7 @@
         st_coinslot,
         st_death,
         st_death_invisible,
+        st_death_movable,
         st_disco,
         st_dispenser,
         st_door,



From ral at mail.berlios.de  Sat May 23 01:25:36 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sat, 23 May 2009 01:25:36 +0200
Subject: [Enigma-game-svn] r1679 - team_levelpacks/team_test_new_api
Message-ID: <200905222325.n4MNPaIZ023991@sheep.berlios.de>

Author: ral
Date: 2009-05-23 01:25:27 +0200 (Sat, 23 May 2009)
New Revision: 1679

Added:
   team_levelpacks/team_test_new_api/ralT087_1.xml
Modified:
   team_levelpacks/team_test_new_api/ralT084_1.xml
   team_levelpacks/team_test_new_api/ralT085_1.xml
   team_levelpacks/team_test_new_api/ralT086_1.xml
Log:
Test Level new API:
- new st_death_movable test level


Modified: team_levelpacks/team_test_new_api/ralT084_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT084_1.xml	2009-05-22 23:04:42 UTC (rev 1678)
+++ team_levelpacks/team_test_new_api/ralT084_1.xml	2009-05-22 23:25:27 UTC (rev 1679)
@@ -78,7 +78,7 @@
         "                                           ...............         ",
         "                                           ...............         ",
         "                                           .....  .  .....         ",
-        "                                           .....     .....         ",
+        "                                           ......    .....         ",
         "                                           ......   ......         ",
         "                                           .....     .....         ",
         "        c                                  .....  .  .....         ",

Modified: team_levelpacks/team_test_new_api/ralT085_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT085_1.xml	2009-05-22 23:04:42 UTC (rev 1678)
+++ team_levelpacks/team_test_new_api/ralT085_1.xml	2009-05-22 23:25:27 UTC (rev 1679)
@@ -54,8 +54,8 @@
     "                                                                "
 })
 
+print("mymaze of type - "..etype(mymaze))
 
-
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Modified: team_levelpacks/team_test_new_api/ralT086_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT086_1.xml	2009-05-22 23:04:42 UTC (rev 1678)
+++ team_levelpacks/team_test_new_api/ralT086_1.xml	2009-05-22 23:25:27 UTC (rev 1679)
@@ -68,6 +68,7 @@
 })
 wo:add({"ot_wire", anchor1="wireice", anchor2="wireswap"})
 
+print("Default = "..etype(DEFAULT))
   ]]></el:luamain>
     <el:i18n>
 	 <el:string el:key="title">

Added: team_levelpacks/team_test_new_api/ralT087_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT087_1.xml	2009-05-22 23:04:42 UTC (rev 1678)
+++ team_levelpacks/team_test_new_api/ralT087_1.xml	2009-05-22 23:25:27 UTC (rev 1679)
@@ -0,0 +1,65 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Test Death new API" el:subtitle="" el:id="20090522ral127"/>
+      <el:version el:score="1" el:release="1" el:revision="$Revision$" el:status="experimental"/>
+      <el:author  el:name="Ronald Lamprecht" el:email="ral at users.berlios.de"/>
+      <el:copyright>Copyright ? 2008 Ronald Lamprecht</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+
+wo["ConserveLevel"] = true
+wo["ExtralifeGlasses"] = SPOT_DEATH + SPOT_LIGHTPASSENGER
+
+ti[" "] = {"fl_sahara"}
+ti["D"] = {"st_death"}
+ti["!"] = {"st_death_invisible"}
+ti["M"] = {"st_death_movable", interval=5}
+ti["m"] = {"st_death_movable", "md"}
+ti["S"] = {"st_swap", "swap"}
+ti["R"] = {"st_rotator", movable=true}
+ti["W"] = {"st_box"}
+ti["B"] = {"st_boulder_w"}
+
+ti["G"] = {"it_glasses"}
+
+
+ti["b"] = {"it_bag"}
+ti["@"] = {"#ac_marble_black"} .. ti{"it_magicwand"}
+ti["o"] = {"#ac_bug"}
+
+w, h = wo(ti, " ", {
+"!!!   DDD           ",
+"                    ",
+"  D            M    ",
+"  M                 ",
+"  D      o       R  ",
+"  D                 ",
+"  M  b   @  G       ",
+"  D                 ",
+"      m             ",
+"          S         ",
+"                    ",
+"B             W     ",
+"                    "
+})
+
+
+wo:add({"ot_wire", anchor1="swap", anchor2="md"})
+  ]]></el:luamain>
+    <el:i18n>
+	 <el:string el:key="title">
+	   <el:english el:translate="false"/>
+	 </el:string>
+   </el:i18n>
+  </el:protected>
+</el:level>
+


Property changes on: team_levelpacks/team_test_new_api/ralT087_1.xml
___________________________________________________________________
Name: svn:keywords
   + Revision
Name: svn:eol-style
   + native



From raoul at mail.berlios.de  Sat May 23 14:10:06 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 23 May 2009 14:10:06 +0200
Subject: [Enigma-game-svn] r1680 - in trunk/data: gfx32 gfx40
Message-ID: <200905231210.n4NCA6Nu005226@sheep.berlios.de>

Author: raoul
Date: 2009-05-23 14:10:05 +0200 (Sat, 23 May 2009)
New Revision: 1680

Removed:
   trunk/data/gfx32/st-puzzle.png
   trunk/data/gfx40/st-puzzle.png
Log:
-> Remove unused old puzzle gfx



Deleted: trunk/data/gfx32/st-puzzle.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-puzzle.png
===================================================================
(Binary files differ)



From andreasl at mail.berlios.de  Sat May 23 23:53:31 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Sat, 23 May 2009 23:53:31 +0200
Subject: [Enigma-game-svn] r1681 - trunk/doc/reference
Message-ID: <200905232153.n4NLrVKp006541@sheep.berlios.de>

Author: andreasl
Date: 2009-05-23 23:53:28 +0200 (Sat, 23 May 2009)
New Revision: 1681

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Refman (trunk):
 - Typos
 - Freeze Checking:
    - Updated and moved to other chapter.
    - Added short descriptions of attribute "freeze_check (floor)".
    - Added attribute "freeze_check (stone)".
    - Added "burnable"-attribute defaults of floors (and "noash"-default of "fl_abyss").
 - Fire Spreading:
    - Updated and moved to other chapter ("Heat-Transformation" gets an own subsection).
    - Added short descriptions of fire-related floor-attributes.


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-05-23 12:10:05 UTC (rev 1680)
+++ trunk/doc/reference/enigma-ref.texi	2009-05-23 21:53:28 UTC (rev 1681)
@@ -3368,8 +3368,8 @@
 is called whenever the action is triggered.
 
 @example
-@{st_switch, target="my_magic", action="callback"@}
-@{st_switch, target="my_magic"@}
+@{"st_switch", target="my_magic", action="callback"@}
+@{"st_switch", target="my_magic"@}
 @end example
 
 The @samp{target} is the name of the function as a string. You may set the
@@ -3383,7 +3383,7 @@
 
 @example
 function my_magic(value, sender)
-    if value == true
+    if value == true then
         wo[sender + @{1,0@}] = @{"it_coin_s"@}
     end
 end
@@ -9194,7 +9194,7 @@
 * force_x::                 Constant Force
 * force_y::                 Constant Force
 * fragility (floor)::       Crack 
-* freeze_check::            -
+* freeze_check (floor)::    Freeze Checking
 * friction (floor)::        Decelerating friction force factor
 * ignitable::               -
 * indestructible::          System Flag for destruction resistence 
@@ -9226,7 +9226,8 @@
 @node burnable
 @subsection burnable
 
- at xref{Fire Spreading} for details.
+Determines whether the floor starts to burn when a fire is nearby and the item
+on the floor allows it to burn. @xref{Fire Spreading} for details.
 
 @table @asis
 @item @b{Type:} @ @ boolean
@@ -9239,7 +9240,8 @@
 @node eternal
 @subsection eternal
 
- at xref{Fire Spreading} for details.
+Determines whether a fire keeps on burning unlimited, until an external cause
+stops it. @xref{Fire Spreading} for details.
 
 @table @asis
 @item @b{Type:} @ @ boolean
@@ -9270,7 +9272,9 @@
 @node fastfire
 @subsection fastfire
 
- at xref{Flood Spreading} for details.
+When set to @code{true}, fire will spread faster than usual, with the same
+speed as if @ref{it_burnable}[_oil] would be on it. @xref{Flood Spreading} for
+details.
 
 @table @asis
 @item @b{Type:} @ @ boolean
@@ -9341,10 +9345,12 @@
 @end table
 
 @c ----------------- freeze_check --------------------
- at node freeze_check
- at subsection freeze_check
+ at node freeze_check (floor)
+ at subsection freeze_check (floor)
 
- at xref{Freeze Checking} for details.
+If @code{true}, allows for @ref{Freeze Checking} on this floor tile. Note that
+Freeze Checking only works with those (movable) stones that have additionally set
+ at code{freeze_check = true} on their own, see @ref{freeze_check (stone)}.
 
 @table @asis
 @item @b{Type:} @ @ boolean
@@ -9370,7 +9376,8 @@
 @node ignitable
 @subsection ignitable
 
- at xref{Fire Spreading} for details.
+When @code{true}, and the item on the floor allows it to burn, it will start
+burning on nearby explosions. @xref{Fire Spreading} for details.
 
 @table @asis
 @item @b{Type:} @ @ boolean
@@ -9399,7 +9406,8 @@
 @node initfire
 @subsection initfire
 
- at xref{Fire Spreading} for details.
+When set to @code{true}, the floor will start to burn after level
+initialization. @xref{Fire Spreading} for details.
 
 @table @asis
 @item @b{Type:} @ @ boolean
@@ -9412,8 +9420,15 @@
 @node noash
 @subsection noash
 
- at xref{Fire Spreading} for details.
+Determines whether @ref{it_burnable}_ash is put onto the floor after a fire
+stops. Ash stops a floor from re-igniting, so @code{noash = true} will allow a
+floor to start burning a second time, unless the item on it or its
+ at code{burnable}-attribute deny fire. @xref{Fire Spreading} for details.
 
+ at ref{fl_abyss} is the only floor with @code{noash = true} by default, because
+ash falls into the abyss. Note however, that @ref{fl_abyss} isn't burnable by
+default.
+
 @table @asis
 @item @b{Type:} @ @ boolean
 @item @b{Values:} @ @ @code{false}, @code{true}
@@ -9440,7 +9455,8 @@
 @node secure
 @subsection secure
 
- at xref{Fire Spreading} for details.
+Ensures that a nearby fire eventually ignites this floor. @xref{Fire Spreading}
+for details.
 
 @table @asis
 @item @b{Type:} @ @ boolean
@@ -9518,6 +9534,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 0.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 2.5 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9538,6 +9555,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 0.4 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9554,11 +9572,14 @@
 
 Brown woven bast with black background.
 
+When burnt, @code{fl_bast} will become @ref{fl_abyss}.
+
 @table @asis
 @item @b{Attributes:}
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.5 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 1.5 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9580,6 +9601,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.5 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 4.5 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9601,6 +9623,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 6.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9623,6 +9646,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 7.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9644,6 +9668,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 3.5 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9666,6 +9691,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.5 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 3.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9687,6 +9713,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.3 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 4.5 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9709,6 +9736,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.5 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 3.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9730,6 +9758,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.6 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 3.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9751,6 +9780,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 1.3 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9772,6 +9802,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.5 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 3.2 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9793,6 +9824,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 3.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 5.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9814,6 +9846,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 5.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9835,6 +9868,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.6 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 2.2 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9851,12 +9885,15 @@
 
 Grass floor. Light and dark grass and different textures of both exist.
 
+When burnt, @code{fl_lawn} becomes @ref{fl_dunes}.
+
 @table @asis
 @item @b{Attributes:}
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.5 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 4.0 @ @ @xref{friction}
 @item @b{texture}, @ @ @i{values}: "a","b","c1","c2","c3","c4","d1","d2","d3","d4","e1","e2","e3","e4" ; @ @ @i{default}: "a"; @ @ @i{access}: @code{none}  @ @ @xref{texture}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9891,6 +9928,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 6.4 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9914,6 +9952,7 @@
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 3.0 @ @ @xref{friction}
 @item @b{texture}, @ @ @i{values}: integer number, 1 <= n <= 7  ; @ @ @i{default}: random; @ @ @i{access}: @code{none}  @ @ @xref{texture}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9949,6 +9988,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.8 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 7.2 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9970,6 +10010,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.2 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 5.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -9986,11 +10027,14 @@
 
 Floor build up by small diagonal orange brown planks.
 
+When burnt, @code{fl_plank} becomes @ref{fl_abyss}.
+
 @table @asis
 @item @b{Attributes:}
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 5.5 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10012,6 +10056,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.6 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 3.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10033,6 +10078,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 0.9 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10055,6 +10101,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 7.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10076,6 +10123,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 7.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10097,6 +10145,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 6.4 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10111,15 +10160,18 @@
 @subsection fl_samba
 @obindex fl_samba
 
-Grey bleached wooden floor. Textures with horizontal and vertical aligned plank 
+Gray bleached wooden floor. Textures with horizontal and vertical aligned plank 
 exist.
 
+When burnt, @code{fl_samba} becomes @ref{fl_abyss}.
+
 @table @asis
 @item @b{Attributes:}
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 6.0 @ @ @xref{friction}
 @item @b{texture}, @ @ @i{values}: "h", "v"  ; @ @ @i{default}: random; @ @ @i{access}: @code{none}  @ @ @xref{texture}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10145,6 +10197,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 6.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10168,6 +10221,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 0.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 0.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10188,6 +10242,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 1.4 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10209,6 +10264,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 6.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10230,6 +10286,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 4.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10251,6 +10308,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 3.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 6.5 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable}
 @end table
 
 @item @b{Variants:}
@@ -10297,12 +10355,19 @@
 Some stones fall into abyss, too. @ref{st_box} will build floors on which all
 actors can move and pass the former abyss filled grid.
 
+By default, @code{fl_abyss} can't burn. However, when it burns (e.g. by
+ at ref{it_burnable}_oil), it does not create @ref{it_burnable}_ash in the end by
+default (i.e., @ref{noash} is true by default). In particular, when
+ at code{burnable} is set to @code{true}, an abyss may reignite arbitrarily often.
+
 @table @asis
 @item @b{Attributes:}
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{friction}
 @item @b{indestructible}, @ @ @i{values}: bool ; @ @ @i{default}: true; @ @ @i{access}: @code{none}  @ @ @xref{indestructible}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable}
+ at item @b{noash}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{noash} 
 @end table
 
 @item @b{Variants:}
@@ -10340,6 +10405,9 @@
 A bridge being set adjusts its state according to the @ref{Snapshot Principle}.
 It checks for solid stones being on top of it and auto closes accordingly.
 
+Only the brown (wooden) bridges are burnable by default. Open bridges are never
+burnable, regardless of the @ref{burnable}-attribute.
+
 @table @asis
 
 @item @b{Attributes:}
@@ -10351,6 +10419,8 @@
 The type of the bridge.
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 5.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: depends on @code{flavor} @ @ @xref{burnable} 
+True if flavor is @code{"b*"}, false otherwise.
 @end table
 
 @item @b{Messages:}
@@ -10401,6 +10471,8 @@
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 3.0 @ @ @xref{friction}
 @item @b{flavor}, @ @ @i{values}: @code{"abyss"}, @code{"trigger"}; @ @ @i{default}: @code{"abyss"}; @ @ @i{access}: @code{none}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: depends on @code{flavor} @ @ @xref{burnable} 
+True if flavor is @code{"trigger"}, false otherwise.
 @end table
 
 @item @b{Variants:}
@@ -10434,6 +10506,7 @@
 Number of seconds .
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.5 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 5.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable} 
 @end table
 
 @item @b{Variants:}
@@ -10453,13 +10526,14 @@
 
 Ice is a standard floor in most aspects. But an @ref{it_dynamite} will leave
 an @ref{it_crack}_water instead of a meditation hollow, and nearby fire heat
-will melt the ice to @ref{fl_water}.
+will melt the ice to @ref{fl_water} (see @ref{Heat-Transformation}).
 
 @table @asis
 @item @b{Attributes:}
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 0.1 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 0.1 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable} 
 @end table
 
 @item @b{Variants:}
@@ -10482,6 +10556,7 @@
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: -2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 3.0 @ @ @xref{friction}
 @item @b{flavor}, @ @ @i{values}: @code{"white"}, @code{"gray"}; @ @ @i{default}: @code{"white"}; @ @ @i{access}: @code{none}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable} 
 @end table
 
 @item @b{Variants:}
@@ -10516,6 +10591,7 @@
 Number of seconds .
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.2 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 6.5 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable} 
 @end table
 
 @item @b{Variants:}
@@ -10581,6 +10657,7 @@
 @item @b{force_y} @ @ @i{values}: float number; @ @ @i{default}: @code{0.0} @ @ @xref{force_y}
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 4.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable} 
 
 @end table
 
@@ -10630,8 +10707,8 @@
 
 A swamp is indestructible to the aspect that @ref{it_crack} will not spread
 onto it. But fire starting to burn nearby will dry out the swamp to 
- at ref{fl_dunes}. A swamp itself may be a successor of a @ref{fl_water} heated by 
-a fire.
+ at ref{fl_dunes} (see @ref{Heat-Transform}). A swamp itself may be a successor of
+a @ref{fl_water} heated by a fire.
 
 @table @asis
 @item @b{Attributes:}
@@ -10639,6 +10716,7 @@
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 13.0 @ @ @xref{friction}
 @item @b{indestructible}, @ @ @i{values}: bool ; @ @ @i{default}: true; @ @ @i{access}: @code{none}  @ @ @xref{indestructible}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable} 
 @end table
 
 @item @b{Variants:}
@@ -10677,6 +10755,7 @@
 @table @asis
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.5 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 4.5 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable} 
 @end table
 
 @item @b{Messages:} none
@@ -10709,7 +10788,7 @@
 
 Water itself is indestructible to the aspect that @ref{it_crack} will not spread
 onto it. But a fire starting to burn nearby will dry out the water to
- at ref{fl_swamp}.
+ at ref{fl_swamp} (see @ref{Heat-Transformation}).
 
 The standard water is static, its @samp{state} is @samp{IDLE}. It will not 
 spread to adjacent floors. But you can set up flood streams that will fill areas
@@ -10735,6 +10814,7 @@
 @item @b{indestructible}, @ @ @i{values}: bool ; @ @ @i{default}: true; @ @ @i{access}: @code{none}  @ @ @xref{indestructible}
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 5.0 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable} 
 @end table
 
 @item @b{Variants:}
@@ -10761,6 +10841,8 @@
 a framed wood can even operate as a flood source, but we do not recommend this
 usage. @pxref{Flood Spreading}.
 
+When burnt, @code{fl_wood} becomes @ref{fl_abyss}.
+
 @table @asis
 @item @b{Attributes:}
 @table @asis
@@ -10769,6 +10851,7 @@
 Number of seconds .
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 6.4 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: true @ @ @xref{burnable} 
 @end table
 
 @item @b{Variants:}
@@ -10804,6 +10887,7 @@
 @item @b{invisible} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 2.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 5.2 @ @ @xref{friction}
+ at item @b{burnable}, @ @ @i{values}: boolean; @ @ @i{default}: false @ @ @xref{burnable} 
 @end table
 
 @item @b{Variants:}
@@ -13503,12 +13587,13 @@
 @section Stone Attributes
 
 @menu
-* breakable::         -
-* hit_*::             -
-* hollow::            -
-* hovering::          -
-* movable::           -
-* transparent::       -
+* breakable::              -
+* freeze_check (stone)::   Freeze Checking
+* hit_*::                  -
+* hollow::                 -
+* hovering::               -
+* movable::                -
+* transparent::            -
 @end menu
 
 
@@ -13524,6 +13609,21 @@
 @item @b{Access:} @ @ read/write
 @end table
 
+ at c ----------------- freeze_check --------------------
+ at node freeze_check (stone)
+ at subsection freeze_check (stone)
+
+If @code{true}, allows for @ref{Freeze Checking} for this stone. Note that
+Freeze Checking only works on those floors that have additionally set
+ at code{freeze_check = true} on their own, see @ref{freeze_check (floor)}.
+
+ at table @asis
+ at item @b{Type:} @ @ boolean
+ at item @b{Values:} @ @ @code{false}, @code{true}
+ at item @b{Default:} @ @ @code{false}
+ at item @b{Access:} @ @ read/write
+ at end table
+
 @c ----------------- hit_* --------------------
 @node hit_*
 @subsection hit_*
@@ -14736,7 +14836,7 @@
 A chess stone that jumps onto a @ref{fl_thief} captures and inactivates the
 thief.
 
-Chess stones can't jump over or into fire (see @ref{The 1.0-Fire System}). At least,
+Chess stones can't jump over or into fire (see @ref{Fire Spreading}). At least,
 a chess knight is brave enough not to panic when fire starts to burn beneath.
 Note that fire can't ignite the floor below a chess stone. In this
 context it acts like an immovable stone. In the same sense, they don't act on
@@ -21034,8 +21134,9 @@
 @menu
 * Display Follow Strategy::    How the display view follows the active marble
 * Flood Spreading::            How a water flood spreads over a given area
-* Fire Spreading::
-* Freeze Checking::
+* Fire Spreading::             How to start, use, and stop fire.
+* Heat-Transformation::        How some floors transform when a fire starts nearby.
+* Freeze Checking::            How to turn frozen boxes in a Sokoban to st_death.
 @end menu
 
 @node Display Follow Strategy
@@ -21224,13 +21325,276 @@
 water stream. But this feature is intentionally, as it avoids many shortcut
 situations and thus makes the flood more usable for level authors.
 
+ at c ----------------------------------------------------------------------
 @node Fire Spreading
 @subsection Fire Spreading
 
+The 1.0-version of Enigma introduced a new fire system, making use of
+attributes and messages of the floor tiles. The default fire, once
+ignited, spreads over the landscape and destroys items, marbles and
+some stones. It spreads along those floor tiles that are marked ``burnable'' by
+default (like @ref{fl_hay} or @ref{fl_wood}), by attribute (see attribute
+ at ref{burnable}), or by one of two items that indicate burnability: the invisible
+ at ref{it_burnable} and the visible @code{it_burnable_oil}. On a burning floor,
+all items are destroyed. However, some items prevent the floor from burning,
+like @ref{it_meditation} or @ref{it_dynamite} (which ignites instead).
+
+Fire can be ignited in several standard ways:
+ at itemize @bullet
+ at item The @code{setfire}-message sets fire to a floor if it is
+burnable and the item on it allows it to burn; non-burnable items like
+ at ref{it_dynamite} are not ignited by this.
+ at item The @code{heat}-message ignites burnable floors as does
+ at code{setfire}, but also initiates a @ref{Heat-Transformation} of the floor
+and ignites items on it.
+ at item The @code{ignite} and @code{explosion}-messages that are used by
+ at ref{it_dynamite} and @ref{it_bomb} can initiate fire via
+ at ref{it_burnable}[_oil] or if the
+ at ref{ignitable}-attribute of the floor is set (off by default).
+ at item The floor already starts burning on initialization when the
+ at code{initfire}-attribute is set (off by default).
+ at item Fire in the neighborhood, see below.
+ at end itemize
+
+If needed, the @code{forcefire}-message can be used to set fire to
+non-burnable floors. Internally, it is equivalent to manually setting
+ at code{it_burnable_ignited}; however, setting @code{it_burnable_ignited}
+manually is deprecated to allow a further development of the fire-system in
+future.
+
+Fire does the following:
+ at itemize @bullet
+ at item It kills @ref{st_box}_wood, @ref{st_box}_hay, and @ref{st_flat}_moveburnable
+above it, and @ref{st_flat}_burnable beneath it.
+ at item It melts @ref{st_ice} to @ref{fl_water}.
+ at item It heats its neighboring tiles, which might result in a
+ at ref{Heat-Transformation} of the floor.
+ at item It might ignite or destroy items on its neighbor, this concerns
+ at ref{it_dynamite}, both @ref{it_bomb}, and @ref{it_crack}.
+ at item It might set fire to its neighbor.
+ at item It shatters marbles that are not protected with @ref{it_umbrella} or other
+measures. Note that in future versions, jumping over fire with @ref{it_spring}
+might get allowed.
+ at end itemize
+
+Fire stops burning after a random amount of time, as long as the
+ at code{eternal}-attribute of the floor is not set. When it stops
+burning, it might replace the floor by another kind
+(``fire-transform''), this is: @ref{fl_wood} is replaced by
+ at ref{fl_abyss}, @ref{fl_lawn} by @ref{fl_dunes}. Finally, it
+puts @ref{it_burnable}_ash on the floor, which prohibits a second
+fire and which can be removed with @ref{it_brush}. However, ash is not
+set if the @ref{noash}-attribute is set (default only for @ref{fl_abyss}).
+
+Since the spreading of fire is a random event, in 0.92, a level author couldn't
+be sure that a particular item was ignited or fire was set. Since 1.0, these can
+be assured by setting the @ref{secure}-attribute: When a burnable floor with
+ at code{secure = true} is near fire, it will eventually catch fire, items on it
+are ignited, etc. @code{secure} is @code{false} by default.
+
+In 0.92, there were two speeds of fire: When using @ref{it_burnable},
+fire spread much faster than without. This is still the same in
+1.0 and above. However, you can set the @ref{fastfire}-attribute to hasten
+the fire without setting the invisible @ref{it_burnable}, this should be the
+preferred method.
+
+Fire that burns under a stone is not allowed to spread; the only exceptions are
+floating stones like @ref{st_grate}, and those stones that are destroyed by fire
+anyway (@ref{st_box}_wood, @ref{st_box}_hay, @ref{st_flat}_burnable,
+ at ref{st_flat}_moveburnable). In contrast to this, fire might also  spread to
+under a movable stone, but not further.
+
+You can stop fire with @code{it_extinguisher}, which creates the fireproof
+ at code{it_burnable_fireproof}. Another way to stop fire is to push the totally
+inert @ref{st_box}_rock over it: This is the only movable stone that doesn't
+allow fire under it. A final way to stop fire is to send the
+ at code{stopfire}-message to a floor.
+
+ at strong{Differences between 1.0 and 0.92}
+
+The old fire system of Enigma versions up to 0.92, differs from
+the 1.0 and above version mainly in the following points:
+
+ at itemize @bullet
+ at item no fire-transform except @ref{fl_wood} to @ref{fl_abyss}
+ at item no @ref{Heat-Transformation}s
+ at item ash on @ref{fl_abyss}
+ at item no difference between different floors
+ at item replication via same-floor-pattern instead of
+burnable-floor-pattern: 0.92 didn't distinguish between burnable and
+non-burnable floors. Instead, fire was allowed to spread to floors of
+the same kind slowly.
+ at item burnable items always catch fire: In 1.0 and above, a burnable item
+(except for @ref{it_burnable}[_oil]) on a non-burnable floor won't catch fire,
+in 0.92 it did.
+ at end itemize
+
+A good model of the 0.92-system can be attained via the
+compatibility-modes: All non-Enigma-modes (see @ref{Differences
+between Compatibility Modes} and @ref{<compatibility>}) feature a
+version which only marginally differs from 0.92-fire, yet allowing
+some of the new achievements, like secure- or eternal-fire.
+
+Note that in 0.92, fire-transformation happened at the beginning of
+the fire, which manifested in the so called ``burning-abyss''-bug.
+Besides other details, this is how the original 0.92 system differs from the
+one in 1.0-non-Enigma-mode.
+
+ at strong{Burnable and Fireproof Floors}
+
+All floors that look like plastic, fabrics, or organics are burnable by default:
+ at code{fl_adhesionless, fl_aquamarine, fl_bluegray, fl_bluegreen, fl_blueslab,
+fl_fake_trigger, fl_hay, fl_ivory, fl_marble, fl_platinum, fl_red, fl_redslab,
+fl_rough*, fl_tigris, fl_woven}.
+
+All floors that look like wood are burnable and leave @ref{fl_abyss} behind:
+ at code{fl_bast, fl_plank, fl_samba*, fl_wood*}, and @ref{fl_bridge}_b*.
+
+All floors that look like grass are burnable and leave @ref{fl_dunes} behind:
+ at ref{fl_lawn}.
+
+All other floors are fireproof (they don't burn by default):
+ at code{fl_abyss*, fl_brick, fl_bright, fl_concrete, fl_dark, fl_darkgray,
+fl_dummy, fl_dunes,  fl_gravel, fl_gray, fl_himalaya, fl_ice, fl_inverse*, 
+fl_metal*, fl_mortar, fl_pinkbumps, fl_rock, fl_sahara, fl_sand, fl_slope*,
+fl_space, fl_stone, fl_swamp, fl_water, fl_white, fl_yinyang*}, and
+ at ref{fl_bridge}_g*.
+
+An open @ref{fl_bridge} is never burnable, this overrides all items and
+attributes. A closed @ref{fl_bridge} is burnable if and only if it is brown,
+but this can be changed via attribute @code{burnable}. Note that changing the
+flavor of @ref{fl_bridge} will change @code{burnable} according to the new
+flavor as well.
+
+ at strong{Fireproof Items}
+
+Most items are passively burnable, this is: An item is destroyed by
+fire, if and only if the floor could burn all by itself.  However,
+there are some items with individual reactions (@code{it_burnable,
+it_burnable_oil, it_dynamite, it_bomb*, it_crack*})
+and some items that are completely fireproof. These are: @code{it_burnable_ash,
+it_burnable_fireproof, it_debris, it_dummy, it_explosion*, it_extinguisher,
+it_extinguisher_medium, it_meditation*, it_trap, it_vortex*} and the fire
+animations themselves: @code{it_burnable_ignited} and
+ at code{it_burnable_burning}.
+
+Note that @code{it_extinguisher_empty, it_trigger} (visible and invisible),
+ at code{it_landmine}, and @code{it_death} are passively burnable.  In particular,
+ at code{it_landmine} does not explode or create @code{it_meditation} when burning.
+The reaction of @ref{it_sensor} towards fire might be changed in future
+versions.
+
+If you need to save a passively burnable item from fire, simply set a fireproof
+floor like @code{fl_sand} or @code{fl_rock} below it. This normally is the case
+when using @ref{it_strip}. However, you can use the @code{burnable}-attribute in
+these cases to force burnability of the floors.
+
+ at node Heat-Transformation
+ at subsection Heat-Transformation
+
+When a fire starts to burn near @ref{fl_ice}, it melts to @ref{fl_water}. In the
+same sense, @ref{fl_water} boils to @ref{fl_swamp}, and this again to
+ at ref{fl_dunes}. In contrast to most other fire-related actions, this is not
+random, but always and only happens, when a nearby fire starts to burn, i.e.
+once for each new fire.
+
+Examples: Put an @ref{st_box}_rock on @ref{fl_ice}. A fire will melt
+the ice, and @ref{st_box}_rock creates a fireproof and safe way to the
+other side. If you use @ref{st_box}_wood instead, @ref{fl_wood}_framed is
+created, which presumably catches fire and leaves @ref{fl_abyss}
+behind. Finally, @ref{st_box}_hay will create @ref{fl_hay}_framed, which is
+burnable, but won't burn down to @ref{fl_abyss}. A similar combination is
+ at code{fl_water} with @ref{st_chess}.
+
+You can enforce a transformation by sending the @code{heat}-message to the
+floor.
+
+If you want to suppress this transformation, you can switch to
+a non-Enigma-compatibility-mode.
+
 @node Freeze Checking
 @subsection Freeze Checking
 
+With Enigma 1.1 and above, you can use a special feature to support Sokoban
+levels and Sokoban parts of levels: Whenever a movable stone is pushed into
+some unmovable position, this feature automatically transforms the stone into
+ at ref{st_death}, to demonstrate that the game is lost and provide a simple way
+for the player to restart.
 
+The feature is called ``Freeze Checking''. It applies to each stone with
+attribute @code{freeze_check = true} which is pushed onto a floor with
+attribute @code{freeze_check = true}. This way you can restrict the freeze
+check to a bounded area. For a true Sokoban the goal tiles should not be marked
+with @code{freeze_check = true}, as a frozen box on a goal is not considered
+harmful. On the other hand, you can specify which boxes are freeze-checked. This
+gives further freedom to use other stones inside your Sokoban area: Floor and
+stone both need the @code{freeze_check}-attribute activated.
+
+The freeze check recognizes three basic constellations of stones that lead to a
+freeze of a standard movable stone. With @code{B} as box (movable or
+persistent) and @code{#} as wall (persistent):
+ at example
+BB   #B   #B
+BB    #    B#
+ at end example
+There are more freeze constellations which are not recognized, the simplest
+would be:
+ at example
+#B
+ BB
+  #
+ at end example
+Don't rely on this fact, it might be changed in future versions.
+
+Please bear in mind: The freeze check is not intelligent. It can't foresee that
+one of your functions might remove a stone, it can't foresee that some door
+will never open up again (doors are considered as non-existent), it doesn't
+recognize when you put an @ref{it_puller}, @ref{it_cherry}, or @ref{st_swap} in
+your level. It handles special stones in a way to minimize false-positive freeze
+checks.
+
+Floating stones (like @ref{st_grate}) create completely new frozen
+constellations. From the following two examples, only the right example is
+frozen (@code{G} is @code{st_grate_cross}):
+ at example
+G    G
+BB   BB
+GB   GBG
+ at end example
+At present, none of these are recognized as frozen by Enigma, floating stones
+are considered as non-existing during a freeze check. To demonstrate the
+difficulty, you may analyze yourself which of the following constellations is
+frozen:
+ at example
+G      G      GBG   GB#    G G#G
+B#    BBB     BB    GB G   BBBBB
+G    #B B#   #B      G     G#G G
+      G G     G
+ at end example
+
+In some cases, stones are even handled differently although they have similar
+properties: @ref{st_box}_wood and @code{st_flat_moveburnable} (see
+ at ref{st_flat}) are both movable and both destroyed by fire (see @ref{Fire
+Spreading}). There would never be frozen stones, as they can easily be burned
+away. Yet, @code{st_box_wood} uses the default freeze checking, whereas
+ at code{st_flat_moveburnable} is considered as non-existing. This is because
+ at code{st_box_wood} is often used without fire, whereas
+ at code{st_flat_moveburnable} is primarily used in combination with fire.
+
+Another example is @ref{st_shogun}_s, which is considered as a default
+movable stone, in contrast to the remaining shogun stones. This way you can use
+ at code{st_shogun_s} with goal @ref{it_shogun}_s, but don't have to fear
+false-positive freeze checks from the non-standard way in which shogun stones
+move.
+
+As a concluding remark, the freeze checking is to be used as a support for the
+gamer only. It's not meant to be exploited as special feature to make movable
+stones unmovable or to provide a way to jump back to the starting position. It
+is subject to changes in future versions. And versions before 1.1 won't make a
+freeze check at all - so you can't rely on it to happen. It should really be
+used in Sokoban-kind parts of a level only, for which it is designed.
+
+ at c ----------------------------------------------------------------------
 @node Tips and Tricks
 @section Tips and Tricks
 
@@ -21609,8 +21973,6 @@
 * Stones::
 * Old Actors::
 * General object attributes::
-* The 1.0-Fire System::
-* Freeze Checking::
 * Differences between Compatibility Modes::
 @end menu
 
@@ -21655,7 +22017,7 @@
 See @ref{Freeze Checking}.
 @end table
 
-Attributes connected to @ref{The 1.0-Fire System} (all boolean):
+Attributes connected to @ref{Fire Spreading} (all boolean):
 @table @code
 @item burnable
 Sets if the floor may burn.
@@ -22244,7 +22606,7 @@
 @node Fire and Extinguisher
 @subsection Fire and Extinguisher
 
-Compare @ref{The 1.0-Fire System}.
+Compare @ref{Fire Spreading}.
 
 Six items are particular to the fire system:
 @itemize
@@ -23079,7 +23441,7 @@
 @ref{fl-abyss}, @ref{it-abyss}, and laser beams.  Note that you can't
 jump over any kind of stone, or pass @ref{st-grate} during the
 jump, even if you could on the ground.  The interplay of jumping and
-fire (@ref{The 1.0-Fire System}) will be target of future changes;
+fire (@ref{Fire Spreading}) will be target of future changes;
 don't use them together yet.
 
 You can pick up and use @code{it-spring1} and @code{it-spring2}.  You
@@ -24023,12 +24385,11 @@
 @ref{fl-swamp}, but cross @ref{fl-water} undamaged.  They inactivate
 @ref{fl-thief}.
 
-Chess stones can't jump over or into fire (see @ref{The 1.0-Fire
-System}).  At least, a chess knight is brave enough not to
-panic when fire starts to burn beneath.  Note that fire can't ignite
-the floor below an @code{st-chess_[black/white]}, in this context it
-acts like an immovable stone.  In the same sense, they don't act on
-impulses of @ref{st-stoneimpulse} or similar stones.
+Chess stones can't jump over or into fire (see @ref{Fire Spreading}). At least,
+a chess knight is brave enough not to panic when fire starts to burn beneath. 
+Note that fire can't ignite the floor below an @code{st-chess_[black/white]}, in
+this context it acts like an immovable stone. In the same sense, they don't act
+on impulses of @ref{st-stoneimpulse} or similar stones.
 
 @strong{Attributes}
 
@@ -24251,7 +24612,7 @@
 @subsection st-firebreak[_move]: Firebreakable Stones
 
 @code{st-firebreak} gets destroyed when there is fire near it (see
- at ref{The 1.0-Fire System}). @code{st-firebreak_move} is movable and
+ at ref{Fire Spreading}). @code{st-firebreak_move} is movable and
 gets destroyed when there is fire below it, just like
 @ref{st-wood}. It falls into @ref{fl-water}, @ref{fl-abyss} and
 @ref{fl-swamp} (if you need it not to fall, use @ref{fl-bridge}
@@ -25315,7 +25676,7 @@
 
 When there is fire under @code{st-wood} or @code{st-flhay}, they burn
 away.  In contrast to this, @code{st-flrock} extinguishes fire as it
-is pushed over it (see @ref{The 1.0-Fire System}).  This distinguishes
+is pushed over it (see @ref{Fire Spreading}).  This distinguishes
 it from all other movable stones.  Fire that is extinguished in this
 way might leave @code{it-burnable_ash} behind, but the floor does not
 fire-transform.
@@ -25615,286 +25976,6 @@
 @end table
 
 @c ----------------------------------------------------------------------
- at node The 1.0-Fire System
- at section The 1.0-Fire System
-
-The 1.0-version of Enigma introduces a new fire system, making use of
-attributes and messages of the floor tiles. The default fire, once
-ignited, spreads over the landscape and destroys items, marbles and
-some stones. It spreads along those floor tiles that are marked
-``burnable'' by default (like @code{fl-hay} or @code{fl-wood1}), by
-attribute (setting @code{enigma.SetAttrib(myfloor, "burnable", TRUE)}),
-or by one of two items that indicate burnability: the invisible
- at code{it-burnable} and the visible @code{it-burnable_oil}. On a
-burning floor, all items are destroyed. However, some items prevent the
-floor from burning, like @code{it-hollow} (see @ref{Hills and Hollows}) or
- at ref{it-dynamite} (which is ignited instead).
-
-Fire can be ignited in several standard ways:
- at itemize @bullet
- at item The @code{setfire}-message sets fire to a floor if it is
-burnable and the item on it allows it to burn; non-burnable items like
- at code{it-dynamite} are not ignited by this!
- at item The @code{heat}-message ignites burnable floors as does
- at code{setfire}, but also initiates a heat-transformation of the floor
-(see below) and ignites items on it.
- at item The @code{ignite} and @code{expl}-messages that are used by
- at code{it-dynamite}, @ref{it-blackbomb} and @ref{it-whitebomb} can
-initiate fire via @code{it-burnable[_oil]} or if the
- at code{ignitable}-attribute of the floor is set (off by default).
- at item The floor already starts burning on initialization when the
- at code{initfire}-attribute is set (off by default).
- at item Fire in the neighborhood, see below.
- at end itemize
-
-If needed, the @code{forcefire}-message can be used to set fire to
-non-burnable floors. Internally, it is equivalent to manually setting
- at code{it-burnable_ignited}, the last method (which was quite famous in
-0.92) should be avoided in future, to allow a further development of
-the fire-system.
-
-Fire does the following:
- at itemize @bullet
- at item It kills @ref{st-wood} and @ref{st-firebreak[_move]} above it
-(in case of @code{st-firebreak}: beneath it).
- at item It heats its neighboring tiles, which might result in a
-``heat-transform'' of the floor (see below).
- at item It might ignite or destroy items on its neighbor, this concerns
- at code{it-dynamite}, @code{it-blackbomb}, @code{it-whitebomb} and
- at ref{it-crack}.
- at item It might set fire to its neighbor.
- at item It shatters marbles that are not protected with
- at ref{it-umbrella}. Note that in future versions, jumping over
-fire with @ref{it-spring[1/2/board]} might get allowed.
- at end itemize
-
-Fire stops burning after a random amount of time, as long as the
- at code{eternal}-attribute of the floor is not set. When it stops
-burning, it might replace the floor by another kind
-(``fire-transform''), this is: Wooden floors are replaced by
- at ref{fl-abyss}, leaves are replaced by @code{fl-dunes}. Finally, it
-puts @code{it-burnable_ash} on the floor, which prohibits a second
-fire and which can be removed with @ref{it-brush}. However, ash is not
-set if the floor is @code{fl-abyss} or the @code{noash}-attribute is
-set.
-
-Since the spreading of fire is a random event, in 0.92, a level author
-couldn't be sure that a particular item was ignited or fire was
-set. In 1.0, these can be assured by setting the
- at code{secure}-attribute: When a burnable floor with
- at code{secure}-attribute is near fire, it will eventually catch fire,
-items on it are ignited, etc.
-
-In 0.92, there were two speeds of fire: When using @code{it-burnable},
-fire spread much faster than without. This is still the same in
-1.0. However, you can set the @code{fastfire}-attribute to hasten
-the fire without setting the invisible @code{it-burnable}.
-
-Fire that burns under a stone is not allowed to spread; the only exceptions
-are floating stones (as @ref{st-grate}), and those stones that
-are destroyed by fire anyway (see @ref{st-wood}-variants and
- at ref{st-firebreak[_move]}). In contrast to this, fire might also
-spread to under a movable stone, but not further.
-
-You can stop fire with @code{it-extinguisher}, which creates the
-fireproof @code{it-burnable_fireproof}. Another way to stop fire is to
-push the totally inert @code{st-flrock} (see @ref{st-wood}) over
-it: This is the only movable stone that doesn't allow fire under it. A
-final way to stop fire is to send the @code{stopfire}-message to a
-floor, which works the same way as @code{st-flrock}.
-
-Compare with @ref{Fire and Extinguisher}.
-
- at strong{Heat-Transformations}
-
-When a fire starts to burn near @ref{fl-ice}, it melts to
- at ref{fl-water}. In the same sense, @code{fl-water} boils to
- at ref{fl-swamp}, and this again to @code{fl-dunes}. In contrast to most
-other fire-related actions, this is not random, but always and only
-happens, when a nearby fire starts to burn.
-
-Examples: Put an @code{st-flrock} on @code{fl-ice}. A fire will melt
-the ice, and @code{st-flrock} creates a fireproof and safe way to the
-other side. If you use @ref{st-wood} instead, @code{fl-stwood} is
-created, which presumably catches fire and leaves @code{fl-abyss}
-behind. A similar combination is @code{fl-water} with
- at ref{st-chess_[black/white]}.
-
-If you want to suppress this transformation, you can switch to
-a non-Enigma-compatibility-mode, see the following section.
-
- at strong{Differences between 1.0 and 0.92}
-
-The old fire system of Enigma versions up to 0.92, differs from
-the 1.0 version mainly in the following points:
-
- at itemize @bullet
- at item no fire-transform except @code{fl-[st]wood} to @code{fl-abyss}
- at item no heat-transformations
- at item ash on fl-abyss
- at item no difference between different floors
- at item replication via same-floor-pattern instead of
-burnable-floor-pattern: 0.92 didn't distinguish between burnable and
-non-burnable floors. Instead, fire was allowed to spread to floors of
-the same kind slowly.
- at item burnable items always catch fire: In 1.0, a burnable item (except
-for @code{it-burnable} and @code{it-burnable_oil} themselves) on an
-non-burnable floor won't catch fire, in 0.92 it did.
- at end itemize
-
-A good model of the 0.92-system can be attained via the
-compatibility-modes: All non-Enigma-modes (see @ref{Differences
-between Compatibility Modes} and @ref{<compatibility>}) feature a
-version which only marginally differs from 0.92-fire, yet allowing
-some of the new achievements, like secure- or eternal-fire.
-
-Note that in 0.92, fire-transformation happened at the beginning of
-the fire, which manifested in the so called ``burning-abyss''-bug.
-Besides other details, this is how the original 0.92 system differs from the
-one in 1.0-non-Enigma-mode.
-
- at strong{Burnable and Fireproof Floors}
-
-The following floors are fireproof (they don't burn by default):
- at code{fl-abyss*, fl-ac*, fl-black, fl-brick, fl-bumps,
-fl-concrete, fl-dummy, fl-dunes, fl-gradient*, fl-gravel, fl-gray,
-fl-himalaya, fl-ice*, fl-inverse, fl-inverse2, fl-darkgray, fl-metal*,
-fl-mortar, fl-normal*, fl-rock, fl-sahara, fl-sand, fl-space*,
-fl-springboard, fl-stone, fl-swamp, fl-water, fl-white}, gray @code{fl-bridge}
-
-The following floors are burnable: @code{fl-bluegray, fl-bluegreen*,
-fl-hay, fl-light, fl-lightgray, fl-marble, fl-red, fl-rough*,
-fl-tigris, fl-woven*, fl-trigger}
-
-The following floors are burnable and leave @code{fl-dunes} behind:
- at code{fl-leaves*}
-
-The following floors are burnable and leave @code{fl-abyss} behind:
- at code{fl-floor_001, fl-plank, fl-samba*, fl-stwood*, fl-wood*}, brown
- at code{fl-bridge}.
-
-An open @ref{fl-bridge} is never burnable, this overrides all items and
-attributes. A closed @code{fl-bridge} is burnable if and only if it is brown,
-but this can be changed via attribute @code{burnable}. Note that changing the
-flavor of @code{fl-bridge} will change @code{burnable} according to the new
-flavor as well.
-
- at strong{Fireproof Items}
-
-Most items are passively burnable, this is: An item is destroyed by
-fire, if and only if the floor could burn all by itself.  However,
-there are some items with individual reactions (@code{it-burnable,
-it-burnable_oil, it-dynamite, it-blackbomb, it-whitebomb, it-crack*})
-and some items that are completely fireproof. These are:
- at code{it-hollow, it-tinyhollow, it-hill, it-tinyhill, it-vortex*,
-it-burnable_fireproof, it-burnable_ash, it-extinguisher,
-it-extinguisher_medium, it-abyss}, all items of section @ref{System
-and Debug Items} (@code{it-[1/2]pkillstone, it-bridge-oxyd*,
-it-debris, it-dummy, it-easy[kill/keep]stone, it-explosion*,
-it-oxyd5f, it-signalfilter[0/1]}) and the fire animations themselves:
- at code{it-burnable_ignited} and @code{it-burnable_burning}.
-
-Note that @code{it-extinguisher_empty, it-trigger} (visible and
-invisible), @code{it-landmine}, @code{it-changefloor} and
- at code{it-death} are passively burnable.  In particular,
- at code{it-landmine} does not explode or create
- at code{it-hollow} when burning. The reaction of @ref{it-sensor} and
- at code{it-inversesensor} towards fire might be changed in future
-versions.
-
-If you need to save a passively burnable item from fire, simply set a
-fireproof floor like @code{fl-sand} or @code{fl-rock} below it. This
-normally is the case when using @ref{it-[h/v]strip} and
- at ref{it-changefloor}. However, you can use the
- at code{burnable}-attribute in these cases to force burnability of the
-floors.
-
-
- at c ----------------------------------------------------------------------
- at node Freeze Checking
- at section Freeze Checking
-
-With Enigma 1.1 and above, you can use a special feature to support Sokoban
-levels and Sokoban parts of levels: Whenever a movable stone is pushed into
-some unmovable position, this feature automatically transforms the stone into
- at ref{st-death}, to demonstrate that the game is lost and provide a simple way
-for the player to restart.
-
-The feature is called ``Freeze Checking''. It applies to each stone with
-attribute @code{freeze_check = true} which is pushed onto a floor with
-attribute @code{freeze_check = true}. This way you can restrict the freeze
-check to a bounded area. For a true Sokoban the goal tiles should not be marked
-with @code{freeze_check = true}, as a frozen box on a goal is not considered
-harmful. On the other hand, you can specify which boxes are freeze-checked. This
-gives further freedom to use other stones inside your Sokoban area: Floor and
-stone both need the @code{freeze_check}-attribute activated.
-
-The freeze check recognizes three basic constellations of stones that lead to a
-freeze of a standard movable stone. With @code{B} as box (movable or
-persistent) and @code{#} as wall (persistent):
- at example
-BB   #B   #B
-BB    #    B#
- at end example
-There are more freeze constellations which are not recognized, the simplest
-would be:
- at example
-#B
- BB
-  #
- at end example
-Don't rely on this fact, it might be changed in future versions.
-
-Please bear in mind: The freeze check is not intelligent. It can't foresee that
-one of your functions might remove a stone, it can't foresee that some door
-will never open up again (doors are considered as not existent), it doesn't
-recognize when you put an @ref{it-puller}, @ref{it-cherry}, or @ref{st-swap} in
-your level. It handles special stones in a way to minimize false-positive freeze
-checks.
-
-Floating stones (like @ref{st-grate}) create completely new frozen
-constellations. From the following two examples, only the right example is
-frozen (@code{G} is @code{st-grate1}):
- at example
-G    G
-BB   BB
-GB   GBG
- at end example
-At present, none of these are recognized as frozen by Enigma, floating stones
-are considered as not existing during a freeze check. To demonstrate the
-difficulty, you may analyze yourself which of the following constellations is
-frozen:
- at example
-G      G      GBG   GB#    G G#G
-B#    BBB     BB    GB G   BBBBB
-G    #B B#   #B      G     G#G G
-      G G     G
- at end example
-
-In some cases, stones are even handled differently although they have similar
-properties: @ref{st-wood} and @code{st-firebreak_move} (see
- at ref{st-firebreak[_move]}) are both movable and both destroyed by fire (see
- at ref{The 1.0-Fire System}). There would never be frozen stones, as they can
-easily be burned away. Yet, @code{st-wood} uses the default freeze checking,
-whereas @code{st-firebreak_move} is considered as not existing. This is because
- at code{st-wood} is often used without fire, whereas @code{st-firebreak_move} is
-primarily used in combination with fire.
-
-Another example is @code{st-shogun-s}, which is considered as a default
-movable stone, in contrast to the remaining shogun stones (see
- at ref{st-shogun-<sml>}). This way you can use @code{st-shogun-s} with goal
- at code{it-shogun-s}, but don't have to fear false-positive freeze checks from
-the non-standard way in which shogun stones move.
-
-As a concluding remark, the freeze checking is to be used as a support for the
-gamer only. It's not meant to be exploited as special feature to make movable
-stones unmovable or to provide a way to jump back to the starting position. It
-is subject to changes in future versions. And versions before 1.1 won't make a
-freeze check at all - so you can't rely on it to happen. It should really be
-used in Sokoban-kind parts of a level only, for which it is designed.
-
-
- at c ----------------------------------------------------------------------
 @node Differences between Compatibility Modes
 @section Differences between Compatibility Modes
 
@@ -25914,7 +25995,7 @@
 @item Oxyd-stones (@ref{st-oxyd}) must blink before they can be
 ultimately opened (pairs must be hit with some time delay).
 @item The non-Enigma modes feature a model of the 0.92-Fire System
-(see @ref{The 1.0-Fire System}).
+(see @ref{Fire Spreading}).
 @item @ref{it-squashed} and @ref{it-cross} can't be removed with
 @ref{it-brush}.
 @item Only function of @ref{it-pencil} is to turn



From ral at mail.berlios.de  Sun May 24 14:27:06 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sun, 24 May 2009 14:27:06 +0200
Subject: [Enigma-game-svn] r1682 - trunk/doc/reference
Message-ID: <200905241227.n4OCR678032152@sheep.berlios.de>

Author: ral
Date: 2009-05-24 14:26:56 +0200 (Sun, 24 May 2009)
New Revision: 1682

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
- st_ice
- st_death_movable
- GlobalForce


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-05-23 21:53:28 UTC (rev 1681)
+++ trunk/doc/reference/enigma-ref.texi	2009-05-24 12:26:56 UTC (rev 1682)
@@ -41,9 +41,9 @@
 * Item Objects::
 * Stone Objects::
 * Actor Objects::
-* Other Objects::               Rubberbands, etc.
-* Libraries::                   Advanced tools
-* Advanced Features::           Fire, ...
+* Other Objects::               Wires, Rubberbands and Gadgets
+* Libraries::                   Supplemental Functions and Features 
+* Advanced Features::           Resolvers, Scrolling, Flood, Fire, etc.
 * Extension Development::       Resolver, Library Development
 * Guidelines and Hints::        Tips and Recommendations for Levels to be included in Enigma
 * Old API - Objects::           Description of all objects in Enigma
@@ -743,8 +743,8 @@
 sample file at @samp{reference/soundset.lua}. Each entry in these tables is
 either a string like @samp{enigma/st-coinslot}, which is interpreted as the
 file @samp{soundsets/enigma/st-coinslot.wav} with some default properties, or a
-list of sound attributes enclosed in curly braces. Sound events triggered with
- at ref{enigma.EmitSound} are converted the same way. Here is an example of such an
+list of sound attributes enclosed in curly braces. Sound events triggered by a
+ at ref{sound} message are converted the same way. Here is an example of such an
 entry:
 
 @example
@@ -8136,6 +8136,9 @@
 * off::
 * open::
 * close::
+* ignite::
+* heat::
+* setfire::
 * kill::
 * sound::
 * disconnect::
@@ -8239,6 +8242,44 @@
 @item @b{Support:} @ @ by door like objects that can be opened and closed
 @end table
 
+ at node ignite
+ at subsection ignite
+
+Sets fire to a floor if its burnable (@pxref{Fire Spreading}) or start an
+explosion or shattering of items like @ref{it_dynamite}, @ref{it_bomb} or
+stones like @ref{st_ice}, @ref{st_dispenser} and many more.
+
+ at table @asis
+ at item @b{Value:} @ @ -
+ at item @b{Returns:} @ @ -
+ at item @b{Support:} @ @ by all @ref{Floors} and explosive or shattering items and stones
+ at end table
+
+ at node heat
+ at subsection heat
+
+Sets fire to a floor if its burnable (@pxref{Fire Spreading}) or causes a 
+ at ref{Heat-Transformation} on a floor or other objects like @ref{st_ice} that 
+starts melting. Some objects do react on a heat message like on an @ref{ignite}
+message by explosions or shattering.
+
+ at table @asis
+ at item @b{Value:} @ @ -
+ at item @b{Returns:} @ @ -
+ at item @b{Support:} @ @ by all @ref{Floors} and some other objects.
+ at end table
+
+ at node setfire
+ at subsection setfire
+
+Sets fire to a floor if its burnable (@pxref{Fire Spreading}).
+
+ at table @asis
+ at item @b{Value:} @ @ -
+ at item @b{Returns:} @ @ -
+ at item @b{Support:} @ @ by all @ref{Floors}
+ at end table
+
 @node kill
 @subsection kill
 
@@ -8564,6 +8605,7 @@
 * FollowThreshold::
 * Fragility::
 * FrictionStrength::
+* GlobalForce::
 * Height::
 * IsDifficult::
 * MagnetRange::
@@ -8830,6 +8872,20 @@
 @item @b{Support:} @ @ @ref{it_crack} and @ref{Floors}
 @end table
 
+ at node GlobalForce
+ at subsection GlobalForce
+
+A global constant force that is added to every actor on every grid. The force
+is given as a vector constant by a value of type @ref{Position}.
+
+ at table @asis
+ at item @b{Type:} @ @ @ref{Position}
+ at item @b{Values:} @ @ pair of float numbers
+ at item @b{Default:} @ @ @code{po(0.0, 0.0)}
+ at item @b{Access:} @ @ read/write
+ at item @b{Support:} @ @ all floors
+ at end table
+
 @node FrictionStrength
 @subsection FrictionStrength
 
@@ -10707,7 +10763,7 @@
 
 A swamp is indestructible to the aspect that @ref{it_crack} will not spread
 onto it. But fire starting to burn nearby will dry out the swamp to 
- at ref{fl_dunes} (see @ref{Heat-Transform}). A swamp itself may be a successor of
+ at ref{fl_dunes} (@pxref{Heat-Transformation}). A swamp itself may be a successor of
 a @ref{fl_water} heated by a fire.
 
 @table @asis
@@ -11027,7 +11083,6 @@
 * it_key::             Lock opening coded Key
 * it_magicwand::       Wizards Tools
 * it_pencil::          Pencil to mark Objects
-* it_pencil::
 * it_pin::             Friction increasing crampon
 * it_pipe::            Pipe for Transmissions
 * it_puller::          Stone pulling item
@@ -12582,6 +12637,14 @@
 Note that you are not allowed to set or change the @samp{state} of a burnable
 item. But you can investigate the kind of a burnable.
 
+Besides by @ref{Fire Spreading} the user can interact with burnable items with
+the following other objects:
+ at itemize @bullet
+ at item @ref{it_extinguisher} sprays @samp{fireproof} foam
+ at item @ref{it_brush} removes @samp{ash} and @samp{fireproof}
+ at item @ref{st_ice} removes all burnable besides @samp{oil} when being pushed over them
+ at end itemize
+
 @table @asis
 @item @b{Attributes:}
 @table @asis
@@ -12667,8 +12730,11 @@
 Indestructible floors like @ref{fl_abyss}, @ref{fl_water}, @ref{fl_swamp} will
 never crack. As any other item cracks do block laser light and prohibit other items to be
 dropped on the same grid. Nearby fire, explosions and hitting 
- at ref{ot_cannonball}s will dissolve a crack.
+ at ref{ot_cannonball}s will dissolve a crack by another step.
 
+On the other hand @ref{st_ice} will putty any existing crack when being pushed 
+over it.
+
 @table @asis
 
 @item @b{Attributes:}
@@ -13130,6 +13196,9 @@
 top will start in state @samp{ON} without sending actions due to the
 @ref{Snapshot Principle}.
 
+Note that a dot is freezable by an @ref{st_ice} and can thus be delocated to
+another position.
+
 @table @asis
 @item @b{Attributes:}
 @table @asis
@@ -13195,8 +13264,8 @@
 a stone over it.
 
 The squashed remnants are scarcely visible on some floor types. The player can
-not pick them up. But it can be wiped away by application of an @ref{it_brush}
-or by a nearby exploding @ref{it_bomb}.
+not pick them up. But it can be wiped away by application of an @ref{it_brush},
+by a nearby exploding @ref{it_bomb} or by an @ref{st_ice} being pushed over it.
 
 @table @asis
 @item @b{Attributes:}
@@ -13561,7 +13630,7 @@
 
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
 @item @image{images/st_ancient} @tab @yref{st_ancient}
- at tab                            @tab @yref{st_bluegray}
+ at tab @image{images/st_bluegray} @tab @yref{st_bluegray}
 @tab @image{images/st_brownie} @tab @yref{st_brownie}
 @item @image{images/st_brownmarble} @tab @yref{st_brownmarble}
 @tab @image{images/st_camouflage} @tab @yref{st_camouflage}
@@ -14976,9 +15045,9 @@
 @subsection st_death
 @obindex st_death
 
-Shatters any marble that hits or even just touches it. Just marbles protected
-by an activated @ref{it_umbrella} will bounce unharmed as other actors do which
-will not die anyway.
+Shatters any @ref{ac_marble} and @ref{ac_pearl} that hits or even just touches
+it. Just marbles and pearls protected by an activated @ref{it_umbrella} will
+bounce unharmed as other actors do which will not die anyway.
 
 Death stones can be configured by the @samp{invisible} attribute to
 be hidden while being idle. When hit by an actor any death stone becomes
@@ -14990,6 +15059,24 @@
 @ref{ExtralifeGlasses} even glasses generated by laser lighting an
 @ref{it_extralife} can be configured not to show invisible actorimpulse stones.
 
+A death stone can also be movable. Of course ball like actors can not push it.
+But other actors can push it. A movable death stone can be connected by an 
+ at ref{ot_wire} to another movable stone that allows to control it. Furtheron
+all stones emitting stone impulses like @ref{st_stoneimpulse}, @ref{st_rotator},
+ at ref{st_lightpassenger} can move it. And finally a pushing @ref{st_boulder}
+will move it until an obstacle stops the death stone.
+
+A movable death stone looks identical to the static default version. But from
+time to time it will show its animation and can thus be identified by the user.
+The interval of the animations is determined by the attribute @samp{interval},
+but will randomly vary up to 20% from the given value. When the @samp{interval}
+equals zero no animation will reveal the movable death. But any @ref{it_glasses}
+capable of @samp{SPOT_DEATH} will show the movable death in a lighter stone
+color than the static ones.
+
+A @samp{movable} death can not be @samp{invisible} at the same time. If you set
+both attributes the last attribute set wins and resets the first one.
+
 @table @asis
 
 @item @b{Attributes:}
@@ -14999,6 +15086,12 @@
 a hitting actor.
 @item @b{invisible} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
 Invisible death stones show only when hit by an actor or been toggled by a message.
+Setting this attribute to @samp{true} sets @samp{movable} to @samp{false}.
+ at item @b{movable} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @xref{movable}
+Movable death stone. Setting this attribute to @samp{true} sets @samp{invisible}
+to @samp{false}.
+ at item @b{interval} @ @ @i{values}: positive number; @ @ @i{default}: @code{10.0}
+Number of seconds to show animation on movable death.
 @end table
 
 @item @b{Messages:}
@@ -15014,11 +15107,11 @@
 @table @asis
 @item @b{st_death}: invisible = @code{false}
 @item @b{st_death_invisible}: invisible = @code{true}
+ at item @b{st_death_movable}: movable = @code{true}
 @end table
 
 @end table
 
-
 @c ----------------- Disco Stone --------------------
 @node st_disco
 @subsection st_disco
@@ -15582,15 +15675,68 @@
 being pushed over it. But a block of ice can be destroyed by explosions and by
 heating fire leaving either @ref{fl_ice} or @ref{fl_water}.
 
-Note some minor details of st_ice are not yet stable - especially the fire
-interactions may still change.
+When an ice block without frozen item is pushed onto a grid with an 
+ at ref{freezable} item, the ice will freeze the item and will move it beneath
+itself on subsequent pushes. All items that the user can cary in his inventory
+are @ref{freezable} and even some @ref{Static Items} like @ref{it_magnet}, 
+ at ref{it_springboard}, etc. But a few items react in a special manner when an
+ice block is pushed onto them:
+ at itemize @bullet
+ at item @ref{it_squashed} and @ref{it_burnable}, with the exception of 
+ at samp{it_burnable_oil}, dissolve to nothing. 
+ at item @ref{it_crack} will vanish as the ice is putty for the cracked floors
+ at item @ref{it_seed} will not start growing, even though the ice is pushed as a
+solid stone on top.
+ at item @ref{it_bomb} will explode and destroy the ice block as well as the floor.
+ at item @ref{it_dynamite} is very special - a burning dynamite gets extinguished
+by an ice block and becomes frozen in its idle state.
+ at end itemize
 
+But what happens when an ice block with a frozen items gets pushed onto a grid
+with another item? The stronger item wins and survives beneath the ice block
+on the new position while the weaker item will be killed. The sequence from
+weak to strong is quite simple:
+ at itemize @bullet
+ at item static items that get anyway wiped out by an ice block
+ at item @ref{Liftable Items}
+ at item @ref{portable} items that are not @ref{liftable}
+ at item @ref{freezable} items that are not @ref{portable}
+ at item @ref{Static Items} that are not @ref{freezable}
+ at end itemize
+When the two items are of the same category the already frozen item wins. This
+last rule ensures that the user can not free frozen items by dropping a liftable
+item out of his inventory in front of an ice block before pushing it.
+
+An ice block looks like a bluish version of @ref{st_rawglass}. But it has just
+one feature in common. It is transparent to laser light. Of course you can not
+freeze laser beams, even though they are implemented in the item layer. Laser
+light will interact even with frozen items and can ignite @ref{it_dynamite} or
+ at ref{it_bomb}. Even though being light transparent invisible actors can not
+pass it (@pxref{Transparent Stones}).
+
+Ice blocks shatter on nearby @ref{it_bomb} and @ref{it_dynamite} explosions and
+on @ref{ot_cannonball} hits. The ice will spead to the four direct neighboring
+grid positions and will cover these and the originating position with 
+ at ref{fl_ice}. Just @ref{fl_abyss} will not be covered by this ice floor and
+remains unchanged. Thus an exploding bomb leaves an @ref{fl_abyss} at its
+position, even when an ice blocks shatters nearby.
+
+A fire starting to burn on a direct neighbor position will eventually melt the
+ice block by its @ref{Heat-Transformation}. The ice will melt to an 
+ at ref{fl_water}. Just in case the ice block melts over an @ref{fl_abyss} the
+floor remains unchanged. The ice heating is no secure feature, as the heat burst
+occurs just once for each fire. Thus a user may be able to push an ice block
+aside a fire without heat transformation. Furtheron the melting takes time.
+Any intermediate nearby explosion can still shatter the melting ice block.
+
 @table @asis
 @item @b{Messages:}
 
 @table @asis
 @item @b{ignite} @ @ @xref{ignite}
+Shatter the ice block.
 @item @b{heat} @ @ @xref{heat}
+Melt the ice block
 @end table
 
 @item @b{Variants:}
@@ -17104,6 +17250,7 @@
 @item @ref{st_yinyang} do toggle,
 @item @ref{st_puzzle} do explode completely connected clusters, 
 @item @ref{st_brownpyramide} do break,
+ at item @ref{st_spitter} do break, if not being @samp{secure}
 @item other stones do remain unmodified and protect items and floors,
 @item @ref{it_dynamite} do ignite,
 @item @ref{it_crack} do crack,
@@ -17156,6 +17303,7 @@
 @item @b{destination}, @ @ @i{values}: tokens or position; @ @ @i{default}: @code{nil} @ @ @xref{destination}
 The destination of the cannonball given by an object or a position.
 @item @b{secure} @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}
+Unsecure spitters do break on a @ref{ot_cannonball} hit.
 @end table
 
 @item @b{Messages:}
@@ -17916,6 +18064,7 @@
 @item @ref{st_polarswitch} @tab st_polarswitch_off @tab toggle @tab pass @tab no
 @item @ref{st_beads} @tab st_beads @tab leave @tab pass @tab no
 @item @ref{st_lightpassenger} @tab st_lightpassenger_off @tab rebound @tab rebound @tab no
+ at item @ref{st_ice} @tab st_ice @tab push @tab push @tab yes
 @item @ref{st_invisible} @tab st_invisible @tab rebound @tab rebound @tab no
 @item @ref{st_invisible} @tab st_invisible_movable @tab push @tab push @tab no
 @item @ref{st_invisible} @tab st_invisible_hollow @tab pass @tab pass @tab no
@@ -20843,9 +20992,9 @@
 @end example
 
 @item @b{Details:}
+Cell
 
 
-
 @item @b{Full Example:}
 @example
 ti[" "] = @{"fl_sahara"@}



From ral at mail.berlios.de  Sun May 24 22:49:37 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 24 May 2009 22:49:37 +0200
Subject: [Enigma-game-svn] r1683 - in trunk: data src src/items src/stones
Message-ID: <200905242049.n4OKnb7V009507@sheep.berlios.de>

Author: ral
Date: 2009-05-24 22:49:35 +0200 (Sun, 24 May 2009)
New Revision: 1683

Modified:
   trunk/data/api2init.lua
   trunk/src/items/Bomb.cc
   trunk/src/items/Bomb.hh
   trunk/src/lua.cc
   trunk/src/stones/DeathStone.cc
   trunk/src/stones/IceBlock.cc
Log:
Trunk 1.1:
- group:sort("circular") fix limitation to GridObject, support Actors, too
- st_death_movable: disable push of stone by unshielded balls
- st_ice: break on ot_cannonball hits
- it_bomb: on stone hit explode within 0.01 s to avoid level shortcuts
- DIRNUM2OFF a Lua table for convertion of direction numbers to offsets

Modified: trunk/data/api2init.lua
===================================================================
--- trunk/data/api2init.lua	2009-05-24 12:26:56 UTC (rev 1682)
+++ trunk/data/api2init.lua	2009-05-24 20:49:35 UTC (rev 1683)
@@ -161,6 +161,9 @@
 NEIGHBORS_8     = NEIGHBORS_4 .. NW .. SW ..SE .. NE
 NEIGHBORS_CHESS = NNE .. ENE .. ESE .. SSE .. SSW .. WSW .. WNW .. NNW
 
+-- convertion direction numbers to offset vectors
+DIRNUM2OFF = {[0]=W, S, E, N}
+
 -- essential
 DISPENSIBLE   = 0
 INDISPENSIBLE = 1

Modified: trunk/src/items/Bomb.cc
===================================================================
--- trunk/src/items/Bomb.cc	2009-05-24 12:26:56 UTC (rev 1682)
+++ trunk/src/items/Bomb.cc	2009-05-24 20:49:35 UTC (rev 1683)
@@ -32,6 +32,10 @@
             state = BURNING;
     }
     
+    Bomb::~Bomb() {
+        GameTimer.remove_alarm(this);
+    }
+    
     std::string Bomb::getClass() const {
         return "it_bomb";
     }
@@ -107,6 +111,11 @@
         }
     }
     
+    void Bomb::alarm() {
+        GameTimer.remove_alarm(this);
+        explode();
+    }
+    
     void Bomb::burn() {
         if (state == IDLE) {
             state = BURNING;
@@ -115,11 +124,9 @@
     }
     
     void Bomb::ignite() {
-        if (state == IDLE) {
-            state = BURNING;
-            std::string color = (getAttr("color") == BLACK) ? "black" : "white";
-            set_anim(ecl::strf("it_bomb_%s_exploding", color.c_str()));   // shortened burning
-        }
+        state = IDLE;   // abort any burning process and explode as soon as possible
+        init_model();
+        GameTimer.set_alarm(this, 0.01, false);
     }
     
     void Bomb::explode() {

Modified: trunk/src/items/Bomb.hh
===================================================================
--- trunk/src/items/Bomb.hh	2009-05-24 12:26:56 UTC (rev 1682)
+++ trunk/src/items/Bomb.hh	2009-05-24 20:49:35 UTC (rev 1683)
@@ -28,7 +28,7 @@
      * 
      */
 
-    class Bomb : public Item {
+    class Bomb : public Item, public TimeHandler {
         CLONEOBJ(Bomb);
         DECL_ITEMTRAITS_ARRAY(2, traitsIdx());
 
@@ -40,6 +40,7 @@
         
     public:
         Bomb(int color, bool burning =false);
+        virtual ~Bomb();
         
         // Object interface
         virtual std::string getClass() const;
@@ -60,6 +61,9 @@
         virtual std::string get_inventory_model();
         virtual void on_stonehit(Stone *st);
         
+        // TimeHandler interface
+        virtual void alarm();
+
     private:
         void burn();
         void ignite();

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2009-05-24 12:26:56 UTC (rev 1682)
+++ trunk/src/lua.cc	2009-05-24 20:49:35 UTC (rev 1683)
@@ -3169,11 +3169,10 @@
         double cy = 0;  // center
         int num = 0;
         for (ObjectList::iterator itr = oldSort.begin(); itr != oldSort.end(); ++itr) {
-            GridObject *go = dynamic_cast<GridObject *>(*itr);
-            if (go != NULL) {
-                GridPos p = go->get_pos();
-                cx += p.x;
-                cy += p.y;
+            if (*itr != NULL) {
+                ecl::V2 pos = Value(*itr);
+                cx += pos[0];
+                cy += pos[1];
                 num++;
             } 
         }
@@ -3181,10 +3180,9 @@
             cx = cx/num;
             cy = cy/num;
             for (ObjectList::iterator itr = oldSort.begin(); itr != oldSort.end(); ++itr) {
-                GridObject *go = dynamic_cast<GridObject *>(*itr);
-                if (go != NULL) {
-                    GridPos p = go->get_pos();
-                    double alpha = std::atan2(p.y - cy, p.x - cx); 
+                if (*itr != NULL) {
+                    ecl::V2 pos = Value(*itr);
+                    double alpha = std::atan2(pos[1] - cy, pos[0] - cx); 
                     sortMap[alpha] = *itr;
                 }
             }

Modified: trunk/src/stones/DeathStone.cc
===================================================================
--- trunk/src/stones/DeathStone.cc	2009-05-24 12:26:56 UTC (rev 1682)
+++ trunk/src/stones/DeathStone.cc	2009-05-24 20:49:35 UTC (rev 1683)
@@ -21,7 +21,7 @@
 #include "stones/DeathStone.hh"
 
 #include "items/GlassesItem.hh"
-#include "main.hh"
+//#include "main.hh"
 
 namespace enigma {
     DeathStone::DeathStone(bool isInvisible, bool isMovable) : Stone () {
@@ -141,7 +141,8 @@
     
     void DeathStone::actor_hit(const StoneContact &sc) {
         actor_touch(sc);
-        Stone::actor_hit(sc);
+        if (sc.actor->has_shield())   // just shielded actors are allowed to push this stone
+            Stone::actor_hit(sc);
     }
 
     void DeathStone::actor_touch(const StoneContact &sc) {

Modified: trunk/src/stones/IceBlock.cc
===================================================================
--- trunk/src/stones/IceBlock.cc	2009-05-24 12:26:56 UTC (rev 1682)
+++ trunk/src/stones/IceBlock.cc	2009-05-24 20:49:35 UTC (rev 1683)
@@ -32,7 +32,7 @@
     }
     
     Value IceBlock::message(const Message &m) {
-        if (m.message == "_explosion" || m.message == "ignite") {
+        if (m.message == "_explosion" || m.message == "ignite" || m.message == "_cannonball") {
             if (isDisplayable()) {
                 state = BREAKING;
                 set_anim("st_ice_breaking");



From ral at mail.berlios.de  Mon May 25 00:47:45 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Mon, 25 May 2009 00:47:45 +0200
Subject: [Enigma-game-svn] r1684 - in trunk: data src/stones
Message-ID: <200905242247.n4OMljgJ029938@sheep.berlios.de>

Author: ral
Date: 2009-05-25 00:47:44 +0200 (Mon, 25 May 2009)
New Revision: 1684

Modified:
   trunk/data/models-2d.lua
   trunk/src/stones/IceBlock.cc
   trunk/src/stones/IceBlock.hh
Log:
Trunk 1.1:
- st_ice: melt by anim, melt is slower than break, break overrides a melting


Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-24 20:49:35 UTC (rev 1683)
+++ trunk/data/models-2d.lua	2009-05-24 22:47:44 UTC (rev 1684)
@@ -599,9 +599,6 @@
     local images = DefSubimages("it_bomb_black_burning", {h=9})
     local frames = BuildFrames(images, 100)
     DefAnim("it_bomb_black_burning", frames)
-    
-    local frames = BuildFrames({"it_bomb_black_burning8", "it_bomb_black_burning9"},120)
-    DefAnim("it_bomb_black_exploding", frames)
 end
 
 -- Burning white bomb --
@@ -1034,6 +1031,10 @@
     local frames = BuildFrames(images,50)
     DefAnim("st_ice_break-anim", frames)
     DefShModel("st_ice_breaking", "st_ice_break-anim", "sh-glass")
+
+    local frames = BuildFrames(images,100)
+    DefAnim("st_ice_melt-anim", frames)
+    DefShModel("st_ice_melting", "st_ice_melt-anim", "sh-glass")
 end
 
 -- st-knight --

Modified: trunk/src/stones/IceBlock.cc
===================================================================
--- trunk/src/stones/IceBlock.cc	2009-05-24 20:49:35 UTC (rev 1683)
+++ trunk/src/stones/IceBlock.cc	2009-05-24 22:47:44 UTC (rev 1684)
@@ -33,33 +33,40 @@
     
     Value IceBlock::message(const Message &m) {
         if (m.message == "_explosion" || m.message == "ignite" || m.message == "_cannonball") {
-            if (isDisplayable()) {
+            if (isDisplayable() && state != BREAKING) {  // priorise explosion over melting
                 state = BREAKING;
                 set_anim("st_ice_breaking");
             }
             return Value();
         } else if (m.message == "heat") {
-            if (isDisplayable()) {
-                GridPos p = get_pos();
-                setNoAbyssFloor(p, "fl_water");
-                KillStone(p);
+            if (isDisplayable() && state == IDLE) {
+                state = MELTING;
+                set_anim("st_ice_melting");
             }
             return Value();            
         }
         return Stone::message(m);
     }
     
+    void IceBlock::setState(int extState) {
+        // block all state write attempts
+    }
+    
     void IceBlock::init_model() {
         set_model("st_ice");
     }
     
     void IceBlock::animcb() {
         GridPos p = get_pos();
-        setNoAbyssFloor(p, "fl_ice");
-        setNoAbyssFloor(move(p, NORTH), "fl_ice");
-        setNoAbyssFloor(move(p, EAST), "fl_ice");
-        setNoAbyssFloor(move(p, SOUTH), "fl_ice");
-        setNoAbyssFloor(move(p, WEST), "fl_ice");
+        if (state == BREAKING) {
+            setNoAbyssFloor(p, "fl_ice");
+            setNoAbyssFloor(move(p, NORTH), "fl_ice");
+            setNoAbyssFloor(move(p, EAST), "fl_ice");
+            setNoAbyssFloor(move(p, SOUTH), "fl_ice");
+            setNoAbyssFloor(move(p, WEST), "fl_ice");
+        } else {  // MELTING
+            setNoAbyssFloor(p, "fl_water");
+        }
         KillStone(p);
     }
     
@@ -67,8 +74,12 @@
         return true;
     }
     
+    bool IceBlock::is_removable() const {
+        return state == IDLE;
+    }
+    
     bool IceBlock::is_movable() const {
-        return (state != BREAKING) ? Stone::is_movable() : false;
+        return (state == IDLE) ? Stone::is_movable() : false;
     }
     
     bool IceBlock::on_move(const GridPos &origin) {

Modified: trunk/src/stones/IceBlock.hh
===================================================================
--- trunk/src/stones/IceBlock.hh	2009-05-24 20:49:35 UTC (rev 1683)
+++ trunk/src/stones/IceBlock.hh	2009-05-24 22:47:44 UTC (rev 1684)
@@ -36,6 +36,7 @@
         enum iState {
             IDLE,           ///< 
             BREAKING,       ///< 
+            MELTING         ///< 
         };
     public:
         IceBlock();
@@ -44,6 +45,9 @@
         virtual std::string getClass() const;
         virtual Value message(const Message &m);
         
+        // StateObject interface
+        virtual void setState(int extState);
+
         // GridObject interface
         virtual void init_model();
         
@@ -52,6 +56,7 @@
         
         // Stone interface
         virtual bool is_transparent(Direction d) const;
+        virtual bool is_removable() const;
         virtual bool is_movable() const;
         virtual bool on_move(const GridPos &origin);
         



From raoul at mail.berlios.de  Mon May 25 12:03:46 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Mon, 25 May 2009 12:03:46 +0200
Subject: [Enigma-game-svn] r1686 - trunk/data/levels/enigma_experimental
Message-ID: <200905251003.n4PA3kO5028992@sheep.berlios.de>

Author: raoul
Date: 2009-05-25 12:03:44 +0200 (Mon, 25 May 2009)
New Revision: 1686

Modified:
   trunk/data/levels/enigma_experimental/stones_1.xml
Log:
-> Update of the all-stones testlevel



Modified: trunk/data/levels/enigma_experimental/stones_1.xml
===================================================================
--- trunk/data/levels/enigma_experimental/stones_1.xml	2009-05-25 01:06:55 UTC (rev 1685)
+++ trunk/data/levels/enigma_experimental/stones_1.xml	2009-05-25 10:03:44 UTC (rev 1686)
@@ -162,6 +162,7 @@
 
 {"st_death", _text="st_death, default"},
 {"st_death", invisible=true, _text="st_death, invisible=true"},
+{"st_death_movable", _text="st_death, movable=true"},
 
 {"st_disco", _text="st_disco, default"},
 {"st_disco", state=LIGHT, _text="st_disco, state=LIGHT"},
@@ -230,6 +231,8 @@
 {"st_greenbrown_movable", _text="st_greenbrown_movable"},
 {"st_greenbrown_growing", _text="st_greenbrown_growing"},
 
+{"st_ice", _text="st_ice"},
+
 {"st_jamb", _text="st_jamb, default"},
 {"st_jamb", color=BLACK, _text="st_jamb, color=BLACK"},
 {"st_jamb", color=WHITE, _text="st_jamb, color=WHITE"},



From raoul at mail.berlios.de  Mon May 25 12:07:54 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Mon, 25 May 2009 12:07:54 +0200
Subject: [Enigma-game-svn] r1687 - team_levelpacks/team_test_new_api
Message-ID: <200905251007.n4PA7sM2029273@sheep.berlios.de>

Author: raoul
Date: 2009-05-25 12:07:54 +0200 (Mon, 25 May 2009)
New Revision: 1687

Added:
   team_levelpacks/team_test_new_api/raoulT10_1.xml
Log:
-> Testlevel for sort(...) of circular arranged actors


Added: team_levelpacks/team_test_new_api/raoulT10_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/raoulT10_1.xml	2009-05-25 10:03:44 UTC (rev 1686)
+++ team_levelpacks/team_test_new_api/raoulT10_1.xml	2009-05-25 10:07:54 UTC (rev 1687)
@@ -0,0 +1,88 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Test sort actors circular" el:subtitle="" el:id="raoult10"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="experimental"/>
+      <el:author  el:name="Raoul Bourquin" el:email=""/>
+      <el:copyright>Copyright ? 2009 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_dark"}
+ti["#"] = {"st_panel"}
+
+ti["a"] = {"ac_killer", name="killer1#"}
+ti["b"] = {"ac_killer", name="killer2#"}
+ti["c"] = {"ac_killer", name="killer3#"}
+
+ti["1"] = {"ac_marble_black", 0.0, 0.5, name="blackball1"}
+ti["2"] = {"ac_marble_black", 0.0, 0.5, name="blackball2"}
+ti["3"] = {"ac_marble_black", 0.0, 0.5, name="blackball3"}
+
+wo(ti, " ", {
+    "####################",
+    "#                  #",
+    "#                  #",
+    "#    1             #",
+    "#                  #",
+    "#                  #",
+    "#         2        #",
+    "#                  #",
+    "#                  #",
+    "#              3   #",
+    "#                  #",
+    "#                  #",
+    "####################"})
+
+local number = 10
+local radius = cond(wo["IsDifficult"], 1.5, 2.5)
+local theta = 2.0*math.pi/number
+local segment = 2.0*radius*math.sin(theta/2.0)
+
+
+for i=0, number-1 do
+    wo[no["blackball1"] + po(0.0, 0.5) + po(radius*math.cos(i*theta), radius*math.sin(i*theta))] = ti["a"]
+end
+print(no["killer1#*"])
+actors = no["killer1#*"]:sort()
+print(#actors)
+for i=0, #actors-1 do
+    wo:add({"ot_rubberband", anchor1=actors[i+1], anchor2=actors[(i+1)%number+1], length=segment})
+end
+
+
+
+for i=0, number-1 do
+    wo[no["blackball2"] + po(0.0, 0.5) + po(radius*math.cos(i*theta), radius*math.sin(i*theta))] = ti["b"]
+end
+print(no["killer2#*"])
+actors = no["killer2#*"]:sort("linear")
+print(#actors)
+for i=0, #actors-1 do
+    wo:add({"ot_rubberband", anchor1=actors[i+1], anchor2=actors[(i+1)%number+1], length=segment})
+end
+
+
+
+for i=0, number-1 do
+    wo[no["blackball3"] + po(0.0, 0.5) + po(radius*math.cos(i*theta), radius*math.sin(i*theta))] = ti["c"]
+end
+print(no["killer3#*"])
+actors = no["killer3#*"]:sort("circular")
+print(#actors)
+for i=0, #actors-1 do
+    wo:add({"ot_rubberband", anchor1=actors[i+1], anchor2=actors[(i+1)%number+1], length=segment})
+end
+
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: team_levelpacks/team_test_new_api/raoulT10_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native



From ral at mail.berlios.de  Tue May 26 00:46:24 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Tue, 26 May 2009 00:46:24 +0200
Subject: [Enigma-game-svn] r1688 - trunk/src
Message-ID: <200905252246.n4PMkOPS010293@sheep.berlios.de>

Author: ral
Date: 2009-05-26 00:46:22 +0200 (Tue, 26 May 2009)
New Revision: 1688

Modified:
   trunk/src/server.cc
Log:
Trunk 1.1: 
- remove compatibility support of Lua 4.* libraries for 1.10 new API levels

Modified: trunk/src/server.cc
===================================================================
--- trunk/src/server.cc	2009-05-25 10:07:54 UTC (rev 1687)
+++ trunk/src/server.cc	2009-05-25 22:46:22 UTC (rev 1688)
@@ -301,7 +301,7 @@
     int api = (server::EnigmaCompatibility < 1.10) ? 1 : 2;
     lua::ShutdownLevel();
     lua_State *L = lua::InitLevel(api);
-    if (lua::DoSysFile(L, "compat.lua") != lua::NO_LUAERROR) {
+    if (api == 1 && lua::DoSysFile(L, "compat.lua") != lua::NO_LUAERROR) {
         throw XLevelLoading("While processing 'compat.lua':\n"+lua::LastError(L));
     }
     if (lua::DoSysFile(L, ecl::strf("api%dinit.lua", api)) != lua::NO_LUAERROR) {



From andreasl at mail.berlios.de  Thu May 28 23:19:48 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Thu, 28 May 2009 23:19:48 +0200
Subject: [Enigma-game-svn] r1689 - in trunk/data: . levels/lib
Message-ID: <200905282119.n4SLJm79023351@sheep.berlios.de>

Author: andreasl
Date: 2009-05-28 23:19:46 +0200 (Thu, 28 May 2009)
New Revision: 1689

Modified:
   trunk/data/api2init.lua
   trunk/data/levels/lib/libmaze_2.xml
   trunk/data/levels/lib/libpento_1.xml
Log:
Trunk:
 - Fix r1678: Accept "maze" as type for resolvers.
   (This bug only happened when res.maze was used with active assertions.)


Modified: trunk/data/api2init.lua
===================================================================
--- trunk/data/api2init.lua	2009-05-25 22:46:22 UTC (rev 1688)
+++ trunk/data/api2init.lua	2009-05-28 21:19:46 UTC (rev 1689)
@@ -218,7 +218,7 @@
         -- world, resolver, (position|object|table), string, (table|map), [int]
         -- world, resolver, (position|object|table), map, [int]
         assert_type(world, "wo:drawMap self (world)", 2, "world")
-        assert_type(resolver, "wo:drawMap first argument (resolver)", 2, "tiles", "function", "table")
+        assert_type(resolver, "wo:drawMap first argument (resolver)", 2, "tiles", "function", "table", "maze")
         assert_type(anchor, "wo:drawMap second argument (anchor)", 2, "position", "valid object", "table")
         assert_type(arg3, "wo:drawMap third argument (ignorekey or map)", 2, "string", "map")
         local origin = po(anchor)   -- either convert or make a working position copy
@@ -439,7 +439,7 @@
 function res.random(subresolver, hits, replacements)
     -- syntax: hits = key | {key, [key]*, [{key, superkey}]*}
     --         replacements = {key, [key]*, [{key, frequency}]*}
-    assert_type(subresolver, "res.random first argument (subresolver)", 2, "tiles", "function", "table")
+    assert_type(subresolver, "res.random first argument (subresolver)", 2, "tiles", "function", "table", "maze")
     assert_type(hits, "res.random second argument (hits)", 2, "non-empty string", "table")
     assert_type(hits, "res.random third argument (replacements)", 2, "string", "table")
     local hit_table = {}
@@ -561,7 +561,7 @@
 function res.autotile(subresolver, ...)
     -- syntax: ... = <{prefixkey, template} | {firstkey, lastkey, template[, offset]}>
     -- context: [4] = table with unmodified rule tables
-    assert_type(subresolver, "res.autotile first argument (subresolver)", 2, "tiles", "function", "table")
+    assert_type(subresolver, "res.autotile first argument (subresolver)", 2, "tiles", "function", "table", "maze")
     local args = {...}
     for i, rule in ipairs(args) do
         assert_type(rule, "res.autotile argument " .. (i+1) .. " (rule " .. i .. ")", 2, "table")
@@ -627,7 +627,7 @@
 end
 
 function res.composer(subresolver, ...)
-    assert_type(subresolver, "res.composer first argument (subresolver)", 2, "tiles", "function", "table")
+    assert_type(subresolver, "res.composer first argument (subresolver)", 2, "tiles", "function", "table", "maze")
     local args = {...}
     local sequence = nil
     assert_bool(#args <= 1, "res.composer: Too many arguments (must be 1 or 2)." ,2)

Modified: trunk/data/levels/lib/libmaze_2.xml
===================================================================
--- trunk/data/levels/lib/libmaze_2.xml	2009-05-25 22:46:22 UTC (rev 1688)
+++ trunk/data/levels/lib/libmaze_2.xml	2009-05-28 21:19:46 UTC (rev 1689)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="library">
       <el:identity el:title="" el:id="lib/libmaze"/>
-      <el:version el:score="1" el:release="2" el:revision="7" el:status="released"/>
+      <el:version el:score="1" el:release="2" el:revision="8" el:status="released"/>
       <el:author  el:name="Ronald Lamprecht" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2009 Ronald Lamprecht</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -156,7 +156,7 @@
         }
         
     -- argument evaluation
-    assert_type(subresolver, "res.maze first argument (subresolver)", 2, "tiles", "function", "table")
+    assert_type(subresolver, "res.maze first argument (subresolver)", 2, "tiles", "function", "table", "maze")
     assert_bool(#args == 1, "res.maze: wrong number of arguments - expected subresolver and a table of configuration data.", 2)
     assert_type(args[1], "res.maze second argument (libmaze configuration data)", 2, "table")
     context.area = args[1].area

Modified: trunk/data/levels/lib/libpento_1.xml
===================================================================
--- trunk/data/levels/lib/libpento_1.xml	2009-05-25 22:46:22 UTC (rev 1688)
+++ trunk/data/levels/lib/libpento_1.xml	2009-05-28 21:19:46 UTC (rev 1689)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="library">
       <el:identity el:title="" el:id="lib/libpento"/>
-      <el:version el:score="1" el:release="1" el:revision="2" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="3" el:status="released"/>
       <el:author  el:name="Ronald Lamprecht" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2009 Ronald Lamprecht</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -107,7 +107,7 @@
     -- syntax: ... = <sourcebasename>, <targetbasename>
     -- context: 
     local args = {...}
-    assert_type(subresolver, "res.pento first argument (subresolver)", 2, "tiles", "function", "table")
+    assert_type(subresolver, "res.pento first argument (subresolver)", 2, "tiles", "function", "table", "maze")
     assert_type(args[1], "res.pento second argument (source basename)", 2, "string")
     assert_type(args[2], "res.pento third argument (target basename)", 2, "string")
     local autotile = res.autotile(subresolver, {"O","Z", "pentopuzzle"})



From ral at mail.berlios.de  Fri May 29 00:35:42 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Fri, 29 May 2009 00:35:42 +0200
Subject: [Enigma-game-svn] r1690 - in trunk: data data/gfx32 data/gfx40
	data/gfx48 data/levels/lib src src/gui src/items src/stones
Message-ID: <200905282235.n4SMZgnK000664@sheep.berlios.de>

Author: ral
Date: 2009-05-29 00:35:28 +0200 (Fri, 29 May 2009)
New Revision: 1690

Added:
   trunk/data/gfx32/it_blocker.png
   trunk/data/gfx32/it_coin_l.png
   trunk/data/gfx32/it_coin_m.png
   trunk/data/gfx32/it_coin_s.png
   trunk/data/gfx32/it_laser.png
   trunk/data/gfx32/it_magnet_off.png
   trunk/data/gfx32/it_magnet_on.png
   trunk/data/gfx32/it_pipe.png
   trunk/data/gfx32/it_seed.png
   trunk/data/gfx32/it_shogun_l.png
   trunk/data/gfx32/it_shogun_m.png
   trunk/data/gfx32/it_shogun_s.png
   trunk/data/gfx32/it_trigger.png
   trunk/data/gfx32/it_vortex.png
   trunk/data/gfx32/it_wormhole.png
   trunk/data/gfx40/it_blocker.png
   trunk/data/gfx40/it_coin_l.png
   trunk/data/gfx40/it_coin_m.png
   trunk/data/gfx40/it_coin_s.png
   trunk/data/gfx40/it_laser.png
   trunk/data/gfx40/it_magnet_off.png
   trunk/data/gfx40/it_magnet_on.png
   trunk/data/gfx40/it_pipe.png
   trunk/data/gfx40/it_seed.png
   trunk/data/gfx40/it_shogun_l.png
   trunk/data/gfx40/it_shogun_m.png
   trunk/data/gfx40/it_shogun_s.png
   trunk/data/gfx40/it_trigger.png
   trunk/data/gfx40/it_vortex.png
   trunk/data/gfx40/it_wormhole.png
   trunk/data/gfx48/it_blocker.png
   trunk/data/gfx48/it_coin_l.png
   trunk/data/gfx48/it_coin_m.png
   trunk/data/gfx48/it_coin_s.png
   trunk/data/gfx48/it_laser.png
   trunk/data/gfx48/it_magnet_off.png
   trunk/data/gfx48/it_magnet_on.png
   trunk/data/gfx48/it_pipe.png
   trunk/data/gfx48/it_seed.png
   trunk/data/gfx48/it_shogun_l.png
   trunk/data/gfx48/it_shogun_m.png
   trunk/data/gfx48/it_shogun_s.png
   trunk/data/gfx48/it_trigger.png
   trunk/data/gfx48/it_vortex.png
   trunk/data/gfx48/it_wormhole.png
Removed:
   trunk/data/gfx32/it-blocker.png
   trunk/data/gfx32/it-coin1.png
   trunk/data/gfx32/it-coin2.png
   trunk/data/gfx32/it-coin4.png
   trunk/data/gfx32/it-laser.png
   trunk/data/gfx32/it-magnet-off.png
   trunk/data/gfx32/it-magnet-on.png
   trunk/data/gfx32/it-pipe.png
   trunk/data/gfx32/it-seed.png
   trunk/data/gfx32/it-shogun-big.png
   trunk/data/gfx32/it-shogun-med.png
   trunk/data/gfx32/it-shogun-small.png
   trunk/data/gfx32/it-trigger.png
   trunk/data/gfx32/it-vortex.png
   trunk/data/gfx32/it-wormhole.png
   trunk/data/gfx40/it-blocker.png
   trunk/data/gfx40/it-coin1.png
   trunk/data/gfx40/it-coin2.png
   trunk/data/gfx40/it-coin4.png
   trunk/data/gfx40/it-laser.png
   trunk/data/gfx40/it-magnet-off.png
   trunk/data/gfx40/it-magnet-on.png
   trunk/data/gfx40/it-pipe.png
   trunk/data/gfx40/it-seed.png
   trunk/data/gfx40/it-shogun-big.png
   trunk/data/gfx40/it-shogun-med.png
   trunk/data/gfx40/it-shogun-small.png
   trunk/data/gfx40/it-trigger.png
   trunk/data/gfx40/it-vortex.png
   trunk/data/gfx40/it-wormhole.png
   trunk/data/gfx48/it-blocker.png
   trunk/data/gfx48/it-coin1.png
   trunk/data/gfx48/it-coin2.png
   trunk/data/gfx48/it-coin4.png
   trunk/data/gfx48/it-laser.png
   trunk/data/gfx48/it-magnet-off.png
   trunk/data/gfx48/it-magnet-on.png
   trunk/data/gfx48/it-pipe.png
   trunk/data/gfx48/it-seed.png
   trunk/data/gfx48/it-shogun-big.png
   trunk/data/gfx48/it-shogun-med.png
   trunk/data/gfx48/it-shogun-small.png
   trunk/data/gfx48/it-trigger.png
   trunk/data/gfx48/it-vortex.png
   trunk/data/gfx48/it-wormhole.png
Modified:
   trunk/data/api2init.lua
   trunk/data/levels/lib/libpuzzle_3.xml
   trunk/data/models-2d.lua
   trunk/src/actors.cc
   trunk/src/gui/MainMenu.cc
   trunk/src/items.hh
   trunk/src/items/BlockerItem.cc
   trunk/src/items/Coin.cc
   trunk/src/items/Magnet.cc
   trunk/src/items/SeedItem.cc
   trunk/src/items/Trigger.cc
   trunk/src/items/Vortex.cc
   trunk/src/items/WormHole.cc
   trunk/src/laser.cc
   trunk/src/stones/CoinSlot.cc
   trunk/src/stones/WindowStone.cc
   trunk/src/world.cc
Log:
Trunk 1.1:
- item image and model renaming: use underscore only, no more dashes
- it_ring: no more auto (unreliable) free respawn position calculation
- ORI2DIR = {[WEST]=W, [SOUTH]=S, [EAST]=E, [NORTH]=N, [NODIR]=po(0,0)}
- puzzle resolver: add check subresolver type
- st_window: do no longer shatter balls on green, secure windows

Modified: trunk/data/api2init.lua
===================================================================
--- trunk/data/api2init.lua	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/data/api2init.lua	2009-05-28 22:35:28 UTC (rev 1690)
@@ -162,7 +162,7 @@
 NEIGHBORS_CHESS = NNE .. ENE .. ESE .. SSE .. SSW .. WSW .. WNW .. NNW
 
 -- convertion direction numbers to offset vectors
-DIRNUM2OFF = {[0]=W, S, E, N}
+ORI2DIR = {[WEST]=W, [SOUTH]=S, [EAST]=E, [NORTH]=N, [NODIR]=po(0,0)}
 
 -- essential
 DISPENSIBLE   = 0

Deleted: trunk/data/gfx32/it-blocker.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-coin1.png
===================================================================
--- trunk/data/gfx32/it-coin1.png	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/data/gfx32/it-coin1.png	2009-05-28 22:35:28 UTC (rev 1690)
@@ -1,7 +0,0 @@
-?PNG
-
-
-??~C?y:??8{hK??????0???c?????JB???????{??s???
-?q?kU
-0??@>2nl?x??????7?G?P?0?!@qw@??s??^?\????8Q?"	?"
-??x1??}?sk????X? ?FG??sp?30z?o,%?$lK?>?6/?W??^?}?
\ No newline at end of file

Deleted: trunk/data/gfx32/it-coin2.png
===================================================================
--- trunk/data/gfx32/it-coin2.png	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/data/gfx32/it-coin2.png	2009-05-28 22:35:28 UTC (rev 1690)
@@ -1,8 +0,0 @@
-?PNG
-
-
-??c????|?<<`O?N??N?J???R?v(+??R#p`?pX'?;5??EP??=?O<?	zQ`???)0?1?? ?C7?????t?=rm*?g???=??FG?5?????{?V?p@?M??
-lt????(?=?X@ ??T?C?8???U?Q?z?8???L??=????
-4?(?k??P?u???2??Pi???????g???C?|?X?UD?j?????
-"?5??(
-??_??c?	??j???l????M????5Z??u??kE???=???:?}B???
\ No newline at end of file

Deleted: trunk/data/gfx32/it-coin4.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-laser.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-magnet-off.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-magnet-on.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-pipe.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-seed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-shogun-big.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-shogun-med.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-shogun-small.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-trigger.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-vortex.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/it-wormhole.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/it_blocker.png (from rev 1688, trunk/data/gfx32/it-blocker.png)

Copied: trunk/data/gfx32/it_coin_l.png (from rev 1688, trunk/data/gfx32/it-coin4.png)

Copied: trunk/data/gfx32/it_coin_m.png (from rev 1688, trunk/data/gfx32/it-coin2.png)

Copied: trunk/data/gfx32/it_coin_s.png (from rev 1688, trunk/data/gfx32/it-coin1.png)

Copied: trunk/data/gfx32/it_laser.png (from rev 1688, trunk/data/gfx32/it-laser.png)

Copied: trunk/data/gfx32/it_magnet_off.png (from rev 1688, trunk/data/gfx32/it-magnet-off.png)

Copied: trunk/data/gfx32/it_magnet_on.png (from rev 1688, trunk/data/gfx32/it-magnet-on.png)

Copied: trunk/data/gfx32/it_pipe.png (from rev 1688, trunk/data/gfx32/it-pipe.png)

Copied: trunk/data/gfx32/it_seed.png (from rev 1688, trunk/data/gfx32/it-seed.png)

Copied: trunk/data/gfx32/it_shogun_l.png (from rev 1688, trunk/data/gfx32/it-shogun-big.png)

Copied: trunk/data/gfx32/it_shogun_m.png (from rev 1688, trunk/data/gfx32/it-shogun-med.png)

Copied: trunk/data/gfx32/it_shogun_s.png (from rev 1688, trunk/data/gfx32/it-shogun-small.png)

Copied: trunk/data/gfx32/it_trigger.png (from rev 1688, trunk/data/gfx32/it-trigger.png)

Copied: trunk/data/gfx32/it_vortex.png (from rev 1688, trunk/data/gfx32/it-vortex.png)

Copied: trunk/data/gfx32/it_wormhole.png (from rev 1688, trunk/data/gfx32/it-wormhole.png)

Deleted: trunk/data/gfx40/it-blocker.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-coin1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-coin2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-coin4.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-laser.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-magnet-off.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-magnet-on.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-pipe.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-seed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-shogun-big.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-shogun-med.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-shogun-small.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-trigger.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-vortex.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/it-wormhole.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/it_blocker.png (from rev 1688, trunk/data/gfx40/it-blocker.png)

Copied: trunk/data/gfx40/it_coin_l.png (from rev 1688, trunk/data/gfx40/it-coin4.png)

Copied: trunk/data/gfx40/it_coin_m.png (from rev 1688, trunk/data/gfx40/it-coin2.png)

Copied: trunk/data/gfx40/it_coin_s.png (from rev 1688, trunk/data/gfx40/it-coin1.png)

Copied: trunk/data/gfx40/it_laser.png (from rev 1688, trunk/data/gfx40/it-laser.png)

Copied: trunk/data/gfx40/it_magnet_off.png (from rev 1688, trunk/data/gfx40/it-magnet-off.png)

Copied: trunk/data/gfx40/it_magnet_on.png (from rev 1688, trunk/data/gfx40/it-magnet-on.png)

Copied: trunk/data/gfx40/it_pipe.png (from rev 1688, trunk/data/gfx40/it-pipe.png)

Copied: trunk/data/gfx40/it_seed.png (from rev 1688, trunk/data/gfx40/it-seed.png)

Copied: trunk/data/gfx40/it_shogun_l.png (from rev 1688, trunk/data/gfx40/it-shogun-big.png)

Copied: trunk/data/gfx40/it_shogun_m.png (from rev 1688, trunk/data/gfx40/it-shogun-med.png)

Copied: trunk/data/gfx40/it_shogun_s.png (from rev 1688, trunk/data/gfx40/it-shogun-small.png)

Copied: trunk/data/gfx40/it_trigger.png (from rev 1688, trunk/data/gfx40/it-trigger.png)

Copied: trunk/data/gfx40/it_vortex.png (from rev 1688, trunk/data/gfx40/it-vortex.png)

Copied: trunk/data/gfx40/it_wormhole.png (from rev 1688, trunk/data/gfx40/it-wormhole.png)

Deleted: trunk/data/gfx48/it-blocker.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-coin1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-coin2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-coin4.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-laser.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-magnet-off.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-magnet-on.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-pipe.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-seed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-shogun-big.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-shogun-med.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-shogun-small.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-trigger.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-vortex.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/it-wormhole.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/it_blocker.png (from rev 1688, trunk/data/gfx48/it-blocker.png)

Copied: trunk/data/gfx48/it_coin_l.png (from rev 1688, trunk/data/gfx48/it-coin4.png)

Copied: trunk/data/gfx48/it_coin_m.png (from rev 1688, trunk/data/gfx48/it-coin2.png)

Copied: trunk/data/gfx48/it_coin_s.png (from rev 1688, trunk/data/gfx48/it-coin1.png)

Copied: trunk/data/gfx48/it_laser.png (from rev 1688, trunk/data/gfx48/it-laser.png)

Copied: trunk/data/gfx48/it_magnet_off.png (from rev 1688, trunk/data/gfx48/it-magnet-off.png)

Copied: trunk/data/gfx48/it_magnet_on.png (from rev 1688, trunk/data/gfx48/it-magnet-on.png)

Copied: trunk/data/gfx48/it_pipe.png (from rev 1688, trunk/data/gfx48/it-pipe.png)

Copied: trunk/data/gfx48/it_seed.png (from rev 1688, trunk/data/gfx48/it-seed.png)

Copied: trunk/data/gfx48/it_shogun_l.png (from rev 1688, trunk/data/gfx48/it-shogun-big.png)

Copied: trunk/data/gfx48/it_shogun_m.png (from rev 1688, trunk/data/gfx48/it-shogun-med.png)

Copied: trunk/data/gfx48/it_shogun_s.png (from rev 1688, trunk/data/gfx48/it-shogun-small.png)

Copied: trunk/data/gfx48/it_trigger.png (from rev 1688, trunk/data/gfx48/it-trigger.png)

Copied: trunk/data/gfx48/it_vortex.png (from rev 1688, trunk/data/gfx48/it-vortex.png)

Copied: trunk/data/gfx48/it_wormhole.png (from rev 1688, trunk/data/gfx48/it-wormhole.png)

Modified: trunk/data/levels/lib/libpuzzle_3.xml
===================================================================
--- trunk/data/levels/lib/libpuzzle_3.xml	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/data/levels/lib/libpuzzle_3.xml	2009-05-28 22:35:28 UTC (rev 1690)
@@ -180,6 +180,7 @@
 function res.puzzle(subresolver, ...)
     -- syntax: ... = <prefixkey>
     -- context: [4] = table with unmodified rule tables
+    assert_type(subresolver, "res.puzzle first argument (subresolver)", 2, "tiles", "function", "table", "maze")
     local args = {...}
     local length = 0
     for i, prefix in ipairs(args) do

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/data/models-2d.lua	2009-05-28 22:35:28 UTC (rev 1690)
@@ -484,11 +484,14 @@
         "it_banana",
         "it_bomb_black",
         "it_bomb_white",
-        "it-blocker",
+        "it_blocker",
         "it_bottle_idle",
         "it_bottle_broken",
         "it_brush",
         "it_cherry",
+        "it_coin_s",
+        "it_coin_m",
+        "it_coin_l",
         "it_cross",
         "it_document",
         "it_drop",
@@ -523,9 +526,6 @@
     DefImages(itemlist)
 
     DefImage("it_brake", {filename="st-brake"})
-    DefImage("it_coin_s", {filename="it-coin1"})
-    DefImage("it_coin_m", {filename="it-coin2"})
-    DefImage("it_coin_l", {filename="it-coin4"})
     DefImage("it_meditation_hollow", {filename="it_meditation_hollow"})
     DefImage("it_meditation_hill", {filename="it_meditation_hill"})
     DefImage("it_meditation_dent", {filename="it_meditation_dent"})
@@ -548,12 +548,12 @@
 -- Multiple-Image-Items, non animated, e.g. it-burnable-oil --
 --------------------------------------------------------------
 
--- it-extinguisher --
+-- it_extinguisher --
 do
     DefTiles("it_extinguisher", {"it_extinguisher_full", "it_extinguisher_medium", "it_extinguisher_empty"})
 end
 
--- it-dummy
+-- it_dummy
 do
     DefTiles("it_dummy", {"it_dummy", "it_dummy_egg"})
 end
@@ -565,21 +565,21 @@
 
 -- Laserbeams --
 do
-    DefTiles("it-laser", {"it-laserh", "it-laserv", "it-laserhv"})
+    DefTiles("it_laser", {"it_laser_h", "it_laser_v", "it_laser_hv"})
 end
 
--- it-pipe --
+-- it_pipe --
 do
-    DefTiles("it-pipe", {"it_pipe_e", "it_pipe_s", "it_pipe_es", "it_pipe_sw", "it_pipe_ew",
+    DefTiles("it_pipe", {"it_pipe_e", "it_pipe_s", "it_pipe_es", "it_pipe_sw", "it_pipe_ew",
                             "it_pipe_w", "it_pipe_n", "it_pipe_ne", "it_pipe_nw", "it_pipe_ns"})
 end
 
 -- it-trigger --
 do
-    DefTiles("it-trigger", {"it-trigger","it-trigger1"})
+    DefTiles("it_trigger", {"it_trigger_up","it_trigger_down"})
 end
 
--- it-yinyang --
+-- it_yinyang --
 do
     DefTiles("it_yinyang", {"it_yinyang", "it_yangyin"})
 end
@@ -633,7 +633,7 @@
     DefAlias("it_burnable_invisible", "invisible")
 end
 
--- it-coffee --
+-- it_coffee --
 do
     local images = DefSubimages("it_coffee", {h=4})
     local frames = BuildFrames(images,150)
@@ -671,15 +671,15 @@
     DefAlias("it_explosion", "expl")
 end
 
--- it-magnet --
+-- it_magnet --
 do
-    DefImage("it-magnet-off")
-    local images = DefSubimages("it-magnet-on", {h=5})
+    DefImage("it_magnet_off")
+    local images = DefSubimages("it_magnet_on", {h=5})
     local frames = BuildFrames(images, 100)
-    DefAnim("it-magnet-on", frames, 1)
+    DefAnim("it_magnet_on", frames, 1)
 end
 
--- it-puller --
+-- it_puller --
 do
     local images = {"it_puller_n", "it_puller_e", "it_puller_s", "it_puller_w"}
     DefTiles("it_puller", images)
@@ -687,21 +687,19 @@
     DefAnim("it_puller_active", RepeatAnim(frames, 4), false)
 end
 
--- it-seed --
+-- it_seed --
 do
-    local images = DefSubimages("it-seed", {h=5})
-    DefAlias("it-seed", "it-seed1")
-    DefAlias("it-seed_nowood", "it-seed1")
-    DefAlias("it-seed_volcano", "it-seed1")
+    local images = DefSubimages("it_seed", {h=5})
+    DefAlias("it_seed", "it_seed1")
     local frames = {
-        "it-seed1", "it-seed2", "it-seed1", "it-seed3", "it-seed1", "it-seed2",
-        "it-seed1", "it-seed4", "it-seed5", "it-seed4", "it-seed1",
-        "it-seed4", "it-seed5",
+        "it_seed1", "it_seed2", "it_seed1", "it_seed3", "it_seed1", "it_seed2",
+        "it_seed1", "it_seed4", "it_seed5", "it_seed4", "it_seed1",
+        "it_seed4", "it_seed5",
     }
-    DefAnim("it-seed-growing", BuildFrames(frames, 120))
+    DefAnim("it_seed_growing", BuildFrames(frames, 120))
 end
 
--- it-sensor --
+-- it_sensor --
 do
     DefTiles("it_sensor", {"it_sensor","it_sensor1"})
     local frames = BuildFrames({"it_sensor","it_sensor1"}, 300)
@@ -711,14 +709,14 @@
     DefAnim("it_sensor_exit_hit", RepeatAnim(exitframes, 3), false)
 end
 
--- it-shogun --
+-- it_shogun --
 do
-    NewAnim("it_shogun_s", {img="it-shogun-small", h=3, speed=160, pingpong=1, loop=1})
-    NewAnim("it_shogun_m", {img="it-shogun-med",   h=3, speed=160, pingpong=1, loop=1})
-    NewAnim("it_shogun_l", {img="it-shogun-big",   h=3, speed=160, pingpong=1, loop=1})
+    NewAnim("it_shogun_s", {img="it_shogun_s", h=3, speed=160, pingpong=1, loop=1})
+    NewAnim("it_shogun_m", {img="it_shogun_m",   h=3, speed=160, pingpong=1, loop=1})
+    NewAnim("it_shogun_l", {img="it_shogun_l",   h=3, speed=160, pingpong=1, loop=1})
 end
 
--- it-springboard --
+-- it_springboard --
 do
     local images = {"it_springboard1", "it_springboard2"}
     DefTiles ("it_springboard", images)
@@ -726,22 +724,22 @@
     DefAnim("it_springboard_anim", BuildFrames(ReverseFrames(images),120))
 end
 
--- it-vortex --
+-- it_vortex --
 do
-    local images = DefSubimages("it-vortex", {h=4})
-    DefAlias("it-vortex-open", images[1])
-    DefAlias("it-vortex-closed", images[4])
+    local images = DefSubimages("it_vortex", {h=4})
+    DefAlias("it_vortex_open", images[1])
+    DefAlias("it_vortex_closed", images[4])
 
-    DefAnim("it-vortex-opening", ReverseFrames(BuildFrames(images, 100)))
-    DefAnim("it-vortex-closing", BuildFrames(images, 100))
+    DefAnim("it_vortex_opening", ReverseFrames(BuildFrames(images, 100)))
+    DefAnim("it_vortex_closing", BuildFrames(images, 100))
 end
 
--- it-wormhole --
+-- it_wormhole --
 do
-    local images = DefSubimages("it-wormhole", {h=2})
+    local images = DefSubimages("it_wormhole", {h=2})
     local frames = BuildFrames(images, 100)
-    DefAnim("it-wormhole", frames, true)
-    DefAlias("it-wormhole-off", "it-wormhole1")
+    DefAnim("it_wormhole", frames, true)
+    DefAlias("it_wormhole_off", "it_wormhole1")
 end
 
 -- it_trap --
@@ -1095,11 +1093,11 @@
     local anim_v, anim_h, anim_hv = {}, {}, {}
     for j = 1, 7 do
       anim_v[j] = "st-lightpassenger-break-v"..j
-      display.DefineComposite(anim_v[j], "it-laserv", img[j])
+      display.DefineComposite(anim_v[j], "it_laser_v", img[j])
       anim_h[j] = "st-lightpassenger-break-h"..j
-      display.DefineComposite(anim_h[j], "it-laserh", img[j])
+      display.DefineComposite(anim_h[j], "it_laser_h", img[j])
       anim_hv[j] = "st-lightpassenger-break-hv"..j
-      display.DefineComposite(anim_hv[j], "it-laserhv", img[j])
+      display.DefineComposite(anim_hv[j], "it_laser_hv", img[j])
     end
     DefAnim("st-lightpassenger-break-v", BuildFrames(anim_v, 50), false)
     DefAnim("st-lightpassenger-break-h", BuildFrames(anim_h, 50), false)

Modified: trunk/src/actors.cc
===================================================================
--- trunk/src/actors.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/actors.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -35,7 +35,7 @@
 //using namespace world;
 using ecl::V2;
 
-#include "actors_internal.hh"
+//#include "actors_internal.hh"
 
 namespace enigma {
 
@@ -196,9 +196,9 @@
 }
 
 void Actor::find_respawnpos() {
-    V2& what_pos = use_respawnpos ? respawnpos : startingpos;
-    FreeRespawnLocationFinder unblocked(what_pos, *this);
-    what_pos = unblocked.get_position();
+//    V2& what_pos = use_respawnpos ? respawnpos : startingpos;
+//    FreeRespawnLocationFinder unblocked(what_pos, *this);
+//    what_pos = unblocked.get_position();
 }
 
 const V2& Actor::get_respawnpos() const {

Modified: trunk/src/gui/MainMenu.cc
===================================================================
--- trunk/src/gui/MainMenu.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/gui/MainMenu.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -128,8 +128,8 @@
         "  Raoul Bourquin  (Level admin. & design, all over invaluable additions)",
         "  Siegfried Fennig  (Level design, graphics)",
         "  Martin Hawlisch  (Level design, graphics, programming)",
-        "  Daniel Heck  (Main developer, graphics, documentation)",
-        "  Ronald Lamprecht  (XML, Gui, portability, core prog., documentation)",
+        "  Daniel Heck  (Main developer up to 0.92, graphics, documentation)",
+        "  Ronald Lamprecht  (XML, new API, engine, portability, GUI, documentation)",
         "  Andreas Lochmann  (Programming, level admin. & design, documentation)",
         "  Petr Machata  (Level design, programming)",
         "  Nat Pryce  (Level design)",
@@ -200,6 +200,7 @@
         "  Tobias Schmidbauer  (Windows installer and icon)",
         "  Achim Settelmeier  (RPM specfile)",
         "  ShadowPhrogg32642342 (D??niel Borb??ly)  (Level design)",
+        "  Alex Smith  (Level design)",
         "  Jon Sneyers  (Level design)",
         "  Spaceman  (Level design)",
         "  Ulf Stegemann  (Level design)",

Modified: trunk/src/items/BlockerItem.cc
===================================================================
--- trunk/src/items/BlockerItem.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/items/BlockerItem.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -108,7 +108,7 @@
     }
 
     void BlockerItem::init_model() {
-        set_model("it-blocker");
+        set_model("it_blocker");
     }
     
     void BlockerItem::actor_leave(Actor *a) {

Modified: trunk/src/items/Coin.cc
===================================================================
--- trunk/src/items/Coin.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/items/Coin.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -61,9 +61,9 @@
     }
     
     ItemTraits Coin::traits[3] = {
-        {"it_coin_s",  it_coin1,  itf_none, 0.0},
-        {"it_coin_m",  it_coin2,  itf_none, 0.0},
-        {"it_coin_l",  it_coin4,  itf_none, 0.0},
+        {"it_coin_s",  it_coin_s,  itf_none, 0.0},
+        {"it_coin_m",  it_coin_m,  itf_none, 0.0},
+        {"it_coin_l",  it_coin_l,  itf_none, 0.0},
     };
 
     BOOT_REGISTER_START

Modified: trunk/src/items/Magnet.cc
===================================================================
--- trunk/src/items/Magnet.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/items/Magnet.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -57,7 +57,7 @@
         return Item::message(m);
     }
     void Magnet::init_model() {
-        set_model(ecl::strf("it-magnet%s", state == ON ? "-on" : "-off"));
+        set_model(ecl::strf("it_magnet_%s", state == ON ? "on" : "off"));
     }
     
     void Magnet::on_creation(GridPos p) {

Modified: trunk/src/items/SeedItem.cc
===================================================================
--- trunk/src/items/SeedItem.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/items/SeedItem.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -85,9 +85,9 @@
     
     void SeedItem::init_model() {
         if (state == IDLE)
-            set_model("it-seed");
+            set_model("it_seed");
         else
-            set_anim("it-seed-growing");
+            set_anim("it_seed_growing");
     }
     
     void SeedItem::processLight(Direction d) {
@@ -116,7 +116,7 @@
     }
     
     std::string SeedItem::get_inventory_model() {
-        return "it-seed";
+        return "it_seed";
     }
     
     bool SeedItem::isStatic() const {
@@ -142,7 +142,7 @@
         if (state == IDLE) {
             state = ACTIVE;
             sound_event("seedgrow");
-            set_anim("it-seed-growing");
+            set_anim("it_seed_growing");
         }
     }
         

Modified: trunk/src/items/Trigger.cc
===================================================================
--- trunk/src/items/Trigger.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/items/Trigger.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -81,9 +81,9 @@
         if (getAttr("invisible").to_bool())
             set_model("invisible");
         else if (state != 0)
-            set_model("it-trigger1");
+            set_model("it_trigger_down");
         else
-            set_model("it-trigger");
+            set_model("it_trigger_up");
     }
     
     void Trigger::actor_enter(Actor *a) {

Modified: trunk/src/items/Vortex.cc
===================================================================
--- trunk/src/items/Vortex.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/items/Vortex.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -101,14 +101,14 @@
             case OPEN:
             case EMITTING:
             case SWALLOWING:
-                set_model("it-vortex-open");
+                set_model("it_vortex_open");
                 break;
             case CLOSED: 
-                set_model("it-vortex-closed"); break;
+                set_model("it_vortex_closed"); break;
             case OPENING: 
-                set_anim("it-vortex-opening"); break;
+                set_anim("it_vortex_opening"); break;
             case CLOSING: 
-                set_anim("it-vortex-closing"); break;
+                set_anim("it_vortex_closing"); break;
         }
     }
     

Modified: trunk/src/items/WormHole.cc
===================================================================
--- trunk/src/items/WormHole.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/items/WormHole.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -98,9 +98,9 @@
     
     void WormHole::init_model() {
         if ((state & 3) == ON_IDLE)
-            set_anim("it-wormhole");
+            set_anim("it_wormhole");
         else
-            set_model("it-wormhole-off");
+            set_model("it_wormhole_off");
     }
     
     bool WormHole::actor_hit(Actor *actor) {

Modified: trunk/src/items.hh
===================================================================
--- trunk/src/items.hh	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/items.hh	2009-05-28 22:35:28 UTC (rev 1690)
@@ -49,9 +49,9 @@
         it_cherry,
         it_cherry_crushed,
         it_coffee,
-        it_coin1,
-        it_coin2, 
-        it_coin4,
+        it_coin_s,
+        it_coin_m, 
+        it_coin_l,
         it_crack_i,
         it_crack_s,
         it_crack_m,

Modified: trunk/src/laser.cc
===================================================================
--- trunk/src/laser.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/laser.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -90,12 +90,12 @@
     
     if (directions & (EASTBIT | WESTBIT)) {
         if (directions & (NORTHBIT | SOUTHBIT))
-            set_model("it-laserhv");
+            set_model("it_laser_hv");
         else
-            set_model("it-laserh");
+            set_model("it_laser_h");
     }
     else if (directions & (NORTHBIT | SOUTHBIT))
-        set_model("it-laserv");
+        set_model("it_laser_v");
 }
 
 void LaserBeam::processLight(Direction dir) {

Modified: trunk/src/stones/CoinSlot.cc
===================================================================
--- trunk/src/stones/CoinSlot.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/stones/CoinSlot.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -109,17 +109,17 @@
         if (enigma::Inventory *inv = player::GetInventory(sc.actor)) {
             if (Item *it = inv->get_item(0)) {
                 ItemID id = get_id(it);
-                if (id == it_coin1 || id == it_coin2 || id == it_coin4) {
+                if (id == it_coin_s || id == it_coin_m || id == it_coin_l) {
                     double interval;
                     if (server::EnigmaCompatibility < 1.10) 
                         interval = it->getAttr("coin_value");
                     else {
                         switch (id) {
-                            case it_coin1:
+                            case it_coin_s:
                                 interval = getAttr("interval_s"); break;
-                            case it_coin2:
+                            case it_coin_m:
                                 interval = getAttr("interval_m"); break;
-                            case it_coin4:
+                            case it_coin_l:
                                 interval = getAttr("interval_l"); break;
                         }
                         if (interval == -2)  // reject coin

Modified: trunk/src/stones/WindowStone.cc
===================================================================
--- trunk/src/stones/WindowStone.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/stones/WindowStone.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -153,7 +153,7 @@
             if (objFlags & (sc.faces << 24))  // face is scratched
                 threshold -= 10;
             
-            if (impulse > 35) {
+            if (impulse > 35 && !(objFlags & OBJBIT_SECURE)) {
                 SendMessage(a, "_shatter");
             }
 

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2009-05-28 21:19:46 UTC (rev 1689)
+++ trunk/src/world.cc	2009-05-28 22:35:28 UTC (rev 1690)
@@ -2226,7 +2226,7 @@
 }
 
 void FastRespawnActor(Actor *a, bool keep_velocity) {
-    a->find_respawnpos();
+//    a->find_respawnpos();
     const V2& p = a->get_respawnpos();
     WarpActor(a, p[0], p[1], keep_velocity);
 }



From ral at mail.berlios.de  Fri May 29 22:25:13 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Fri, 29 May 2009 22:25:13 +0200
Subject: [Enigma-game-svn] r1691 - in trunk: data data/gfx32 data/gfx40
	data/gfx48 src src/items src/stones
Message-ID: <200905292025.n4TKPD5P030584@sheep.berlios.de>

Author: ral
Date: 2009-05-29 22:25:11 +0200 (Fri, 29 May 2009)
New Revision: 1691

Added:
   trunk/data/gfx32/it_explosion.png
   trunk/data/gfx32/sh_brake.png
   trunk/data/gfx32/st_brake.png
   trunk/data/gfx40/it_explosion.png
   trunk/data/gfx40/sh_brake.png
   trunk/data/gfx40/st_brake.png
   trunk/data/gfx48/it_explosion.png
   trunk/data/gfx48/sh_brake.png
   trunk/data/gfx48/st_brake.png
Removed:
   trunk/data/gfx32/expl.png
   trunk/data/gfx32/sh-brake.png
   trunk/data/gfx32/st-brake.png
   trunk/data/gfx40/expl.png
   trunk/data/gfx40/sh-brake.png
   trunk/data/gfx40/st-brake.png
   trunk/data/gfx48/expl.png
   trunk/data/gfx48/sh-brake.png
   trunk/data/gfx48/st-brake.png
Modified:
   trunk/data/models-2d.lua
   trunk/src/d_models.cc
   trunk/src/items.hh
   trunk/src/items/BrakeItem.cc
   trunk/src/items/SeedItem.cc
   trunk/src/items/SeedItem.hh
   trunk/src/stones/BoxStone.cc
   trunk/src/stones/BrakeStone.cc
   trunk/src/stones/GreenBrownStone.cc
   trunk/src/stones/VolcanoStone.cc
Log:
Trunk 1.1:
- fix volcano missing seed image renaming
- fix potential crash on it_seed_hay
- rename images expl, st-brake
- fix crash on DefAlias with two identical names
- separate seed growing models in C++, temp. usage of DefAlias


Deleted: trunk/data/gfx32/expl.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/it_explosion.png (from rev 1689, trunk/data/gfx32/expl.png)

Deleted: trunk/data/gfx32/sh-brake.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/sh_brake.png (from rev 1689, trunk/data/gfx32/sh-brake.png)

Deleted: trunk/data/gfx32/st-brake.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/st_brake.png (from rev 1689, trunk/data/gfx32/st-brake.png)

Deleted: trunk/data/gfx40/expl.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/it_explosion.png (from rev 1689, trunk/data/gfx40/expl.png)

Deleted: trunk/data/gfx40/sh-brake.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_brake.png (from rev 1689, trunk/data/gfx40/sh-brake.png)

Deleted: trunk/data/gfx40/st-brake.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/st_brake.png (from rev 1689, trunk/data/gfx40/st-brake.png)

Deleted: trunk/data/gfx48/expl.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/it_explosion.png (from rev 1689, trunk/data/gfx48/expl.png)

Deleted: trunk/data/gfx48/sh-brake.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_brake.png (from rev 1689, trunk/data/gfx48/sh-brake.png)

Deleted: trunk/data/gfx48/st-brake.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/st_brake.png (from rev 1689, trunk/data/gfx48/st-brake.png)

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/data/models-2d.lua	2009-05-29 20:25:11 UTC (rev 1691)
@@ -525,7 +525,7 @@
 
     DefImages(itemlist)
 
-    DefImage("it_brake", {filename="st-brake"})
+    DefImage("it_brake", {filename="st_brake"})
     DefImage("it_meditation_hollow", {filename="it_meditation_hollow"})
     DefImage("it_meditation_hill", {filename="it_meditation_hill"})
     DefImage("it_meditation_dent", {filename="it_meditation_dent"})
@@ -667,8 +667,7 @@
 
 -- Explosion --
 do
-    DefAnimImages("expl", {{"expl", 50}})
-    DefAlias("it_explosion", "expl")
+    DefAnimImages("it_explosion", {{"it_explosion", 50}})
 end
 
 -- it_magnet --
@@ -771,7 +770,7 @@
     DefImage("sh_passage_slash")
     DefImage("sh_passage_cross")
     DefImage("sh-puzzle1")
-    DefImage("sh-brake")
+    DefImage("sh_brake")
     DefImage("sh-floating")
     -- Note: Window shadows are defined where needed.
 end
@@ -788,7 +787,7 @@
     DefStone("st_jamb_black")
     DefStone("st_plop_slate")
     DefStone("st_bluegray", "sh-round")
-    DefStone("st-brake", "sh-brake")
+    DefStone("st_brake", "sh_brake")
     DefStone("st_brownie", "sh-round")
     DefStone("st-bug")
     DefStone("st_pinkbumps")
@@ -1312,7 +1311,7 @@
       local n=DefSubimages("st-wood-growing", {h=3})
       DefAnim("wood-growing-fg", BuildFrames(n, 130))
       DefAnim("wood-growing-bg", BuildFrames(sh, 130))
-      DefShModel("st-wood-growing", "wood-growing-fg", "wood-growing-bg")
+      DefShModel("st_wood_growing", "wood-growing-fg", "wood-growing-bg")
    end
 
    -- Blocker stone --
@@ -1333,7 +1332,9 @@
 end
 
 do
-    DefAlias("st-volcano-growing", "st-blocker-growing")
+    DefAlias("st_flhay_growing", "st_wood_growing")
+    DefAlias("st_greenbrown_growing", "st_wood_growing")
+    DefAlias("st_volcano_growing", "st-blocker-growing")
 end
 
 -- st-window --

Modified: trunk/src/d_models.cc
===================================================================
--- trunk/src/d_models.cc	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/src/d_models.cc	2009-05-29 20:25:11 UTC (rev 1691)
@@ -20,6 +20,7 @@
 #include "display_internal.hh"
 #include "d_models.hh"
 
+//#include "errors.hh"
 #include "lua.hh"
 #include "options.hh"
 #include "d_engine.hh"
@@ -31,6 +32,7 @@
 #include "SDL_image.h"
 
 #include <cstdio>
+#include <cstring>
 #include <iostream>
 
 using namespace enigma;
@@ -368,7 +370,8 @@
 
 void display::DefineAlias (const char *name, const char *othername)
 {
-    DefineModel(name, new AliasModel(othername));
+    if (std::strcmp(name, othername) != 0)
+        DefineModel(name, new AliasModel(othername));
 }
 
 

Modified: trunk/src/items/BrakeItem.cc
===================================================================
--- trunk/src/items/BrakeItem.cc	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/src/items/BrakeItem.cc	2009-05-29 20:25:11 UTC (rev 1691)
@@ -33,7 +33,7 @@
     }
     
     std::string BrakeItem::get_inventory_model() {
-        return "st-brake";
+        return "st_brake";
     }
     
     ItemAction BrakeItem::activate(Actor* a, GridPos p) {

Modified: trunk/src/items/SeedItem.cc
===================================================================
--- trunk/src/items/SeedItem.cc	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/src/items/SeedItem.cc	2009-05-29 20:25:11 UTC (rev 1691)
@@ -151,10 +151,11 @@
     }
     
 
-    ItemTraits SeedItem::traits[3] = {
+    ItemTraits SeedItem::traits[4] = {
         {"it_seed_wood", it_seed_wood, itf_static, 0.2},
         {"it_seed_greenbrown", it_seed_fake, itf_static, 0.2},
-        {"it_seed_volcano", it_seed_volcano, itf_static, 0.2}
+        {"it_seed_volcano", it_seed_volcano, itf_static, 0.2},
+        {"it_seed_hay", it_seed_hay, itf_static, 0.2}
     };
 
     BOOT_REGISTER_START

Modified: trunk/src/items/SeedItem.hh
===================================================================
--- trunk/src/items/SeedItem.hh	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/src/items/SeedItem.hh	2009-05-29 20:25:11 UTC (rev 1691)
@@ -28,7 +28,7 @@
      */
     class SeedItem : public Item {
         CLONEOBJ(SeedItem);
-        DECL_ITEMTRAITS_ARRAY(3, traitsIdx());
+        DECL_ITEMTRAITS_ARRAY(4, traitsIdx());
 
     private:
         enum iState {

Modified: trunk/src/items.hh
===================================================================
--- trunk/src/items.hh	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/src/items.hh	2009-05-29 20:25:11 UTC (rev 1691)
@@ -111,6 +111,7 @@
         it_seed_wood,
         it_seed_fake,
         it_seed_volcano,
+        it_seed_hay,
         it_sensor,
         it_shogun_s,
         it_shogun_m,

Modified: trunk/src/stones/BoxStone.cc
===================================================================
--- trunk/src/stones/BoxStone.cc	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/src/stones/BoxStone.cc	2009-05-29 20:25:11 UTC (rev 1691)
@@ -107,19 +107,19 @@
                 ASSERT(false, XLevelRuntime, "Wood stone init model state error");
             case WOOD1:
                 if (state == GROWING)
-                    set_anim("st-wood-growing");
+                    set_anim("st_wood_growing");
                 else
                     set_model("st-wood1");
                 break;
             case WOOD2:
                 if (state == GROWING)
-                    set_anim("st-wood-growing");
+                    set_anim("st_wood_growing");
                 else
                     set_model("st-wood2");
                 break;
             case HAY:
                 if (state == GROWING)
-                    set_anim("st-wood-growing");
+                    set_anim("st_flhay_growing");
                 else
                     set_model("st-flhay"); break;
                 break;

Modified: trunk/src/stones/BrakeStone.cc
===================================================================
--- trunk/src/stones/BrakeStone.cc	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/src/stones/BrakeStone.cc	2009-05-29 20:25:11 UTC (rev 1691)
@@ -40,7 +40,7 @@
     }
 
     void BrakeStone::init_model() {
-        set_model("st-brake");
+        set_model("st_brake");
     }
     
     void BrakeStone::on_creation (GridPos p) {

Modified: trunk/src/stones/GreenBrownStone.cc
===================================================================
--- trunk/src/stones/GreenBrownStone.cc	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/src/stones/GreenBrownStone.cc	2009-05-29 20:25:11 UTC (rev 1691)
@@ -67,7 +67,7 @@
         if (objFlags & OBJBIT_GLASSES)
             set_model("invisible");
         else if (state == GROWING)
-            set_anim("st-wood-growing");   // missing model
+            set_anim("st_greenbrown_growing");
         else
             set_model(getClass());
     }

Modified: trunk/src/stones/VolcanoStone.cc
===================================================================
--- trunk/src/stones/VolcanoStone.cc	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/src/stones/VolcanoStone.cc	2009-05-29 20:25:11 UTC (rev 1691)
@@ -79,8 +79,8 @@
             case INACTIVE: set_model("st_flat"); break;
             case ACTIVE:   set_anim("st_quaking"); break;
             case BREAKING: set_anim("st_quakebreak_anim"); break;
-            case NEW:      set_anim("it-seed-growing"); break;
-            case GROWING:  set_anim("st-volcano-growing"); break;
+            case NEW:      set_anim("it_seed_growing"); break;
+            case GROWING:  set_anim("st_volcano_growing"); break;
         }
     }
 



From ral at mail.berlios.de  Sat May 30 00:24:18 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sat, 30 May 2009 00:24:18 +0200
Subject: [Enigma-game-svn] r1692 - in trunk/doc/reference: . images
Message-ID: <200905292224.n4TMOI28010802@sheep.berlios.de>

Author: ral
Date: 2009-05-30 00:24:08 +0200 (Sat, 30 May 2009)
New Revision: 1692

Modified:
   trunk/doc/reference/enigma-ref.texi
   trunk/doc/reference/images/Makefile.am
Log:
Trunk 1.1: refman
- Chapter 8 Items: images for overview and most variants
- some fixes


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-05-29 20:25:11 UTC (rev 1691)
+++ trunk/doc/reference/enigma-ref.texi	2009-05-29 22:24:08 UTC (rev 1692)
@@ -860,6 +860,7 @@
 interdependent sound sets (sound sets that share sound files) and want to
 deactivate just one of them.
 
+ at c ===================  Levelpack Basics  =======================
 
 @node  Levelpack Basics
 @chapter Levelpack Basics
@@ -1217,6 +1218,7 @@
 use the composer to insert the levelpack to your levelpack as a copy, and delete the
 unused level file copies from the @samp{auto} folder.
 
+ at c ===================  Level Basics  =======================
 
 @node  Level Basics
 @chapter Level Basics
@@ -1227,8 +1229,7 @@
 generate their layout and look different each time you play them. Other levels provide a dynamic
 behavior during the play; i.e., switches may open doors only in certain circumstances. To
 comply with these demands, we have integrated the powerful lightweight C extension language
- at url{http://www.lua.org, Lua}
-into Enigma.
+ at url{http://www.lua.org, Lua} as of version 5.1.4 into Enigma.
 
 Up to Enigma 0.92, two different level formats did exist. One was a XML-like format, primarily
 designed for external level editor programs. Because its static object map description part was
@@ -3635,10 +3636,10 @@
 
 Knowing the basic principles of an Enigma level's world you now just need
 the language glue to write your first level. Enigma levels are written in
-the language @url{http://www.lua.org, Lua}. This powerful language gives you
-the ability to write most complex, dynamical levels, while being nearly
-transparent on writing basic standard levels. Indeed there is no reason to dig
-into this language at the very beginning.
+the language @url{http://www.lua.org, Lua} as of version 5.1.4. This powerful 
+language gives you the ability to write most complex, dynamical levels, while 
+being nearly transparent on writing basic standard levels. Indeed there is no 
+reason to dig into this language at the very beginning.
 
 With the second Lua API version, as of Enigma 1.10, we designed an optimized
 way of describing levels in a very short and readable manner. Thus we do
@@ -9185,6 +9186,7 @@
 @end iftex
 @end macro
 @c
+WORK IN PROGRESS - The follwing table is still incomplete!
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
 @item @image{images/fl_abyss} @tab @yref{fl_abyss}
 @tab @image{images/fl_adhesionless} @tab @yref{fl_adhesionless}
@@ -9527,7 +9529,7 @@
 
 Many floors do provide several textures - graphical image variations that are
 without any influence on the physical engine. Most floors do select a random
-texture in their default variant. Thiss generates areas without unintended
+texture in their default variant. This generates areas without unintended
 optical effects. But on some floors you can select the textures by means
 of variant kind names to create your own graphical floor layout.
 
@@ -10972,16 +10974,76 @@
 
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
 @item @image{images/it_bag} @tab @yref{it_bag}
+ at tab @image{images/it_banana} @tab @yref{it_banana}
+ at tab @image{images/it_blocker} @tab @yref{it_blocker}
+ at item @image{images/it_bomb_black} @tab @yref{it_bomb}_black
+ at tab @image{images/it_bomb_white} @tab @yref{it_bomb}_white
+ at tab @image{images/it_bottle_idle} @tab @yref{it_bottle}
+ at item @image{images/it_bottle_broken} @tab @yref{it_bottle}_broken
+ at tab @image{images/st_brake} @tab @yref{it_brake}
+ at tab @image{images/it_brush} @tab @yref{it_brush}
+ at item @image{images/it_burnable_ash} @tab @yref{it_burnable}_ash
+ at tab @image{images/it_burnable_burning} @tab @yref{it_burnable}_burning
+ at tab @image{images/it_burnable_fireproof} @tab @yref{it_burnable}_fireproof
+ at item @image{images/it_burnable_oil} @tab @yref{it_burnable}_oil
+ at tab @image{images/it_cherry} @tab @yref{it_cherry}
+ at tab @image{images/it_coffee} @tab @yref{it_coffee}
+ at item @image{images/it_coin_s} @tab @yref{it_coin}_s
+ at tab @image{images/it_coin_m} @tab @yref{it_coin}_m
+ at tab @image{images/it_coin_l} @tab @yref{it_coin}_l
+ at item @image{images/it_crack_abyss} @tab @yref{it_crack}_abyss
+ at tab @image{images/it_crack_water} @tab @yref{it_crack}_water
+ at tab @image{images/it_cross} @tab @yref{it_cross}
+ at item @image{images/it_death} @tab @yref{it_death}
+ at tab @image{images/it_document} @tab @yref{it_document}
+ at tab @image{images/it_drop} @tab @yref{it_drop}
+ at item @image{images/it_dynamite} @tab @yref{it_dynamite}
+ at tab @image{images/it_explosion} @tab @yref{it_explosion}
+ at tab @image{images/it_extralife} @tab @yref{it_extralife}
+ at item @image{images/it_extinguisher} @tab @yref{it_extinguisher}
+ at tab @image{images/it_flag_black} @tab @yref{it_flag}_black
+ at tab @image{images/it_flag_white} @tab @yref{it_flag}_white
+ at item @image{images/it_floppy} @tab @yref{it_floppy}
+ at tab @image{images/it_glasses} @tab @yref{it_glasses}
+ at tab @image{images/it_glasses_broken} @tab @yref{it_glasses}_broken
+ at item @image{images/it_hammer} @tab @yref{it_hammer}
+ at tab @image{images/it_key} @tab @yref{it_key}
+ at tab @image{images/it_landmine} @tab @yref{it_landmine}
+ at item @image{images/it_laser} @tab @yref{it_laserbeam}
+ at tab @image{images/it_magicwand} @tab @yref{it_magicwand}
+ at tab @image{images/it_magnet_off} @tab @yref{it_magnet}
+ at item @image{images/it_meditation_bump} @tab @yref{it_meditation}_bump
+ at tab @image{images/it_meditation_caldera} @tab @yref{it_meditation}_caledera
+ at tab @image{images/it_meditation_dent} @tab @yref{it_meditation}_dent
+ at item @image{images/it_meditation_hill} @tab @yref{it_meditation}_hill
+ at tab @image{images/it_meditation_hollow} @tab @yref{it_meditation}_hollow
+ at tab @image{images/it_meditation_volcano} @tab @yref{it_meditation}_volcano
+ at item @image{images/it_pencil} @tab @yref{it_pencil}
 @tab @image{images/it_pin} @tab @yref{it_pin}
- at tab @image{images/it_puller} @tab @yref{it_puller}
- at item @image{images/it_sensor} @tab @yref{it_sensor}
- at tab @image{images/it_springboard} @tab @yref{it_springboard}
- at tab @image{images/it_spring_drop} @tab @yref{it_spring_drop}
- at item @image{images/it_spring_keep} @tab @yref{it_spring_keep}
+ at tab @image{images/it_pipe} @tab @yref{it_pipe}
+ at item @image{images/it_puller} @tab @yref{it_puller}
+ at tab @image{images/it_ring} @tab @yref{it_ring}
+ at tab @image{images/it_rubberband} @tab @yref{it_rubberband}
+ at item @image{images/it_seed} @tab @yref{it_seed}
+ at tab @image{images/it_sensor} @tab @yref{it_sensor}
+ at tab @image{images/it_sensor_exit} @tab @yref{it_sensor}_exit
+ at item @image{images/it_shogun_m} @tab @yref{it_shogun}
+ at tab @image{images/it_spade} @tab @yref{it_spade}
+ at tab @image{images/it_spoon} @tab @yref{it_spoon}
+ at item @image{images/it_springboard} @tab @yref{it_springboard}
+ at tab @image{images/it_spring_drop} @tab @yref{it_spring}_drop
+ at tab @image{images/it_spring_keep} @tab @yref{it_spring}_keep
+ at item @image{images/it_squashed} @tab @yref{it_squashed}
 @tab @image{images/it_strip} @tab @yref{it_strip}
 @tab @image{images/it_surprise} @tab @yref{it_surprise}
- at item @image{images/it_trap} @tab @yref{it_trap}
+ at item @image{images/it_sword} @tab @yref{it_sword}
+ at tab @image{images/it_trap} @tab @yref{it_trap}
+ at tab @image{images/it_trigger} @tab @yref{it_trigger}
+ at item @image{images/it_umbrella} @tab @yref{it_umbrella}
+ at tab @image{images/it_vortex} @tab @yref{it_vortex}
 @tab @image{images/it_weight} @tab @yref{it_weight}
+ at item @image{images/it_wormhole} @tab @yref{it_wormhole}
+ at tab @image{images/it_wrench} @tab @yref{it_wrench}
 @tab @image{images/it_yinyang} @tab @yref{it_yinyang}
 @end multitable
 
@@ -11074,6 +11136,7 @@
 * it_coin::            Enigma's currency
 * it_document::        Readable Text Document
 * it_drop::            Magic Transformation Elixir
+* it_dynamite::        Exploder
 * it_extinguisher::    Fire Extinguisher
 * it_extralife::       Another Life or Glasses
 * it_flag::            Respawn Position Marker
@@ -11176,7 +11239,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_bag}
+ at item @image{images/it_bag} @b{it_bag}
 @end table
 @end table
 
@@ -11200,7 +11263,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_banana}
+ at item @image{images/it_banana} @b{it_banana}
 @end table
 @end table
 
@@ -11253,9 +11316,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_bottle}: state = @code{IDLE}
- at item @b{it_bottle_idle}: state = @code{IDLE}
- at item @b{it_bottle_broken}: state = @code{BROKEN}
+ at item @image{images/it_bottle_idle} @b{it_bottle}: state = @code{IDLE}
+ at item @image{images/it_bottle_idle} @b{it_bottle_idle}: state = @code{IDLE}
+ at item @image{images/it_bottle_broken} @b{it_bottle_broken}: state = @code{BROKEN}
 @end table
 
 @end table
@@ -11300,7 +11363,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_brake}
+ at item @image{images/st_brake} @b{it_brake}
 @end table
 
 @end table
@@ -11343,7 +11406,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_brush}
+ at item @image{images/it_brush} @b{it_brush}
 @end table
 
 @end table
@@ -11376,7 +11439,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_cherry}
+ at item @image{images/it_cherry} @b{it_cherry}
 @end table
 @end table
 
@@ -11399,7 +11462,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_coffee}
+ at item @image{images/it_coffee} @b{it_coffee}
 @end table
 @end table
 
@@ -11428,9 +11491,9 @@
 @item @b{Attributes:}
 
 @table @asis
- at item @b{state}, @ @ @i{values}: @code{0}, @code{1}, @code{2}; @ @ @i{access}: @code{read only} @ @ @xref{state}
-Represents the coin type with 0 being a small coin, 1 being a medium coin and
-2 being a large coin.
+ at item @b{state}, @ @ @i{values}: @code{SMALL}, @code{MEDIUM}, @code{LARGE}; @ @ @i{default}: @code{SMALL}; @ @ @i{access}: @code{read only} @ @ @xref{state}
+Represents the coin type with @samp{SMALL} being a coin of 2 cents, @samp{MEDIUM}
+being a coin of 5 cents and @samp{LARGE} being a coin of 10 cents..
 @item @b{freezable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}; @ @ @i{access}: @code{read only} @ @ @xref{freezable}
 @item @b{liftable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}; @ @ @i{access}: @code{read only} @ @ @xref{liftable}
 @item @b{portable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}; @ @ @i{access}: @code{read only} @ @ @xref{portable}
@@ -11440,14 +11503,10 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_coin}
-A small coin.
- at item @b{it_coin_s}
-A small coin.
- at item @b{it_coin_m}
-A medium coin.
- at item @b{it_coin_l}
-A large coin.
+ at item @image{images/it_coin_s} @b{it_coin}: state = @code{SMALL}
+ at item @image{images/it_coin_s} @b{it_coin_s}: state = @code{SMALL}
+ at item @image{images/it_coin_m} @b{it_coin_m}: state = @code{MEDIUM}
+ at item @image{images/it_coin_l} @b{it_coin_l}: state = @code{LARGE}
 @end table
 
 @end table
@@ -11482,7 +11541,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_document}
+ at item @image{images/it_document} @b{it_document}
 @end table
 @end table
 
@@ -11517,11 +11576,67 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_drop}
+ at item @image{images/it_drop} @b{it_drop}
 @end table
 
 @end table
 
+ at c ----------------- Dynamite Item --------------------
+ at node it_dynamite
+ at subsection it_dynamite
+ at obindex it_dynamite
+
+Dynamite is an explosive that can be picked up and that can be easily ignited
+at any free grid position. It ignites on drop, or if positioned on the floor in
+ at samp{IDLE} state it ignites on laser light, nearby fire and other nearby 
+explosions as those caused by @ref{it_bomb}, @ref{st_dispenser}, or other 
+dyamite. A falling @ref{ot_cannonball} lets it explode immediately without prior
+ignition.
+
+On ignition its fuse starts burning. During this @samp{ACTIVE} state the
+dynamite can longer be picked up. After a short time the dynamite explodes
+causing on the 8 neigboring positions items to ignite and some stones like
+ at ref{st_break} to dissolve, too. The explosion leaves at its position an
+ at ref{it_meditation}_hollow on all floor kinds besides @ref{fl_ice} where an
+ at ref{it_crack}_water remains.
+
+Generally there is no direct way to stop a burning dynamite in order to prevent
+the explosion. It is even not allowed to reset the @samp{state} attribute to
+ at samp{IDLE}. But when the user pushes an @ref{st_ice} over a @samp{ACTIVE}
+dynamite it will freeze and stop burning, returning to state @samp{IDLE}.
+
+Dynamite items will be added to the inventory when an actor hits a 
+ at ref{st_dispenser}_dynamite.
+
+ at table @asis
+ at item @b{Attributes:}
+ at table @asis
+ at item @b{state}, @ @ @i{values}: @code{IDLE}, @code{ACTIVE}; @ @ @i{default}: @code{IDLE} @ @ @xref{state}
+ at item @b{freezable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}; @ @ @i{access}: @code{read only} @ @ @xref{freezable}
+ at item @b{liftable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}; @ @ @i{access}: @code{read only} @ @ @xref{liftable}
+ at item @b{portable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}; @ @ @i{access}: @code{read only} @ @ @xref{portable}
+Just @samp{IDLE} dynamite can be added to the inventory, burning @samp{ACTIVE}
+ones are not portable.
+ at end table
+
+ at item @b{Messages:}
+ at table @asis
+ at item @b{explode}
+Direct explosion without burning fuse.
+ at item @b{ignite}
+Ignite the fuse.
+ at item @b{heat}
+Ignite the fuse.
+ at end table
+
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/it_dynamite} @b{it_dynamite}: state = @code{IDLE}
+ at item @image{images/fl_white} @b{it_dynamite_burning}: state = @code{ACTIVE}
+ at end table
+
+ at end table
+
 @c ----------------- Extinguisher Item --------------------
 @node it_extinguisher
 @subsection it_extinguisher
@@ -11562,10 +11677,10 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_extinguisher}: state = @code{FULL}
- at item @b{it_extinguisher_empty}: state = @code{IDLE}
- at item @b{it_extinguisher_medium}: state = @code{MEDIUM}
- at item @b{it_extinguisher_full}: state = @code{FULL}
+ at item @image{images/it_extinguisher} @b{it_extinguisher}: state = @code{FULL}
+ at item @image{images/it_extinguisher} @b{it_extinguisher_empty}: state = @code{FULL}
+ at item @image{images/fl_white} @b{it_extinguisher_medium}: state = @code{MEDIUM}
+ at item @image{images/fl_white} @b{it_extinguisher_full}: state = @code{FULL}
 @end table
 
 @end table
@@ -11598,10 +11713,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_extralife}
-A standard extralife item.
- at item @b{it_extralife_new}
-An extralife that is immune to light destruction for a short latency period.
+ at item @image{images/it_extralife} @b{it_extralife}
+ at item @image{images/it_extralife} @b{it_extralife_new}: An extralife that is immune to light destruction for a short latency period.
 @end table
 
 @end table
@@ -11633,9 +11746,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_flag}: color = @code{BLACK}
- at item @b{it_flag_black}: color = @code{BLACK}
- at item @b{it_flag_white}: color = @code{WHITE}
+ at item @image{images/it_flag_black} @b{it_flag}: color = @code{BLACK}
+ at item @image{images/it_flag_black} @b{it_flag_black}: color = @code{BLACK}
+ at item @image{images/it_flag_white} @b{it_flag_white}: color = @code{WHITE}
 @end table
 @end table
 
@@ -11657,7 +11770,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_floppy}
+ at item @image{images/it_floppy} @b{it_floppy}
 @end table
 
 @end table
@@ -11710,10 +11823,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_glasses}
-Active glasses item.
- at item @b{it_glasses_broken}
-Broken glasses that spot nothing.
+ at item @image{images/it_glasses} @b{it_glasses} Active glasses item.
+ at item @image{images/it_glasses_broken} @b{it_glasses_broken} Broken glasses that spot nothing.
 @end table
 
 @end table
@@ -11748,10 +11859,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_hammer}
-A standard hammer item.
- at item @b{it_hammer_new}
-A hammer that is immune to light transformations for a short latency period.
+ at item @image{images/it_hammer} @b{it_hammer} A standard hammer item.
+ at item @image{images/it_hammer} @b{it_hammer_new} A hammer that is immune to light transformations for a short latency period.
 @end table
 
 @end table
@@ -11782,7 +11891,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_key}
+ at item @image{images/it_key} @b{it_key}
 @end table
 @end table
 
@@ -11819,7 +11928,7 @@
 @item @b{Action:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_magicwand}
+ at item @image{images/it_magicwand} @b{it_magicwand}
 @end table
 
 @end table
@@ -11855,7 +11964,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_pencil}
+ at item @image{images/it_pencil} @b{it_pencil}
 @end table
 
 @end table
@@ -11886,7 +11995,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_pin}
+ at item @image{images/it_pin} @b{it_pin}
 @end table
 
 @end table
@@ -11923,20 +12032,17 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_pipe} connections = @code{"ew"}
-The horizontal pipe.
- at item @b{it_pipe_w} connections = @code{"w"}
- at item @b{it_pipe_s} connections = @code{"s"}
- at item @b{it_pipe_sw} connections = @code{"sw"}
- at item @b{it_pipe_e} connections = @code{"e"}
- at item @b{it_pipe_ew} connections = @code{"ew"}
-The horizontal pipe.
- at item @b{it_pipe_es} connections = @code{"es"}
- at item @b{it_pipe_n} connections = @code{"n"}
- at item @b{it_pipe_nw} connections = @code{"nw"}
- at item @b{it_pipe_ns} connections = @code{"ns"}
-The vertical pipe.
- at item @b{it_pipe_ne} connections = @code{"ne"}
+ at item @image{images/fl_white} @b{it_pipe} connections = @code{"ew"} The horizontal pipe.
+ at item @image{images/fl_white} @b{it_pipe_w} connections = @code{"w"}
+ at item @image{images/fl_white} @b{it_pipe_s} connections = @code{"s"}
+ at item @image{images/fl_white} @b{it_pipe_sw} connections = @code{"sw"}
+ at item @image{images/it_pipe} @b{it_pipe_e} connections = @code{"e"}
+ at item @image{images/fl_white} @b{it_pipe_ew} connections = @code{"ew"} The horizontal pipe.
+ at item @image{images/fl_white} @b{it_pipe_es} connections = @code{"es"}
+ at item @image{images/fl_white} @b{it_pipe_n} connections = @code{"n"}
+ at item @image{images/fl_white} @b{it_pipe_nw} connections = @code{"nw"}
+ at item @image{images/fl_white} @b{it_pipe_ns} connections = @code{"ns"} The vertical pipe.
+ at item @image{images/fl_white}@b{it_pipe_ne} connections = @code{"ne"}
 @end table
 @end table
 
@@ -11971,11 +12077,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_puller} orientation = @code{WEST}
- at item @b{it_puller_w} orientation = @code{WEST}
- at item @b{it_puller_s} orientation = @code{SOUTH}
- at item @b{it_puller_e} orientation = @code{EAST}
- at item @b{it_puller_n} orientation = @code{NORTH}
+ at item @image{images/fl_white} @b{it_puller} orientation = @code{WEST}
+ at item @image{images/fl_white}@b{it_puller_w} orientation = @code{WEST}
+ at item @image{images/fl_white}@b{it_puller_s} orientation = @code{SOUTH}
+ at item @image{images/fl_white}@b{it_puller_e} orientation = @code{EAST}
+ at item @image{images/it_puller} @b{it_puller_n} orientation = @code{NORTH}
 @end table
 @end table
 
@@ -12013,7 +12119,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_ring}
+ at item @image{images/it_ring} @b{it_ring}
 @end table
 
 @end table
@@ -12072,7 +12178,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_rubberband}
+ at item @image{images/it_rubberband} @b{it_rubberband}
 @end table
 @end table
 
@@ -12086,7 +12192,7 @@
 on activation. There are different @samp{flavor}s of seeds that all look the
 same, but do grow to different stones. While a @code{"wood"} seed grows to an
 @ref{st_box}_wood, a @code{"hay"} seed grows to an @ref{st_box}_hay, a
- at code{"fake"} seed grows to an unmovable @ref{st_greenbrown} and a
+ at code{"greenbrown"} seed grows to an unmovable @ref{st_greenbrown} and a
 @code{"volcano"} seed grows to an active @ref{st_volcano}.
 
 Seeds can be dropped on any item free grid position, even beneath another stone
@@ -12125,11 +12231,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_seed} flavor = @code{"wood"}
- at item @b{it_seed_wood} flavor = @code{"wood"}
- at item @b{it_seed_hay} flavor = @code{"hay"}
- at item @b{it_seed_fake} flavor = @code{"fake"}
- at item @b{it_seed_volcano} flavor = @code{"volcano"}
+ at item @image{images/it_seed} @b{it_seed} flavor = @code{"wood"}
+ at item @image{images/it_seed} @b{it_seed_wood} flavor = @code{"wood"}
+ at item @image{images/it_seed} @b{it_seed_hay} flavor = @code{"hay"}
+ at item @image{images/it_seed} @b{it_seed_greenbrown} flavor = @code{"greenbrown"}
+ at item @image{images/it_seed} @b{it_seed_volcano} flavor = @code{"volcano"}
 @end table
 
 @end table
@@ -12153,7 +12259,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_spade}
+ at item @image{images/it_spade} @b{it_spade}
 @end table
 
 @end table
@@ -12185,7 +12291,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_spoon}
+ at item @image{images/it_spoon} @b{it_spoon}
 @end table
 
 @end table
@@ -12212,9 +12318,9 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_spring}
- at item @b{it_spring_keep}
- at item @b{it_spring_drop}
+ at item @image{images/it_spring_keep} @b{it_spring}
+ at item @image{images/it_spring_keep} @b{it_spring_keep}
+ at item @image{images/it_spring_drop} @b{it_spring_drop}
 @end table
 @end table
 
@@ -12263,7 +12369,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_surprise}
+ at item @image{images/it_surprise} @b{it_surprise}
 @end table
 
 @end table
@@ -12296,10 +12402,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_sword}
-A standard sword item.
- at item @b{it_sword_new}
-A sword that is immune to light transformations for a short latency period.
+ at item @image{images/it_sword} @b{it_sword} A standard sword item.
+ at item @image{images/it_sword} @b{it_sword_new} A sword that is immune to light transformations for a short latency period.
 @end table
 
 @end table
@@ -12338,10 +12442,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_umbrella}
-A standard umbrella item.
- at item @b{it_umbrella_new}
-An umbrella that is immune to light destruction for a short latency period.
+ at item @image{images/it_umbrella} @b{it_umbrella} A standard umbrella item.
+ at item @image{images/it_umbrella} @b{it_umbrella_new} An umbrella that is immune to light destruction for a short latency period.
 @end table
 
 @end table
@@ -12376,7 +12478,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_weight}
+ at item @image{images/it_weight} @b{it_weight}
 @end table
 
 @end table
@@ -12403,7 +12505,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_wrench}
+ at item @image{images/it_wrench} @b{it_wrench}
 @end table
 
 @end table
@@ -12435,7 +12537,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_yinyang}
+ at item @image{images/it_yinyang} @b{it_yinyang}
 @end table
 
 @end table
@@ -12451,9 +12553,9 @@
 * it_crack::           Crack in the Floor
 * it_cross::           Floor Switch for patient Actors
 * it_death::           Impassable grid blocker
-* it_dynamite::        Exploder
 * it_explosion::       Short Explosion Animation
 * it_landmine::        Buried Explosive
+* it_laserbeam::           Laser Beam
 * it_magnet::          Actor attracting Magnet
 * it_meditation::      Hills and Hollows
 * it_sensor::          Floor Switch for passing Actors
@@ -12541,9 +12643,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_blocker}
+ at item @image{images/it_blocker} @b{it_blocker}
 A standard blocker item.
- at item @b{it_blocker_new}
+ at item @image{images/it_blocker} @b{it_blocker_new}
 A blocker that just finished shrinking. Mainly used internally as the direct
 successor of an @ref{st_blocker}. But it may be useful to generate an initial
 snapshot of a moving boulder over a blocker line, too. See example levels.
@@ -12601,9 +12703,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_bomb}: color = @code{BLACK}
- at item @b{it_bomb_black}: color = @code{BLACK}
- at item @b{it_bomb_white}: color = @code{WHITE}
+ at item @image{images/it_bomb_black} @b{it_bomb}: color = @code{BLACK}
+ at item @image{images/it_bomb_black} @b{it_bomb_black}: color = @code{BLACK}
+ at item @image{images/it_bomb_white} @b{it_bomb_white}: color = @code{WHITE}
 @end table
 
 @end table
@@ -12664,13 +12766,13 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_burnable}: state = @code{0}
- at item @b{it_burnable_invisible}: state = @code{0}
- at item @b{it_burnable_oil}: state = @code{1}
- at item @b{it_burnable_ignited}: state = @code{2}
- at item @b{it_burnable_burning}: state = @code{3}
- at item @b{it_burnable_ash}: state = @code{4}
- at item @b{it_burnable_fireproof}: state = @code{5}
+ at item @image{images/fl_white} @b{it_burnable}: state = @code{0}
+ at item @image{images/fl_white} @b{it_burnable_invisible}: state = @code{0}
+ at item @image{images/it_burnable_oil} @b{it_burnable_oil}: state = @code{1}
+ at item @image{images/fl_white} @b{it_burnable_ignited}: state = @code{2}
+ at item @image{images/it_burnable_burning} @b{it_burnable_burning}: state = @code{3}
+ at item @image{images/it_burnable_ash} @b{it_burnable_ash}: state = @code{4}
+ at item @image{images/it_burnable_fireproof} @b{it_burnable_fireproof}: state = @code{5}
 @end table
 
 @end table
@@ -12760,11 +12862,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_crack}: state = @code{SMALL}
- at item @b{it_crack_i}: state = @code{INVISIBLE}
- at item @b{it_crack_s}: state = @code{SMALL}
- at item @b{it_crack_m}: state = @code{MEDIUM}
- at item @b{it_crack_l}: state = @code{LARGE}
+ at item @image{images/it_crack_abyss} @b{it_crack}: state = @code{SMALL}
+ at item @image{images/fl_white} @b{it_crack_i}: state = @code{INVISIBLE}
+ at item @image{images/it_crack_abyss} @b{it_crack_s}: state = @code{SMALL}
+ at item @image{images/fl_white} @b{it_crack_m}: state = @code{MEDIUM}
+ at item @image{images/fl_white} @b{it_crack_l}: state = @code{LARGE}
 @end table
 
 @end table
@@ -12805,7 +12907,7 @@
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 @item @b{Variants:}
 @table @asis
- at item @b{it_cross}
+ at item @image{images/it_cross} @b{it_cross}
 @end table
 @end table
 
@@ -12837,62 +12939,11 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_death}
+ at item @image{images/it_death} @b{it_death}
 @end table
 
 @end table
 
- at c ----------------- Dynamite Item --------------------
- at node it_dynamite
- at subsection it_dynamite
- at obindex it_dynamite
-
-Dynamite is an explosive that can be picked up and that can be easily ignited
-at any free grid position. It ignites on drop, or if positioned on the floor in
- at samp{IDLE} state it ignites on laser light, nearby fire and other nearby 
-explosions as those caused by @ref{it_bomb}, @ref{st_dispenser}, or other 
-dyamite. A falling @ref{ot_cannonball} lets it explode immediately without prior
-ignition.
-
-On ignition its fuse starts burning. During this @samp{ACTIVE} state the
-dynamite can longer be picked up. After a short time the dynamite explodes
-causing on the 8 neigboring positions items to ignite and some stones like
- at ref{st_break} to dissolve, too. The explosion leaves at its position an
- at ref{it_meditation}_hollow on all floor kinds besides @ref{fl_ice} where an
- at ref{it_crack}_water remains.
-
-Dynamite items will be added to the inventory when an actor hits a 
- at ref{st_dispenser}_dynamite.
-
- at table @asis
- at item @b{Attributes:}
- at table @asis
- at item @b{state}, @ @ @i{values}: @code{IDLE}, @code{ACTIVE}; @ @ @i{default}: @code{IDLE} @ @ @xref{state}
- at item @b{freezable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}; @ @ @i{access}: @code{read only} @ @ @xref{freezable}
- at item @b{liftable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: @code{read only} @ @ @xref{liftable}
- at item @b{portable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{true}; @ @ @i{access}: @code{read only} @ @ @xref{portable}
-Just @samp{IDLE} dynamite can be added to the inventory, burning @samp{ACTIVE}
-ones are not portable.
- at end table
-
- at item @b{Messages:}
- at table @asis
- at item @b{explode}
-Direct explosion without burning fuse.
- at item @b{ignite}
-Ignite the fuse.
- at item @b{heat}
-Ignite the fuse.
- at end table
-
- at item @b{Variants:}
- at table @asis
- at item @b{it_dynamite}: state = @code{IDLE}
- at item @b{it_dynamite_burning}: state = @code{ACTIVE}
- at end table
-
- at end table
-
 @c ----------------- Explosion Item --------------------
 @node it_explosion
 @subsection it_explosion
@@ -12929,11 +12980,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_explosion}: state = @code{0}
- at item @b{it_explosion_nil}: state = @code{0}
- at item @b{it_explosion_hollow}: state = @code{1}
- at item @b{it_explosion_crack}: state = @code{2}
- at item @b{it_explosion_debris}: state = @code{3}
+ at item @image{images/it_explosion} @b{it_explosion}: state = @code{0}
+ at item @image{images/it_explosion} @b{it_explosion_nil}: state = @code{0}
+ at item @image{images/it_explosion} @b{it_explosion_hollow}: state = @code{1}
+ at item @image{images/it_explosion} @b{it_explosion_crack}: state = @code{2}
+ at item @image{images/it_explosion} @b{it_explosion_debris}: state = @code{3}
 @end table
 
 @end table
@@ -12966,11 +13017,36 @@
 @item @b{Action:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_landmine}
+ at item @image{images/it_landmine} @b{it_landmine}
 @end table
 
 @end table
 
+ at c ----------------- Laserbeam Item --------------------
+ at node it_laserbeam
+ at subsection it_laserbeam
+ at obindex it_laserbeam
+
+A beam of laser light. This item is caused by an @ref{st_laser} that is switched
+on. The beam is automatically calculated and the items are set by the engine.
+You can not set laser beam items on your own. But you may detect a beam as an
+item being located on the item layer. You are free to replace a laser beam item
+by another item. This causes automatically a recalculation of the laser light.
+
+ at table @asis
+ at item @b{Attributes:}
+ at table @asis
+ at item @b{freezable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: @code{read only} @ @ @xref{freezable}
+ at item @b{liftable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: @code{read only} @ @ @xref{liftable}
+ at item @b{portable}, @ @ @i{values}: @code{true}, @code{false}; @ @ @i{default}: @code{false}; @ @ @i{access}: @code{read only} @ @ @xref{portable}
+ at end table
+ at item @b{Messages:} none
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/it_laser} @b{it_laserbeam} can not be instanciated by levels
+ at end table
+ at end table
+
 @c ----------------- Magnet Item --------------------
 @node it_magnet
 @subsection it_magnet
@@ -13020,12 +13096,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_magnet}
-A magnet in state @samp{OFF}.
- at item @b{it_magnet_on}
-A magnet in state @samp{ON}.
- at item @b{it_magnet_off}
-A magnet in state @samp{OFF}.
+ at item @image{images/it_magnet_off} @b{it_magnet} state = @samp{OFF}.
+ at item @image{images/it_magnet_on} @b{it_magnet_on} state = @samp{ON}.
+ at item @image{images/it_magnet_off} @b{it_magnet_off} state = @samp{OFF}.
 @end table
 
 @end table
@@ -13111,13 +13184,13 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_meditation} state = @code{MEDITATION_HOLLOW}
- at item @b{it_meditation_caldera} state = @code{MEDITATION_CALDERA}
- at item @b{it_meditation_hollow} state = @code{MEDITATION_HOLLOW}
- at item @b{it_meditation_dent} state = @code{MEDITATION_DENT}
- at item @b{it_meditation_bump} state = @code{MEDITATION_BUMP}
- at item @b{it_meditation_hill} state = @code{MEDITATION_HILL}
- at item @b{it_meditation_volcano} state = @code{MEDITATION_VOLCANO}
+ at item @image{images/it_meditation_hollow} @b{it_meditation} state = @code{MEDITATION_HOLLOW}
+ at item @image{images/it_meditation_caldera} @b{it_meditation_caldera} state = @code{MEDITATION_CALDERA}
+ at item @image{images/it_meditation_hollow} @b{it_meditation_hollow} state = @code{MEDITATION_HOLLOW}
+ at item @image{images/it_meditation_dent} @b{it_meditation_dent} state = @code{MEDITATION_DENT}
+ at item @image{images/it_meditation_bump} @b{it_meditation_bump} state = @code{MEDITATION_BUMP}
+ at item @image{images/it_meditation_hill} @b{it_meditation_hill} state = @code{MEDITATION_HILL}
+ at item @image{images/it_meditation_volcano} @b{it_meditation_volcano} state = @code{MEDITATION_VOLCANO}
 @end table
 
 @end table
@@ -13170,8 +13243,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_sensor}: exit = @code{false}
- at item @b{it_sensor_exit}: exit = @code{true}
+ at item @image{images/it_sensor} @b{it_sensor}: exit = @code{false}
+ at item @image{images/it_sensor_exit} @b{it_sensor_exit}: exit = @code{true}
 @end table
 
 @end table
@@ -13220,10 +13293,10 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_shogun}: flavor = @code{"s"}
- at item @b{it_shogun_s}: flavor = @code{"s"}
- at item @b{it_shogun_m}: flavor = @code{"m"}
- at item @b{it_shogun_l}: flavor = @code{"l"}
+ at item @image{images/it_shogun_s} @b{it_shogun}: flavor = @code{"s"}
+ at item @image{images/it_shogun_s} @b{it_shogun_s}: flavor = @code{"s"}
+ at item @image{images/it_shogun_m} @b{it_shogun_m}: flavor = @code{"m"}
+ at item @image{images/it_shogun_l} @b{it_shogun_l}: flavor = @code{"l"}
 @end table
 
 @end table
@@ -13250,7 +13323,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_springboard}
+ at item @image{images/it_springboard} @b{it_springboard}
 @end table
 
 @end table
@@ -13277,7 +13350,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @b{it_squashed}
+ at item @image{images/it_squashed} @b{it_squashed}
 @end table
 @end table
 
@@ -13321,22 +13394,22 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_strip}: connections = @code{""}
- at item @b{it_strip_w}: connections = @code{"w"}
- at item @b{it_strip_s}: connections = @code{"s"}
- at item @b{it_strip_sw}: connections = @code{"sw"}
- at item @b{it_strip_e}: connections = @code{"e"}
- at item @b{it_strip_ew}: connections = @code{"ew"}
- at item @b{it_strip_es}: connections = @code{"es"}
- at item @b{it_strip_esw}: connections = @code{"esw"}
- at item @b{it_strip_n}: connections = @code{"n"}
- at item @b{it_strip_nw}: connections = @code{"nw"}
- at item @b{it_strip_ns}: connections = @code{"ns"}
- at item @b{it_strip_nsw}: connections = @code{"nsw"}
- at item @b{it_strip_ne}: connections = @code{"ne"}
- at item @b{it_strip_new}: connections = @code{"new"}
- at item @b{it_strip_nes}: connections = @code{"nes"}
- at item @b{it_strip_nesw}: connections = @code{"nesw"}
+ at item @image{images/it_strip} @b{it_strip}: connections = @code{""}
+ at item @image{images/fl_white} @b{it_strip_w}: connections = @code{"w"}
+ at item @image{images/fl_white} @b{it_strip_s}: connections = @code{"s"}
+ at item @image{images/fl_white} @b{it_strip_sw}: connections = @code{"sw"}
+ at item @image{images/fl_white} @b{it_strip_e}: connections = @code{"e"}
+ at item @image{images/fl_white} @b{it_strip_ew}: connections = @code{"ew"}
+ at item @image{images/fl_white} @b{it_strip_es}: connections = @code{"es"}
+ at item @image{images/fl_white} @b{it_strip_esw}: connections = @code{"esw"}
+ at item @image{images/fl_white} @b{it_strip_n}: connections = @code{"n"}
+ at item @image{images/fl_white} @b{it_strip_nw}: connections = @code{"nw"}
+ at item @image{images/fl_white} @b{it_strip_ns}: connections = @code{"ns"}
+ at item @image{images/fl_white} @b{it_strip_nsw}: connections = @code{"nsw"}
+ at item @image{images/fl_white} @b{it_strip_ne}: connections = @code{"ne"}
+ at item @image{images/fl_white} @b{it_strip_new}: connections = @code{"new"}
+ at item @image{images/fl_white} @b{it_strip_nes}: connections = @code{"nes"}
+ at item @image{images/fl_white} @b{it_strip_nesw}: connections = @code{"nesw"}
 
 @end table
 
@@ -13384,7 +13457,7 @@
 @end table
 @item @b{Variants:}
 @table @asis
- at item @b{it_trap}
+ at item @image{images/it_trap} @b{it_trap}
 @end table
 
 @end table
@@ -13443,7 +13516,7 @@
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 @item @b{Variants:}
 @table @asis
- at item @b{it_trigger}
+ at item @image{images/it_trigger} @b{it_trigger}
 @end table
 
 @end table
@@ -13529,9 +13602,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_vortex}:  state = @code{OPEN}.
- at item @b{it_vortex_open}: state = @code{OPEN}.
- at item @b{it_vortex_closed}: state @samp{CLOSED}.
+ at item @image{images/it_vortex} @b{it_vortex}:  state = @code{OPEN}.
+ at item @image{images/it_vortex} @b{it_vortex_open}: state = @code{OPEN}.
+ at item @image{images/fl_white} @b{it_vortex_closed}: state @samp{CLOSED}.
 @end table
 @end table
 
@@ -13604,9 +13677,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{it_wormhole}: state = @code{OFF}.
- at item @b{it_wormhole_on}: state = @code{ON}.
- at item @b{it_wormhole_off}: state @code{OFF}.
+ at item @image{images/it_wormhole} @b{it_wormhole}: state = @code{OFF}.
+ at item @image{images/it_wormhole} @b{it_wormhole_on}: state = @code{ON}.
+ at item @image{images/fl_white} @b{it_wormhole_off}: state @code{OFF}.
 @end table
 @end table
 
@@ -13628,6 +13701,7 @@
 @node Stone Overview
 @section Stone Overview
 
+WORK IN PROGRESS - The follwing table is still incomplete!
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
 @item @image{images/st_ancient} @tab @yref{st_ancient}
 @tab @image{images/st_bluegray} @tab @yref{st_bluegray}
@@ -13834,8 +13908,8 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @b{st_bluegray}
- at item @b{st_bluegray_hollow}
+ at item @image{images/st_bluegray} @b{st_bluegray}
+ at item @image{images/st_bluegray} @b{st_bluegray_hollow}
 @end table
 @end table
 
@@ -17890,7 +17964,8 @@
 strong hits will cause marbles to shatter themselves. An actor can lower the
 required speed by adding @ref{it_weight}, by revealing an @ref{it_hammer}, or by
 weakening the window faces by prior scratching it with an @ref{it_ring}. Green
-safety glass windows will never break on actor attacks.
+safety glass windows will never break on actor attacks and actors will not 
+shatter on hitting saftey glass.
 
 Bomb explosions can shatter window faces, too. Normal blue window faces adjacent
 to a bomb explosion will break. Green safety glass faces will break only if

Modified: trunk/doc/reference/images/Makefile.am
===================================================================
--- trunk/doc/reference/images/Makefile.am	2009-05-29 20:25:11 UTC (rev 1691)
+++ trunk/doc/reference/images/Makefile.am	2009-05-29 22:24:08 UTC (rev 1692)
@@ -54,19 +54,82 @@
 	fl_yinyang_yang.png \
 	fl_yinyang_yin.png \
 	it_bag.png \
+	it_banana.png \
+	it_blocker.png \
+	it_bomb_black.png \
+	it_bomb_white.png \
+	it_bottle_idle.png \
+	it_bottle_broken.png \
+	it_brush.png \
+	it_burnable_ash.png \
+	it_burnable_burning.png \
+	it_burnable_fireproof.png \
+	it_burnable_oil.png \
+	it_cherry.png \
+	it_coffee.png \
+	it_coin_s.png \
+	it_coin_m.png \
+	it_coin_l.png \
+	it_crack_abyss.png \
+	it_crack_water.png \
+	it_cross.png \
+	it_death.png \
+	it_document.png \
+	it_drop.png \
+	it_dynamite.png \
+	it_explosion.png \
+	it_extinguisher.png \
+	it_extralife.png \
+	it_flag_black.png \
+	it_flag_white.png \
+	it_floppy.png \
+	it_glasses.png \
+	it_glasses_broken.png \
+	it_hammer.png \
+	it_key.png \
+	it_landmine.png \
+	it_laser.png \
+	it_magicwand.png \
+	it_magnet_off.png \
+	it_magnet_on.png \
+	it_meditation_bump.png \
+	it_meditation_caldera.png \
+	it_meditation_dent.png \
+	it_meditation_hill.png \
+	it_meditation_hollow.png \
+	it_meditation_volcano.png \
+	it_pencil.png \
 	it_pin.png \
+	it_pipe.png \
 	it_puller.png \
+	it_ring.png \
+	it_rubberband.png \
+	it_seed.png \
 	it_sensor.png \
+	it_sensor_exit.png \
+	it_shogun_m.png \
+	it_shogun_l.png \
+	it_shogun_s.png \
+	it_spade.png \
+	it_spoon.png \
 	it_springboard.png \
 	it_spring_drop.png \
 	it_spring_keep.png \
+	it_squashed.png \
 	it_strip.png \
 	it_surprise.png \
+	it_sword.png \
 	it_trap.png \
+	it_trigger.png \
+	it_umbrella.png \
+	it_vortex.png \
 	it_weight.png \
+	it_wormhole.png \
+	it_wrench.png \
 	it_yinyang.png \
 	st_ancient.png \
 	st_bluegray.png \
+	st_brake.png \
 	st_brownie.png \
 	st_brownmarble.png \
 	st_camouflage.png \



From raoul at mail.berlios.de  Sat May 30 01:29:44 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 30 May 2009 01:29:44 +0200
Subject: [Enigma-game-svn] r1693 - in trunk/data: . gfx32 gfx40 gfx48
Message-ID: <200905292329.n4TNTi5u006996@sheep.berlios.de>

Author: raoul
Date: 2009-05-30 01:29:42 +0200 (Sat, 30 May 2009)
New Revision: 1693

Added:
   trunk/data/gfx32/st_flhay_growing.png
   trunk/data/gfx32/st_greenbrown_growing.png
   trunk/data/gfx32/st_volcano_growing.png
   trunk/data/gfx32/st_wood_growing.png
   trunk/data/gfx40/st_flhay_growing.png
   trunk/data/gfx40/st_greenbrown_growing.png
   trunk/data/gfx40/st_volcano_growing.png
   trunk/data/gfx40/st_wood_growing.png
   trunk/data/gfx48/st_flhay_growing.png
   trunk/data/gfx48/st_greenbrown_growing.png
   trunk/data/gfx48/st_volcano_growing.png
   trunk/data/gfx48/st_wood_growing.png
Removed:
   trunk/data/gfx32/st-wood-growing.png
   trunk/data/gfx40/st-wood-growing.png
   trunk/data/gfx48/st-wood-growing.png
Modified:
   trunk/data/gfx40/sh-round2-growing.png
   trunk/data/gfx48/sh-round2-growing.png
   trunk/data/models-2d.lua
Log:
-> New models for stones that grow from seeds
   (st_box, st_flhay, st_greenbrown, st_volcano)
-> Corrected shadows for these too
   (shadows are round)



Deleted: trunk/data/gfx32/st-wood-growing.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx32/st_flhay_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_flhay_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_greenbrown_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_greenbrown_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_volcano_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_volcano_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx32/st_wood_growing.png (from rev 1691, trunk/data/gfx32/st-wood-growing.png)

Modified: trunk/data/gfx40/sh-round2-growing.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-wood-growing.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx40/st_flhay_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_flhay_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_greenbrown_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_greenbrown_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_volcano_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_volcano_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx40/st_wood_growing.png (from rev 1691, trunk/data/gfx40/st-wood-growing.png)

Modified: trunk/data/gfx48/sh-round2-growing.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-wood-growing.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx48/st_flhay_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_flhay_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/st_greenbrown_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_greenbrown_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx48/st_volcano_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_volcano_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx48/st_wood_growing.png (from rev 1691, trunk/data/gfx48/st-wood-growing.png)

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-29 22:24:08 UTC (rev 1692)
+++ trunk/data/models-2d.lua	2009-05-29 23:29:42 UTC (rev 1693)
@@ -794,11 +794,10 @@
     DefStone("st_camouflage")
     DefStone("st_dummy")
     DefImage("st-easymode")
-    DefStone("st-flhay")
     DefStone("st_flat_fire")
     DefStone("st-floppy0", "sh-round", {filename="st-floppy1"})
     DefStone("st-floppy1", "sh-round", {filename="st-floppy2"})
-    DefStone("st-flrock")
+    DefStone("st-flrock", "sh-round")
     DefStone("st_rawglass", "sh-glass")
     DefStone("st_rawglass_quad", "sh_rawglass_quad")
     DefStone("st_lightglass", "sh-glass")
@@ -1299,21 +1298,48 @@
     DefSolidStone("st-turnstile-green-anim", "turnstile-green-anim")
 end
 
--- st-wood*, growing stones, st-volcano, st-blocker --
+-- growing stones, st_box, st_flhay, greenbrown seed, st-volcano, st-blocker --
 do
-   local sh=DefSubimages("sh-round2-growing", {h=3,imgw=ShadowSize,imgh=ShadowSize})
+   local shadows=DefSubimages("sh-round2-growing", {h=3,imgw=ShadowSize,imgh=ShadowSize})
 
-   -- Wooden stones --
+   -- Wooden (box) stones --
    do
       DefSubimages("st-wood", {modelname="st-wood-fg",h=2})
       DefShModel("st-wood1", "st-wood-fg1", "sh-round")
       DefShModel("st-wood2", "st-wood-fg2", "sh-round")
-      local n=DefSubimages("st-wood-growing", {h=3})
-      DefAnim("wood-growing-fg", BuildFrames(n, 130))
-      DefAnim("wood-growing-bg", BuildFrames(sh, 130))
+
+      local images=DefSubimages("st_wood_growing", {h=3})
+      DefAnim("wood-growing-fg", BuildFrames(images, 130))
+      DefAnim("wood-growing-bg", BuildFrames(shadows, 130))
       DefShModel("st_wood_growing", "wood-growing-fg", "wood-growing-bg")
    end
 
+   -- Greenbrown seed growing --
+   do
+      local images=DefSubimages("st_greenbrown_growing", {h=3})
+      DefAnim("greenbrown-growing-fg", BuildFrames(images, 130))
+      DefAnim("greenbrown-growing-bg", BuildFrames(shadows, 130))
+      DefShModel("st_greenbrown_growing", "greenbrown-growing-fg", "greenbrown-growing-bg")
+   end
+
+   -- st_flhay, hay seed growing --
+   do
+      DefStone("st-flhay", "sh-round")
+
+      local images=DefSubimages("st_flhay_growing", {h=3})
+      DefAnim("hay-growing-fg", BuildFrames(images, 130))
+      DefAnim("hay-growing-bg", BuildFrames(shadows, 130))
+      DefShModel("st_flhay_growing", "hay-growing-fg", "hay-growing-bg")
+   end
+
+   -- volcano growing --
+   do
+      local images=DefSubimages("st_volcano_growing", {h=3})
+      DefAnim("volcano-growing-fg", BuildFrames(images, 80))
+      DefAnim("volcano-growing-bg", BuildFrames(shadows, 80))
+      DefShModel("st_volcano_growing", "volcano-growing-fg", "volcano-growing-bg")
+   end
+
    -- Blocker stone --
    do
       local n=DefSubimages("st-blocker", {h=4})
@@ -1323,20 +1349,14 @@
          table.insert(frames, "st-blocker"..i)
       end
       DefAnim("blocker-growing-fg", BuildFrames(frames, 60))
-      DefAnim("blocker-growing-bg", BuildFrames(sh, 60))
+      DefAnim("blocker-growing-bg", BuildFrames(shadows, 60))
       DefAnim("blocker-shrinking-fg", ReverseFrames(BuildFrames(frames, 60)))
-      DefAnim("blocker-shrinking-bg", ReverseFrames(BuildFrames(sh, 60)))
+      DefAnim("blocker-shrinking-bg", ReverseFrames(BuildFrames(shadows, 60)))
       DefShModel("st-blocker-shrinking", "blocker-shrinking-fg", "blocker-shrinking-bg");
       DefShModel("st-blocker-growing", "blocker-growing-fg", "blocker-growing-bg");
    end
 end
 
-do
-    DefAlias("st_flhay_growing", "st_wood_growing")
-    DefAlias("st_greenbrown_growing", "st_wood_growing")
-    DefAlias("st_volcano_growing", "st-blocker-growing")
-end
-
 -- st-window --
 do
     local fg_window = {blue = DefSubimages("st_window_blue", {modelname="fg-window_blue",w=4,h=4}),



From ral at mail.berlios.de  Sat May 30 13:09:49 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sat, 30 May 2009 13:09:49 +0200
Subject: [Enigma-game-svn] r1694 - trunk/src/items
Message-ID: <200905301109.n4UB9naa027864@sheep.berlios.de>

Author: ral
Date: 2009-05-30 13:09:35 +0200 (Sat, 30 May 2009)
New Revision: 1694

Modified:
   trunk/src/items/ExtraLife.cc
   trunk/src/items/ExtraLife.hh
   trunk/src/items/Hammer.cc
   trunk/src/items/Hammer.hh
   trunk/src/items/Sword.cc
   trunk/src/items/Sword.hh
   trunk/src/items/Umbrella.cc
   trunk/src/items/Umbrella.hh
Log:
Trunk 1.1: 
- it_hammer, it_sword, it_umbrella, it_extralife:
  fix laser light behaviour on frozen st_ice moves, do transform exactly
  when new position has an additional light in comparison to privious pos.


Modified: trunk/src/items/ExtraLife.cc
===================================================================
--- trunk/src/items/ExtraLife.cc	2009-05-29 23:29:42 UTC (rev 1693)
+++ trunk/src/items/ExtraLife.cc	2009-05-30 11:09:35 UTC (rev 1694)
@@ -29,7 +29,7 @@
 
     ExtraLife::ExtraLife(bool isNew) : Item() {
         if (isNew) {
-            objFlags |= ALL_DIRECTIONS;
+            objFlags |= OBJBIT_NEW;
         }
     }
     
@@ -41,20 +41,24 @@
     }
 
     void ExtraLife::on_creation(GridPos p) {
-        if ((objFlags & ALL_DIRECTIONS) == ALL_DIRECTIONS) {
+        if (objFlags & OBJBIT_NEW) {
             // a new transformed extralife
             GameTimer.set_alarm(this, 0.2, false);
         } else {
-            updateCurrentLightDirs();
+            objFlags &= ~OBJBIT_LIGHTNEWDIRS;
+            objFlags |= (objFlags & OBJBIT_LIGHT) >> 25;
             activatePhoto();
         }
         Item::on_creation(p);
     }
     
     void ExtraLife::on_removal(GridPos p) {
+        // remember last enlightment for moves
+        objFlags &= ~OBJBIT_LIGHT;
+        objFlags |= (objFlags & OBJBIT_LIGHTNEWDIRS) << 25;
         GameTimer.remove_alarm(this);
-        objFlags &= ~ALL_DIRECTIONS;
-        Item::on_removal(p);
+        objFlags &= ~OBJBIT_NEW;
+       Item::on_removal(p);
     }
     
     void ExtraLife::lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs) {
@@ -69,8 +73,9 @@
     }
     
     void ExtraLife::alarm() {
-            DirectionBits db = updateCurrentLightDirs();
-            activatePhoto();        
+        objFlags &= ~OBJBIT_NEW;
+        DirectionBits db = updateCurrentLightDirs();
+        activatePhoto();        
     }
 
     DEF_ITEMTRAITS(ExtraLife, "it_extralife", it_extralife);

Modified: trunk/src/items/ExtraLife.hh
===================================================================
--- trunk/src/items/ExtraLife.hh	2009-05-29 23:29:42 UTC (rev 1693)
+++ trunk/src/items/ExtraLife.hh	2009-05-30 11:09:35 UTC (rev 1694)
@@ -30,6 +30,12 @@
         CLONEOBJ(ExtraLife);
         DECL_ITEMTRAITS;
         
+    private:        
+        enum ObjectPrivatFlagsBits {
+            OBJBIT_NEW       =   1<<24,  ///< Object is new and rejects transformations for a latency time 
+            OBJBIT_LIGHT     =  15<<25   ///< Light status kept for frozen moves operations 
+        };
+        
     public:
         ExtraLife(bool isNew);
 

Modified: trunk/src/items/Hammer.cc
===================================================================
--- trunk/src/items/Hammer.cc	2009-05-29 23:29:42 UTC (rev 1693)
+++ trunk/src/items/Hammer.cc	2009-05-30 11:09:35 UTC (rev 1694)
@@ -27,24 +27,28 @@
 
     Hammer::Hammer(bool isNew) : Item() {
         if (isNew) {
-            objFlags |= ALL_DIRECTIONS;
+            objFlags |= OBJBIT_NEW;
         }
     }
     
     void Hammer::on_creation(GridPos p) {
-        if ((objFlags & ALL_DIRECTIONS) == ALL_DIRECTIONS) {
+        if (objFlags & OBJBIT_NEW) {
             // a new transformed hammer
             GameTimer.set_alarm(this, 0.2, false);
         } else {
-            updateCurrentLightDirs();
+            objFlags &= ~OBJBIT_LIGHTNEWDIRS;
+            objFlags |= (objFlags & OBJBIT_LIGHT) >> 25;
             activatePhoto();
         }
         Item::on_creation(p);
     }
     
     void Hammer::on_removal(GridPos p) {
+        // remember last enlightment for moves
+        objFlags &= ~OBJBIT_LIGHT;
+        objFlags |= (objFlags & OBJBIT_LIGHTNEWDIRS) << 25;
         GameTimer.remove_alarm(this);
-        objFlags &= ~ALL_DIRECTIONS;
+        objFlags &= ~OBJBIT_NEW;
         Item::on_removal(p);
     }
     
@@ -56,8 +60,9 @@
     }
     
     void Hammer::alarm() {
-            DirectionBits db = updateCurrentLightDirs();
-            activatePhoto();        
+        objFlags &= ~OBJBIT_NEW;
+        DirectionBits db = updateCurrentLightDirs();
+        activatePhoto();        
     }
     
     DEF_ITEMTRAITS(Hammer, "it_hammer", it_hammer);

Modified: trunk/src/items/Hammer.hh
===================================================================
--- trunk/src/items/Hammer.hh	2009-05-29 23:29:42 UTC (rev 1693)
+++ trunk/src/items/Hammer.hh	2009-05-30 11:09:35 UTC (rev 1694)
@@ -30,6 +30,12 @@
         CLONEOBJ(Hammer);
         DECL_ITEMTRAITS;
 
+    private:        
+        enum ObjectPrivatFlagsBits {
+            OBJBIT_NEW       =   1<<24,  ///< Object is new and rejects transformations for a latency time 
+            OBJBIT_LIGHT     =  15<<25   ///< Light status kept for frozen moves operations 
+        };
+        
     public:
         Hammer(bool isNew);
 

Modified: trunk/src/items/Sword.cc
===================================================================
--- trunk/src/items/Sword.cc	2009-05-29 23:29:42 UTC (rev 1693)
+++ trunk/src/items/Sword.cc	2009-05-30 11:09:35 UTC (rev 1694)
@@ -27,24 +27,28 @@
 
     Sword::Sword(bool isNew) : Item() {
         if (isNew) {
-            objFlags |= ALL_DIRECTIONS;
+            objFlags |= OBJBIT_NEW;
         }
     }
 
     void Sword::on_creation(GridPos p) {
-        if ((objFlags & ALL_DIRECTIONS) == ALL_DIRECTIONS) {
-            // a new transformed hammer
+        if (objFlags & OBJBIT_NEW) {
+            // a new transformed sword
             GameTimer.set_alarm(this, 0.2, false);
         } else {
-            updateCurrentLightDirs();
+            objFlags &= ~OBJBIT_LIGHTNEWDIRS;
+            objFlags |= (objFlags & OBJBIT_LIGHT) >> 25;
             activatePhoto();
         }
         Item::on_creation(p);
     }
     
     void Sword::on_removal(GridPos p) {
+        // remember last enlightment for moves
+        objFlags &= ~OBJBIT_LIGHT;
+        objFlags |= (objFlags & OBJBIT_LIGHTNEWDIRS) << 25;
         GameTimer.remove_alarm(this);
-        objFlags &= ~ALL_DIRECTIONS;
+        objFlags &= ~OBJBIT_NEW;
         Item::on_removal(p);
     }
 
@@ -57,8 +61,9 @@
     }
     
     void Sword::alarm() {
-            updateCurrentLightDirs();
-            activatePhoto();        
+        objFlags &= ~OBJBIT_NEW;
+        updateCurrentLightDirs();
+        activatePhoto();        
     }
     
     DEF_ITEMTRAITS(Sword, "it_sword", it_sword);

Modified: trunk/src/items/Sword.hh
===================================================================
--- trunk/src/items/Sword.hh	2009-05-29 23:29:42 UTC (rev 1693)
+++ trunk/src/items/Sword.hh	2009-05-30 11:09:35 UTC (rev 1694)
@@ -30,6 +30,12 @@
         CLONEOBJ(Sword);
         DECL_ITEMTRAITS;
 
+    private:        
+        enum ObjectPrivatFlagsBits {
+            OBJBIT_NEW       =   1<<24,  ///< Object is new and rejects transformations for a latency time 
+            OBJBIT_LIGHT     =  15<<25   ///< Light status kept for frozen moves operations 
+        };
+        
     public:
         Sword(bool isNew);
 

Modified: trunk/src/items/Umbrella.cc
===================================================================
--- trunk/src/items/Umbrella.cc	2009-05-29 23:29:42 UTC (rev 1693)
+++ trunk/src/items/Umbrella.cc	2009-05-30 11:09:35 UTC (rev 1694)
@@ -29,24 +29,28 @@
 
     Umbrella::Umbrella(bool isNew) : Item() {
         if (isNew) {
-            objFlags |= ALL_DIRECTIONS;
+            objFlags |= OBJBIT_NEW;
         }
     }
     
     void Umbrella::on_creation(GridPos p) {
-        if ((objFlags & ALL_DIRECTIONS) == ALL_DIRECTIONS) {
+        if (objFlags & OBJBIT_NEW) {
             // a new transformed umbrella
             GameTimer.set_alarm(this, 0.2, false);
         } else {
-            updateCurrentLightDirs();
+            objFlags &= ~OBJBIT_LIGHTNEWDIRS;
+            objFlags |= (objFlags & OBJBIT_LIGHT) >> 25;
             activatePhoto();
         }
         Item::on_creation(p);
     }
     
     void Umbrella::on_removal(GridPos p) {
+        // remember last enlightment for moves
+        objFlags &= ~OBJBIT_LIGHT;
+        objFlags |= (objFlags & OBJBIT_LIGHTNEWDIRS) << 25;
         GameTimer.remove_alarm(this);
-        objFlags &= ~ALL_DIRECTIONS;
+        objFlags &= ~OBJBIT_NEW;
         Item::on_removal(p);
     }
     
@@ -63,8 +67,9 @@
     }
     
     void Umbrella::alarm() {
-            DirectionBits db = updateCurrentLightDirs();
-            activatePhoto();        
+        objFlags &= ~OBJBIT_NEW;
+        DirectionBits db = updateCurrentLightDirs();
+        activatePhoto();        
     }
 
     DEF_ITEMTRAITS (Umbrella, "it_umbrella", it_umbrella);

Modified: trunk/src/items/Umbrella.hh
===================================================================
--- trunk/src/items/Umbrella.hh	2009-05-29 23:29:42 UTC (rev 1693)
+++ trunk/src/items/Umbrella.hh	2009-05-30 11:09:35 UTC (rev 1694)
@@ -30,6 +30,12 @@
         CLONEOBJ(Umbrella);
         DECL_ITEMTRAITS;
 
+    private:        
+        enum ObjectPrivatFlagsBits {
+            OBJBIT_NEW       =   1<<24,  ///< Object is new and rejects transformations for a latency time 
+            OBJBIT_LIGHT     =  15<<25   ///< Light status kept for frozen moves operations 
+        };
+        
     public:
         Umbrella(bool isNew);
 



From ral at mail.berlios.de  Sat May 30 13:18:27 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sat, 30 May 2009 13:18:27 +0200
Subject: [Enigma-game-svn] r1695 - team_levelpacks/team_test_new_api
Message-ID: <200905301118.n4UBIRIi007332@sheep.berlios.de>

Author: ral
Date: 2009-05-30 13:18:14 +0200 (Sat, 30 May 2009)
New Revision: 1695

Modified:
   team_levelpacks/team_test_new_api/ralT021_1.xml
   team_levelpacks/team_test_new_api/ralT061_1.xml
   team_levelpacks/team_test_new_api/ralT084_1.xml
   team_levelpacks/team_test_new_api/ralT086_1.xml
Log:
Test Level new API:
- st_ice frozen items laser tests
- it_ring tests


Modified: team_levelpacks/team_test_new_api/ralT021_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT021_1.xml	2009-05-30 11:09:35 UTC (rev 1694)
+++ team_levelpacks/team_test_new_api/ralT021_1.xml	2009-05-30 11:18:14 UTC (rev 1695)
@@ -20,6 +20,7 @@
 wo["ConserveLevel"] = true
 
 ti[" "] = {"fl_sahara"}
+ti["~"] = {"fl_water"}
 ti["#"] = ti[" "] .. {"st-rock1"}
 
 ti["A"] = {"it_vortex", name="v1", destination="v2", scissor=true}
@@ -29,6 +30,8 @@
 ti["R"] = {"st_rubberband"}
 ti["W"] = {"st_box"}
 ti["S"] = {"st_switch", target="autoclose"}
+ti["r"] = {"it_ring"}
+ti["f"] = {"it_flag"}
 
 ti["1"] = {"#ac_marble"}
 
@@ -40,11 +43,11 @@
 "                    ",
 "  W       W    W    ",
 "                    ",
-"      1             ",
+"      1   r    f    ",
 "   S                ",
 "                    ",
 "                    ",
-"                    ",
+"                ~   ",
 "                    "
 })
 

Modified: team_levelpacks/team_test_new_api/ralT061_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT061_1.xml	2009-05-30 11:09:35 UTC (rev 1694)
+++ team_levelpacks/team_test_new_api/ralT061_1.xml	2009-05-30 11:18:14 UTC (rev 1695)
@@ -7,7 +7,7 @@
       <el:author  el:name="Ronald Lamprecht" el:email="ral at users.berlios.de"/>
       <el:copyright>Copyright ? 2008 Ronald Lamprecht</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.00">
+      <el:compatibility el:enigma="1.10">
       </el:compatibility>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
       <el:comments>

Modified: team_levelpacks/team_test_new_api/ralT084_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT084_1.xml	2009-05-30 11:09:35 UTC (rev 1694)
+++ team_levelpacks/team_test_new_api/ralT084_1.xml	2009-05-30 11:18:14 UTC (rev 1695)
@@ -60,7 +60,7 @@
 
 else
     mymaze1 = res.maze(ti, {area ={"anchor1", 4, 5}, render = {".", "~", "-"}})
-    mymaze2 = res.maze(mymaze1, {area ={"anchor2", 8, 4}, render = {{".","+"}, "~", "-"}})
+    mymaze2 = res.maze(mymaze1, {area ={"anchor2", 8, 4}, render = {{".","+"}, "~", "-"}})    
     mymaze3 = res.maze(mymaze2, {area ={po(2, 12), 5, 5}, kernel={3,2}, render = {".", wo:newMap(" ", {"!!!~","--!~","~~~~"})}})
     mymaze4 = res.maze(mymaze3, {area ={"."}, kernel={1,1}, render = {"!", "~", "-"}})
     mymaze5 = res.maze(mymaze4, {area ={"amaze#*"}, render = {"!", "~", "!"}})

Modified: team_levelpacks/team_test_new_api/ralT086_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT086_1.xml	2009-05-30 11:09:35 UTC (rev 1694)
+++ team_levelpacks/team_test_new_api/ralT086_1.xml	2009-05-30 11:18:14 UTC (rev 1695)
@@ -29,12 +29,18 @@
 ti["j"] = {"it_springboard"}
 ti["m"] = {"it_magnet"}
 ti["o"] = {"it_meditation"}
-ti["x"] = {"it_cross"}
+ti["x"] = {"it_cross", "cross"}
+ti["w"] = {"it_wormhole", destination="cross", range=0.5}
 ti["t"] = {"it_trigger"}
 ti["e"] = {"it_extinguisher"}
 ti["%"] = {"it_crack"}
 ti["b"] = {"it_bottle"}
 ti["B"] = {"it_bottle_broken"} .. ti["~"]
+ti["h"] = {"it_hammer"}
+ti["u"] = {"it_umbrella"}
+ti["n"] = {"it_banana"}
+ti["a"] = {"it_coin_s"}
+ti["A"] = {"it_coin_s"} .. ti{"st_ice"}
 ti["'"] = {"it_squashed"}
 ti["d"] = {"it_dynamite"}
 ti["i"] = {"it_burnable_oil"}
@@ -45,6 +51,8 @@
 ti["s"] = {"it_shogun_s", target="shogun"}
 ti["S"] = {"st_shogun_s"}
 ti["L"] = {"st_laser_n", "shogun"}
+ti["M"] = {"st_laser_w", state=ON}
+ti["P"] = {"st_polarswitch"}
 
 ti["@"] = {"#ac_marble"}
 
@@ -52,9 +60,9 @@
 ti["Z"] = {"st_swap", "wireswap"}
 
 w, h = wo(ti, " ", {
-"                    ",
-"     j    m    o    ",
-"                  _ ",
+"     h    a    n  PM",
+"     j    m    o  i ",
+"     u            _ ",
 " L   x    .    c  _ ",
 "                    ",
 " s   t    *    :  b ",
@@ -63,7 +71,7 @@
 "  #                 ",
 "     %    d    W   E",
 "   z                ",
-" Z       ~~~~~~~B   ",
+" Z       ~~~~~~~B  w",
 "            ~~~     "
 })
 wo:add({"ot_wire", anchor1="wireice", anchor2="wireswap"})



From raoul at mail.berlios.de  Sat May 30 17:35:44 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 30 May 2009 17:35:44 +0200
Subject: [Enigma-game-svn] r1696 - in trunk: attic/images-stones data
	data/gfx32 data/gfx40 data/gfx48
Message-ID: <200905301535.n4UFZiB6028189@sheep.berlios.de>

Author: raoul
Date: 2009-05-30 17:35:38 +0200 (Sat, 30 May 2009)
New Revision: 1696

Added:
   trunk/attic/images-stones/sh_round_growing_gfx32.xcf
   trunk/attic/images-stones/sh_round_growing_gfx40.xcf
   trunk/attic/images-stones/sh_round_growing_gfx48.xcf
   trunk/attic/images-stones/st_rock_growing-gfx32.xcf
   trunk/attic/images-stones/st_rock_growing-gfx40.xcf
   trunk/attic/images-stones/st_rock_growing-gfx48.xcf
   trunk/data/gfx32/sh_floating.png
   trunk/data/gfx32/sh_glass.png
   trunk/data/gfx32/sh_jamb.png
   trunk/data/gfx32/sh_passage_frame.png
   trunk/data/gfx32/sh_pull.png
   trunk/data/gfx32/sh_puzzle_hollow.png
   trunk/data/gfx32/sh_round.png
   trunk/data/gfx32/sh_round2.png
   trunk/data/gfx32/sh_round_growing.png
   trunk/data/gfx32/sh_shogun_l.png
   trunk/data/gfx32/sh_shogun_m.png
   trunk/data/gfx32/sh_shogun_s.png
   trunk/data/gfx32/sh_solid.png
   trunk/data/gfx40/sh_floating.png
   trunk/data/gfx40/sh_glass.png
   trunk/data/gfx40/sh_jamb.png
   trunk/data/gfx40/sh_passage_frame.png
   trunk/data/gfx40/sh_pull.png
   trunk/data/gfx40/sh_puzzle_hollow.png
   trunk/data/gfx40/sh_round.png
   trunk/data/gfx40/sh_round2.png
   trunk/data/gfx40/sh_round_growing.png
   trunk/data/gfx40/sh_shogun_l.png
   trunk/data/gfx40/sh_shogun_m.png
   trunk/data/gfx40/sh_shogun_s.png
   trunk/data/gfx40/sh_solid.png
   trunk/data/gfx48/sh_floating.png
   trunk/data/gfx48/sh_glass.png
   trunk/data/gfx48/sh_jamb.png
   trunk/data/gfx48/sh_passage_frame.png
   trunk/data/gfx48/sh_pull.png
   trunk/data/gfx48/sh_puzzle_hollow.png
   trunk/data/gfx48/sh_round.png
   trunk/data/gfx48/sh_round2.png
   trunk/data/gfx48/sh_round_growing.png
   trunk/data/gfx48/sh_shogun_l.png
   trunk/data/gfx48/sh_shogun_m.png
   trunk/data/gfx48/sh_shogun_s.png
   trunk/data/gfx48/sh_solid.png
Removed:
   trunk/data/gfx32/sh-floating.png
   trunk/data/gfx32/sh-glass.png
   trunk/data/gfx32/sh-pull.png
   trunk/data/gfx32/sh-puzzle1.png
   trunk/data/gfx32/sh-round.png
   trunk/data/gfx32/sh-round2-growing.png
   trunk/data/gfx32/sh-round2.png
   trunk/data/gfx32/sh-shogun1.png
   trunk/data/gfx32/sh-shogun2.png
   trunk/data/gfx32/sh-shogun4.png
   trunk/data/gfx32/sh-solid.png
   trunk/data/gfx32/sh-white4.png
   trunk/data/gfx40/sh-floating.png
   trunk/data/gfx40/sh-glass.png
   trunk/data/gfx40/sh-pull.png
   trunk/data/gfx40/sh-puzzle1.png
   trunk/data/gfx40/sh-round.png
   trunk/data/gfx40/sh-round2-growing.png
   trunk/data/gfx40/sh-round2.png
   trunk/data/gfx40/sh-shogun1.png
   trunk/data/gfx40/sh-shogun2.png
   trunk/data/gfx40/sh-shogun4.png
   trunk/data/gfx40/sh-solid.png
   trunk/data/gfx40/sh-white4.png
   trunk/data/gfx48/sh-floating.png
   trunk/data/gfx48/sh-glass.png
   trunk/data/gfx48/sh-pull.png
   trunk/data/gfx48/sh-puzzle1.png
   trunk/data/gfx48/sh-round.png
   trunk/data/gfx48/sh-round2-growing.png
   trunk/data/gfx48/sh-round2.png
   trunk/data/gfx48/sh-shogun1.png
   trunk/data/gfx48/sh-shogun2.png
   trunk/data/gfx48/sh-shogun4.png
   trunk/data/gfx48/sh-solid.png
   trunk/data/gfx48/sh-white4.png
Modified:
   trunk/data/gfx32/sh_grate_cross.png
   trunk/data/gfx32/sh_grate_framed.png
   trunk/data/gfx40/sh_brake.png
   trunk/data/gfx40/sh_grate_cross.png
   trunk/data/gfx40/sh_grate_framed.png
   trunk/data/gfx40/sh_portal_horse.png
   trunk/data/gfx40/st-blocker.png
   trunk/data/gfx40/st_brake.png
   trunk/data/gfx48/sh_brake.png
   trunk/data/gfx48/sh_grate_cross.png
   trunk/data/gfx48/sh_grate_framed.png
   trunk/data/gfx48/sh_portal_horse.png
   trunk/data/models-2d.lua
   trunk/data/models.lua
Log:
-> Fixed shadow model for several rounded stones
-> New growing anims for seed_hay, seed_greenbrown, seed_volcano
-> New shogun and jamb shadows and many bugfixes for other shadows
-> Renaming of shadow images



Added: trunk/attic/images-stones/sh_round_growing_gfx32.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/sh_round_growing_gfx32.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/sh_round_growing_gfx40.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/sh_round_growing_gfx40.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/sh_round_growing_gfx48.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/sh_round_growing_gfx48.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_rock_growing-gfx32.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_rock_growing-gfx32.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_rock_growing-gfx40.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_rock_growing-gfx40.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-stones/st_rock_growing-gfx48.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-stones/st_rock_growing-gfx48.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Deleted: trunk/data/gfx32/sh-floating.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-glass.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-pull.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-puzzle1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-round.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-round2-growing.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-round2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-shogun1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-shogun2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-shogun4.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-solid.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-white4.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/sh_floating.png (from rev 1694, trunk/data/gfx32/sh-floating.png)

Copied: trunk/data/gfx32/sh_glass.png (from rev 1694, trunk/data/gfx32/sh-glass.png)
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/sh_grate_cross.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/sh_grate_framed.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx32/sh_jamb.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/sh_jamb.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx32/sh_passage_frame.png (from rev 1694, trunk/data/gfx32/sh-white4.png)

Copied: trunk/data/gfx32/sh_pull.png (from rev 1694, trunk/data/gfx32/sh-pull.png)

Copied: trunk/data/gfx32/sh_puzzle_hollow.png (from rev 1694, trunk/data/gfx32/sh-puzzle1.png)

Copied: trunk/data/gfx32/sh_round.png (from rev 1694, trunk/data/gfx32/sh-round.png)

Copied: trunk/data/gfx32/sh_round2.png (from rev 1694, trunk/data/gfx32/sh-round2.png)

Copied: trunk/data/gfx32/sh_round_growing.png (from rev 1694, trunk/data/gfx32/sh-round2-growing.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/sh_shogun_l.png (from rev 1694, trunk/data/gfx32/sh-shogun4.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/sh_shogun_m.png (from rev 1694, trunk/data/gfx32/sh-shogun2.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/sh_shogun_s.png (from rev 1694, trunk/data/gfx32/sh-shogun1.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/sh_solid.png (from rev 1694, trunk/data/gfx32/sh-solid.png)

Deleted: trunk/data/gfx40/sh-floating.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-glass.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-pull.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-puzzle1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-round.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-round2-growing.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-round2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-shogun1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-shogun2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-shogun4.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-solid.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-white4.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/sh_brake.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_floating.png (from rev 1694, trunk/data/gfx40/sh-floating.png)

Copied: trunk/data/gfx40/sh_glass.png (from rev 1694, trunk/data/gfx40/sh-glass.png)

Modified: trunk/data/gfx40/sh_grate_cross.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/sh_grate_framed.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx40/sh_jamb.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/sh_jamb.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx40/sh_passage_frame.png (from rev 1694, trunk/data/gfx40/sh-white4.png)

Modified: trunk/data/gfx40/sh_portal_horse.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_pull.png (from rev 1694, trunk/data/gfx40/sh-pull.png)

Copied: trunk/data/gfx40/sh_puzzle_hollow.png (from rev 1694, trunk/data/gfx40/sh-puzzle1.png)

Copied: trunk/data/gfx40/sh_round.png (from rev 1694, trunk/data/gfx40/sh-round.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_round2.png (from rev 1694, trunk/data/gfx40/sh-round2.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_round_growing.png (from rev 1694, trunk/data/gfx40/sh-round2-growing.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_shogun_l.png (from rev 1694, trunk/data/gfx40/sh-shogun4.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_shogun_m.png (from rev 1694, trunk/data/gfx40/sh-shogun2.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_shogun_s.png (from rev 1694, trunk/data/gfx40/sh-shogun1.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_solid.png (from rev 1694, trunk/data/gfx40/sh-solid.png)
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st-blocker.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st_brake.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-floating.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-glass.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-pull.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-puzzle1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-round.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-round2-growing.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-round2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-shogun1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-shogun2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-shogun4.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-solid.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-white4.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/sh_brake.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_floating.png (from rev 1694, trunk/data/gfx48/sh-floating.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_glass.png (from rev 1694, trunk/data/gfx48/sh-glass.png)

Modified: trunk/data/gfx48/sh_grate_cross.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/sh_grate_framed.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx48/sh_jamb.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/sh_jamb.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx48/sh_passage_frame.png (from rev 1694, trunk/data/gfx48/sh-white4.png)

Modified: trunk/data/gfx48/sh_portal_horse.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_pull.png (from rev 1694, trunk/data/gfx48/sh-pull.png)

Copied: trunk/data/gfx48/sh_puzzle_hollow.png (from rev 1694, trunk/data/gfx48/sh-puzzle1.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_round.png (from rev 1694, trunk/data/gfx48/sh-round.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_round2.png (from rev 1694, trunk/data/gfx48/sh-round2.png)
===================================================================
(Binary files differ)

Added: trunk/data/gfx48/sh_round_growing.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/sh_round_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx48/sh_shogun_l.png (from rev 1694, trunk/data/gfx48/sh-shogun4.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_shogun_m.png (from rev 1694, trunk/data/gfx48/sh-shogun2.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_shogun_s.png (from rev 1694, trunk/data/gfx48/sh-shogun1.png)
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_solid.png (from rev 1694, trunk/data/gfx48/sh-solid.png)
===================================================================
(Binary files differ)

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-30 11:18:14 UTC (rev 1695)
+++ trunk/data/models-2d.lua	2009-05-30 15:35:38 UTC (rev 1696)
@@ -648,7 +648,7 @@
 
     local frames = BuildFrames({"it_crack_abyss4", "it_crack_abyss5", "it_crack_abyss6", "it_crack_abyss7", "it_crack_abyss8"},120)
     DefAnim("it_crack_abyss_anim", frames)
-    
+
     local images = DefSubimages("it_crack_water", {h=8})
     local frames = BuildFrames(images,50)
     DefAnim("it_debris_water", frames)
@@ -758,20 +758,21 @@
 -- Stone shadows --
 -------------------
 do
-    DefImage("sh-solid")
-    DefImage("sh-round")
-    DefImage("sh-round2")
+    DefImage("sh_solid")
+    DefImage("sh_round")
+    DefImage("sh_round2")
     DefImage("sh_grate_cross")
     DefImage("sh_grate_framed")
     DefImage("sh_portal_horse")
-    DefImage("sh-glass")
+    DefImage("sh_glass")
     DefImage("sh_rawglass_quad")
-    DefImage("sh-white4")
+    DefImage("sh_passage_frame")
     DefImage("sh_passage_slash")
     DefImage("sh_passage_cross")
-    DefImage("sh-puzzle1")
+    DefImage("sh_puzzle_hollow")
     DefImage("sh_brake")
-    DefImage("sh-floating")
+    DefImage("sh_floating")
+    DefImage("sh_jamb")
     -- Note: Window shadows are defined where needed.
 end
 
@@ -779,40 +780,40 @@
 -- simple stones --
 -------------------
 do
-    DefStone("st_beads", "sh-glass")
-    DefStone("st-black1", "sh-round")
+    DefStone("st_beads", "sh_glass")
+    DefStone("st-black1", "sh_round")
     DefStone("st-black2", "sh_passage_slash")
     DefStone("st-black3", "sh_passage_cross")
-    DefStone("st-black4", "sh-white4")
-    DefStone("st_jamb_black")
+    DefStone("st-black4", "sh_passage_frame")
+    DefStone("st_jamb_black", "sh_jamb")
     DefStone("st_plop_slate")
-    DefStone("st_bluegray", "sh-round")
+    DefStone("st_bluegray", "sh_round")
     DefStone("st_brake", "sh_brake")
-    DefStone("st_brownie", "sh-round")
+    DefStone("st_brownie", "sh_round")
     DefStone("st-bug")
     DefStone("st_pinkbumps")
     DefStone("st_camouflage")
     DefStone("st_dummy")
     DefImage("st-easymode")
     DefStone("st_flat_fire")
-    DefStone("st-floppy0", "sh-round", {filename="st-floppy1"})
-    DefStone("st-floppy1", "sh-round", {filename="st-floppy2"})
-    DefStone("st-flrock", "sh-round")
-    DefStone("st_rawglass", "sh-glass")
+    DefStone("st-floppy0", "sh_round", {filename="st-floppy1"})
+    DefStone("st-floppy1", "sh_round", {filename="st-floppy2"})
+    DefStone("st-flrock", "sh_round")
+    DefStone("st_rawglass", "sh_glass")
     DefStone("st_rawglass_quad", "sh_rawglass_quad")
-    DefStone("st_lightglass", "sh-glass")
-    DefStone("st_darkglass", "sh-glass")
-    DefStone("st_redfiber", "sh-glass")
+    DefStone("st_lightglass", "sh_glass")
+    DefStone("st_darkglass", "sh_glass")
+    DefStone("st_redfiber", "sh_glass")
     DefStone("st_grate_cross", "sh_grate_cross")
     DefStone("st_grate_framed", "sh_grate_framed")
     DefStone("st_portal_horse", "sh_portal_horse")
-    DefStone("st_greenbrown", "sh-round")
-    DefStone("st-key0", "sh-round", {filename="st-key1"})
-    DefStone("st-key1", "sh-round", {filename="st-key2"})
-    DefStone("st_redbrown", "sh-round")
+    DefStone("st_greenbrown", "sh_round")
+    DefStone("st-key0", "sh_round", {filename="st-key1"})
+    DefStone("st-key1", "sh_round", {filename="st-key2"})
+    DefStone("st_redbrown", "sh_round")
     DefStone("st_metal")
     DefStone("st_redrock")
-    DefStone("st_granite", "sh-round")
+    DefStone("st_granite", "sh_round")
     DefStone("st_darkgray")
     DefStone("st_plaster")
     DefStone("st_flat")
@@ -821,23 +822,23 @@
     DefStone("st_tigris")
     DefStone("st_purplegray")
     DefStone("st_greengray")
-    DefStone("st_concrete", "sh-round")
-    DefStone("st_ancient", "sh-round")
+    DefStone("st_concrete", "sh_round")
+    DefStone("st_ancient", "sh_round")
     DefStone("st_brownmarble")
     DefStone("st-rubberband")
     DefStone("st_brownpyramide")
     DefStone("st_redmarble")
-    DefStone("st_surprise")
-    DefStone("st-white1", "sh-round")
+    DefStone("st_surprise", "sh_round")
+    DefStone("st-white1", "sh_round")
     DefStone("st-white2", "sh_passage_slash")
     DefStone("st-white3", "sh_passage_cross")
-    DefStone("st-white4", "sh-white4")
-    DefStone("st_jamb_white")
+    DefStone("st-white4", "sh_passage_frame")
+    DefStone("st_jamb_white", "sh_jamb")
     DefStone("st_woven")
     DefStone("st_yellow")
-    DefStone("st_blur_straight")
-    DefStone("st_blur_cross")
-    DefStone("st_yinyang_inactive", "sh-round")
+    DefStone("st_blur_straight", "sh_round")
+    DefStone("st_blur_cross", "sh_round")
+    DefStone("st_yinyang_inactive", "sh_round")
 end
 
 ---------------------
@@ -910,7 +911,7 @@
         local animname="st-bolder"..orient.."a"
         local frames={img[start], img[start+1], img[start+2]}
         DefAnim(animname, BuildFrames(frames, 120), false)
-        DefShModel("st-bolder-"..orient, animname, "sh-round")
+        DefShModel("st-bolder-"..orient, animname, "sh_round")
 
         animname="st-bolder-"..orient.."-fall-anim"
         frames={imgfall[start],imgfall[start+1],imgfall[start+2]}
@@ -1013,31 +1014,31 @@
 -- st-fourswitch --
 do
     DefSubimages("st-fourswitch",{h=4})
-    DefShModel("st-fourswitch-n", "st-fourswitch1", "sh-round")
-    DefShModel("st-fourswitch-e", "st-fourswitch2", "sh-round")
-    DefShModel("st-fourswitch-s", "st-fourswitch3", "sh-round")
-    DefShModel("st-fourswitch-w", "st-fourswitch4", "sh-round")
+    DefShModel("st-fourswitch-n", "st-fourswitch1", "sh_round")
+    DefShModel("st-fourswitch-e", "st-fourswitch2", "sh_round")
+    DefShModel("st-fourswitch-s", "st-fourswitch3", "sh_round")
+    DefShModel("st-fourswitch-w", "st-fourswitch4", "sh_round")
 end
 
 -- st_ice --
 do
-    DefStone("st_ice", "sh-glass")
+    DefStone("st_ice", "sh_glass")
 
     local images = DefSubimages("st_ice_break", {h=5})
     local frames = BuildFrames(images,50)
     DefAnim("st_ice_break-anim", frames)
-    DefShModel("st_ice_breaking", "st_ice_break-anim", "sh-glass")
+    DefShModel("st_ice_breaking", "st_ice_break-anim", "sh_glass")
 
     local frames = BuildFrames(images,100)
     DefAnim("st_ice_melt-anim", frames)
-    DefShModel("st_ice_melting", "st_ice_melt-anim", "sh-glass")
+    DefShModel("st_ice_melting", "st_ice_melt-anim", "sh_glass")
 end
 
 -- st-knight --
 do
     local images = DefSubimages("st-knight", {modelname="knight", h=5})
     for i=1, table.getn(images) do
-        DefSolidStone("st-knight"..i, images[i])
+        DefShModel("st-knight"..i, images[i], "sh_round")
     end
 end
 
@@ -1069,23 +1070,22 @@
 
 -- laserswitch --
 do
-    DefStone("st-laserswitch0", nil, {filename="st_oxydb"})
-    DefAnimImages("laserswitch-blink",
-        RepeatAnim(PingPong(BuildFrames(FrameNames("st_fakeoxyd_blink", 1,4),50))), {loop=1})
-    DefSolidStone("st-laserswitch1", "laserswitch-blink")
+    DefStone("st-laserswitch0", "sh_round", {filename="st_oxydb"})
+    DefAnimImages("laserswitch-blink", RepeatAnim(PingPong(BuildFrames(FrameNames("st_fakeoxyd_blink", 1,4),50))), {loop=1})
+    DefShModel("st-laserswitch1", "laserswitch-blink", "sh_round")
 end
 
 -- st-lightpassenger --
 do
     local img = DefSubimages("st-lightpassenger", {h=7})
-    DefShModel("st-lightpassenger", img[1], "sh-glass")
+    DefShModel("st-lightpassenger", img[1], "sh_glass")
     DefImage("st-lightpassenger_offx", {filename = "st-lightpassenger_off"})
-    DefShModel("st-lightpassenger_off", "st-lightpassenger_offx", "sh-glass")
+    DefShModel("st-lightpassenger_off", "st-lightpassenger_offx", "sh_glass")
     DefAlias("st-lightpassenger_hidden", "st_darkglass")
     -- Blink animation
     local frames = {img[2], img[3], img[4], img[5], img[6], img[7]}
     DefAnim("st-lightpassenger-blink1", PingPong(BuildFrames(frames, 75)), true)
-    DefShModel("st-lightpassenger-blink", "st-lightpassenger-blink1", "sh-glass")
+    DefShModel("st-lightpassenger-blink", "st-lightpassenger-blink1", "sh_glass")
     -- Break animation
     img = DefSubimages("st-lightpassenger-break", {h=7})
     local anim_v, anim_h, anim_hv = {}, {}, {}
@@ -1137,19 +1137,19 @@
 do
    DefSubimages("st-pull",{modelname="st-pull-fg",h=5})
    DefSubimages("st-swap",{modelname="st-swap-fg",h=5})
-   DefSubimages("sh-pull",{h=4,imgw=ShadowSize,imgh=ShadowSize})
+   DefSubimages("sh_pull",{h=4, imgw=ShadowSize, imgh=ShadowSize})
 
-   DefShModel("st-pull",   "st-pull-fg1", "sh-glass")
-   DefShModel("st-pull-n", "st-pull-fg2", "sh-pull1")
-   DefShModel("st-pull-s", "st-pull-fg3", "sh-pull2")
-   DefShModel("st-pull-e", "st-pull-fg4", "sh-pull3")
-   DefShModel("st-pull-w", "st-pull-fg5", "sh-pull4")
+   DefShModel("st-pull",   "st-pull-fg1", "sh_glass")
+   DefShModel("st-pull-n", "st-pull-fg2", "sh_pull1")
+   DefShModel("st-pull-s", "st-pull-fg3", "sh_pull2")
+   DefShModel("st-pull-e", "st-pull-fg4", "sh_pull3")
+   DefShModel("st-pull-w", "st-pull-fg5", "sh_pull4")
 
-   DefShModel("st-swap",   "st-swap-fg1", "sh-round")
-   DefShModel("st-swap-n", "st-swap-fg2", "sh-pull1")
-   DefShModel("st-swap-s", "st-swap-fg3", "sh-pull2")
-   DefShModel("st-swap-e", "st-swap-fg4", "sh-pull3")
-   DefShModel("st-swap-w", "st-swap-fg5", "sh-pull4")
+   DefShModel("st-swap",   "st-swap-fg1", "sh_round")
+   DefShModel("st-swap-n", "st-swap-fg2", "sh_pull1")
+   DefShModel("st-swap-s", "st-swap-fg3", "sh_pull2")
+   DefShModel("st-swap-e", "st-swap-fg4", "sh_pull3")
+   DefShModel("st-swap-w", "st-swap-fg5", "sh_pull4")
 end
 
 -- st-puzzle* --
@@ -1158,7 +1158,7 @@
     -- Full puzzels
     for i=0,31  do DefSolidStone("st_puzzle"..i, "st_puzzlex"..i) end
     -- Hollow puzzels
-    for i=32,63  do DefShModel("st_puzzle"..i, "st_puzzlex"..i, "sh-puzzle1") end
+    for i=32,63  do DefShModel("st_puzzle"..i, "st_puzzlex"..i, "sh_puzzle_hollow") end
 end
 
 -- st_flat-break --
@@ -1187,24 +1187,25 @@
 
 -- st-scissors --
 do
-    DefStone("st-scissors")
+    DefStone("st-scissors", "sh_round")
+
     local images = DefSubimages("st-scissors-snip", {h=1})
     DefAnim("st-scissors-snip-anim", BuildFrames(images, 130))
-    DefSolidStone("st-scissors-snip", "st-scissors-snip-anim")
+    DefShModel("st-scissors-snip", "st-scissors-snip-anim", "sh_round")
 end
 
 -- st-shogun* --
 do
-    DefImages{"sh-shogun1","sh-shogun2", "sh-shogun4"}
+    DefImages{"sh_shogun_s","sh_shogun_m", "sh_shogun_l"}
     DefSubimages("st-shogun", {modelname="st-shogun-fg",h=7})
 
-    DefShModel("st-shogun1", "st-shogun-fg1", "sh-shogun1")
-    DefShModel("st-shogun2", "st-shogun-fg2", "sh-shogun2")
-    DefShModel("st-shogun3", "st-shogun-fg3", "sh-shogun1")
-    DefShModel("st-shogun4", "st-shogun-fg4", "sh-shogun4")
-    DefShModel("st-shogun5", "st-shogun-fg5", "sh-shogun1")
-    DefShModel("st-shogun6", "st-shogun-fg6", "sh-shogun2")
-    DefShModel("st-shogun7", "st-shogun-fg7", "sh-shogun1")
+    DefShModel("st-shogun1", "st-shogun-fg1", "sh_shogun_s")
+    DefShModel("st-shogun2", "st-shogun-fg2", "sh_shogun_m")
+    DefShModel("st-shogun3", "st-shogun-fg3", "sh_shogun_s")
+    DefShModel("st-shogun4", "st-shogun-fg4", "sh_shogun_l")
+    DefShModel("st-shogun5", "st-shogun-fg5", "sh_shogun_s")
+    DefShModel("st-shogun6", "st-shogun-fg6", "sh_shogun_m")
+    DefShModel("st-shogun7", "st-shogun-fg7", "sh_shogun_s")
 end
 
 -- st-stoneimpulse --
@@ -1228,14 +1229,14 @@
 -- st-stoneimpulse-hollow --
 do
    local images = DefSubimages("st-stoneimpulse-hollow", {h=4})
-   DefShModel("st-stoneimpulse-hollow", images[1], "sh-floating")
+   DefShModel("st-stoneimpulse-hollow", images[1], "sh_floating")
    local frames = {}
    for i=1,4 do table.insert(frames, images[i]) end
    DefAnim("stoneimpulse-hollow-anim1", BuildFrames(frames, 55))
-   DefShModel("st-stoneimpulse-hollow-anim1", "stoneimpulse-hollow-anim1", "sh-floating")
+   DefShModel("st-stoneimpulse-hollow-anim1", "stoneimpulse-hollow-anim1", "sh_floating")
    table.insert(frames, images[4]) -- add 1 frame to make closing anim longer!
    DefAnim("stoneimpulse-hollow-anim2", ReverseFrames(BuildFrames(frames, 55)))
-   DefShModel("st-stoneimpulse-hollow-anim2", "stoneimpulse-hollow-anim2", "sh-floating")
+   DefShModel("st-stoneimpulse-hollow-anim2", "stoneimpulse-hollow-anim2", "sh_floating")
 end
 
 do
@@ -1270,10 +1271,11 @@
 
 -- st-timeswitch --
 do
-    DefStone("st-timeswitch")
+    DefStone("st-timeswitch", "sh_round")
+
     local images = DefSubimages("st-time1switch", {h=2})
     DefAnim("st-time1switch-anim", BuildFrames (images, 180), 1)
-    DefSolidStone("st-time1switch", "st-time1switch-anim")
+    DefShModel("st-time1switch", "st-time1switch-anim", "sh_round")
 end
 
 -- st-turnstile --
@@ -1300,13 +1302,13 @@
 
 -- growing stones, st_box, st_flhay, greenbrown seed, st-volcano, st-blocker --
 do
-   local shadows=DefSubimages("sh-round2-growing", {h=3,imgw=ShadowSize,imgh=ShadowSize})
+   local shadows=DefSubimages("sh_round_growing", {h=3,imgw=ShadowSize,imgh=ShadowSize})
 
    -- Wooden (box) stones --
    do
       DefSubimages("st-wood", {modelname="st-wood-fg",h=2})
-      DefShModel("st-wood1", "st-wood-fg1", "sh-round")
-      DefShModel("st-wood2", "st-wood-fg2", "sh-round")
+      DefShModel("st-wood1", "st-wood-fg1", "sh_round")
+      DefShModel("st-wood2", "st-wood-fg2", "sh_round")
 
       local images=DefSubimages("st_wood_growing", {h=3})
       DefAnim("wood-growing-fg", BuildFrames(images, 130))
@@ -1324,7 +1326,7 @@
 
    -- st_flhay, hay seed growing --
    do
-      DefStone("st-flhay", "sh-round")
+      DefStone("st-flhay", "sh_round")
 
       local images=DefSubimages("st_flhay_growing", {h=3})
       DefAnim("hay-growing-fg", BuildFrames(images, 130))
@@ -1343,7 +1345,7 @@
    -- Blocker stone --
    do
       local n=DefSubimages("st-blocker", {h=4})
-      DefRoundStone("st-blocker", n[1])
+      DefShModel("st-blocker", n[1], "sh_round")
       frames={}
       for i=4,2,-1 do
          table.insert(frames, "st-blocker"..i)
@@ -1492,10 +1494,10 @@
         d="st_oxydd_open",
     }
     local shadow = {
-       a="sh-round",
-       b="sh-round",
-       c="sh-solid",
-       d="sh-solid",
+       a="sh_round",
+       b="sh_round",
+       c="sh_solid",
+       d="sh_solid",
     }
     local fopening = {
         a = BuildFrames(DefSubimages("st_oxyda_opening", {h=9}), 60),
@@ -1608,7 +1610,7 @@
     -- flavors 'e'
     for color = 0, num_colors - 1 do
         DefOverlay("st_oxyde"..color.."_peep", {"st_oxydb_open", colorspots[color+1], "st_oxyde"})
-        DefShModel("st_oxyde"..color, "st_oxyde"..color.."_peep", "sh-round")
+        DefShModel("st_oxyde"..color, "st_oxyde"..color.."_peep", "sh_round")
         DefAlias("st_oxyde"..color.."_opening", "st_oxydb"..color.."_opening")
         DefAlias("st_oxyde"..color.."_closing", "st_oxydb"..color.."_closing")
         DefAlias("st_oxyde"..color.."_blink", "st_oxydb"..color.."_blink")
@@ -1621,12 +1623,12 @@
     DefAlias("st_oxyde_pseudo-3", "st_oxydb_pseudo-3")
     DefAlias("st_oxyde-3_closing", "st_oxydb-3_closing")
     DefOverlay("st_oxyde-3_peep", {"st_oxydb_open", colorspots[97], "st_oxyde"})
-    DefShModel("st_oxyde-3", "st_oxyde-3_peep", "sh-round")
+    DefShModel("st_oxyde-3", "st_oxyde-3_peep", "sh_round")
     DefAlias("st_oxyde-4_opening", "st_oxydb-4_opening")
     DefAlias("st_oxyde_pseudo-4", "st_oxydb_pseudo-4")
     DefAlias("st_oxyde-4_closing", "st_oxydb-4_closing")
     DefOverlay("st_oxyde-4_peep", {"st_oxydb_open", colorspots[96], "st_oxyde"})
-    DefShModel("st_oxyde-4", "st_oxyde-4_peep", "sh-round")
+    DefShModel("st_oxyde-4", "st_oxyde-4_peep", "sh_round")
 end
 
 -- st-coffee --
@@ -1696,7 +1698,7 @@
 
 -- st_quake --
 do
-    DefStone("st_quake", "sh-round", {filename="st_oxydb"})
+    DefStone("st_quake", "sh_round", {filename="st_oxydb"})
     DefAnimImages("quaking",
         RepeatAnim(PingPong(BuildFrames(FrameNames("st_fakeoxyd_blink", 1,4),50))))
     DefRoundStone("st_quaking", "quaking")
@@ -1711,24 +1713,24 @@
      local images = DefSubimages("st_spitter_idle", {h=6})
      local frames = BuildFrames(images,150)
      DefAnim("st_spitter_active", frames, true)
-     DefShModel("st_spitter_active", "st_spitter_active", "sh-round")
-     DefShModel("st_spitter_idle", "st_spitter_idle1",  "sh-round")
+     DefShModel("st_spitter_active", "st_spitter_active", "sh_round")
+     DefShModel("st_spitter_idle", "st_spitter_idle1",  "sh_round")
 
      local images = DefSubimages("st_spitter_spitting", {h=6})
      local frames = BuildFrames(images,175)
      DefAnim("st_spitter_spitting", frames)
-     DefShModel("st_spitter_spitting", "st_spitter_spitting", "sh-round")
+     DefShModel("st_spitter_spitting", "st_spitter_spitting", "sh_round")
 
      local images = DefSubimages("st_spitter_loading", {h=6})
      local frames = BuildFrames(images,100)
      frames[6][2] = 50
      DefAnim("st_spitter_loading", frames)
-     DefShModel("st_spitter_loading", "st_spitter_loading", "sh-round")
+     DefShModel("st_spitter_loading", "st_spitter_loading", "sh_round")
 
      local images = DefSubimages("st_spitter_breaking", {h=6})
      local frames = BuildFrames(images,100)
      DefAnim("st_spitter_breaking", frames)
-     DefShModel("st_spitter_breaking", "st_spitter_breaking", "sh-round")
+     DefShModel("st_spitter_breaking", "st_spitter_breaking", "sh_round")
 
 end
 
@@ -1764,7 +1766,7 @@
         names[j] = "st_thief_drunken"..format("%04d", j)
         display.DefineComposite(names[j], stonebase, drunkenovl[j])
     end
-    
+
     local f5 = BuildFrames(names, 3000)
     DefAnim("pre_st_thief_drunken", f5, true)
     DefRoundStone("st_thief_drunken", "pre_st_thief_drunken")
@@ -1834,7 +1836,7 @@
         for i=1,4 do
                 mname = basename .. i
                 DefOverlay (mname .. "-ovl", {baseimg, overlays[i]})
-                DefShModel(mname, mname .. "-ovl", "sh-round2")
+                DefShModel(mname, mname .. "-ovl", "sh_round2")
         end
     end
 

Modified: trunk/data/models.lua
===================================================================
--- trunk/data/models.lua	2009-05-30 11:18:14 UTC (rev 1695)
+++ trunk/data/models.lua	2009-05-30 15:35:38 UTC (rev 1696)
@@ -345,7 +345,7 @@
 -- Define a stone together with its shadow model:
 function DefStone(name, shmodel, opt)
     opt = opt or {}
-    shmodel = shmodel or "sh-solid"
+    shmodel = shmodel or "sh_solid"
     opt.filename = opt.filename or name
     display.DefineShadedModel(name, DefImage(nil, opt), shmodel)
 end
@@ -358,15 +358,15 @@
 end
 
 function DefSolidStone(name, front)
-    DefShModel(name, front, "sh-solid")
+    DefShModel(name, front, "sh_solid")
 end
 
 function DefRoundStone(name, front)
-    DefShModel(name, front, "sh-round")
+    DefShModel(name, front, "sh_round")
 end
 
 function DefFloatingStone(name, front)
-    DefShModel(name, front, "sh-floating")
+    DefShModel(name, front, "sh_floating")
 end
 
 -- Animated Stones --



From andreasl at mail.berlios.de  Sat May 30 21:44:02 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Sat, 30 May 2009 21:44:02 +0200
Subject: [Enigma-game-svn] r1697 - in trunk/data: . gfx16 gfx32 gfx40 gfx48
	gfx64
Message-ID: <200905301944.n4UJi2Qm022909@sheep.berlios.de>

Author: andreasl
Date: 2009-05-30 21:43:51 +0200 (Sat, 30 May 2009)
New Revision: 1697

Added:
   trunk/data/gfx16/st_ice_melting.png
   trunk/data/gfx32/st_ice_melting.png
   trunk/data/gfx40/st_ice_melting.png
   trunk/data/gfx48/st_ice_melting.png
   trunk/data/gfx64/st_ice_melting.png
Modified:
   trunk/data/models-2d.lua
Log:
Trunk:
 - Add melting animation or st_ice (2 seconds length).


Added: trunk/data/gfx16/st_ice_melting.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx16/st_ice_melting.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx32/st_ice_melting.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_ice_melting.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx40/st_ice_melting.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_ice_melting.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx48/st_ice_melting.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_ice_melting.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/data/gfx64/st_ice_melting.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx64/st_ice_melting.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-30 15:35:38 UTC (rev 1696)
+++ trunk/data/models-2d.lua	2009-05-30 19:43:51 UTC (rev 1697)
@@ -1029,7 +1029,8 @@
     DefAnim("st_ice_break-anim", frames)
     DefShModel("st_ice_breaking", "st_ice_break-anim", "sh_glass")
 
-    local frames = BuildFrames(images,100)
+    images = DefSubimages("st_ice_melting", {h=10})
+    frames = BuildFrames(images,200)
     DefAnim("st_ice_melt-anim", frames)
     DefShModel("st_ice_melting", "st_ice_melt-anim", "sh_glass")
 end



From raoul at mail.berlios.de  Sat May 30 21:53:41 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 30 May 2009 21:53:41 +0200
Subject: [Enigma-game-svn] r1698 - trunk/data
Message-ID: <200905301953.n4UJrfcm023926@sheep.berlios.de>

Author: raoul
Date: 2009-05-30 21:53:41 +0200 (Sat, 30 May 2009)
New Revision: 1698

Modified:
   trunk/data/models-2d.lua
Log:
-> Fix explosion for puzzle stones



Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-05-30 19:43:51 UTC (rev 1697)
+++ trunk/data/models-2d.lua	2009-05-30 19:53:41 UTC (rev 1698)
@@ -1866,7 +1866,7 @@
 do
     DefAlias("st_break_bug", "st-bug")
     DefAlias("st_break_bug-anim", "st_flat_breaking")
-    DefAlias("st-explosion", "expl")
+    DefAlias("st-explosion", "it_explosion")
     DefAlias("st-glass_move", "st-glass");
     DefAlias("st_break_laser", "st_flat")
     DefAlias("st_break_laser-anim", "st_flat_breaking")



From raoul at mail.berlios.de  Sun May 31 20:21:46 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sun, 31 May 2009 20:21:46 +0200
Subject: [Enigma-game-svn] r1699 - team_levelpacks/team_test_physics
Message-ID: <200905311821.n4VILkD2004812@sheep.berlios.de>

Author: raoul
Date: 2009-05-31 20:21:46 +0200 (Sun, 31 May 2009)
New Revision: 1699

Modified:
   team_levelpacks/team_test_physics/physics_test02.xml
   team_levelpacks/team_test_physics/physics_test07.xml
Log:
-> Physics testlevel bugfixes


Modified: team_levelpacks/team_test_physics/physics_test02.xml
===================================================================
--- team_levelpacks/team_test_physics/physics_test02.xml	2009-05-30 19:53:41 UTC (rev 1698)
+++ team_levelpacks/team_test_physics/physics_test02.xml	2009-05-31 18:21:46 UTC (rev 1699)
@@ -44,7 +44,7 @@
     " #    v v v                 v v v      #",
     " #    - - -                 - - -      #",
     " #> - - - - - <         > - - - - - <  #",
-    " X> - - - - - <         > - - - - - <. X",
+    " X>.- - - - - <         > - - - - - <. X",
     " #> - - - - - <         > - - - - - <  #",
     " #    - - -                 - - -      #",
     " #    ^ ^.^                 ^ ^.^      #",

Modified: team_levelpacks/team_test_physics/physics_test07.xml
===================================================================
--- team_levelpacks/team_test_physics/physics_test07.xml	2009-05-30 19:53:41 UTC (rev 1698)
+++ team_levelpacks/team_test_physics/physics_test07.xml	2009-05-31 18:21:46 UTC (rev 1699)
@@ -44,15 +44,15 @@
     " #      ^.                    v.       #",
     " # #   # #                    v.       #",
     " #v.  v.                      v.       #",
-    " #v.  v.             #  >.>.>.- <.<.<. #",
+    " #v.  v.               #>.>.>.- <.<.<. #",
     " #v.  v.                      ^.       #",
     " #v.  v.                      ^.       #",
     " #v.  v.                      ^.       #",
     " #v.  ^.                       #       #",
     " #v.  ^.                               #",
-    " #v.  ^.       #  >.>.>.>.>.<.<.<.<.<. #",
+    " #v.  ^.         #>.>.>.>.>.<.<.<.<.<. #",
     " #v.  ^.                               #",
-    " #v.  ^.       #  >.>.>.>.>.>.>.>.>.>. #",
+    " #v.  ^.         #>.>.>.>.>.>.>.>.>.>. #",
     " # # # # # # # # # # # # # # # # # # # #"})
  ]]></el:luamain>
     <el:i18n>



