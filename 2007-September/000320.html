<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r888 - in trunk/data/levels: enigma_experimental	lib
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2007-September/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r888%20-%20in%20trunk/data/levels%3A%20enigma_experimental%0A%09lib&In-Reply-To=%3C200709252320.l8PNK9f1020868%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000319.html">
   <LINK REL="Next"  HREF="000321.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r888 - in trunk/data/levels: enigma_experimental	lib</H1>
    <B>andreasl at BerliOS</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r888%20-%20in%20trunk/data/levels%3A%20enigma_experimental%0A%09lib&In-Reply-To=%3C200709252320.l8PNK9f1020868%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r888 - in trunk/data/levels: enigma_experimental	lib">andreasl at mail.berlios.de
       </A><BR>
    <I>Wed Sep 26 01:20:09 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000319.html">[Enigma-game-svn] r887 - in homepage: . images/lotm input input/lotm
</A></li>
        <LI>Next message: <A HREF="000321.html">[Enigma-game-svn] r889 - in trunk: lib-src/enigma-core src src/lev
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#320">[ date ]</a>
              <a href="thread.html#320">[ thread ]</a>
              <a href="subject.html#320">[ subject ]</a>
              <a href="author.html#320">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: andreasl
Date: 2007-09-26 01:20:08 +0200 (Wed, 26 Sep 2007)
New Revision: 888

Added:
   trunk/data/levels/enigma_experimental/test_libsoko.xml
Modified:
   trunk/data/levels/enigma_experimental/index.xml
   trunk/data/levels/lib/libsoko.xml
Log:
Sokoban:
 - 75 new designs (150 in total)
 - implemented &quot;white&quot;-attribute (libsoko)
 - (hopefully) fixed line matching to recognise empty lines
 - new function &quot;recreate_sokoball&quot; for developmental purposes
 - typos in libsoko
 - added test/demo-level &quot;test_libsoko&quot;:
     The two switches at the top change the design number,
     the left decreases the right increases. Currently, only
     new designs are shown. It also demonstrates the use of
     multilevels and chessobans.   


Modified: trunk/data/levels/enigma_experimental/index.xml
===================================================================
--- trunk/data/levels/enigma_experimental/index.xml	2007-09-24 21:31:04 UTC (rev 887)
+++ trunk/data/levels/enigma_experimental/index.xml	2007-09-25 23:20:08 UTC (rev 888)
@@ -17,10 +17,11 @@
     &lt;level _seq=&quot;9&quot; _title=&quot;Glassstones&quot; _xpath=&quot;./glassstones_1&quot; author=&quot;Raoul Bourquin&quot; ctrl=&quot;force&quot; easy=&quot;false&quot; id=&quot;glassstones_testlevel&quot; rel=&quot;1&quot; rev=&quot;4&quot; score=&quot;1&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
     &lt;level _seq=&quot;10&quot; _title=&quot;Impulstest&quot; _xpath=&quot;./testimpulses&quot; author=&quot;Enigma Team&quot; ctrl=&quot;force&quot; easy=&quot;false&quot; id=&quot;testimpulses&quot; rel=&quot;1&quot; rev=&quot;0&quot; score=&quot;1&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
     &lt;level _seq=&quot;11&quot; _title=&quot;Wolf Among Sheep&quot; _xpath=&quot;./wolfamongsheep&quot; author=&quot;illmind&quot; ctrl=&quot;force&quot; easy=&quot;false&quot; id=&quot;wolfamongsheep&quot; rel=&quot;1&quot; rev=&quot;0&quot; score=&quot;1&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
-    &lt;level _seq=&quot;12&quot; _title=&quot;Puzzle Labor&quot; _xpath=&quot;./puzzle_testarea_1&quot; author=&quot;Raoul Bourquin&quot; ctrl=&quot;force&quot; easy=&quot;false&quot; id=&quot;puzzle_testarea&quot; rel=&quot;1&quot; rev=&quot;1&quot; score=&quot;1&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
-    &lt;level _seq=&quot;13&quot; _title=&quot;Puzzle Demo&quot; _xpath=&quot;./puzzle_demo_2&quot; author=&quot;Raoul Bourquin&quot; ctrl=&quot;force&quot; easy=&quot;false&quot; id=&quot;puzzle_demo&quot; rel=&quot;2&quot; rev=&quot;2&quot; score=&quot;2&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
+    &lt;level _seq=&quot;12&quot; _title=&quot;Puzzle Labor&quot; _xpath=&quot;./puzzle_testarea_1&quot; author=&quot;Raoul Bourquin&quot; ctrl=&quot;force&quot; easy=&quot;false&quot; id=&quot;puzzle_testarea&quot; rel=&quot;1&quot; rev=&quot;2&quot; score=&quot;1&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
+    &lt;level _seq=&quot;13&quot; _title=&quot;Puzzle Demo&quot; _xpath=&quot;./puzzle_demo_2&quot; author=&quot;Raoul Bourquin&quot; ctrl=&quot;force&quot; easy=&quot;false&quot; id=&quot;puzzle_demo&quot; rel=&quot;2&quot; rev=&quot;3&quot; score=&quot;2&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
     &lt;level _seq=&quot;14&quot; _title=&quot;Flood Demo&quot; _xpath=&quot;./flood_demo_1&quot; author=&quot;Raoul Bourquin&quot; ctrl=&quot;force&quot; easy=&quot;false&quot; id=&quot;flood_demo&quot; rel=&quot;1&quot; rev=&quot;0&quot; score=&quot;1&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
     &lt;level _seq=&quot;15&quot; _title=&quot;Impossible?&quot; _xpath=&quot;./wb2&quot; author=&quot;Jon 'WB' Sneyers&quot; ctrl=&quot;force&quot; easy=&quot;false&quot; id=&quot;wb2_exp&quot; rel=&quot;1&quot; rev=&quot;0&quot; score=&quot;1&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
+    &lt;level _seq=&quot;16&quot; _title=&quot;Libsoko - Test&quot; _xpath=&quot;./test_libsoko&quot; author=&quot;Andreas Lochmann&quot; ctrl=&quot;force&quot; easy=&quot;true&quot; id=&quot;test_libsoko&quot; rel=&quot;1&quot; rev=&quot;0&quot; score=&quot;1&quot; target=&quot;time&quot; unit=&quot;duration&quot;/&gt;
   &lt;/levels&gt;
 
 &lt;/index&gt;

Added: trunk/data/levels/enigma_experimental/test_libsoko.xml
===================================================================
--- trunk/data/levels/enigma_experimental/test_libsoko.xml	2007-09-24 21:31:04 UTC (rev 887)
+++ trunk/data/levels/enigma_experimental/test_libsoko.xml	2007-09-25 23:20:08 UTC (rev 888)
@@ -0,0 +1,350 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot; ?&gt;
+&lt;el:level xmlns:xsi=&quot;<A HREF="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</A>&quot; xsi:schemaLocation=&quot;<A HREF="http://enigma-game.org/schema/level/1">http://enigma-game.org/schema/level/1</A> level.xsd&quot; xmlns:el=&quot;<A HREF="http://enigma-game.org/schema/level/1">http://enigma-game.org/schema/level/1</A>&quot;&gt;
+  &lt;el:protected&gt;
+    &lt;el:info el:type=&quot;level&quot;&gt;
+      &lt;el:identity el:title=&quot;Libsoko - Test&quot; el:subtitle=&quot;&quot; el:id=&quot;test_libsoko&quot;/&gt;
+      &lt;el:version el:score=&quot;1&quot; el:release=&quot;1&quot; el:revision=&quot;0&quot; el:status=&quot;experimental&quot;/&gt;
+      &lt;el:author el:name=&quot;Andreas Lochmann&quot; el:email=&quot;&quot; el:homepage=&quot;&quot;/&gt;
+      &lt;el:copyright&gt;Copyright &#169; 2007 Andreas Lochmann&lt;/el:copyright&gt;
+      &lt;el:license el:type=&quot;GPL v2.0 or above&quot; el:open=&quot;true&quot;/&gt;
+      &lt;el:compatibility el:enigma=&quot;1.00&quot;&gt;
+        &lt;el:dependency el:path=&quot;lib/libsoko&quot; el:id=&quot;lib/libsoko&quot; el:release=&quot;1&quot; el:preload=&quot;true&quot;/&gt;
+      &lt;/el:compatibility&gt;
+      &lt;el:modes el:easy=&quot;true&quot; el:single=&quot;true&quot; el:network=&quot;false&quot;/&gt;
+      &lt;el:score el:easy=&quot;-&quot; el:difficult=&quot;-&quot;/&gt;
+    &lt;/el:info&gt;
+    &lt;el:luamain&gt;&lt;![CDATA[
+
+level =   &quot;  ###  ###\n&quot;
+        ..&quot;###.####.#\n&quot;
+        ..&quot;#    $   # ###\n&quot;
+        ..&quot;# # ###* # #  #\n&quot;
+        ..&quot;# @  $   #  ##\n&quot;
+        ..&quot;#######  #\n&quot;
+        ..&quot;      ####&quot;
+
+level2 =  &quot;    ####            |&quot;
+       ..&quot;    #  ####         |&quot;
+       ..&quot;    # $   ######### |&quot;
+       ..&quot;    # .#    $ ##  # |&quot;
+       ..&quot;    # $# .## $    ##|&quot;
+       ..&quot; #### .###   #$    #|&quot;
+       ..&quot;##  ## #  .. # $$  #|&quot;
+       ..&quot;#  $      ...#   $ #|&quot;
+       ..&quot;# $  #####... #   ##|&quot;
+       ..&quot;#  $#   #  .**@#### |&quot;
+       ..&quot;###   # #    # #    |&quot;
+       ..&quot;  #####  ####  # #  |&quot;
+       ..&quot;      ##      ##    |&quot;
+       ..&quot;       ########     |&quot;
+  
+multilevel =
+  &quot;\n&quot;
+..&quot;\n&quot;
+..&quot;     #####\n&quot;
+..&quot;     #   #\n&quot;
+..&quot;     #   #\n&quot;
+..&quot;   ###   ##\n&quot;
+..&quot;   #  $   #\n&quot;
+..&quot;#### # ## #   ######\n&quot;
+..&quot; #   # ## #####   .#\n&quot;
+..&quot; #    $            #\n&quot;
+..&quot; ##### ### #@##   .#\n&quot;
+..&quot;     #     #########\n&quot;
+..&quot;     #######\n&quot;
+..&quot;&gt; 2\n&quot;
+..&quot;Hier steht etwas Text.\n&quot;
+..&quot;\n&quot;
+..&quot;Hier steht mehr Text.\n&quot;
+..&quot;    \n&quot;
+..&quot;N&#228;chster Level:\n&quot;
+..&quot;############\n&quot;
+..&quot;#..  #     ###\n&quot;
+..&quot;#..  # $  $  #\n&quot;
+..&quot;#..  #$####  #\n&quot;
+..&quot;#..    @ ##  #\n&quot;
+..&quot;#..  # #  $ ##\n&quot;
+..&quot;###### ##$ $ #\n&quot;
+..&quot;  # $  $ $ $ #\n&quot;
+..&quot;  #    #     #\n&quot;
+..&quot;  ############\n&quot;
+..&quot;              \n&quot;
+..&quot;        ########\n&quot;
+..&quot;        #     @#\n&quot;
+..&quot;        # $#$ ##\n&quot;
+..&quot;        # $  $#\n&quot;
+..&quot;        ##$ $ #\n&quot;
+..&quot;######### $ # ###\n&quot;
+..&quot;#....  ## $  $  #\n&quot;
+..&quot;##...    $  $   #\n&quot;
+..&quot;#....  ##########\n&quot;
+..&quot;########\n&quot;
+
+multilevel2 =
+  &quot;&gt; 1\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###          ######\n&quot;
+..&quot;## $######## ######\n&quot;
+..&quot;##  $     #......##\n&quot;
+..&quot;##  $@$ # $.*.#..##\n&quot;
+..&quot;### ###$$ #......##\n&quot;
+..&quot;######    #......##\n&quot;
+..&quot;######$ ###.#######\n&quot;
+..&quot;###     $      ####\n&quot;
+..&quot;#### $ ####$ # ####\n&quot;
+..&quot;###  $$ # $  $ ####\n&quot;
+..&quot;### $$  # $#$  ####\n&quot;
+..&quot;###  $$ #  $ $ ####\n&quot;
+..&quot;####    ##     ####\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;&gt; 2\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;##   #     ########\n&quot;
+..&quot;##     $ $ ###  ..#\n&quot;
+..&quot;###  ## # #### ...#\n&quot;
+..&quot;#### ## $  ###$ #.#\n&quot;
+..&quot;##    #$$$ ### ...#\n&quot;
+..&quot;## $$ #    ###$ #.#\n&quot;
+..&quot;##  $  ##  ##  ...#\n&quot;
+..&quot;##   $ ##   $  $#.#\n&quot;
+..&quot;### $######### ...#\n&quot;
+..&quot;###     $ $ ##$$#.#\n&quot;
+..&quot;###  $$ #   ## ...#\n&quot;
+..&quot;#####  ##$$@##$ #.#\n&quot;
+..&quot;#####      ###  ..#\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;&gt; 3\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;#    ##...$...#   #\n&quot;
+..&quot;# $$ ##$# ##..$ $ #\n&quot;
+..&quot;###  #......... $ #\n&quot;
+..&quot;#   ##....@####$  #\n&quot;
+..&quot;# $$ ##...#####   #\n&quot;
+..&quot;# #  ###.#######$ #\n&quot;
+..&quot;# $ $     #       #\n&quot;
+..&quot;#   #  $$ # $$ $$ #\n&quot;
+..&quot;# ### ##  #  # # ##\n&quot;
+..&quot;#   #  ## #    $ ##\n&quot;
+..&quot;##     ##### # # ##\n&quot;
+..&quot;####$$ ##### $$$  #\n&quot;
+..&quot;####   #####      #\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;&gt; 4\n&quot;
+..&quot;###################\n&quot;
+..&quot;#  *....#       ###\n&quot;
+..&quot;# $**....*  $ #@###\n&quot;
+..&quot;# #.#...## #$$# ###\n&quot;
+..&quot;# $.**##   #    ###\n&quot;
+..&quot;# #.#.## $$# ######\n&quot;
+..&quot;#  ....###   ######\n&quot;
+..&quot;# $ # $# # $#######\n&quot;
+..&quot;# # #    #  #######\n&quot;
+..&quot;#    $ $ ##########\n&quot;
+..&quot;# $##$# ## ########\n&quot;
+..&quot;#   # # #  ########\n&quot;
+..&quot;# $      $ ########\n&quot;
+..&quot;# ## ## #$ ########\n&quot;
+..&quot;# $  ##$   ########\n&quot;
+..&quot;#         #########\n&quot;
+..&quot;###################\n&quot;
+..&quot;&gt; 5\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;#####   ###   #####\n&quot;
+..&quot;#####  $  $ # #####\n&quot;
+..&quot;###### ##   $ #####\n&quot;
+..&quot;###### #  # .######\n&quot;
+..&quot;##### $#  ##.######\n&quot;
+..&quot;#####  @$ *..######\n&quot;
+..&quot;##### #$ *.*.######\n&quot;
+..&quot;#####   ###########\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;&gt; 6\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;######  ###########\n&quot;
+..&quot;####.. $###########\n&quot;
+..&quot;####*.  ###########\n&quot;
+..&quot;####.$$ #   #######\n&quot;
+..&quot;####.# $$   #######\n&quot;
+..&quot;####.$  # # #######\n&quot;
+..&quot;####.##@$   #######\n&quot;
+..&quot;####. $ ##$ #######\n&quot;
+..&quot;####.   ##  #######\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;&gt; 7\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;######  ###########\n&quot;
+..&quot;###### $##   ######\n&quot;
+..&quot;###### .  $@*######\n&quot;
+..&quot;######  #..# ######\n&quot;
+..&quot;#######  $ # ######\n&quot;
+..&quot;####### #*.$ ######\n&quot;
+..&quot;#######$# $#  #####\n&quot;
+..&quot;###### .    . #####\n&quot;
+..&quot;######   ##########\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;###################\n&quot;
+..&quot;&gt; 8\n&quot;
+..&quot;#################\n&quot;
+..&quot;#  *....#       #\n&quot;
+..&quot;# $**....*  $ #@#\n&quot;
+..&quot;# #.#...## #$$# #\n&quot;
+..&quot;# $.**##   #    ##\n&quot;
+..&quot;# #.#.## $$# ##  #\n&quot;
+..&quot;# .....###     $ #\n&quot;
+..&quot;# $ #.*# # $#$$ $##\n&quot;
+..&quot;# #.#... #      $ #\n&quot;
+..&quot;# ...$ $ ###$$$   #\n&quot;
+..&quot;# $## # ## #   $ ##\n&quot;
+..&quot;#   # # #  # #$  #\n&quot;
+..&quot;# $      $ #    ##\n&quot;
+..&quot;# ##$## #$ ######\n&quot;
+..&quot;# $  ##$   #\n&quot;
+..&quot;#         ##\n&quot;
+..&quot;###########\n&quot;
+..&quot;&gt; 9\n&quot;
+..&quot; ########\n&quot;
+..&quot; #  #   #\n&quot;
+..&quot;##  .$  #\n&quot;
+..&quot;# $#.#$##\n&quot;
+..&quot;#@ . . #\n&quot;
+..&quot;# $$.###\n&quot;
+..&quot;## # #\n&quot;
+..&quot; #   #\n&quot;
+..&quot; #####\n&quot;
+..&quot;&gt; 10\n&quot;
+..&quot;#####\n&quot;
+..&quot;# #####\n&quot;
+..&quot;# # . #\n&quot;
+..&quot;# # * ##\n&quot;
+..&quot;### *###\n&quot;
+..&quot;##  $@ #\n&quot;
+..&quot;## # # #\n&quot;
+..&quot;##     #\n&quot;
+..&quot;########\n&quot;
+..&quot;&gt; 11\n&quot;
+..&quot; #####\n&quot;
+..&quot;##   #\n&quot;
+..&quot;#  #$####\n&quot;
+..&quot;# .. .$ #\n&quot;
+..&quot;#  # ## #\n&quot;
+..&quot;# $ $ # #\n&quot;
+..&quot;##@* .  #\n&quot;
+..&quot; ###  ###\n&quot;
+..&quot;   ####\n&quot;
+..&quot;&gt; 12\n&quot;
+..&quot; #######\n&quot;
+..&quot; #   * #\n&quot;
+..&quot; #$# # ##\n&quot;
+..&quot;## . $. #\n&quot;
+..&quot;# @#..  #\n&quot;
+..&quot;# $$  ###\n&quot;
+..&quot;##   ##\n&quot;
+..&quot; #####\n&quot;
+..&quot;&gt; 13\n&quot;
+..&quot;  #####\n&quot;
+..&quot;  #   #\n&quot;
+..&quot;  # $ #\n&quot;
+..&quot; ## #$#\n&quot;
+..&quot;##   @##\n&quot;
+..&quot;#  .#$ #\n&quot;
+..&quot;#.#*.. #\n&quot;
+..&quot;#  . # #\n&quot;
+..&quot;# $# $ #\n&quot;
+..&quot;##   ###\n&quot;
+..&quot; #####\n&quot;
+
+level13_no_actor =
+ &quot;&gt; 13\n&quot;
+..&quot;  #####\n&quot;
+..&quot;  #   #\n&quot;
+..&quot;  # $ #\n&quot;
+..&quot; ## #$#\n&quot;
+..&quot;##    ##\n&quot;
+..&quot;#  .#$ #\n&quot;
+..&quot;#.#*.. #\n&quot;
+..&quot;#  . # #\n&quot;
+..&quot;# $# $ #\n&quot;
+..&quot;##   ###\n&quot;
+..&quot; #####\n&quot;
+
+chessoban =
+  &quot;########\n&quot;
+..&quot;#  NN@ #\n&quot;
+..&quot;#  ##  #\n&quot;
+..&quot;##    ##\n&quot;
+..&quot;#  ##  #\n&quot;
+..&quot;# #  # #\n&quot;
+..&quot;#      #\n&quot;
+..&quot;########\n&quot;
+..&quot;\n\n&quot;
+..&quot;#######\n&quot;
+..&quot;#     #\n&quot;
+..&quot;#  #  #\n&quot;
+..&quot;##n#n##\n&quot;
+..&quot;#  @  #\n&quot;
+..&quot;#.   .#\n&quot;
+..&quot;#######\n&quot;
+
+
+
+design_min = 76
+design_max = table.getn(design_list)
+
+design_number = design_max
+
+create_sokoball(multilevel2, 13, design_number)
+--create_sokoball(chessoban, 2)
+set_stone(&quot;st-switch&quot;, 9, 1, {action=&quot;callback&quot;, target=&quot;design_minus_one&quot;})
+set_stone(&quot;st-switch&quot;, 10, 1, {action=&quot;callback&quot;, target=&quot;design_plus_one&quot;})
+
+function design_minus_one()
+  design_number = design_number - 1
+  if design_number &lt; design_min then
+    design_number = design_max
+  end
+  recreate_sokoball(design_number)
+  set_stone(&quot;st-switch&quot;, 9, 1, {action=&quot;callback&quot;, target=&quot;design_minus_one&quot;})
+  set_stone(&quot;st-switch&quot;, 10, 1, {action=&quot;callback&quot;, target=&quot;design_plus_one&quot;})
+end
+function design_plus_one()
+  design_number = design_number + 1
+  if design_number &gt; design_max then
+    design_number = design_min
+  end
+  recreate_sokoball(design_number)
+  set_stone(&quot;st-switch&quot;, 9, 1, {action=&quot;callback&quot;, target=&quot;design_minus_one&quot;})
+  set_stone(&quot;st-switch&quot;, 10, 1, {action=&quot;callback&quot;, target=&quot;design_plus_one&quot;})
+end
+
+    ]]&gt;&lt;/el:luamain&gt;
+    &lt;el:i18n&gt;
+      &lt;el:string el:key=&quot;title&quot;&gt;
+        &lt;el:english el:translate=&quot;false&quot;/&gt;
+      &lt;/el:string&gt;
+    &lt;/el:i18n&gt;
+  &lt;/el:protected&gt;
+&lt;/el:level&gt;

Modified: trunk/data/levels/lib/libsoko.xml
===================================================================
--- trunk/data/levels/lib/libsoko.xml	2007-09-24 21:31:04 UTC (rev 887)
+++ trunk/data/levels/lib/libsoko.xml	2007-09-25 23:20:08 UTC (rev 888)
@@ -26,7 +26,7 @@
 
 -- This section holds a table with all default designs. Each design
 -- is again a table consisting of the following entries:
---    wall, inf, outf, box, goal, oxyd, endk
+--    wall, inf, outf, box, goal, oxyd, oxop
 -- Each of these entries is either a string representing the objects to
 -- be used, or a table if several objects shall be used. Such a
 -- combination of objects will be called &quot;element&quot;.
@@ -51,12 +51,12 @@
 -- Example:
 --
 --   [5] = { outf = &quot;fl-leaves&quot;, inf = &quot;fl-leavesb&quot;, box = &quot;st-wood&quot;
---           wall = {&quot;st-glass&quot;, &quot;fl-wood&quot;, &quot;fl-leaves&quot;, &quot;al-random&quot;},
---           oxyd =&quot;a&quot; }
+--           wall = {&quot;st-glass&quot;, &quot;fl-wood&quot;, &quot;fl-leaves&quot;, &quot;al:random&quot;},
+--           oxyd = &quot;a&quot;, white = true }
 --
 --   will define design 5. The walls will alternate between
 --   st-glass/fl-wood and st-glass/fl-leaves. The goal will be
---   it-trigger by default.
+--   it-trigger by default. The actor will be ac-whiteball.
 --
 -- Possible flags:
 --
@@ -80,6 +80,8 @@
   oxop = 1 }
 
 design_list = {
+
+-- Ralf's designs
 [1]={box=&quot;st-brownie&quot;, wall=&quot;st-bluegray&quot;, inf=&quot;fl-bluegray&quot;, outf=&quot;fl-space&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
 [2]={box=&quot;st-glass_move&quot;, wall=&quot;st-bluegray&quot;, inf=&quot;fl-bluegray&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_b&quot;, oxyd=&quot;a&quot;},
 [3]={box=&quot;st-wood-growing&quot;, wall=&quot;st-bluegray&quot;, inf=&quot;fl-bluegray&quot;, outf=&quot;fl-abyss&quot;, door=&quot;st-door_c&quot;, oxyd=&quot;a&quot;},
@@ -154,9 +156,139 @@
 [72]={box=&quot;st-block&quot;, wall=&quot;st-rock6&quot;, inf=&quot;fl-acblack&quot;, outf=&quot;fl-leaves&quot;, door=&quot;st-blocker&quot;, oxyd=&quot;d&quot;},
 [73]={box=&quot;st-shogun&quot;, wall=&quot;st-rock6&quot;, inf=&quot;fl-acblack&quot;, outf=&quot;fl-leaves&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
 [74]={box=&quot;st-shogun&quot;, wall=&quot;st-rock6&quot;, inf=&quot;fl-tigris&quot;, outf=&quot;fl-rough-blue&quot;, door=&quot;st-blocker&quot;, oxyd=&quot;b&quot;},
-[75]={box=&quot;st-shogun&quot;, wall=&quot;st-rock6&quot;, inf=&quot;fl-tigris&quot;, outf=&quot;fl-water&quot;,door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;}
+[75]={box=&quot;st-shogun&quot;, wall=&quot;st-rock6&quot;, inf=&quot;fl-tigris&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+
+-- New designs
+[76]={box=&quot;st-glass1_move&quot;, wall=&quot;st-glass2&quot;, inf=&quot;fl-lightgray&quot;, outf=&quot;fl-abyss&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[77]={box=&quot;st-rock3_move&quot;, wall=&quot;st-brick&quot;, inf=&quot;fl-darkgray&quot;, outf=&quot;fl-leavesb&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[78]={box=&quot;st-rock3_move&quot;, wall=&quot;st-bumps&quot;, inf=&quot;fl-dunes&quot;, outf=&quot;fl-sand&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[79]={box=&quot;st-flrock&quot;, wall=&quot;st-camouflage&quot;, inf=&quot;fl-gravel&quot;, outf={&quot;fl-gravel&quot;, &quot;st-disco-medium&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[80]={box=&quot;st-flhay&quot;, wall=&quot;st-camouflage&quot;, inf=&quot;fl-leaves&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[81]={box=&quot;st-glass2_move&quot;, wall={&quot;st-glass1&quot;, &quot;fl-lightgray&quot;}, inf=&quot;fl-black&quot;, outf=&quot;fl-white&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;},
+[82]={box=&quot;st-wood&quot;, wall={&quot;st-glass1&quot;, &quot;fl-water&quot;}, inf=&quot;fl-sand&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;},
+[83]={box=&quot;st-camouflage_move&quot;, wall=&quot;st-glass2&quot;, inf=&quot;fl-lightgray&quot;, outf={&quot;fl-leavesb&quot;, &quot;st-disco-medium&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[84]={box=&quot;st-flrock&quot;, wall=&quot;st-glass2&quot;, inf=&quot;fl-sand&quot;, outf={&quot;fl-water&quot;, &quot;st-disco-medium&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[85]={box=&quot;st-flrock&quot;, wall=&quot;st-brick&quot;, inf=&quot;fl-sand&quot;, outf={&quot;fl-water&quot;, &quot;st-disco-medium&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[86]={box=&quot;st-glass1_move&quot;, wall={&quot;st-glass3&quot;, &quot;fl-abyss_fake&quot;}, inf=&quot;fl-red&quot;, outf=&quot;fl-space&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[87]={box=&quot;st-rock3_move&quot;, wall={&quot;st-glass3&quot;, &quot;fl-rough-blue&quot;}, inf=&quot;fl-plank&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[88]={box=&quot;st-glass1_move&quot;, wall=&quot;st-likeoxyda&quot;, inf=&quot;fl-black&quot;, outf=&quot;fl-abyss&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[89]={box=&quot;st-greenbrown_move&quot;, wall=&quot;st-likeoxyda-open&quot;, inf=&quot;fl-brick&quot;, outf={&quot;fl-mortar&quot;, &quot;st-disco-medium&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[90]={box=&quot;st-rock3_move&quot;, wall=&quot;st-likeoxydb&quot;, inf=&quot;fl-rough-red&quot;, outf=&quot;fl-space&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[91]={box=&quot;st-flhay&quot;, wall=&quot;st-likeoxydb-open&quot;, inf=&quot;fl-rough-blue&quot;, outf={&quot;fl-swamp&quot;, &quot;st-disco-light&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[92]={box=&quot;st-glass2_move&quot;, wall=&quot;st-likeoxydc&quot;, inf=&quot;fl-sahara&quot;, outf={&quot;fl-water&quot;, &quot;st-disco-light&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;},
+[93]={box=&quot;st-glass_move&quot;, wall=&quot;st-likeoxydc-open&quot;, inf=&quot;fl-red&quot;, outf={&quot;st-blackballs&quot;, &quot;fl-abyss&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;},
+[94]={box=&quot;st-glass2_move&quot;, wall=&quot;st-likeoxydd&quot;, inf=&quot;fl-concrete&quot;, outf=&quot;fl-sand&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[95]={box=&quot;st-flrock&quot;, wall=&quot;st-likeoxydd-open&quot;, inf=&quot;fl-marble&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[96]={box=&quot;st-flrock&quot;, wall=&quot;st-marble&quot;, inf=&quot;fl-marble&quot;, outf={&quot;fl-leavesc3&quot;, &quot;fl-leavesd3&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[97]={box=&quot;st-camouflage_move&quot;, wall=&quot;st-marble&quot;, inf=&quot;fl-leaves&quot;, outf={&quot;fl-leaves&quot;, &quot;st-marble&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[98]={box=&quot;st-rock1_move&quot;, wall=&quot;st-redrock&quot;, inf=&quot;fl-acblack&quot;, outf={&quot;fl-acblack&quot;, &quot;st-redrock&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[99]={box=&quot;st-glass1_move&quot;, wall=&quot;st-redrock&quot;, inf=&quot;fl-mortar&quot;, outf=&quot;fl-brick&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[100]={box=&quot;st-block&quot;, wall=&quot;st-redrock&quot;, inf=&quot;fl-mortar&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[101]={box=&quot;st-glass2_move&quot;, wall=&quot;st-redrock&quot;, inf=&quot;fl-leavesb&quot;, outf={&quot;fl-leavesc3&quot;, &quot;fl-leavesd4&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[102]={box=&quot;st-camouflage_move&quot;, wall=&quot;st-rock2&quot;, inf=&quot;fl-rock&quot;, outf={&quot;fl-rock&quot;, &quot;st-disco-medium&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[103]={box=&quot;st-glass2_move&quot;, wall=&quot;st-rock2&quot;, inf=&quot;fl-stone&quot;, outf={&quot;fl-water&quot;, &quot;st-disco-medium&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[104]={box=&quot;st-wood&quot;, wall=&quot;st-rock2&quot;, inf=&quot;fl-lightgray&quot;, outf=&quot;fl-space&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[105]={box=&quot;st-camouflage_move&quot;, wall=&quot;st-rock7&quot;, inf=&quot;fl-woven&quot;, outf=&quot;fl-gravel&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[106]={box=&quot;st-brownie&quot;, wall=&quot;st-rock7&quot;, inf=&quot;fl-black&quot;, outf=&quot;fl-abyss&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[107]={box=&quot;st-glass_move&quot;, wall=&quot;st-rock8&quot;, inf=&quot;fl-plank&quot;, outf={&quot;fl-plank&quot;, &quot;st-rock8&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[108]={box=&quot;st-glass2_move&quot;, wall={&quot;st-rock8&quot;, &quot;fl-water&quot;}, inf=&quot;fl-leaves&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;},
+[109]={box=&quot;st-marble_move&quot;, wall={&quot;st-rock8&quot;, &quot;fl-abyss_fake&quot;}, inf=&quot;fl-stone&quot;, outf=&quot;fl-space&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;},
+[110]={box=&quot;st-greenbrown_move&quot;, wall=&quot;st-rock9&quot;, inf=&quot;fl-rock&quot;, outf={&quot;fl-rock&quot;, &quot;st-rock9&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[111]={box=&quot;st-glass_move&quot;, wall=&quot;st-rock9&quot;, inf=&quot;fl-sand&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;},
+[112]={box=&quot;st-camouflage_move&quot;, wall=&quot;st-rock9&quot;, inf=&quot;fl-stone&quot;, outf=&quot;fl-swamp&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[113]={box=&quot;st-block&quot;, wall=&quot;st-rock10&quot;, inf=&quot;fl-bluegreen&quot;, outf=&quot;fl-abyss&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[114]={box=&quot;st-wood&quot;, wall=&quot;st-rock10&quot;, inf=&quot;fl-sand&quot;, outf={&quot;fl-sand&quot;, &quot;st-rock10&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[115]={box=&quot;st-glass2_move&quot;, wall=&quot;st-stone1&quot;, inf={&quot;fl-lightgray&quot;, &quot;fl-white&quot;}, outf={&quot;fl-space&quot;, &quot;fl-abyss&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[116]={box=&quot;st-rock1_move&quot;, wall=&quot;st-stone1&quot;, inf=&quot;fl-stwood&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[117]={box=&quot;st-glass_move&quot;, wall=&quot;st-stone1&quot;, inf=&quot;fl-black&quot;, outf=&quot;st-stone1&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[118]={box=&quot;st-glass_move&quot;, wall=&quot;st-stone2&quot;, inf=&quot;fl-black&quot;, outf=&quot;fl-gravel&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[119]={box=&quot;st-block&quot;, wall=&quot;st-stone2&quot;, inf=&quot;fl-rough-red&quot;, outf={&quot;fl-rough-blue&quot;, &quot;st-disco-light&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[120]={box=&quot;st-rock3_move&quot;, wall={&quot;st-marble&quot;, &quot;st-stone2&quot;}, inf=&quot;fl-black&quot;, outf={&quot;st-marble&quot;, &quot;st-stone2&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[121]={box=&quot;st-wood&quot;, wall=&quot;st-panel&quot;, inf=&quot;fl-wood&quot;, outf={&quot;fl-leavesd3&quot;, &quot;fl-leavesd2&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[122]={box=&quot;st-block&quot;, wall=&quot;st-panel&quot;, inf=&quot;fl-leaves&quot;, outf=&quot;fl-leavesb&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[123]={box=&quot;st-glass1_move&quot;, wall=&quot;st-woven&quot;, inf=&quot;fl-dunes&quot;, outf=&quot;fl-bluegreen&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[124]={box=&quot;st-marble_move&quot;, wall=&quot;st-woven&quot;, inf=&quot;fl-hay&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[125]={box=&quot;st-rock3_move&quot;, wall=&quot;st-yellow&quot;, inf=&quot;fl-leavesb&quot;, outf=&quot;fl-leaves&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[126]={box=&quot;st-glass_move&quot;, wall=&quot;st-yellow&quot;, inf=&quot;fl-rough-blue&quot;, outf=&quot;fl-abyss&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[127]={box=&quot;st-block&quot;, wall=&quot;st-yellow&quot;, inf=&quot;fl-lightgray&quot;, outf=&quot;fl-space&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[128]={box=&quot;st-glass1_move&quot;, wall=&quot;st-rock7&quot;, inf=&quot;fl-himalaya&quot;, outf={&quot;fl-himalaya&quot;, &quot;st-rock8&quot;, &quot;st-rock7&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[129]={box=&quot;st-camouflage_move&quot;, wall={&quot;st-rock9&quot;, &quot;fl-leavesb&quot;}, inf=&quot;fl-dunes&quot;,
+       outf={&quot;fl-leavese1&quot;, &quot;fl-leavese2&quot;, &quot;fl-leavese3&quot;, &quot;fl-leavese4&quot;, &quot;al:waves&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[130]={box=&quot;st-glass1_move&quot;, wall=&quot;st-redrock&quot;, inf=&quot;fl-darkgray&quot;,
+       outf={&quot;fl-black&quot;, &quot;st-redrock&quot;, &quot;st-invisible&quot;, &quot;st-invisible&quot;, &quot;st-invisible&quot;, &quot;al:waves&quot;},
+       door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[131]={box=&quot;st-glass1_move&quot;, wall={&quot;st-yellow&quot;, &quot;st-yellow&quot;, &quot;st-redrock&quot;, &quot;st-redrock&quot;, &quot;al:waves&quot;}, inf=&quot;fl-wood&quot;,
+       outf={&quot;st-yellow&quot;, &quot;st-yellow&quot;, &quot;st-redrock&quot;, &quot;st-redrock&quot;, &quot;al:waves&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[132]={box=&quot;st-wood&quot;, wall=&quot;st-camouflage&quot;, inf=&quot;fl-leavesb&quot;,
+       outf={&quot;fl-water&quot;, &quot;fl-swamp&quot;, &quot;fl-water&quot;, &quot;fl-water&quot;, &quot;al:random&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[133]={box=&quot;st-glass2_move&quot;, wall=&quot;st-metal&quot;, inf=&quot;fl-metal&quot;,
+       outf={&quot;fl-space&quot;, &quot;fl-abyss&quot;, &quot;fl-abyss&quot;, &quot;fl-abyss&quot;, &quot;al:random&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[134]={box=&quot;st-marble_move&quot;, wall=&quot;st-metal&quot;, inf=&quot;fl-white&quot;,
+       outf={&quot;fl-abyss&quot;, &quot;st-grate1&quot;, &quot;st-invisible&quot;, &quot;st-invisible&quot;, &quot;st-invisible&quot;, &quot;al:waves&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[135]={box=&quot;st-glass_move&quot;, wall=&quot;st-likeoxydc&quot;, inf=&quot;fl-white&quot;,
+       outf={&quot;fl-white&quot;, &quot;st-rock1&quot;, &quot;st-invisible&quot;, &quot;st-invisible&quot;, &quot;st-invisible&quot;, &quot;al:random&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;},
+[136]={box=&quot;st-block&quot;, wall={&quot;st-oneway_white-n&quot;, &quot;st-oneway_white-s&quot;, &quot;st-oneway_white-e&quot;, &quot;st-oneway_white-w&quot;, &quot;al:random&quot;}, inf=&quot;fl-rough&quot;,
+       outf={&quot;st-oneway_white-n&quot;, &quot;st-oneway_white-s&quot;, &quot;st-oneway_white-e&quot;, &quot;st-oneway_white-w&quot;, &quot;al:random&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[137]={box={&quot;st-mirror-p-m&quot;, &quot;st-mirror-p/m&quot;, &quot;st-mirror-p\\m&quot;, &quot;st-mirror-p|m&quot;, &quot;al:random&quot;},
+       --wall={&quot;st-laser-n&quot;, &quot;st-laser-s&quot;, &quot;st-laser-e&quot;, &quot;laser-w&quot;, &quot;al:random&quot;},
+       wall={&quot;st-glass3&quot;, &quot;fl-abyss&quot;}, inf=&quot;fl-metal&quot;,
+       --wall={&quot;st-mirror-p-&quot;, &quot;st-mirror-p/&quot;, &quot;st-mirror-p\\&quot;, &quot;st-mirror-p|&quot;, &quot;al:random&quot;},
+       outf={&quot;st-mirror-p-&quot;, &quot;st-mirror-p/&quot;, &quot;st-mirror-p|&quot;, &quot;st-mirror-p\\&quot;, &quot;al:random&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[138]={box=&quot;st-shogun-s&quot;, wall=&quot;st-panel&quot;, inf=&quot;fl-stwood&quot;, outf=&quot;fl-water&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[139]={box=&quot;st-shogun-s&quot;, wall={&quot;st-white4&quot;, &quot;fl-springboard&quot;, &quot;fl-abyss_fake&quot;}, inf={&quot;fl-springboard&quot;, &quot;fl-abyss_fake&quot;},
+       outf={&quot;st-white1&quot;, &quot;st-black1&quot;, &quot;fl-springboard&quot;, &quot;fl-abyss_fake&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;b&quot;},
+[140]={box=&quot;st-brownie&quot;, wall={&quot;st-stone1&quot;, &quot;fl-leavesb&quot;}, inf={&quot;fl-floor_001&quot;, &quot;fr:3.0&quot;},
+       outf={&quot;fl-leavese4&quot;, &quot;fl-leavese2&quot;, &quot;fl-leavese1&quot;, &quot;fl-leavese3&quot;, &quot;al:waves&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[141]={box=&quot;st-brownie&quot;, wall={&quot;st-rock4&quot;, &quot;fl-leavesb&quot;}, inf={&quot;fl-bluegreenx&quot;, &quot;mf:1.0&quot;, &quot;fr:3.0&quot;},
+       outf={&quot;fl-water&quot;, &quot;st-rock10&quot;, &quot;st-invisible&quot;, &quot;st-invisible&quot;, &quot;st-invisible&quot;, &quot;al:waves&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[142]={box=&quot;st-glass2_move&quot;, wall={&quot;st-glass1&quot;, &quot;fl-leavesb&quot;}, inf=&quot;fl-leavesb&quot;,
+       outf={&quot;fl-leavesc4&quot;, &quot;fl-leavesd2&quot;, &quot;fl-leavesc2&quot;, &quot;fl-leavese3&quot;, &quot;al:waves&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[143]={box=&quot;st-block&quot;, wall={&quot;st-rock5&quot;, &quot;fl-stwood&quot;}, inf=&quot;fl-wood&quot;,
+       outf={&quot;st-disco-light&quot;, &quot;fl-wood1&quot;, &quot;fl-wood1&quot;, &quot;fl-wood1&quot;, &quot;fl-wood2&quot;, &quot;al:waves&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[144]={box=&quot;st-wood&quot;, wall=&quot;st-rock6&quot;, inf=&quot;fl-bluegreen&quot;,
+       outf={&quot;fl-space&quot;, &quot;it-squashed&quot;, &quot;it-sensor&quot;, &quot;it-sensor&quot;, &quot;it-sensor&quot;, &quot;al:random&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;d&quot;},
+[145]={box=&quot;st-glass1_move&quot;, wall={&quot;st-greenbrown&quot;, &quot;fl-sand&quot;}, inf=&quot;fl-dunes&quot;,
+       outf={&quot;fl-sand&quot;, &quot;it-landmine&quot;, &quot;it-booze-broken&quot;, &quot;it-none&quot;, &quot;it-none&quot;, &quot;it-none&quot;, &quot;it-none&quot;, &quot;it-none&quot;, &quot;it-none&quot;, &quot;al:random&quot;},
+       door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[146]={box=&quot;st-wood&quot;, wall=&quot;st-rock1&quot;, inf=&quot;fl-black&quot;,
+       outf={&quot;fl-abyss&quot;, &quot;st-grate1&quot;, &quot;st-none&quot;, &quot;st-none&quot;, &quot;st-none&quot;, &quot;st-none&quot;, &quot;st-none&quot;, &quot;st-none&quot;,
+       &quot;st-none&quot;, &quot;st-none&quot;, &quot;st-none&quot;, &quot;st-none&quot;, &quot;al:random&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;, white = true},
+[147]={box=&quot;st-wood&quot;, wall=&quot;st-whiteballs&quot;, inf=&quot;fl-gray&quot;, white = true,
+       outf={&quot;fl-gradient5&quot;, &quot;fl-gradient6&quot;, &quot;fl-gradient7&quot;, &quot;fl-gradient8&quot;, &quot;al:waves&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[148]={box=&quot;st-shogun-s&quot;, wall=&quot;st-metal&quot;, inf=&quot;fl-rough-blue&quot;, white = true,
+       outf={&quot;fl-rough-red&quot;, &quot;fl-rough-blue&quot;, &quot;st-disco-light&quot;}, door=&quot;st-door_a&quot;, oxyd=&quot;a&quot;},
+[149]={box=&quot;st-shogun-s&quot;, wall=&quot;st-yellow&quot;, inf=&quot;fl-wood&quot;, outf=&quot;fl-swamp&quot;, door=&quot;st-door_a&quot;,
+       oxyd=&quot;c&quot;, goal=&quot;it-shogun-s&quot;, white = true},
+[150]={box=&quot;st-flrock&quot;, wall=&quot;st-redrock&quot;, inf=&quot;fl-brick&quot;, outf=&quot;fl-space&quot;, door=&quot;st-door_a&quot;, oxyd=&quot;c&quot;, white = true},
 }
 
+--
+-- Remaining walls:
+--  st-beads, st-brick, st-bumps, st-camouflage, st-fakeoxyd,
+--  st-glass1/2/3, st-likeoxyda/b/c/d[-open], [st-marble],
+--  st-redrock, st-rock2/7/8/9/10, st-stone1/2, st-panel,
+--  st-woven, st-yellow
+--
+-- Remaining boxes:
+--  st-camouflage_move, st-glass1/2_move, st-rock1_move, st-flhay,
+--  st-flrock
+--
+-- Remaining floors (inside):
+--  fl-abyss_fake, fl-black, fl-bluegreen[x], fl-brick, fl-bumps,
+--  fl-concrete, fl-darkgray, fl-dunes, [fl-floor_001], fl-gravel,
+--  fl-gray, fl-hay, fl-leavesb/c/d/e*, fl-lightgray, fl-marble,
+--  fl-metal, fl-mortar, [fl-normal[_x]], fl-plank, fl-red,
+--  fl-rock, fl-rough-blue, fl-sahara, fl-sand, fl-springboard,
+--  fl-stone, fl-stwood, [fl-trigger], fl-woven
+--
+-- have: fl-acblack, fl-bluegray, fl-himalaya, fl-leaves,
+--       fl-light, fl-rough, fl-rough-red, fl-samba, fl-tigris,
+--       fl-white, fl-wood
+--
+-- outside (have): fl-abyss, fl-leaves, fl-rough-blue, fl-sahara,
+--                 fl-space, fl-water
+--
+
 ------------------------------------------------------------------------
 -- Global variables
 ------------------------------------------------------------------------
@@ -183,12 +315,12 @@
   error(st)
 end
 
-function is_floor(s)      return string.sub(s, 1, 3) == &quot;fl-&quot;  end
-function is_stone(s)      return string.sub(s, 1, 3) == &quot;st-&quot;  end
-function is_item(s)       return string.sub(s, 1, 3) == &quot;it-&quot;  end
-function is_algorithm(s)  return string.sub(s, 1, 3) == &quot;al:&quot;  end
-function is_friction(s)   return string.sub(s, 1, 3) == &quot;fr:&quot;  end
-function is_mouseforce(s) return string.sub(s, 1, 3) == &quot;mf:&quot;  end
+function is_floor(s)       return string.sub(s, 1, 3) == &quot;fl-&quot;  end
+function is_stone(s)       return string.sub(s, 1, 3) == &quot;st-&quot;  end
+function is_item(s)        return string.sub(s, 1, 3) == &quot;it-&quot;  end
+function is_algorithm(s)   return string.sub(s, 1, 3) == &quot;al:&quot;  end
+function is_friction(s)    return string.sub(s, 1, 3) == &quot;fr:&quot;  end
+function is_mousefactor(s) return string.sub(s, 1, 3) == &quot;mf:&quot;  end
 
 -- combine_tables returns a table consisting of all entries of the
 -- entries of OVER_TABLE: OVER_TABLE is a table of tables, say
@@ -298,6 +430,7 @@
 -- draw_level_array draws a sokoball level from global variable LEVEL_ARRAY
 -- with design CHOSEN_DESIGN (global var, a ready-for-use design table)
 -- at offset DX, DY. If OUTSIDE is true, the outside will be drawn as well.
+-- DRAW_ACTOR determines whether the actor should be placed.
 -- draw_level_array will NOT
 --  - create the world
 --  - set global variables
@@ -305,7 +438,7 @@
 --  - solve the level
 -- This function is not intended to be used in level programming
 -- directly, use &quot;draw_sokoball&quot; instead.
-function draw_level_array(dx, dy, outside)
+function draw_level_array(dx, dy, outside, draw_actor)
   local array_width = table.getn(level_array[1])
   local array_height = table.getn(level_array)
 
@@ -348,12 +481,20 @@
       
       -- Chess-Stones
       if (ch == &quot;n&quot;) or (ch == &quot;N&quot;) then
-        set_stone(&quot;st-chess_black&quot;, x, y)
+        if chosen_design[&quot;white&quot;] then
+          set_stone(&quot;st-chess_white&quot;, x + dx, y + dy)
+        else
+          set_stone(&quot;st-chess_black&quot;, x + dx, y + dy)
+        end
       end
       
       -- Actors
-      if (ch == &quot;@&quot;) or (ch == &quot;+&quot;) then
-        set_actor(&quot;ac-blackball&quot;, x + 0.5 + dx, y + 0.5 + dy, { name = &quot;marble&quot; })
+      if ((ch == &quot;@&quot;) or (ch == &quot;+&quot;)) and draw_actor then
+        if chosen_design[&quot;white&quot;] then
+          set_actor(&quot;ac-whiteball&quot;, x + 0.5 + dx, y + 0.5 + dy, { name = &quot;marble&quot;, controllers = 1, player = 0 })
+        else
+          set_actor(&quot;ac-blackball&quot;, x + 0.5 + dx, y + 0.5 + dy, { name = &quot;marble&quot; })
+        end
       end
     end
   end  
@@ -392,8 +533,9 @@
     ..&quot;[\#\$\.@\*Nn\+]+&quot;          -- at least one non-space character
     ..&quot;[ \-\#\_\$\.@\*0-9Nn\+]*&quot;  -- again all allowed characters except line ending
   local in_level = false
-  for line in string.gfind(multilevel, &quot;[^\n\|]+&quot;) do
+  for line in string.gfind(multilevel, &quot;([^\n\|]*)[\n\|]&quot;) do
     if string.match(line, level_line_match) == line then
+      mydebug(&quot;Level &quot;..current_level..&quot; : |&quot;..line..&quot;|&quot;)
       if in_level then
         if current_level == (sublevel_number or 1) then
           level = level..line..&quot;\n&quot;
@@ -772,7 +914,7 @@
     end
   end
   
-  draw_level_array(dx, dy, true)
+  draw_level_array(dx, dy, true, true)
 
   if number_goals &lt; 1 then
     myerror(&quot;No goals defined!\n&quot;)
@@ -787,6 +929,53 @@
   enigma.ConserveLevel = FALSE
 end
 
+-- recreate_sokoball is used for design development only.
+-- It redraws the current level from scratch, but not the world
+-- and doesn't add another actor.
+function recreate_sokoball(design)
+  -- calculate screen position
+  -- Important Note: level_array is reversely indexed, i.e.
+  --                 level_array[y-coordinate][x-coordinate]
+  local array_width = table.getn(level_array[1])
+  local array_height = table.getn(level_array)
+  levelw = math.max(array_width, 20)
+  levelh = math.max(array_height, 13)
+  
+  -- Calculate padding
+  local dx = 0
+  local dy = 0
+  if levelw &gt; array_width then
+    dx = math.floor((levelw - array_width) / 2)
+  end
+  if levelh &gt; array_height then
+    dy = math.floor((levelh - array_height) / 2)
+  end
+  
+  chosen_design = design_from_description(design, level_array)
+
+  for x = 0, levelw - 1 do
+    for y = 0, levelh - 1 do
+      kill_stone(x, y)
+      kill_item(x, y)
+      set_element(x, y, chosen_design, &quot;outf&quot;)
+    end
+  end
+  
+  draw_level_array(dx, dy, true, false)
+
+  if number_goals &lt; 1 then
+    myerror(&quot;No goals defined!\n&quot;)
+  end
+
+  -- determine oxop (way to open oxyds)
+  local oxop = chosen_design.oxop
+  prepare_oxyds(oxop)
+
+  enigma.ShowMoves = TRUE
+  display.SetFollowMode(display.FOLLOW_SMOOTH)
+  enigma.ConserveLevel = FALSE
+end
+
 -- draw_sokoball draws a sokoball level from argument LEVEL with design
 -- DESIGN (see create_sokoball) at offset DX, DY. It's arguments are
 -- identical to those of create_sokoball. Whereas create_sokoball should
@@ -797,14 +986,15 @@
 --  - draw the outside, such that it doesn't overwrite the rest of your
 --    level
 --  - solve the level when all triggers are activated.
+-- DRAW_ACTOR determines if an actor should be placed.
 -- Note: Overwriting one sokoball part by another creates problems
 --       with the triggers.
 --
-function draw_sokoball(dx, dy, level, sublevel, design)
+function draw_sokoball(dx, dy, level, sublevel, design, draw_actor)
   -- unpack level
   level_array = unpack_level(level, sublevel)
   chosen_design = design_from_description(design, level_array)
-  draw_level_array(dx, dy, false)
+  draw_level_array(dx, dy, false, draw_actor)
 end
 
     ]]&gt;&lt;/el:luamain&gt;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000319.html">[Enigma-game-svn] r887 - in homepage: . images/lotm input input/lotm
</A></li>
	<LI>Next message: <A HREF="000321.html">[Enigma-game-svn] r889 - in trunk: lib-src/enigma-core src src/lev
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#320">[ date ]</a>
              <a href="thread.html#320">[ thread ]</a>
              <a href="subject.html#320">[ subject ]</a>
              <a href="author.html#320">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
