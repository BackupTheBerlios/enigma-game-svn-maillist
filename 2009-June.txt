From raoul at mail.berlios.de  Mon Jun  1 02:34:00 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Mon, 1 Jun 2009 02:34:00 +0200
Subject: [Enigma-game-svn] r1700 - in trunk/data/levels: enigma_cross
	enigma_i enigma_ii enigma_iii enigma_iv enigma_v enigma_vi
	enigma_vii enigma_viii lib
Message-ID: <200906010034.n510Y0TL021195@sheep.berlios.de>

Author: raoul
Date: 2009-06-01 02:33:56 +0200 (Mon, 01 Jun 2009)
New Revision: 1700

Added:
   trunk/data/levels/enigma_iii/siegfried20_2.xml
   trunk/data/levels/enigma_v/duffy23_2.xml
   trunk/data/levels/enigma_vi/andreas43_3.xml
   trunk/data/levels/enigma_vi/just10_3.xml
   trunk/data/levels/enigma_viii/luc36.xml
   trunk/data/levels/enigma_viii/manfi01_1.xml
   trunk/data/levels/enigma_viii/pulley24_1.xml
Removed:
   trunk/data/levels/enigma_iii/siegfried20_1.xml
   trunk/data/levels/enigma_v/duffy23_1.xml
   trunk/data/levels/enigma_vi/andreas43_2.xml
   trunk/data/levels/enigma_vi/just10_2.xml
Modified:
   trunk/data/levels/enigma_cross/enigma0_92_1.xml
   trunk/data/levels/enigma_cross/enigma0_92_2.xml
   trunk/data/levels/enigma_cross/newlevels.xml
   trunk/data/levels/enigma_cross/newlevels_1.0.1.xml
   trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
   trunk/data/levels/enigma_i/andreas01_2.xml
   trunk/data/levels/enigma_i/andreas12_2.xml
   trunk/data/levels/enigma_i/index.xml
   trunk/data/levels/enigma_i/martin92_2.xml
   trunk/data/levels/enigma_ii/welcometopack2_2.xml
   trunk/data/levels/enigma_iii/illmind11_2.xml
   trunk/data/levels/enigma_iii/index.xml
   trunk/data/levels/enigma_iii/nat36_2.xml
   trunk/data/levels/enigma_iii/welcometopack3_2.xml
   trunk/data/levels/enigma_iv/duffy93_3.xml
   trunk/data/levels/enigma_iv/index.xml
   trunk/data/levels/enigma_iv/nat16_2.xml
   trunk/data/levels/enigma_iv/welcometopack4_2.xml
   trunk/data/levels/enigma_v/index.xml
   trunk/data/levels/enigma_v/raoul12_2.xml
   trunk/data/levels/enigma_v/welcometopack5_2.xml
   trunk/data/levels/enigma_vi/index.xml
   trunk/data/levels/enigma_vi/welcometopack6_2.xml
   trunk/data/levels/enigma_vii/welcometopack7_2.xml
   trunk/data/levels/enigma_viii/index.xml
   trunk/data/levels/lib/natmaze.xml
Log:
-> 3 new levels ("the sum of its parts", "missing oxyds?", "path through flood")
-> A few rewrites ("check the light", ...)
-> Updates for "cooler spot in hell", "waterworld"
-> Fixes for natmaze in new API levels




Modified: trunk/data/levels/enigma_cross/enigma0_92_1.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="29" title="Enigma 0.92 - 1"/>
+  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="30" title="Enigma 0.92 - 1"/>
 
   <attributes/>
 
@@ -36,7 +36,7 @@
     <level _seq="28" _title="Swap Swap" _xpath="enigma_iii/siegfried02_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level1f" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="29" _title="Push your way" _xpath="enigma_ii/siegfried12_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level4b" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="30" _title="- Meditation -" _xpath="enigma_i/siegfried38_2" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation5" rel="2" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="31" _title="Bridgebuilder" _xpath="enigma_iii/siegfried20_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level6b" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="31" _title="Bridgebuilder" _xpath="enigma_iii/siegfried20_2" author="Siegfried Fennig" ctrl="force" easy="false" id="level6b" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="32" _title="Space Pirates" _xpath="enigma_v/siegfried19_2" author="Siegfried Fennig" ctrl="force" easy="false" id="level6a" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="33" _title="Mission Impossible" _xpath="enigma_i/martin14_1" author="Martin Hawlisch" ctrl="force" easy="true" id="martin14" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="34" _title="Send More Money" _xpath="enigma_ii/siegfried18_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level5f" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/enigma0_92_2.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_cross/enigma0_92_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15200" network="false" owner="Enigma Team" release="1" revision="37" title="Enigma 0.92 - 2"/>
+  <info enigma="1.00" group="Facets" location="15200" network="false" owner="Enigma Team" release="1" revision="38" title="Enigma 0.92 - 2"/>
 
   <attributes/>
 
@@ -82,7 +82,7 @@
     <level _seq="74" _title="Choo-Choo" _xpath="enigma_v/duffy22_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy22" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="75" _title="Switch-Switch" _xpath="enigma_iv/raywick02_2" author="Ray Wick" ctrl="force" easy="false" id="RayWick002" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="76" _title="Turbulence" _xpath="enigma_i/duffy24_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy24" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="77" _title="Shrinking Pits" _xpath="enigma_v/duffy23_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy23" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="77" _title="Shrinking Pits" _xpath="enigma_v/duffy23_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy23" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="78" _title="Run Like Hell" _xpath="enigma_iv/ralf09_2" author="Ralf Westram" ctrl="force" easy="false" id="ralf09" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="79" _title="Be Faster!" _xpath="enigma_iv/martin98_1" author="Martin Hawlisch" ctrl="force" easy="true" id="martin98" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="80" _title="Teamwork" _xpath="enigma_iii/duffy25_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy25" rel="2" rev="2" score="1" target="time" unit="duration"/>
@@ -108,7 +108,7 @@
     <level _seq="100" _title="Sisyphus" _xpath="enigma_vi/nat13_1" author="Nat Pryce" ctrl="force" easy="false" id="nat13" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="101" _title="Snowball Fight" _xpath="enigma_iv/nat14_1" author="Nat Pryce" ctrl="force" easy="false" id="nat14" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="102" _title="Caterpillar" _xpath="enigma_v/nat15_2" author="Nat Pryce" ctrl="force" easy="true" id="nat15" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="103" _title="Squaring the Circle" _xpath="enigma_iv/nat16_2" author="Nat Pryce" ctrl="force" easy="true" id="nat16" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="103" _title="Squaring the Circle" _xpath="enigma_iv/nat16_2" author="Nat Pryce" ctrl="force" easy="true" id="nat16" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="104" _title="Electrickery" _xpath="enigma_iv/nat17_2" author="Nat Pryce" ctrl="force" easy="false" id="nat17" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="105" _title="- Meditation -" _xpath="enigma_iv/nat18_2" author="Nat Pryce" ctrl="force" easy="false" id="nat18" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="106" _title="Eccentric Orbits" _xpath="enigma_iv/nat19_1" author="Nat Pryce" ctrl="force" easy="false" id="nat19" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_cross/newlevels.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="44" title="Enigma 1.00 new"/>
+  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="45" title="Enigma 1.00 new"/>
 
   <attributes/>
 
@@ -12,8 +12,8 @@
     <level _seq="4" _title="Hostile World" _xpath="enigma_i/rb01_1" author="Roberto Bardin" ctrl="force" easy="true" id="rb01" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="5" _title="The Big Swamp" _xpath="enigma_i/luc10_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc10" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="6" _title="Bendixxon" _xpath="enigma_i/alain06_1" author="Alain Busser" ctrl="force" easy="false" id="alain06" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="7" _title="Lissajous" _xpath="enigma_i/andreas01_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas01" rel="2" rev="4" score="1" target="time" unit="duration"/>
-    <level _seq="8" _title="Lissajous' Revenge" _xpath="enigma_i/andreas12_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas12" rel="2" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="7" _title="Lissajous" _xpath="enigma_i/andreas01_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas01" rel="2" rev="5" score="1" target="time" unit="duration"/>
+    <level _seq="8" _title="Lissajous' Revenge" _xpath="enigma_i/andreas12_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas12" rel="2" rev="6" score="1" target="time" unit="duration"/>
     <level _seq="9" _title="Enigmawale" _xpath="enigma_i/alain20_1" author="Alain Busser" ctrl="force" easy="true" id="alain20" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="10" _title="Encased" _xpath="enigma_i/xerxes01_1" author="Xerxes M. Dynatos" ctrl="force" easy="false" id="xerxes01" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="11" _title="Without Tremor" _xpath="enigma_i/richi04_2" author="Richi B?tzer" ctrl="force" easy="false" id="richi04" rel="2" rev="1" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels_1.0.1.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.0.1.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_cross/newlevels_1.0.1.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15500" network="false" owner="Enigma Team" release="1" revision="28" title="Enigma 1.01 new"/>
+  <info enigma="1.00" group="Facets" location="15500" network="false" owner="Enigma Team" release="1" revision="29" title="Enigma 1.01 new"/>
 
   <attributes/>
 
@@ -15,7 +15,7 @@
     <level _seq="7" _title="Playing with Lasers" _xpath="enigma_vi/just09_1" author="JuSt" ctrl="force" easy="false" id="just09_1" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Hot Hurdle Race" _xpath="enigma_vi/ulf04_1" author="Ulf Stegemann" ctrl="force" easy="true" id="20070124ulf019" rel="1" rev="93" score="1" target="time" unit="duration"/>
     <level _seq="9" _title="Counterclockwise" _xpath="enigma_vi/ulf05_2" author="Ulf Stegemann" ctrl="force" easy="true" id="20070126ulf020" rel="2" rev="98" score="1" target="time" unit="duration"/>
-    <level _seq="10" _title="Check the light" _xpath="enigma_vi/just10_2" author="JuSt" ctrl="force" easy="false" id="just10" rel="2" rev="6" score="2" target="time" unit="duration"/>
+    <level _seq="10" _title="Check the light" _xpath="enigma_vi/just10_3" author="JuSt" ctrl="force" easy="false" id="just10" rel="3" rev="7" score="2" target="time" unit="duration"/>
     <level _seq="11" _title="Twokoban I" _xpath="enigma_vi/raoul28_2" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul28" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="12" _title="The Passage" _xpath="enigma_vi/just11_1" author="JuSt" ctrl="force" easy="false" id="just11" rel="1" rev="7" score="1" target="time" unit="duration"/>
     <level _seq="13" _title="Magic Triangle" _xpath="enigma_vi/just13_1" author="JuSt" ctrl="force" easy="false" id="just13" rel="1" rev="1" score="1" target="time" unit="duration"/>
@@ -51,7 +51,7 @@
     <level _seq="43" _title="Correspondence Chess" _xpath="enigma_vi/luc35_3" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc352007" rel="3" rev="4" score="3" target="time" unit="duration"/>
     <level _seq="44" _title="Exclusive Pole Positions" _xpath="enigma_vii/duffy149_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy149" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="45" _title="Mirror Sharing" _xpath="enigma_vii/duffy150_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy150" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="46" _title="A Cooler Spot in Hell" _xpath="enigma_vi/andreas43_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas43" rel="2" rev="3" score="2" target="time" unit="duration"/>
+    <level _seq="46" _title="A Cooler Spot in Hell" _xpath="enigma_vi/andreas43_3" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas43" rel="4" rev="7" score="3" target="time" unit="duration"/>
     <level _seq="47" _title="Quadropolis" _xpath="enigma_vi/cel1_1" author="Johannes Laire, Jacob Scott, Raoul Bourquin, Andreas Lochmann" ctrl="force" easy="false" id="cel2007_364" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="48" _title="Polar Bears' Paradise" _xpath="enigma_vi/ral19_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20070314ral394" rel="1" rev="68" score="1" target="time" unit="duration"/>
     <level _seq="49" _title="Open Path" _xpath="enigma_vii/duffy152_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy152" rel="2" rev="2" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="51" title="Enigma 1.1 new"/>
+  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="52" title="Enigma 1.1 new"/>
 
   <attributes/>
 
@@ -170,6 +170,9 @@
     <level _seq="162" _title="Transforming Numbers" _xpath="enigma_viii/ais06_1" author="Alex Smith" ctrl="force" easy="false" id="20090406ais523002" rel="1" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="163" _title="Enigmaparcour III" _xpath="enigma_viii/mecke35_1" author="mecke" ctrl="force" easy="true" id="mecke35" rel="1" rev="9" score="1" target="time" unit="duration"/>
     <level _seq="164" _title="Mazelets" _xpath="enigma_viii/raoul34_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul34" rel="1" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="165" _title="The Sum Of Its Parts" _xpath="enigma_viii/luc36" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc362009" rel="1" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="166" _title="Missing Oxyds?" _xpath="enigma_viii/manfi01_1" author="Manfredi Carta" ctrl="force" easy="true" id="manfi01" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="167" _title="Path Through Flood" _xpath="enigma_viii/pulley24_1" author="Mark Pulley" ctrl="force" easy="false" id="20080803pulley001" rel="1" rev="1" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: trunk/data/levels/enigma_i/andreas01_2.xml
===================================================================
--- trunk/data/levels/enigma_i/andreas01_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_i/andreas01_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Lissajous" el:subtitle="" el:id="andreas01"/>
-      <el:version el:score="1" el:release="2" el:revision="4" el:status="released"/>
+      <el:version el:score="1" el:release="2" el:revision="5" el:status="released"/>
       <el:author el:name="Andreas Lochmann" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2005, 2006, 2009 Andreas Lochmann</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -46,32 +46,29 @@
 
 wo:shuffleOxyd()
 
-TICK_ANGLE1_DELTA = 360.0 * 0.1 / 7.0
-TICK_ANGLE2_DELTA = 360.0 * 0.1631 / 7.0
-
 -- coord/old_pos relate to the death stones.
 -- This initial position is that of one of the oxyd-stones,
 -- so there won't be fl-space drawn at the beginning
 coord = po({9.0, 6.0})
 angle1 = 90.0
 angle2 = 90.0
+angle1_delta = 360.0 * 0.1 / 7.0
+angle2_delta = 360.0 * 0.1631 / 7.0
 
 function lissajous_callback()
-    -- Yes, lua's sin and cos work with degree, not radian.
-    angle1 = mod(angle1 + TICK_ANGLE1_DELTA, 360.0)
-    angle2 = mod(angle2 + TICK_ANGLE2_DELTA, 360.0)
+    angle1 = math.fmod(angle1 + angle1_delta, 360.0)
+    angle2 = math.fmod(angle2 + angle2_delta, 360.0)
     -- Without the following "po" old_pos would just become a reference
     -- to coord, not a deep-copy. This would be particularly confusing,
     -- as old_pos would be the coord after the next calculation, but
     -- "grid()" breaks the memory reference, such that old_pos differs
     -- from coord but is non-integer!
     local old_pos = po(coord)
-    coord.x = 8.0 * cos(angle1) + 10.0
-    coord.y = 5.0 * sin(angle2) +  6.5
-    coord = coord:grid()
+    coord = po(8.0 * math.cos(math.rad(angle1)) + 10.0,
+               5.0 * math.sin(math.rad(angle2)) +  6.5):grid()
     move_death_stone(old_pos, coord)
     if wo["IsDifficult"] then
-      move_death_stone({19.0, 12.0} - old_pos, {19.0, 12.0} - coord)
+        move_death_stone({19.0, 12.0} - old_pos, {19.0, 12.0} - coord)
     end
 end
 

Modified: trunk/data/levels/enigma_i/andreas12_2.xml
===================================================================
--- trunk/data/levels/enigma_i/andreas12_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_i/andreas12_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Lissajous' Revenge" el:subtitle="" el:id="andreas12"/>
-      <el:version el:score="1" el:release="2" el:revision="3" el:status="released"/>
+      <el:version el:score="1" el:release="2" el:revision="6" el:status="released"/>
       <el:author  el:name="Andreas Lochmann" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2005, 2009 Andreas Lochmann</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -22,19 +22,14 @@
 ti["~"] = {"fl_water"}
 ti["."] = {"fl_swamp"}
 ti["#"] = {"st_purplegray"}
-ti["1"] = {"st_oxyd", flavor = "b", oxydcolor = OXYD_GREEN}
-ti["2"] = {"st_oxyd", flavor = "b", oxydcolor = OXYD_BLUE}
-ti["3"] = {"st_oxyd", flavor = "b", oxydcolor = OXYD_CYAN}
-ti["4"] = {"st_oxyd", flavor = "b", oxydcolor = OXYD_PURPLE}
+ti["1"] = {"st_oxyd", flavor = "b", oxydcolor = OXYD_GREEN} .. ti["."]
+ti["2"] = {"st_oxyd", flavor = "b", oxydcolor = OXYD_BLUE} .. ti["."]
+ti["3"] = {"st_oxyd", flavor = "b", oxydcolor = OXYD_CYAN} .. ti["."]
+ti["4"] = {"st_oxyd", flavor = "b", oxydcolor = OXYD_PURPLE} .. ti["."]
 ti["T"] = {"st_timer", target = "spin_gravity", interval = 0.1}
 ti["@"] = {"ac_marble", 0, 0.5, adhesion = 1}
+ti["-"] = cond(wo["IsDifficult"], ti["~"], ti["."])
 
-if wo["IsDifficult"] then
-  ti["-"] = ti["~"]
-else
-  ti["-"] = ti["."]
-end
-
 w, h = wo(ti, " ",
        {"T###################",
         "#~~..............~~#",
@@ -52,18 +47,17 @@
 
 wo:shuffleOxyd()
 
--- Stolen from Nat Pryce ("When Gravity Fails"), then
--- adapted for API 2.
-TICK_ANGLE1_DELTA = 360.0 * 0.1 / 2.0
-TICK_ANGLE2_DELTA = 360.0 * 0.1231 / 2.0
+-- Stolen from Nat Pryce ("When Gravity Fails"), then adapted for API 2.
 angle1 = 90.0
 angle2 = 90.0
+angle1_delta = 360.0 * 0.1 / 2.0
+angle2_delta = 360.0 * 0.1231 / 2.0
 
 function spin_gravity()
-    angle1 = mod(angle1 + TICK_ANGLE1_DELTA, 360.0)
-    angle2 = mod(angle2 + TICK_ANGLE2_DELTA, 360.0)
-    local gravity_x = cos(angle1) * 20.0
-    local gravity_y = sin(angle2) * 20.0
+    angle1 = math.fmod(angle1 + angle1_delta, 360.0)
+    angle2 = math.fmod(angle2 + angle2_delta, 360.0)
+    local gravity_x = math.cos(math.rad(angle1)) * 20.0
+    local gravity_y = math.sin(math.rad(angle2)) * 20.0
     wo["GlobalForce"] = po(gravity_x, gravity_y)
 end
 

Modified: trunk/data/levels/enigma_i/index.xml
===================================================================
--- trunk/data/levels/enigma_i/index.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_i/index.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10200" network="false" owner="Enigma Team" release="1" revision="21" title="Enigma I"/>
+  <info enigma="1.00" group="Enigma" location="10200" network="false" owner="Enigma Team" release="1" revision="22" title="Enigma I"/>
 
   <attributes/>
 
@@ -28,11 +28,11 @@
     <level _seq="20" _title="- Meditation -" _xpath="./siegfried33_2" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation1" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="21" _title="Do Not Dive" _xpath="./martin74_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin74" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="22" _title="Bendixxon" _xpath="./alain06_1" author="Alain Busser" ctrl="force" easy="false" id="alain06" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="23" _title="Lissajous" _xpath="./andreas01_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas01" rel="2" rev="4" score="1" target="time" unit="duration"/>
+    <level _seq="23" _title="Lissajous" _xpath="./andreas01_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas01" rel="2" rev="5" score="1" target="time" unit="duration"/>
     <level _seq="24" _title="Over the Ditch" _xpath="./martin78_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin78" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="25" _title="Brittle Planks" _xpath="./martin92_2" author="Martin Hawlisch" ctrl="force" easy="true" id="martin92" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="26" _title="Uhh-Steady!" _xpath="./siegfried05_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level2f" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="27" _title="Lissajous' Revenge" _xpath="./andreas12_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas12" rel="2" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="27" _title="Lissajous' Revenge" _xpath="./andreas12_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas12" rel="2" rev="6" score="1" target="time" unit="duration"/>
     <level _seq="28" _title="Mossy Paths" _xpath="./martin02_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin02" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="29" _title="No Jumping Necessary" _xpath="./duffy46_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy46" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="30" _title="- Meditation -" _xpath="./siegfried39_2" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation6" rel="2" rev="1" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_i/martin92_2.xml
===================================================================
--- trunk/data/levels/enigma_i/martin92_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_i/martin92_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -28,8 +28,8 @@
     ti["."] = ti["#"]
     ti["|"] = ti[" "]
 end
-ti["0"] = {"st_oxyd", flavor="a", name="left#"}
-ti["1"] = {"st_oxyd", flavor="a", name="right#"}
+ti["0"] = ti["#"] .. {"st_oxyd", flavor="a", name="left#"}
+ti["1"] = ti["#"] .. {"st_oxyd", flavor="a", name="right#"}
 ti["@"] = ti["#"] .. {"#ac_marble_black"}
 
 wo(ti, " ", {

Modified: trunk/data/levels/enigma_ii/welcometopack2_2.xml
===================================================================
--- trunk/data/levels/enigma_ii/welcometopack2_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_ii/welcometopack2_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -16,8 +16,8 @@
 ti["#"] = {"st_bluesand"}
 ti["O"] = {"st_oxyd"}
 if wo["IsDifficult"] then
-    ti["Q"] = {"st_quake", name="quaker"}
-    ti["T"] = {"st_timer", interval=12.5, target="quaker"}
+    ti["Q"] = {"st_quake", name="quake"}
+    ti["T"] = {"st_timer", interval=12.5, target="quake"}
 else
     ti["Q"] = ti[" "]
     ti["T"] = ti[" "]

Modified: trunk/data/levels/enigma_iii/illmind11_2.xml
===================================================================
--- trunk/data/levels/enigma_iii/illmind11_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_iii/illmind11_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Waterworld" el:subtitle="" el:id="illmind11"/>
-      <el:version el:score="2" el:release="2" el:revision="6" el:status="test"/>
+      <el:version el:score="2" el:release="2" el:revision="6" el:status="stable"/>
       <el:author el:name="illmind" el:email="support at mag-heut.net" el:homepage="http://www.mag-heut.net/"/>
       <el:copyright>Copyright ? 2003 illmind</el:copyright>
       <el:license el:type="GPL version 2" el:open="true"/>
@@ -18,6 +18,7 @@
     <el:luamain><![CDATA[
 
 wo["SlopeStrength"] = 30
+wo["ShowMoves"] = true
 
 ti[" "] = {"fl_sand"}
 ti["~"] = {"fl_water"}
@@ -33,10 +34,11 @@
 ti["F"] = ti["-"] .. {"st_death"}
 ti["G"] = ti["|"] .. {"st_death"}
 ti["H"] = ti["^"] .. {"st_death"}
-ti["O"] = {"st_oxyd", flavor = "a"}
+ti["O"] = {"st_oxyd", flavor = "a", name = "outer#"}
+ti["o"] = {"st_oxyd", flavor = "a", name = "inner#"}
 ti["P"] = {"st_stoneimpulse"}
-ti["Q"] = ti["|"] .. ti["O"]
-ti["R"] = ti["-"] .. ti["O"]
+ti["Q"] = ti["|"] .. ti["o"]
+ti["R"] = ti["-"] .. ti["o"]
 ti["S"] = {"st_swap"}
 ti["T"] = ti["~"] .. {"st_death_invisible"}
 ti["X"] = {"st_grate_cross"}
@@ -54,70 +56,81 @@
 ti["1"] = {"it_document", text = "text1"}
 ti["2"] = ti["B"] .. {"it_document", text = "text2"}
 ti["3"] = {"it_document", text = "text3"}
+ti["4"] = ti["B"] .. {"it_document", text = "text4"}
 
 if wo["IsDifficult"] then
   ti["b"] = ti[" "]
   ti["n"] = ti["v"] .. {"it_magnet", state = ON}
+  ti["I"] = ti["~"] .. {"st_death"}
+  ti["5"] = {"it_document", text = "text5"}
 else
   ti["b"] = ti["B"]
   ti["n"] = ti["v"]
+  ti["I"] = ti["~"]
+  ti["5"] = ti[" "]
 end
 
 wo(ti, " ", {
   "BBPPPPBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB",
   "BBSBBP~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~BOvmvmvmvmvmvmvmvmvB",
   "BBO BPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPh^h^h^h^h^hB",
-  "BBBBBBBBBBBBBBBBBBBB~~~~~~       ~~~~~B~~~~~~~~~X~~~~~~~~B~~~~~~~~~       e~BmvmvmvmvmvmvmvmvmvB",
+  "BBBBBBBBBBBBBBBBBBBB~~~~~~       ~~~~~B~~~~~~~~~X~~~~~~~~B~~~~~~~~~B      e~BmvmvmvmvmvmvmvmvmvB",
   "BXXXXXX            B~~~~~~ c   C ~~~~~B~~~~~~~~XOX~~~~~~~B~~~~~~~~~ ~~~~~~~~B^h^h^h^h^h^h^h^h^hB",
   "BXXXXXXeTTTTTTTTTTTB~~~~~~     C ~~~~~B~~~~~~~XSXSX~~~~~~B~~~~~~~~~ ~~~~~~~~BmvmvmvmvmvmvmvmvmvB",
-  "BXXXXXX   T   T   TB~~~~~~ 2   C ~~~~~B~~~~~~XXXOXXX~~~~~B~~~~~~~~~ ~~~~kkkkk^h^h^h^h^h^h^h^h^vB",
-  "BXSXSXX T T T T T TB~~~~~~       ~~~~~B~~~~~~~XSXSX~~~~~~B~~~~~~~~~ ~~~~k~~~BmvmvmvmvmvmvmvmvmvB",
-  "BXXXXXX T   T   T TB~~~~~~~~~~~~~~~~~~B~~~~~~~~XXX~~~~~~~B~~~~~~~~~ kkkkk~~~B^h^h^h^h^h^h^h^h^hB",
+  "BXXXXXX   T   T   TB~~~~~~ 2   C ~~~~~B~~~~~~XXXoXXX~~~~~B~~~~~~~~~ ~~~~kkkkk^h^h^h^h^h^h^h^h^vB",
+  "BXSXSXX T T T T T TB~~~~~~       ~~~~~B~~~~~~~XSXSX~~~~~~B~~~~~~~~~ kkkkk~~~BmvmvmvmvmvmvmvmvmvB",
+  "BXXXXXX T   T   T TB~~~~~~~~~~~~~~~~~~B~~~~~~~~XXX~~~~~~~B~~~~~~~~~ ~~~~~~~~B^h^h^h^h^h^h^h^h^hB",
   "B       TTTTTTTTT TB~~~~~~~~~~~~~~~~~~B~~~~~~~~~X~~~~~~~~B~~~~~~~~~ ~~~~~~~~BmvmvmvmvmvmvmvmvmvB",
   "BTTTTTTTTT        TB~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B^hgh^h^h^h^h^h^hghB",
   "B~~~~~~~~T~TTTTTTTTB~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~BHnHnHnHnHnHnHnHnHnB",
-  "BBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBBBBBBBBBBBB",
+  "BBBBBBBBB4~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBBBBBBBBBBBB",
   "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B",
   "B~       ~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~               ~B",
   "B~ B B B ~~~~~~~~~~B~~             ~~~B~~             ~~~B~~             ~~~B~~ b  b  b  b  b ~B",
-  "B~       ~~~~~~~~~~B~~ B b B B b B ~~~B~~ B B b b B B ~~~B~~  B b B b B  ~~~B~~               ~B",
-  "B~ B B B ~~~~~~~~~~B~~    1        ~~~B~~  B       B  ~~~B~~         1   ~~~B~~   ~~~~~~~~~   ~B",
-  "B~         ~~~~~~~~~~~ b b b b b b ~~~~~~ B Beb at b3B B ~~~~~~  b B b B b b~~~~~~   ~~~~~~~~~   ~B",
-  "B~ b b b b ~~~~~~~~B~~             ~~~B~~  B       B  ~~~B~~             ~~~B~~               ~B",
-  "B~         ~~~~~~~~B~~ B b B B b B ~~~B~~ B B b b B B ~~~B~~  B b B b B  ~~~B~~ B     B     B ~B",
-  "B~ B E B b ~~~~~~~~B~~             ~~~B~~             ~~~B~~             ~~~B~~               ~B",
+  "B~       ~~~~~~~~~~B~~ B b b b b B ~~~B~~ b B b b B b ~~~B~~  B b b b B  ~~~B~~               ~B",
+  "B~ B B B ~~~~~~~~~~B~~    1        ~~~B~~  b       b  ~~~B~~         1   ~~~B~~   ~~~~~~~~~   ~B",
+  "B~         ~~~~~~~~~~~ b B b b B b ~~~~~~ E b5b at b3b B ~~~~~~  b B B B b b~~~~~~   ~~~~~~~~~   ~B",
+  "B~ B B B B ~~~~~~~~B~~             ~~~B~~  b       b  ~~~B~~             ~~~B~~               ~B",
+  "B~         ~~~~~~~~B~~ B b b b b B ~~~B~~ b B b b B b ~~~B~~  B b b b B  ~~~B~~ B     b     B ~B",
+  "B~ B E B B ~~~~~~~~B~~             ~~~B~~             ~~~B~~             ~~~B~~               ~B",
   "B~         ~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B",
   "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~rB",
-  "BBBBBBBBBBBBBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBB",
-  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~ B",
-  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~      ~B~~~~~~~~~~~~~~~~~~B~~ t ~  ~~~  ~ t ~B~kkkkkkk~~~kkkkkk~B",
-  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~ B B  ~B~~~FGFGFG-GFGFG~~~B~~~~~~  ~~~  ~~~~~B~k~~~~~k~+.k~~~~k~B",
-  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~      ~B~~~GRQ-|-|-|-QF~~~B~~ B ~  ~ ~  ~ B ~B~kkkkk~k~~~~~kkkk~B",
-  "B~TTTTTTTTTTTTTTT~~B~~~~~~~~~~~ B B  ~B~~~FfF|F|F|F|-G~~~B~~   ~       ~   ~B~~~~~k~kkkkkkk~~~~B",
-  "B~TO =========== ~~~~~~~~~~~~        ~B~~~G-|F|F|F|F|F~~~B~~~~~~       ~~~~~B~kkkkk~~~~~~~~~kkkB",
-  "B~TTTTTTTTTTTTTTT~~B~~~~~~~~~ B B B  ~B~~~FQ-|-|-|-|-G~~~B~~ B ~B     2~ B ~B~k~~~~~kkkkkkkkk~kB",
-  "B~~~~~~~~~~~~~~~~~~B~~~              ~B~~~GFGFGFGFGFGF~~~B~~~ ~~~~   ~~~~ ~~B~k~kkk~k~~~~~~~~~kB",
-  "B~~~~~~~~~~~~~~~~~~B~~~  E B  B B B  ~B~~~~~~~~~~~~~~~~~~B~~~ ~~~~   ~~~~ ~~B~k~k~k~k~ B  B  B B",
-  "B~~~~~~~~~~~~~~~~~~B~~~              ~B~~~~~~~~~~~~~~~~~~B~~~             ~~B~kkk~kkk~  B  B   B",
-  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~        OB",
+  "BBBBBBBBBBBBBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~BBBBBBBBBBBBBBBBBB~4BBBBBBBB",
+  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~BIIIIIIII~~~IIIIIIIB",
+  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~      ~B~~~~~~~~~~~~~~~~~~B~~ t ~  ~~~  ~ t ~BIkkkkkkk~~~kkkkkk~B",
+  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~ B B  ~B~~~FGFGFG-GFGFG~~~B~~~~~~  ~~~  ~~~~~BIk~~~~~k~+.k~~~~k~B",
+  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~      ~B~~~GRQ-|-|-|-QF~~~B~~ B ~  ~ ~  ~ B ~BIkkkkk~k~~~~~kkkk~B",
+  "B~TTTTTTTTTTTTTTT~~4~~~~~~~~~~~ B B  ~B~~~FfF|F|F|F|-G~~~B~~   ~       ~   ~BI~~~~k~kkkkkkk~~~~B",
+  "B~TO =========== ~~~~~~~~~~~~        ~B~~~G-|F|F|F|F|F~~~B~~~~~~       ~~~~~BIkkkkk~~~~~~~~~kkkB",
+  "B~TTTTTTTTTTTTTTT~~4~~~~~~~~~ B B B  ~B~~~FQ-|-|-|-|-G~~~B~~ B ~B     2~ B ~BIk~~~~~kkkkkkkkk~kB",
+  "B~~~~~~~~~~~~~~~~~~B~~~              ~B~~~GFGFGFGFGFGF~~~B~~~ ~~~~   ~~~~ ~~BIk~kkk~k~~~~~~~~~kB",
+  "B~~~~~~~~~~~~~~~~~~B~~~  E B  B B B  ~B~~~~~~~~~~~~~~~~~~B~~~ ~~~~   ~~~~ ~~BIk~k~k~k~ B  B  B B",
+  "B~~~~~~~~~~~~~~~~~~B~~~              ~B~~~~~~~~~~~~~~~~~~B~~~             ~~BIkkk~kkk~  B  E   B",
+  "B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~B~~~~~~~~~~~~~~~~~~BIIIIIIII~        OB",
   "BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB"})
 
-    wo:shuffleOxyd()
-    
-    ]]></el:luamain>
+    wo:shuffleOxyd({"inner#*", max = 0}, {"outer#*", max = 0})
+
+ ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">
         <el:english el:translate="false"/>
       </el:string>
       <el:string el:key="text1">
         <el:english el:translate="true">Remember  to  only  move  enough  stones  to  just  look  into  the  next  room  ...</el:english>
-      </el:string> 
+      </el:string>
       <el:string el:key="text2">
-        <el:english el:translate="true">You  have  lost  ...</el:english>
-      </el:string> 
+        <el:english el:translate="false">The  mechanism  should  not  be  exposed  to  moisture  or  water  ...</el:english>
+      </el:string>
       <el:string el:key="text3">
         <el:english el:translate="false">Welcome  to  illmind's  waterworld  ...</el:english>
-      </el:string> 
+      </el:string>
+      <el:string el:key="text4">
+        <el:english el:translate="false">Danger!  ...</el:english>
+      </el:string>
+      <el:string el:key="text5">
+        <el:english el:translate="false">Limited supplies. Mind your steps!  ...</el:english>
+      </el:string>
     </el:i18n>
   </el:protected>
 </el:level>

Modified: trunk/data/levels/enigma_iii/index.xml
===================================================================
--- trunk/data/levels/enigma_iii/index.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_iii/index.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10400" network="false" owner="Enigma Team" release="1" revision="27" title="Enigma III"/>
+  <info enigma="1.00" group="Enigma" location="10400" network="false" owner="Enigma Team" release="1" revision="28" title="Enigma III"/>
 
   <attributes/>
 
@@ -51,7 +51,7 @@
     <level _seq="43" _title="The Ditch" _xpath="./richi01_1" author="Richi B?tzer" ctrl="force" easy="false" id="richi01" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="44" _title="Rush Hour Traffic" _xpath="./duffy62_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy62" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="45" _title="The Turtle" _xpath="./ant05_1" author="Petr Machata" ctrl="force" easy="false" id="ant05" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="46" _title="Bridgebuilder" _xpath="./siegfried20_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level6b" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="46" _title="Bridgebuilder" _xpath="./siegfried20_2" author="Siegfried Fennig" ctrl="force" easy="false" id="level6b" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="47" _title="Easy Skyscraper" _xpath="./wb07_1" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb7" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="48" _title="Automatic Transmission" _xpath="./duffy60_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy60" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="49" _title="Tough Skyscraper" _xpath="./wb08_1" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb8" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_iii/nat36_2.xml
===================================================================
--- trunk/data/levels/enigma_iii/nat36_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_iii/nat36_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -35,8 +35,8 @@
     cell = maze[maze:encode(cell_vec.x, cell_vec.y)]
     for d = WEST, NORTH do
         if cell[d] then
-            wo[cell:pos() + DIRNUM2OFF[d]] = ti["="]
-            wo[cell:pos() + 2*DIRNUM2OFF[d]] = ti["t"]
+            wo[cell:pos() + ORI2DIR[d]] = ti["="]
+            wo[cell:pos() + 2*ORI2DIR[d]] = ti["t"]
         end
     end
 end

Deleted: trunk/data/levels/enigma_iii/siegfried20_1.xml
===================================================================
--- trunk/data/levels/enigma_iii/siegfried20_1.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_iii/siegfried20_1.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,111 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Bridgebuilder" el:subtitle="" el:id="level6b"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Siegfried Fennig" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Siegfried Fennig</el:copyright>
-      <el:license el:type="GPL version 2" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-levelw = 20
-levelh = 13
-
-create_world(levelw, levelh)
-draw_border("st-greenbrown")
-fill_floor("fl-wood")
-
-oxyd(2,0)
-oxyd(0,8)
-oxyd(0,11)
-oxyd(10,5)
-oxyd(19,4)
-oxyd(19,9)
-
-draw_stones("st-greenbrown", {1,1}, {0,1}, 2)
-draw_stones("st-greenbrown", {3,2}, {0,1}, 2)
-draw_stones("st-greenbrown", {5,2}, {0,1}, 2)
-draw_stones("st-greenbrown", {9,2}, {0,1}, 2)
-draw_stones("st-greenbrown", {13,5}, {0,1}, 2)
-draw_stones("st-greenbrown", {17,2}, {0,1}, 2)
-draw_stones("st-greenbrown", {18,5}, {0,1}, 2)
-draw_stones("st-greenbrown", {2,7}, {0,1}, 2)
-draw_stones("st-greenbrown", {15,5}, {0,1}, 3)
-draw_stones("st-greenbrown", {6,2}, {1,0}, 3)
-draw_stones("st-greenbrown", {11,3}, {1,0}, 2)
-draw_stones("st-greenbrown", {4,7}, {1,0}, 4)
-draw_stones("st-greenbrown", {9,7}, {1,0}, 2)
-draw_stones("st-greenbrown", {12,8}, {1,0}, 2)
-draw_stones("st-greenbrown", {1,10}, {1,0}, 16)
-set_stones("st-greenbrown", {{11,1},{14,1},{15,3},{1,4},{3,5},
-                            {5,5},{7,5},{9,5},{11,5}})
-set_stones("st-greenbrown", {{17,5},{10,8},{8,9},{15,9},{18,10}})
-
-shogundot1( 8,1,{target="bridge1" , action="openclose"})
-shogundot1(13,1,{target="bridge2" , action="openclose"})
-shogundot1( 4,3,{target="bridge3" , action="openclose"})
-shogundot1( 8,3,{target="bridge4" , action="openclose"})
-shogundot1(16,3,{target="bridge5" , action="openclose"})
-shogundot1(12,4,{target="bridge6" , action="openclose"})
-shogundot1( 2,5,{target="bridge7" , action="openclose"})
-shogundot1( 5,6,{target="bridge8" , action="openclose"})
-shogundot1( 9,6,{target="bridge9" , action="openclose"})
-shogundot1(16,6,{target="bridge10", action="openclose"})
-shogundot1( 3,7,{target="bridge11", action="openclose"})
-shogundot1(11,7,{target="bridge12", action="openclose"})
-shogundot1(14,7,{target="bridge13", action="openclose"})
-shogundot1(17,7,{target="bridge14", action="openclose"})
-shogundot1( 4,9,{target="bridge15", action="openclose"})
-shogundot1(12,9,{target="bridge16", action="openclose"})
-
-set_stone("st-shogun-s", 5,1)
-set_stone("st-shogun-s", 12,2)
-set_stone("st-shogun-s", 15,2)
-set_stone("st-shogun-s", 2,4)
-set_stone("st-shogun-s", 4,4)
-set_stone("st-shogun-s", 7,4)
-set_stone("st-shogun-s", 9,4)
-set_stone("st-shogun-s", 14,4)
-set_stone("st-shogun-s", 17,4)
-set_stone("st-shogun-s", 12,5)
-set_stone("st-shogun-s", 4,6)
-set_stone("st-shogun-s", 8,6)
-set_stone("st-shogun-s", 4,8)
-set_stone("st-shogun-s", 7,8)
-set_stone("st-shogun-s", 15,8)
-set_stone("st-shogun-s", 6,9)
-
-set_floor("fl-bridge",  1,11, {name="bridge1", type="x"})
-set_floor("fl-bridge",  2,11, {name="bridge2", type="x"})
-set_floor("fl-bridge",  3,11, {name="bridge3", type="x"})
-set_floor("fl-bridge",  4,11, {name="bridge4", type="x"})
-set_floor("fl-bridge",  5,11, {name="bridge5", type="x"})
-set_floor("fl-bridge",  6,11, {name="bridge6", type="x"})
-set_floor("fl-bridge",  7,11, {name="bridge7", type="x"})
-set_floor("fl-bridge",  8,11, {name="bridge8", type="x"})
-set_floor("fl-bridge",  9,11, {name="bridge9", type="x"})
-set_floor("fl-bridge", 10,11, {name="bridge10",type="x"})
-set_floor("fl-bridge", 11,11, {name="bridge11",type="x"})
-set_floor("fl-bridge", 12,11, {name="bridge12",type="x"})
-set_floor("fl-bridge", 13,11, {name="bridge13",type="x"})
-set_floor("fl-bridge", 14,11, {name="bridge14",type="x"})
-set_floor("fl-bridge", 15,11, {name="bridge15",type="x"})
-set_floor("fl-bridge", 16,11, {name="bridge16",type="x"})
-
-set_actor("ac-blackball", 17.5,8.5)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_iii/siegfried20_2.xml (from rev 1698, trunk/data/levels/enigma_iii/siegfried20_1.xml)
===================================================================
--- trunk/data/levels/enigma_iii/siegfried20_1.xml	2009-05-30 19:53:41 UTC (rev 1698)
+++ trunk/data/levels/enigma_iii/siegfried20_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -0,0 +1,47 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Bridgebuilder" el:subtitle="" el:id="level6b"/>
+      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Siegfried Fennig" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Siegfried Fennig</el:copyright>
+      <el:license el:type="GPL version 2" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_wood"}
+ti["#"] = {"st_greenbrown"}
+ti["S"] = {"st_shogun_s"}
+ti["dot"] = {"it_shogun_s", target="bridge%%"}
+ti["bridge"] = {"fl_bridge_bw", name="bridge%%"}
+ti["*"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(res.autotile(ti, {"a", "p", "dot"}, {"A", "P", "bridge"}), " ", {
+    "##*#################",
+    "##   S  a  # b#    #",
+    "## # #####  S  S # #",
+    "#  #c#  d# ##  #e# #",
+    "##S S  S S  f S  S *",
+    "# g# # # #*#S# # ###",
+    "#   Sh  Si   # #j ##",
+    "# #k#### ##l  m# n #",
+    "* # S  S  # ## S @ #",
+    "#   o S #   p  #   *",
+    "################# ##",
+    "*ABCDEFGHIJKLMNOP  #",
+    "####################"})
+
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_iii/welcometopack3_2.xml
===================================================================
--- trunk/data/levels/enigma_iii/welcometopack3_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_iii/welcometopack3_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -16,8 +16,8 @@
 ti["#"] = {"st_brick"}
 ti["O"] = {"st_oxyd"}
 if wo["IsDifficult"] then
-    ti["Q"] = {"st_quake", name="quaker"}
-    ti["T"] = {"st_timer", interval=15.0, target="quaker"}
+    ti["Q"] = {"st_quake", name="quake"}
+    ti["T"] = {"st_timer", interval=15.0, target="quake"}
 else
     ti["Q"] = ti["#"]
     ti["T"] = ti["#"]

Modified: trunk/data/levels/enigma_iv/duffy93_3.xml
===================================================================
--- trunk/data/levels/enigma_iv/duffy93_3.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_iv/duffy93_3.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -7,7 +7,7 @@
       <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2007 Jacob Scott</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10" el:engine="oxyd1"/>
+      <el:compatibility el:enigma="1.10"/>
       <el:modes el:easy="false" el:single="true" el:network="false"/>
       <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
       <el:score el:easy="-" el:difficult="-"/>
@@ -27,7 +27,7 @@
 ti[">"] = {"st_oneway", orientation=EAST}
 ti["V"] = {"st_oneway", orientation=SOUTH}
 ti["<"] = {"st_oneway", orientation=WEST}
-ti["."] = {"it_seed"}
+ti["."] = {"it_seed_hay"}
 ti["O"] = {"st_oxyd", oxydcolor=OXYD_BLUE}
 ti["@"] = {"ac_marble_black", 0.0, 0.5}
 

Modified: trunk/data/levels/enigma_iv/index.xml
===================================================================
--- trunk/data/levels/enigma_iv/index.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_iv/index.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10500" network="false" owner="Enigma Team" release="1" revision="40" title="Enigma IV"/>
+  <info enigma="1.00" group="Enigma" location="10500" network="false" owner="Enigma Team" release="1" revision="41" title="Enigma IV"/>
 
   <attributes/>
 
@@ -93,7 +93,7 @@
     <level _seq="85" _title="Bad Nightmare" _xpath="./duffy117_3" author="Jacob Scott" ctrl="force" easy="true" id="duffy117" rel="3" rev="5" score="2" target="time" unit="duration"/>
     <level _seq="86" _title="Laser Games" _xpath="./mp03_1" author="moonpearl" ctrl="force" easy="false" id="mp03" rel="1" rev="10" score="1" target="time" unit="duration"/>
     <level _seq="87" _title="Worse Nightmare" _xpath="./duffy124_3" author="Jacob Scott" ctrl="force" easy="true" id="duffy124" rel="3" rev="5" score="2" target="time" unit="duration"/>
-    <level _seq="88" _title="Squaring the Circle" _xpath="./nat16_2" author="Nat Pryce" ctrl="force" easy="true" id="nat16" rel="2" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="88" _title="Squaring the Circle" _xpath="./nat16_2" author="Nat Pryce" ctrl="force" easy="true" id="nat16" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="89" _title="Pain" _xpath="./ant27_1" author="Petr Machata" ctrl="force" easy="false" id="ant27" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="90" _title="Drunkard's Walk" _xpath="./duffy105_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy105" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="91" _title="Magritte" _xpath="./nat37_1" author="Nat Pryce" ctrl="force" easy="false" id="natmaze6" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_iv/nat16_2.xml
===================================================================
--- trunk/data/levels/enigma_iv/nat16_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_iv/nat16_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Squaring the Circle" el:subtitle="" el:id="nat16"/>
-      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
+      <el:version el:score="1" el:release="2" el:revision="3" el:status="released"/>
       <el:author  el:name="Nat Pryce" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2003 Nat Pryce</el:copyright>
       <el:license el:type="GPL version 2" el:open="true"/>
@@ -41,7 +41,7 @@
 local theta = 2.0*math.pi/number
 local segment = 2.0*radius*math.sin(theta/2.0)
 for i=0, number-1 do
-    wo[no["blackball"] + po(0.0, 0.5) + po(radius*math.cos(i*theta), radius*math.sin(i*theta))] = {"ac_killer", name="killer#"}
+    wo[no["blackball"] + po(0.0, 0.5) + po(radius*math.cos(i*theta), radius*math.sin(i*theta))] = {"ac_killer", name="killer#", adhesion=1.0}
 end
 local killers = no["killer#*"]:sort("circular")
 for i=0, #killers-1 do

Modified: trunk/data/levels/enigma_iv/welcometopack4_2.xml
===================================================================
--- trunk/data/levels/enigma_iv/welcometopack4_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_iv/welcometopack4_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -16,8 +16,8 @@
 ti["#"] = {"st_redbrown"}
 ti["O"] = {"st_oxyd"}
 if wo["IsDifficult"] then
-    ti["Q"] = {"st_quake", name="quaker"}
-    ti["T"] = {"st_timer", interval=17.5, target="quaker"}
+    ti["Q"] = {"st_quake", name="quake"}
+    ti["T"] = {"st_timer", interval=17.5, target="quake"}
 else
     ti["Q"] = ti[" "]
     ti["T"] = ti[" "]

Deleted: trunk/data/levels/enigma_v/duffy23_1.xml
===================================================================
--- trunk/data/levels/enigma_v/duffy23_1.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_v/duffy23_1.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,83 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Shrinking Pits" el:subtitle="" el:id="duffy23"/>
-      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
-      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-rooms_wide=2
-rooms_high=1
-
-levelw=1+(19*rooms_wide)
-levelh=1+(12*rooms_high)
-
-create_world( levelw, levelh)
-
-fill_floor("fl-bluegreen", 0,0,levelw,levelh)
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-        if c =="#" then
-            set_stone( "st-greenbrown", i-1, line)
-        elseif c == "o" then
-            oxyd( i-1, line)
-        elseif c == "!" then
-            fill_floor("fl-water", i-1,line, 1,1)
-        elseif c=="+" then
-            set_stone( "st-wood", i-1, line)
-        elseif c == "r" then
-            set_stone("st-bolder-e", i-1,line)
-        elseif c=="g" then
-            draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
-        elseif c=="l" then
-            oneway(i-1,line, enigma.WEST)
-        elseif c=="w" then
-            set_actor("ac-whiteball-small", i-1,line, {player=0})
-        elseif c=="H" then
-            hollow(i-1,line)
-        elseif c=="$" then
-            hollow(i-1,line)
-            draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
-        end
-    end
-end
-
--- Floor:  " "
--- Border: "#"
--- Oxyd:   "o"
-
-renderLine(00,"#######################################")
-renderLine(01,"# gggg#gggggg#gggg l                  #")
-renderLine(02,"# gHg +  $Hg +  Hg l  w   w   w   w   #")
-renderLine(03,"# g gg#ggg gg#gg g l                  #")
-renderLine(04,"###+######+#####+###                  #")
-renderLine(05,"#gg gg#ggg gg#gg g l    w   w   w     #")
-renderLine(06,"# g$g +  $H  + gHg l                  #")
-renderLine(07,"# gggg#g gggg#gg g l                  #")
-renderLine(08,"#+######+#######+###      w   w       #")
-renderLine(09,"#     #g gggg#gg g l                  #")
-renderLine(10,"#g $gg#ggH$  + gHg l w              w #")
-renderLine(11,"#g g  + ggggg#gggg l        w         #")
-renderLine(12,"#######################################")
-
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_v/duffy23_2.xml (from rev 1698, trunk/data/levels/enigma_v/duffy23_1.xml)
===================================================================
--- trunk/data/levels/enigma_v/duffy23_1.xml	2009-05-30 19:53:41 UTC (rev 1698)
+++ trunk/data/levels/enigma_v/duffy23_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -0,0 +1,46 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Shrinking Pits" el:subtitle="" el:id="duffy23"/>
+      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
+      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_bluegreen"}
+ti["#"] = {"st_greenbrown"}
+ti["X"] = {"st_grate", flavor="cross"}
+ti["<"] = {"st_oneway", orientation=WEST}
+ti["+"] = {"st_box"}
+ti["o"] = {"it_meditation_hollow"}
+ti["O"] = ti["X"] .. ti["o"]
+ti["@"] = {"#ac_pearl"}
+
+wo(ti, " ", {
+    "#######################################",
+    "# XXXX#XXXXXX#XXXX <                  #",
+    "# XoX +  OoX +  oX <  @   @   @   @   #",
+    "# X XX#XXX XX#XX X <                  #",
+    "###+######+#####+###                  #",
+    "#XX XX#XXX XX#XX X <    @   @   @     #",
+    "# XOX +  Oo  + XoX <                  #",
+    "# XXXX#X XXXX#XX X <                  #",
+    "#+######+#######+###      @   @       #",
+    "#     #X XXXX#XX X <                  #",
+    "#X OXX#XXoO  + XoX < @              @ #",
+    "#X X  + XXXXX#XXXX <        @         #",
+    "#######################################"})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_v/index.xml
===================================================================
--- trunk/data/levels/enigma_v/index.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_v/index.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10600" network="false" owner="Enigma Team" release="1" revision="38" title="Enigma V"/>
+  <info enigma="1.00" group="Enigma" location="10600" network="false" owner="Enigma Team" release="1" revision="39" title="Enigma V"/>
 
   <attributes/>
 
@@ -15,7 +15,7 @@
     <level _seq="7" _title="Moving Puzzles" _xpath="./luc13_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc13" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Spiders" _xpath="./ant26_1" author="Petr Machata" ctrl="force" easy="false" id="ant26" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="9" _title="Table Hockey" _xpath="./capkoh01_1" author="capkoh" ctrl="force" easy="false" id="capkoh01" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="10" _title="Shrinking Pits" _xpath="./duffy23_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy23" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="10" _title="Shrinking Pits" _xpath="./duffy23_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy23" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="11" _title="The Prison" _xpath="./martin30_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin30" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="12" _title="Jesusbond" _xpath="./richi02_1" author="Richi B?tzer" ctrl="force" easy="false" id="richi02" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="13" _title="Sentry Duty" _xpath="./nat25_1" author="Nat Pryce" ctrl="force" easy="true" id="nat25" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_v/raoul12_2.xml
===================================================================
--- trunk/data/levels/enigma_v/raoul12_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_v/raoul12_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -16,12 +16,9 @@
       <el:score el:easy="-" el:difficult="1:10"/>
     </el:info>
     <el:luamain><![CDATA[
-wo["ConserveLevel"] = true
-
 ti[" "] = {"fl_dark"}
 ti["."] = {"fl_abyss"}
 ti["#"] = {"st_rawglass"}
-ti["O"] = {"st_oxyd"}
 ti["P"] = {"st_puzzle_blue", cluster=1}
 ti["1"] = {"st_switch_white", target="permute", _tag=1}
 ti["2"] = {"st_switch_white", target="permute", _tag=2}
@@ -31,53 +28,49 @@
 ti["6"] = {"st_switch_white", target="permute", _tag=6}
 ti["7"] = {"st_switch_white", target="permute", _tag=7}
 ti["?"] = {"st_puzzle_yellow", intensity = 4/5, cluster=1}
+ti["O"] = {"st_oxyd"}
 ti["@"] = {"#ac_marble_black"} .. ti({"it_yinyang"})
 ti["B"] = {"#ac_marble_white"} .. ti({"it_yinyang"})
 
-puzz = res.puzzle(ti,"?")
+wo(res.puzzle(ti,"?"), " ", {
+    "#######O#######",
+    "#     PPP     #",
+    "#      P      #",
+    "#     PPP     #",
+    "#      P      #",
+    "#P  P??P??P  P#",
+    "OPPPPP???PPPPPO",
+    "#P P ??P??P  P#",
+    "#      PP     #",
+    "#     PP      #",
+    "#      P    @ #",
+    "#     PPP     #",
+    "#######O#######",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "...............",
+    "..###########..",
+    "..#         #..",
+    "..# B       #..",
+    "..#  1   3  #..",
+    "..#   567   #..",
+    "..#  2   4  #..",
+    "..#         #..",
+    "..#         #..",
+    "..###########..",
+    "...............",
+    "..............."})
 
-w, h = wo(puzz, " ", {
-"#######O#######",
-"#     PPP     #",
-"#      P      #",
-"#     PPP     #",
-"#      P      #",
-"#P  P??P??P  P#",
-"OPPPPP???PPPPPO",
-"#P P ??P??P  P#",
-"#      PP     #",
-"#     PP      #",
-"#      P    @ #",
-"#     PPP     #",
-"#######O#######",
-
-"...............",
-"...............",
-"...............",
-"...............",
-"...............",
-"...............",
-"...............",
-"...............",
-"...............",
-"...............",
-"...............",
-
-"...............",
-"...............",
-"..###########..",
-"..#         #..",
-"..# B       #..",
-"..#  1   3  #..",
-"..#   567   #..",
-"..#  2   4  #..",
-"..#         #..",
-"..#         #..",
-"..###########..",
-"...............",
-"..............."
-})
-
 wo:shuffleOxyd()
 
 if wo["IsDifficult"] then

Modified: trunk/data/levels/enigma_v/welcometopack5_2.xml
===================================================================
--- trunk/data/levels/enigma_v/welcometopack5_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_v/welcometopack5_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -16,8 +16,8 @@
 ti["#"] = {"st_metal"}
 ti["O"] = {"st_oxyd"}
 if wo["IsDifficult"] then
-    ti["Q"] = {"st_quake", name="quaker"}
-    ti["T"] = {"st_timer", interval=15.0, target="quaker"}
+    ti["Q"] = {"st_quake", name="quake"}
+    ti["T"] = {"st_timer", interval=15.0, target="quake"}
 else
     ti["Q"] = ti[" "]
     ti["T"] = ti[" "]

Deleted: trunk/data/levels/enigma_vi/andreas43_2.xml
===================================================================
--- trunk/data/levels/enigma_vi/andreas43_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_vi/andreas43_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,128 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="A Cooler Spot in Hell" el:subtitle="" el:id="andreas43"/>
-      <el:version el:score="2" el:release="2" el:revision="3" el:status="released"/>
-      <el:author  el:name="Andreas Lochmann" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2006 Andreas Lochmann</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.0">
-       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-       <el:dependency el:path="lib/andreas_itemfreeze" el:id="lib/andreas_itemfreeze" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="03:33"/>
-    </el:info>
-    <el:luamain><![CDATA[
-
-levelw=39
-levelh=13
-create_world(levelw, levelh)
-
-mainfloor = "fl-bumps"  --"fl-dunes"
-abyssfloor = "fl-abyss"
-mainstone = "st-bumps"
-blockstone = "st-block"
-secondaryfloor = "fl-bumps"
-fill_floor(mainfloor, 0, 0, levelw, levelh)
-oxyd_default_flavor="a"
-
-function renderLine(line, pattern)
-  for j = 1, strlen(pattern) do
-    local c = strsub(pattern, j, j)
-    if c == " " then
-      set_floor(mainfloor, j-1, line, { secure = true })
-    elseif c == "#" then
-      set_stone(mainstone, j-1, line)
-    elseif c == "." then
-      set_floor(abyssfloor, j-1, line, { burnable = true, ignitable = true,
-                             eternal = true, secure = true, fastfire = true })
-    elseif c == "b" then
-      set_item("it-blackbomb", j-1, line)
-    elseif c == "c" then
-      set_floor(secondaryfloor, j-1, line, { secure = true })
-      set_item("it-blackbomb", j-1, line)
-    elseif c == "d" then
-      set_item("it-dynamite", j-1, line)
-    elseif c == "e" then
-      set_floor(secondaryfloor, j-1, line, { secure = true })
-      set_item("it-dynamite", j-1, line)
-    elseif c == "T" then
-      set_stone(blockstone, j-1, line)
-    elseif c == "-" then
-      set_item("it-burnable_oil", j-1, line)
-    elseif c == "O" then
-      oxyd(j-1, line)
-    elseif c == "K" then
-      set_stone("st-knight", j-1, line)
-    elseif c == "s" then
-      set_item("it-sword", j-1, line)
-    elseif c == "o" then
-      set_actor("ac-blackball", j-1 + 0.5, line + 0.5)
-    elseif c == "I" then
-      set_itemfreeze(j-1, line)
-    elseif c == "J" then
-      set_floor(secondaryfloor, j-1, line, { secure = true })
-      set_itemfreeze(j-1, line)
-    elseif c == "B" then
-      set_item("it-blackbomb", j-1, line)
-      set_itemfreeze(j-1, line)
-    elseif c == "C" then
-      set_floor(secondaryfloor, j-1, line, { secure = true })
-      set_item("it-blackbomb", j-1, line)
-      set_itemfreeze(j-1, line)
-    elseif c == "S" then
-      set_item("it-sword", j-1, line)
-      set_itemfreeze(j-1, line)
-    elseif c == "j" then
-      set_item("it-springboard", j-1, line)
-    elseif c == "G" then
-      set_stone("st-grate", j-1, line)
-    elseif c == "R" then
-      set_stone("st-flrock", j-1, line)
-      set_floor(secondaryfloor, j-1, line, { secure = true })
-    elseif c == "_" then
-      set_floor(secondaryfloor, j-1, line, { secure = true })
-    end
-  end
-end
-
-
---              012345678901234567890123456789012345678
-renderLine( 0, ".....#...........#....##...........##..")
-renderLine( 1, "...e__ -____.#...c.#.bI  .#######....#.")
-renderLine( 2, "#..__C..#__J ..#__J_#.   .#_____#......")
-renderLine( 3, ".....I..o.c. ..___._#. .-.#_##J_#..   .")
-renderLine( 4, ".OK .dd T.#. .._#..-.. .  #_##R__   S #")
-renderLine( 5, "... -  .b..# .#_#.  ..I.. #C___##..   .")
-renderLine( 6, "...-....s..  .#_#   b# .. #_#_##.......")
-renderLine( 7, "... .      d..#_.. .#_d.. #___#......#.")
-renderLine( 8, ".OK ... ..-..##J#.-.__d.. ##  #......#.")
-renderLine( 9, ".....  I .    __#  .._R.#    ##.....#..")
-renderLine(10, "....  db . dd ### #.__J  RR# #.....#...")
-renderLine(11, "..#. dd ...  .... I __..#..  ....##....")
-renderLine(12, ".....#......#..........................")
---              012345678901234567890123456789012345678
-
-
-itemfreeze_init(0,0,0.01)
-itemfreeze_test_for_explosion = 1
-itemfreeze_test_for_fire = 1
-itemfreeze_test_for_existence = 1
-itemfreeze_modern_fire = 1
-oxyd_shuffle()
---display.SetFollowMode(display.FOLLOW_SCROLLING)
-display.SetFollowMode(display.FOLLOW_SMOOTH)
-enigma.ConserveLevel = FALSE
-
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_vi/andreas43_3.xml (from rev 1698, trunk/data/levels/enigma_vi/andreas43_2.xml)
===================================================================
--- trunk/data/levels/enigma_vi/andreas43_2.xml	2009-05-30 19:53:41 UTC (rev 1698)
+++ trunk/data/levels/enigma_vi/andreas43_3.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -0,0 +1,66 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="A Cooler Spot in Hell" el:subtitle="" el:id="andreas43"/>
+      <el:version el:score="3" el:release="4" el:revision="7" el:status="released"/>
+      <el:author  el:name="Andreas Lochmann" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2006, 2009 Andreas Lochmann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+        <el:dependency el:path="lib/libmap" el:id="lib/libmap" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="03:33"/>
+    </el:info>
+    <el:luamain><![CDATA[
+
+wo["ConserveLevel"] = false
+wo["FollowGrid"] = false
+wo["FollowMethod"] = FOLLOW_SCROLL
+wo["CrackSpreading"] = 0
+
+ti[" "] = {"fl_pinkbumps", secure = true}
+ti["."] = {"fl_abyss", burnable = true, ignitable = true, eternal = true, secure = true, fastfire = true}
+ti[","] = {"fl_abyss", burnable = true, ignitable = true, eternal = true, secure = true, fastfire = false}
+ti["#"] = {"st_pinkbumps"}
+ti["I"] = {"st_ice"}
+ti["K"] = {"st_knight"}
+ti["O"] = {"st_oxyd", flavor = "a", oxydcolor = OXYD_RED}
+ti["P"] = {"st_plop"}
+ti["R"] = {"st_box_rock"}
+ti["-"] = {"it_burnable_oil"}
+ti["b"] = {"it_bomb_black"}
+ti["c"] = ti["b"] .. ti["."]
+ti["d"] = {"it_dynamite"}
+ti["s"] = {"it_sword"}
+ti["@"] = {"#ac_marble"}
+ti["B"] = ti["I"] .. ti["b"]
+ti["S"] = ti["I"] .. ti["s"]
+
+wo(ti, " ", {
+--       0123456789012345678901234567890123456789
+        ".....#.......,,..#....##............##..",
+        "...d    B   .#c..b.#..bI  .#######....#.",
+        "#..   ..#  I ..#  I ##.   .#     #......",
+        ".....I.. at .b. ..   . #.. .-.# ##I #..   .",
+        ".OK .dd P.#. .. #..-... .  # ##R     S #",
+        "... -  .b..# .# #.  ...I.. #B   ##..   .",
+        "...-,.,.s..  .# #   c#  .. # # ##.......",
+        "... .      d..# .. .# Bd.. #   #......#.",
+        ".OK ... ..-..##I#.-..  d.. ##  #......#.",
+        ".....  I .      #  ... R.#    ##.....#..",
+        "....  db . d  ### #.   I  RR# #.....#...",
+        "..#. dd ...dd.... I  #...#..  ....##....",
+        ".....#......#..........................."})
+
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_vi/index.xml
===================================================================
--- trunk/data/levels/enigma_vi/index.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_vi/index.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10700" network="false" owner="Enigma Team" release="1" revision="43" title="Enigma VI"/>
+  <info enigma="1.00" group="Enigma" location="10700" network="false" owner="Enigma Team" release="1" revision="44" title="Enigma VI"/>
 
   <attributes/>
 
@@ -71,8 +71,8 @@
     <level _seq="63" _title="Playing with Lasers" _xpath="./just09_1" author="JuSt" ctrl="force" easy="false" id="just09_1" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="64" _title="Rotor Guards" _xpath="./duffy144_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy144" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="65" _title="Knight's Journey" _xpath="./johannes02_1" author="Johannes Laire" ctrl="force" easy="false" id="20061210johannes313" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="66" _title="A Cooler Spot in Hell" _xpath="./andreas43_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas43" rel="2" rev="3" score="2" target="time" unit="duration"/>
-    <level _seq="67" _title="Check the light" _xpath="./just10_2" author="JuSt" ctrl="force" easy="false" id="just10" rel="2" rev="6" score="2" target="time" unit="duration"/>
+    <level _seq="66" _title="A Cooler Spot in Hell" _xpath="./andreas43_3" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas43" rel="4" rev="7" score="3" target="time" unit="duration"/>
+    <level _seq="67" _title="Check the light" _xpath="./just10_3" author="JuSt" ctrl="force" easy="false" id="just10" rel="3" rev="7" score="2" target="time" unit="duration"/>
     <level _seq="68" _title="The Passage" _xpath="./just11_1" author="JuSt" ctrl="force" easy="false" id="just11" rel="1" rev="7" score="1" target="time" unit="duration"/>
     <level _seq="69" _title="Devil's Bolder" _xpath="./just14_1" author="JuSt" ctrl="force" easy="true" id="just14" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="70" _title="Twisting by the pool" _xpath="./alain23_1" author="Alain Busser" ctrl="force" easy="true" id="alain23" rel="1" rev="0" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_vi/just10_2.xml
===================================================================
--- trunk/data/levels/enigma_vi/just10_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_vi/just10_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,136 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Check the light" el:subtitle="how to play chess with lasers" el:id="just10"/>
-      <el:version el:score="2" el:release="2" el:revision="6" el:status="released"/>
-      <el:author  el:name="JuSt" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2007 JuSt</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.00" />
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="1:17"/>
-    </el:info>
-    <el:luamain><![CDATA[
-enigma.ConserveLevel = 0
-
-create_world(21, 13)
-oxyd_default_flavor="b"
-
--- Floor Layer
-fill_floor("fl-concrete")
-draw_floor("fl-water", {1, 2}, {0, 1}, 10)
-draw_floor("fl-water", {2, 2}, {1, 0}, 5)
-draw_floor("fl-water", {5, 3}, {0, 1}, 9)
-set_floor("fl-water", 18, 5)
-draw_floor("fl-water", {2, 11}, {1, 0}, 3)
-draw_floor("fl-water", {6, 11}, {1, 0}, 12)
-set_floor("fl-wood", 7, 11)
-set_floor("fl-wood", 9, 11)
-set_floor("fl-wood", 11, 11)
-set_floor("fl-wood", 13, 11)
-set_floor("fl-bridge-open", 7, 7, {name="bridge"})
-
--- Item Layer
-set_item("it-trigger", 4, 0, {action="open", target="door1", invisible=FALSE})
-set_item("it-seed", 18, 5)
-set_item("it-trigger", 3, 8, {action="close", target="door1", invisible=FALSE})
-set_item("it-trigger", 18, 11, {action="callback", target="got_you", invisible=FALSE})
-set_item("it-document", 14, 3, {text="text1"})
-
--- Stone Layer
-oxyd(18, 0)
-oxyd(19, 1)
-oxyd(19, 2)
-oxyd(19, 3)
-draw_stones("st-stone2", {0, 0}, {0, 1}, 11)
-draw_stones("st-stone2", {1, 0}, {1, 0}, 2)
-draw_stones("st-stone2", {10, 0}, {1, 0}, 8)
-draw_stones("st-stone2", {4, 1}, {1, 0}, 2)
-draw_stones("st-stone2", {7, 1}, {1, 0}, 2)
-draw_stones("st-stone2", {10, 1}, {0, 1}, 2)
-draw_stones("st-stone2", {8, 2}, {0, 1}, 3)
-draw_stones("st-stone2", {17, 2}, {0, 1}, 3)
-draw_stones("st-stone2", {2, 3}, {0, 1}, 8)
-draw_stones("st-stone2", {4, 3}, {0, 1}, 2)
-draw_stones("st-stone2", {12, 3}, {0, 1}, 4)
-draw_stones("st-stone2", {10, 4}, {0, 1}, 4)
-draw_stones("st-stone2", {19, 4}, {0, 1}, 9)
-draw_stones("st-stone2", {4, 7}, {0, 1}, 4)
-draw_stones("st-stone2", {14, 9}, {-1, 1}, 2)
-fill_stones("st-stone2", 16, 9, 2, 2)
-draw_stones("st-stone2", {7, 10}, {1, 0}, 6)
-draw_stones("st-stone2", {0, 12}, {1, 0}, 5)
-draw_stones("st-stone2", {6, 12}, {1, 0}, 13)
-draw_stones("st-stone2", {20, 1}, {0, 1}, 12)
-set_stones("st-stone2", {{19, 0}, {2, 1}, {12, 1}, {3, 10}, {8, 7}})
-draw_stones("st-grate1", {7, 3}, {0, 1}, 5)
-set_stone("st-grate1", 7, 9)
-draw_stones("st-grate2", {18, 5}, {0, 1}, 3)
-set_stone("st-grate2", 18, 9)
-set_stone("st-grate2", 17, 8)
-set_stones("st-wood", {{5, 0}, {3, 7}, {7, 11}, {9, 11}, {11, 11}, {13, 11}})
-draw_stones("st-stoneimpulse", {6, 0}, {1, 0}, 4)
-draw_stones("st-stoneimpulse", {9, 1}, {0, 1}, 6)
-draw_stones("st-stoneimpulse", {3, 4}, {0, 1}, 3)
-set_stone("st-stoneimpulse", 4, 6)
-set_stone("st-laserswitch", 4, 5)
-set_stone("st-laser", 3, 0, {dir=SOUTH, on="1"})
-set_stone("st-laser", 1, 1, {dir=SOUTH, on="1"})
-set_stone("st-laser", 6, 1, {name="laser1", dir=SOUTH, on="1"})
-set_stone("st-laser", 7, 2, {dir=WEST, on="1"})
-set_stone("st-laser", 10, 3, {name="laser3", dir=EAST, on="1"})
-set_stone("st-laser", 8, 5, {name="laser2", dir=WEST, on="1"})
-set_stone("st-laser", 18, 10, {name="laser4", dir=NORTH, on="0"})
-set_stone("st-laser", 0, 11, {dir=EAST, on="1"})
-set_stone("st-laser", 5, 12, {dir=NORTH, on="1"})
-set_stones("st-glass", {{3, 1}, {8, 6}})
-set_stone("st-lightpassenger", 1, 3)
-set_stone("st-door", 3, 3, {name="door1", type="h"})
-set_stone("st-door_a", 18, 4, {name="door3"})
-set_stone("st-door_a", 15, 9, {name="door2"})
-set_stones("st-chess_black", {{15, 5}, {13, 7}})
-set_stone("st-pmirror", 11, 6, {movable=TRUE, transparent=FALSE, orientation="3"})
-set_stone("st-switch", 14, 10, {action="callback", target="change_floors", on="1"})
-set_stones("st-stone_break", {{17, 1}, {13, 10}, {10, 6}, {9, 7}})
-set_stone("st-timer", 20, 0, {action="callback", target="check_it", interval="0.01"})
-
--- Actor Layer
-set_actor("ac-blackball", 11.5, 1.5, {player="0", mouseforce="1"})
-
-oxyd_shuffle()
-
--- Functions
-function check_it()
-    local mystone = enigma.GetStone(5,5)
-    if mystone ~= nil then
-        local mystonekind = enigma.GetKind(mystone,"kind")
-        if mystonekind == "st-chess" then
-            SendMessage("laser3","off")
-            SendMessage("laser2","off")
-            SendMessage("bridge","close")
-        end
-    end
-end
-
-function got_you()
-    SendMessage("door3","open")
-    SendMessage("laser4","on")
-    SendMessage("laser1","off")
-    SendMessage("door2","open")
-end
-
-function change_floors()
-    fill_floor("fl-wood", 5, 3, 1, 8)
-end
-  ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-      <el:string el:key="text1">
-        <el:english el:translate="true">Ob Schachfiguren laserresistent sind?</el:english>
-      </el:string> 
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_vi/just10_3.xml (from rev 1690, trunk/data/levels/enigma_vi/just10_2.xml)
===================================================================
--- trunk/data/levels/enigma_vi/just10_2.xml	2009-05-28 22:35:28 UTC (rev 1690)
+++ trunk/data/levels/enigma_vi/just10_3.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -0,0 +1,91 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Check the light" el:subtitle="how to play chess with lasers" el:id="just10"/>
+      <el:version el:score="2" el:release="3" el:revision="7" el:status="released"/>
+      <el:author  el:name="JuSt" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2007 JuSt</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="1:17"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ConserveLevel"] = false
+
+ti[" "] = {"fl_concrete"}
+ti["~"] = {"fl_water"}
+ti["-"] = {"fl_wood"}
+ti["#"] = {"st_redmarble"}
+ti["R"] = {"st_rawglass"}
+ti["+"] = {"st_box"}
+ti["*"] = ti["-"] .. ti["+"]
+ti["C"] = {"st_chess"}
+ti["B"] = {"st_break_oxydc"}
+ti["I"] = {"st_stoneimpulse"}
+ti["X"] = {"st_grate", flavor="cross"}
+ti["G"] = {"st_grate", flavor="framed"}
+ti["M"] = {"st_mirror", orientation=VERTICAL, movable=true}
+ti["P"] = ti["~"] .. {"st_lightpassenger"}
+ti["L"] = {"st_laserswitch", target="chess"}
+ti["^"] = {"st_laser", orientation=NORTH, state=ON}
+ti[">"] = {"st_laser", orientation=EAST, state=ON}
+ti["V"] = {"st_laser", orientation=SOUTH, state=ON}
+ti["<"] = {"st_laser", orientation=WEST, state=ON}
+ti["1"] = {"st_laser", orientation=WEST, name="laser1", state=ON}
+ti["2"] = {"st_laser", orientation=EAST, name="laser2", state=ON}
+ti["3"] = {"st_laser", orientation=NORTH, name="laser3"}
+ti["="] = {"st_door", flavor="d", faces="ns", name="door1"}
+ti["D"] = {"st_door", flavor="a", name="door2#"}
+ti["S"] = {"st_switch", target="dry"}
+ti["x"] = {"fl_bridge", name="bridge"} .. ti["X"]
+ti["a"] = {"it_trigger", target="door1", action="open"}
+ti["b"] = {"it_trigger", target="door1", action="close"}
+ti["c"] = {"it_trigger", action={"open", "on"}, target={"door2#*", "laser3"}}
+ti["t"] = {"it_document", text="text1"}
+ti["s"] = ti["~"] .. ti["G"] .. {"it_seed"}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+    "###Va+IIII########O#",
+    "#V#R##V##I#@#    B O",
+    "#~~~~~~<#I#      # O",
+    "#P#=#~ X#I2 # t  # O",
+    "#~#I#~ X#I# #    #D#",
+    "#~#IL~ X1I# #  C  s#",
+    "#~#II~ XRIBM#     G#",
+    "#~#+#~ x#B#  C    G#",
+    "#~#b#~           G #",
+    "#~# #~ X      #D##G#",
+    "#~###~ ######BS ##3#",
+    ">~~~~~~*~*~*~*~~~~c#",
+    "#####^##############"})
+
+wo:shuffleOxyd()
+
+function chess(value, sender)
+    if st(sender+E):is("st_chess") then
+        no["bridge"]:close()
+        grp(no["laser1"], no["laser2"]):off()
+    end
+end
+
+function dry(value, sender)
+    sender["target"] = DEFAULT
+    wo:drawMap(ti, po(5, 3), " ", {"-","-","-","-","-","-","-","-"})
+end
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Are chess knights resistent to laser beams?</el:english>
+        <el:translation el:lang="de">Ob Schachfiguren laserresistent sind?</el:translation>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_vi/welcometopack6_2.xml
===================================================================
--- trunk/data/levels/enigma_vi/welcometopack6_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_vi/welcometopack6_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -16,8 +16,8 @@
 ti["#"] = {"st_flat"}
 ti["O"] = {"st_oxyd"}
 if wo["IsDifficult"] then
-    ti["Q"] = {"st_quake", name="quaker"}
-    ti["T"] = {"st_timer", interval=20.0, target="quaker"}
+    ti["Q"] = {"st_quake", name="quake"}
+    ti["T"] = {"st_timer", interval=20.0, target="quake"}
 else
     ti["Q"] = ti[" "]
     ti["T"] = ti[" "]

Modified: trunk/data/levels/enigma_vii/welcometopack7_2.xml
===================================================================
--- trunk/data/levels/enigma_vii/welcometopack7_2.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_vii/welcometopack7_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -19,8 +19,8 @@
 ti["#"] = {"st_rawglass"}
 ti["O"] = {"st_oxyd"}
 if wo["IsDifficult"] then
-    ti["Q"] = {"st_quake", name="quaker"}
-    ti["T"] = {"st_timer", interval=20.0, target="quaker"}
+    ti["Q"] = {"st_quake", name="quake"}
+    ti["T"] = {"st_timer", interval=20.0, target="quake"}
 else
     ti["Q"] = ti[" "]
     ti["T"] = ti[" "]

Modified: trunk/data/levels/enigma_viii/index.xml
===================================================================
--- trunk/data/levels/enigma_viii/index.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_viii/index.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="46" title="Enigma VIII"/>
+  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="47" title="Enigma VIII"/>
 
   <attributes/>
 
@@ -96,6 +96,9 @@
     <level _seq="88" _title="Transforming Numbers" _xpath="./ais06_1" author="Alex Smith" ctrl="force" easy="false" id="20090406ais523002" rel="1" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="89" _title="Enigmaparcour III" _xpath="./mecke35_1" author="mecke" ctrl="force" easy="true" id="mecke35" rel="1" rev="9" score="1" target="time" unit="duration"/>
     <level _seq="90" _title="Mazelets" _xpath="./raoul34_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul34" rel="1" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="91" _title="The Sum Of Its Parts" _xpath="./luc36" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc362009" rel="1" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="92" _title="Missing Oxyds?" _xpath="./manfi01_1" author="Manfredi Carta" ctrl="force" easy="true" id="manfi01" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="93" _title="Path Through Flood" _xpath="./pulley24_1" author="Mark Pulley" ctrl="force" easy="false" id="20080803pulley001" rel="1" rev="1" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Added: trunk/data/levels/enigma_viii/luc36.xml
===================================================================
--- trunk/data/levels/enigma_viii/luc36.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_viii/luc36.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -0,0 +1,104 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="The Sum Of Its Parts" el:id="luc362009"/>
+      <el:version el:score="1" el:release="1" el:revision="2" el:status="released"/>
+      <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 Lukas Sch?ller</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:score el:easy="2:57" el:difficult="5:00"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["FollowGrid"] = false
+wo["FollowMethod"] = FOLLOW_SCROLL
+
+ti["  "] = {"fl_dark"}
+ti["#a"] = {"st_panel", cluster=1}
+ti["#b"] = {"st_panel", cluster=2}
+ti["SS"] = {"st_swap"}
+ti["KK"] = {"st_chess"}
+if wo["IsDifficult"] then
+    ti["BB"] = {"st_brownie"}
+    ti["b*"] = {"st_brownie", "bw%%"}
+else
+    ti["BB"] = {"st_box"}
+    ti["b*"] = {"st_box", "bw%%"}
+end
+ti["HH"] = {"st_box_hay"}
+ti["LL"] = {"st_laser", name="laser", orientation=SOUTH}
+ti["SW"] = {"st_switch", target="laser"}
+ti["BX"] = {"st_break"}
+ti["D1"] = {"st_door", name="sokodoor", faces="ew"}
+ti["D2"] = {"st_door", name="wiredoor", faces="ew"}
+ti["O^"] = {"st_oneway", orientation=NORTH}
+ti["O<"] = {"st_oneway", orientation=WEST}
+ti["BD"] = {"st_dispenser"}
+ti["=*"] = {"st_door", name="cdoor%%"}
+ti["|*"] = {"st_door", name="cdoor%%", faces="ew"}
+ti["C*"] = {"st_coinslot", target="cdoor%%"}
+ti["pv"] = {"it_puller_s"}
+ti["dd"] = {"it_dynamite"}
+ti["22"] = {"it_coin"}
+ti["xx"] = {"it_cross"}
+ti["XX"] = ti["xx"] .. {"st_grate"}
+ti["x1"] = {"it_trigger", name="soko#", action="signal", target="sokocount"}
+ti["x2"] = {"it_trigger", name="wire#", action="signal", target="wirecount"}
+ti["bb"] = {"it_bomb"}
+ti["GG"] = ti["bb"] .. {"st_rawglass"}
+ti["v1"] = {"it_vortex", name="vortex1", destination="vortex2"}
+ti["v2"] = {"it_vortex", name="vortex2", destination="vortex1"}
+ti["OO"] = {"st_oxyd_d"}
+ti["@@"] = {"#ac_marble"}
+
+autoCoins = res.autotile(ti, {"C","C*"}, {"=","=*"}, {"|","|*"}, {"b","b*"})
+randomWalls = res.random(autoCoins, "##", {"#a","#b"})
+
+wo(randomWalls, "  ", {
+  -- 000102030405060708091011121314151617181920212223242526
+    "######################################################",
+    "############        ##########################    BX##",
+    "##x1x1  ####BBBBBB  ######      ########LLSW##O^##  ##",
+    "##x1x1        pv    ####    ##      ####        O<  OO",
+    "##x1x1    ##BBBBBB  ##    ########  ########  ########",
+    "############        ##  ####  OO##    ######      ####",
+    "##OO  D1      ##    ##  ####      #a    @@##  ##BB####",
+    "##################      ######SS#a#b#a    ##  ##22####",
+    "##################  ##  ##            ##  ##      ####",
+    "##########v1######  ##  ##    KK      ##      ########",
+    "######  22    ####  ##  ########    ##################",
+    "##22  b3####  ####  ##    ######    ##      ##########",
+    "######  ####  ####  ####          ####    HHbbOO######",
+    "############22##    ############  ####    ##GG########",
+    "########      ##                    xx          BD####",
+    "########  ######  ############      ####XX####XX######",
+    "########  22      ########  ############        D2dd##",
+    "########  Ca####          BBOO##########b1x2    ######",
+    "######Cb  |a  ####Cc######  ####OO##    x2b2##########",
+    "########=b##        |c  ##  ####  ##      ############",
+    "########  ####=dCd####  ##  ####  ####################",
+    "########    |e  ####Cf  ##  ####    ##########      ##",
+    "########  Ce##  ######=f##  ######  ##########  ##  ##",
+    "######Ch  ##      |g    ##  ######  ####  ####  ##  ##",
+    "########=h##=i##Cg####  |j  ######      b4####  ##  ##",
+    "########      Ci######Cj##  ############        ##  ##",
+    "############  ############=k######################v2##",
+    "##########Cl  |l            Ck########################",
+    "######################################################"})
+
+wo:add({"ot_wire", anchor1="bw%1", anchor2="bw%2"})
+wo:add({"ot_wire", anchor1="bw%3", anchor2="bw%4"})
+wo:add({"ot_counter", "sokocount", action_5="close", target_5="sokodoor", action_6="open", target_6="sokodoor"})
+wo:add({"ot_counter", "wirecount", action_1="close", target_1="wiredoor", action_2="open", target_2="wiredoor"})
+
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/luc36.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_viii/manfi01_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/manfi01_1.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_viii/manfi01_1.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -0,0 +1,117 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Missing Oxyds?" el:subtitle="" el:id="manfi01"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
+      <el:author  el:name="Manfredi Carta" el:email=""/>
+      <el:copyright>Copyright ? 2009 Manfredi Carta</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:credits>Thanks to the level editors for their kind help.</el:credits>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="5:36"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_himalaya"}
+ti["."] = {"fl_lawn"}
+ti["~"] = {"fl_water"}
+ti["#"] = {"st_redbrown"}
+ti["X"] = {"st_redbrown_hollow"}
+ti["B"] = {"st_redbrown_movable"}
+ti["y"] = ti["."] .. {"st_redbrown_hollow"}
+ti["b"] = ti["."] .. {"st_redbrown_movable"}
+ti["G"] = ti["."] .. {"st_rawglass"}
+ti["T"] = ti["~"] .. {"st_rawglass"}
+ti["C"] = {"st_ghost_break"}
+ti["F"] = {"st_quake"}
+ti["E"] = ti["."] .. {"st_quake"}
+ti["+"] = ti["."] .. {"st_box"}
+ti["A"] = ti["X"] .. {"fl_slope", slope=SOUTH}
+ti["a"] = ti["X"] .. {"fl_slope", slope=SOUTHEAST}
+ti["w"] = ti["X"] .. {"fl_slope", slope=SOUTHWEST}
+ti["q"] = {"it_seed"}
+ti["L"] = ti["q"] .. {"st_oneway", orientation=WEST}
+ti["U"] = ti["."] .. {"st_oneway", orientation=NORTH}
+ti["e"] = {"st_door", name="door_e#", faces="ew"}
+ti["*"] = {"st_timer"}
+ti["m"] = ti["X"] .. {"it_hammer"}
+ti["k"] = ti["."] .. {"it_cherry"}
+ti["Q"] = ti["X"] .. {"it_cherry"}
+ti["H"] = ti["+"] .. {"it_seed"}
+ti["s"] = ti["y"] .. {"it_seed"}
+ti["J"] = ti["E"] .. {"it_cherry"}
+ti["p"] = ti["U"] .. {"it_brush"}
+ti["D"] = ti["."] .. {"it_document", text="text1"}
+ti["z"] = ti["y"] .. {"it_document", text="text2"}
+ti["t"] = ti["."] .. {"it_trigger", target="lastdoor"}
+ti["%"] = ti["."] .. {"st_door", name="lastdoor", faces="ew"}
+ti["I"] = {"st_oxyd"}
+ti["O"] = {"st_oxyd", name="start#"}
+ti["P"] = {"st_oxyd", name="glass#"}
+ti["@"] = {"#ac_marble_black"}
+if wo["IsDifficult"] then
+    ti["j"] = ti["."]
+    ti["d"] = {"st_door", "door_d#", faces="ew"}
+    ti["?"] = {"st_timer", interval=1.3, target="door_d#*", action="signal"}
+    ti["$"] = {"st_timer", interval=1.3, target="door_e#*", action="signal", inverse=true}
+else
+    ti["j"] = ti["k"]
+    ti["d"] = ti["e"]
+    ti["?"] = ti["*"]
+    ti["$"] = {"st_timer", interval=1.3, target="door_e#*", action="signal", inverse=false}
+end
+
+wo(ti, " ", {
+    "#########################################",
+    "#######?    $#######..#.....#...#.....###",
+    "#Oe d e      d e dO#..................###",
+    "#######      #######..~~~#~~~~~~#~~~+.###",
+    "#######      #######..~......#.....~.+###",
+    "#######      ########.~.#~~~~~~~~~.~+.###",
+    "#Od e d   @  e d eFBD.~.~....t...~#~.+%a#",
+    "#######      #######..~.~~~~~~~~~~.~+.#A#",
+    "#######      #mXXX##.#~......#.....~.H#A#",
+    "#######      ####X##..#~~~~~~~~~~~~~+.#A#",
+    "#Ie dCe      d e dO#.............#....#A#",
+    "##XBX##*    *#######.......#........#.#A#",
+    "###Q#########XXXXX#########s###########A#",
+    "#..~..~~...~.b~~~..yy.y~#.y.y~y.s~#.y.#A#",
+    "#.~#~.X..~~~~.....~#~#~y~y~#.#.#~y.y~y#A#",
+    "#.~~~p~TTTTTTT~~~~~##~#~s.#~s~y~#~#~#.#A#",
+    "#.~TTG~Tk...jT~TTT~#.y.#~#~y~y~#.#~y.y#A#",
+    "#.~T..~T.P.P.T~~~T~#y~s.y.y.#.#~#~y~#~#A#",
+    "Xb~T.~~T..J..G...G.#~#~#~#~#~s.y.#.#.zLw#",
+    "X.~T...G.J.P.T~~~T.#y~y.y.y~#~#~y~y~y~###",
+    "#.~TTT~Tj...kT~TTT.#.#.#~#.#.y~#.#.#.y###",
+    "#.~...~TTTTTTT~~~~.#s~y~y.y~y~y~s~y~#.###",
+    "#.~.~.~~~~~~~.X....#.y.#.#~#.#.#.#.y~y###",
+    "#..b~.........~~#~~##~#~y~y.s~y.y~#.s.###",
+    "#########################################"})
+
+wo:shuffleOxyd({"glass#*", max=0}, {"start#*", min=1})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="true"/>
+        <el:translation el:lang="de">Fehlende Oxyds?</el:translation>
+        <el:translation el:lang="it">Oxyds Mancanti?</el:translation>
+        <el:translation el:lang="fr">Oxyds Manqants?</el:translation>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Not everything is as it seems ...</el:english>
+        <el:translation el:lang="de">Nicht alles ist wie es scheint ...</el:translation>
+        <el:translation el:lang="it">Non tutto ? come sembra ...</el:translation>
+        <el:translation el:lang="fr">Pas tout n'est comme il semble ...</el:translation>
+      </el:string>
+      <el:string el:key="text2">
+        <el:english el:translate="true">Make sure you find all of them</el:english>
+        <el:translation el:lang="de">Pass auf, dass du alle findest</el:translation>
+        <el:translation el:lang="it">Accertati di trovarli tutti</el:translation>
+        <el:translation el:lang="fr">Assure-toi de tous trouver</el:translation>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/manfi01_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_viii/pulley24_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pulley24_1.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/enigma_viii/pulley24_1.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -0,0 +1,61 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Path Through Flood" el:subtitle="" el:id="20080803pulley001"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
+      <el:author  el:name="Mark Pulley" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2008 Mark Pulley</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="6:24"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["FollowGrid"] = false
+wo["FollowMethod"] = FOLLOW_SCROLL
+
+ti[" "] = {"fl_sand"}
+ti["~"] = {"fl_water", "StartFlood", interval=0.1}
+ti["-"] = {"fl_rough", floodable=true}
+ti["#"] = {"st_redbrown"}
+ti["A"] = {"st_greenbrown"}
+ti["h"] = {"st_box_hay"}
+ti["r"] = {"st_box_rock"}
+ti["H"] = ti["-"] .. {"st_box_hay"}
+ti["N"] = ti["H"] .. {"it_seed_greenbrown"}
+ti["S"] = ti["H"] .. {"it_seed"}
+ti["V"] = ti["H"] .. {"it_seed_volcano"}
+ti["B"] = ti["H"] .. {"it_key", code="1"}
+ti["!"] = {"st_switch", target="StartFlood"}
+ti["K"] = {"st_key", code="1", target="Door1"}
+ti["|"] = {"st_door_a", name="Door1"}
+ti["O"] = {"st_oxyd"}
+ti["*"] = cond(wo["CreatingPreview"], ti["-"] .. {"ac_marble_black", 0.0, 0.5}, ti["-"])
+ti["@"] = cond(wo["CreatingPreview"], ti[" "], {"#ac_marble_black"})
+
+wo(ti, " ", {
+    "#       ~--NH-HV-----AH-HS-----------------------------# O",
+    "#@ r    HH-HA-----BH-HH-----HN-------------------------# O",
+    "#     r HH-----NH-AH-----HH-HA---------------------K---# O",
+    "#   r    ---AH-HA-----AH-AS-----------------    -   ---# O",
+    "#     r  HH-NH-----SH-HV-----SH       ------------- ---# O",
+    "#  r     HH-----NA-AH-----HH-HH------ ------ ----------# O",
+    "!         ---AH-HH---*-HA-AS-----------------------   -| #",
+    "#     r   HH-HV-----SA-HV-----HA----- ------ ----------# O",
+    "#  r      HH-----SH-HS-----HH-VH----- -----------------# O",
+    "#    r     ---HS-HA-----NH-AN-------- ------ ----------# O",
+    "#  r       HH-HA-----HN-AH------------   -   ----------# O",
+    "#     r    HH-----HN-AH-----VH-------------------------# O",
+    "#          -------HH-----HN-AN-------------------------# O"})
+
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/pulley24_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/data/levels/lib/natmaze.xml
===================================================================
--- trunk/data/levels/lib/natmaze.xml	2009-05-31 18:21:46 UTC (rev 1699)
+++ trunk/data/levels/lib/natmaze.xml	2009-06-01 00:33:56 UTC (rev 1700)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="library">
       <el:identity el:title="" el:id="lib/natmaze"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
       <el:author  el:name="Nat Pryce" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2002 Nat Pryce</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -19,12 +19,12 @@
 -- Maze module: maze generator and renderer for Enigma
 -- 
 
-function remove_random_element( table )
-    return tremove( table, random( 1, getn(table) ) )
+function remove_random_element( tab )
+    return table.remove(tab, random(1, #tab))
 end
 
-function random_element( table )
-    return table[random( 1, getn(table) )]
+function random_element( tab )
+    return tab[random(1, #tab)]
 end
 
 
@@ -156,10 +156,10 @@
     for y = 0, maze.height-1 do
         for x = 0, maze.width-1 do
             if y < maze.height-1 then
-                tinsert( walls, {cellx=x,celly=y,side=SOUTH} )
+                table.insert( walls, {cellx=x,celly=y,side=SOUTH} )
             end
             if x < maze.width-1 then
-                tinsert( walls, {cellx=x,celly=y,side=EAST} )
+                table.insert( walls, {cellx=x,celly=y,side=EAST} )
             end
         end
     end



From raoul at mail.berlios.de  Tue Jun  2 15:17:23 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Tue, 2 Jun 2009 15:17:23 +0200
Subject: [Enigma-game-svn] r1701 - in trunk/data/levels: enigma_iii
	enigma_viii
Message-ID: <200906021317.n52DHNqm003186@sheep.berlios.de>

Author: raoul
Date: 2009-06-02 15:17:23 +0200 (Tue, 02 Jun 2009)
New Revision: 1701

Modified:
   trunk/data/levels/enigma_iii/luc09_2.xml
   trunk/data/levels/enigma_viii/ais06_1.xml
Log:
-> Lua5.x bugfix for "Transforming numbers"
-> Direction constants for "Teamplay doors"



Modified: trunk/data/levels/enigma_iii/luc09_2.xml
===================================================================
--- trunk/data/levels/enigma_iii/luc09_2.xml	2009-06-01 00:33:56 UTC (rev 1700)
+++ trunk/data/levels/enigma_iii/luc09_2.xml	2009-06-02 13:17:23 UTC (rev 1701)
@@ -47,12 +47,12 @@
 wo:shuffleOxyd()
 
 function postinit()
-    st(no["trigger%5"]+po(-1,0)):open()
+    st(no["trigger%5"]+W):open()
 end
 
 function send_toggle(value, sender)
     if value == true then
-        gr = grp({st(sender+po(-1,0)), st(sender+NNW), st(sender+SSW)})
+        gr = grp({st(sender+W), st(sender+NNW), st(sender+SSW)})
         if sender.name == "trigger%1" then
             gr = grp({st(sender+NNW), st(sender+SSW)})
         end

Modified: trunk/data/levels/enigma_viii/ais06_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/ais06_1.xml	2009-06-01 00:33:56 UTC (rev 1700)
+++ trunk/data/levels/enigma_viii/ais06_1.xml	2009-06-02 13:17:23 UTC (rev 1701)
@@ -247,7 +247,7 @@
 function trigcall(state,caller)
     if state==false then return end
     local rs = caller._num
-    local r = strsub(rs,2,2)
+    local r = string.sub(rs,2,2)
     if r+0 <= 5 then
     -- this is one of the number's triggers
         local dg = dform[r+0]



From ral at mail.berlios.de  Wed Jun  3 01:03:43 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Wed, 3 Jun 2009 01:03:43 +0200
Subject: [Enigma-game-svn] r1702 - in trunk: data data/levels/lib src
Message-ID: <200906022303.n52N3hO0018942@sheep.berlios.de>

Author: ral
Date: 2009-06-03 01:03:33 +0200 (Wed, 03 Jun 2009)
New Revision: 1702

Modified:
   trunk/data/api2init.lua
   trunk/data/levels/lib/libmaze_2.xml
   trunk/data/levels/lib/libpento_1.xml
   trunk/data/levels/lib/libpuzzle_3.xml
   trunk/src/lua.cc
Log:
Trunk 1.1:
- resolver finalization: revert call sequence - from bottom to top
- add Lua type "resolver" for general resolvers without own identity
- make resolver argument check independent of resolver listing by adding
    a mandatory entry "_resolver"=true to metatable of resolvers
- drawBorder, drawRectangle: allow arguments "key"+"resolver" instead of
    "tile" for full usage of these methods in resolvers
- res.maze:
  - avoid multiple initialization and finalization
  - evaluate all keys by the complete subresolver chain by all renderers


Modified: trunk/data/api2init.lua
===================================================================
--- trunk/data/api2init.lua	2009-06-02 13:17:23 UTC (rev 1701)
+++ trunk/data/api2init.lua	2009-06-02 23:03:33 UTC (rev 1702)
@@ -161,7 +161,7 @@
 NEIGHBORS_8     = NEIGHBORS_4 .. NW .. SW ..SE .. NE
 NEIGHBORS_CHESS = NNE .. ENE .. ESE .. SSE .. SSW .. WSW .. WNW .. NNW
 
--- convertion direction numbers to offset vectors
+-- convertion orientation numbers to direction vectors
 ORI2DIR = {[WEST]=W, [SOUTH]=S, [EAST]=E, [NORTH]=N, [NODIR]=po(0,0)}
 
 -- essential
@@ -218,7 +218,7 @@
         -- world, resolver, (position|object|table), string, (table|map), [int]
         -- world, resolver, (position|object|table), map, [int]
         assert_type(world, "wo:drawMap self (world)", 2, "world")
-        assert_type(resolver, "wo:drawMap first argument (resolver)", 2, "tiles", "function", "table", "maze")
+        assert_bool(is_resolver(resolver), "wo:drawMap first argument is no valid resolver", 2)
         assert_type(anchor, "wo:drawMap second argument (anchor)", 2, "position", "valid object", "table")
         assert_type(arg3, "wo:drawMap third argument (ignorekey or map)", 2, "string", "map")
         local origin = po(anchor)   -- either convert or make a working position copy
@@ -286,74 +286,101 @@
                 end
             end
         end
-        -- Call resolver finalizers
-        local context = resolver
-        while type(context) == "table" do
-            local finalizer = context[2]
-            if type(finalizer) == "function" then
-                 finalizer(context) 
+        -- Call resolver finalizers from bottom to top
+        local function finalizeResolvers(context)
+            if type(context) == "table" then
+                finalizeResolvers(context[3])
+                local finalizer = context[2]
+                if type(finalizer) == "function" then
+                     finalizer(context) 
+                end
             end
-            context = context[3]
         end
+        finalizeResolvers(resolver)
     end
 )
 
 wo:_register("drawBorder", 
     function (world, arg1, arg2, arg3, arg4)
-        -- world, (position|object|table), width, height, (tile|table)
-        -- world, (position|object|table), (position|object|table), (tile|table)
+        -- world, (position|object|table), width, height, (tile|table|key, resolver)
+        -- world, (position|object|table), (position|object|table), (tile|table|key, resolver)
         assert_type(world, "wo:drawBorder self (world)", 2, "world")
         assert_type(arg1, "wo:drawBorder first argument (upperleft edge)", 2, "position", "valid object", "table")
         assert_type(arg2, "wo:drawBorder second argument (width or lowerright edge)", 2, "position", "valid object", "table", "positive integer")
         local origin = po(arg1)
-        local dest, tile
+        local dest, tile, resolver
+        local isTile = true
         if etype(arg2) == "number" then
             assert_type(arg3, "wo:drawBorder third argument (height)", 2, "positive integer")
-            assert_type(arg4, "wo:drawBorder fourth argument (tile)", 2, "tile", "table")
             dest = po(origin.x + arg2 - 1, origin.y + arg3 - 1)
             tile = arg4            
+            resolver = arg5
         else
-            assert_type(arg3, "wo:drawBorder third argument (tile)", 2, "tile", "table")
             dest = po(arg2)
             tile = arg3
+            resolver = arg4
         end
+        assert_type(tile, "wo:drawBorder tile/key argument error", 2, "tile", "table", "string")
+        if etype(tile) == "string" then
+            assert_bool(is_resolver(resolver), "wo:drawBorder resolver argument error", 2)
+            isTile = false
+        end
         for x = origin.x, dest.x do
             wo[{x, origin.y}] = tile
             if origin.y ~= dest.y then
-                wo[{x, dest.y}] = tile
+                if isTile then
+                    wo[{x, dest.y}] = tile
+                else
+                    wo[{x, dest.y}] = world:_evaluate(resolver, tile, x, dest.y)
+                end
             end
         end
         for y = origin.y + 1, dest.y -1 do
             wo[{origin.x, y}] = tile
             if origin.x ~= dest.x then
-                wo[{dest.x, y}] = tile
+                if isTile then
+                    wo[{dest.x, y}] = tile
+                else
+                    wo[{dest.x, y}] = world:_evaluate(resolver, tile, dest.x, y)
+                end
             end
         end
     end
 )
 
 wo:_register("drawRect", 
-    function (world, arg1, arg2, arg3, arg4)
-        -- world, (position|object|table), width, height, (tile|table)
-        -- world, (position|object|table), (position|object|table), (tile|table)
+    function (world, arg1, arg2, arg3, arg4, arg5)
+        -- world, (position|object|table), width, height, (tile|table|key, resolver)
+        -- world, (position|object|table), (position|object|table), (tile|table|key, resolver)
         assert_type(world, "wo:drawRect self (world)", 2, "world")
         assert_type(arg1, "wo:drawRect first argument (upperleft edge)", 2, "position", "valid object", "table")
         assert_type(arg2, "wo:drawRect second argument (width or lowerright edge)", 2, "position", "valid object", "table", "positive integer")
         local origin = po(arg1)
-        local dest, tile
+        local dest, tile, resolver
+        local isTile = true
         if etype(arg2) == "number" then
             assert_type(arg3, "wo:drawRect third argument (height)", 2, "positive integer")
-            assert_type(arg4, "wo:drawRect fourth argument (tile)", 2, "tile", "table")
             dest = po(origin.x + arg2 - 1, origin.y + arg3 - 1)
-            tile = arg4            
+            tile = arg4
+            resolver = arg5
         else
-            assert_type(arg3, "wo:drawRect third argument (tile)", 2, "tile", "table")
             dest = po(arg2)
             tile = arg3
+            resolver = arg4
         end
+        assert_type(tile, "wo:drawRect tile/key argument error", 2, "tile", "table", "string")
+        if etype(tile) == "string" then
+            assert_bool(is_resolver(resolver), "wo:drawRect resolver argument error", 2)
+            isTile = false
+        end
+
         for x = origin.x, dest.x do
             for y = origin.y, dest.y do
-                wo[{x, y}] = tile
+                if isTile then
+                    wo[{x, y}] = tile
+                else
+                    wo[{x, y}] = world:_evaluate(resolver, tile, x, y)
+                end
             end
         end
     end
@@ -405,6 +432,7 @@
         end
     end 
 })
+res.metatable = {_type="resolver", _resolver=true}
 
 function res.random_implementation(context, evaluator, key, x, y)
     for hit_itr, hit_pair in ipairs(context[4]) do
@@ -439,7 +467,7 @@
 function res.random(subresolver, hits, replacements)
     -- syntax: hits = key | {key, [key]*, [{key, superkey}]*}
     --         replacements = {key, [key]*, [{key, frequency}]*}
-    assert_type(subresolver, "res.random first argument (subresolver)", 2, "tiles", "function", "table", "maze")
+    assert_bool(is_resolver(subresolver), "res.random first argument (subresolver)", 2)
     assert_type(hits, "res.random second argument (hits)", 2, "non-empty string", "table")
     assert_type(hits, "res.random third argument (replacements)", 2, "string", "table")
     local hit_table = {}
@@ -478,6 +506,7 @@
     end
     local context = {res.random_implementation, nil, subresolver, hit_table, 
                      repl_table, repl_sum}
+    setmetatable(context, res.metatable)
     return context
 end
 
@@ -561,7 +590,7 @@
 function res.autotile(subresolver, ...)
     -- syntax: ... = <{prefixkey, template} | {firstkey, lastkey, template[, offset]}>
     -- context: [4] = table with unmodified rule tables
-    assert_type(subresolver, "res.autotile first argument (subresolver)", 2, "tiles", "function", "table", "maze")
+    assert_bool(is_resolver(subresolver), "res.autotile first argument (subresolver)", 2)
     local args = {...}
     for i, rule in ipairs(args) do
         assert_type(rule, "res.autotile argument " .. (i+1) .. " (rule " .. i .. ")", 2, "table")
@@ -588,6 +617,7 @@
         assert_bool(ti[rule[template_pos]], "res.autotile: Missing template tile '" .. rule[template_pos] .. "'", 2)
     end
     local context = {res.autotile_implementation, nil, subresolver, args}
+    setmetatable(context, res.metatable)
     return context
 end
 
@@ -627,7 +657,7 @@
 end
 
 function res.composer(subresolver, ...)
-    assert_type(subresolver, "res.composer first argument (subresolver)", 2, "tiles", "function", "table", "maze")
+    assert_bool(is_resolver(subresolver), "res.composer first argument (subresolver)", 2)
     local args = {...}
     local sequence = nil
     assert_bool(#args <= 1, "res.composer: Too many arguments (must be 1 or 2)." ,2)
@@ -636,6 +666,7 @@
         sequence = args[1]
     end
     local context = {res.composer_implementation, nil, subresolver, sequence}
+    setmetatable(context, res.metatable)
     return context
 end
 
@@ -653,6 +684,12 @@
     return t
 end
 
+function is_resolver(resolver)
+    local t = etype(resolver)
+    return (t == "tiles") or (t == "function") or (t == "resolver") or 
+        ((type(resolver) == "table") and getmetatable(resolver) and getmetatable(resolver)["_resolver"])
+end
+
 assert_type = function (object, objname, level, ...)
     -- assert_type throws an error if object does not fulfill one of the
     -- conditions in "...". Possible conditions are the lua- and usertype

Modified: trunk/data/levels/lib/libmaze_2.xml
===================================================================
--- trunk/data/levels/lib/libmaze_2.xml	2009-06-02 13:17:23 UTC (rev 1701)
+++ trunk/data/levels/lib/libmaze_2.xml	2009-06-02 23:03:33 UTC (rev 1702)
@@ -29,6 +29,7 @@
     local context = {res.maze_implementation, res.maze_finalization, subresolver}
     
     -- default settings
+    context.finalizing = false
     context.encode = function (maze, i, j)
             return lib.maze.MAX_WIDTH_IN_ENCODE*j + i + 100
         end
@@ -77,6 +78,7 @@
         end
     setmetatable(context,{
           _type = "maze",
+          _resolver = true,
           __index = function (context, key)
                   if type(key) == "number" and key >= 99 then
                       return rawget(context, "cells")[key]
@@ -156,7 +158,7 @@
         }
         
     -- argument evaluation
-    assert_type(subresolver, "res.maze first argument (subresolver)", 2, "tiles", "function", "table", "maze")
+    assert_bool(is_resolver(subresolver), "res.maze first argument (subresolver)", 2)
     assert_bool(#args == 1, "res.maze: wrong number of arguments - expected subresolver and a table of configuration data.", 2)
     assert_type(args[1], "res.maze second argument (libmaze configuration data)", 2, "table")
     context.area = args[1].area
@@ -202,7 +204,7 @@
 end
 
 function res.maze_implementation(context, evaluator, key, x, y)
-    if not context.rectangular then
+    if (not context.finalizing) and (not context.rectangular) then
         if not context.area_args_separated then 
             for k,v in pairs(context.area) do
                 if #v == #key then
@@ -231,6 +233,8 @@
 end
 
 function res.maze_finalization(context)
+    if context.finalizing then return end
+    context.finalizing = true
     local maze = context
     if maze.rectangular then
         for i = 0, maze.area[2] - 1 do
@@ -414,53 +418,53 @@
     for cell in maze do
         local anchor = cell:pos()
         if map then
-            wo:drawMap(ti, anchor, map_kernel)
+            wo:drawMap(maze[3], anchor, map_kernel)
             if cell[EAST] ~= nil then
-                wo:drawMap(ti, anchor + {maze.kernel[1], 0}, map_spacing_y)
+                wo:drawMap(maze[3], anchor + {maze.kernel[1], 0}, map_spacing_y)
             end
             if cell[SOUTH] ~= nil then
-                wo:drawMap(ti, anchor + {0, maze.kernel[2]}, map_spacing_x)
+                wo:drawMap(maze[3], anchor + {0, maze.kernel[2]}, map_spacing_x)
                 if cell[EAST] ~= nil and (cell:neighbor(EAST))[SOUTH] ~= nil
                                 and (cell:neighbor(SOUTH))[EAST] ~= nil then
-                    wo:drawMap(ti, anchor + {maze.kernel[1], maze.kernel[2]}, map_spacing_z)
+                    wo:drawMap(maze[3], anchor + {maze.kernel[1], maze.kernel[2]}, map_spacing_z)
                 end
             end
         else
             if args[3] then
-                wo:drawRect(anchor, maze.kernel[1], maze.kernel[2], ti[args[3]])
+                wo:drawRect(anchor, maze.kernel[1], maze.kernel[2], args[3], maze[3])
             end
             if args[2] then
                 if cell[EAST] ~= nil then
                     wo:drawRect(anchor + {maze.kernel[1], 0}, maze.spacing[1], 
-                        maze.kernel[2], ti[args[2]])
+                        maze.kernel[2], args[2], maze[3])
                 end
                 if cell[SOUTH] ~= nil then
                     wo:drawRect(anchor + {0, maze.kernel[2]}, 
-                        maze.kernel[1], maze.spacing[2], ti[args[2]])
+                        maze.kernel[1], maze.spacing[2], args[2], maze[3])
                     if cell[EAST] ~= nil and (cell:neighbor(EAST))[SOUTH] ~= nil
                             and (cell:neighbor(SOUTH))[EAST] ~= nil then
                         wo:drawRect(anchor + {maze.kernel[1], maze.kernel[2]}, maze.spacing[1], 
-                            maze.spacing[2], ti[args[2]])
+                            maze.spacing[2], args[2], maze[3])
                     end
                 end
             end
         end
         if cell[EAST] == true then
             wo:drawRect(anchor + {maze.kernel[1], maze.kernel[2]/2}, 
-                    maze.spacing[1], 1, ti[passage_open])
+                    maze.spacing[1], 1, passage_open, maze[3])
         end
         if cell[SOUTH] == true then
             wo:drawRect(anchor + {maze.kernel[1]/2, maze.kernel[2]}, 
-                    1, maze.spacing[2], ti[passage_open])
+                    1, maze.spacing[2], passage_open, maze[3])
         end
         if passage_closed then
             if cell[EAST] == false then
                 wo:drawRect(anchor + {maze.kernel[1], maze.kernel[2]/2}, 
-                        maze.spacing[1], 1, ti[passage_closed])
+                        maze.spacing[1], 1, passage_closed, maze[3])
             end
             if cell[SOUTH] == false then
                 wo:drawRect(anchor + {maze.kernel[1]/2, maze.kernel[2]}, 
-                        1, maze.spacing[2], ti[passage_closed])
+                        1, maze.spacing[2], passage_closed, maze[3])
             end
         end
     end
@@ -478,10 +482,10 @@
     for cell in maze do
         local anchor = cell:pos()
         if map then
-            wo:drawMap(ti, anchor, map_kernel)
+            wo:drawMap(maze[3], anchor, map_kernel)
         else
             if args[1] then
-                wo:drawRect(anchor, maze.kernel[1], maze.kernel[2], ti[args[1]])
+                wo:drawRect(anchor, maze.kernel[1], maze.kernel[2], args[1], maze[3])
             end
         end
         -- TODO extend logic to arbitrary kernel size in the following lines
@@ -515,10 +519,10 @@
     for cell in maze do
         local anchor = cell:pos()
         if map then
-            wo:drawMap(ti, anchor, map_spacing)
+            wo:drawMap(maze[3], anchor, map_spacing)
         else
             if args[1] then
-                wo:drawRect(anchor, maze.spacing[1], maze.spacing[2], ti[args[1]])
+                wo:drawRect(anchor, maze.spacing[1], maze.spacing[2], args[1], maze[3])
             end
         end
         local connections = ""

Modified: trunk/data/levels/lib/libpento_1.xml
===================================================================
--- trunk/data/levels/lib/libpento_1.xml	2009-06-02 13:17:23 UTC (rev 1701)
+++ trunk/data/levels/lib/libpento_1.xml	2009-06-02 23:03:33 UTC (rev 1702)
@@ -107,7 +107,7 @@
     -- syntax: ... = <sourcebasename>, <targetbasename>
     -- context: 
     local args = {...}
-    assert_type(subresolver, "res.pento first argument (subresolver)", 2, "tiles", "function", "table", "maze")
+    assert_bool(is_resolver(subresolver), "res.pento first argument (subresolver)", 2)
     assert_type(args[1], "res.pento second argument (source basename)", 2, "string")
     assert_type(args[2], "res.pento third argument (target basename)", 2, "string")
     local autotile = res.autotile(subresolver, {"O","Z", "pentopuzzle"})
@@ -122,6 +122,7 @@
         MAP_MIRROR_SLASH}
     context.mirrors = {MAP_MIRROR_HORIZONTAL, MAP_MIRROR_SLASH, MAP_MIRROR_VERTICAL,
         MAP_MIRROR_BACKSLASH, MAP_ROT_CCW, MAP_IDENT, MAP_ROT_CW, MAP_ROT_180}
+    setmetatable(context, res.metatable)
     return context
 end
 

Modified: trunk/data/levels/lib/libpuzzle_3.xml
===================================================================
--- trunk/data/levels/lib/libpuzzle_3.xml	2009-06-02 13:17:23 UTC (rev 1701)
+++ trunk/data/levels/lib/libpuzzle_3.xml	2009-06-02 23:03:33 UTC (rev 1702)
@@ -180,7 +180,7 @@
 function res.puzzle(subresolver, ...)
     -- syntax: ... = <prefixkey>
     -- context: [4] = table with unmodified rule tables
-    assert_type(subresolver, "res.puzzle first argument (subresolver)", 2, "tiles", "function", "table", "maze")
+    assert_bool(is_resolver(subresolver), "res.puzzle first argument (subresolver)", 2)
     local args = {...}
     local length = 0
     for i, prefix in ipairs(args) do
@@ -192,6 +192,7 @@
         end
     end
     local context = {res.puzzle_implementation, res.puzzle_finalization, subresolver, args, {}}
+    setmetatable(context, res.metatable)
     return context
 end
 

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2009-06-02 13:17:23 UTC (rev 1701)
+++ trunk/src/lua.cc	2009-06-02 23:03:33 UTC (rev 1702)
@@ -2419,6 +2419,33 @@
     return 0;
 }
 
+static int finalizeResolvers(lua_State *L) {
+    // next resolver on top of stack
+    
+    // this is a recursive function - ensure enough space on the stack
+    if (lua_gettop(L) >  LUA_MINSTACK - 5)
+        lua_checkstack(L, 10);         // guarantee another 10 free slots
+    
+    if (is_table(L, -1)) {
+        lua_rawgeti(L, -1, 3);      // get subresolver at index 3
+        finalizeResolvers(L);       // finalize subresolver first 
+        lua_pop(L, 1);              // subresolver
+        
+        lua_rawgeti(L, -1, 2);      // get resolver finalization at index 2
+        if (!lua_isnil(L, -1)) {
+            lua_pushvalue(L, -2);       // duplicate table as resolver context
+            int retval=lua_pcall(L, 1, 0, 0);     // resolver(context,evaluator,key,x,y) ->  tile
+            if (retval!=0) {
+                throwLuaError(L, ecl::strf("Error within tile key resolver finalization:\n %s", 
+                        lua_tostring(L, -1)).c_str());
+                return 0;
+            }
+        } else {
+            lua_pop(L, 1);  // nil
+        }
+    }
+}
+
 static int createWorld(lua_State *L) {
     // world, resolver, default key, map
     // world, (ti|function|table), string, table
@@ -2518,23 +2545,8 @@
     }
     
     lua_getfield(L, LUA_REGISTRYINDEX, LUA_ID_RESOLVER);
-    while (is_table(L, -1)) {
-        lua_rawgeti(L, -1, 2);      // get resolver finalization at index 2
-        if (!lua_isnil(L, -1)) {
-            lua_pushvalue(L, -2);       // duplicate table as resolver context
-            int retval=lua_pcall(L, 1, 0, 0);     // resolver(context,evaluator,key,x,y) ->  tile
-            if (retval!=0) {
-                throwLuaError(L, ecl::strf("Error within tile key resolver finalization:\n %s", 
-                        lua_tostring(L, -1)).c_str());
-                return 0;
-            }
-        } else {
-            lua_pop(L, 1);  // nil
-        }
-        lua_rawgeti(L, -1, 3);      // get subresolver at index 3
-        lua_remove(L, -2);          // substitute current resolver table by subresolver
-    }
-    lua_pop(L, 1);   // final resolver
+    finalizeResolvers(L);
+    lua_pop(L, 1);           // top resolver
     
     lua_pushinteger(L, width);
     lua_pushinteger(L, height);



From ral at mail.berlios.de  Fri Jun  5 00:58:29 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Fri, 5 Jun 2009 00:58:29 +0200
Subject: [Enigma-game-svn] r1703 - in trunk: data src src/items
Message-ID: <200906042258.n54MwTc4017983@sheep.berlios.de>

Author: ral
Date: 2009-06-05 00:58:28 +0200 (Fri, 05 Jun 2009)
New Revision: 1703

Modified:
   trunk/data/api2init.lua
   trunk/src/items/ExtraLife.cc
   trunk/src/items/ExtraLife.hh
   trunk/src/items/Hammer.cc
   trunk/src/items/Hammer.hh
   trunk/src/items/SimpleItems.hh
   trunk/src/items/Sword.cc
   trunk/src/items/Sword.hh
   trunk/src/items/Umbrella.cc
   trunk/src/items/Umbrella.hh
   trunk/src/lua.cc
Log:
Trunk 1.1:
- ORI2DIR add values for NORTHWEST,...
- fix r1694: items picked up in light and dropped on position without light
    now transform on subsequent enlighting
- PositionList: add equality operator support
- it_coffee: do not explode on laser light

Modified: trunk/data/api2init.lua
===================================================================
--- trunk/data/api2init.lua	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/data/api2init.lua	2009-06-04 22:58:28 UTC (rev 1703)
@@ -162,7 +162,8 @@
 NEIGHBORS_CHESS = NNE .. ENE .. ESE .. SSE .. SSW .. WSW .. WNW .. NNW
 
 -- convertion orientation numbers to direction vectors
-ORI2DIR = {[WEST]=W, [SOUTH]=S, [EAST]=E, [NORTH]=N, [NODIR]=po(0,0)}
+ORI2DIR = {[WEST]=W, [SOUTH]=S, [EAST]=E, [NORTH]=N, [NODIR]=po(0,0),
+           [NORTHWEST]=NW, [SOUTHWEST]=SW, [SOUTHEAST]=SE, [NORTHEAST]=NE}
 
 -- essential
 DISPENSIBLE   = 0

Modified: trunk/src/items/ExtraLife.cc
===================================================================
--- trunk/src/items/ExtraLife.cc	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/items/ExtraLife.cc	2009-06-04 22:58:28 UTC (rev 1703)
@@ -72,6 +72,10 @@
         newitem->setState(server::ExtralifeGlasses);
     }
     
+    void ExtraLife::on_pickup(Actor *a) {
+        objFlags &= ~OBJBIT_LIGHT;   // forget enlighting info        
+    }
+    
     void ExtraLife::alarm() {
         objFlags &= ~OBJBIT_NEW;
         DirectionBits db = updateCurrentLightDirs();

Modified: trunk/src/items/ExtraLife.hh
===================================================================
--- trunk/src/items/ExtraLife.hh	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/items/ExtraLife.hh	2009-06-04 22:58:28 UTC (rev 1703)
@@ -47,7 +47,8 @@
         // Item interface
         virtual string get_inventory_model();
         virtual void setup_successor(Item *newitem);
-
+        virtual void on_pickup(Actor *a);
+        
         // TimeHandler interface
         virtual void alarm();
     };

Modified: trunk/src/items/Hammer.cc
===================================================================
--- trunk/src/items/Hammer.cc	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/items/Hammer.cc	2009-06-04 22:58:28 UTC (rev 1703)
@@ -59,6 +59,10 @@
         }
     }
     
+    void Hammer::on_pickup(Actor *a) {
+        objFlags &= ~OBJBIT_LIGHT;   // forget enlighting info        
+    }
+    
     void Hammer::alarm() {
         objFlags &= ~OBJBIT_NEW;
         DirectionBits db = updateCurrentLightDirs();

Modified: trunk/src/items/Hammer.hh
===================================================================
--- trunk/src/items/Hammer.hh	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/items/Hammer.hh	2009-06-04 22:58:28 UTC (rev 1703)
@@ -44,6 +44,9 @@
         virtual void on_removal(GridPos p);
         virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
 
+        // Item interface
+        virtual void on_pickup(Actor *a);
+        
         // TimeHandler interface
         virtual void alarm();
     };

Modified: trunk/src/items/SimpleItems.hh
===================================================================
--- trunk/src/items/SimpleItems.hh	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/items/SimpleItems.hh	2009-06-04 22:58:28 UTC (rev 1703)
@@ -76,7 +76,7 @@
     /**
      * Coffee
      */
-    DEF_ITEMF(Coffee, "it_coffee", it_coffee, itf_inflammable);
+    DEF_ITEMF(Coffee, "it_coffee", it_coffee);
 
     /**
      * DeathItem

Modified: trunk/src/items/Sword.cc
===================================================================
--- trunk/src/items/Sword.cc	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/items/Sword.cc	2009-06-04 22:58:28 UTC (rev 1703)
@@ -60,6 +60,10 @@
         }
     }
     
+    void Sword::on_pickup(Actor *a) {
+        objFlags &= ~OBJBIT_LIGHT;   // forget enlighting info        
+    }
+    
     void Sword::alarm() {
         objFlags &= ~OBJBIT_NEW;
         updateCurrentLightDirs();

Modified: trunk/src/items/Sword.hh
===================================================================
--- trunk/src/items/Sword.hh	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/items/Sword.hh	2009-06-04 22:58:28 UTC (rev 1703)
@@ -44,6 +44,9 @@
         virtual void on_removal(GridPos p);
         virtual void lightDirChanged(DirectionBits oldDirs, DirectionBits newDirs);
 
+        // Item interface
+        virtual void on_pickup(Actor *a);
+        
         // TimeHandler interface
         virtual void alarm();
     };

Modified: trunk/src/items/Umbrella.cc
===================================================================
--- trunk/src/items/Umbrella.cc	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/items/Umbrella.cc	2009-06-04 22:58:28 UTC (rev 1703)
@@ -66,6 +66,10 @@
         return ITEM_KILL;
     }
     
+    void Umbrella::on_pickup(Actor *a) {
+        objFlags &= ~OBJBIT_LIGHT;   // forget enlighting info        
+    }
+    
     void Umbrella::alarm() {
         objFlags &= ~OBJBIT_NEW;
         DirectionBits db = updateCurrentLightDirs();

Modified: trunk/src/items/Umbrella.hh
===================================================================
--- trunk/src/items/Umbrella.hh	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/items/Umbrella.hh	2009-06-04 22:58:28 UTC (rev 1703)
@@ -46,6 +46,7 @@
 
         // Item interface
         virtual ItemAction activate(Actor* a, GridPos p);
+        virtual void on_pickup(Actor *a);
         
         // TimeHandler interface
         virtual void alarm();

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2009-06-02 23:03:33 UTC (rev 1702)
+++ trunk/src/lua.cc	2009-06-04 22:58:28 UTC (rev 1703)
@@ -3308,6 +3308,25 @@
     return 1;
 }
 
+static int polistEquality(lua_State *L) {
+    // (polist) == (polist)
+    if (!(is_polist(L, 1) &&  is_polist(L, 2))) {
+        throwLuaError(L, "Comparison of polists - argument is no polist");
+        return 0;
+    }
+    PositionList pl1 = toPositionList(L, 1);
+    PositionList pl2 = toPositionList(L, 2);
+    PositionList::iterator itr2 = pl2.begin();
+    for (PositionList::iterator itr1 = pl1.begin(); itr1 != pl1.end(); ++itr1) {
+         if (itr2 == pl2.end() || ((ecl::V2)(*itr1) !=  (ecl::V2)(*itr2))) {
+             lua_pushboolean(L, false);
+             return 1;
+         }
+         ++itr2;
+    }
+    lua_pushboolean(L, itr2 == pl2.end());
+    return 1;
+}
 
 MethodMap defaultMethodeMap;
 
@@ -3543,6 +3562,7 @@
     {subPositions,                  "__sub"},      //  obj - obj
     {joinPolist,                    "__concat"},   //  obj .. obj
     {scalarMultPositions,           "__mul"},      //  obj * obj
+    {polistEquality,                "__eq"},       //  ==
     {0,0}
 };
 



From ral at mail.berlios.de  Fri Jun  5 01:01:15 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Fri, 5 Jun 2009 01:01:15 +0200
Subject: [Enigma-game-svn] r1704 - trunk/src/items
Message-ID: <200906042301.n54N1FhQ020413@sheep.berlios.de>

Author: ral
Date: 2009-06-05 01:01:01 +0200 (Fri, 05 Jun 2009)
New Revision: 1704

Modified:
   trunk/src/items/SimpleItems.hh
Log:
Trunk 1.1:
- fix 1703: incomplete coffee patch, that causes compile error

Modified: trunk/src/items/SimpleItems.hh
===================================================================
--- trunk/src/items/SimpleItems.hh	2009-06-04 22:58:28 UTC (rev 1703)
+++ trunk/src/items/SimpleItems.hh	2009-06-04 23:01:01 UTC (rev 1704)
@@ -76,7 +76,7 @@
     /**
      * Coffee
      */
-    DEF_ITEMF(Coffee, "it_coffee", it_coffee);
+    DEF_ITEM(Coffee, "it_coffee", it_coffee);
 
     /**
      * DeathItem



From ral at mail.berlios.de  Sat Jun  6 00:52:55 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sat, 6 Jun 2009 00:52:55 +0200
Subject: [Enigma-game-svn] r1705 - trunk/doc/reference
Message-ID: <200906052252.n55Mqtj0026672@sheep.berlios.de>

Author: ral
Date: 2009-06-06 00:52:36 +0200 (Sat, 06 Jun 2009)
New Revision: 1705

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
- updates to last trunk commits

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-04 23:01:01 UTC (rev 1704)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-05 22:52:36 UTC (rev 1705)
@@ -3088,6 +3088,7 @@
 But these unique names should never interfere with the user assigned object
 names.
 
+ at c ----------------- Object Attributes --------------------
 @node Object Attributes
 @subsection Object Attributes
 
@@ -3117,7 +3118,7 @@
 If we speak of a bool value we do it in the sense of Lua 5, that means with the
 possible values @samp{true} and @samp{false}.
 
-Many enumerated values like directions and colors are covered by the integer
+Many enumerated values like orientations and colors are covered by the integer
 numbers.
 
 Of special interest is the value @samp{nil}. Just a few attributes make direct
@@ -3125,7 +3126,7 @@
 attribute to value @samp{nil} you do actually reset its value to the default
 value. E.g. if you set the attribute "orientation" of @ref{st_boulder} to
 @samp{nil} it will be set to its default, which is actually @samp{NORTH}, an
-enumerated direction value. A subsequent read of the attribute will return this
+enumerated orientation value. A subsequent read of the attribute will return this
 value. Just those attributes that allow a nil value will ever return @samp{nil}
 on a read access. As a direct consequence these attributes always default to
 @samp{nil}.
@@ -3217,6 +3218,7 @@
 * Object State::
 @end menu
 
+ at c ----------------- Messages --------------------
 @node Messages
 @subsection Messages
 
@@ -3259,6 +3261,7 @@
 All messages are listed and described in @ref{Common Messages} and the
 subsequent chapters.
 
+ at c ----------------- Target - Action --------------------
 @node Target - Action
 @subsection Target - Action
 
@@ -3359,6 +3362,7 @@
 the sequence of actions. This can cause unexpected logical results on the other
 hand.
 
+ at c ----------------- Callback Function --------------------
 @node Callback Function
 @subsection Callback Function
 
@@ -3402,6 +3406,7 @@
 The @ref{Advanced Lua Examples} will show examples of real powerful callback
 functions with a line by line comment.
 
+ at c ----------------- Object State --------------------
 @node Object State
 @subsection Object State
 
@@ -3415,8 +3420,8 @@
 Even though states are usually named by appropriate uppercase names like above,
 the states are integer numbers starting with @samp{0} usually related to the
 default state. But some objects use another mapping due to historic reasons.
-E.g. states that are direction related use the state @samp{3} representing
- at samp{NORTH} usually as the default and number the directions clockwise down to
+E.g. states that are orientation related use the state @samp{3} representing
+ at samp{NORTH} usually as the default and number the orientations clockwise down to
 @samp{0} representing @samp{WEST}.
 
 In most cases it is sufficient to perform a state independent common action
@@ -3642,7 +3647,7 @@
 reason to dig into this language at the very beginning.
 
 With the second Lua API version, as of Enigma 1.10, we designed an optimized
-way of describing levels in a very short and readable manner. Thus we do
+way of describing levels in a very short and readable manner. Thus we like to
 introduce you to this API by giving several examples from a basic level to most
 thrilling dynamic real Enigma levels. You should be able to start your first
 experiments just after reading the first example with its explanations.
@@ -3652,8 +3657,8 @@
 attribute or message names are colored in blue. Level specific variable names
 and value constants are colored in magenta.
 
-After the examples and a short overview we do give details of the language
-specific API part as you can expect it for a reference manual. Please note
+After the examples and a short overview the details of the language specific API
+part are given, as you can expect it for a reference manual. Please note
 that additional @ref{Advanced Features} are described in a separate chapter.
 
 @menu
@@ -5143,6 +5148,21 @@
 @node Introduction Datatypes
 @section Introduction Datatypes
 
+Before describing the datatypes in detail let us look at the used common 
+concepts and conventions.
+
+ at menu
+* Syntax and Conventions::         Abbreviations in syntax descriptions
+* Value and Reference::            Basic differences of datatypes
+* Polymorphism and Overloading::   Methods of Object Orientation
+* Pseudo Datatypes::               Reinterpretation of datatypes
+ at end menu
+
+ at c ----------------- Syntax and Conventions --------------------
+
+ at node Syntax and Conventions
+ at subsection Syntax and Conventions
+
 In the following subchapters we will describe the datatypes, their operators
 and methods, and global functions in detail. We need some syntax and
 conventions for an efficient description.
@@ -5189,6 +5209,11 @@
 still free to name your position variable and the resulting value variable
 whatever you like.
 
+ at c ----------------- Value and Reference --------------------
+
+ at node Value and Reference
+ at subsection Value and Reference
+
 Another most important aspect of Lua data types is the difference between
 values and references. Values are numbers, booleans like @samp{true} and
 @samp{false}, strings and @samp{nil}. The only reference data type is the Lua
@@ -5213,6 +5238,11 @@
 reference. If you are unfamilar to the resulting effects you may want to read
 the appendix about @ref{Caveats}.
 
+ at c ----------------- Polymorphism and Overloading --------------------
+
+ at node Polymorphism and Overloading
+ at subsection Polymorphism and Overloading
+
 @cindex polymorphism
 You may have noticed that in many operations you can use an @ref{Object} as
 a @ref{Position}. This is due to the fact that objects support most of the
@@ -5242,6 +5272,43 @@
 object either into a position or a group. Please read carefully the given
 syntax rules for a clear understanding of the results.
 
+ at c ----------------- Pseudo Datatypes --------------------
+
+ at node Pseudo Datatypes
+ at subsection Pseudo Datatypes
+
+Even though we introduce just the ten additional fundamental datatypes as
+described in the following subchapters, the API does additionally differ
+the same datatype according to its usage. E.g. a standard Lua number is used to
+describe the @ref{state} of an object. Just in rare occurences the state will 
+reflect a real number like the state of @ref{ot_counter}. For most objects
+the state will just be one of a given set of allowed values, which happen to
+be described by numbers by the API. Thus we speak of a pseudo datatype
+in the case of @ref{state} values. 
+
+The API provides @ref{Common Constants} for all pseudo datatypes, all written in
+upper case letters only. You should use exclusively these constants and never
+their equivalent basic number or other type values. The usage of the constants
+makes the level code readable and upward compatible if we ever should have the
+need of changing the assigned values or transforming the pseudo datatype to a
+another datatype.
+
+There is one abstract datatype that needs to be mentioned, as it uses two 
+different pseudo datatypes at the same time. This special case is the datatype
+used to describe the @samp{direction} or @samp{orientation}. Both are 
+essentially the same. But we speak of @samp{orientation} if we are just 
+interested in enlisting the main directions by number values for the purpose of 
+identification. The constant values are given as @ref{orientations}. 
+
+Sometimes you need values for calculation of position offsets. In this case we
+speak of a @samp{direction} and use @ref{Position} values as offset vectors. 
+The most common values are given as constants as listed in subchapter
+ at ref{direction offsets}. Note that our @samp{direction} values have no need of
+being normalized to the length of 1.
+
+A given @samp{orientation} can be transformed into a @samp{direction} value by
+the convertion table @ref{ORI2DIR}.
+
 @c ----------------- Position --------------------
 
 @node Position
@@ -6359,6 +6426,7 @@
 For task driven samples @pxref{Named Positions Tasks}. 
 
 @menu
+* PositionList Comparison::          Equality @samp{==} and Inequality @samp{~=}
 * PositionList Length::              Operator @samp{#}
 * PositionList Member Access::       Index Operators @samp{[]}
 * PositionList Concatenation::       Operator @samp{..}
@@ -6366,6 +6434,26 @@
 * PositionList Stretching::          Operators @samp{*} and @samp{/}
 @end menu
 
+ at c ----------------- PositionList Comparison --------------------
+ at node PositionList Comparison
+ at subsection PositionList Comparison
+
+ at table @asis
+ at item @b{Syntax:}
+result = @i{polist1} <==|~=> @i{polist2}
+
+ at item @b{Details:}
+A comparison of two position lists. Two position lists are equal if both contain
+the same positions in the identical sequence. Otherwise they are unequal.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{bool} = (@i{po}(@var{2}, at var{3}).. @i{po}(@var{5}, at var{7})) == (@i{po}(@var{2}, at var{3}) .. @i{po}(@var{5}, at var{7}))  -- = true
+ at var{bool} = (@i{po}(@var{2}, at var{3}).. @i{po}(@var{5}, at var{7})) == (@i{po}(@var{4}, at var{0}) .. @i{po}(@var{5}, at var{7}))  -- = false, different positions
+ at var{bool} = (@i{po}(@var{2}, at var{3}).. @i{po}(@var{5}, at var{7})) == (@i{po}(@var{5}, at var{7}) .. @i{po}(@var{2}, at var{3}))  -- = false, different sequence
+ at end example
+ at end table
+
 @c ----------------- PositionList Length --------------------
 @node PositionList Length
 @subsection PositionList Length
@@ -6617,7 +6705,7 @@
 second example uses the shortcut of specifying the name attribute value as
 second table entry, that will be stored at table position @samp{2}. It has to
 be a string value. The third variation, that is useful for actor declarations,
-stores the grid offsets in x and y direction in the table postions @samp{2} and
+stores the grid offsets in x and y directions in the table postions @samp{2} and
 @samp{3}. Of course you can not use the name attribute shortcut in the same
 declaration.
 
@@ -6907,9 +6995,9 @@
 
 @table @asis
 @item @b{Syntax:}
- at b{wo:drawBorder}(@i{upperleft_edge}, @i{lowerright_edge}, @i{tile})
+ at b{wo:drawBorder}(@i{upperleft_edge}, @i{lowerright_edge}, <@i{tile} | @i{key}, @i{resolver}>)
 
- at b{wo:drawBorder}(@i{upperleft_edge}, @i{width}, @i{height}, @i{tile})
+ at b{wo:drawBorder}(@i{upperleft_edge}, @i{width}, @i{height}, <@i{tile} | @i{key}, @i{resolver}>)
 
 @table @asis
 @item @i{upperleft_edge}
@@ -6920,12 +7008,20 @@
 Width of the rectangle.
 @item @i{height}
 Height of the rectangle.
+ at item @i{tile}
+A tile or an object declaration.
+ at item @i{key}
+A key string to be resolved via the given resolver.
+ at item @i{key}
+A resolver to be used for resolving the key to a valid tile.
 @end table
 
 @item @b{Syntax Samples:}
 @example
 wo:drawBorder(po(0, 0), wo["Width"], wo["Height"], ti["#"])
 wo:drawBorder(no["myRectUL"], no["myRectLR"], @{"st_grate1"@})
+wo:drawBorder(no["myRectUL"], no["myRectLR"], @{"fl_water"@} .. ti["X"])
+wo:drawBorder(no["myRectUL"], no["myRectLR"], "x", myresolver)
 @end example
 
 @item @b{Details:}
@@ -7055,9 +7151,9 @@
 
 @table @asis
 @item @b{Syntax:}
- at b{wo:drawRect}(@i{upperleft_edge}, @i{lowerright_edge}, @i{tile})
+ at b{wo:drawRect}(@i{upperleft_edge}, @i{lowerright_edge}, <@i{tile} | @i{key}, @i{resolver}>)
 
- at b{wo:drawRect}(@i{upperleft_edge}, @i{width}, @i{height}, @i{tile})
+ at b{wo:drawRect}(@i{upperleft_edge}, @i{width}, @i{height}, <@i{tile} | @i{key}, @i{resolver}>)
 
 @table @asis
 @item @i{upperleft_edge}
@@ -7068,12 +7164,20 @@
 Width of the rectangle.
 @item @i{height}
 Height of the rectangle.
+ at item @i{tile}
+A tile or an object declaration.
+ at item @i{key}
+A key string to be resolved via the given resolver.
+ at item @i{key}
+A resolver to be used for resolving the key to a valid tile.
 @end table
 
 @item @b{Syntax Samples:}
 @example
 wo:drawRect(po(0, 0), wo["Width"], wo["Height"], ti[" "])
 wo:drawRect(no["myRectUL"], no["myRectLR"], @{"fl_water"@})
+wo:drawRect(no["myRectUL"], no["myRectLR"], @{"fl_water"@} .. ti["#"])
+wo:drawRect(no["myRectUL"], no["myRectLR"], "x", myresolver)
 @end example
 
 @item @b{Details:}
@@ -7321,6 +7425,7 @@
 * fl::              Floor retrieval
 * grp::             Create a group out of the argument objects
 * it::              Item retrieval
+* ORI2DIR::         Orientation to direction convertion
 * random::          Random number generator
 * st::              Stone retrieval
 * usertype::        Type info for Enigma userdata types 
@@ -7578,10 +7683,10 @@
 @item @i{"table"}
 If @code{var} is a table, it's metatable will be queried. If there is an entry
 @samp{_type}, this entry will be used as @code{etype}. Most important examples
-of this kind are @ref{libmap}-maps and @ref{res.maze} with its mazes and cells.
-So @samp{etype} will return @code{"map"}, @code{"maze"} and @code{"cell"}, too.
-You may access the @code{etype}-system through @samp{_type} whenever you use
-metatables on your own.
+of this kind are @ref{libmap}-maps, @ref{Resolvers} and @ref{res.maze} with its
+mazes and cells. So @samp{etype} will return @code{"map"}, @code{"resolver"}, 
+ at code{"maze"} and @code{"cell"}, too. You may access the @code{etype}-system
+through @samp{_type} whenever you use metatables on your own.
 @end table
 
 @end table
@@ -7689,6 +7794,28 @@
 
 @end table
 
+ at c ----------------- ORI2DIR --------------------
+ at node ORI2DIR
+ at subsection ORI2DIR
+
+The table @samp{ORI2DIR[]} converts orientation values to direction values.
+
+ at table @asis
+ at item @b{Syntax:}
+result = @b{ORI2DIR}[@var{orientation}]
+
+ at item @b{Details:}
+The table has stored the proper directions values at the index positions of
+the related orientations.
+
+ at item @b{Syntax Samples:}
+ at example
+ at var{direction} = @i{ORI2DIR}[NORTH]      -- N  = po(0, -1)
+ at var{direction} = @i{ORI2DIR}[SOUTHEAST]  -- SE = po(1,  1)
+ at var{direction} = @i{ORI2DIR}[NODIR]      --      po(0,  0)
+ at end example 
+
+ at end table
 @c ----------------- random --------------------
 @node random
 @subsection random
@@ -7971,7 +8098,7 @@
 @item @b{Access:} @ @ read/write
 @item @b{Support:} @ @ by most objects
 All objects with boolean action values will support this attribute. Additionally
-some objects with other invertible action value types like directions will
+some objects with other invertible action value types like orientations will
 support the inversion of their attributes as stated in the individual object
 descriptions.
 @end table
@@ -8154,7 +8281,7 @@
 to @samp{OFF} or from @samp{OFF} to @samp{ON}. Door like objects will toggle
 their state from @samp{OPEN} to @samp{CLOSED} or from @samp{CLOSED} to
 @samp{OPEN}. Other objects like @ref{st_fourswitch} will turn into the next
-direction. Generally the object will toggle to its next state.
+orientation. Generally the object will toggle to its next state.
 
 @table @asis
 @item @b{Value:} @ @ -
@@ -8181,7 +8308,7 @@
 A signal message tries to set the object to the state 0 (@samp{OFF},
 @samp{CLOSED}) or state 1 (@samp{ON}, @samp{OPEN}) according to its value. This
 message allows you to keep the states of an action source and a receiving object
-in sync. Note that values like @samp{true}, @samp{false} and direction values
+in sync. Note that values like @samp{true}, @samp{false} and orientation values
 like @samp{WEST} to @samp{NORTH} are converted to 0 and 1. This allows you to
 use @samp{signal} as action message on most objects.
 
@@ -8325,6 +8452,8 @@
 @node Common Constants
 @section Common Constants
 
+Constants for @ref{Pseudo Datatypes}.
+
 @menu
 * state values::
 * color values::
@@ -10668,8 +10797,8 @@
 or tubes that channelize actors.
 
 Slope floors are basically described by their @samp{slope} and their @samp{shape}.
-The slope is the direction of the force applied to actors on top. The eight
-main directions and @samp{NODIR}, that causes no force to be applied at all, are
+The slope is the orientation of the force applied to actors on top. The eight
+main orientations and @samp{NODIR}, that causes no force to be applied at all, are
 currently supported.
 
 The shape describes the intended usage, which causes a proper visual
@@ -10685,7 +10814,7 @@
 @code{"tnr"}).
 
 Note that several shapes do currently use an identical visual representation.
-But they differ in their usage and different slope force directions are
+But they differ in their usage and different slope force orientations are
 assigned by default when you use the variant suffices. It is strongly
 recommended to use always the shape of the intended usage as the images might
 be improved in the future and should fit to your level.
@@ -10702,7 +10831,7 @@
 
 @table @asis
 @item @b{slope}, @ @ @i{values}: @code{NODIR}, @code{WEST}, @code{SOUTH}, @code{EAST}, @code{NORTH}, @code{NORTHWEST}, @code{SOUTHWEST}, @code{SOUTHEAST}, @code{NORTHEAST}; @ @ @i{default}: @code{NODIR}
-The direction of the force. Note that setting this attribute does not
+The orientation of the force. Note that setting this attribute does not
 automatically assign a fitting @samp{shape}. This attribute is neglected if
 @samp{force_x} or @samp{force_y} attributes are set.
 
@@ -11395,6 +11524,9 @@
 @item @ref{it_squashed} - remove from floor
 @end itemize
 
+The brush is sensitive to laser light an dissolves with an @ref{it_explosion}_nil
+leaving no remnants when being hit by light.
+
 @table @asis
 
 @item @b{Attributes:}
@@ -11519,6 +11651,9 @@
 This item looks like a piece of paper and contains a text message that can be
 displayed by activating the item. It is destroyed by explosions from 
 @ref{it_bomb}, @ref{st_dispenser}, @ref{it_dynamite} and by burning fire.
+The document is sensitive to laser light an dissolves with an 
+ at ref{it_explosion}_nil leaving no remnants when being hit by light.
+
 Another message carrying item is the @ref{it_bottle}.
 
 @table @asis
@@ -11905,11 +12040,11 @@
 
 @itemize @bullet
 @item @ref{st_blur}, magic - transforms to @ref{st_passage},
- at item @ref{st_boulder} - changes direction of a boulder,
+ at item @ref{st_boulder} - changes orientation of a boulder,
 @item @ref{st_chess} - changes the color of a chess stone,
 @item @ref{st_ghost}, greenbrown - transforms to @ref{st_greenbrown},
 @item @ref{st_magic}, brick - transforms to a @ref{st_rawglass},
- at item @ref{st_oneway} - changes direction of a oneway,
+ at item @ref{st_oneway} - changes orientation of a oneway,
 @item @ref{st_puzzle} - scrambles blue puzzle stones instead of pushing, causes complete
 clusters to explode,
 @item @ref{st_rubberband} - makes rubberband stones movable,
@@ -12490,7 +12625,7 @@
 
 A wrench wielded as first item in the players inventory causes some objects
 to react on actor hits. An @ref{st_rotator} changes its turning direction.
-An green @ref{st_turnstile} rotates backwards when hit. An @ref{st_window}
+A green @ref{st_turnstile} rotates backwards when hit. An @ref{st_window}
 face pushed with an wrench will swap to the opposite side of the stone if
 possible.
 
@@ -14374,7 +14509,7 @@
 * st_flash::           Partner Marble pushing Stone
 * st_flat::            Featured Gypsum Stone
 * st_floppy::          Floppy Driven Switch
-* st_fourswitch::      Four Direction Switch
+* st_fourswitch::      Four Orientation Switch
 * st_ghost::           Invisible Transforming Stone
 * st_grate::           Hovering metal Grate
 * st_greenbrown::      Mainly brown seedable stone
@@ -14450,7 +14585,7 @@
 even glasses generated by laser lighting an @ref{it_extralife} can be configured
 to show invisible actorimpulse stones.
 
-An @ref{st_boulder} hitting an actorimpulse stone will revert its direction
+An @ref{st_boulder} hitting an actorimpulse stone will revert its orientation
 and return in the incoming direction.
 
 @table @asis
@@ -14652,9 +14787,9 @@
 Boulder stones fall into @ref{fl_abyss}, but cross @ref{fl_water}
 unchanged.
 
- at ref{it_magicwand} and lasers reverse its direction. An @ref{st_actorimpulse}
-reverts the direction if the boulder hits it frontally. An @ref{st_rotator}
-changes its direction according to the rotator's direction. An
+ at ref{it_magicwand} and lasers reverse its orientation. An @ref{st_actorimpulse}
+reverts the orientation if the boulder hits it frontally. An @ref{st_rotator}
+changes its orientation according to the rotator's direction. An
 @ref{st_stoneimpulse} pushes a boulder away.
 
 @table @asis
@@ -14675,7 +14810,7 @@
 @table @asis
 @msindex orientate
 @item @b{orientate}, @ @ @i{value type}: direction
-Change the orientation to the given direction value. The @ref{st_fourswitch}
+Change the orientation to the given orientation value. The @ref{st_fourswitch}
 provides a compatible action which allows you to set a boulder as
 target and this message as action.
 @item @b{turn}
@@ -15571,15 +15706,15 @@
 @subsection st_fourswitch
 @obindex st_fourswitch
 
-A switch that points to one of the four directions turning on every switching
-event. The most common event is an actor hitting this stone. But @ref{st_boulder}
-will trigger this switch, too. Of course other objects can send messages on
-actions to make this switch turning.
+A switch that points into one of the four orientations and turning on every
+switching event. The most common event is an actor hitting this stone. But 
+ at ref{st_boulder} will trigger this switch, too. Of course other objects can send
+messages on actions to make this switch turning.
 
 When turning its pointer on a switching event it performs the action given by
 the @samp{action/target}-pair. This can be either a common pair or a
-state/direction dependent pair allowing you to issue different messages
-dependent on the pointing direction.
+state/orientation dependent pair allowing you to issue different messages
+dependent on the pointing orientation.
 
 @table @asis
 @item @b{Attributes:}
@@ -15592,8 +15727,8 @@
 direction.
 @item @b{inverse} @ @ @xref{inverse}
 Note that the action value is inverted in its boolean interpretation. This means
-that an inverted action value is @emph{not} the reverse direction and should not
-be used as a direction value at all.
+that an inverted action value is @emph{not} the reverse orientation and should
+not be used as an orientation value at all.
 @end table
 
 @item @b{Messages:}
@@ -15608,10 +15743,10 @@
 
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 Performs an action on each turn. If just a pair of global @samp{target/action}
-attributes are given, the action message is sent to the target with a
-direction value of the new orientation. This value suits any message of the
-target that expects a direction value, and the @ref{signal} message, that
-translates the direction to a 1 for @samp{NORTH}, @samp{SOUTH} and a 0 for
+attributes are given, the action message is sent to the target with a value of
+the new orientation. This value suits any message of the target that expects
+an orientation value, and the @ref{signal} message, that translates the 
+orientation value to a 1 for @samp{NORTH}, @samp{SOUTH} and a 0 for
 @samp{EAST}, @samp{WEST}.
 
 If state dependent target/action pairs are given instead, namely
@@ -15961,7 +16096,7 @@
 The laser stone is the only object that is capable of emitting light beams.
 Per default laser stones are switched off. The @samp{state} attribute represents
 the activity of the laser and can be set initially to @samp{ON}. A laser is
-orientated to one direction in which the light will be emitted.
+orientated to one direction into which the light will be emitted.
 
 Lasers have a latency that protect them from infinite fast switching cycles. This
 allows you to toggle a laser with an @ref{st_laserswitch} that is illuminated
@@ -16361,8 +16496,8 @@
 
 @table @asis
 @msindex orientate
- at item @b{orientate}, @ @ @i{value type}: direction
-Change the orientation to the given direction value. The @ref{st_fourswitch}
+ at item @b{orientate}, @ @ @i{value type}: orientation
+Change the orientation to the given orientation value. The @ref{st_fourswitch}
 provides a compatible action which allows you to set a mirror as
 target and this message as action.
 @item @b{turn}
@@ -16471,8 +16606,8 @@
 @item @b{Messages:}
 
 @table @asis
- at item @b{orientate}, @ @ @i{value type}: direction
-Change the orientation to the given direction value. The @ref{st_fourswitch}
+ at item @b{orientate}, @ @ @i{value type}: orientation
+Change the orientation to the given orientation value. The @ref{st_fourswitch}
 provides a compatible action which allows you to set a oneway as
 target and this message as action.
 @item @b{flip},
@@ -16993,10 +17128,10 @@
 @item @b{get_adjacents}
 Returns the huddle of all adjacent puzzle stones of same color independent of
 being connected or not. The huddle is returned as a group.
- at item @b{pull_rotate}, @ @ @i{value type}: direction
+ at item @b{pull_rotate}, @ @ @i{value type}: orientation
 Perform a reverse @samp{push_rotate} from this puzzle stones with the line
 of puzzle stone into the given direction.
- at item @b{push_rotate}, @ @ @i{value type}: direction
+ at item @b{push_rotate}, @ @ @i{value type}: orientation
 Perform a line rotation as described above from this puzzle stones with the line
 of puzzle stone into the given direction.
 
@@ -17116,7 +17251,7 @@
 @obindex st_rotator
 
 Rotators send impulses to neighboring stones, thus pushing them in the direction
-given by the rotation. @ref{st_boulder} additionally change their direction to
+given by the rotation. @ref{st_boulder} additionally change their orientation to
 the one they are pushed to.
 
 Rotators can either rotate in clockwise or counterclockwise direction. They can
@@ -17787,7 +17922,7 @@
 @item @b{orientation}, @ @ @i{values}: @code{NORTH}, @code{EAST}, @code{SOUTH}, @code{WEST}; @ @ @i{default}: @code{NORTH}
 The orientation of the turnstile that is only visible by its arms. Setting
 this attribute just defines a new base, but does not turn the turnstile as the
-direction would not be defined. But every rotation does update this attribute
+orientation would not be defined. But every rotation does update this attribute
 relative to its previous value.
 @end table
 
@@ -17822,7 +17957,7 @@
 An arm that usually connects to an @ref{st_turnstile} pivot building a turnstile
 cluster. The arm's subkind suffix, its state and orientation are named according
 to the arm's position within the turnstile cluster. Thus a @samp{NORTH} arm has
-a single standard connection of @code{"s"}, the reverse direction.
+a single standard connection of @code{"s"}, the reverse orientation.
 
 As long as a turnstile arm is not connected to a pivot it is a free movable
 stone. Intentionally it is visually indistinguishable from a @ref{st_puzzle}
@@ -17861,8 +17996,8 @@
 
 @table @asis
 @msindex orientate
- at item @b{orientate}, @ @ @i{value type}: direction
-Change the orientation to the given direction value. The @ref{st_fourswitch}
+ at item @b{orientate}, @ @ @i{value type}: orientation
+Change the orientation to the given orientation value. The @ref{st_fourswitch}
 provides a compatible action which allows you to set an arm as
 target and this message as action.
 @end table
@@ -18006,8 +18141,8 @@
 @item @b{Messages:}
 
 @table @asis
- at item @b{inner_pull}, @ @ @i{value type}: direction
-Tries to tear the opposite window face into the given direction.
+ at item @b{inner_pull}, @ @ @i{value type}: orientation
+Tries to tear the opposite window face into the given orientation.
 @end table
 
 @item @b{Variants:}
@@ -19248,7 +19383,7 @@
 
 @item @b{Syntax Samples:}
 @example
-directions = lib.lua.shuffle(@{NORTH, SOUTH, EAST, WEST@})
+orientations = lib.lua.shuffle(@{NORTH, SOUTH, EAST, WEST@})
 a = @{1, 2, 3, "r", @{"x", "y", "z"@}, 4@}
 b = lib.lua.shuffle(a)
 @end example
@@ -21067,18 +21202,11 @@
 @end example
 
 @item @b{Details:}
-Cell
+To be written.
 
 
 @item @b{Full Example:}
 @example
-ti[" "] = @{"fl_sahara"@}
-
-w, h = wo(resolver, " ", @{
-"                                        ",
-"                                        ",
-"                                        "
-@})
 @end example
 @end table
 
@@ -21999,9 +22127,12 @@
 
 It is the task of the configurator function to check the user supplied
 parameters thoroughly and to provide appropriate error messages on bad
-parameters. Do this with a lua error message call at level 2:
+parameters. Do this with a lua error message call at level 2 or the useful
+helper functions @ref{assert_bool} and @ref{assert_type}:
 @example
 error("Resolver autotile rule " .. i.." is not a table", 2)
+assert_bool(is_resolver(subresolver), "res.composer first argument (subresolver)", 2)
+assert_type(args[1], "res.composer second argument (sequence)", 2, "non-empty string")
 @end example
 
 The configuration function has to return a table that contains the context
@@ -22022,10 +22153,21 @@
 first parameter of the configurator call needs to be the third context
 table entry.
 
+The context needs to add a metatable with two entries. First @code{"_type"} 
+needs to identify the context as an enigma data type for the @ref{etype}
+function. Most resolvers to simply store the string @code{"resolver"}, but
+special ones might return special identification strings like @code{"maze"}.
+The second required entry is @code{"_resolver"} that needs a boolean @samp{true}
+value assigned for purpose of secure identification of resolver tables. A 
+default resolver metatable is stored at @samp{res.metatable} and can directly
+be set by @samp{setmetatable}.
+
 @item @b{Full Example:}
 @example
 function res.composer(subresolver)
+    assert_bool(is_resolver(subresolver), "res.composer first argument (subresolver)", 2)
     local context = @{res.composer_implementation, nil, subresolver@}
+    setmetatable(context, res.metatable)
     return context
 end
 @end example
@@ -22093,7 +22235,7 @@
 coordinates for postprocessing operations in the finalizer.
 
 @item @b{Full Example:}
-The implementation of the composer (without the special 3 character key treatment)
+The implementation of the composer (without the special sequence treatment)
 @example
 function res.composer_implementation(context, evaluator, key, x, y)
     local tile = evaluator(context[3], key, x, y)
@@ -22134,7 +22276,7 @@
 @end table
 
 @item @b{Details:}
-The finalization functions of chained resolvers are called from top to bottom.
+The finalization functions of chained resolvers are called from bottom to top.
 
 Many resolvers have no need of a finalization. But some like a maze constructor
 need to know all participating tiles until they can do their final work.
@@ -22176,7 +22318,7 @@
 
 @node Title Recommendation
 @section Title Recommendation
-English - no translation - use subtitle, too
+English titles preferred - use subtitle, too
 
 @node Tile Key Recommendation
 @section Tile Key Recommendation



From ral at mail.berlios.de  Sat Jun  6 13:00:28 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sat, 6 Jun 2009 13:00:28 +0200
Subject: [Enigma-game-svn] r1706 - trunk/doc/reference
Message-ID: <200906061100.n56B0SID030291@sheep.berlios.de>

Author: ral
Date: 2009-06-06 12:59:43 +0200 (Sat, 06 Jun 2009)
New Revision: 1706

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
- removal of old API chapters

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-05 22:52:36 UTC (rev 1705)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-06 10:59:43 UTC (rev 1706)
@@ -46,9 +46,7 @@
 * Advanced Features::           Resolvers, Scrolling, Flood, Fire, etc.
 * Extension Development::       Resolver, Library Development
 * Guidelines and Hints::        Tips and Recommendations for Levels to be included in Enigma
-* Old API - Objects::           Description of all objects in Enigma
-* Old API - Variables::         Lua variables that influence the game
-* Old API - Functions::         Predefined functions
+* Compatibility::               Enigine Mode and Version Compatibility
 * Object Index::
 * Attribute Index::
 * Message Index::
@@ -5555,10 +5553,10 @@
 
 Note that the @ref{Object}s @samp{exists} method reports the existence of the
 object. Evaluation of @samp{po(obj):exists()} may result in @samp{false} for
-exisiting objects. E.g. this result occurs for @ref{Items} currently being part
-of a player's inventory. The item exists, but is not part of the world. But
-items contained in a bag placed in the world will report the same position as
-the bag.
+exisiting objects. E.g. this result occurs for @ref{Item Objects} currently 
+being part of a player's inventory. The item exists, but is not part of the 
+world. But items contained in a bag placed in the world will report the same 
+position as the bag.
 
 @item @b{Syntax Samples:}
 @example
@@ -5601,10 +5599,10 @@
 directly used as a position without explicit conversion. Just special methods
 like existence differ on both datatypes. Of course all objects placed in the
 world are limited to positions within the world. But be aware that portable 
- at ref{Items} can well be part of a player's inventory and thus report a position 
-outside of the world. Actors will always report positions rounded to the
-containing grid. This feature is legacy. As Lua code is anyway unapropriate to
-handle actor movements we maintained this rounding feature.
+ at ref{Item Objects} can well be part of a player's inventory and thus report a 
+position  outside of the world. Actors will always report positions rounded to 
+the containing grid. This feature is legacy. As Lua code is anyway unapropriate
+to handle actor movements we maintained this rounding feature.
 
 Objects support standard set operators of @ref{Group}s, too, as long as one
 operand is a group and the other an object.
@@ -6982,8 +6980,9 @@
 
 @item @b{Details:}
 Just @ref{Other Objects} can be directly added to the world. Just portable
- at ref{Items} can be added to the player's inventories @samp{YIN} and @samp{YANG}
-and to @ref{it_bag}s. No other targets do currently add objects by this method.
+ at ref{Item Objects} can be added to the player's inventories @samp{YIN} and
+ at samp{YANG} and to @ref{it_bag}s. No other targets do currently add objects by 
+this method.
 
 @end table
 
@@ -8380,7 +8379,7 @@
 @table @asis
 @item @b{Value:} @ @ -
 @item @b{Returns:} @ @ -
- at item @b{Support:} @ @ by all @ref{Floors} and explosive or shattering items and stones
+ at item @b{Support:} @ @ by all @ref{Floor Objects} and explosive or shattering items and stones
 @end table
 
 @node heat
@@ -8394,7 +8393,7 @@
 @table @asis
 @item @b{Value:} @ @ -
 @item @b{Returns:} @ @ -
- at item @b{Support:} @ @ by all @ref{Floors} and some other objects.
+ at item @b{Support:} @ @ by all @ref{Floor Objects} and some other objects.
 @end table
 
 @node setfire
@@ -8405,7 +8404,7 @@
 @table @asis
 @item @b{Value:} @ @ -
 @item @b{Returns:} @ @ -
- at item @b{Support:} @ @ by all @ref{Floors}
+ at item @b{Support:} @ @ by all @ref{Floor Objects}
 @end table
 
 @node kill
@@ -8999,7 +8998,7 @@
 @item @b{Values:} @ @ float number between @code{0.0} and @code{1.0}
 @item @b{Default:} @ @ @code{1.0}
 @item @b{Access:} @ @ read/write
- at item @b{Support:} @ @ @ref{it_crack} and @ref{Floors}
+ at item @b{Support:} @ @ @ref{it_crack} and @ref{Floor Objects}
 @end table
 
 @node GlobalForce
@@ -18256,7 +18255,7 @@
 
 Enigma provides a collection of transparent stones, all similar, but with
 different features. Some of them may be passed after the use of an
- at ref{it-cherry}, others will be just pushed. Some are transparent for lasers,
+ at ref{it_cherry}, others will be just pushed. Some are transparent for lasers,
 but not all! This table shows their exact properties.
 
 @multitable {st_lightpassenger} {st_lightpassenger_off_plus} {actor is visible:  } {actor is invisible:  } {lasertransparent:  }
@@ -21782,10 +21781,10 @@
 @end itemize
 
 A good model of the 0.92-system can be attained via the
-compatibility-modes: All non-Enigma-modes (see @ref{Differences
-between Compatibility Modes} and @ref{<compatibility>}) feature a
-version which only marginally differs from 0.92-fire, yet allowing
-some of the new achievements, like secure- or eternal-fire.
+compatibility-modes: All non-Enigma-modes (@pxref{Engine Compatibility} and
+ at ref{<compatibility>}) feature a version which only marginally differs from
+0.92-fire, yet allowing some of the new achievements, like secure- or 
+eternal-fire.
 
 Note that in 0.92, fire-transformation happened at the beginning of
 the fire, which manifested in the so called ``burning-abyss''-bug.
@@ -22328,4047 +22327,40 @@
 @section Easy Mode Hints
 write easy first, floor friction,...
 
- at c ===================  Old API - Objects  =======================
+ at c ==================  Compatibility  =======================
 
- at node Old API - Objects
- at chapter Old API - Objects
+ at node Compatibility
+ at chapter Compatibility
 
- at menu
-* Floors::
-* Items::
-* Stones::
-* Old Actors::
-* General object attributes::
-* Differences between Compatibility Modes::
- at end menu
 
- at node Floors
- at section Floors
-
 @menu
-* Common Floor Attributes::     Common attributes for single floor tiles
-* Special floor tiles::         List of special floors
-* Regular floor tiles::         List of regular floors
-* fl-abyss::                    Abyss
-* fl-ac[black/white]::          Blackmarble and Whitemarble Floor
-* fl-bridge::                   Bridge
-* fl-dummy::                    Dummy floor
-* fl-gradient::                 Gradient
-* fl-ice::                      Ice
-* fl-inverse::                  Inverse Floor
-* fl-nomouse::                  No-mouse-floor
-* fl-space::                    Space Floor
-* fl-space-force::              Space Floor with Vertical Force
-* fl-swamp::                    Swamp
-* fl-thief::                    Thief Floor
-* fl-water::                    Water
+* Engine Compatibility::     Differences between Compatibility Modes
 @end menu
 
-
- at node Common Floor Attributes
- at subsection Common Floor Attributes
-
-Standard attributes:
-
- at table @code
- at item friction
-Overrides the default friction for this floor tile.
- at item mousefactor
-Overrides the default mousefactor.
- at item force_x, force_y
-Define horizontal and vertical flat forces on the floor. On
- at ref{fl-gradient}, @code{force_x} and @code{force_y} are additive to
-the gradient's standard force.
- at item freeze_check
-See @ref{Freeze Checking}.
- at end table
-
-Attributes connected to @ref{Fire Spreading} (all boolean):
- at table @code
- at item burnable
-Sets if the floor may burn.
- at item ignitable
-Sets if the floor gets ignited by explosions.
- at item secure
-Sets if the floor gets securely ignited and/or heated by neighbors.
- at item eternal
-Sets if the floor doesn't stop burning after awhile.
- at item noash
-Sets if the floor doesn't leave @code{it-burnable_ash} behind.
- at item fastfire
-Sets if the fire spreads fast.
- at item initfire
-Sets if the floor starts burning on initialization.
- at end table
-
-
- at node Special floor tiles
- at subsection Special floor tiles
-
- at example
-fl-abyss
-fl-acblack
-fl-acwhite
-fl-bridge( type )
-fl-bridge-closed( type )
-fl-bridge-open( type )
-fl-dummy
-fl-gradient( type force )
-fl-gradient@{1..16@}( force )
-fl-ice
-fl-inverse
-fl-inverse2
-fl-nomouse
-fl-swamp
-fl-thief
-fl-water
- at end example
-
-
- at node Regular floor tiles
- at subsection Regular floor tiles
-
- at example
-fl-abyss_fake
-fl-black
-fl-bluegray
-fl-bluegreen
-fl-bluegreenx
-fl-brick
-fl-bumps
-fl-concrete
-fl-darkgray
-fl-dunes
-fl-floor_001
-fl-gravel
-fl-gray
-fl-hay
-fl-himalaya
-fl-leaves
-fl-leavesb
-fl-leavesc@{1..4@}
-fl-leavesd@{1..4@}
-fl-leavese@{1..4@}
-fl-light
-fl-lightgray
-fl-marble
-fl-metal
-fl-metal@{1..6@}
-fl-mortar
-fl-normal
-fl-normal_x
-fl-plank
-fl-red
-fl-rock
-fl-rough
-fl-rough-blue
-fl-rough-red
-fl-rough_medium
-fl-rough_slow
-fl-sahara
-fl-samba
-fl-samba1
-fl-samba2
-fl-sand
-fl-space
-fl-space-force
-fl-springboard
-fl-stone
-fl-stwood
-fl-stwood1
-fl-stwood2
-fl-tigris
-fl-trigger
-fl-white
-fl-wood
-fl-woven
- at end example
-
-
- at node fl-abyss
- at subsection fl-abyss
-
-Kills marbles that roll onto it, unless they're protected by an
- at ref{it-umbrella}.  @ref{st-wood} transforms this floor into
- at code{fl-stwood}.  Marbles may jump over an @ref{fl-abyss} with an
- at ref{it-spring[1/2/board]}.  Compare with @ref{it-abyss},
- at ref{fl-water} and @ref{fl-swamp}.
-
-
- at node fl-ac[black/white]
- at subsection fl-ac[black/white]
-
-Marbles on this floor are controlled by player 0 only (who has
- at ref{ac-blackball} by default), respectively player 1 only
-(@ref{ac-whiteball} by default).  See @ref{it-changefloor} for an item
-interacting with these floors.
-
-
- at node fl-bridge
- at subsection fl-bridge
-
- at code{fl-bridge} can be open (marbles fall into it) or closed (marbles
-may pass).  The state can be changed via messages.
-
- at code{fl-bridge} closes and re-opens automatically when a stone is
-pushed onto it.  Thus @ref{st-wood} and other stones don't fall into
-it, as they do on @ref{fl-abyss}.
-
- at strong{Attributes}
-
- at table @code
- at item type
- at code{a}, @code{x} or @code{y}
- at end table
-
- at strong{Messages}
-
- at table @code
- at item open, close, openclose
-as they say
- at item signal
-change state, like @code{openclose}
- at end table
-
- at strong{Variants}
-
- at table @code
- at item fl-bridge
-open by default
- at item fl-bridge-open
- at item fl-bridge-closed
- at end table
-
-
- at node fl-dummy
- at subsection fl-dummy
-
-Prints its Oxyd code when entered.  Used for maintenance purposes.
-Compare it with @code{st-dummy} (@ref{Oxyd Compatibility Stones}) and
- at code{it-dummy} (@ref{System and Debug Items}).
-
-
- at node fl-gradient
- at subsection fl-gradient
-
-Adds a horizontal, vertical or diagonal force to actors on it.  The
-strength of the force is determined by @code{enigma.SlopeForce} (see
- at ref{Old API - Variables}) or the attribute @code{force}.  It is additive to the
-force determined by the @code{force_[x/y]}-attributes (see @ref{Common
-Floor Attributes}).
-
- at strong{Attributes}
-
- at table @code
- at item force
-overrides @code{enigma.SlopeForce}
- at item type
-between 1 and 24, determines the direction of the gradient and its design.
- at end table
-
-Direction of the forces to certain types: 1 and 21: south, 2 and 22:
-north, 3 and 23: east, 4 and 24: west, 5 and 9: south-east, 6 and 11:
-south-west, 7 and 10: north-east, 8 and 12: north-west.
-
- at strong{Variants}
-
- at table @code
- at item fl-gradient
-type 1 by default
- at item fl-gradient1 .. fl-gradient12
-type is 1..12
- at item fl-gradient13 .. fl-gradient16
-types are 22, 21, 24 and 23
- at end table
-
-The latter four gradients don't show an outline like the first twelve:
-They all look identical, and similar to @code{fl-gray}.  The remaining
-types show outlines that don't correspond to their forces (use them
-for tubes etc.).
-
-
- at node fl-ice
- at subsection fl-ice
-
-Ice has very low friction and mousefactor, such that it's difficult to
-move on it.  You can use @ref{it-pin} and @code{enigma.IceFriction}
-(see @ref{Old API - Variables}) to ease the friction.
-
- at strong{Variants}
-
- at table @code
- at item fl-ice
- at end table
-
- at node fl-inverse
- at subsection fl-inverse
-
-Inverses the mouse movements (negative @code{mouseforce}).
-
- at strong{Variants}
-
- at table @code
- at item fl-inverse
- at item fl-inverse2
- at end table
-
-
- at node fl-nomouse
- at subsection fl-nomouse
-
-This floor prevents a player from controlling the marble
-(@code{mouseforce = 0}).
-
-
- at node fl-space
- at subsection fl-space
-
-This floor prevents a player from controlling the marble
-(@code{mouseforce = 0}), but in contrast to @ref{fl-nomouse}, there
-also is no friction, so that marbles seldom get stuck on space.
-
-
- at node fl-space-force
- at subsection fl-space-force
-
-This floor has (like @ref{fl-space}) no friction and no mouseforce,
-but adds a vertical force of the amount given in
- at code{enigma.FlatForce}.  This is obsolete since you can use
- at code{fl-space} with @code{force_y}-attribute (see @ref{Common Floor
-Attributes}).  Note however, that the @code{enigma.FlatForce} overrides the
- at code{force_y}-attribute of @code{fl-space-force}.
-
-
- at node fl-swamp
- at subsection fl-swamp
-
-Kills marbles that roll onto it, unless they're protected by an
- at ref{it-umbrella}.  @ref{st-wood} transforms this floor into
- at code{fl-stwood}.
-
-Once in the swamp, marbles constantly sink with the speed
-given by @code{enigma.SwampSinkSpeed} (see @ref{Old API - Variables}),
-and may rise again when moving fast enough (compare with
- at ref{fl-water} and @ref{fl-abyss}).
-
-Marbles may jump over the swamp with an
- at ref{it-spring[1/2/board]}.
-
-
- at node fl-thief
- at subsection fl-thief
-
-This floor steals one item from the player's inventory. It looks like
-the simple floor @code{fl-bluegray}. Compare with @ref{st-thief} for
-details.
-
-Like @code{st-thief}, @ref{st-chess_[black/white]} can deactivate @code{fl-thief}, leaving an
- at ref{it-bag} behind, filled
-with the items the thief stole from the actors (plus possibly the item
-that already lay on the floor, if it could be picked up; if it is a
-static item, no @code{it-bag} is produced).
-
-
- at node fl-water
- at subsection fl-water
-
-Kills marbles that roll onto it, unless they're protected by an
- at ref{it-umbrella}.  @ref{st-wood} transforms this floor into
- at code{fl-stwood}.
-
-Once in the water, marbles constantly sink with the speed
-given by @code{enigma.WaterSinkSpeed} (see @ref{Old API - Variables}).
-In contrast to @ref{fl-swamp}, they can't rise again, as
-long as they're in the water.
-
-Marbles may jump over @ref{fl-water} with an
- at ref{it-spring[1/2/board]}.
-
-
- at c ================== Items ====================
-
- at node Items
- at section Items
-
- at menu
-* Item List::                   A complete list of all items
-* System and Debug Items::      Items for System, Debug and Compatibility
-* Hills and Hollows::           Hills and Hollows
-* Fire and Extinguisher::       Fire and Extinguisher
-* it-abyss::                    Abyss as Item
-* it-bag::                      Bag
-* it-banana::                   Banana
-* it-blackbomb::                Black Bomb
-* it-blocker::                  Blocker Item
-* it-booze::                    Booze
-* it-booze-broken::             Broken Booze
-* it-brake::                    Brake Item
-* it-brush::                    Brush
-* it-changefloor::              Changefloor Item
-* it-cherry::                   Cherry
-* it-coffee::                   Coffee Pause Item
-* it-coin::                     Coins
-* it-crack::                    Cracks in the Floor
-* it-cross::                    Cross on the Floor
-* it-death::                    Death Item
-* it-document::                 Scrolls of Paper
-* it-drop::                     Transmuting Liquid
-* it-dynamite::                 Dynamite
-* it-extralife::                Extralife
-* it-flag[black/white]::        Black and White Flag
-* it-floppy::                   Floppy Disk
-* it-glasses::                  Glasses
-* it-hammer::                   Hammer
-* it-[h/v]strip::               Floor Strips
-* it-key::                      Key
-* it-landmine::                 Landmine
-* it-magicwand::                Magic Wand
-* it-magnet::                   Magnets
-* it-odometer::                 Odometer
-* it-pencil::                   Pencil
-* it-pin::                      Pin
-* it-pipe::                     Pipes
-* it-puller::                   Puller Items
-* it-ring::                     Ring
-* it-rubberband::               Rubberband
-* it-seed::                     Seeds
-* it-sensor::                   Sensor
-* it-shogun::                   Shogun Items
-* it-spade::                    Spade
-* it-spoon::                    Spoon
-* it-spring[1/2/board]::        Springs and Springboard
-* it-squashed::                 Squashed Fruit
-* it-surprise::                 Surprise Item
-* it-sword::                    Sword
-* it-trigger::                  Trigger
-* it-umbrella::                 Umbrella
-* it-vortex::                   Vortices for Teleporting
-* it-weight::                   Weight
-* it-whitebomb::                White Bomb
-* it-wormhole::                 Wormhole
-* it-wrench::                   Wrench
-* it-yinyang::                  Yinyang Item
- at end menu
-
- at node Item List
- at subsection Item List
-
- at example
-it-1pkillstone
-it-2pkillstone
-it-abyss
-it-bag
-it-banana
-it-blackbomb
-it-blackbomb_burning
-it-blocker
-it-blocker-new
-it-booze
-it-booze-broken
-it-brake
-it-bridge-oxyd
-it-bridge-oxyd_active
-it-brush
-it-burnable
-it-burnable_ash
-it-burnable_burning
-it-burnable_fireproof
-it-burnable_ignited
-it-changefloor
-it-cherry
-it-coffee
-it-coin1( value )
-it-coin2( value )
-it-coin4( value )
-it-crack@{0..3@} ( type fixed brittleness )
-it-cross( action target )
-it-debris
-it-document( text )
-it-drop
-it-dummy
-it-dynamite
-it-easykeepstone
-it-easykillstone
-it-explosion1
-it-explosion2
-it-explosion3
-it-extinguisher( load )
-it-extinguisher_empty( load )
-it-extinguisher_medium( load )
-it-extralife
-it-flagblack
-it-flagwhite
-it-floppy
-it-glasses
-it-glasses-broken
-it-hammer
-it-hill
-it-hollow( essential )
-it-hstrip
-it-inversesensor( action target )
-it-key( keycode )
-it-key_a
-it-key_b
-it-key_c
-it-landmine
-it-magicwand
-it-magnet( on strength range )
-it-magnet-off( on strength range )
-it-magnet-on( on strength range )
-it-odometer
-it-oxyd5f( action target )
-it-pencil
-it-pin
-it-pipe-e
-it-pipe-es
-it-pipe-h
-it-pipe-n
-it-pipe-ne
-it-pipe-s
-it-pipe-sw
-it-pipe-v
-it-pipe-w
-it-pipe-wn
-it-puller-e
-it-puller-n
-it-puller-s
-it-puller-w
-it-ring
-it-rubberband( target length strength minlength scissor)
-it-seed
-it-seed_nowood
-it-seed_volcano
-it-sensor( action target )
-it-shogun-l( action target )
-it-shogun-m( action target )
-it-shogun-s( action target )
-it-signalfilter0( action target )
-it-signalfilter1( action target )
-it-spade
-it-spoon
-it-spring1
-it-spring2
-it-springboard
-it-squashed
-it-surprise
-it-sword
-it-tinyhill
-it-tinyhollow( essential )
-it-trigger( action target invisible )
-it-umbrella
-it-vortex-closed( autoclose targetx targety )
-it-vortex-open( autoclose targetx targety )
-it-vstrip
-it-weight
-it-whitebomb
-it-wormhole( on targetx targety strength range interval )
-it-wormhole-off( on targetx targety strength range interval )
-it-wrench
-it-yinyang
- at end example
-
-
- at c -------------------- System and Debug Items --------------------
- at node System and Debug Items
- at subsection System and Debug Items
-
-Enigma includes several items that are not meant as items in the usual way:
-
- at table @code
- at item it-1pkillstone, it-2pkillstone
-Kills the stone on the same tile in single-player mode
-(correspondingly in multi-player mode). Unused, due to Enigma's missing networking
-capability.
-
- at item it-bridge-oxyd, it-bridge-oxyd_active
-Used for Oxyd compatibility to animate bridges. Use @ref{fl-bridge}
-instead.
-
- at item it-debris
-Animation of a breaking floor. Creates @ref{fl-abyss}, then kills
-itself.
-
- at item it-dummy
-Prints its own Oxyd code when picked up or used. Compare
- at ref{fl-dummy} and @code{st-dummy} (@ref{Oxyd Compatibility Stones}).
-
- at item it-easykillstone
-Kills the stone on the same tile in easy mode; if it is one of
- at ref{st-death}, @ref{st-flash} or @ref{st-thief}, it is transformed to
- at ref{st-plain} instead.
-
- at item it-easykeepstone
-Kills the stone on the same tile in normal mode; no exceptions.
-
- at item it-explosion[1,2,3]
-Sets a visual explosion effect of strength 1 (no remainder), 2
-(@code{it-hollow} remains, see @ref{Hills and Hollows}) or 3
-(@code{it-debris} remains, shattering the floor).
-
- at item it-oxyd5f
-When a message is sent to this item, it performs its
- at code{action/target}-pair. Used for Oxyd compatibility only.
-
- at item it-signalfilter[0/1]
-Transforms signal 1 to signal 0 or 1, forgets signal 0. Used for Oxyd
-compatibility only.
-
- at end table
-
-
- at c -------------------- Hills and Hollows  --------------------
- at node Hills and Hollows
- at subsection Hills and Hollows
-
- at code{it-hill} and @code{it-hollow} create small hills and hollows in
-the floor, @code{it-tinyhill} and @code{it-tinyhollow} are smaller
-versions.  The strength of the slope is given by
- at code{enigma.HoleForce} (see @ref{Old API - Variables}).
-
-When a stone is pushed over them or an @ref{it-spade} is used on them,
-they decrease their size: @code{it-hill} and @code{it-hollow} become
- at code{it-tinyhill} and @code{it-tinyhollow}; the latter two disappear
-completely.
-
- at strong{Messages}
-
- at table @code
- at item trigger
-Converts a hill to a hollow and vice versa.
- at item shovel
-Hills and hollows are replaced by their tiny versions; tiny ones are
-removed.
- at item signal
-0: become @code{it-hollow} or @code{it-tinyhollow}, 1: become
- at code{it-hill} or @code{it-tinyhill}
- at end table
-
- at strong{Attributes}
-
- at table @code
- at item essential
-only @code{it-tinyhollow} and @code{it-hollow}, see below
- at end table
-
- at strong{In Meditation Levels}
-
-If all existing @ref{ac-whiteball-small} are inside hollows
-(@code{it-hollow} or @code{it-tinyhollow}), the level succeeds.
-
-Use the @code{essential}-attribute if there are more holes than small
-whiteballs in a level, and you want to determine which of the holes are
-needed to finish the level (1 means this hollow must be filled with a
-whiteball to end the level).
-
-For example: If you have many holes and 3 whiteballs, then set
- at code{essential=1} in 3 holes.  The game will end when the 3
-whiteballs are inside the 3 marked holes.
-
-Note that hollows might appear or disappear during the game; they are
-handled the same way as described above.
-
-
- at c -------------------- Fire and Extinguisher  --------------------
- at node Fire and Extinguisher
- at subsection Fire and Extinguisher
-
-Compare @ref{Fire Spreading}.
-
-Six items are particular to the fire system:
- at itemize
- at item Use @code{it-burnable} to allow a floor tile to catch fire, and
-it ignites from explosions, like from @ref{it-dynamite},
- at ref{it-blackbomb} and @ref{it-whitebomb}.
- at item @code{it-burnable_oil} is the visible variant of the invisible
- at code{it-burnable}.
- at item @code{it-burnable_ignited} carries the starting-animation of
-fire. Use the @code{setfire}-message to a floor instead.
- at item @code{it-burnable_burning} carries the animation of burning
-fire. Use @code{setfire} instead.
- at item @code{it-burnable_ash} is the unburnable remnant of a fire.
- at item @code{it-burnable_fireproof} saves a floor from fire.
- at end itemize
-
-Use @code{it-extinguisher} to set @code{it-burnable_fireproof}. After
-using it once, it becomes @code{it-extinguisher_medium}, which guards
-less floor, and itself becomes @code{it-extinguisher_empty}, which can
-be laid down again.
-
- at c -------------------- Abyss as Item --------------------
- at node it-abyss
- at subsection it-abyss
-
-Use this to set an invisible alternative to @ref{fl-abyss}.  Note
-however, that @ref{st-wood} doesn't fill @code{it-abyss} as it does
-with @code{fl-abyss}.  Marbles may jump over @code{it-abyss} with an
- at code{it-spring[1/2/board]}, in contrast to @ref{it-death}.  Also,
-compare to @ref{it-booze-broken}.
-
-
- at c -------------------- Bag --------------------
- at node it-bag
- at subsection it-bag
-
-As long as @code{it-bag} is at the first place in the inventory, new
-items are put into the bag instead of the inventory, until the bag is
-full (13 items). The player can drop @code{it-bag} anytime.  When picked up again,
-items from the bag are put back into the inventory (until it is full).
-
-The quite complex rules in detail:
-
- at enumerate
- at item
-Inventory and bag are limited concerning pickups to 13 items.
-
- at item
-Both are LIFO (last item picked up is first item out) - besides inventory rotation.
-
- at item
-If you pick up any item besides a bag and your first inventory item is not a bag
-the item is added to the inventory.
-
- at item
-If you pick up any item besides a non-empty bag and your first inventory item is
-a bag the item is added to the first inventory bag (this includes non-empty bags
-into bags!)
-
- at item
-You empty a bag by picking it up with any item at the first inventory position
-but a bag. As many items as possible are taken from the bag and added to the
-inventory.
-
- at item
-Empty bags are never put into other bags (this would cause unresolvable recursion
-problems - see below). They will only be added to the inventory.
-
- at item
-If the touched bag cannot empty its contents to the inventory or a bag at the
-inventory position is full the bag is not picked up and keeps the remaining items.
-
- at end enumerate
-
- at code{it-bag} is created by @ref{st-thief} and @ref{fl-thief} when
-they're captured by @ref{st-chess_[black/white]}.
-
-
- at c -------------------- Banana --------------------
- at node it-banana
- at subsection it-banana
-
- at code{it-banana} transforms into @ref{it-cherry} when hit by a laser
-beam, and into @ref{it-squashed} when a stone is pushed over it.
-
-
- at c -------------------- Black Bomb --------------------
- at node it-blackbomb
- at subsection it-blackbomb
-
-This item can't be picked up, but received from @ref{st-bombs}.  It
-can be ignited by lasers, fire and other explosions (other
- at code{it-blackbomb}, @ref{it-whitebomb}, @ref{it-dynamite}, exploding
- at code{st-bombs} above them), messages ``ignite'', ``expl'' and
-``explosion'' and by pushing stones over them (except for
- at ref{st-shogun-<sml>} and, in Oxyd compatibility mode,
- at ref{st-wood}).
-
-When exploding, @code{it-blackbomb} ignites or destroys neighboring
-items, and destroys its own floor tile by replacing it against
- at code{fl-abyss}. See also @ref{it-whitebomb} for a stronger version.
-
- at strong{Messages}
-
- at table @code
- at item ignite, expl
-ignite, then explode
- at item explode
-explode instantly
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-blackbomb
- at item it-blackbomb_burning
- at end table
-
-
- at c -------------------- Blocker Item --------------------
- at node it-blocker
- at subsection it-blocker
-
-This item is the shrunken form of @ref{st-blocker}.  When it is hit by
- at ref{st-bolder}, it becomes @code{st-blocker} again.  It can be
-destroyed with @ref{it-brake}.
-
- at strong{Messages}
-
- at table @code
- at item trigger, openclose
-If shrunken, grow. Otherwise, change internal state; only sensible
-while a stone is on top of @code{it-blocker}.
- at item open, close
-These are complicated, but in most cases @code{close} makes the item
-grow. Consult the source code for details.
- at item signal
-1: open, 0: close
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-blocker
- at item it-blocker-new
-doesn't grow at once when @code{st-bolder} just arrives (acts as if
-recently shrank)
- at end table
-
-
- at c -------------------- Booze --------------------
- at node it-booze
- at subsection it-booze
-
-When used, the actor becomes slower for a short period of time.  Note
-that @code{it-booze} is still under development; its behavior might be
-changed.
-
-When hit by a stone, @code{it-booze} transforms into
- at ref{it-booze-broken}.
-
-
- at c -------------------- Broken Booze --------------------
- at node it-booze-broken
- at subsection it-booze-broken
-
-The remnants of @ref{it-booze} after pushing a
-stone over it. Kills a marble that touches it, but not when it is jumping with
- at ref{it-spring[1/2/board]} or protected by @ref{it-umbrella}, compare
- at ref{it-abyss} and @ref{it-death}.  Can be removed with @ref{it-brush}
-while jumping over it, or otherwise protected.
-
-
- at c -------------------- Brake Item --------------------
- at node it-brake
- at subsection it-brake
-
-When used, this item creates an @ref{st-brake}, which itself can be
-picked up as @code{it-brake} again.  It can be used to destroy
- at ref{it-blocker}.
-
-
- at c -------------------- Brush --------------------
- at node it-brush
- at subsection it-brush
-
-This item can be used to make some invisible stones visible
-(@code{st-actorimpulse_invisible} (see @ref{st-actorimpulse}),
- at code{st-break_invisible} (see @ref{Breakable-Stones}),
- at code{st-stonebrush} (see @ref{st-invisible}), and to remove debris
-from the level: (@ref{it-cross}, @ref{it-squashed},
- at ref{it-booze-broken}, @code{it-glasses-broken} (see
- at ref{it-glasses}), @code{it-burnable_ash},
- at code{it-burnable_fireproof} (see @ref{Fire and Extinguisher})).
-
-In addition, this item can be used to transform @code{st-firebreak}
-into @code{st-plain} and @code{st-firebreak_move} into
- at code{st-plain_move} (see @ref{st-firebreak[_move]} and
- at ref{st-plain}).
-
-The Per.Oxyd-compatibility stone @code{st-yinyang3} (see
- at ref{st-yinyang}) must be touched with an @code{it-brush} or
- at ref{it-magicwand} in order to activate it.
-
-
- at c -------------------- Changefloor Item --------------------
- at node it-changefloor
- at subsection it-changefloor
-
-When in multi-player mode, this item exchanges @code{fl-acblack} and
- at code{fl-acwhite} below it after an actor has left it (see
- at ref{fl-ac[black/white]}).  This way the marble can't roll back
-as easily as before.  Try the original Per.Oxyd Link Level 69 to see
-this scarcely-used item in action.
-
-
- at c -------------------- Cherry --------------------
- at node it-cherry
- at subsection it-cherry
-
-When used, the marble becomes invisible for a short time.
-Some benefits of this are that rotors and tops can't find it and
-it can walk through glass. There are some different glassstones, and not all
-may be passed when invisible. For details, see @ref{Glassstones}.
-When a stone is pushed over @code{it-cherry}, it becomes
- at ref{it-squashed}.
-
-
- at c -------------------- Coffee --------------------
- at node it-coffee
- at subsection it-coffee
-
- at code{it-coffee} is supposed to pause the game; not implemented yet.
-
-
- at c -------------------- Coins --------------------
- at node it-coin
- at subsection it-coin
-
-Activates @ref{st-coinslot}.
-
-When hit by a stone, @code{it-coin2} transforms into @code{it-coin4},
-and @code{it-coin1} into @code{it-coin2}.  A laser beam transforms
- at code{it-coin1}, @code{it-coin2}, and @code{it-coin4} into
- at ref{it-umbrella}, @ref{it-hammer}, and @ref{it-extralife}.
-
- at strong{Attributes}
-
- at table @code
- at item value
-Determines how long @ref{st-coinslot} keeps activated. Defaults:
- at code{it-coin1} 3.0, @code{it-coin2} 6.0, @code{it-coin4} 12.0.
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-coin1
- at item it-coin2
- at item it-coin4
- at end table
-
-
- at c -------------------- Cracks --------------------
- at node it-crack
- at subsection it-crack
-
-Represents cracks in the floor. @code{it-crack0} is invisible and
-grows to @code{it-crack1}, @code{it-crack2}, @code{it-crack3}, after
-which the floor disintegrates to @ref{fl-abyss}.
-
-The @code{brittleness}-attribute and
- at code{enigma.Brittleness}-variable determine the probability that a
-crack grows when an actor enters. When the crack grows, it spreads to
-neighboring unoccupied tiles.  If you want to suppress this, set
- at code{enigma.Brittleness} to 0.0 and the @code{brittleness}-attribute
-of the cracks to 0.5 (or whatever you like, also see @ref{Old API - Variables}).
-
- at strong{Attributes}
-
- at table @code
- at item type
-0, 1, 2, or 3
- at item fixed
-0: crack can grow, 1: crack doesn't grow
- at item brittleness
-overrides @code{enigma.Brittleness}
- at end table
-
- at strong{Messages}
-
- at table @code
- at item crack
-grow by one step
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-crack0
- at item it-crack1
- at item it-crack2
- at item it-crack3
- at end table
-
-
- at c -------------------- Cross --------------------
- at node it-cross
- at subsection it-cross
-
-Marks an interesting spot, can be created with an @ref{it-pencil} and
-removed with @ref{it-brush}.
-
-When a marble remains on the cross for at least 10 seconds,
- at code{it-cross} performs its @code{action/target} (only once, not
-every 10 seconds).   @ref{it-trigger} and
- at ref{it-sensor} have similar functions.
-
- at strong{Attributes}
-
- at table @code
- at item action, target
-as usual
- at end table
-
- at strong{Messages}
-
- at table @code
- at item brush
-remove @code{it-cross}
- at item signal
-performs @code{action/target} with inverted signal-data; works only in
-Per.Oxyd-compatibility mode
- at end table
-
-
- at c -------------------- Death Item --------------------
- at node it-death
- at subsection it-death
-
-Kills a marble that touches it, even when it is jumping with
- at ref{it-spring[1/2/board]}, compare @ref{it-abyss} and
- at ref{it-booze-broken}.  @ref{it-umbrella} protects the marble.
-
-
- at c -------------------- Document --------------------
- at node it-document
- at subsection it-document
-
-This item looks like a piece of paper and contains a text message that
-can be displayed by activating the item.  It is destroyed by
-explosions (like from @ref{it-blackbomb}, @ref{it-whitebomb},
- at ref{st-bombs} and also @ref{it-dynamite}).
-
- at strong{Attributes}
-
- at table @code
- at item text
-The message to be displayed.
- at end table
-
- at strong{Messages}
-
- at table @code
- at item expl, bombstone
-destroy
- at item ignite
-destroy if not in Oxyd compatibility mode
- at end table
-
- at strong{Example}
- at example
-set_item("it-document", 1,1, @{text="Hello World!"@})
-Document(1,1, "Hello World")
- at end example
-
- at c -------------------- Drop --------------------
- at node it-drop
- at subsection it-drop
-
-Transforms the marble into an @ref{ac-rotor} for a short time.
-Can be used multiple times.
-
- at c -------------------- Dynamite --------------------
- at node it-dynamite
- at subsection it-dynamite
-
- at code{it-dynamite} can be ignited by dropping it, by lasers, fire,
-other explosions (@ref{it-blackbomb}, @ref{it-whitebomb}, other
- at code{it-dynamite} and @ref{st-bombs}).  While burning, it can't be
-picked up.  During explosion (@code{it-explosion2}, see
- at ref{System and Debug Items}), it ignites neighboring items and
-leaves an @code{it-hollow} behind (see @ref{Hills and Hollows}). On
- at ref{fl-ice}, it creates @code{it-crack2} instead (see @ref{it-crack}).
-
-On @ref{fl-space}, dynamite is supposed to result in shards. This is
-not implemented yet: It creates @code{it-hollow} without explosion.
-Note that this and the exact implementation of explosions might change
-in future versions.
-
- at strong{Messages}
-
- at table @code
- at item ignite, expl, bombstone
-ignite, then explode
- at item explode
-explode instantly
- at end table
-
-
- at c -------------------- Extralife --------------------
- at node it-extralife
- at subsection it-extralife
-
-Adds a life to the player's inventory.
-
-A laser beam transforms this into @ref{it-glasses}, and
- at code{it-extralife} itself results from @code{it-coin4} (see
- at ref{it-coin}).
-
-
- at c -------------------- Black and White Flag --------------------
- at node it-flag[black/white]
- at subsection it-flag[black/white]
-
-Marks the place, where @ref{ac-blackball} respectively
- at ref{ac-whiteball} respawn when killed.  For this purpose, they have
-to be used at least once.
-
-
- at c -------------------- Floppy --------------------
- at node it-floppy
- at subsection it-floppy
-
-The floppy disk is needed to activate the floppy switch (see
- at ref{st-floppy}).
-
-
- at c -------------------- Glasses --------------------
- at node it-glasses
- at subsection it-glasses
-
-While @code{it-glasses} is in the inventory, hollow stones become
-invisible and @code{st-death_invisible} becomes visible (see
- at ref{st-death}).
-
- at code{it-glasses} breaks when a stone is pushed over it, and becomes
-the inactive version @code{it-glasses-broken}.  @code{it-glasses}
-results from the laser transformation of @ref{it-extralife}.
-
- at strong{Variants}
-
- at table @code
- at item it-glasses
- at item it-glasses-broken
- at end table
-
-
- at c -------------------- Hammer --------------------
- at node it-hammer
- at subsection it-hammer
-
-The hammer is used to destroy some stones, see @ref{Breakable
-Stones} and @ref{st-lightpassenger}. It also transforms into
- at ref{it-sword} when hit with a laser beam and is itself a
-laser transformation result of @ref{it-sword} and @code{it-coin2} (see
- at ref{it-coin}).
-
-
- at c -------------------- Horizontal and Vertical Land Strip --------------------
- at node it-[h/v]strip
- at subsection it-[h/v]strip
-
-These items cover a small strip of the ground below them and provide a
-narrow bridge for the marble to safely pass @ref{fl-abyss},
- at ref{fl-swamp}, @ref{fl-water}, or any other floor.
-
- at strong{Variants}
-
- at table @code
- at item it-hstrip
-horizontal
- at item it-vstrip
-vertical
- at end table
-
-
- at c -------------------- Key --------------------
- at node it-key
- at subsection it-key
-
-Used to activate @ref{st-key}.
-
- at strong{Attributes}
-
- at table @code
- at item keycode
-see @ref{st-key}
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-key
- at code{keycode} is 1
- at item it-key_a
- at code{keycode} is 1
- at item it-key_b
- at code{keycode} is 2
- at item it-key_c
- at code{keycode} is 3
- at end table
-
-
- at c -------------------- Landmine --------------------
- at node it-landmine
- at subsection it-landmine
-
-Explodes when hit by a marble or by a stone, shatters the marble, and
-leaves an @code{it-hollow} behind (see @ref{Hills and Hollows}).
-
-
- at c -------------------- Magic Wand --------------------
- at node it-magicwand
- at subsection it-magicwand
-
- at itemize @bullet
- at item
-Changes direction of a oneway stone (@ref{st-oneway}).
- at item
-Changes direction of a bolder stone (@ref{st-bolder}).
- at item
-Scrambles blue puzzle stones instead of pushing, causes complete
-clusters to explode (@ref{st-puzzle}).
- at c @item
- at c not implemented?  st-stoneimpulse_movable doesn't pulse
- at item
-Makes @code{st-brick_magic} transparent (@ref{st-brick_magic}).
- at item
-Makes @code{st-invisible_magic} visible and non-transparent
-(@ref{st-invisible}).
- at item
-Makes rubberband stones movable (@ref{st-rubberband}).
- at item
-Changes the color of a chess stone (@ref{st-chess_[black/white]}).
- at item
-Activates @code{st-yinyang3} (@ref{st-yinyang}).
- at end itemize
-
-
- at c -------------------- Magnet --------------------
- at node it-magnet
- at subsection it-magnet
-
-Attracts actors in its @code{range} with a force proportional to
- at code{strength} and the inverse of the distance.  The magnet can be on
-or off.
-
- at strong{Attributes}
-
- at table @code
- at item on
- at code{TRUE} or @code{FALSE}, see variants below
- at item strength
-default: 30
- at item range
-default: 1000 (quasi infinite)
- at end table
-
- at strong{Messages}
-
- at table @code
- at item on, off, onoff
-as usual
- at item signal
-0: off, 1: on
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-magnet
-by default off
- at item it-magnet-on
- at item it-magnet-off
- at end table
-
-
- at c -------------------- Odometer --------------------
- at node it-odometer
- at subsection it-odometer
-
-Supposed to measure the route the marble has rolled since picking up
- at code{it-odometer}.  Not implemented yet.
-
-
- at c -------------------- Pencil --------------------
- at node it-pencil
- at subsection it-pencil
-
-Try to scratch an @ref{it-cross} into the floor; the pencil is lost
-after this. Scratching onto ice results in a crack, scratching
-while flying or on certain floors results in dropping the pencil.
-
-In addition, this item can be used to transform @code{st-plain} into
- at code{st-firebreak} and @code{st-plain_move} into
- at code{st-firebreak_move} (see @ref{st-plain} and
- at ref{st-firebreak[_move]}).
-
-
- at c -------------------- Pin --------------------
- at node it-pin
- at subsection it-pin
-
-While in inventory, @code{it-pin} increases the friction of the
-floor.  Used in conjunction with @ref{fl-ice}.
-
-
- at c -------------------- Pipes --------------------
- at node it-pipe
- at subsection it-pipe
-
-Pipes are used by @ref{st-mail} to transport items over large
-distances or onto unreachable grounds.  Pipes can be destroyed by
-explosions (such as from @ref{it-blackbomb} or @ref{it-whitebomb}).
-
- at strong{Variants}
-
- at table @code
- at item it-pipe-e
- at item it-pipe-w
- at item it-pipe-s
- at item it-pipe-n
- at item it-pipe-es
- at item it-pipe-ne
- at item it-pipe-sw
- at item it-pipe-wn
- at item it-pipe-h
-horizontal
- at item it-pipe-v
-vertical
- at end table
-
-The first four variants depict endpoints of the pipe, they're of no
-use to @ref{st-mail} other than blocking the endpoint.
-
-
- at c -------------------- Puller --------------------
- at node it-puller
- at subsection it-puller
-
-When dropped, these items pull a stone from the direction they point
-to, to their own position.  They explode during this, shattering
-marbles near them.
-
- at strong{Variants}
-
- at table @code
- at item it-puller-e
- at item it-puller-w
- at item it-puller-s
- at item it-puller-n
- at end table
-
-
- at c -------------------- Ring --------------------
- at node it-ring
- at subsection it-ring
-
-When a player drops this item, the marble is teleported.  The
-destination depends on the game mode:
-
- at table @emph
- at item Single player levels:
-The marble is transported to its starting position or
-to the position of the last dropped @ref{it-flag[black/white]}.
-
- at item Multi player levels:
-Both marbles exchange their positions.  In contrast to
- at ref{it-yinyang}, the positions are exchanged, not the players.
- at end table
-
-
- at c -------------------- Rubberband --------------------
- at node it-rubberband
- at subsection it-rubberband
-
-Connects the actor using it with a target. This target can be an other actor or a stone.
-The target is determined by its name-attribute. If the target doesn't exist,
-the it-rubberband will be dropped.
-
- at strong{Attributes}
-
- at table @code
- at item target
-The target to connect with. It must be the name of an other actor or a stone.
- at item length
-The natural length of the rubberband (default: 1)
- at item strength
-The strength of the rubberband (default: 10)
- at item minlength
-The minimal length of the rubberband (default: 0)
- at item scissor
-Boolean value defining if already-existing rubberbands to the actor should be cut off.
-(Default: false)
- at end table
-
- at subsection Examples
-
- at example
-set_stones("st-glass", 5, 5, @{name="MyRubberTarget1"@})
- at dots{}
--- When used, this it-rubberband will connect the actor with the glassstone.
-set_item("it-rubberband", 3, 5, @{target="MyRubberTarget1"@})
- at end example
-
- at c -------------------- Seeds --------------------
- at node it-seed
- at subsection it-seed
-
-Stones can grow from three different seeds:
- at code{it-seed} creates @ref{st-wood}, @code{it-seed_nowood} creates
- at code{st-greenbrown-growing}, which produces the unmovable simple
-stone @code{st-greenbrown}, and @code{it-seed_volcano} that creates
-an @ref{st-volcano}.  The new
-stone inherits the name of the seed.
-
-In Oxyd-Magnum-compatibility mode, @code{it-seed} under
- at code{st-grate1} (see @ref{st-grate}) grows to the simple floor
- at code{fl-stwood} instead of destroying the grate.  In all other cases,
-stones at the position of the seed are replaced by the new stone.
-
-Seeds start growing on dropping them, on laser beams, stone hits and
-the @code{grow} and @code{signal}-messages.
-
- at strong{Messages}
-
- at table @code
- at item grow, signal
-start growing
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-seed
- at item it-seed_nowood
- at item it-seed_volcano
- at end table
-
-
- at c -------------------- Sensor --------------------
- at node it-sensor
- at subsection it-sensor
-
-This is an invisible, quiet and less extensive version of
- at ref{it-trigger}.  Whenever an actor enters it, it performs its
- at code{action/target}-pair, with second data @code{TRUE} for
- at code{it-sensor} and @code{FALSE} for @code{it-inversesensor}.
-Also compare @ref{it-cross}.
-
- at strong{Attributes}
-
- at table @code
- at item action, target
-as usual
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-sensor
- at item it-inversesensor
- at end table
-
-
- at c -------------------- Shogun Item --------------------
- at node it-shogun
- at subsection it-shogun
-
-Performs its @code{action/target}-pair when an @ref{st-shogun-<sml>}
-of fitting size covers it.
-
- at strong{Attributes}
-
- at table @code
- at c @item size couldn't find this in code, though announced in remark
- at item target, action
-as usual
- at end table
-
- at strong{Messages}
-
- at table @code
- at item noshogun
-deactivate
- at item shogun @enddots{}
-used to activate or deactivate @code{it-shogun}
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-shogun-s
- at item it-shogun-m
- at item it-shogun-l
- at end table
-
-
- at c -------------------- Spade --------------------
- at node it-spade
- at subsection it-spade
-
-Decreases the size of an @code{it-hill} or @code{it-hollow} and
-removes @code{it-tinyhill} and @code{it-tinyhollow}, see @ref{Hills
-and Hollows}.
-
-
- at c -------------------- Spoon --------------------
- at node it-spoon
- at subsection it-spoon
-
-Shatters the marble.  Note that in contrast to F3, @code{it-spoon}
-only shatters the marble using it, not all of them.
-
-
- at c -------------------- Springs --------------------
- at node it-spring[1/2/board]
- at subsection it-spring[1/2/board]
-
-Springs let marbles jump, e.g., over @ref{fl-water}, @ref{fl-swamp},
- at ref{fl-abyss}, @ref{it-abyss}, and laser beams.  Note that you can't
-jump over any kind of stone, or pass @ref{st-grate} during the
-jump, even if you could on the ground.  The interplay of jumping and
-fire (@ref{Fire Spreading}) will be target of future changes;
-don't use them together yet.
-
-You can pick up and use @code{it-spring1} and @code{it-spring2}.  You
-keep the former in the inventory, but in general, drop
- at code{it-spring2} when using.  @code{it-springboard} is fixed to the
-ground; you can only use it where it is.
-
-When you're already sinking in @code{fl-swamp} or @code{fl-water}, you
-can use springs to jump out of them, sinking then starts anew.
-
- at strong{Variants}
-
- at table @code
- at item it-spring1
- at item it-spring2
- at item it-springboard
- at end table
-
-
- at c -------------------- Squashed Fruits --------------------
- at node it-squashed
- at subsection it-squashed
-
-The remnants of @ref{it-cherry} or @ref{it-banana} after pushing a
-stone over them.  Can be removed with @ref{it-brush}.
-
-
- at c -------------------- Surprise Item --------------------
- at node it-surprise
- at subsection it-surprise
-
-This item turns randomly into @ref{it-umbrella}, @code{it-spring1} (see
- at ref{it-spring[1/2/board]}), @ref{it-dynamite}, @ref{it-coffee}, or
- at ref{it-hammer} when dropped.  The corresponding stone is @ref{st-surprise}.
-
-
- at c -------------------- Sword --------------------
- at node it-sword
- at subsection it-sword
-
-Used to neutralize @ref{st-knight}.  The laser transforms it into
- at ref{it-hammer} and vice versa.
-
-
- at c -------------------- Trigger --------------------
- at node it-trigger
- at subsection it-trigger
-
-When pushed down by an actor or a stone, this trigger performs its
- at code{action/target}-pair, and a second time when it is released
-again. As second data it uses @code{TRUE} when pressed, and
- at code{FALSE} if not.
-
-Floating stones do not hold down a trigger, except of the tunnel
-puzzle-stone (see @ref{st-puzzle}).
-
- at code{it-trigger} can be initialized as invisible with attribute
- at code{invisible = TRUE}.  Note that it still produces its
-click-sounds.  For a simpler version, see @ref{it-sensor}.  Also
-compare @ref{it-cross}.
-
- at strong{Attributes}
-
- at table @code
- at item invisible
-0.0 (visible) or 1.0 (invisible), by default 0.0
- at item action, target
-as usual
- at end table
-
- at strong{Messages}
-
- at table @code
- at item signal
-perform @code{action/target} according to second data
- at end table
-
-
- at c -------------------- Umbrella --------------------
- at node it-umbrella
- at subsection it-umbrella
-
- at code{it-umbrella} temporarily protects a marble from @ref{st-death},
- at ref{st-knight}, @ref{st-thief}, @ref{fl-abyss}, @ref{fl-water},
- at ref{fl-swamp}, @ref{fl-thief}, @ref{it-death}, @ref{it-abyss},
- at ref{it-booze-broken}, explosions, moving stones and the ``shatter''
-and ``fall''-messages; in other words, from all lethal situations and
-thieves.
-
- at code{it-umbrella} can be destroyed by laserlight and is the result of
-laser-transforming an @code{it-coin1} (see @ref{it-coin}).
-
-
- at c -------------------- Vortex --------------------
- at node it-vortex
- at subsection it-vortex
-
-Vortices, like @ref{it-wormhole}, can be used to teleport marbles.  In
-the simplest case, every vortex is connected to exactly one other
-vortex. If there are multiple target vortices, the marble will be
-teleported to the first @emph{unblocked} target site.  Many levels in
-the original Oxyd games required the player to selectively block
-vortices to gain access to new parts of the level.
-
-In a further contrast to wormholes, vortices can be open or closed,
-and when marbles exit, they jump out of them.  Furthermore, connecting
-vortices in a cycle works as expected and is standard (though not
-necessary), whereas connecting wormholes cyclic results in an
-error-message (as long as their @code{interval}-message isn't used).
-
- at strong{Attributes}
-
- at table @code
- at item targetx, targety
-destination of teleport
- at item autoclose
-not implemented yet, see variants below
- at end table
-
- at strong{Messages}
-
- at table @code
- at item open, close, openclose
-as they say
- at item trigger
-identical to @code{openclose}
- at item signal
-0: close, 1: open
- at item arrival
-used by the teleport-system, don't use in levels
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-vortex-open
-This vortex starts open and doesn't close when an actor jumps out of
-it. Default teleportation target is the own position, thus an actor
-keeps jumping in and out of it until moved away.
- at item it-vortex-closed
-This vortex starts closed and closes again when an actor jumps out of
-it.  If you want to create an open vortex that closes after an actor,
-send a @code{trigger}-message to @code{it-vortex-closed} on
-initialization.
- at end table
-
-Note that @code{it-vortex-open} and @code{it-vortex-closed} @emph{do
-behave differently}, in contrast to their names.
-
- at strong{Example}
-
-This example creates three vortices.  If the second vortex is blocked, a
-marble falling into the first one is transported to (20,1).
-
- at example
-set_item ("it-vortex-open", 1, 1)
-set_item ("it-vortex-open", 10,1)
-set_item ("it-vortex-open", 20,1)
-Signal ("it(1 1)", "it(10 1)")
-Signal ("it(1 1)", "it(20 1)")
-Signal ("it(10 1)", "it(1 1)")
-Signal ("it(20 1)", "it(1 1)")
- at end example
-
-
- at c -------------------- Weight --------------------
- at node it-weight
- at subsection it-weight
-
-Heightens the mass of the marble (making it more difficult to
-accelerate and guide) and it can't be dropped.  Note that it can still be
-stolen by @ref{st-thief} or @ref{fl-thief} and mailed away with
- at ref{st-mail}.
-
-
- at c -------------------- White Bomb --------------------
- at node it-whitebomb
- at subsection it-whitebomb
-
-This item is the stronger version of @ref{it-blackbomb}, and can't be
-picked up also.  It can be ignited by lasers, fire and other
-explosions (@ref{it-blackbomb}, other @code{it-whitebomb},
- at ref{it-dynamite}), messages ``ignite'', ``expl'' and ``explosion''
-and by pushing stones over them (except for @ref{st-shogun-<sml>} and,
-in Oxyd compatibility mode, @ref{st-wood}).
-
-When exploding, @code{it-whitebomb} ignites or destroys neighboring
-items and destroys all nine neighboring floor tiles by replacing them
-with @code{fl-abyss}.
-
- at strong{Messages}
-
- at table @code
- at item ignite, expl
-ignite, then explode
- at item explode
-explode instantly
- at end table
-
-Note that, in contrast to @ref{it-blackbomb}, white bombs are not
-removed from @ref{st-bombs}-explosions.
-
-
- at c -------------------- Wormhole --------------------
- at node it-wormhole
- at subsection it-wormhole
-
-Teleports actors to the coordinates given by the @code{targetx}- and
- at code{targety}-attributes (compare @ref{it-vortex}).  In addition,
-wormholes have a variable force field, which can be switched on and
-off.
-
-After teleporting an actor, the wormhole's teleporting ability is
-switched off for a time period given by the @code{interval}-attribute,
-which is by default 0.0.
-
- at strong{Attributes}
-
- at table @code
- at item targetx, targety
-exit of the wormhole
- at item strength, range
-strength and range of the force field
- at item on
-whether force field is on
- at item interval
-minimal delay between two teleports
- at end table
-
- at strong{Messages}
-
- at table @code
- at item on, off, onoff
-as usual
- at item signal
-0: off, 1: on
- at end table
-
- at strong{Variants}
-
- at table @code
- at item it-wormhole
- at item it-wormhole-off
-wormhole without force field
- at end table
-
-
- at c -------------------- Wrench --------------------
- at node it-wrench
- at subsection it-wrench
-
-Changes direction of @ref{st-rotator}.
-
-
- at c -------------------- Yinyang Item --------------------
- at node it-yinyang
- at subsection it-yinyang
-
-Toggles between players.  Compare @ref{it-ring} in multiplayer mode.
-
-
- at c ===================  Stones  =======================
-
- at node Stones
- at section Stones
-
- at menu
-* Stone List::                  A complete list of all stones
-* Glassstones::                 A summary of all kinds of glassy stones
-* Breakable-Stones::            A summary of all breakable stones
-* Oxyd Compatibility Stones::   Special stones for Oxyd compatibility and debugging
-* st-actorimpulse::             Bumper Stones
-* st-big[brick/bluesand]::      Big Stones
-* st-[black/white]::            Black and White Stones
-* st-[black/white]balls::       Blackballs Stone and Whiteballs Stone
-* st-block::                    Movable and sinkable stone
-* st-blocker::                  Shrinkable Blocker Stone
-* st-bolder::                   Bolder (or Arrow) Stone
-* st-bombs::                    Bombstone
-* st-brake::                    Brake
-* st-brick_magic::              Magic Brick Stone
-* st-chameleon::                Chameleon Stone
-* st-charge::                   Charge Stones
-* st-chess_[black/white]::      Chess (Knight) Stone
-* st-coffee::                   Coffee Stone
-* st-coinslot::                 Coin Slot Switch
-* st-death::                    Skull Stones
-* st-disco::                    Disco Stones
-* st-door::                     Doors
-* st-easymode::                 Easy Mode Stone
-* st-explosion::                Explosion Stone
-* st-fakeoxyda::                Movable Fake Oxyd Stone
-* st-fart::                     The Infamous Fart Stones
-* st-firebreak[_move]::         Firebreakable Stones
-* st-flash::                    Flash Stone
-* st-floppy::                   Floppy Switch
-* st-fourswitch::               Fourswitch
-* st-grate::                    Various Grates
-* st-invisible::                Invisible Stones
-* st-key::                      Key (or Lock) Stone
-* st-knight::                   Knight Stone
-* st-laser::                    Laser Stones
-* st-laserswitch::              Laser Switch
-* st-lasertimeswitch::          Laser Time Switch
-* st-lightpassenger::           Light Passenger
-* st-mail::                     Mail Stones
-* st-mirror::                   Mirror Stones
-* st-oneway::                   One-way Stones
-* st-oxyd::                     The Famous Oxyd Stones
-* st-plain::                    Plain Stones
-* st-polarswitch::              Light Switch in Polarizator Style
-* st-pull::                     Pull Stone
-* st-puzzle::                   Puzzle Stones
-* st-rotator::                  Rotator Stone
-* st-rubberband::               Rubberband Stone
-* st-scissors::                 Scissors Stone
-* st-shogun-<sml>::             Shogun Stones
-* st-spitter::                  Spitter Stone
-* st-stoneimpulse::             Impulse Stones
-* st-surprise::                 Surprise Stone
-* st-swap::                     Swap Stones
-* st-switch::                   Ordinary Switches
-* st-thief::                    Thief (Thieves)
-* st-timer::                    Timers
-* st-timeswitch::               Time Switch
-* st-turnstile::                Turnstiles
-* st-volcano::                  Volcano
-* st-window::                   Breakable Window
-* st-wood::                     Wooden Stones
-* st-yinyang::                  Yin-Yang Stones
- at end menu
-
-For the common stone attribute @code{freeze_check}, see @ref{Freeze Checking}.
-
- at node Stone List
- at subsection Stone List
-
- at strong{Simple stones}
-
-The following stone types are commonly used for ``decoration''.  They
-generally do not have special properties or abilities.  We use three types of
-abbreviations in the tables: @code{[abc]} stands for any of the
-characters in square brackets, @code{<abc>} stands for any subsequence
-of the characters between the angle brackets (in this case abc, ab, bc,
-a, b, c), and @code{@{1..9@}} indicates a sequence of numbers.
-
- at example
-st-beads
-st-blue-sand
-st-bluegray
-st-bluegray_hole
-st-brick
-st-brownie
-st-bumps
-st-camouflage
-st-camouflage_hole
-st-camouflage_move
-st-dummy
-st-fakeoxyd( blinking )
-st-glass
-st-glass_move
-st-glass[123]
-st-glass[12]_hole
-st-glass[12]_move
-st-greenbrown
-st-greenbrown_hole
-st-greenbrown_move
-st-likeoxyd[abcd]
-st-likeoxyd[abcd]-open
-st-marble
-st-marble_hole
-st-marble_move
-st-metal
-st-metal_hole
-st-redrock
-st-rock@{1..10@}
-st-rock[123]_hole
-st-rock[13]_move
-st-stone[12]
-st-wood[12]
-st-wood_001
-st-woven
-st-yellow
- at end example
-
- at strong{Special stones}
-
-The following stones types are special in the sense that they perform
-some action, either when hit by an actor, or all by themselves.
-
- at example
-st-3mirror( transparent movable orientation )
-st-actorimpulse( force hit_factor hit_distortion_[xx/xy/yx/yy] )
-st-actorimpulse_invisible( force hit_factor hit_distortion_[xx/xy/yx/yy] )
-st-bigbluesand-<nesw>
-st-bigbrick-<nesw>
-st-black@{1..4@}
-st-blackballs
-st-block
-st-blocker
-st-blocker-growing
-st-bolder( direction )
-st-bolder-[ensw]( direction )
-st-bombs
-st-brake
-st-break_acblack
-st-break_acwhite
-st-break_bolder
-st-break_gray
-st-break_invisible
-st-breaking
-st-brick_magic
-st-bug
-st-chameleon
-st-chargeminus( charge )
-st-chargeplus( charge )
-st-chargezero( charge )
-st-chess_black( color direction1 direction2 )
-st-chess_white( color direction1 direction2 )
-st-coffee
-st-coinslot( on action target )
-st-death
-st-death_invisible
-st-disco-dark
-st-disco-light
-st-disco-medium
-st-door( type )
-st-door-h( type )
-st-door-h-open( type )
-st-door-v( type )
-st-door-v-open( type )
-st-door_[abc]
- at c st-dynamite
-st-easymode
-st-explosion
-st-fakeoxyda
-st-fart
-st-firebreak
-st-firebreak_move
-st-flash( hit_factor hit_distortion_[xx,xy,yx,yy] )
-st-flhay
-st-floppy( action target on )
-st-flrock
-st-fourswitch( action target on )
-st-grate[123]
-st-greenbrown-growing
-st-invisible
-st-invisible_magic
-st-key( action target on keycode )
-st-key_[abc]( action target on keycode )
-st-knight
-st-laser( dir on )
-st-laser-[ensw]( dir on )
-st-laserbreak
-st-laserswitch( action target inverse )
-st-lasertimeswitch( action target inverse delay )
-st-lightpassenger( interval friction_factor gradient_factor )
-st-magic
-st-mail-[ensw]
-st-mirror*( movable transparent orientation )
-st-mirror-3<
-st-mirror-3<m
-st-mirror-3<t
-st-mirror-3<tm
-st-mirror-3>
-st-mirror-3>m
-st-mirror-3>t
-st-mirror-3>tm
-st-mirror-3^
-st-mirror-3^m
-st-mirror-3^t
-st-mirror-3^tm
-st-mirror-3v
-st-mirror-3vm
-st-mirror-3vt
-st-mirror-3vtm
-st-mirror-p-
-st-mirror-p-m
-st-mirror-p-t
-st-mirror-p-tm
-st-mirror-p/
-st-mirror-p/m
-st-mirror-p/t
-st-mirror-p/tm
-st-mirror-p\
-st-mirror-p\m
-st-mirror-p\t
-st-mirror-p\tm
-st-mirror-p|
-st-mirror-p|m
-st-mirror-p|t
-st-mirror-p|tm
-st-oneway( orientation )
-st-oneway-[nesw]( orientation )
-st-oneway_black( orientation )
-st-oneway_black-[nesw]( orientation )
-st-oneway_white( orientation )
-st-oneway_white-[nesw]( orientation )
-st-oxyd( flavor color static )
-st-oxyd-0x18
-st-peroxyd-0xb8
-st-peroxyd-0xb9
-st-plain
-st-plain_break
-st-plain_breaking
-st-plain_cracked
-st-plain_falling
-st-plain_hole
-st-plain_move
-st-pmirror( transparent movable orientation )
-st-polarswitch( on )
-st-pull
-st-puzzle-hollow( oxyd )
-st-puzzle-<nesw>( oxyd )
-st-puzzle2-hollow( oxyd )
-st-puzzle2-<nesw>( oxyd )
-st-rock3_break
-st-rock3_movebreak
-st-rotator-left
-st-rotator-right
-st-rotator_move-left
-st-rotator_move-right
-st-rubberband( length strength minlength scissor)
-st-scissors( action target )
-st-shogun-<sml>( holes )
-st-spitter( hit_factor hit_distortion_[xx/xy/yx/yy] )
-st-stone_break
-st-stonebrush
-st-stoneimpulse
-st-stoneimpulse-hollow
-st-stoneimpulse_movable
-st-surprise
-st-swap
-st-switch( action target on )
-st-switch_black( action target on )
-st-switch_white( action target on )
-st-thief
-st-timer( action target on interval loop invisible )
-st-timeswitch( action target delay inverse )
-st-turnstile
-st-turnstile-green
-st-turnstile-[ensw]
-st-volcano
-st-volcano-growing
-st-volcano_active
-st-volcano_inactive
-st-white@{1..4@}
-st-whiteballs
- at c st-whitebombs
-st-window
-st-wood
-st-wood-growing
-st-yinyang@{1..3@}
- at end example
-
- at node Glassstones
- at subsection Glassstones
-
-There are a few kinds of glassstones, all similar, but with different details.
-Some of them may be passed after the use of an @ref{it-cherry}, others will be
-just pushed. Some are transparent for lasers, but not all! This table shows their
-exact properties.
-
- at multitable {st-polarswitch (off)  } {actor is visible:  } {actor is invisible:  } {lasertransparent:  }
- at headitem stone: @tab actor is visible: @tab actor is invisible: @tab lasertransparent:
- at item st-glass @tab - @tab pass @tab yes
- at item st-glass_move @tab push @tab pass @tab yes
- at item st-glass1 @tab - @tab pass @tab yes
- at item st-glass1_move @tab push @tab push @tab yes
- at item st-glass1_hole @tab pass @tab pass @tab yes
- at item st-glass2 @tab - @tab pass @tab no
- at item st-glass2_move @tab push @tab push @tab no
- at item st-glass2_hole @tab pass @tab pass @tab yes
- at item st-glass3 @tab - @tab - at tab yes
- at item st-polarswitch (on) @tab toggle @tab pass @tab yes
- at item st-polarswitch (off) @tab toggle @tab pass @tab no
- at item st-beads @tab - @tab pass @tab no
- at end multitable
-
-These entries can be visualized as follows: A glassstone is transparent for
-laser light, if it is not dark, or if it is hollow. Exception is
- at code{st-beads}, whose irregular sides would scatter the beam. A glassstone
-can always be passed by invisible actors, with three exceptions:
- at code{st-glass3}, whose inside is filled with red stripes, and the two movables
- at code{st-glass1_move} and @code{st-glass2_move} which have a non-glass frame
-which the actor can use to move the stone. @code{st-glass_move} does not have
-such a frame and cannot be moved by an invisible actor.
-
-
- at node Breakable-Stones
- at subsection Breakable-Stones
-
-A list of all breakable stones and what may break them. Messages are
-given in quotation marks. ``pyro'' is short for dynamite, bombs,
-bombstones, ``ignite'', ``expl'' and ``bombstone''.
-
- at table @code
- at item st-stone_break, st-rock3_break, st-break_gray
-hammer, laser, pyro
- at item st-break_acblack
- at ref{ac-blackball} with hammer, laser, pyro
- at item st-break_acwhite
- at ref{ac-whiteball} with hammer, laser, pyro
- at item st-break_bolder
-hammer, laser, bolder, ``trigger'', (pyro?)
- at item st-break_invisible
-hammer after using a brush
- at item st-laserbreak
-laser, pyro
- at item st-rock3_movebreak
-hammer, pyro; this stone is movable by impulses (not actors)
- at item st-plain_break
-hammer, laser, pyro; falls into @ref{fl-abyss}
- at item st-plain_cracked
-hammer, pyro
- at item st-plain_move
-pyro; this stone is movable; falls into @ref{fl-abyss},
- at ref{fl-water} and @ref{fl-swamp}; see also @ref{st-plain}
- at item st-bug
- at ref{ac-bug}
- at item st-breaking, st-plain_breaking
-breaks instantly, looks like @code{st-rock3}
- at item st-fart
-hammer, laser; see also @ref{st-fart}
- at item st-bombs
- at c st-dynamite, st-whitebombs
-bombs, bombstones, ``expl'', ``bombstone''; see also @ref{st-bombs}
- at item st-brake
-laser, bombs, ``expl''; see @ref{st-brake}
- at item st-puzzle
-see @ref{st-puzzle}
- at item st-volcano_active
-hammer; see @ref{st-volcano}
- at item st-lightpassenger
-hammer when active and trapped; see @ref{st-lightpassenger}
- at item st-firebreak
-fire near the stone; see also @ref{st-firebreak[_move]}
- at item st-firebreak_move
-fire under the stone; movable; falls into @ref{fl-abyss},
- at ref{fl-water} and @ref{fl-swamp}; see also @ref{st-firebreak[_move]}
- at end table
-
-For the mentioned objects, see @ref{it-hammer}, @ref{it-dynamite},
- at ref{it-blackbomb}, @ref{st-bombs}, @ref{st-bolder}, @ref{it-brush}.
-Also compare @ref{st-plain}, since @code{st-plain_cracked} results from
- at code{st-plain} when hit by a laser beam, and @code{st-plain[_move]}
-can be transformed into and out of @code{st-firebreak[_move]}.
-
-
- at node Oxyd Compatibility Stones
- at subsection Oxyd Compatibility Stones
-
- at code{st-magic} disappears when hit hard enough.
-
- at code{st-dummy} prints its own Oxyd code when hit. Compare
- at code{it-dummy} (@ref{System and Debug Items}) and @ref{fl-dummy}.
-
- at code{st-peroxyd-0xb8}, @code{st-peroxyd-0xb9} and @code{st-oxyd-0x18}
-just seem to destroy themselves on creation, the former two creating
- at code{fl-normal} beneath them.  Their purpose in the original games is
-unknown.
-
-
- at node st-actorimpulse
- at subsection st-actorimpulse: Bumper Stones
-
-These stones apply an impulse to actors that touch them.  The amount
-of force applied can be controlled by setting
- at code{enigma.BumperForce} (see @ref{Old API - Variables}) accordingly (the
-default is 200). Alternatively, the @code{force} attribute can be used
-to set this factor for @emph{individual} bumper stones.
-
- at strong{Attributes}
-
- at table @code
- at item force
-factor of the transmitted force (overrides @code{enigma.BumperForce})
- at item hit_factor
-factor of the transmitted force (overrides @code{enigma.BumperForce}
-and @code{force})
- at item hit_distortion_xx, hit_distortion_xy, hit_distortion_yx, hit_distortion_yy
-define a matrix to be applied to the force (default @code{((1,0),(0,1))})
- at end table
-
- at strong{Variants}
-
-The invisible variant, @code{st-actorimpulse_invisible} can be
-``painted'' with an @ref{it-brush}.
-
- at node st-big[brick/bluesand]
- at subsection st-big[brick/bluesand]: Big Stones
-
-These stones are used to construct big clusters of stones that
-visually seem like one big stone.  Though mainly decorative, they also
-have a small special ability, since they are the only stones that can't
-be swapped with @ref{st-swap} or @ref{st-pull} (besides @ref{st-oxyd}
-with true @code{static}-attribute).
-
- at strong{Attributes}
-
- at table @code
- at item connections
-A number between 1 and 16.  Each bit in (connections-1) corresponds to
-an open face of the stone.  You will normally simply use one of the
-Lua constants @code{PUZ_0001} to @code{PUZ_1111}.
- at end table
-
- at strong{Variants}
-
-Two families of big stones differ in design:
- at code{st-bigbrick-<nesw>} (similar to @code{st-brick}) and
- at code{st-bigbluesand-<nesw>} (similar to @code{st-blue-sand}).
-
-The term @code{<nesw>} denotes all non-empty substrings of
- at code{nesw}, describing the directions to which the single parts are
-open. Examples: @code{st-bigbluesand-nw} is a blue stone with a border
-on the south and east side, @code{st-bigbrick-esw} is a brick-type
-stone which connects to the east, south and west, and has a border on
-the north side.
-
- at code{st-bigbrick} and @code{st-bigbluesand}, without suffix, are not
-defined. Use @code{st-brick} and @code{st-blue-sand} to set single
-stones of these designs.  Note, however, that both these stones are
-swappable and pullable like normal stones.
-
-See @ref{st-puzzle} for another kind of cluster-building stones.
-
-
- at node st-[black/white]
- at subsection st-[black/white]: Black and white stones
-
-These stones only let black, or respectively, white marbles, pass.
-
- at strong{Variants}
-
- at code{st-black} and @code{st-white} come in four flavors each:
- at code{st-black1} and @code{st-white1} are not transparent at all,
- at code{@dots{}2} has a diagonal bar, @code{@dots{}3} a cross and @code{@dots{}4}
-only consists of a black or white frame.
-
-See @ref{st-grate} for other stones that only special actors may
-pass.
-
-
- at node st-[black/white]balls
- at subsection st-[black/white]balls: Blackballs and Whiteballs Stones
-
-Mainly used as decorative, this stone also has a special function: When
-it receives a message from a stone, which is just hit by a black
-(or white, respectively) marble, it sends signal 1 to the neighboring stones
-west and east of it and 0 to north and south; or vice versa, depending
-on the position of the message-sending stone.
-
-A typical construction for this is an @code{st-blackballs} surrounded
-by @ref{st-door} and @ref{it-sensor}, with @code{st-blackballs} as
-target of the action of @code{it-sensor}.  When in this situation a
-black marble hits one of the closed doors, the door lets
- at code{it-sensor} perform its action, sending a message to
- at code{st-blackballs}.  This then opens the knocked door and the door in
-the opposite direction, while closing the doors in the perpendicular
-directions.  However, when @code{it-sensor} triggers because of the
-marble entering it, @code{st-blackballs} won't trigger since there is no
-collision causing this event.
-
-
- at node st-block
- at subsection st-block: Solid Block
-
-This stone is movable and sinks on @ref{fl-abyss}, @ref{fl-water} and
- at ref{fl-swamp}.
-
-
- at node st-blocker
- at subsection st-blocker: Shrinkable Blocker Stone
-
-This stone shrinks to @ref{it-blocker} when hit by an
- at ref{st-bolder} and vice versa.
-
- at strong{Messages}
-
- at table @code
- at item trigger, openclose, open, close
-shrink (open) / grow (close)
- at item signal
-1: shrink, 0: grow
- at end table
-
-Note that @code{st-blocker} becomes a new object when shrinking, so
-that the messages @code{close} and @code{signal (0)} only make sense
-during transformation.
-
- at strong{Variants}
-
- at table @code
- at item st-blocker
- at item st-blocker-growing
- at end table
-
-
- at node st-bolder
- at subsection st-bolder: Bolder (or Arrow) Stone
-
-This stone runs in the direction given by the arrow on its picture.
-When a stone blocks its way, it triggers it (e.g. @ref{st-oxyd},
- at ref{st-stoneimpulse}), marbles are shattered.
-
-Bolder stones fall into @ref{fl-abyss}, but cross @ref{fl-water}
-unchanged.  @ref{it-magicwand} and lasers reverse its direction.
- at ref{st-rotator} changes its direction according to the rotators
-direction.
-
- at strong{Attributes}
-
- at table @code
- at item direction
- at code{EAST}, @code{NORTH}, @code{SOUTH} or @code{WEST}
- at end table
-
- at strong{Messages}
-
- at table @code
- at item direction
-Change direction to the direction in the second argument,
-e.g. @code{SendMessage(mystone, "direction", WEST)}.
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-bolder
-default direction is @code{NORTH}
- at item st-bolder-w
- at item st-bolder-s
- at item st-bolder-e
- at item st-bolder-n
- at end table
-
-
- at node st-bombs
- at subsection st-bombs: Bombstones
-
-When hit, @code{st-bombs} adds an @ref{it-blackbomb} to the
-inventory.  It can be destroyed with explosions from
- at ref{it-blackbomb}, @ref{it-whitebomb} and other bombstones (see
- at ref{Breakable-Stones}).  When exploding, it ignites items below it. It
-also ignites @ref{it-dynamite} beneath it, but not @code{it-blackbomb}
-or @code{it-whitebomb}.
-
- at c There are two more variants of @code{st-bombs}, that differ in that
- at c they dispense @code{it-dynamite} and @code{it-whitebomb}:
- at c @code{st-dynamite} and @code{st-whitebomb}
-
- at strong{Messages}
-
- at table @code
- at item expl, bombstone
-destroy stone
- at end table
-
- at c @strong{Variants}
-
- at c @table @code
- at c @item st-bombs
- at c @item st-dynamite
- at c @item st-whitebombs
- at c @end table
-
-
- at node st-brake
- at subsection st-brake: Brake
-
-This stone can be picked up as item @ref{it-brake}.  It can be used to
-block @ref{st-bolder}.  It destroys @ref{it-blocker} and can itself be
-destroyed by lasers and explosions from bombs (@ref{it-blackbomb},
- at ref{it-whitebomb}).
-
- at strong{Messages}
-
- at table @code
- at item expl
-destroy stone
- at end table
-
-
- at node st-brick_magic
- at subsection st-brick_magic: Magic Brick Stone
-
-At first sight identical with @code{st-brick}, this stone becomes
-transparent when hit with an @ref{it-magicwand}.
-
-
- at node st-chameleon
- at subsection st-chameleon: Chameleon Stone
-
-This stone takes on the look of the floor beneath it.  Actors can
-move through it, so these stones are perfect for hiding stuff under
-them.  For solid, yet invisible stone-types see @ref{st-invisible}.
-
-
- at node st-charge
- at subsection st-charge: Charge Stones
-
-When hit, the marble is provided with a constant electrostatic charge,
-given by the @code{charge}-attribute of @code{st-charge}.  The charge
-is confined to be between -1.0 and +1.0.  Actors with charges are
-drawn together or pushed apart respectively, by a force given by
-multiplication of their charges and the factor
- at code{enigma.ElectricForce} (see @ref{Old API - Variables}) and divided by their
-relative distance.
-
- at strong{Attributes}
-
- at table @code
- at item charge
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-chargeplus
-charge +1.0
- at item st-chargeminus
-charge -1.0
- at item st-chargezero
-charge 0.0
- at end table
-
-
- at node st-chess_[black/white]
- at subsection st-chess_[black/white]: Chess (Knight) Stone
-
-When hit, a chess stone makes a knight move: two steps in direction of
-the hit plus one step in direction of the vertical velocity
-component. @code{st-chess_black} can be moved only with the black
-marble, @code{st-chess_white} only with the white. When there is a
-chess stone of opposite color or a thief stone (@ref{st-thief}) at
-the target position of a knight move, this stone is destroyed.
-
-When hit with a magic wand (@ref{it-magicwand}), a chess stone changes
-color.  Chess stones fall into @ref{fl-abyss} and sink in
- at ref{fl-swamp}, but cross @ref{fl-water} undamaged.  They inactivate
- at ref{fl-thief}.
-
-Chess stones can't jump over or into fire (see @ref{Fire Spreading}). At least,
-a chess knight is brave enough not to panic when fire starts to burn beneath. 
-Note that fire can't ignite the floor below an @code{st-chess_[black/white]}, in
-this context it acts like an immovable stone. In the same sense, they don't act
-on impulses of @ref{st-stoneimpulse} or similar stones.
-
- at strong{Attributes}
-
- at table @code
- at item color
-0 for black, 1 for white
- at item direction1, direction2
-Used by the @code{move}-message
- at end table
-
- at strong{Messages}
-
- at table @code
- at item capture
-Destroy stone with capture-animation.
- at item flip
-Change color.
- at item move_[nne, nnw, wwn, wws, ssw, sse, ees, een]
-Make a knight move.
- at item move
-Make a knight move defined by the attributes @code{direction1} (two
-steps) and @code{direction2} (one step). You can use the @code{NORTH},
- at code{SOUTH}, @code{EAST} and @code{WEST} constants for this.
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-chess_black
- at item st-chess_white
- at end table
-
-
- at node st-coffee
- at subsection st-coffee
-
-This stone is non-transparent at first and becomes transparent and
-movable when hit (@code{st-glass_move}). See @ref{st-fakeoxyda} for a
-similar stone.
-
-
- at node st-coinslot
- at subsection st-coinslot
-
-A switch that can be activated with coins (see @ref{it-coin}). The
-more coins you put in, the longer the switch will stay activated.
-
- at strong{Attributes}
-
- at table @code
- at item on
-as usual
- at item target, action
-as usual
- at end table
-
- at strong{Messages}
-
- at table @code
- at item on, off, onoff
-as usual
- at item signal
-0: off, 1: on
- at end table
-
-
- at node st-death
- at subsection st-death: Skull Stones
-
-Simply kills all marbles that touch it (except when protected by an
- at ref{it-umbrella}).
-
-The invisible variant @code{st-death_invisible} becomes visible while
-using @ref{it-glasses}.
-
- at strong{Variants}
-
- at table @code
- at item st-death
- at item st-death_invisible
- at end table
-
-
- at node st-disco
- at subsection st-disco: Disco Stones
-
-A passable stone, which darkens everything that is underneath the
-stone (much like tinted glass).  Can be switched on and off (hence the
-name).
-
-When lightened or darkened, this stone also lightens and darkens
-neighboring @code{st-disco}, such that the light on a passage can be
-switched on and off just by sending a single message.
-
- at strong{Messages}
-
- at table @code
- at item signal
-With parameter 1, lighten the stone and (recursively) all neighboring
-disco stones; with parameter smaller than 1, darken them.
- at item lighten
- at item darken
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-disco-light
- at item st-disco-medium
- at item st-disco-dark
- at end table
-
-
- at node st-door
- at subsection st-door: Doors
-
-Doors are designed to let actors pass or not, depending on their
-internal state, which can be changed by triggers and other objects in
-the game. There is a family of ``standard doors'' (referred to as
- at code{st-door}-variants) and three single variants
-(@code{st-door_a}, @code{st-door_b}, @code{st-door_c}), which differ
-in design and behavior.
-
- at code{st-door}-variants let actors and laser beams pass in all
-directions when they are opened, and block those perpendicular to the
-doors when @code{st-door} is closed. The other three have no
-distinguished directions, they let actors and laser beams pass if, and
-only if, they're open.
-
-When an @code{st-door}-variant is hit, the item at the door's position
-performs its @code{action/target}-pair (you can use all items for
-this). There is nothing similar for the other variants.
-
- at code{st-door}-variants do not hold @ref{it-trigger} down.
-
- at strong{Attributes}
-
- at table @code
- at item type
- at code{h} (horizontal) or @code{v} (vertical): only
- at code{st-door}-variants.
- at end table
-
- at strong{Messages}
-
- at table @code
- at item open, close, openclose
-as they say
- at item signal
-0: close, 1: open
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-door
-equals st-door-h
- at item st-door-h
- at item st-door-v
- at item st-door-h-open
- at item st-door-v-open
- at item st-door_a
- at item st-door_b
- at item st-door_c
- at end table
-
-The first five all have the same design, the last three differ:
- at code{st-door_a} looks like @ref{st-oxyd} of flavor @code{a} when
-closed and like @code{st-grate} when open, @code{st-door_b} like
- at code{st-plain} and shrinks when opened, @code{st-door_c} also like
- at code{st-plain}, but @code{st-grate3} when opened.  Note that this is
-just design; they don't behave the same way.
-
-
- at node st-easymode
- at subsection st-easymode: Easy Mode Stone
-
-In easy game mode, this stone converts the floor at its position to
- at code{fl-normal}.  In normal game mode, the stone removes any item at
-its position.  The stone itself never appears in either game mode; it
-removes itself immediately after performing its job.
-
-This stone is commonly used to hide danger areas (water holes, abyss)
-or to insert helper items (umbrellas, seeds, etc.) that make the level
-easier in easy game mode.
-
-
- at node st-explosion
- at subsection st-explosion: Explosion Stone
-
-This stone mimics an explosion when set, and destroys itself
-afterwards.  Actors that contact it are shattered.
-
-
- at node st-fakeoxyda
- at subsection st-fakeoxyda: Movable Fake Oxyd Stone
-
-This stone looks like an @ref{st-oxyd} of flavor @code{a}, yet it
-transforms into the movable and transparent @code{st-glass1_move} when
-hit. See @ref{st-coffee} for a similar stone.
-
-
- at node st-fart
- at subsection st-fart: Fart Stone
-
-The fart stone has the unpleasant habit of ``blowing off'' when
-triggered (by actor hit or signal) and will close all Oxyd stones.
-It can be destroyed with lasers and @ref{it-hammer}, see also
- at ref{Breakable-Stones}.
-
- at strong{Messages}
-
- at table @code
- at item trigger
-blow off
- at end table
-
-
- at node st-firebreak[_move]
- at subsection st-firebreak[_move]: Firebreakable Stones
-
- at code{st-firebreak} gets destroyed when there is fire near it (see
- at ref{Fire Spreading}). @code{st-firebreak_move} is movable and
-gets destroyed when there is fire below it, just like
- at ref{st-wood}. It falls into @ref{fl-water}, @ref{fl-abyss} and
- at ref{fl-swamp} (if you need it not to fall, use @ref{fl-bridge}
-instead).
-
- at code{st-firebreak} and @code{st-firebreak_move} are the results of
- at code{st-plain} and @code{st-plain_move} when using @ref{it-pencil} on
-them (see @ref{st-plain}), and can be reverted again by using
- at ref{it-brush}.
-
- at strong{Messages}
-
- at table @code
- at item fire
- at code{st-firebreak[_move]} breaks
- at item heat
- at code{st-firebreak} breaks
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-firebreak
- at item st-firebreak_move
- at end table
-
-
- at node st-flash
- at subsection st-flash: Flash Stone
-
-When the flash stone is hit by the black marble, an impulse will
-be given to the white marble as if it had been hit itself -- and vice
-versa, when the white marble hits the flash stone.
-
- at strong{Attributes}
-
- at table @code
- at item hit_factor
-factor of the transmitted force (default 20)
- at item hit_distortion_xx, hit_distortion_xy, hit_distortion_yx, hit_distortion_yy
-define a matrix to be applied to the force (default @code{((1,0),(0,1))})
- at end table
-
- at node st-floppy
- at subsection st-floppy: Floppy Switch
-
-A switch that is activated by inserting a floppy disk (see @ref{it-floppy}).
-
- at strong{Attributes}
-
- at table @code
- at item on
-1 or 0
- at item target
- at item action
- at end table
-
-
- at node st-fourswitch
- at subsection st-fourswitch: Fourswitch
-
-When hit, this stone visually turns its pointer and performs the
-action given by the @code{action/target}-pair.
-
- at strong{Attributes}
-
- at table @code
- at item on
-1: @code{EAST} or @code{WEST}, 0: @code{NORTH} or @code{SOUTH}
- at item action, target
-as usual
- at end table
-
- at strong{Messages}
-
- at table @code
- at item trigger, signal
-turn as if hit with a marble
- at end table
-
-Note that no @code{direction}-attribute nor -message is implemented
-yet.  When using the direction in a level, you have to count the hits
-yourself: The stone always starts with direction @code{NORTH}.
-
-
- at node st-grate
- at subsection st-grate: Grates
-
-Floating grates, mainly decorative.  @code{st-grate1} and
- at code{st-grate2} block jumping marbles; all other actors may pass.  In
-Oxyd compatibility mode, all actors may pass.
-
- at code{st-grate3} lets only small marbles (@ref{ac-killerball} and
- at ref{ac-whiteball-small}) and @ref{ac-horse} pass. See
- at ref{st-[black/white]} for other stones that let only some actors
-pass.
-
- at strong{Variants}
-
- at table @code
- at item st-grate1
- at item st-grate2
- at item st-grate3
- at end table
-
-
- at node st-invisible
- at subsection st-invisible: Invisible Stones
-
- at code{st-invisible} is invisible and non-transparent for lasers, and
-is solid, in contrast to @ref{st-chameleon}.
-
- at code{st-stonebrush} initially equals @code{st-invisible}, but
-turns into @code{st-rock4} when hit with an @ref{it-brush},
-respectively into @code{st-likeoxydc-open} in Per.Oxyd compatibility
-mode.
-
- at code{st-invisible_magic} is invisible and transparent for lasers, and
-turns into @code{st-greenbrown} when touched with @ref{it-magicwand}.
-
- at strong{Variants}
-
- at table @code
- at item st-invisible
- at item st-invisible_magic
- at item st-stonebrush
- at end table
-
-
- at node st-key
- at subsection st-key: Key (or Lock) Stone
-
-When the right @ref{it-key} is used on this stone, it performs the
-action given by the @code{action/target}-pair.  For this, the key must
-have the same @code{keycode}-attribute as the stone.
-
-In Enigma compatibility mode, the key remains in the stone and can't
-be used until removed from it. In all other modes, you keep the key.
-
- at strong{Attributes}
-
- at table @code
- at item keycode
-a numerical code determining the correct key
- at item on
-1: key used, 0: no key
- at item action, target
-as usual
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-key
- at code{keycode} is 0
- at item st-key_a
- at code{keycode} is 1
- at item st-key_b
- at code{keycode} is 2
- at item st-key_c
- at code{keycode} is 3
- at end table
-
-Note that @code{it-key} and @code{st-key} do not match by defaults,
-since the default keycodes are different.  Use @code{st-key_a}
-instead.
-
-
- at node st-knight
- at subsection st-knight: Knight Stone
-
-Also called ``black knight stone'', this stone destroys all marbles
-that hit it, as long as they are not protected by @ref{it-umbrella}
-or wield an @ref{it-sword}.  By hitting @code{st-knight} with an
- at code{it-sword} four times, the knight stone spits out a cheeky remark
-and can be passed thereafter, even without a sword.
-
-
- at node st-laser
- at subsection st-laser: Laser Stone
-
- at code{st-laser} emits a laser beam in a specified direction while
-activated.  Note that a laser stone starts deactivated, but you can
-attach an @code{on=TRUE}-attribute to it to initialize it in an
-activated state.
-
- at strong{Attributes}
-
- at table @code
- at item on
- at item dir
-direction of the laser beam (use @code{SOUTH, EAST, NORTH, WEST}; read-only)
- at end table
-
- at strong{Messages}
-
- at table @code
- at item on, off, onoff
-as usual
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-laser
-standard direction is @code{EAST}
- at item st-laser-w
- at item st-laser-s
- at item st-laser-e
- at item st-laser-n
- at end table
-
-For redirecting and forking laser beams, see @ref{st-mirror}.
-
-
- at node st-laserswitch
- at subsection st-laserswitch: Laser Switch
-
-This switch is @code{on} while hit by a laserbeam
-and @code{off} when not hit by a laserbeam.
-
-See also @ref{st-lasertimeswitch}.
-
- at strong{Attributes}
-
- at table @code
- at item inverse=1
-Inverts the on/off state of the switch
-(i.e @code{on} at startup and switch @code{off} with laserbeam)
- at item target,action
-as usual
- at end table
-
-
- at node st-lasertimeswitch
- at subsection st-lasertimeswitch: Laser Time Switch
-
-This switch is a mix between @ref{st-laserswitch} and @ref{st-timeswitch}.
-
-
- at node st-lightpassenger
- at subsection st-lightpassenger: Light Passenger
-
-The light passenger skates on a laser beam, and may push up to one
-movable stone in front of it. Opposing laser beams are ignored.
-When another laser beam crosses the actual laser beam on which the
-passenger skates, the passenger switches beams. If it is initially
-lighted by two rectangular beams, one of them will be chosen by
-random. The light passenger's skating ability can be turned off
-and on.
-
-When a stone is in its way, the passenger sends an impulse to the
-blocking stone, which may move it, but it may also have other effects;
-e.g., a turnstile turns around and an impulse-stone starts pulsing,
-but it does not open oxyds (this is intended).
-
-The light passenger can't be pushed by actors, but, e.g., by
- at ref{st-stoneimpulse}.
-
-The speed of the light passenger can be changed with the
- at code{interval}-attribute (default 50 ms, which is quite fast) and may
-include the floor friction and local gradient via
- at code{friction_factor} (ff) and @code{gradient_factor} (gf).
-The resulting interval results as
-
- at example
-interval  =  base * (1 + ff * friction) / (1 + gf * gradient)
- at end example
-
-with @code{base} the value of the @code{interval}-attribute,
- at code{friction} the friction of the floor below the light passenger,
-and @code{gradient} the parallel part of the force of the floor,
-i.e., the sum of gradient-force and @code{force_x/y}-attributes.
-
-The light passenger can be switched on and off by messages (see
-below), and appears as @code{st-glass2} when inactive.  The variant
- at code{st-lightpassenger_off} is deactivated from the beginning.
-
-When an active @code{st-lightpassenger} is trapped between exactly two
-opposing light beams or light beams from all four directions, it
-starts blinking.  In this state, it can be destroyed with
- at ref{it-hammer}.
-
- at strong{Attributes}
-
- at table @code
- at item interval
-overrides the standard speed of the light passenger
- at item friction_factor
-involves friction into the speed of the light passenger (sensible:
-1.0, default 0.0)
- at item gradient_factor
-involves gradients into the speed of the light passenger (sensible:
-0.02, default 0.0)
- at end table
-
- at strong{Messages}
-
- at table @code
- at item onoff, on, off, trigger
-trigger between activated and deactivated (= no skating)
- at item signal
-with parameter 0: deactivating, else activating
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-lightpassenger
- at item st-lightpassenger_off
- at end table
-
-
- at node st-mail
- at subsection st-mail: Mail Stones
-
-When hit, these stones take the first item out of the player's
-inventory and drop it at their exit, or the exit of the appending
- at ref{it-pipe}-structure. If this position is blocked (e.g., by another
-item), no item is taken from inventory.
-
- at strong{Variants}
-
- at table @code
- at item st-mail-w
- at item st-mail-e
- at item st-mail-s
- at item st-mail-n
- at end table
-
-
- at node st-mirror
- at subsection st-mirror: Mirror Stones
-
-These stones redirect and fork laser beams. They can be movable or
-non-movable, semi-transparent or non-transparent, plane or triangular,
-and have one of four orientations.  When hit, the mirror turns 90
-degrees clockwise.
-
- at strong{Attributes}
-
- at table @code
- at item movable
- at item transparent
- at item orientation
- at end table
-
- at strong{Messages}
-
- at table @code
- at item trigger, turn
-rotate clockwise
- at item signal
-0: do nothing, else: rotate clockwise
- at item mirror-north, mirror-east, mirror-south, mirror-west
-set orientation
- at end table
-
- at strong{Variants}
-
-There is a total of 32 mirrors, the names are constructed in the
-following way: Start with @code{st-mirror}. For a plane mirror, add
- at code{p} and one of the orientations @code{|,/,-,\\} (the last one is
-the backslash and has to be masked by doubling). For a triangular
-mirror, instead add @code{3} and one of @code{v,<,>,^}. For a
-semi-transparent mirror, add a @code{t}. Finally, for a movable
-version, add an @code{m}.
-
-Or, use @code{st-pmirror} and @code{st-3mirror} and set the attributes
-accordingly, with defaults @code{/} or @code{v}, non-transparent and
-non-movable.
-
-
- at node st-oneway
- at subsection st-oneway: One-way Stones
-
-The marble can be pass this stone  in only one direction. (Or to
-be more exact, the arrow on the stone points to the one side of the
-stone through which it @emph{can't} be entered.  Hard to explain, try
-it yourself :-)
-
-There are three different variants of the one-way stone: the standard
-one, @code{st-oneway}, which both the black and the white marble can
-pass, and two colored ones, @code{st-oneway_black} and
- at code{st-oneway_white}, which completely block marbles of the other
-color.
-
-When hit with an @ref{it-magicwand}, the standard @code{st-oneway}
-flips its direction, the variants @code{st-oneway_black} and
- at code{st-oneway_white} do not.
-
- at strong{Attributes}
-
- at table @code
- at item orientation
-One of @code{NORTH}, @code{EAST}, @code{SOUTH}, or @code{WEST}.  This
-determines the orientation of the stone when the level is loaded.  You
-need to use the @code{direction} message for changing the orientation
-during the game.  Note that it is usually easier to use one of the
-alternative names, like @code{st-oneway-north} instead of explicitly
-setting this attribute.
- at end table
-
- at strong{Messages}
-
- at table @code
- at item direction
-Set the direction of the arrow during the game.  Simply setting the
-attribute @code{orientation} is not enough, since this does not update
-the stone's model on the screen.
- at item signal, flip
-Both these messages flip the direction of the arrow.
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-oneway
- at item st-oneway-[nesw]
- at item st-oneway_black
- at item st-oneway_black-[nesw]
- at item st-oneway_white
- at item st-oneway_white-[nesw]
- at end table
-
-
- at node st-oxyd
- at subsection st-oxyd: Oxyd Stones
-
-Oxyd stones are characterized by two attributes: Their flavor and
-their color.  The @code{flavor} only affects the visual representation
-of the stone; it can be either `a' (opening like a flower), `b'
-(displaying a fade-in animation), `c', or `d'.  The @code{color}
-attribute determines the color on the oxyd stone.  The @code{static}
-attribute declares the oxyd stone to be unswappable/unpullable (see
- at ref{st-swap} and @ref{st-pull}).
-
- at strong{Note}: You should rarely need to create oxyd stones manually
-with @ref{set_stone}.  Use the predefined oxyd function
-instead.  It will automatically take care of creating two oxyd stones
-of every color.
-
- at strong{Attributes}
-
- at table @code
- at item flavor
-`a', `b', `c', or `d'
- at item color
-a number between 0 and 7
- at item static
- at code{true}, @code{false} (default) - static oxyds may not be swapped
-or pulled
- at end table
-
- at strong{Messages}
-
- at table @code
- at item closeall
-Close all oxyd stones.
- at item shuffle
-Interchange the colors of the oxyd stones in the current
-landscape. Better use the oxyd_shuffle function.
- at item trigger
-Open the stone (useful for opening oxyd stones using switches)
- at end table
-
-
- at node st-plain
- at subsection st-plain: Plain Stones
-
- at code{st-plain} and @code{st-plain_hole} trigger between solid and
-hollow when they receive a @code{trigger}- or @code{signal}-message.
-
-The solid version additionally becomes @code{st-plain_cracked} when hit
-by a laser beam and can then be destroyed with an @ref{it-hammer} or
-explosions (see @ref{Breakable-Stones}).  The hollow version is
-transparent to lasers.  Note that @code{st-plain_cracked} doesn't
-become transparent or hollow by messages.
-
- at code{st-plain_move} is a movable and breakable stone (see
- at ref{Breakable-Stones}) that looks identical to @code{st-plain}. It
-falls into @ref{fl-abyss}, @ref{fl-water} and @ref{fl-swamp}, but only
-when moved. @code{st-plain_move} and @code{st-plain} can be
-transformed into @ref{st-firebreak[_move]} with @ref{it-pencil}, and
-get reverted by @ref{it-brush}.
-
-As @code{st-plain} is a frequent design scheme, you might want to use
-a version that doesn't transform under laser light.  For this purpose,
-use @code{st-rock3} or one of the closed doors @code{st-door_b} or
- at code{st-door_c} (see @ref{st-door}).  Other stones with the typical
- at code{st-plain}-design are @ref{st-chess_[black/white]} and the
-already mentioned @code{st-firebreak[_move]}.
-
- at strong{Messages}
-
- at table @code
- at item trigger, signal
-switch between solid and hollow
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-plain
- at item st-plain_hole
- at end table
-
-Note that there are more stones starting with ``st-plain'', but none
-of them has the ability to trigger between solid and hollow:
- at code{st-plain_move}, @code{st-plain_breaking},
- at code{st-plain_falling}, @code{st-plain_break} and
- at code{st-plain-cracked}.  See @ref{Breakable-Stones} for them, and
- at ref{st-door} for stones with similar functions like @code{st-plain}.
-
-
- at node st-polarswitch
- at subsection st-polarswitch: Light Switch
-
-When hit, this stone changes transparency for laser
-beams. It uses the same graphics as @code{st-glass1} and
- at code{st-glass2}. By default, it is non-transparent.
-
-Attributes and messages are equivalent to those of switches:
-
- at strong{Attributes}
-
- at table @code
- at item on
-1 (transparent) or 0 (non-transparent)
- at end table
-
- at strong{Messages}
-
- at table @code
- at item signal
-1 (lighten) or 0 (darken)
- at item on, off, onoff
-on = lighten, off = darken, onoff = toggle
- at end table
-
-
- at node st-pull
- at subsection st-pull: Pull Stone
-
-When pushed, this stone acts like pulled, regardless of the source of
-the impulse.  Actors on the destination field are pulled through it,
-not caged under them.  Hollow stones on the
-position of the actor exchange their position with the pull-stone.
-Note however, that the special combination of @ref{st-brake} and
- at code{st-pull} is lethal for the marble.
-
-The only stones that cannot be pulled, are
- at ref{st-big[brick/bluesand]}.  Use them to make sure that an
- at code{st-pull} can't get out of a restricted area when you use, e.g.,
- at ref{st-rotator} or other objects that @code{st-pull} reacts on.
-In addition, you can declare @ref{st-oxyd} to be unswappable by
-attribute @code{static}.
-
-Note that, in non-Enigma-modes, @code{st-pull} may not get pulled into
-the border of the level.  This behavior might change in future
-versions.
-
-For a stone with similar function and restrictions, see @ref{st-swap}.
-
-
- at node st-puzzle
- at subsection st-puzzle: Puzzle Stones
-
-Puzzle stones can construct large clusters of stones, that move
-together and can be destroyed together.  There are two families, blue
-and yellow puzzle stones, which behave different (the yellow ones are
-compatible to the puzzle stones in the original Oxyd-game). Each of
-these families again consists of several variants that differ in the
-location of sockets to which neighboring puzzle stones can be
-attached.  A cluster is complete as soon as all sockets are connected
-to sockets of other puzzle stones of the same color.
-
-Laser beams make all complete puzzle clusters explode. Besides this,
-yellow, incomplete puzzle cluster rotate on a laser beam (means: the
-lightened row or column rotates by one stone position).  Incomplete
-blue clusters don't react on lasers.
-
-If a complete cluster is moved fully onto a combination of
- at ref{fl-water} and @ref{fl-abyss}, it becomes a bridge of
- at code{fl-gray}, similar to @ref{st-wood}.  An incomplete cluster
-forms a bridge only on @ref{fl-water}, and only if the wielded item
-is not @ref{it-magicwand}.  Note that in contrast to @code{st-wood},
-puzzle stones become bridges only after they are moved' they don't
-react on changing the floor.
-
-There also is a single hollow variant for each of the two colors,
- at code{st-puzzle-hollow} and @code{st-puzzle2-hollow}.  It acts as if
-it had sockets to all four directions, but is still hollow.  However,
-these stones are the only hollow ones that press down
- at ref{it-trigger}.
-
-When an actor hits:
- at itemize @bullet
- at item a yellow complete cluster, it explodes;
- at item a single yellow puzzle stone, it moves;
- at item a yellow incomplete cluster, it rotates;
- at item a blue complete cluster with @code{it-magicwand}, it explodes;
- at item a blue complete cluster without @code{it-magicwand}, it moves;
- at item a blue incomplete cluster with @code{it-magicwand}, it rotates.
- at end itemize
-Note that an exploding cluster can shatter the marble.
-
-In the current implementation, moving a puzzle stone over an item
-doesn't change it.  This affects, e.g., @ref{it-coin} (that don't
-transform), @ref{Hills and Hollows} (that don't diminish),
- at ref{it-blackbomb} and @ref{it-whitebomb} (that don't explode).  Be
-aware when using these items with @code{it-puzzle} that
-future implementations of Enigma might change this behavior.
-
-
- at strong{Messages}
-
- at table @code
- at item scramble
-Internal message used to scramble a puzzle using secondary
-information; use AddScramble and SetScrambleIntensity to
-scramble a puzzle in a level instead or make use of one of the
-libraries (@code{ant} and @code{libpuzzle} both offer this
-possibility)
- at end table
-
- at strong{Attributes}
-
- at table @code
- at item connections
-A number between 1 and 16.  Each bit in (connections-1) corresponds to
-a socket on one of the four faces.  Normally, you will simply use
-one of the Lua constants @code{PUZ_0000} to @code{PUZ_1111}.
- at item oxyd
-0, if the puzzle stone is blue; 1, if it is yellow
-(@code{st-puzzle2-*})
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-puzzle-hollow
-blue hollow puzzle stone
- at item st-puzzle-<nesw>
-blue solid puzzle stone
- at item st-puzzle2-hollow
-yellow hollow puzzle stone
- at item st-puzzle2-<nesw>
-yellow solid puzzle stone
- at end table
-
-The term @code{<nesw>} denotes all non-empty substrings of
- at code{nesw}, describing the directions to which there are sockets on
-the stone.  Examples: @code{st-puzzle-nw} is a blue puzzle stone with
-connections going north and west, @code{st-puzzle2-esw} is a yellow
-puzzle stone with connections to the east, south and west.
-
-See @ref{st-big[brick/bluesand]} for other kinds of cluster-building
-stones.
-
-
- at node st-rotator
- at subsection st-rotator: Rotator Stone
-
-Rotator stones come in four flavors: Clockwise or counterclockwise
-rotation, and movable or not movable.  They send impulses to
-neighboring stones, thus pushing them in the direction given by the
-rotation.  @ref{st-bolder} additionally change their direction to the
-one they are pushed to.  @code{st-rotator} changes direction when hit
-with an @ref{it-wrench} or by a laser beam.
-
- at strong{Variants}
-
- at table @code
- at item st-rotator-right
- at item st-rotator-left
- at item st-rotator_move-right
- at item st-rotator_move-left
- at end table
-
-
- at node st-rubberband
- at subsection st-rubberband: Rubberband Stone
-
-If hit by a marble, this stone first removes existing connections with
-other stones, then attaches a new elastic between the
-marble and itself.  Nothing happens if the marble was already attached
-to this particular stone.
-
-This stone can be moved if hit with a magic wand.
-
- at strong{Attributes}
-
- at table @code
- at item length
-The natural length of the rubberband (default: 1)
- at item strength
-The strength of the rubberband (default: 10)
- at item minlength
-The minimal length of the rubberband (default: 0)
- at item scissor
-Boolean value defining if already existing rubberbands to other Stones should be cut off.
-(Default: true)
- at end table
-
-
- at node st-scissors
- at subsection st-scissors: Scissors Stone
-
-This stone cuts all rubber bands attached to an actor that touches it.
-When at least one rubber band is cut, it performs the action given in
-the @code{action/target}-pair.
-
- at strong{Attributes}
-
- at table @code
- at item target, action
-as usual
- at end table
-
-
- at node st-shogun-<sml>
- at subsection st-shogun-<sml>: Shogun Stones
-
-These stones come in three basic variants: small (@code{s}), medium
-(@code{m}) and large (@code{l}).  The smaller ones can be pushed into
-bigger ones, forming combined forms denoted by combinations of @code{s},
- at code{m} and @code{l}.  When hit, these combined stones split again
-into the smaller ones.
-
-The shogun stones trigger shogun items (see @ref{it-shogun}):  A
-single @code{st-shogun-s} triggers @code{it-shogun-s}, a combined
- at code{st-shogun-sm} triggers @code{it-shogun-m}, and the triplet
- at code{st-shogun-sml} triggers @code{it-shogun-l}.
-
-Shogun stones don't ignite bombs when pushed over them.
-
- at code{st-shogun-s} is handled differently in a @ref{Freeze Checking} than
-the other shogun stones. This allows to use @code{st-shogun-s} to use in a
-Sokoban and avoids false freeze checks when used together with other shogun
-stones (which are handled as non-existent during a freeze check).
-
- at strong{Attributes}
-
- at table @code
- at item holes
-between 1 and 7 (the three lower bits), used internally, thus
-read-only
- at end table
-
-
- at node st-spitter
- at subsection st-spitter: Spitter Stone
-
-When hit, an @ref{it-extralife} from the inventory of the hitting
-marble is transformed into a cannonball (@ref{ac-cannonball}) which
-can open @ref{st-oxyd}, destroy items and floor tiles (replacing them
-by @ref{fl-abyss}).  You can vary the initial velocity of the cannonball
-by using the @code{hit_factor}- and
- at code{hit_distortion_*}-attributes.
-
- at strong{Attributes}
-
- at table @code
- at item hit_factor
-factor of the transmitted force (default 1.0)
- at item hit_distortion_xx, hit_distortion_xy, hit_distortion_yx, hit_distortion_yy
-define a matrix to be applied to the force (default @code{((1,0),(0,1))})
- at end table
-
-
- at node st-stoneimpulse
- at subsection st-stoneimpulse: Impulse Stones
-
-These stones send impulses to their neighbors when they receive such
-themselves, or when hit by a laser beam (only when the laser beam is
-turned on or changed, not the entire time).
-
- at strong{Messages}
-
- at table @code
- at item trigger
-Pulse as if pulse arrived from direction given in the second argument to
-SendMessage (like in @code{SendMessage(mystone, "trigger",
-NORTH}). Use @code{NODIR} if no direction shall be assumed.
- at item signal
-0: do nothing, else: start pulsing
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-stoneimpulse
- at item st-stoneimpulse-hollow
-not activated by lasers; blocks laser and may shatter actors while
-pulsing
- at item st-stoneimpulse_movable
-movable version; pulses after move
- at end table
-
-
- at node st-surprise
- at subsection st-surprise: Surprise Stone
-
-When hit, this stone randomly transforms into one of @code{st-grate1},
- at code{st-death}, @code{st-glass1_hole}, @code{st-magic},
- at code{st-knight}, @code{st-thief}, @code{st-plain_break},
- at code{st-plain_breaking}, or another @code{st-surprise}
-(see @ref{st-grate}, @ref{st-death}, @ref{Oxyd Compatibility Stones},
- at ref{st-knight}, @ref{st-thief}, and @ref{Breakable-Stones}). The corresponding
-item is @ref{it-surprise}.
-
-
- at node st-swap
- at subsection st-swap: Swap Stone
-
-This stone can exchange its position with other neighboring stones
-if it is hit hard enough.  In a way, this makes swap stones a kind
-of ``movable stone'', except that they can be exchanged only with
-other stones and may not be moved on empty fields.
-
-The only stones that cannot be swapped, are
- at ref{st-big[brick/bluesand]}.  Use them to make sure that an
- at code{st-swap} can't get out of a restricted area.  In addition, you
-can declare @ref{st-oxyd} to be unswappable by attribute
- at code{static}.
-
-Note that, in non-Enigma-modes, @code{st-swap} may not swap into the
-border of the level.  This behavior might change in future versions.
-
-For a stone with similar function and restrictions, see @ref{st-pull}.
-
-
- at node st-switch
- at subsection st-switch: Switches
-
-A simple switch.
-
- at strong{Attributes}
-
- at table @code
- at item on
-1 (activate) or 0 (inactive)
- at item target, action
-as usual
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-switch
-All kinds of objects can activate this switch.
- at item st-switch_black
-Only black marbles can activate this switch.
- at item st-switch_white
-Only white marbles can activate this switch.
- at end table
-
-
- at node st-thief
- at subsection st-thief: Thief Stone
-
-Takes one item from inventory shortly after hit by a player's marble.
- at ref{it-umbrella} protects against thievery.
-
-Thief stones can be destroyed with chess stones
-(@ref{st-chess_[black/white]}).  They then leave an @ref{it-bag}
-behind, filled with the stolen items.  If the tile is already occupied
-by an item that could be picked up, it is added to the bag, if the item
-couldn't be picked up, no bag is produced (you can use this to
-suppress bag generation).
-
-Compare with @code{fl-thief} (@ref{fl-thief}).
-
- at strong{Messages}
-
- at table @code
- at item capture
-Destroy the thief stone with capture-animation (as if captured by a chess
-stone).
- at end table
-
-
- at node st-timer
- at subsection st-timer: Timer Stone
-
-This stone can be used to trigger periodic events or to trigger one
-single event after a certain amount of time.  When triggering, it
-performs its @code{action/target}-pair, the second data is 1 for every
-odd activation, and 0 for every even one.
-
- at strong{Attributes}
-
- at table @code
- at item on
-1 if the timer is running (default: 1)
- at item interval
-number of seconds before @code{action} is performed (default: 1.0)
- at item loop
-If @code{true}, restart the timer after performing @code{action}, stop
-on @code{false}. Note: This argument doesn't work in Enigma 1.01 or
-older. (default: @code{true})
- at item action, target
-as usual
- at item invisible
-if 1, stone is invisible (default: 0)
- at end table
-
- at strong{Messages}
- at table @code
- at item on, off, onoff
-as usual
- at item signal
-0: off, 1: on
- at end table
-
-
- at strong{Example}
-
- at example
--- activate a laser after 5 seconds
-set_stone("st-laser", 10,11, @{name="laser"@})
-set_stone("st-timer", 10,10,
-          @{loop=0, action="onoff", target="laser", interval=5@})
- at end example
-
-
- at node st-timeswitch
- at subsection st-timeswitch: Time Switch
-
-When this switch is touched by an actor, it switches @code{on}
-for 1.8 seconds and then switches @code{off} again.
-
-See also @ref{st-lasertimeswitch}.
-
- at strong{Attributes}
-
- at table @code
- at item delay
-The delay in seconds after which the switch goes @code{off}.
- at item inverse=1
-Inverts the on/off state of the switch.
- at item action, target
-as usual
- at end table
-
-
- at node st-turnstile
- at subsection st-turnstile: Turnstiles
-
-A turnstile consists of the pivot (@code{st-turnstile} or
- at code{st-turnstile-green}) and up to four arms
-(@code{st-turnstile-[w/e/s/n]}). When hit by an actor or by another
-impulse (e.g., @ref{st-lightpassenger} or @ref{st-stoneimpulse}), the
-whole complex turns 90 degrees.  The red standard version takes only
-the actor hitting the turnstile, with it to the other side and shatters all
-others in its surrounding; the green version takes all actors to the other
-side, for which there is an arm behind them, and ignores the rest. Imagine the
-red turnstile as pulling, the green one as pushing.
-
-The turnstile may be blocked by other stones (even movable ones).
-Items are handled during rotation as if a stone is pushed over them.
-
-When a turnstile-pivot rotates, it subsequently performs its
- at code{action/target}-pair, with secondary data 0 if it rotates
-clockwise, 1 if counterclockwise.  If you send a signal to a pivot (or
-otherwise try to rotate it) that is already rotating, the signal
-will be discarded.  This way you can concatenate several turnstiles to
-a complex, which simultaneously rotates (or only in certain parts),
-without constructing an endless loop.
-
-When two green turnstiles are intertwined, one of them is hit and an actor would
-be transported between them, then the second turnstile will be hit, too.
-
-When an actor is to be warped outside of the level by a turnstile
-(which only happens with a green one directly at the level border), the
-actor is shattered instead of warped. This is the only case in which a
-green turnstile is able to shatter a marble.
-
- at strong{Messages to the pivot}
-
- at table @code
- at item signal
-0: rotate clockwise, 1: rotate counterclockwise
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-turnstile
- at item st-turnstile-green
- at item st-turnstile-e
- at item st-turnstile-s
- at item st-turnstile-n
- at item st-turnstile-w
- at end table
-
-
- at node st-volcano
- at subsection st-volcano: Volcano
-
-This stone duplicates itself and spreads out very fast.  During one
-``life-cycle'', it starts as @code{it-seed_volcano} (see
- at ref{it-seed}), grows as @code{st-volcano-growing} (during which it
-shatters nearby marbles), becomes @code{st-volcano_active} when
-mature, spreads new @code{it-seed_volcano} on neighboring tiles and
-becomes inactive after some random time period.
-
-Seeds are spread to randomly chosen neighboring tiles on which are no
-other stones.  Other items are destroyed by this.
-
-While active (not while growing or while inactive), a volcano
-stone can be broken with @ref{it-hammer} (see @ref{Breakable-Stones}).
-
- at strong{Messages}
-
- at table @code
- at item trigger
-Makes an inactive stone active again.
- at end table
-
- at strong{Variants}
-
- at table @code
- at item st-volcano
-starts inactive
- at item st-volcano-growing
- at item st-volcano_active
- at item st-volcano_inactive
- at end table
-
-See also @ref{it-seed}.
-
-
- at node st-window
- at subsection st-window: Breakable Stone
-
-Hit this window hard with your marble to blast it into smithereens.
-
-
- at node st-wood
- at subsection st-wood: Wooden Stone
-
-This stone is movable.  If moved into @ref{fl-abyss}, @ref{fl-water} or
- at ref{fl-swamp}, it builds a wooden plank (@code{fl-stwood1} or
- at code{fl-stwood2}).  In Oxyd 1 compatibility mode @code{st-wood} only
-checks for floor when it is moved or when it receives the message
-``fall''.
-
-Note: There are two flavors of @code{st-wood} that you may specify
-by using @code{st-wood1} or @code{st-wood2}.
-
- at code{st-wood-growing} is a growing version of @code{st-wood}, it
-results from using a particular @ref{it-seed}.
-
- at code{st-flhay} and @code{st-flrock} are movable, too, and create
- at code{fl-hay}, respectively @code{fl-rock}, when moved into
- at code{fl-abyss}, @code{fl-water} or @code{fl-swamp}.  The difference
-to @code{st-wood} is that @code{fl-hay} doesn't become @code{fl-abyss}
-when burning and @code{fl-rock} doesn't burn at all.
-
-When there is fire under @code{st-wood} or @code{st-flhay}, they burn
-away.  In contrast to this, @code{st-flrock} extinguishes fire as it
-is pushed over it (see @ref{Fire Spreading}).  This distinguishes
-it from all other movable stones.  Fire that is extinguished in this
-way might leave @code{it-burnable_ash} behind, but the floor does not
-fire-transform.
-
- at strong{Variants}
-
- at table @code
- at item st-wood
- at item st-wood1
- at item st-wood2
- at item st-wood-growing
- at item st-flrock
- at item st-flhay
- at end table
-
-
- at node st-yinyang
- at subsection st-yinyang: Yin-Yang Stones
-
-Yin-Yang stones change into @code{st-white1} or @code{st-black1}
-if you touch them (see @ref{st-[black/white]}).
-
-Actors get stuck inside the Yin-Yang Stone if they are starting
-there or when they warp there. They can be freed by changing the
-color of the Yin-Yang Stone to their color.
-
- at strong{Variants}
-
-There are several flavors of this stone:
-
- at table @code
- at item st-yinyang1
-If touched, it changes it's color to the opposite color of your marble.
- at item st-yinyang2
-If touched, it changes it's color to the same color as your marble.
- at item st-yinyang3
-The Per.Oxyd compatible: You must hold @ref{it-magicwand} or
- at ref{it-brush} to change the color to the color opposite of your
-marble.
- at end table
-
-
 @c ----------------------------------------------------------------------
- at node Old Actors
- at section Old Actors
+ at node Engine Compatibility
+ at section Engine Compatibility
 
- at menu
-* Actor Attributes::            Common attributes of actors
-* ac-blackball::                Black Marble
-* ac-bug::                      Bug
-* ac-cannonball::               Cannonball
-* ac-horse::                    Horse
-* ac-killerball::               Small killer marble
-* ac-rotor::                    Rotor
-* ac-top::                      Spinning Top
-* ac-whiteball::                White Marble
-* ac-whiteball-small::          Meditation Marble
- at end menu
+Although Enigma was inspired by the Oxyd game series, there are
+some differences between the native Enigma engine mode and the other modes as
+well as between the other modes themselves. Using the compatibility element
+of the xml-metadata (@pxref{<compatibility>}), it is possible to activate some
+of these special features. Here is a list of the major differences
 
-Movable objects are called ``actors'' in Enigma.  The most common
-actor is, of course, the black marble, but there are others, including
-the white marble, the killerball and a few more:
-
- at node Actor Attributes
- at subsection Actor Attributes
-
-All actors share a set of common attributes that determine their
-general behavior:
-
- at table @code
- at item @b{player} values: 0, 1, nil; default: nil
-The player ``owning'' this actor.  This is either 0 or 1 for the first
-or second player respectively.  Actors attached to a player can pick
-up items and can be respawned when they are killed (same player means
-same inventory).  Note: The controllers of the marble are given by the
- at code{controllers}-attribute
-
- at item @b{mouseforce} values: float; default: 1.0
-A factor that determines how much the actor accelerates when the mouse
-is moved.  Default is 1, use higher values for fast moving actors.  If
-set to 0, the actor cannot be moved with the mouse (but external
-forces can still exert a force on it).
-
- at item @b{controllers} values: 0, 1, 2, 3
-Determines which players may move this actor: 1=Player 0, 2=Player 1,
-3=both, 0=none. By default, @code{ac-blackball}, @code{ac-whiteball} and
- at code{ac-whiteball-small} have their @code{controllers} attribute set
-to 1, 2, and 3 respectively. Use value 0 if you want a passive actor.
-
- at item @b{essential} values: 0, 1, -1
-Describes the necessity of an actor to be alive in case of multiple actors being
-attached to a player. A value 0 marks an actor as not essential. The player
-may well continue to play with other actors that he controls which are still
-alive. A value of -1
-marks an actor as totally necessary. If such an actor cannot be resurrected
-after a death, the player is essentially dead. A value of 1 marks an actor as
-partially essential. Not the actor itself needs to survive but the number of
-actors of its kind controlled by the player need to be larger than the number
-of actors with value 1. For example, marking 3 out of 5 small whiteballs with 1 means
-that the player is dead if 3 small whiteballs are no longer alive. See
- at ref{Old API - Variables} @samp{enigma.ConserveLevel} for more details about restart of levels.
-
- at item @b{essential_id} values: string; default: model name of actor
-Since a player may control actors of different kinds at the same time, the
-essentialness of actors is limited to its kind via this id. It is possible
-to group actors of different kinds into an essential group via this id. The
-engine keeps this id even if actors are transformed into other kinds.
-
- at item @b{whiteball}, @b{blackball} @i{deprecated}
- at code{TRUE} or @code{FALSE}. Used by color-sensitive stones
-(black/white switches for example) to determine whether the actor is
-the black or the white marble.  These attributes may disappear in
-future versions, please do not use them.
- at end table
-
-
- at node ac-blackball
- at subsection ac-blackball
-
-This is the most common actor.
-
- at strong{Attributes}
-
- at table @code
- at item mouseforce (default 1.0)
- at item color (default 0.0)
- at item blackball (default 1)
- at item player (default 0)
- at item controllers (default 1)
- at end table
-
-
- at node ac-bug
- at subsection ac-bug
-
-A small, passive marble.  It can be used to break @code{st-bug} (see
- at ref{Breakable-Stones}), to pass @code{st-grate3} (see @ref{st-grate})
-to open oxyds, etc.  It can't shatter or die.
-
- at c @strong{Attributes}
-
- at c @table @code
- at c @end table
-
-
- at node ac-cannonball
- at subsection ac-cannonball
-
-Used by @ref{st-spitter} as a cannon ball. Don't use in levels.
-
-
- at node ac-horse
- at subsection ac-horse
-
-A slightly larger actor that shuttles between the targets given in
-its @code{target1}- to @code{target4}- attributes with a given
- at code{force}.  In future versions, it's planned that marbles can ride
- at code{ac-horse} to surpass @ref{fl-abyss}, @ref{fl-water} etc.
- at code{ac-horse} can pass @code{st-grate3} (see @ref{st-grate}), open
-oxyds and much more, without shattering or dying.
-
- at strong{Attributes}
-
- at table @code
- at item force (default 10.0)
- at item target1
- at item target2
- at item target3
- at item target4
- at end table
-
- at strong{Example}
-
-The syntax of the @code{target}-attributes is a little bit
-uncommon. Here is an example from the meditation @code{ral04_1}:
-
- at example
-set_actor("ac-horse",16.5, 6.5, @{force=6, target1="16 3",
-    target2="3 3", target3="3 9", target4="16 9" @})
- at end example
-
-The attribute consists of a string, holding the x- and y-coordinates,
-separated by a blank.  The @code{ac-horse} in the example shuttles
-between the coordinates (16,3), (3,3), (3,9) and (16,9) on a
-rectangular route.  Note that only four targets are allowed at
-the moment.
-
-
- at node ac-killerball
- at subsection ac-killerball
-
-A small marble, mostly controlled by the player, which shatters other
-marbles.
-
- at strong{Attributes}
-
- at table @code
- at item mouseforce (default 2.0)
- at item color (default 1.0)
- at item whiteball (default 1)
- at item controllers (default 3)
- at end table
-
-
- at node ac-rotor
- at subsection ac-rotor
-
-An actor that is actively attracted by marbles and shatters them.
-Compare @ref{ac-top}.
-
- at strong{Attributes}
-
- at table @code
- at item range (default 5.0)
- at item force (default 10.0)
- at item gohome (default 1)
- at item attacknearest (default FALSE)
-in case of multiple balls, the default behavior for rotors is to attack the
-center of all balls. If this flag is set to @samp{TRUE}, the nearest ball will
-be attacked.
-
- at item prefercurrent (default 0.0)
-with values from 0.0 to 1.0 the likelihood is expressed that the rotor hunts
-the current controlled ball instead of the otherwise attacked aim. You will
-usually use this attribute in combination with @samp{attacknearest=TRUE}. The
-Level @samp{Toreador} is an example of the behavior of rotors.
- at end table
-
- at node ac-top
- at subsection ac-top
-
-An actor that is actively attracted by marbles and shatters them.
-Compare @ref{ac-rotor}.
-
- at strong{Attributes}
-
- at table @code
- at item range (default 5.0)
- at item force (default 10.0)
- at item gohome (default 1)
- at item attacknearest (default FALSE)
-in case of multiple balls, the default behavior for rotors is to attack the
-center of all balls. If this flag is set to @samp{TRUE}, the nearest ball will
-be attacked.
-
- at item prefercurrent (default 0.0)
-with values from 0.0 to 1.0 the likelihood is expressed that the rotor hunts
-the current controlled ball instead of the otherwise attacked aim. You will
-usually use this attribute in combination with @samp{attacknearest=TRUE}. The
-Level @samp{Toreador} is an example of the behavior of rotors.
-
- at end table
-
-
- at node ac-whiteball
- at subsection ac-whiteball
-
-This marble is mostly played by another player or via
- at ref{it-yinyang}.
-
- at strong{Attributes}
-
- at table @code
- at item mouseforce (default 1.0)
- at item color (default 1.0)
- at item whiteball (default 1)
- at item player (default 1)
- at item controllers (default 2)
- at end table
-
-
- at node ac-whiteball-small
- at subsection ac-whiteball-small
-
-This is the meditation marble. In meditation levels, you must place
-them in @code{it-hollow} or @code{it-tinyhollow} to win the level,
-see @ref{Hills and Hollows}.
-
- at strong{Attributes}
-
- at table @code
- at item mouseforce (default 1.0)
- at item color (default 1.0)
- at item whiteball (default 1)
- at item controllers (default 3)
- at end table
-
-
- at c ----------------------------------------------------------------------
- at node General object attributes
- at section General object attributes
-
- at table @code
- at item name
-All objects may be given a @code{name} attribute. Such @emph{named objects} can
-be searched using @ref{enigma.GetNamedObject}.
- at end table
-
- at c ----------------------------------------------------------------------
- at node Differences between Compatibility Modes
- at section Differences between Compatibility Modes
-
-Although Enigma was inspired by the original Oxyd-series, there are
-some differences between the current Enigma engine and the Oxyds as
-well as between the Oxyds themselves. Using the compatibility-section
-of the xml-metadata (see @ref{<compatibility>}) or the
- at ref{enigma.SetCompatibility}-function, it's possible to activate some
-of these behaviors. Here's a list of the currently implemented
-differences, not all of them are mentioned at the corresponding
-sections above:
-
 @strong{All non-Enigma modes @code{(oxyd1, per.oxyd, oxyd.magnum, oxyd.extra)}}
 
 @itemize @bullet
- at item Keep @ref{it-key} when using @ref{st-key}.
- at item Oxyd-stones (@ref{st-oxyd}) must blink before they can be
+ at item Keep @ref{it_key} when using @ref{st_key}.
+ at item Oxyd stones (@ref{st_oxyd}) must blink before they can be
 ultimately opened (pairs must be hit with some time delay).
 @item The non-Enigma modes feature a model of the 0.92-Fire System
 (see @ref{Fire Spreading}).
- at item @ref{it-squashed} and @ref{it-cross} can't be removed with
- at ref{it-brush}.
- at item Only function of @ref{it-pencil} is to turn
- at code{st-plain[_move]} into @code{st-firebreak[_move]}.
- at item @ref{it-booze} doesn't break to @ref{it-booze-broken} when a
-stone is pushed over it.
- at item @ref{st-swap} and @ref{st-pull} may not swap/pull into the level
+ at item @ref{it_squashed} and @ref{it_cross} can't be removed with
+ at ref{it_brush}.
+ at item Only function of @ref{it_pencil} is to turn
+ at ref{st_flat} and its movable variant into the burnable variants.
+ at item @ref{it_bottle} doesn't break when a stone is pushed over it.
+ at item @ref{st_swap} and @ref{st_pull} may not swap/pull into the level
 border.
 @end itemize
 
@@ -26376,1056 +22368,41 @@
 @strong{@code{oxyd1}-compatibility}
 
 @itemize @bullet
- at item @ref{it-seed} grows to @code{fl-stwood} under @code{st-grate1}
-(@ref{st-grate}), not to @ref{st-wood}.
- at item Flying actors may pass @code{st-grate1} and @code{st-grate2}
-(see @ref{st-grate}).
- at item @ref{st-wood} only falls when moved.
- at item The @code{ignite}-message (e.g. by @ref{it-dynamite}) doesn't
-kill @ref{it-document}.
- at item Bombs (@ref{it-blackbomb}, @ref{it-whitebomb}) aren't ignited
-when @ref{st-wood} is pushed over them (see
- at code{oxydmagnum}-compatibility).
+ at item @ref{it_seed} grows to @ref{fl_wood}_framed under @ref{st_grate}_cross, 
+not to @ref{st_box}_wood.
+ at item Flying actors may pass @ref{st_grate}).
+ at item @ref{st_box}_wood only falls when moved.
+ at item The @code{ignite}-message (e.g. by @ref{it_dynamite}) doesn't
+kill @ref{it_document}.
+ at item Bombs @ref{it_bomb} aren't ignited when @ref{st_box}_wood is pushed over
+them (see @code{oxydmagnum}-compatibility).
 @end itemize
 
 
 @strong{@code{per.oxyd}-compatibility}
 
 @itemize @bullet
- at item When painted with @ref{it-brush}, @code{st-stonebrush} (see
- at ref{st-invisible}) becomes @code{st-likeoxydc-open} instead of
- at code{st-rock4}.
- at item @ref{it-hammer} doesn't laser-transform into @ref{it-sword}.
- at item @ref{it-umbrella} doesn't explode in laser light.
- at item @ref{it-cross} inverts signals it receives.
+ at item When painted with @ref{it_brush}, @ref{st_ghost}_purplemarble becomes
+an open @ref{st_fake}_oxydc instead of @code{st_purplemarble}.
+ at item @ref{it_hammer} doesn't laser-transform into @ref{it_sword}.
+ at item @ref{it_umbrella} doesn't explode in laser light.
+ at item @ref{it_cross} inverts signals it receives.
 @end itemize
 
 
 @strong{@code{oxyd.magnum}-compatibility}
 
 @itemize @bullet
- at item @ref{it-seed} grows to @code{fl-stwood} under @code{st-grate1}
-(@ref{st-grate}), not to @ref{st-wood}.
- at item Bombs (@ref{it-blackbomb}, @ref{it-whitebomb}) aren't ignited
-when @ref{st-wood} is pushed over them (see
- at code{oxyd1}-compatibility).
+ at item @ref{it_seed} grows to @ref{fl_wood}_framed under @ref{st_grate}_cross, 
+not to @ref{st_box}_wood.
+ at item Bombs at ref{it_bomb} aren't ignited when @ref{st_box}_wood is pushed over
+them (see @code{oxyd1}-compatibility).
 @end itemize
 
 
 
- at c ======================================================================
- at node Old API - Variables
- at chapter Old API - Variables
-
-This chapter describes a few variables that you can change from
-level descriptions to alter the behavior of the game engine or set
-default attributes for some particular objects, or that carry
-interesting information about the context of the level.  In the second
-case, you can usually achieve the same effect by setting the
-corresponding object attributes directly, but being able to specify a
-global default value often is more convenient.  You can always
-override these default attribute values for specific objects by
-setting the appropriate object attributes.
-
- at defvar enigma.ConserveLevel values: @code{TRUE}, @code{FALSE}; default: @code{TRUE}
-The conserve mode determines if a dead actor will be resurrected in case of
-extralives in the gamer's inventory.
-
-If @code{TRUE}, dead actors attached to a
-player will be resurrected as long as extralives are available. If a player has
-no living actor to control or is missing the actor's essential constraints
-(@pxref{Actor Attributes}), the
-player is dead. The level may still continue if a second player is alive. If
-the gamer has a yinyang in his inventory in single user mode, the control switches
-to the second player. If all players are dead, a new level game is started.
-
-If the conserve mode is @code{FALSE}, no actors will be resurrected. As soon as the
-player is dead and the control cannot switch to another player, all dead actors
-are resurrected by using extralives, and the level is restarted without
-finishing the level game.
-
-Use @code{FALSE} if the level cannot be solved in case of resurrected actors.
-In all other cases, mode @code{TRUE} with proper usage of actors essential
-constraints will be preferable (@pxref{Actor Attributes}).
- at end defvar
-
- at defvar enigma.CreatingPreview
- at code{TRUE} or @code{FALSE}, read-only.  Use this in a
-level to determine whether it is just loaded to build a thumbnail.  If so, you can,
-e.g., change the start-position of @ref{ac-blackball} to display
-another part of the level in the preview, or hide objects from it.
-When changing the initial position, it might be advantageous to also
-set the follow-mode to smooth (@ref{display.SetFollowMode}):
- at example
-if enigma.CreatingPreview then
-  display.SetFollowMode(display.FOLLOW_SMOOTH)
-else
-  display.SetFollowMode(@dots{})
-end
- at end example
- at end defvar
-
- at defvar enigma.Brittleness
-A value between 0 and 1, denoting the probability that a brittle floor
-plate disintegrates further when an actor enters or leaves it.  1
-means that the floor will always crack, 0 that it is indestructible
-(see @ref{it-crack}).  Default: 0.5.
- at end defvar
-
- at defvar enigma.BumperForce
-The amount of force applied to an actor that hits an
- at ref{st-actorimpulse} stone.
-Default: 200.0.
- at end defvar
-
- at defvar enigma.ElectricForce
-A force multiplier for all electric forces between actors,
-see @ref{st-charge}.
-Default: 15.0.
- at end defvar
-
- at defvar enigma.FrictionFactor
-All friction forces are multiplied by this value.
-Default: 1.0.
- at end defvar
-
- at defvar enigma.FlatForce
-A global downward force.  This is currently only applied on floors of
-type @ref{fl-space-force}, and obsolete since introduction of the
- at code{force_[x/y]}-attributes.  Default: 0.
- at end defvar
-
- at defvar enigma.IceFriction
-Friction of @ref{fl-ice} is multiplied with this constant. Default:
-1.0.
- at end defvar
-
- at defvar enigma.HoleForce
-A force factor that affects the steepness of hollows and hills (see
- at ref{Hills and Hollows}).  Default: 1.0.
- at end defvar
-
- at defvar enigma.MagnetForce
-A force multiplier for magnetic fields (see @ref{it-magnet}).
-Default: 30.0.
- at end defvar
-
- at defvar enigma.MagnetRange
-The range of magnetic fields (see @ref{it-magnet}).  Default: 10.0.
- at end defvar
-
- at defvar enigma.ShowMoves
- at code{TRUE} or @code{FALSE}.  This is preferably used in Sokoban
-levels to display a move counter in the inventory.
-Default: @code{FALSE}.
- at end defvar
-
- at defvar enigma.SlopeForce
-A force multiplier for sloped floor tiles (see @ref{fl-gradient}).
-Default: 25.0.
- at end defvar
-
- at defvar enigma.WaterSinkSpeed
-How quickly balls sink in @ref{fl-water}.  Default: 1000.0.
- at end defvar
-
- at defvar enigma.SwampSinkSpeed
-How quickly balls sink in @ref{fl-swamp}.  Default: 4.0.
- at end defvar
-
- at defvar enigma.WormholeForce
-A force multiplier for @ref{it-wormhole}.  Default: 30.0.
- at end defvar
-
- at defvar enigma.WormholeRange
-The range of @ref{it-wormhole}.  Default: 10.0.
- at end defvar
-
-
- at node Old API - Functions
- at chapter Old API - Functions
-
- at menu
-* AddRubberBand::               Creating rubber bands
-* CreateWorld::                 Create the Level
-* display.SetFollowMode::       Sets the follow mode
-* draw_border::                 Drawing a border of stones
-* draw_checkerboard_floor::     Draws a checkerboard
-* draw_floor::                  Draws a line of floortiles
-* draw_items::                  Draws a line of items
-* draw_stones::                 Draws a line of stones
-* enigma.AddConstantForce::     Add a constant force
-* enigma.GetAttrib::            Get an objects attribute
-* enigma.GetNamedObject::       Get an objects name
-* enigma.GetKind::              Get an objects kind
-* enigma.KillFloor::            Kills a floortile
-* enigma.KillItem::             Kills an item
-* enigma.KillStone::            Kills a stone
-* enigma.LoadLib::              Loading a not preloaded library
-* enigma.NameObject::           Set the name of an object
-* enigma.SetAttrib::            Set an attribute of an object
-* enigma.SetAttribs::           Set multiple attributes of an object
-* enigma.SetDefaultAttribs::    Set default attributes
-* enigma.SetCompatibility::     Compatibility of a level
-* fill_floor::                  Fills a rectangle with a floortile
-* fill_items::                  Fills a rectangle with an item
-* fill_stones::                 Fills a rectangle with a stone
-* MakeObject::                  Creates an object
-* SendMessage::                 Sending messages to objects
-* set_floor::                   Set a single floortile
-* set_item::                    Set a single item
-* set_stone::                   Set a single stone
-* set_stones::                  Set a list of stones
-
-
- at end menu
-
 @c ......................................................................
- at node AddRubberBand
- at section AddRubberBand
 
- at defun AddRubberBand (actor, object, strength, length)
-
-This function connects two objects with a rubber band: The first
-object is always an actor, the second object can be either another
-actor or a stone.
-
-The first argument @var{actor} is always a reference to an actor
-created earlier with the @code{set_actor} function.  The second
-parameter @var{object} may be either an actor or a stone created
-earlier.  The last two parameters define the properties of the rubber
-band: @var{strength} denotes the force factor of the elastic, and
- at var{length} denotes its natural length.  No force is exerted on the actor if
-the rubber band is shorter than its natural length.
-
- at end defun
-
- at subsection Example
-
- at example
-local ac=set_actor("ac-blackball", 1.5,7.5)
-local st=set_stone("st-brownie", 10,6)
-AddRubberBand(ac, st, 50, 10)
- at end example
-
- at c ......................................................................
- at node CreateWorld
- at section CreateWorld
-
- at defun CreateWorld (width, height)
-
-This function creates a new level. Because objects can be added
-to the level only after @code{CreateWorld} has been called,
-you should usually do so near the beginning of your level
-description.
-
-The @var{width} and @var{height} denote the size of the new level.  All
-levels with only one screen have the minimum size of 20x13 blocks.
-
-Note that level fields are indexed from zero, i.e., the field indices
-for a 20x13 level are in the range (0..19)x(0..12). Also note that the
-screens in Enigma overlap by one line or column: A level that fits on
-a single screen has size of 20x13, but two a level that is two screens
-wide 39x13 or 20x25, three screens 58x13 or 20x37.
- at end defun
-
- at c ......................................................................
- at node display.SetFollowMode
- at section display.SetFollowMode
-
- at defun display.SetFollowMode (mode)
-
-This function sets the followmode of a level. The followmode defines the behavior
-of the landscape if a level is bigger than one screen.
-
-Possible values are:
- at table @var
- at item display.FOLLOW_NONE
-Don't follow any sprite.
- at item display.FOLLOW_SCROLLING
-Scroll the screen.
- at item display.FOLLOW_SCREEN
-Flip the screen region.
- at item display.FOLLOW_SCREENSCROLLING
-Scroll to the next screen.
- at item display.FOLLOW_SMOOTH
-Follow pixel by pixel.
- at end table
-
- at end defun
-
- at c ......................................................................
- at node  draw_border
- at section draw_border
-
- at defun draw_border (stonename, x,y, w,h)
-
-This function adds a border of stones to your level.  If invoked with
-only one argument, this border encloses the whole level.
-
- at table @var
- at item stonename
-The name of the border stone.
- at item x,y
-(optional) Coordinates of upper-left corner. (0,0) if omitted.
- at item w,h
-(optional) Width and height of border.
- at end table
-
- at end defun
-
- at subsection Example
-
- at example
-draw_border("st-marble")
-draw_border("st-greenbrown", 0,5,3,3)
- at end example
-
- at c ......................................................................
- at node  draw_checkerboard_floor
- at section draw_checkerboard_floor
-
- at defun draw_checkerboard_floor (name1, name2, x, y, w, h, attribs)
-
-This function draws checkerboard composed of two selected floor
-types. @var{name1} and @var{name2} are names of floor objects. See
- at ref{set_floor} for further details.
-
- at table @var
- at item name1, name2
-Names of floor objects
- at item x, y
-Location of left top corner of checkerboard area. Note that upper left
-map corner is [0,0].
- at item w, h
-Size of generated checkerboard.
- at item attribs
-Table of attribute names and corresponding values:
- at code{@{attrib1=value1, attrib2=value2, @dots{}@}}. These attributes,
-together with default attributes, are passed to each tile of the
-generated checkerboard.
- at end table
-
- at end defun
-
- at subsection Example
-
- at example
-draw_checkerboard_floor("fl-abyss", "fl-rough", 2, 2, 23, 11)
-draw_checkerboard_floor("fl-normal", "fl-inverse", 0, 0, levelw, levelh) -- racetrack
- at end example
-
- at c ......................................................................
- at node  draw_floor
- at section draw_floor
-
- at defun draw_floor (floorname, location, increment, count , attribs)
-
-Description: Use this function to add several floor objects
-to your level at periodic distances. How does it work? At first it
-places the floor to location. Then it moves by
-increment, and again places the given floor. And again and again
--- as many times as defined by count.
- at table @var
- at item Floorname
-Name of floor object.
- at item Location
-This is Lua table with two elements:
-@{x,y@}. They represent the location of first floor object
- at item Increment: Another Lua table with two elements:
-@{dx,dy@}. dx is the increment per step in x-axis,
-dy is increment per step in y-axis. Often this function is
-used to add a row of floors in one direction, then
-Increment looks like this: @{1,0@} or
-@{0,1@}.
- at item Count
-Number of steps to proceed.
- at item Attribs
-Table of attribute names and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}. It represents the
-attributes to be passed to each created floor. You can omit this
-argument.
- at end table
-
- at end defun
-
- at subsection Example
-
- at example
-draw_floor("fl-abyss", @{3,0@}, @{0,1@}, level_height)
-draw_floor("fl-gradient", @{15, 5@}, @{1,0@}, 4, @{type=1@})
-draw_floor("fl-water", @{level_width-4,3@}, @{0,1@}, level_height-6)
- at end example
-
-
- at c ......................................................................
- at node  draw_items
- at section draw_items
-
- at defun draw_items (itemname, location, increment, count [, attribs])
-
-Description: This function adds several item
-objects to your level at periodic distances. It works much like draw_floor,
-except that it adds items instead of floors.
- at table @var
- at item Itemname
-Name of item object.
- at item Location
-This is Lua table with two elements:
-@{x,y@}. They represent the location of first item that you
-want to add to map.
- at item Increment: Another Lua table with two elements:
-@{dx,dy@}. dx is the increment per step in x-axis,
-dy is increment per step in y-axis.
- at item Count
-Number of steps to proceed.
- at item Attribs
-Table of attribute names and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}. It represents the
-attributes to be passed to each created item. You may omit this
-argument.
- at end table
-
- at end defun
-
- at subsection Example
-
- at example
-draw_items("it-trigger", @{3,3@}, @{2,0@}, 8)
-draw_items("it-tinyhill", @{5,3@}, @{2,0@}, 7)
- at end example
-
- at c ......................................................................
- at node  draw_stones
- at section draw_stones
-
- at defun draw_stones (stonename, location, increment, count [, attribs])
-
-Description: This function adds several stones
-to your level at periodic distances. It works much like draw_floor,
-except that it adds stones instead of floors.
- at table @var
- at item Stonename
-Name of stone object.
- at item Location
-This is Lua table with two elements:
-@{x,y@}. They represent the location of first stone to be
-placed to map.
- at item Increment
-Another Lua table with two elements:
-@{dx,dy@}. dx is the increment per step in x-axis,
-dy is increment per step in y-axis.
- at item Count
-Total number of stones to add.
- at item Attribs
-Table of attribute names and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}. It represents the
-attributes to be passed to each created stone. You may omit this
-argument.
- at end table
-
- at end defun
-
- at subsection Example
-
- at example
-draw_stones("st-grate1", @{9,1@},@{0,1@}, 5)
-draw_stones("st-stone_break", @{21,1@}, @{1,0@}, 10)
-
-function draw_border(stonename, x0, y0, w, h)
-    draw_stones(stonename, @{x0,y0@}, @{1,0@}, w)
-    draw_stones(stonename, @{x0,y0+h-1@},@{1,0@}, w)
-    draw_stones(stonename, @{x0,y0@}, @{0,1@}, h)
-    draw_stones(stonename, @{x0+w-1,y0@},@{0,1@}, h)
-end
- at end example
-
- at c ......................................................................
- at node enigma.AddConstantForce
- at section enigma.AddConstantForce
-
- at defun enigma.AddConstantForce (gravity_x, gravity_y)
-
-Adds global gravity to the current level.
-
- at table @var
- at item gravity_x
-adds gravity in horizontal direction (positive means rightwards).
- at item gravity_y
-adds gravity in vertical direction (positive means downwards).
- at end table
-
- at end defun
-
- at c ......................................................................
- at node enigma.GetAttrib
- at section enigma.GetAttrib
-
- at defun GetAttrib (object, attribname)
-
-Description: The function is similar to SetAttrib, except
-that it doesn't set the attribute, but returns current attribute
-value. Function arguments have the same meaning as in
-SetAttrib, see its description. Also note
-GetKind.
- at table @var
- at end table
-
- at end defun
-
- at subsection Example
-
- at example
-local bolder_dir = GetAttrib(bolder1, "direction")
- at end example
-
- at c ......................................................................
- at node enigma.GetNamedObject
- at section enigma.GetNamedObject
-
- at defun enigma.GetNamedObject (objname)
-
-This function searches for an object that has a @code{name} attribute
-with value @var{objname}.  It returns a reference to the object or
- at code{nil} if none could be found.
-
- at end defun
-
- at subsection Example
-
- at example
-set_stone("st-wood", 7, 11, @{name="woodie"@})
- at dots{}
-local Woodie = enigma.GetNamedObject("woodie")
- at end example
-
- at c ......................................................................
- at node enigma.GetKind
- at section enigma.GetKind
-
- at defun enigma.GetKind(object)
-
-Description: This function returns the kind of an object.
- at end defun
-
- at subsection Example
-
- at example
-set_stone("st-wood", 7, 11)
- at dots{}
-local mystone=enigma.GetStone(7,11)
-local mystonetype = enigma.GetKind(mystone)
-
-mystonekind will be "st-wood"
- at end example
-
- at c ......................................................................
- at node enigma.KillFloor
- at section enigma.KillFloor
-
- at defun enigma.KillFloor (x, y)
-
-Kills the floor tile at position (x,y).
-
- at table @var
- at item x, y
-Coordinates of the floortile to kill.
- at end table
-
- at end defun
-
- at c ......................................................................
- at node enigma.KillItem
- at section enigma.KillItem
-
- at defun enigma.KillItem (x, y)
-
-Kills the item at position (x,y).
-
- at table @var
- at item x, y
-Coordinates of the item to kill.
- at end table
-
- at end defun
-
- at c ......................................................................
- at node enigma.KillStone
- at section enigma.KillStone
-
- at defun enigma.KillStone (x, y)
-
-Kills the stone tile at position (x,y).
-
- at table @var
- at item x, y
-Coordinates of the stone to kill.
- at end table
-
- at end defun
-
- at c ......................................................................
- at node enigma.LoadLib
- at section enigma.LoadLib
-
- at defun enigma.LoadLib (libraryId)
-
-This function loads a Lua level library that has previously been declared in
- at ref{<compatibility>} at a given point of code execution. If the library is
-declared with @samp{el:preload="true"}, no Lua function call is necessary.
-The @var{libraryId} is the same as in the declaration.
- at end defun
-
- at c ......................................................................
- at node enigma.NameObject
- at section enigma.NameObject
-
- at defun enigma.NameObject (object, value)
-
-Description: Gives the name value to object.
-
- at table @var
- at end table
-
- at end defun
-
- at c ......................................................................
- at node enigma.SetAttrib
- at section enigma.SetAttrib
-
- at defun enigma.SetAttrib (object, attribname, value)
-
-Description: The function sets the given attribute of a
-given object to a given value. If you try to pass an unknown attribute to
-an object, Enigma will ignore it (i.e., the value is assigned, but nothing
-special happens).
- at table @var
- at item Object
-The variable that holds the object. Every function
-that creates an object returns the variable representing the freshly added
-object. That's right, what should be passed to SetAttrib. (See example.)
- at item Attribname
-Name of the attribute. See the description of
-objects to learn which object knows what attributes.
- at item Value
-New value of attribute.
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-local ls = set_stone("st-laser", 1, 4, @{on=FALSE, dir=NORTH@})
-set_attrib(ls, "name", "laser")
-
--- (also "on" and "dir" are attributes in this example)
- at end example
-
- at c ......................................................................
- at node enigma.SetAttribs
- at section enigma.SetAttribs
-
- at defun enigma.set_attribs (object, attribs)
-
-Description: This function sets several attributes at a
-time. The only thing it does is to call SetAttrib as many times as needed to set
-values of all desired attributes.
- at table @var
- at item Object
-Value that holds the object, whose attributes are
-about to change.
- at item Attribs
-Table of attribute names and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-local ls = set_stone("st-laser", 1, 4, @{on=FALSE, dir=NORTH@})
- at dots{} (some lua code) @dots{}
-set_attribs(ls, @{on=TRUE, dir=WEST@})
- at end example
-
- at c ......................................................................
- at node enigma.SetDefaultAttribs
- at section enigma.SetDefaultAttribs
-
- at defun enigma.SetDefaultAttribs (objectname, attribs)
-
-Description: Use this function if there are several objects
-of same kind, which have attributes (all or just some) with the same
-value. For example, if there are twenty wormholes with strength of 10,
-you can set the strength of 10 as a default value for all
-wormholes.
-
-Notes: Default attributes can be overridden or several extra
-attributes can be assigned to an object. The attributes specified at
-creation time (using set_floor, set_item, set_stone
-functions) override the default attributes specified by
-SetDefaultAttribs.
- at table @var
- at item Objname may be name of any Enigma stone, floor or
-item. In most cases, this is a wormhole, because it's usual to have
-several wormholes with the same strength and range, while it's not very
-common to have, for example, all doors vertical or all bolders facing
-west.
- at item Attribs
-Table of keys and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-SetDefaultAttribs("it-wormhole", @{range=1.0, strength=10@})
-set_item("it-wormhole", 11, 6, @{targetx="48.5",targety="56.5"@})
- at end example
-
- at c ......................................................................
- at node enigma.SetCompatibility
- at section enigma.SetCompatibility
-
- at defun enigma.SetCompatibility (compatibility)
-
-This function sets the compatibility of a level. Because certain objects may have a different
-behavior in the original Oxyd games, a compatibility mode exists for each game. Enigma itself
-has also a compatibility mode, it's the default.
-
-Note: This function is deprecated. Set the compatibility information in the
-xml-node @ref{<compatibility>} instead.
-
-Possible values for compatibility are:
- at table @var
- at item oxyd1
-Oxyd1-mode
- at item per.oxyd
-Per.Oxyd-mode
- at item oxyd.magnum
-OxydMagnum-mode
- at item oxyd.extra
-Oxydextra-mode
- at item enigma
-Enigma-mode
-
- at end table
-
- at end defun
-
- at c ......................................................................
- at node fill_floor
- at section fill_floor
-
- at defun fill_floor (floorname)
-fill_floor (floorname, x, y, w, h)
-
-Description: This function fills an area of map with a
-selected floor type.
- at table @var
- at item Floorname
-Name of the floor object. If this is the only argument to the function,
-the whole map area is filled with this kind of floor.
- at item x, y
-Coordinates of upper left corner of filled area. Note
-that the upper left square of map is at coordinates [0,0]. If those
-arguments are omitted, zero is passed instead.
- at item w, h
-Size of the filled area. If any of these arguments is
-omitted, level width or height respectively is passed by default.
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-fill_floor("fl-space", 0,0, level_width,level_height)  -- these two lines
-fill_floor("fl-space")                                 -- do the same
-fill_floor("fl-gray", 1, 1, level_width-2, level_height-2)
-fill_floor("fl-water", 24,47, 11,1)
- at end example
-
- at c ......................................................................
- at node fill_items
- at section fill_items
-
- at defun fill_items (itemname, x, y, w, h)
-
-Description: This function fills an area of the map with
-items of a selected kind.
-
-Note: Please note that in contrast to function fill_floor, this function
-doesn't have any default attributes, and no parameter may be omitted.
-
-(strange, no one ever used this function in their map @enddots{})
- at table @var
- at item Itemname
-Name of item object.
- at item x, y
-Coordinates of the upper left corner of the filled area. Note
-that the upper left square of the map is at coordinates [0,0].
- at item w, h
-Size of the filled area - w is width and
-h is height.
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-fill_items("it-wormhole", 1, 1, 3, 3) -- field of 3x3 wormholes
- at end example
-
- at c ......................................................................
- at node fill_stones
- at section fill_stones
-
- at defun fill_stones (stonename, x, y, w, h)
-
-Description: This function fills an area of the map with
-stones of a selected kind.
-
-Note: Please note that in contrast to function fill_floor,
-this function doesn't have any default attributes, and no parameter may be omitted.
- at table @var
- at item Stonename
-Name of stone object.
- at item x, y
-Coordinates of the upper left corner of the filled area. Note
-that the upper left square of the map is at coordinates [0,0].
- at item w, h
-Size of filled area - w is width and h is height.
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-fill_stones("st-chameleon", 1, 1, 18, 11)
-fill_stones("st-grate1", 1, 5, 5, 7)
-fill_stones("st-death", 9, 5, 2, 2)
- at end example
-
- at c ......................................................................
- at node  MakeObject
- at section MakeObject
-
- at defun MakeObject (objname, attribs)
-
-Description: The function MakeObject is used internally by
-other functions, like set_floor, set_item or
-set_stone.
-It takes care of creating the object and sets up all desired
-attributes, including default ones
- at table @var
- at item Objname
-Name of an internal Enigma object. It can be the name of
-any floor, stone or item.
- at item Attribs
-Table of attribute names and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}
- at end table
-
- at end defun
-
- at subsection Example
-
- at example
-Example: To my best knowledge, no one uses this function in
-their levels. You should instead use set_floor/stone/item functions for
-creating particular Enigma objects. If you need this function, you are
-probably a guru and you don't need this manual either.
- at end example
-
- at c ......................................................................
- at node SendMessage
- at section SendMessage
-
- at defun SendMessage (object, message, data)
-
-This function sends a @var{message} to an @var{object}.
-
- at table @var
- at item object
-The recipient of the message.  Can be either the name of an object or a
-reference as returned by @ref{enigma.GetNamedObject}.
- at item message
-The message itself (e.g. ``signal'') You can see which messages are
-understood in the documentation of the particular @ref{Old API - Objects}.
- at item data
-Some specific messages expect some additional data (e.g., message
-``direction'' expects a direction like SOUTH or WEST).
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-set_stone("st-laser-s", 2, 2, @{name="laser3", on=FALSE@})
- at dots{}
-SendMessage("laser3", "onoff")
- at end example
-
- at example
-set_stone("st-bolder", 7, 11, @{name="bolder1", direction=SOUTH@})
- at dots{}
-SendMessage("bolder1", "direction", WEST)
- at end example
-
- at c ......................................................................
- at node set_floor
- at section set_floor
-
- at defun set_floor (floorname, x, y, attribs)
-
-Description: As you would expect, this function creates a
-floor at a given [x,y] position in Enigma level, and passes all
-necessary default attributes and
-attributes passed in the attribs argument.
- at table @var
- at item Floorname
-Enigma internal object name. The name should be
-the name of the floor (they typically start with ``fl-'' prefix). Enigma
-won't let you create a floor from another object, just from real floors.
- at item x, y
-Location where you want the floor to be placed. Note
-that level coordinates begin with zero (see CreateWorld).
- at item Attribs
-Table of attribute names and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-function setup_gradient_rose(x,y)
-   set_floor("fl-gradient", x, y+1, @{type=1@})
-   set_floor("fl-gradient", x, y-1, @{type=2@})
-   set_floor("fl-gradient", x+1, y, @{type=3@})
-   set_floor("fl-gradient", x-1, y, @{type=4@})
-end
- at end example
-
- at c ......................................................................
- at node set_item
- at section set_item
-
- at defun set_item (itemname, x, y, attribs)
-
-Description: This function is very similar to the one named
-set_floor, described earlier. It creates an
-item at a given position. Items in Enigma are all those magic wands,
-brushes, coins, triggers, bombs and also, for example, the laser ray or
-crackles. Only one single item can be on each position.
-
-Note: The rule of single-item-per-field also means that a
-laser cannot ``overshoot'' a magic wand or trigger, or that you cannot drop
-an item to cracked floor, etc. It may look like a disadvantage, but on the
-other hand, it can be used as an advantage (see, for example, the level
-named ``Follow the Light'' in ``Oxyd Clones'' package).
- at table @var
- at item Itemname
-Enigma internal object name. The name must be
-the name of an item (they typically start with ``it-'' prefix). Enigma
-won't let you create an item from another object, just from real items.
- at item x, y
-Location where you want the item to be placed. Note
-that level coordinates begin with zero (see CreateWorld).
- at item Attribs
-Table of attribute names and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-set_item("it-trigger", 34, 3, @{action="openclose", target="bridge1"@})
- at end example
-
- at c ......................................................................
- at node set_stone
- at section set_stone
-
- at defun set_stone (stonename, x, y, attribs)
-
-Description: This function is very similar to the one named
-set_floor, describer earlier. It places the
-stone to the desired location. Stones in Enigma are all walls, glass
-blocks, death's heads, and also doors, switches, lasers, bolders and
-lots of other special Enigma objects.
- at table @var
- at item Stonename
-Enigma internal stone name. The name must be
-the name of a stone (they typically start with ``st-'' prefix). Enigma
-won't let you create a stone from another object, just from real stones.
- at item x, y
-Location where you want the stone to be placed. Note
-that level coordinates begin with zero (see CreateWorld).
- at item Attribs
-Table of attribute names and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-set_stone("st-door", 18,  6, @{name="door01", type="h"@})
-set_stone("st-bolder", 2, 11, @{name="bolder01", direction=NORTH@})
- at end example
-
- at c ......................................................................
- at node set_stones
- at section set_stones
-
- at defun set_stones (stonename, positions, attribs)
-
-Description: This function is somehow similar to draw_stones.
-It can place several stones in locations all over the map.
-The locations to which the stones will be placed are listed in argument
-positions.
- at table @var
- at item Stonename
-Enigma internal stone name.
- at item Positions
-Table of stone locations. Its format is like this:
-@{loc1, loc2, @dots{}@}, where each location is
-@{x,y@}. Together it looks like this: @{@{x1,y1@}, @{x2,y2@},
- at dots{}@}.
- at item Attribs
-Table of attribute names and corresponding values:
-@{attrib1=value1, attrib2=value2, @dots{}@}. Those attributes will
-be passed to created stones together with default attributes. You may omit this
-attribute.
- at end table
-
- at end defun
-
- at subsection Examples
-
- at example
-set_stones("st-glass", @{@{1,6@},@{1,12@},@{34,1@},@{34,2@},@{35,2@},@{36,1@},@{36,2@}@})
-set_stones(bordertile, @{@{34, 1@}, @{34, 5@}, @{34, 7@}, @{34, 11@}@})
- at dots{}
-set_stones("st-invisible", @{@{7,9@}@}) -- these two lines
-set_stone("st-invisible", 7, 9)     -- do the same
- at end example
-
- at c ......................................................................
-
 @node Object Index
 @unnumbered Object Index
 
@@ -27454,8 +22431,10 @@
 
 @printindex cp
 
+ at c ==================  Renaming Index  =======================
 @node Renaming Index
 @unnumbered Renaming Index
+
 @table @asis
 @item @b{ac-blackball} @expansion{} @code{ac_marble_black}, @pxref{ac_marble}
 @item @b{ac-bug} @expansion{} @ref{ac_bug}
@@ -28089,7 +23068,7 @@
 @need 200
 @item @b{st-white3} @expansion{} @code{st_passage_white_cross}, @pxref{st_passage}
 @item @b{st-white4} @expansion{} @code{st_passage_white_frame}, @pxref{st_passage}
- at item @b{st-window} @expansion{} @ref{st-window}
+ at item @b{st-window} @expansion{} @ref{st_window}
 @item @b{st-wood} @expansion{} @code{st_box_wood}, @pxref{st_box}
 @need 200
 @item @b{st-wood1} @expansion{} @code{st_box_wood_h}, @pxref{st_box}



From raoulb at bluewin.ch  Sat Jun  6 16:19:12 2009
From: raoulb at bluewin.ch (Raoul)
Date: Sat, 6 Jun 2009 16:19:12 +0200
Subject: [Enigma-game-svn] r1707
Message-ID: <20090606161912.411424ff@amarok.loinet.zh>

-> New level ("sunrise-sunset")
-> Bugfixes ("just moving blocks")
-> Many new rewrites


From raoul at mail.berlios.de  Sat Jun  6 16:27:50 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 6 Jun 2009 16:27:50 +0200
Subject: [Enigma-game-svn] r1708 - in trunk/data/levels: enigma_cross
	enigma_iv
Message-ID: <200906061427.n56ERo44010398@sheep.berlios.de>

Author: raoul
Date: 2009-06-06 16:27:49 +0200 (Sat, 06 Jun 2009)
New Revision: 1708

Modified:
   trunk/data/levels/enigma_cross/enigma0_92_1.xml
   trunk/data/levels/enigma_iv/duffy05_2.xml
   trunk/data/levels/enigma_iv/index.xml
Log:
-> Another update for "just moving blocks"



Modified: trunk/data/levels/enigma_cross/enigma0_92_1.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-06-06 14:14:51 UTC (rev 1707)
+++ trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-06-06 14:27:49 UTC (rev 1708)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="31" title="Enigma 0.92 - 1"/>
+  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="32" title="Enigma 0.92 - 1"/>
 
   <attributes/>
 
@@ -128,7 +128,7 @@
     <level _seq="120" _title="Jump!" _xpath="enigma_i/duffy07_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy7" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="121" _title="Checkerboard" _xpath="enigma_iii/duffy08_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy8" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="122" _title="Circularity" _xpath="enigma_iv/ant10_1" author="Petr Machata" ctrl="force" easy="false" id="ant10" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="123" _title="Just Moving Blocks?" _xpath="enigma_iv/duffy05_2" author="Jacob Scott" ctrl="force" easy="true" id="duffy5" rel="2" rev="3" score="2" target="time" unit="duration"/>
+    <level _seq="123" _title="Just Moving Blocks?" _xpath="enigma_iv/duffy05_2" author="Jacob Scott" ctrl="force" easy="true" id="duffy5" rel="2" rev="4" score="2" target="time" unit="duration"/>
     <level _seq="124" _title="Slinky-Racing" _xpath="enigma_iv/duffy14_1" author="Jacob Scott" ctrl="force" easy="true" id="duffy14" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="125" _title="Boulder-Puzzle" _xpath="enigma_iv/duffy06_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy6" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="126" _title="Wild" _xpath="enigma_iii/ant28_2" author="Petr Machata" ctrl="force" easy="false" id="ant28" rel="2" rev="1" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_iv/duffy05_2.xml
===================================================================
--- trunk/data/levels/enigma_iv/duffy05_2.xml	2009-06-06 14:14:51 UTC (rev 1707)
+++ trunk/data/levels/enigma_iv/duffy05_2.xml	2009-06-06 14:27:49 UTC (rev 1708)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Just Moving Blocks?" el:subtitle="" el:id="duffy5"/>
-      <el:version el:score="2" el:release="2" el:revision="3" el:status="released"/>
+      <el:version el:score="2" el:release="2" el:revision="4" el:status="released"/>
       <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -30,7 +30,7 @@
 ti["H"] = {"st_break_oxydc"}
 ti["M"] = {"st_mirror", transparent=true, orientation=SLASH}
 ti["N"] = {"st_mirror", transparent=true, orientation=BACKSLASH}
-ti["V"] = {"st_oneway_s", "ow#"}
+ti["V"] = cond(wo["IsDifficult"], {"st_oneway_n", "ow#"}, {"st_oneway_s", "ow#"})
 ti["F"] = {"st_floppy", target="ow#*", action="flip"}
 ti["D"] = {"st_door_d", "hurdle#", faces="ew", state=OPEN}
 ti["S"] = {"st_switch", target="hurdle#*"}

Modified: trunk/data/levels/enigma_iv/index.xml
===================================================================
--- trunk/data/levels/enigma_iv/index.xml	2009-06-06 14:14:51 UTC (rev 1707)
+++ trunk/data/levels/enigma_iv/index.xml	2009-06-06 14:27:49 UTC (rev 1708)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10500" network="false" owner="Enigma Team" release="1" revision="42" title="Enigma IV"/>
+  <info enigma="1.00" group="Enigma" location="10500" network="false" owner="Enigma Team" release="1" revision="43" title="Enigma IV"/>
 
   <attributes/>
 
@@ -52,7 +52,7 @@
     <level _seq="44" _title="Patterns of Impulse" _xpath="./andreas11_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas11" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="45" _title="Ball and Chain" _xpath="./duffy41_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy41" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="46" _title="Stay There!" _xpath="./ralf05_3" author="Ralf Westram" ctrl="force" easy="false" id="ralf05" rel="3" rev="2" score="2" target="time" unit="duration"/>
-    <level _seq="47" _title="Just Moving Blocks?" _xpath="./duffy05_2" author="Jacob Scott" ctrl="force" easy="true" id="duffy5" rel="2" rev="3" score="2" target="time" unit="duration"/>
+    <level _seq="47" _title="Just Moving Blocks?" _xpath="./duffy05_2" author="Jacob Scott" ctrl="force" easy="true" id="duffy5" rel="2" rev="4" score="2" target="time" unit="duration"/>
     <level _seq="48" _title="Artillery" _xpath="./duffy111_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy111" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="49" _title="What's the Problem?" _xpath="./ss14_1" author="Sven Siggelkow" ctrl="force" easy="true" id="ss14" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="50" _title="Walls Of Sadness" _xpath="./ss12_1" author="Sven Siggelkow" ctrl="force" easy="true" id="ss12" rel="1" rev="0" score="1" target="time" unit="duration"/>



From ral at mail.berlios.de  Sat Jun  6 16:59:57 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sat, 6 Jun 2009 16:59:57 +0200
Subject: [Enigma-game-svn] r1709 - team_levelpacks/team_test_new_api
Message-ID: <200906061459.n56Exv3P014483@sheep.berlios.de>

Author: ral
Date: 2009-06-06 16:59:49 +0200 (Sat, 06 Jun 2009)
New Revision: 1709

Modified:
   team_levelpacks/team_test_new_api/ralT067_1.xml
   team_levelpacks/team_test_new_api/ralT084_1.xml
Log:
Test Level new API:
- updates on maze and position list levels


Modified: team_levelpacks/team_test_new_api/ralT067_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT067_1.xml	2009-06-06 14:27:49 UTC (rev 1708)
+++ team_levelpacks/team_test_new_api/ralT067_1.xml	2009-06-06 14:59:49 UTC (rev 1709)
@@ -38,6 +38,7 @@
 ti["u"] = {"st_switch", target="posconcat"}
 ti["v"] = {"st_switch", target="ploffset"}
 ti["x"] = {"st_switch", target="equality"}
+ti["y"] = {"st_switch", target="equalitypl"}
 
 
 
@@ -52,13 +53,16 @@
 "u                   ",
 "v      @            ",
 "x                   ",
-"                    ",
+"y                   ",
 "      wwwww         ",
 "                    ",
 "      .....         ",
 "    W .....  X      "
 })
 
+aby = no["ab#*"]
+abypos = po(aby)
+
 function lightoff()
 --    (no["other#*"] + no["anchor"]):kill()
     (no["anchor"] + no["other#*"]):kill()
@@ -82,8 +86,11 @@
     if grp1 + grp2 == (grp2 + grp1) then print("grp1 + grp2 == grp2 + grp1") else print("grp1 + grp2 != grp2 + grp1") end
 end
 
-aby = no["ab#*"]
-abypos = po(aby)
+function equalitypl()
+    pl2 = abypos .. po(1,4)
+    if abypos == abypos then print("abypos == abypos") else print("abypos != abypos") end
+    if abypos == pl2 then print("abypos == pl2") else print("abypos != pl2") end
+end
 
 function doabyss()
     for i = 1, #abypos do

Modified: team_levelpacks/team_test_new_api/ralT084_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT084_1.xml	2009-06-06 14:27:49 UTC (rev 1708)
+++ team_levelpacks/team_test_new_api/ralT084_1.xml	2009-06-06 14:59:49 UTC (rev 1709)
@@ -25,7 +25,9 @@
 ti[","] = {"fl_hay", "amaze#"}
 ti[";"] = {"it_puller"} .. ti[","]
 ti["!"] = {"fl_lawn"}
+ti["*"] = ti["."]
 
+
 ti["@"] = {"#ac_marble", "anchor1"}
 ti["A"] = {"fl_samba", "anchor2"}
 ti["c"] = {"it_cherry"}
@@ -62,7 +64,7 @@
     mymaze1 = res.maze(ti, {area ={"anchor1", 4, 5}, render = {".", "~", "-"}})
     mymaze2 = res.maze(mymaze1, {area ={"anchor2", 8, 4}, render = {{".","+"}, "~", "-"}})    
     mymaze3 = res.maze(mymaze2, {area ={po(2, 12), 5, 5}, kernel={3,2}, render = {".", wo:newMap(" ", {"!!!~","--!~","~~~~"})}})
-    mymaze4 = res.maze(mymaze3, {area ={"."}, kernel={1,1}, render = {"!", "~", "-"}})
+    mymaze4 = res.maze(mymaze3, {area ={"*"}, kernel={1,1}, render = {"!", "~", "-"}})
     mymaze5 = res.maze(mymaze4, {area ={"amaze#*"}, render = {"!", "~", "!"}})
     mymaze6 = res.maze(mymaze5, {area ={po(24, 12), 15, 12}, spacing={0,0}})
     mymaze7 = res.maze(mymaze6, {area ={po(40, 25), 15, 12}, kernel={0,0}})
@@ -70,21 +72,21 @@
     w,h = wo(mymaze7, " ", {
         "                                                                   ",
         "                      A                                            ",
-        "            @                          .............+.....         ",
-        "                                       .............+.....         ",
-        "                                       .............+.....         ",
-        "                                       .............+.....         ",
-        "                                       ...................         ",
-        "                                           ...............         ",
-        "                                           ...............         ",
-        "                                           .....  .  .....         ",
-        "                                           ......    .....         ",
-        "                                           ......   ......         ",
-        "                                           .....     .....         ",
-        "        c                                  .....  .  .....         ",
-        "                                           ...............         ",
-        "            c                              ...............         ",
-        "                                           ...............         ",
+        "            @                          *************+*****         ",
+        "                                       *************+*****         ",
+        "                                       *************+*****         ",
+        "                                       *************+*****         ",
+        "                                       *******************         ",
+        "                                           ***************         ",
+        "                                           ***************         ",
+        "                                           *****  *  *****         ",
+        "                                           ******    *****         ",
+        "                                           ******   ******         ",
+        "                                           *****     *****         ",
+        "        c                                  *****  *  *****         ",
+        "                                           ***************         ",
+        "            c                              ***************         ",
+        "                                           ***************         ",
         "                                                                   ",
         "          c                                                        ",
         "                                                                   ",
@@ -96,9 +98,9 @@
         "                                                                   ",
         "                                                                   ",
         "       ,,;,,,,,,,,,,,,,,,,,,                                       ",
-        "       ,,,,,,,,,,,,,,,,;,,,,                                       ",
-        "       ,,,,,,,,;,,,,,,,,,,,,                                       ",
         "       ,,,,,,,,,,,,,,,,,,,,,                                       ",
+        "       ,,,,,,,,;,,,,,,,;,,,,                                       ",
+        "       ,,,,,,,,,,,,,,,,,,,,,                                       ",
         "       ,,,,,,,,,,,,,,;,,,,,,                                       ",
         "       ,,,,,,,,,,,,,,,,,,,,,                                       ",
         "       ,,,,,,;,,,,,;,,,,,,,,                                       ",



From ral at mail.berlios.de  Sat Jun  6 18:45:52 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sat, 6 Jun 2009 18:45:52 +0200
Subject: [Enigma-game-svn] r1710 - in trunk: doc/reference/images src/gui
Message-ID: <200906061645.n56GjquO005226@sheep.berlios.de>

Author: ral
Date: 2009-06-06 18:45:47 +0200 (Sat, 06 Jun 2009)
New Revision: 1710

Modified:
   trunk/doc/reference/images/Makefile.am
   trunk/src/gui/MainMenu.cc
Log:
Trunk 1.1:
- update credits
- fix r1649: refman had been broken for targets "install","dist" generally
    and "pdf" on older pdflatex based systems
Note:
- refman makefile fix is partially a quick hack
- this commit marks milestone 4 of Enigma 1.10


Modified: trunk/doc/reference/images/Makefile.am
===================================================================
--- trunk/doc/reference/images/Makefile.am	2009-06-06 14:59:49 UTC (rev 1709)
+++ trunk/doc/reference/images/Makefile.am	2009-06-06 16:45:47 UTC (rev 1710)
@@ -1,5 +1,5 @@
 
-PNG = $(wildcard $(srcdir)/*.png)
+PNG = first_level.png
 
 GFXDIR = ../../../data/gfx48
 
@@ -153,14 +153,20 @@
 # PDFLIST is deprecated (on elder systems pdflatex needs pdf images)
 PDFLIST = $(addsuffix .pdf, $(basename $(PNGLIST)))
 
+pngdir = @datadir@/doc/enigma/reference/images
+png_DATA = $(PNG) $(PNGLIST)
+
 .SUFFIXES = .png
 
-all: $(PNGLIST) $(PDFLIST)
+all: $(PNGLIST) $(PDFLIST) first_level.pdf
 
 clean:
 	$(RM) $(PNGLIST)
 	$(RM) $(PDFLIST)
+	$(RM) first_level.pdf
 
+first_level.pdf: first_level.png
+	convert -density 112x112 $< $@
 
 %.png: $(GFXDIR)/%.png
 	convert -density 112x112 -units PixelsPerCentimeter -crop 48x48+0+0 $< $@
@@ -168,4 +174,4 @@
 %.pdf: $(GFXDIR)/%.png
 	convert -density 112x112 -units PixelsPerCentimeter -crop 48x48+0+0 $< $@
 
-EXTRA_DIST = $(PNG) $(PNGLIST)
+EXTRA_DIST = $(PNG)

Modified: trunk/src/gui/MainMenu.cc
===================================================================
--- trunk/src/gui/MainMenu.cc	2009-06-06 14:59:49 UTC (rev 1709)
+++ trunk/src/gui/MainMenu.cc	2009-06-06 16:45:47 UTC (rev 1710)
@@ -104,7 +104,7 @@
 
     /* -------------------- Main menu -------------------- */
     static const char *credit_text[] = {
-        N_("Main developers of the 1.0 release:"),
+        N_("Main developers of the 1.10 release:"),
         N_("  RONALD LAMPRECHT (lead)"),
         "  RAOUL BOURQUIN",
         "  ANDREAS LOCHMANN",
@@ -159,6 +159,7 @@
         "  Guy Busser  (Level design)",
         "  Richi B?tzer  (Level design)",
         "  Capkoh  (Level design)",
+        "  Manfredi Carta  (Level design)",
         "  Christoph & Anita  (Level design)",
         "  ?????? ?????? - Serge Dremuk  (Russian translation)",
         "  Joseph Dunne  (Level design)",
@@ -170,11 +171,11 @@
         "  Roberto Garc?a (Spanish translation)",
         "  Andy Geldmacher  (Level design)",
         "  Edwin Groothuis  (FreeBSD port)",
+        0,
         "  Immanuel Herrmann  (Level design)",
+        "  Brian Huffman  (Level design)",
+        "  Johannes H?sing  (Level design)",
         "  M?t? Lehel Juh?sz  (Hungarian translation)",
-        0,
-        "  Johannes H?sing  (Level design)",
-        "  Brian Huffman  (Level design)",
         "  Samuele Kaplun  (Italian translation)",
         "  Jens-Christian Korth  (Level design)",
         "  Manuel K?nig  (Level design, bug reports)",



From ral at mail.berlios.de  Sat Jun  6 23:12:21 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sat, 6 Jun 2009 23:12:21 +0200
Subject: [Enigma-game-svn] r1711 - homepage/input
Message-ID: <200906062112.n56LCLCZ000477@sheep.berlios.de>

Author: ral
Date: 2009-06-06 23:12:14 +0200 (Sat, 06 Jun 2009)
New Revision: 1711

Modified:
   homepage/input/stat-other.html
   homepage/input/table-hcp.html
   homepage/input/table-rat.html
   homepage/input/table-solved.html
   homepage/input/table-wr.html
   homepage/input/userlist.html
Log:
Homepage:
- statistics May 2009


Modified: homepage/input/stat-other.html
===================================================================
--- homepage/input/stat-other.html	2009-06-06 16:45:47 UTC (rev 1710)
+++ homepage/input/stat-other.html	2009-06-06 21:12:14 UTC (rev 1711)
@@ -1,22 +1,22 @@
   <div class="stat-help">
     <h3>$$Other_Statistics$$</h3>
     <h4>$$Scores$$</h4>
-      92298 $$single_level_scores$$.
+      94074 $$single_level_scores$$.
     <h4>$$Ratings$$</h4>
-      17711 $$single_level_ratings$$ 4.93 $$and_distribution$$: 
+      17777 $$single_level_ratings$$ 4.93 $$and_distribution$$: 
       <table>
         <colgroup><col width="80"><col width="80"></colgroup>
         <tr><th>$$rating$$</th><th>$$count$$</th></tr>
-        <tr><td class="num">0</td><td class="num">115</td></tr>
-        <tr><td class="num">1</td><td class="num">319</td></tr>
-        <tr><td class="num">2</td><td class="num">915</td></tr>
-        <tr><td class="num">3</td><td class="num">2441</td></tr>
-        <tr><td class="num">4</td><td class="num">3381</td></tr>
-        <tr><td class="num">5</td><td class="num">4233</td></tr>
-        <tr><td class="num">6</td><td class="num">2998</td></tr>
-        <tr><td class="num">7</td><td class="num">2017</td></tr>
-        <tr><td class="num">8</td><td class="num">795</td></tr>
-        <tr><td class="num">9</td><td class="num">328</td></tr>
+        <tr><td class="num">0</td><td class="num">118</td></tr>
+        <tr><td class="num">1</td><td class="num">320</td></tr>
+        <tr><td class="num">2</td><td class="num">917</td></tr>
+        <tr><td class="num">3</td><td class="num">2451</td></tr>
+        <tr><td class="num">4</td><td class="num">3390</td></tr>
+        <tr><td class="num">5</td><td class="num">4246</td></tr>
+        <tr><td class="num">6</td><td class="num">3017</td></tr>
+        <tr><td class="num">7</td><td class="num">2023</td></tr>
+        <tr><td class="num">8</td><td class="num">796</td></tr>
+        <tr><td class="num">9</td><td class="num">330</td></tr>
         <tr><td class="num">10</td><td class="num">169</td></tr>
       </table>
   </div>

Modified: homepage/input/table-hcp.html
===================================================================
--- homepage/input/table-hcp.html	2009-06-06 16:45:47 UTC (rev 1710)
+++ homepage/input/table-hcp.html	2009-06-06 21:12:14 UTC (rev 1711)
@@ -1,180 +1,183 @@
   <table>
-    <caption>$$Handicap_Statistics$$ $$April$$ 2009</caption>
+    <caption>$$Handicap_Statistics$$ $$May$$ 2009</caption>
     <colgroup><col width="130"><col width="220"></colgroup>
     <tr><th>$$solved_hcp$$</th><th class="left">$$user$$</th></tr>
-     <tr><td class="num">-153.1</td><td class="left">'Moneymaker'</td></tr>
-     <tr><td class="num">-105.2</td><td class="left">'daydreamer'</td></tr>
-     <tr><td class="num"> -76.1</td><td class="left">'Stupid'</td></tr>
-     <tr><td class="num"> -75.8</td><td class="left">'Johannes'</td></tr>
-     <tr><td class="num"> -65.9</td><td class="left">'Mentist'</td></tr>
-     <tr><td class="num"> -64.9</td><td class="left">'Great Scott'</td></tr>
-     <tr><td class="num"> -64.7</td><td class="left">'dev0'</td></tr>
-     <tr><td class="num"> -56.7</td><td class="left">'Crystalicum'</td></tr>
-     <tr><td class="num"> -55.2</td><td class="left">'Daisy'</td></tr>
-     <tr><td class="num"> -55.1</td><td class="left">'Duffy'</td></tr>
-     <tr><td class="num"> -53.4</td><td class="left">'Malla'</td></tr>
-     <tr><td class="num"> -50.1</td><td class="left">'ryujun'</td></tr>
-     <tr><td class="num"> -45.3</td><td class="left">'Alexandros'</td></tr>
-     <tr><td class="num"> -42.8</td><td class="left">'Django'</td></tr>
-     <tr><td class="num"> -40.6</td><td class="left">'Gloop'</td></tr>
-     <tr><td class="num"> -33.3</td><td class="left">'Taztunes'</td></tr>
-     <tr><td class="num"> -31.7</td><td class="left">'Angolino'</td></tr>
-     <tr><td class="num"> -31.2</td><td class="left">'Safalra'</td></tr>
-     <tr><td class="num"> -30.9</td><td class="left">'Emmanuel'</td></tr>
-     <tr><td class="num"> -28.6</td><td class="left">'Ludmian'</td></tr>
-     <tr><td class="num"> -25.9</td><td class="left">'B-Huff'</td></tr>
-     <tr><td class="num"> -24.2</td><td class="left">'dpl'</td></tr>
-     <tr><td class="num"> -23.3</td><td class="left">'Zekobah'</td></tr>
-     <tr><td class="num"> -22.4</td><td class="left">'bojster'</td></tr>
-     <tr><td class="num"> -22.1</td><td class="left">'Ghatotkacha'</td></tr>
-     <tr><td class="num"> -19.4</td><td class="left">'ged'</td></tr>
-     <tr><td class="num"> -19.0</td><td class="left">'Medimaster'</td></tr>
-     <tr><td class="num"> -17.8</td><td class="left">'hendrik'</td></tr>
-     <tr><td class="num"> -16.6</td><td class="left">'ABS'</td></tr>
-     <tr><td class="num"> -15.8</td><td class="left">'Raoul'</td></tr>
-     <tr><td class="num"> -12.8</td><td class="left">'Ronald'</td></tr>
-     <tr><td class="num"> -12.8</td><td class="left">'Dime'</td></tr>
-     <tr><td class="num">  -8.0</td><td class="left">'Lukas'</td></tr>
-     <tr><td class="num">  -7.3</td><td class="left">'HuB34'</td></tr>
-     <tr><td class="num">  -4.1</td><td class="left">'Iceshark7'</td></tr>
-     <tr><td class="num">  -3.9</td><td class="left">'Timo'</td></tr>
-     <tr><td class="num">  -3.6</td><td class="left">'joseba'</td></tr>
-     <tr><td class="num">  -0.1</td><td class="left">'Daniel'</td></tr>
-     <tr><td class="num">   0.7</td><td class="left">'fabian'</td></tr>
-     <tr><td class="num">   1.3</td><td class="left">'U-Punkt'</td></tr>
-     <tr><td class="num">   1.4</td><td class="left">'mecke'</td></tr>
-     <tr><td class="num">   1.5</td><td class="left">'Hairball'</td></tr>
-     <tr><td class="num">   2.3</td><td class="left">'Craven'</td></tr>
-     <tr><td class="num">   2.4</td><td class="left">'Wuzzy'</td></tr>
-     <tr><td class="num">   2.4</td><td class="left">'JuSt'</td></tr>
-     <tr><td class="num">   3.1</td><td class="left">'Freshman'</td></tr>
+     <tr><td class="num">-153.8</td><td class="left">'Moneymaker'</td></tr>
+     <tr><td class="num">-107.5</td><td class="left">'daydreamer'</td></tr>
+     <tr><td class="num">-105.9</td><td class="left">'Medimaster'</td></tr>
+     <tr><td class="num"> -75.3</td><td class="left">'Stupid'</td></tr>
+     <tr><td class="num"> -74.7</td><td class="left">'Johannes'</td></tr>
+     <tr><td class="num"> -67.0</td><td class="left">'Mentist'</td></tr>
+     <tr><td class="num"> -63.8</td><td class="left">'dev0'</td></tr>
+     <tr><td class="num"> -63.4</td><td class="left">'Great Scott'</td></tr>
+     <tr><td class="num"> -58.7</td><td class="left">'Daisy'</td></tr>
+     <tr><td class="num"> -54.8</td><td class="left">'Crystalicum'</td></tr>
+     <tr><td class="num"> -54.0</td><td class="left">'Duffy'</td></tr>
+     <tr><td class="num"> -52.7</td><td class="left">'Malla'</td></tr>
+     <tr><td class="num"> -49.4</td><td class="left">'ryujun'</td></tr>
+     <tr><td class="num"> -44.2</td><td class="left">'Alexandros'</td></tr>
+     <tr><td class="num"> -42.0</td><td class="left">'Django'</td></tr>
+     <tr><td class="num"> -39.6</td><td class="left">'Gloop'</td></tr>
+     <tr><td class="num"> -32.6</td><td class="left">'Taztunes'</td></tr>
+     <tr><td class="num"> -30.5</td><td class="left">'Safalra'</td></tr>
+     <tr><td class="num"> -30.2</td><td class="left">'Angolino'</td></tr>
+     <tr><td class="num"> -29.6</td><td class="left">'Emmanuel'</td></tr>
+     <tr><td class="num"> -27.7</td><td class="left">'Ludmian'</td></tr>
+     <tr><td class="num"> -24.9</td><td class="left">'B-Huff'</td></tr>
+     <tr><td class="num"> -23.5</td><td class="left">'dpl'</td></tr>
+     <tr><td class="num"> -22.1</td><td class="left">'Zekobah'</td></tr>
+     <tr><td class="num"> -21.6</td><td class="left">'bojster'</td></tr>
+     <tr><td class="num"> -21.0</td><td class="left">'Ghatotkacha'</td></tr>
+     <tr><td class="num"> -17.9</td><td class="left">'ged'</td></tr>
+     <tr><td class="num"> -16.5</td><td class="left">'hendrik'</td></tr>
+     <tr><td class="num"> -15.7</td><td class="left">'Raoul'</td></tr>
+     <tr><td class="num"> -15.7</td><td class="left">'ABS'</td></tr>
+     <tr><td class="num"> -12.9</td><td class="left">'Ronald'</td></tr>
+     <tr><td class="num"> -12.3</td><td class="left">'Dime'</td></tr>
+     <tr><td class="num">  -7.5</td><td class="left">'Lukas'</td></tr>
+     <tr><td class="num">  -6.7</td><td class="left">'HuB34'</td></tr>
+     <tr><td class="num">  -3.4</td><td class="left">'Timo'</td></tr>
+     <tr><td class="num">  -3.2</td><td class="left">'Iceshark7'</td></tr>
+     <tr><td class="num">  -2.4</td><td class="left">'joseba'</td></tr>
+     <tr><td class="num">  -0.3</td><td class="left">'mecke'</td></tr>
+     <tr><td class="num">   0.8</td><td class="left">'Daniel'</td></tr>
+     <tr><td class="num">   1.3</td><td class="left">'fabian'</td></tr>
+     <tr><td class="num">   1.7</td><td class="left">'U-Punkt'</td></tr>
+     <tr><td class="num">   2.2</td><td class="left">'Hairball'</td></tr>
+     <tr><td class="num">   2.6</td><td class="left">'Craven'</td></tr>
+     <tr><td class="num">   2.6</td><td class="left">'JuSt'</td></tr>
+     <tr><td class="num">   3.2</td><td class="left">'Wuzzy'</td></tr>
+     <tr><td class="num">   3.5</td><td class="left">'Freshman'</td></tr>
      <tr><td class="num">   3.7</td><td class="left">'Kevin'</td></tr>
-     <tr><td class="num">   3.9</td><td class="left">'mrduke'</td></tr>
-     <tr><td class="num">   4.8</td><td class="left">'Tiza'</td></tr>
-     <tr><td class="num">   4.9</td><td class="left">'para_doks'</td></tr>
-     <tr><td class="num">   5.3</td><td class="left">'Tobias'</td></tr>
-     <tr><td class="num">   5.7</td><td class="left">'Another'</td></tr>
-     <tr><td class="num">   6.4</td><td class="left">'Guglielmo'</td></tr>
-     <tr><td class="num">   6.5</td><td class="left">'alfred69'</td></tr>
-     <tr><td class="num">   7.2</td><td class="left">'Sigma'</td></tr>
-     <tr><td class="num">   7.4</td><td class="left">'serpent'</td></tr>
-     <tr><td class="num">   7.6</td><td class="left">'Andy'</td></tr>
-     <tr><td class="num">   9.7</td><td class="left">'Austin'</td></tr>
-     <tr><td class="num">  10.4</td><td class="left">'H-J.Epting'</td></tr>
-     <tr><td class="num">  11.2</td><td class="left">'shoki'</td></tr>
-     <tr><td class="num">  13.1</td><td class="left">'oxyd4ever'</td></tr>
-     <tr><td class="num">  13.7</td><td class="left">'ShadowPhrogg32642342'</td></tr>
-     <tr><td class="num">  15.9</td><td class="left">'Mark P.'</td></tr>
-     <tr><td class="num">  16.0</td><td class="left">'Andreas'</td></tr>
-     <tr><td class="num">  16.9</td><td class="left">'AlephD'</td></tr>
-     <tr><td class="num">  17.1</td><td class="left">'Chocolate Zero'</td></tr>
-     <tr><td class="num">  17.1</td><td class="left">'Sim_Ed'</td></tr>
-     <tr><td class="num">  17.5</td><td class="left">'Agnieszka'</td></tr>
-     <tr><td class="num">  20.4</td><td class="left">'ais523'</td></tr>
-     <tr><td class="num">  21.3</td><td class="left">'Ale'</td></tr>
-     <tr><td class="num">  21.7</td><td class="left">'Alex'</td></tr>
-     <tr><td class="num">  23.9</td><td class="left">'Antonio EE'</td></tr>
-     <tr><td class="num">  24.2</td><td class="left">'Klaus'</td></tr>
-     <tr><td class="num">  24.3</td><td class="left">'Jinajon'</td></tr>
-     <tr><td class="num">  24.7</td><td class="left">'Marc-Hendrik'</td></tr>
-     <tr><td class="num">  25.1</td><td class="left">'Chris'</td></tr>
-     <tr><td class="num">  25.7</td><td class="left">'Thomas'</td></tr>
-     <tr><td class="num">  26.1</td><td class="left">'Feynman'</td></tr>
-     <tr><td class="num">  26.4</td><td class="left">'hdwow'</td></tr>
-     <tr><td class="num">  26.9</td><td class="left">'Gottseinsohn'</td></tr>
-     <tr><td class="num">  27.2</td><td class="left">'Bent'</td></tr>
-     <tr><td class="num">  27.7</td><td class="left">'Hans-HD'</td></tr>
-     <tr><td class="num">  28.8</td><td class="left">'un_guru'</td></tr>
-     <tr><td class="num">  29.1</td><td class="left">'Little_Mole'</td></tr>
-     <tr><td class="num">  29.4</td><td class="left">'J3FF'</td></tr>
-     <tr><td class="num">  30.5</td><td class="left">'biotopa'</td></tr>
-     <tr><td class="num">  30.5</td><td class="left">'Vinksu'</td></tr>
-     <tr><td class="num">  30.5</td><td class="left">'GiannuzzITA'</td></tr>
-     <tr><td class="num">  30.8</td><td class="left">'oblo'</td></tr>
-     <tr><td class="num">  31.4</td><td class="left">'redsantz'</td></tr>
-     <tr><td class="num">  32.1</td><td class="left">'geembo_90'</td></tr>
-     <tr><td class="num">  32.5</td><td class="left">'Edgar_Flesk'</td></tr>
-     <tr><td class="num">  32.8</td><td class="left">'Melanie'</td></tr>
-     <tr><td class="num">  33.3</td><td class="left">'NorthForty'</td></tr>
-     <tr><td class="num">  33.3</td><td class="left">'IChrisI'</td></tr>
-     <tr><td class="num">  33.6</td><td class="left">'erich'</td></tr>
-     <tr><td class="num">  33.7</td><td class="left">'Gorn'</td></tr>
-     <tr><td class="num">  36.4</td><td class="left">'niebie'</td></tr>
-     <tr><td class="num">  36.4</td><td class="left">'MicWa'</td></tr>
-     <tr><td class="num">  36.7</td><td class="left">'WP319'</td></tr>
-     <tr><td class="num">  37.0</td><td class="left">'Kosby'</td></tr>
-     <tr><td class="num">  37.9</td><td class="left">'alain'</td></tr>
-     <tr><td class="num">  38.5</td><td class="left">'Liam Sheehan'</td></tr>
-     <tr><td class="num">  39.0</td><td class="left">'Rugby4ever'</td></tr>
-     <tr><td class="num">  39.9</td><td class="left">'WesleyCrusher'</td></tr>
-     <tr><td class="num">  40.1</td><td class="left">'Drotten'</td></tr>
-     <tr><td class="num">  40.3</td><td class="left">'Archcorenth'</td></tr>
-     <tr><td class="num">  40.5</td><td class="left">'Harry Lim'</td></tr>
-     <tr><td class="num">  41.0</td><td class="left">'B-man'</td></tr>
-     <tr><td class="num">  41.2</td><td class="left">'Nfol'</td></tr>
-     <tr><td class="num">  42.1</td><td class="left">'Tiger'</td></tr>
-     <tr><td class="num">  42.4</td><td class="left">'gringer'</td></tr>
-     <tr><td class="num">  42.9</td><td class="left">'Vlad'</td></tr>
-     <tr><td class="num">  42.9</td><td class="left">'Snaily'</td></tr>
-     <tr><td class="num">  44.0</td><td class="left">'Momcat'</td></tr>
-     <tr><td class="num">  44.8</td><td class="left">'Breezy'</td></tr>
-     <tr><td class="num">  45.1</td><td class="left">'Uli'</td></tr>
-     <tr><td class="num">  46.4</td><td class="left">'Tarim'</td></tr>
-     <tr><td class="num">  47.1</td><td class="left">'IntKecsk'</td></tr>
-     <tr><td class="num">  47.3</td><td class="left">'Jonyzz'</td></tr>
-     <tr><td class="num">  47.4</td><td class="left">'tjRaven'</td></tr>
-     <tr><td class="num">  48.3</td><td class="left">'Valkyrie2'</td></tr>
-     <tr><td class="num">  48.5</td><td class="left">'ntaeijr'</td></tr>
-     <tr><td class="num">  48.5</td><td class="left">'mhatta'</td></tr>
-     <tr><td class="num">  50.4</td><td class="left">'Zak'</td></tr>
-     <tr><td class="num">  50.5</td><td class="left">'Tomson'</td></tr>
-     <tr><td class="num">  50.6</td><td class="left">'rima'</td></tr>
-     <tr><td class="num">  51.0</td><td class="left">'Sandra'</td></tr>
-     <tr><td class="num">  51.0</td><td class="left">'Mecki'</td></tr>
-     <tr><td class="num">  51.1</td><td class="left">'brynn'</td></tr>
-     <tr><td class="num">  51.8</td><td class="left">'jdcampo'</td></tr>
-     <tr><td class="num">  52.0</td><td class="left">'ReasonAnce'</td></tr>
-     <tr><td class="num">  52.1</td><td class="left">'Jeffrey S'</td></tr>
-     <tr><td class="num">  53.1</td><td class="left">'Slav'</td></tr>
+     <tr><td class="num">   4.3</td><td class="left">'mrduke'</td></tr>
+     <tr><td class="num">   5.3</td><td class="left">'para_doks'</td></tr>
+     <tr><td class="num">   5.5</td><td class="left">'Tiza'</td></tr>
+     <tr><td class="num">   5.7</td><td class="left">'Tobias'</td></tr>
+     <tr><td class="num">   6.2</td><td class="left">'Another'</td></tr>
+     <tr><td class="num">   6.8</td><td class="left">'alfred69'</td></tr>
+     <tr><td class="num">   7.0</td><td class="left">'Guglielmo'</td></tr>
+     <tr><td class="num">   8.0</td><td class="left">'Sigma'</td></tr>
+     <tr><td class="num">   8.1</td><td class="left">'serpent'</td></tr>
+     <tr><td class="num">   8.2</td><td class="left">'Andy'</td></tr>
+     <tr><td class="num">  10.2</td><td class="left">'H-J.Epting'</td></tr>
+     <tr><td class="num">  10.4</td><td class="left">'Austin'</td></tr>
+     <tr><td class="num">  11.6</td><td class="left">'shoki'</td></tr>
+     <tr><td class="num">  13.6</td><td class="left">'oxyd4ever'</td></tr>
+     <tr><td class="num">  14.2</td><td class="left">'ShadowPhrogg32642342'</td></tr>
+     <tr><td class="num">  16.4</td><td class="left">'Mark P.'</td></tr>
+     <tr><td class="num">  16.5</td><td class="left">'Andreas'</td></tr>
+     <tr><td class="num">  17.2</td><td class="left">'AlephD'</td></tr>
+     <tr><td class="num">  17.5</td><td class="left">'Sim_Ed'</td></tr>
+     <tr><td class="num">  18.1</td><td class="left">'Chocolate Zero'</td></tr>
+     <tr><td class="num">  18.1</td><td class="left">'Agnieszka'</td></tr>
+     <tr><td class="num">  18.9</td><td class="left">'casmith_789'</td></tr>
+     <tr><td class="num">  19.7</td><td class="left">'ais523'</td></tr>
+     <tr><td class="num">  21.6</td><td class="left">'Ale'</td></tr>
+     <tr><td class="num">  21.9</td><td class="left">'Alex'</td></tr>
+     <tr><td class="num">  24.3</td><td class="left">'Antonio EE'</td></tr>
+     <tr><td class="num">  24.5</td><td class="left">'Klaus'</td></tr>
+     <tr><td class="num">  24.7</td><td class="left">'Jinajon'</td></tr>
+     <tr><td class="num">  25.1</td><td class="left">'Marc-Hendrik'</td></tr>
+     <tr><td class="num">  25.8</td><td class="left">'Chris'</td></tr>
+     <tr><td class="num">  26.1</td><td class="left">'Thomas'</td></tr>
+     <tr><td class="num">  26.4</td><td class="left">'Feynman'</td></tr>
+     <tr><td class="num">  26.9</td><td class="left">'hdwow'</td></tr>
+     <tr><td class="num">  27.1</td><td class="left">'Gottseinsohn'</td></tr>
+     <tr><td class="num">  28.0</td><td class="left">'Bent'</td></tr>
+     <tr><td class="num">  28.1</td><td class="left">'Hans-HD'</td></tr>
+     <tr><td class="num">  29.0</td><td class="left">'un_guru'</td></tr>
+     <tr><td class="num">  29.4</td><td class="left">'Little_Mole'</td></tr>
+     <tr><td class="num">  29.9</td><td class="left">'J3FF'</td></tr>
+     <tr><td class="num">  30.7</td><td class="left">'biotopa'</td></tr>
+     <tr><td class="num">  30.8</td><td class="left">'Vinksu'</td></tr>
+     <tr><td class="num">  31.2</td><td class="left">'oblo'</td></tr>
+     <tr><td class="num">  31.2</td><td class="left">'GiannuzzITA'</td></tr>
+     <tr><td class="num">  31.2</td><td class="left">'evane'</td></tr>
+     <tr><td class="num">  31.7</td><td class="left">'redsantz'</td></tr>
+     <tr><td class="num">  32.9</td><td class="left">'geembo_90'</td></tr>
+     <tr><td class="num">  33.0</td><td class="left">'Edgar_Flesk'</td></tr>
+     <tr><td class="num">  33.1</td><td class="left">'Melanie'</td></tr>
+     <tr><td class="num">  33.4</td><td class="left">'NorthForty'</td></tr>
+     <tr><td class="num">  33.7</td><td class="left">'IChrisI'</td></tr>
+     <tr><td class="num">  33.9</td><td class="left">'erich'</td></tr>
+     <tr><td class="num">  34.0</td><td class="left">'Gorn'</td></tr>
+     <tr><td class="num">  36.8</td><td class="left">'niebie'</td></tr>
+     <tr><td class="num">  36.8</td><td class="left">'MicWa'</td></tr>
+     <tr><td class="num">  36.9</td><td class="left">'WP319'</td></tr>
+     <tr><td class="num">  37.3</td><td class="left">'Kosby'</td></tr>
+     <tr><td class="num">  38.1</td><td class="left">'alain'</td></tr>
+     <tr><td class="num">  39.0</td><td class="left">'Liam Sheehan'</td></tr>
+     <tr><td class="num">  39.5</td><td class="left">'Rugby4ever'</td></tr>
+     <tr><td class="num">  40.4</td><td class="left">'WesleyCrusher'</td></tr>
+     <tr><td class="num">  40.5</td><td class="left">'Drotten'</td></tr>
+     <tr><td class="num">  40.8</td><td class="left">'Archcorenth'</td></tr>
+     <tr><td class="num">  40.9</td><td class="left">'Harry Lim'</td></tr>
+     <tr><td class="num">  41.4</td><td class="left">'B-man'</td></tr>
+     <tr><td class="num">  41.8</td><td class="left">'Nfol'</td></tr>
+     <tr><td class="num">  42.6</td><td class="left">'Tiger'</td></tr>
+     <tr><td class="num">  42.7</td><td class="left">'gringer'</td></tr>
+     <tr><td class="num">  43.2</td><td class="left">'Vlad'</td></tr>
+     <tr><td class="num">  43.4</td><td class="left">'Snaily'</td></tr>
+     <tr><td class="num">  44.3</td><td class="left">'Momcat'</td></tr>
+     <tr><td class="num">  45.0</td><td class="left">'Breezy'</td></tr>
+     <tr><td class="num">  45.6</td><td class="left">'Uli'</td></tr>
+     <tr><td class="num">  46.5</td><td class="left">'Tarim'</td></tr>
+     <tr><td class="num">  47.5</td><td class="left">'IntKecsk'</td></tr>
+     <tr><td class="num">  47.9</td><td class="left">'tjRaven'</td></tr>
+     <tr><td class="num">  47.9</td><td class="left">'Jonyzz'</td></tr>
+     <tr><td class="num">  48.4</td><td class="left">'Valkyrie2'</td></tr>
+     <tr><td class="num">  48.7</td><td class="left">'mhatta'</td></tr>
+     <tr><td class="num">  48.9</td><td class="left">'ntaeijr'</td></tr>
+     <tr><td class="num">  50.8</td><td class="left">'Zak'</td></tr>
+     <tr><td class="num">  50.9</td><td class="left">'rima'</td></tr>
+     <tr><td class="num">  51.0</td><td class="left">'Tomson'</td></tr>
+     <tr><td class="num">  51.1</td><td class="left">'Mecki'</td></tr>
+     <tr><td class="num">  51.3</td><td class="left">'brynn'</td></tr>
+     <tr><td class="num">  51.3</td><td class="left">'Sandra'</td></tr>
+     <tr><td class="num">  51.4</td><td class="left">'Jeffrey S'</td></tr>
+     <tr><td class="num">  52.1</td><td class="left">'jdcampo'</td></tr>
+     <tr><td class="num">  52.5</td><td class="left">'ReasonAnce'</td></tr>
      <tr><td class="num">  53.1</td><td class="left">'AkRa'</td></tr>
-     <tr><td class="num">  53.3</td><td class="left">'Vaily'</td></tr>
-     <tr><td class="num">  53.4</td><td class="left">'Pascal'</td></tr>
-     <tr><td class="num">  54.3</td><td class="left">'Cyphase'</td></tr>
-     <tr><td class="num">  54.4</td><td class="left">'Turbogurk'</td></tr>
-     <tr><td class="num">  54.6</td><td class="left">'Neophilus'</td></tr>
-     <tr><td class="num">  56.6</td><td class="left">'krazy62'</td></tr>
-     <tr><td class="num">  57.6</td><td class="left">'Adonica'</td></tr>
-     <tr><td class="num">  58.1</td><td class="left">'Kadu'</td></tr>
-     <tr><td class="num">  59.9</td><td class="left">'Enrymather'</td></tr>
-     <tr><td class="num">  60.6</td><td class="left">'Sopoforic'</td></tr>
-     <tr><td class="num">  61.4</td><td class="left">'jumbo'</td></tr>
-     <tr><td class="num">  62.0</td><td class="left">'jdrexler'</td></tr>
-     <tr><td class="num">  62.7</td><td class="left">'Asbel'</td></tr>
-     <tr><td class="num">  64.5</td><td class="left">'tasker'</td></tr>
-     <tr><td class="num">  64.8</td><td class="left">'Meeve'</td></tr>
-     <tr><td class="num">  66.8</td><td class="left">'ael'</td></tr>
-     <tr><td class="num">  67.5</td><td class="left">'Samuel'</td></tr>
-     <tr><td class="num">  67.6</td><td class="left">'schmusi20'</td></tr>
-     <tr><td class="num">  67.7</td><td class="left">'Fred_the_wise'</td></tr>
-     <tr><td class="num">  67.7</td><td class="left">'Sparkey'</td></tr>
-     <tr><td class="num">  68.1</td><td class="left">'Alf'</td></tr>
-     <tr><td class="num">  69.8</td><td class="left">'Magnus and Susi'</td></tr>
-     <tr><td class="num">  70.4</td><td class="left">'Zhura'</td></tr>
-     <tr><td class="num">  71.1</td><td class="left">'xmouse'</td></tr>
-     <tr><td class="num">  72.6</td><td class="left">'AQZ'</td></tr>
-     <tr><td class="num">  72.6</td><td class="left">'Joona'</td></tr>
-     <tr><td class="num">  74.2</td><td class="left">'crypto_rsa'</td></tr>
-     <tr><td class="num">  74.5</td><td class="left">'Dvorhagen'</td></tr>
-     <tr><td class="num">  75.3</td><td class="left">'Eselchen'</td></tr>
-     <tr><td class="num">  75.4</td><td class="left">'Nicol?s'</td></tr>
-     <tr><td class="num">  75.6</td><td class="left">'jojo'</td></tr>
-     <tr><td class="num">  75.6</td><td class="left">'AsuCaga'</td></tr>
-     <tr><td class="num">  79.0</td><td class="left">'colonel crayon'</td></tr>
-     <tr><td class="num">  79.7</td><td class="left">'Kroetchen'</td></tr>
-     <tr><td class="num">  80.5</td><td class="left">'Agares'</td></tr>
-     <tr><td class="num">  81.7</td><td class="left">'IIkka'</td></tr>
-     <tr><td class="num">  85.4</td><td class="left">'Miel56'</td></tr>
+     <tr><td class="num">  53.8</td><td class="left">'Slav'</td></tr>
+     <tr><td class="num">  53.8</td><td class="left">'Pascal'</td></tr>
+     <tr><td class="num">  53.8</td><td class="left">'Vaily'</td></tr>
+     <tr><td class="num">  54.7</td><td class="left">'Cyphase'</td></tr>
+     <tr><td class="num">  55.1</td><td class="left">'Turbogurk'</td></tr>
+     <tr><td class="num">  55.1</td><td class="left">'Neophilus'</td></tr>
+     <tr><td class="num">  56.9</td><td class="left">'krazy62'</td></tr>
+     <tr><td class="num">  58.1</td><td class="left">'Adonica'</td></tr>
+     <tr><td class="num">  58.5</td><td class="left">'Kadu'</td></tr>
+     <tr><td class="num">  60.0</td><td class="left">'Enrymather'</td></tr>
+     <tr><td class="num">  61.3</td><td class="left">'Sopoforic'</td></tr>
+     <tr><td class="num">  61.7</td><td class="left">'jumbo'</td></tr>
+     <tr><td class="num">  62.4</td><td class="left">'jdrexler'</td></tr>
+     <tr><td class="num">  63.1</td><td class="left">'Asbel'</td></tr>
+     <tr><td class="num">  64.8</td><td class="left">'tasker'</td></tr>
+     <tr><td class="num">  65.1</td><td class="left">'Meeve'</td></tr>
+     <tr><td class="num">  67.1</td><td class="left">'ael'</td></tr>
+     <tr><td class="num">  67.7</td><td class="left">'Samuel'</td></tr>
+     <tr><td class="num">  67.9</td><td class="left">'Sparkey'</td></tr>
+     <tr><td class="num">  68.0</td><td class="left">'schmusi20'</td></tr>
+     <tr><td class="num">  68.0</td><td class="left">'Fred_the_wise'</td></tr>
+     <tr><td class="num">  68.2</td><td class="left">'Alf'</td></tr>
+     <tr><td class="num">  70.0</td><td class="left">'Magnus and Susi'</td></tr>
+     <tr><td class="num">  70.7</td><td class="left">'Zhura'</td></tr>
+     <tr><td class="num">  71.5</td><td class="left">'xmouse'</td></tr>
+     <tr><td class="num">  72.8</td><td class="left">'Joona'</td></tr>
+     <tr><td class="num">  72.9</td><td class="left">'AQZ'</td></tr>
+     <tr><td class="num">  74.4</td><td class="left">'crypto_rsa'</td></tr>
+     <tr><td class="num">  74.7</td><td class="left">'Dvorhagen'</td></tr>
+     <tr><td class="num">  75.5</td><td class="left">'Eselchen'</td></tr>
+     <tr><td class="num">  75.7</td><td class="left">'Nicol?s'</td></tr>
+     <tr><td class="num">  75.8</td><td class="left">'AsuCaga'</td></tr>
+     <tr><td class="num">  75.9</td><td class="left">'jojo'</td></tr>
+     <tr><td class="num">  79.1</td><td class="left">'colonel crayon'</td></tr>
+     <tr><td class="num">  79.8</td><td class="left">'Kroetchen'</td></tr>
+     <tr><td class="num">  80.6</td><td class="left">'Agares'</td></tr>
+     <tr><td class="num">  81.9</td><td class="left">'IIkka'</td></tr>
+     <tr><td class="num">  85.6</td><td class="left">'Miel56'</td></tr>
      <tr><td class="num">  90.2</td><td class="left">'The red O'</td></tr>
-     <tr><td class="num">  90.5</td><td class="left">'Sequoyah'</td></tr>
-     <tr><td class="num">  92.4</td><td class="left">'Michael'</td></tr>
+     <tr><td class="num">  90.6</td><td class="left">'Sequoyah'</td></tr>
+     <tr><td class="num">  90.9</td><td class="left">'Jan'</td></tr>
+     <tr><td class="num">  92.5</td><td class="left">'Michael'</td></tr>
   </table>

Modified: homepage/input/table-rat.html
===================================================================
--- homepage/input/table-rat.html	2009-06-06 16:45:47 UTC (rev 1710)
+++ homepage/input/table-rat.html	2009-06-06 21:12:14 UTC (rev 1711)
@@ -1,5 +1,5 @@
   <table>
-    <caption>$$Rating_Statistics$$ $$April$$ 2009</caption>
+    <caption>$$Rating_Statistics$$ $$May$$ 2009</caption>
     <colgroup><col width="80"><col width="80"><col width="220"></colgroup>
     <tr><th>$$count$$</th><th>$$average$$</th><th class="left">$$user$$</th></tr>    <tr><td class="num">1062</td><td class="num"> 5.06</td><td class="left">'ryujun'</td></tr>
     <tr><td class="num">1056</td><td class="num"> 4.83</td><td class="left">'Taztunes'</td></tr>
@@ -8,15 +8,15 @@
     <tr><td class="num">899</td><td class="num"> 4.80</td><td class="left">'daydreamer'</td></tr>
     <tr><td class="num">871</td><td class="num"> 5.09</td><td class="left">'Stupid'</td></tr>
     <tr><td class="num">653</td><td class="num"> 5.01</td><td class="left">'Duffy'</td></tr>
-    <tr><td class="num">643</td><td class="num"> 4.79</td><td class="left">'U-Punkt'</td></tr>
+    <tr><td class="num">647</td><td class="num"> 4.79</td><td class="left">'U-Punkt'</td></tr>
     <tr><td class="num">631</td><td class="num"> 4.99</td><td class="left">'Moneymaker'</td></tr>
     <tr><td class="num">622</td><td class="num"> 4.22</td><td class="left">'shoki'</td></tr>
-    <tr><td class="num">581</td><td class="num"> 5.33</td><td class="left">'Mentist'</td></tr>
+    <tr><td class="num">604</td><td class="num"> 5.31</td><td class="left">'Mentist'</td></tr>
     <tr><td class="num">573</td><td class="num"> 5.16</td><td class="left">'dpl'</td></tr>
     <tr><td class="num">562</td><td class="num"> 4.48</td><td class="left">'Alexandros'</td></tr>
     <tr><td class="num">534</td><td class="num"> 4.97</td><td class="left">'B-Huff'</td></tr>
+    <tr><td class="num">511</td><td class="num"> 5.05</td><td class="left">'Ronald'</td></tr>
     <tr><td class="num">511</td><td class="num"> 5.30</td><td class="left">'Lukas'</td></tr>
-    <tr><td class="num">505</td><td class="num"> 5.05</td><td class="left">'Ronald'</td></tr>
     <tr><td class="num">482</td><td class="num"> 4.04</td><td class="left">'Vinksu'</td></tr>
     <tr><td class="num">448</td><td class="num"> 5.08</td><td class="left">'Johannes'</td></tr>
     <tr><td class="num">439</td><td class="num"> 4.98</td><td class="left">'Tiza'</td></tr>
@@ -30,13 +30,13 @@
     <tr><td class="num">187</td><td class="num"> 5.05</td><td class="left">'WP319'</td></tr>
     <tr><td class="num">178</td><td class="num"> 4.41</td><td class="left">'Jonyzz'</td></tr>
     <tr><td class="num">135</td><td class="num"> 4.13</td><td class="left">'Edgar_Flesk'</td></tr>
-    <tr><td class="num">132</td><td class="num"> 5.65</td><td class="left">'Raoul'</td></tr>
+    <tr><td class="num">129</td><td class="num"> 5.64</td><td class="left">'Raoul'</td></tr>
     <tr><td class="num">126</td><td class="num"> 5.79</td><td class="left">'Ghatotkacha'</td></tr>
     <tr><td class="num">124</td><td class="num"> 4.44</td><td class="left">'Sigma'</td></tr>
+    <tr><td class="num">104</td><td class="num"> 4.20</td><td class="left">'Medimaster'</td></tr>
     <tr><td class="num">100</td><td class="num"> 5.08</td><td class="left">'Angolino'</td></tr>
     <tr><td class="num"> 97</td><td class="num"> 4.16</td><td class="left">'Safalra'</td></tr>
     <tr><td class="num"> 91</td><td class="num"> 4.41</td><td class="left">'Zhura'</td></tr>
-    <tr><td class="num"> 87</td><td class="num"> 3.98</td><td class="left">'Medimaster'</td></tr>
     <tr><td class="num"> 85</td><td class="num"> 4.76</td><td class="left">'para_doks'</td></tr>
     <tr><td class="num"> 75</td><td class="num"> 4.52</td><td class="left">'Kroetchen'</td></tr>
     <tr><td class="num"> 72</td><td class="num"> 5.63</td><td class="left">'Wuzzy'</td></tr>
@@ -57,16 +57,16 @@
     <tr><td class="num"> 31</td><td class="num"> 7.61</td><td class="left">'AkRa'</td></tr>
     <tr><td class="num"> 30</td><td class="num"> 4.40</td><td class="left">'Archcorenth'</td></tr>
     <tr><td class="num"> 30</td><td class="num"> 6.93</td><td class="left">'un_guru'</td></tr>
+    <tr><td class="num"> 27</td><td class="num"> 5.33</td><td class="left">'Jeffrey S'</td></tr>
     <tr><td class="num"> 25</td><td class="num"> 4.88</td><td class="left">'Drotten'</td></tr>
     <tr><td class="num"> 19</td><td class="num"> 3.74</td><td class="left">'Eselchen'</td></tr>
     <tr><td class="num"> 18</td><td class="num"> 4.22</td><td class="left">'Mecki'</td></tr>
-    <tr><td class="num"> 17</td><td class="num"> 5.53</td><td class="left">'Jeffrey S'</td></tr>
     <tr><td class="num"> 16</td><td class="num"> 3.25</td><td class="left">'tasker'</td></tr>
     <tr><td class="num"> 13</td><td class="num"> 5.23</td><td class="left">'Samuel'</td></tr>
     <tr><td class="num"> 13</td><td class="num"> 8.15</td><td class="left">'Ludmian'</td></tr>
     <tr><td class="num"> 11</td><td class="num"> 6.36</td><td class="left">'ShadowPhrogg32642342'</td></tr>
     <tr><td class="num"> 10</td><td class="num"> 7.80</td><td class="left">'hdwow'</td></tr>
-    <tr><td class="num">  9</td><td class="num"> 5.11</td><td class="left">'ais523'</td></tr>
+    <tr><td class="num"> 10</td><td class="num"> 4.90</td><td class="left">'ais523'</td></tr>
     <tr><td class="num">  8</td><td class="num"> 3.25</td><td class="left">'Vlad'</td></tr>
     <tr><td class="num">  8</td><td class="num"> 7.63</td><td class="left">'Antonio EE'</td></tr>
     <tr><td class="num">  7</td><td class="num"> 4.29</td><td class="left">'Snaily'</td></tr>
@@ -74,9 +74,11 @@
     <tr><td class="num">  5</td><td class="num"> 6.80</td><td class="left">'Breezy'</td></tr>
     <tr><td class="num">  5</td><td class="num"> 9.20</td><td class="left">'HuB34'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 6.75</td><td class="left">'Agares'</td></tr>
+    <tr><td class="num">  4</td><td class="num"> 2.00</td><td class="left">'casmith_789'</td></tr>
     <tr><td class="num">  4</td><td class="num">10.00</td><td class="left">'Kevin'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 5.75</td><td class="left">'joseba'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 5.75</td><td class="left">'Emmanuel'</td></tr>
+    <tr><td class="num">  4</td><td class="num"> 7.75</td><td class="left">'evane'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 1.00</td><td class="left">'Hans-HD'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 6.50</td><td class="left">'serpent'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 7.00</td><td class="left">'redsantz'</td></tr>

Modified: homepage/input/table-solved.html
===================================================================
--- homepage/input/table-solved.html	2009-06-06 16:45:47 UTC (rev 1710)
+++ homepage/input/table-solved.html	2009-06-06 21:12:14 UTC (rev 1711)
@@ -1,15 +1,15 @@
   <table>
-    <caption>$$Solved_Level_Statistics$$ $$April$$ 2009</caption>
+    <caption>$$Solved_Level_Statistics$$ $$May$$ 2009</caption>
     <colgroup><col width="130"><col width="130"><col width="130"><col width="240"></colgroup>
     <tr><th>$$difficult$$</th><th>$$easy$$</th><th>$$total$$</th><th class="left">$$user$$</th></tr>
     <tr><td class="num">1045/1045</td><td class="num">189/189</td><td class="num">100.00%</td><td class="left">'ryujun'</td></tr>
     <tr><td class="num">1043/1045</td><td class="num">189/189</td><td class="num"> 99.84%</td><td class="left">'Taztunes'</td></tr>
     <tr><td class="num">1039/1045</td><td class="num">189/189</td><td class="num"> 99.51%</td><td class="left">'dev0'</td></tr>
     <tr><td class="num">1035/1045</td><td class="num">183/189</td><td class="num"> 98.70%</td><td class="left">'Dime'</td></tr>
+    <tr><td class="num">1027/1045</td><td class="num">189/189</td><td class="num"> 98.54%</td><td class="left">'Ronald'</td></tr>
     <tr><td class="num">1029/1045</td><td class="num">186/189</td><td class="num"> 98.46%</td><td class="left">'daydreamer'</td></tr>
     <tr><td class="num">1034/1045</td><td class="num">181/189</td><td class="num"> 98.46%</td><td class="left">'Moneymaker'</td></tr>
     <tr><td class="num">1029/1045</td><td class="num">185/189</td><td class="num"> 98.38%</td><td class="left">'Freshman'</td></tr>
-    <tr><td class="num">1025/1045</td><td class="num">189/189</td><td class="num"> 98.38%</td><td class="left">'Ronald'</td></tr>
     <tr><td class="num">1029/1045</td><td class="num">183/189</td><td class="num"> 98.22%</td><td class="left">'Craven'</td></tr>
     <tr><td class="num">1026/1045</td><td class="num">185/189</td><td class="num"> 98.14%</td><td class="left">'Ale'</td></tr>
     <tr><td class="num">1021/1045</td><td class="num">177/189</td><td class="num"> 97.08%</td><td class="left">'Malla'</td></tr>
@@ -19,8 +19,8 @@
     <tr><td class="num"> 970/1045</td><td class="num">166/189</td><td class="num"> 92.06%</td><td class="left">'Andy'</td></tr>
     <tr><td class="num"> 962/1045</td><td class="num">173/189</td><td class="num"> 91.98%</td><td class="left">'mecke'</td></tr>
     <tr><td class="num"> 949/1045</td><td class="num">170/189</td><td class="num"> 90.68%</td><td class="left">'para_doks'</td></tr>
-    <tr><td class="num"> 938/1045</td><td class="num">160/189</td><td class="num"> 88.98%</td><td class="left">'H-J.Epting'</td></tr>
-    <tr><td class="num"> 926/1045</td><td class="num">160/189</td><td class="num"> 88.01%</td><td class="left">'Mentist'</td></tr>
+    <tr><td class="num"> 942/1045</td><td class="num">160/189</td><td class="num"> 89.30%</td><td class="left">'H-J.Epting'</td></tr>
+    <tr><td class="num"> 937/1045</td><td class="num">162/189</td><td class="num"> 89.06%</td><td class="left">'Mentist'</td></tr>
     <tr><td class="num"> 922/1045</td><td class="num">154/189</td><td class="num"> 87.20%</td><td class="left">'mrduke'</td></tr>
     <tr><td class="num"> 933/1045</td><td class="num">125/189</td><td class="num"> 85.74%</td><td class="left">'Alex'</td></tr>
     <tr><td class="num"> 914/1045</td><td class="num">135/189</td><td class="num"> 85.01%</td><td class="left">'JuSt'</td></tr>
@@ -33,13 +33,14 @@
     <tr><td class="num"> 846/1045</td><td class="num">144/189</td><td class="num"> 80.23%</td><td class="left">'Gorn'</td></tr>
     <tr><td class="num"> 854/1045</td><td class="num">131/189</td><td class="num"> 79.82%</td><td class="left">'shoki'</td></tr>
     <tr><td class="num"> 874/1045</td><td class="num">103/189</td><td class="num"> 79.17%</td><td class="left">'Melanie'</td></tr>
+    <tr><td class="num"> 896/1045</td><td class="num"> 54/189</td><td class="num"> 76.99%</td><td class="left">'evane'</td></tr>
     <tr><td class="num"> 950/1045</td><td class="num">  0/189</td><td class="num"> 76.99%</td><td class="left">'Tarim'</td></tr>
     <tr><td class="num"> 804/1045</td><td class="num">142/189</td><td class="num"> 76.66%</td><td class="left">'Safalra'</td></tr>
     <tr><td class="num"> 800/1045</td><td class="num">135/189</td><td class="num"> 75.77%</td><td class="left">'dpl'</td></tr>
     <tr><td class="num"> 802/1045</td><td class="num">129/189</td><td class="num"> 75.45%</td><td class="left">'Ludmian'</td></tr>
     <tr><td class="num"> 812/1045</td><td class="num">114/189</td><td class="num"> 75.04%</td><td class="left">'brynn'</td></tr>
     <tr><td class="num"> 782/1045</td><td class="num">132/189</td><td class="num"> 74.07%</td><td class="left">'AlephD'</td></tr>
-    <tr><td class="num"> 779/1045</td><td class="num">121/189</td><td class="num"> 72.93%</td><td class="left">'U-Punkt'</td></tr>
+    <tr><td class="num"> 781/1045</td><td class="num">123/189</td><td class="num"> 73.26%</td><td class="left">'U-Punkt'</td></tr>
     <tr><td class="num"> 739/1045</td><td class="num">131/189</td><td class="num"> 70.50%</td><td class="left">'ABS'</td></tr>
     <tr><td class="num"> 728/1045</td><td class="num">126/189</td><td class="num"> 69.21%</td><td class="left">'B-Huff'</td></tr>
     <tr><td class="num"> 734/1045</td><td class="num">108/189</td><td class="num"> 68.23%</td><td class="left">'Another'</td></tr>
@@ -48,13 +49,14 @@
     <tr><td class="num"> 734/1045</td><td class="num"> 82/189</td><td class="num"> 66.13%</td><td class="left">'bojster'</td></tr>
     <tr><td class="num"> 782/1045</td><td class="num"> 33/189</td><td class="num"> 66.05%</td><td class="left">'Sim_Ed'</td></tr>
     <tr><td class="num"> 680/1045</td><td class="num">130/189</td><td class="num"> 65.64%</td><td class="left">'Alexandros'</td></tr>
+    <tr><td class="num"> 651/1045</td><td class="num">111/189</td><td class="num"> 61.75%</td><td class="left">'Raoul'</td></tr>
     <tr><td class="num"> 650/1045</td><td class="num">110/189</td><td class="num"> 61.59%</td><td class="left">'Ghatotkacha'</td></tr>
     <tr><td class="num"> 681/1045</td><td class="num"> 78/189</td><td class="num"> 61.51%</td><td class="left">'HuB34'</td></tr>
     <tr><td class="num"> 659/1045</td><td class="num"> 95/189</td><td class="num"> 61.10%</td><td class="left">'Marc-Hendrik'</td></tr>
-    <tr><td class="num"> 633/1045</td><td class="num">111/189</td><td class="num"> 60.29%</td><td class="left">'Raoul'</td></tr>
     <tr><td class="num"> 665/1045</td><td class="num"> 64/189</td><td class="num"> 59.08%</td><td class="left">'alain'</td></tr>
     <tr><td class="num"> 643/1045</td><td class="num"> 83/189</td><td class="num"> 58.83%</td><td class="left">'Great Scott'</td></tr>
     <tr><td class="num"> 714/1045</td><td class="num">  0/189</td><td class="num"> 57.86%</td><td class="left">'Gottseinsohn'</td></tr>
+    <tr><td class="num"> 637/1045</td><td class="num"> 63/189</td><td class="num"> 56.73%</td><td class="left">'ais523'</td></tr>
     <tr><td class="num"> 604/1045</td><td class="num"> 94/189</td><td class="num"> 56.56%</td><td class="left">'Tiza'</td></tr>
     <tr><td class="num"> 620/1045</td><td class="num"> 72/189</td><td class="num"> 56.08%</td><td class="left">'Breezy'</td></tr>
     <tr><td class="num"> 636/1045</td><td class="num"> 55/189</td><td class="num"> 56.00%</td><td class="left">'fabian'</td></tr>
@@ -63,7 +65,6 @@
     <tr><td class="num"> 599/1045</td><td class="num"> 80/189</td><td class="num"> 55.02%</td><td class="left">'serpent'</td></tr>
     <tr><td class="num"> 577/1045</td><td class="num">100/189</td><td class="num"> 54.86%</td><td class="left">'Zekobah'</td></tr>
     <tr><td class="num"> 634/1045</td><td class="num"> 43/189</td><td class="num"> 54.86%</td><td class="left">'Klaus'</td></tr>
-    <tr><td class="num"> 611/1045</td><td class="num"> 59/189</td><td class="num"> 54.29%</td><td class="left">'ais523'</td></tr>
     <tr><td class="num"> 576/1045</td><td class="num"> 93/189</td><td class="num"> 54.21%</td><td class="left">'Guglielmo'</td></tr>
     <tr><td class="num"> 552/1045</td><td class="num">107/189</td><td class="num"> 53.40%</td><td class="left">'oxyd4ever'</td></tr>
     <tr><td class="num"> 525/1045</td><td class="num"> 95/189</td><td class="num"> 50.24%</td><td class="left">'ShadowPhrogg32642342'</td></tr>
@@ -90,12 +91,14 @@
     <tr><td class="num"> 440/1045</td><td class="num"> 50/189</td><td class="num"> 39.71%</td><td class="left">'ged'</td></tr>
     <tr><td class="num"> 369/1045</td><td class="num">112/189</td><td class="num"> 38.98%</td><td class="left">'Jinajon'</td></tr>
     <tr><td class="num"> 438/1045</td><td class="num">  3/189</td><td class="num"> 35.74%</td><td class="left">'oblo'</td></tr>
+    <tr><td class="num"> 375/1045</td><td class="num"> 66/189</td><td class="num"> 35.74%</td><td class="left">'Medimaster'</td></tr>
+    <tr><td class="num"> 396/1045</td><td class="num"> 43/189</td><td class="num"> 35.58%</td><td class="left">'Jeffrey S'</td></tr>
     <tr><td class="num"> 359/1045</td><td class="num"> 74/189</td><td class="num"> 35.09%</td><td class="left">'Crystalicum'</td></tr>
     <tr><td class="num"> 392/1045</td><td class="num"> 40/189</td><td class="num"> 35.01%</td><td class="left">'hendrik'</td></tr>
     <tr><td class="num"> 391/1045</td><td class="num"> 36/189</td><td class="num"> 34.60%</td><td class="left">'Iceshark7'</td></tr>
     <tr><td class="num"> 389/1045</td><td class="num"> 37/189</td><td class="num"> 34.52%</td><td class="left">'Mecki'</td></tr>
     <tr><td class="num"> 397/1045</td><td class="num"> 24/189</td><td class="num"> 34.12%</td><td class="left">'Chocolate Zero'</td></tr>
-    <tr><td class="num"> 376/1045</td><td class="num"> 35/189</td><td class="num"> 33.31%</td><td class="left">'Jeffrey S'</td></tr>
+    <tr><td class="num"> 358/1045</td><td class="num"> 53/189</td><td class="num"> 33.31%</td><td class="left">'casmith_789'</td></tr>
     <tr><td class="num"> 392/1045</td><td class="num"> 12/189</td><td class="num"> 32.74%</td><td class="left">'NorthForty'</td></tr>
     <tr><td class="num"> 344/1045</td><td class="num"> 51/189</td><td class="num"> 32.01%</td><td class="left">'Momcat'</td></tr>
     <tr><td class="num"> 382/1045</td><td class="num"> 10/189</td><td class="num"> 31.77%</td><td class="left">'J3FF'</td></tr>
@@ -139,7 +142,6 @@
     <tr><td class="num"> 163/1045</td><td class="num"> 10/189</td><td class="num"> 14.02%</td><td class="left">'tjRaven'</td></tr>
     <tr><td class="num"> 131/1045</td><td class="num"> 36/189</td><td class="num"> 13.53%</td><td class="left">'Enrymather'</td></tr>
     <tr><td class="num"> 164/1045</td><td class="num">  0/189</td><td class="num"> 13.29%</td><td class="left">'Bent'</td></tr>
-    <tr><td class="num"> 135/1045</td><td class="num"> 25/189</td><td class="num"> 12.97%</td><td class="left">'Medimaster'</td></tr>
     <tr><td class="num"> 124/1045</td><td class="num"> 33/189</td><td class="num"> 12.72%</td><td class="left">'joseba'</td></tr>
     <tr><td class="num"> 127/1045</td><td class="num"> 29/189</td><td class="num"> 12.64%</td><td class="left">'ael'</td></tr>
     <tr><td class="num"> 120/1045</td><td class="num"> 35/189</td><td class="num"> 12.56%</td><td class="left">'Kadu'</td></tr>
@@ -176,5 +178,6 @@
     <tr><td class="num">  39/1045</td><td class="num">  0/189</td><td class="num">  3.16%</td><td class="left">'Sequoyah'</td></tr>
     <tr><td class="num">  27/1045</td><td class="num">  5/189</td><td class="num">  2.59%</td><td class="left">'Miel56'</td></tr>
     <tr><td class="num">  23/1045</td><td class="num">  5/189</td><td class="num">  2.27%</td><td class="left">'The red O'</td></tr>
+    <tr><td class="num">  13/1045</td><td class="num"> 13/189</td><td class="num">  2.11%</td><td class="left">'Jan'</td></tr>
     <tr><td class="num">   7/1045</td><td class="num"> 12/189</td><td class="num">  1.54%</td><td class="left">'Michael'</td></tr>
   </table>

Modified: homepage/input/table-wr.html
===================================================================
--- homepage/input/table-wr.html	2009-06-06 16:45:47 UTC (rev 1710)
+++ homepage/input/table-wr.html	2009-06-06 21:12:14 UTC (rev 1711)
@@ -1,51 +1,49 @@
   <table>
-    <caption>$$Worldrecord_Statistics$$ $$April$$ 2009</caption>
+    <caption>$$Worldrecord_Statistics$$ $$May$$ 2009</caption>
     <colgroup><col width="80"><col width="80"><col width="470"></colgroup>
     <tr><th>$$total$$</th><th>$$shared$$</th><th class="left">$$user$$</th></tr>
-    <tr><td class="num">1054</td><td class="num">315</td><td class="left">'Moneymaker'</td></tr>
-    <tr><td class="num">199</td><td class="num">163</td><td class="left">'daydreamer'</td></tr>
-    <tr><td class="num">183</td><td class="num">174</td><td class="left">'Crystalicum'</td></tr>
-    <tr><td class="num">113</td><td class="num"> 77</td><td class="left">'Stupid'</td></tr>
-    <tr><td class="num"> 91</td><td class="num"> 85</td><td class="left">'Johannes'</td></tr>
-    <tr><td class="num"> 85</td><td class="num"> 76</td><td class="left">'dev0'</td></tr>
-    <tr><td class="num"> 79</td><td class="num"> 72</td><td class="left">'Mentist'</td></tr>
-    <tr><td class="num"> 48</td><td class="num"> 36</td><td class="left">'Medimaster'</td></tr>
-    <tr><td class="num"> 45</td><td class="num"> 41</td><td class="left">'Daisy'</td></tr>
-    <tr><td class="num"> 38</td><td class="num"> 33</td><td class="left">'Duffy'</td></tr>
-    <tr><td class="num"> 36</td><td class="num"> 35</td><td class="left">'Ghatotkacha'</td></tr>
-    <tr><td class="num"> 35</td><td class="num"> 26</td><td class="left">'Malla'</td></tr>
-    <tr><td class="num"> 34</td><td class="num"> 33</td><td class="left">'Angolino'</td></tr>
-    <tr><td class="num"> 32</td><td class="num"> 32</td><td class="left">'Great Scott'</td></tr>
-    <tr><td class="num"> 29</td><td class="num"> 27</td><td class="left">'Alexandros'</td></tr>
-    <tr><td class="num"> 28</td><td class="num"> 26</td><td class="left">'Zekobah'</td></tr>
-    <tr><td class="num"> 28</td><td class="num"> 27</td><td class="left">'Django'</td></tr>
-    <tr><td class="num"> 27</td><td class="num"> 27</td><td class="left">'Iceshark7' + 'ryujun'</td></tr>
-    <tr><td class="num"> 26</td><td class="num"> 26</td><td class="left">'joseba'</td></tr>
-    <tr><td class="num"> 19</td><td class="num"> 17</td><td class="left">'Emmanuel'</td></tr>
-    <tr><td class="num"> 17</td><td class="num"> 17</td><td class="left">'ged'</td></tr>
-    <tr><td class="num"> 15</td><td class="num"> 13</td><td class="left">'B-Huff'</td></tr>
-    <tr><td class="num"> 15</td><td class="num"> 15</td><td class="left">'Safalra' + 'Ludmian'</td></tr>
+    <tr><td class="num">990</td><td class="num">269</td><td class="left">'Moneymaker'</td></tr>
+    <tr><td class="num">253</td><td class="num">151</td><td class="left">'Medimaster'</td></tr>
+    <tr><td class="num">146</td><td class="num">122</td><td class="left">'daydreamer'</td></tr>
+    <tr><td class="num">136</td><td class="num">134</td><td class="left">'Crystalicum'</td></tr>
+    <tr><td class="num">104</td><td class="num"> 69</td><td class="left">'Stupid'</td></tr>
+    <tr><td class="num"> 78</td><td class="num"> 73</td><td class="left">'Johannes'</td></tr>
+    <tr><td class="num"> 72</td><td class="num"> 66</td><td class="left">'dev0'</td></tr>
+    <tr><td class="num"> 66</td><td class="num"> 65</td><td class="left">'Mentist'</td></tr>
+    <tr><td class="num"> 44</td><td class="num"> 39</td><td class="left">'Daisy'</td></tr>
+    <tr><td class="num"> 35</td><td class="num"> 30</td><td class="left">'Duffy'</td></tr>
+    <tr><td class="num"> 32</td><td class="num"> 23</td><td class="left">'Malla'</td></tr>
+    <tr><td class="num"> 32</td><td class="num"> 31</td><td class="left">'Ghatotkacha'</td></tr>
+    <tr><td class="num"> 26</td><td class="num"> 25</td><td class="left">'Angolino'</td></tr>
+    <tr><td class="num"> 25</td><td class="num"> 24</td><td class="left">'Django'</td></tr>
+    <tr><td class="num"> 25</td><td class="num"> 25</td><td class="left">'Great Scott'</td></tr>
+    <tr><td class="num"> 24</td><td class="num"> 22</td><td class="left">'Alexandros' + 'Zekobah'</td></tr>
+    <tr><td class="num"> 23</td><td class="num"> 23</td><td class="left">'Iceshark7' + 'ryujun'</td></tr>
+    <tr><td class="num"> 21</td><td class="num"> 21</td><td class="left">'joseba'</td></tr>
+    <tr><td class="num"> 16</td><td class="num"> 14</td><td class="left">'Emmanuel'</td></tr>
+    <tr><td class="num"> 16</td><td class="num"> 16</td><td class="left">'ged'</td></tr>
+    <tr><td class="num"> 14</td><td class="num"> 12</td><td class="left">'B-Huff'</td></tr>
+    <tr><td class="num"> 14</td><td class="num"> 14</td><td class="left">'Safalra'</td></tr>
+    <tr><td class="num"> 13</td><td class="num">  8</td><td class="left">'Ronald'</td></tr>
     <tr><td class="num"> 13</td><td class="num"> 12</td><td class="left">'HuB34'</td></tr>
-    <tr><td class="num"> 12</td><td class="num">  8</td><td class="left">'Ronald'</td></tr>
-    <tr><td class="num"> 12</td><td class="num"> 12</td><td class="left">'bojster'</td></tr>
-    <tr><td class="num"> 11</td><td class="num"> 10</td><td class="left">'Dime'</td></tr>
-    <tr><td class="num"> 10</td><td class="num"> 10</td><td class="left">'dpl'</td></tr>
-    <tr><td class="num">  9</td><td class="num">  6</td><td class="left">'ShadowPhrogg32642342'</td></tr>
+    <tr><td class="num"> 13</td><td class="num"> 13</td><td class="left">'Ludmian'</td></tr>
+    <tr><td class="num"> 10</td><td class="num"> 10</td><td class="left">'bojster' + 'casmith_789'</td></tr>
+    <tr><td class="num">  9</td><td class="num">  7</td><td class="left">'ShadowPhrogg32642342'</td></tr>
     <tr><td class="num">  9</td><td class="num">  8</td><td class="left">'Gloop'</td></tr>
-    <tr><td class="num">  9</td><td class="num">  9</td><td class="left">'fabian'</td></tr>
-    <tr><td class="num">  8</td><td class="num">  7</td><td class="left">'Chocolate Zero'</td></tr>
-    <tr><td class="num">  8</td><td class="num">  8</td><td class="left">'H-J.Epting' + 'ABS'</td></tr>
+    <tr><td class="num">  9</td><td class="num">  9</td><td class="left">'fabian' + 'dpl'</td></tr>
+    <tr><td class="num">  8</td><td class="num">  7</td><td class="left">'Chocolate Zero' + 'Dime'</td></tr>
+    <tr><td class="num">  8</td><td class="num">  8</td><td class="left">'H-J.Epting'</td></tr>
     <tr><td class="num">  7</td><td class="num">  6</td><td class="left">'Edgar_Flesk'</td></tr>
     <tr><td class="num">  6</td><td class="num">  5</td><td class="left">'Guglielmo'</td></tr>
-    <tr><td class="num">  6</td><td class="num">  6</td><td class="left">'Tobias'</td></tr>
+    <tr><td class="num">  6</td><td class="num">  6</td><td class="left">'ABS'</td></tr>
     <tr><td class="num">  5</td><td class="num">  3</td><td class="left">'Breezy'</td></tr>
     <tr><td class="num">  5</td><td class="num">  4</td><td class="left">'Another'</td></tr>
-    <tr><td class="num">  5</td><td class="num">  5</td><td class="left">'Taztunes' + 'Raoul' + 'Thomas' + 'mecke' + 'Chris' + 'Wuzzy' + 'Ralf'</td></tr>
-    <tr><td class="num">  4</td><td class="num">  4</td><td class="left">'Sigma' + 'U-Punkt' + 'J3FF' + 'Cyphase' + 'para_doks' + 'GiannuzzITA' + 'Lukas'</td></tr>
+    <tr><td class="num">  5</td><td class="num">  5</td><td class="left">'Raoul' + 'Thomas' + 'mecke' + 'Chris' + 'Tobias' + 'Wuzzy' + 'Ralf'</td></tr>
+    <tr><td class="num">  4</td><td class="num">  4</td><td class="left">'Taztunes' + 'U-Punkt' + 'J3FF' + 'para_doks' + 'GiannuzzITA' + 'Lukas'</td></tr>
     <tr><td class="num">  3</td><td class="num">  2</td><td class="left">'Hairball' + 'Stephanie'</td></tr>
-    <tr><td class="num">  3</td><td class="num">  3</td><td class="left">'geembo_90' + 'Tiza' + 'Neophilus' + 'Nicol?s' + 'Andy'</td></tr>
-    <tr><td class="num">  2</td><td class="num">  2</td><td class="left">'alfred69' + 'ReasonAnce' + 'mrduke' + 'Drotten' + 'tjRaven' + 'Sim_Ed' + 'hendrik' + 'Bent' + 'Austin' + 'Snaily' + 'Craven' + 'Sopoforic' + 'Ingo' + 'serpent'</td></tr>
+    <tr><td class="num">  3</td><td class="num">  3</td><td class="left">'Sigma' + 'Tiza' + 'Neophilus' + 'Nicol?s' + 'Cyphase' + 'Andy'</td></tr>
+    <tr><td class="num">  2</td><td class="num">  2</td><td class="left">'alfred69' + 'ReasonAnce' + 'mrduke' + 'geembo_90' + 'Drotten' + 'Sim_Ed' + 'hendrik' + 'Bent' + 'Austin' + 'Snaily' + 'Craven' + 'Sopoforic' + 'Ingo' + 'serpent'</td></tr>
     <tr><td class="num">  1</td><td class="num">  0</td><td class="left">'Feynman' + 'alain' + 'colonel crayon' + 'Gorn' + 'Nat'</td></tr>
-    <tr><td class="num">  1</td><td class="num">  1</td><td class="left">'Agares' + 'Tiger' + 'Zak' + 'Daniel' + 'Slav' + 'niebie' + 'Andreas' + 'AlephD' + 'Samuel' + 'Mark P.' + 'oblo' + 'Pascal' + 'hdwow' + 'B-man' + 'Asbel' + 'Vlad' + 'Jinajon' + 'Vaily' + 'Antonio EE' + 'JuSt' + 'Timo'</td></tr>
-    <tr><td class="num">  0</td><td class="num">  0</td><td class="left">'AQZ' + 'tasker' + 'jumbo' + 'Miel56' + 'Zhura' + 'Alf' + 'Turbogurk' + 'Gottseinsohn' + 'ntaeijr' + 'Eselchen' + 'ael' + 'biotopa' + 'Ale' + 'brynn' + 'IntKecsk' + 'Adonica' + 'Joona' + 'Sandra' + 'schmusi20' + 'Kosby' + 'Magnus and Susi' + 'WP319' + 'Kevin' + 'jdrexler' + 'xmouse' + 'erich' + 'Vinksu' + 'Uli' + 'Alex' + 'Valkyrie2' + 'Fred_the_wise' + 'jdcampo' + 'Freshman' + 'Little_Mole' + 'Kroetchen' + 'crypto_rsa' + 'Harry Lim' + 'Sequoyah' + 'AkRa' + 'Momcat' + 'Tomson' + 'NorthForty' + 'Mecki' + 'The red O' + 'gringer' + 'IIkka' + 'Jeffrey S' + 'Nfol' + 'Marc-Hendrik' + 'Kadu' + 'shoki' + 'Enrymather' + 'jojo' + 'WesleyCrusher' + 'rima' + 'Klaus' + 'MicWa' + 'AsuCaga' + 'oxyd4ever' + 'Jonyzz' + 'Rugby4ever' + 'Archcorenth' + 'Meeve' + 'mhatta' + 'Hans-HD' + 'un_guru' + 'krazy62' + 'Dvorhagen' + 'Sparkey' + 'ais523' + 'Holger' + 'Ingo_K' + 'Ant' + 'Melanie' + 'IChrisI' + 'redsantz' + 'Markus' + !
 'Michael' + 'Liam Sheehan' + 'Tarim' + 'Agnieszka'</td></tr>
+    <tr><td class="num">  1</td><td class="num">  1</td><td class="left">'Agares' + 'Tiger' + 'Zak' + 'Daniel' + 'Slav' + 'niebie' + 'Andreas' + 'AlephD' + 'Samuel' + 'tjRaven' + 'Mark P.' + 'oblo' + 'Pascal' + 'hdwow' + 'B-man' + 'Asbel' + 'Vlad' + 'Jinajon' + 'Vaily' + 'Antonio EE' + 'JuSt' + 'Timo'</td></tr>
+    <tr><td class="num">  0</td><td class="num">  0</td><td class="left">'AQZ' + 'tasker' + 'jumbo' + 'Miel56' + 'Zhura' + 'Alf' + 'Turbogurk' + 'Gottseinsohn' + 'ntaeijr' + 'Eselchen' + 'ael' + 'biotopa' + 'Ale' + 'brynn' + 'IntKecsk' + 'Adonica' + 'Joona' + 'Sandra' + 'schmusi20' + 'Kosby' + 'Magnus and Susi' + 'WP319' + 'Kevin' + 'jdrexler' + 'xmouse' + 'erich' + 'Vinksu' + 'Uli' + 'Alex' + 'Valkyrie2' + 'Fred_the_wise' + 'Jan' + 'jdcampo' + 'Freshman' + 'Little_Mole' + 'Kroetchen' + 'crypto_rsa' + 'Harry Lim' + 'Sequoyah' + 'AkRa' + 'Momcat' + 'Tomson' + 'NorthForty' + 'Mecki' + 'The red O' + 'gringer' + 'IIkka' + 'Jeffrey S' + 'Nfol' + 'Marc-Hendrik' + 'Kadu' + 'shoki' + 'Enrymather' + 'jojo' + 'WesleyCrusher' + 'evane' + 'rima' + 'Klaus' + 'MicWa' + 'AsuCaga' + 'oxyd4ever' + 'Jonyzz' + 'Rugby4ever' + 'Archcorenth' + 'Meeve' + 'mhatta' + 'Hans-HD' + 'un_guru' + 'krazy62' + 'Dvorhagen' + 'Sparkey' + 'ais523' + 'Holger' + 'Ingo_K' + 'Ant' + 'Melanie' + 'IChrisI' + 'redsa!
 ntz' + 'Markus' + 'Michael' + 'Liam Sheehan' + 'Tarim' + 'Agnieszka'</td></tr>
   </table>

Modified: homepage/input/userlist.html
===================================================================
--- homepage/input/userlist.html	2009-06-06 16:45:47 UTC (rev 1710)
+++ homepage/input/userlist.html	2009-06-06 21:12:14 UTC (rev 1711)
@@ -33,6 +33,7 @@
     <li>bojster</li>
     <li>Breezy</li>
     <li>brynn</li>
+    <li>casmith_789</li>
     <li>Chocolate Zero</li>
     <li>Chris</li>
     <li>colonel crayon</li>
@@ -55,6 +56,7 @@
     <li>Enrymather</li>
     <li>erich</li>
     <li>Eselchen</li>
+    <li>evane</li>
     <li>fabian</li>
     <li>Feynman</li>
     <li>Fred_the_wise</li>
@@ -84,6 +86,7 @@
     <li>Ingo_K</li>
     <li>IntKecsk</li>
     <li>J3FF</li>
+    <li>Jan</li>
     <li>jdcampo</li>
     <li>jdrexler</li>
     <li>Jeffrey S</li>



From raoul at mail.berlios.de  Sun Jun  7 00:35:37 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sun, 7 Jun 2009 00:35:37 +0200
Subject: [Enigma-game-svn] r1712 - in trunk/data/levels: enigma_cross
	enigma_viii
Message-ID: <200906062235.n56MZbSj009341@sheep.berlios.de>

Author: raoul
Date: 2009-06-07 00:35:36 +0200 (Sun, 07 Jun 2009)
New Revision: 1712

Modified:
   trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
   trunk/data/levels/enigma_viii/index.xml
   trunk/data/levels/enigma_viii/pulley18_1.xml
Log:
-> Fix position bug in "sunrise sunset"



Modified: trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-06-06 21:12:14 UTC (rev 1711)
+++ trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-06-06 22:35:36 UTC (rev 1712)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="53" title="Enigma 1.1 new"/>
+  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="54" title="Enigma 1.1 new"/>
 
   <attributes/>
 
@@ -173,7 +173,7 @@
     <level _seq="165" _title="The Sum Of Its Parts" _xpath="enigma_viii/luc36" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc362009" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="166" _title="Missing Oxyds?" _xpath="enigma_viii/manfi01_1" author="Manfredi Carta" ctrl="force" easy="true" id="manfi01" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="167" _title="Path Through Flood" _xpath="enigma_viii/pulley24_1" author="Mark Pulley" ctrl="force" easy="false" id="20080803pulley001" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="168" _title="Sunrise Sunset" _xpath="enigma_viii/pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="168" _title="Sunrise Sunset" _xpath="enigma_viii/pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="3" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: trunk/data/levels/enigma_viii/index.xml
===================================================================
--- trunk/data/levels/enigma_viii/index.xml	2009-06-06 21:12:14 UTC (rev 1711)
+++ trunk/data/levels/enigma_viii/index.xml	2009-06-06 22:35:36 UTC (rev 1712)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="48" title="Enigma VIII"/>
+  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="49" title="Enigma VIII"/>
 
   <attributes/>
 
@@ -99,7 +99,7 @@
     <level _seq="91" _title="The Sum Of Its Parts" _xpath="./luc36" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc362009" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="92" _title="Missing Oxyds?" _xpath="./manfi01_1" author="Manfredi Carta" ctrl="force" easy="true" id="manfi01" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="93" _title="Path Through Flood" _xpath="./pulley24_1" author="Mark Pulley" ctrl="force" easy="false" id="20080803pulley001" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="94" _title="Sunrise Sunset" _xpath="./pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="94" _title="Sunrise Sunset" _xpath="./pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="3" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: trunk/data/levels/enigma_viii/pulley18_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/pulley18_1.xml	2009-06-06 21:12:14 UTC (rev 1711)
+++ trunk/data/levels/enigma_viii/pulley18_1.xml	2009-06-06 22:35:36 UTC (rev 1712)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Sunrise Sunset" el:subtitle="" el:id="pulley18"/>
-      <el:version el:score="1" el:release="1" el:revision="2" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="3" el:status="released"/>
       <el:author  el:name="Mark Pulley" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2008 Mark Pulley</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -27,6 +27,10 @@
 ti["C"] = ti[" "] .. {"st_camouflage"}
 ti["G"] = ti["="] .. {"st_darkglass"}
 ti["V"] = ti["-"] .. {"st_boulder", orientation=SOUTH, name="Sun", _sunstate=0}
+ti["R"] = ti["-"] .. {"st_rotator_cw", name="rot_south#"}
+ti["r"] = ti["-"] .. {"st_rotator_ccw", name="rot_north#"}
+ti["Q"] = ti["="] .. {"st_rotator_cw", name="rot_south#"}
+ti["q"] = ti["="] .. {"st_rotator_ccw", name="rot_north#"}
 ti["D"] = ti["="] .. {"st_door", flavor="b", name="doors#"}
 ti["X"] = ti["="] .. {"st_door", flavor="a", name="door1"}
 ti["N"] = ti["="] .. {"st_switch", target="SetHemisphere", name="hemisphere#", _hemisphere=NORTH}
@@ -39,8 +43,8 @@
 ti["@"] = cond(wo["CreatingPreview"], ti["="], ti["="] .. {"#ac_marble_black"})
 
 wo(ti, " ", {
-    "----------------------------------------------------------",
-    "-----------------------------V----------------------------",
+    "-r------------------------------------------------------R-",
+    "R----------------------------V---------------------------r",
     "--######################################################--",
     "--#                                                    #--",
     "--#     CCCCCC            CCCCCC            CCCCCC     #--",
@@ -74,8 +78,8 @@
     "==G=OGGGGGGGGGGGGGGGG===G=G=GGGGG=G=G=G=OGGGGGGGGG=G=G=G==",
     "==G===================G===G=======G===G============G===G==",
     "==GGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGGG==",
-    "==========================================================",
-    "=========================================================="})
+    "q========================================================Q",
+    "=Q======================================================q="})
 
 wo:add({"ot_timer", name="timer", interval=0.1, target="draw_line", state=OFF})
 wo:shuffleOxyd()
@@ -124,12 +128,10 @@
 
 -- Split the maps into vertical 1-tile stripes
 local dayparts = {}
+local nightparts = {}
+
 for i=0, daymap.width do
     dayparts[i+1] = daymap:sub(po(i,0), po(i, daymap.height))
-end
-
-local nightparts = {}
-for i=0, nightmap.width do
     nightparts[i+1] = nightmap:sub(po(i,0), po(i, nightmap.height))
 end
 
@@ -138,12 +140,12 @@
     no["Sun"]:message("orientate", sender["_hemisphere"]-1)
     no["door1"]:open()
     if sender["_hemisphere"] == NORTH then
-        wo[po(1, 0) .. po(57, 1) .. po(0, 35) .. po(56, 36)] = {"st_rotator_ccw"}
+        wo[no["rot_south#*"]] = {"st_nil"}
         partsbeg = 1
         partsend = daymap.width
         partsinc = 1
     else
-        wo[po(1, 0) .. po(57, 1) .. po(0, 35) .. po(56, 36)] = {"st_rotator_cw"}
+        wo[no["rot_north#*"]] = {"st_nil"}
         partsbeg = daymap.width
         partsend = 1
         partsinc = -1



From raoul at mail.berlios.de  Mon Jun  8 02:37:33 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Mon, 8 Jun 2009 02:37:33 +0200
Subject: [Enigma-game-svn] r1714 - in trunk: . data/levels
	data/levels/enigma_cross data/levels/enigma_i
	data/levels/enigma_ii data/levels/enigma_iii
	data/levels/enigma_ix data/levels/enigma_tutorial
	data/levels/enigma_v data/levels/enigma_vi data/levels/enigma_viii
Message-ID: <200906080037.n580bXct018192@sheep.berlios.de>

Author: raoul
Date: 2009-06-08 02:37:30 +0200 (Mon, 08 Jun 2009)
New Revision: 1714

Added:
   trunk/data/levels/enigma_i/duffy07_2.xml
   trunk/data/levels/enigma_i/wb06_2.xml
   trunk/data/levels/enigma_ii/nat05_2.xml
   trunk/data/levels/enigma_ii/rb02_2.xml
   trunk/data/levels/enigma_iii/illmind07_2.xml
   trunk/data/levels/enigma_ix/
   trunk/data/levels/enigma_ix/Makefile.am
   trunk/data/levels/enigma_ix/index.xml
   trunk/data/levels/enigma_ix/welcometopack9_1.xml
   trunk/data/levels/enigma_v/martin58_2.xml
   trunk/data/levels/enigma_vi/ant39_2.xml
   trunk/data/levels/enigma_viii/devnull33_1.xml
Removed:
   trunk/data/levels/enigma_i/duffy07_1.xml
   trunk/data/levels/enigma_i/wb06_1.xml
   trunk/data/levels/enigma_ii/nat05_1.xml
   trunk/data/levels/enigma_ii/rb02_1.xml
   trunk/data/levels/enigma_iii/illmind07_1.xml
   trunk/data/levels/enigma_v/martin58_1.xml
   trunk/data/levels/enigma_vi/ant39_1.xml
Modified:
   trunk/configure.ac
   trunk/data/levels/Makefile.am
   trunk/data/levels/enigma_cross/enigma0_92_1.xml
   trunk/data/levels/enigma_cross/enigma0_92_2.xml
   trunk/data/levels/enigma_cross/newlevels.xml
   trunk/data/levels/enigma_cross/newlevels_1.0.1.xml
   trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
   trunk/data/levels/enigma_i/index.xml
   trunk/data/levels/enigma_ii/index.xml
   trunk/data/levels/enigma_ii/pento05_1.xml
   trunk/data/levels/enigma_iii/index.xml
   trunk/data/levels/enigma_tutorial/index.xml
   trunk/data/levels/enigma_v/index.xml
   trunk/data/levels/enigma_vi/index.xml
   trunk/data/levels/enigma_viii/index.xml
Log:
-> More rewrites mostly from /dev/null
-> Levelpack Enigma IX



Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/configure.ac	2009-06-08 00:37:30 UTC (rev 1714)
@@ -369,6 +369,7 @@
            data/levels/enigma_vi/Makefile
            data/levels/enigma_vii/Makefile
            data/levels/enigma_viii/Makefile
+           data/levels/enigma_ix/Makefile
            data/levels/enigma_cross/Makefile
            data/levels/enigma_esprit/Makefile
            data/levels/enigma_oxyd/Makefile

Modified: trunk/data/levels/Makefile.am
===================================================================
--- trunk/data/levels/Makefile.am	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/Makefile.am	2009-06-08 00:37:30 UTC (rev 1714)
@@ -1,5 +1,5 @@
 SUBDIRS = enigma_tutorial enigma_i enigma_ii enigma_iii enigma_iv enigma_v \
-	enigma_vi enigma_vii enigma_viii \
+	enigma_vi enigma_vii enigma_viii enigma_ix \
 	enigma_esprit enigma_oxyd enigma_peroxyd enigma_oxydmagnum enigma_oxydextra \
 	enigma_sokoban enigma_microban enigma_mas_microban \
 	enigma_pentomino_i \

Modified: trunk/data/levels/enigma_cross/enigma0_92_1.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -16,7 +16,7 @@
     <level _seq="8" _title="Light Switches" _xpath="enigma_i/martin08_2" author="Martin Hawlisch" ctrl="force" easy="true" id="martin08" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="9" _title="Floppy Swapping" _xpath="enigma_ii/martin19_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin19" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="10" _title="- Meditation -" _xpath="enigma_i/siegfried33_2" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation1" rel="2" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="11" _title="Push Them In" _xpath="enigma_ii/nat05_1" author="Andreas Persenius, Nat Pryce" ctrl="force" easy="false" id="nat5" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="11" _title="Push Them In" _xpath="enigma_ii/nat05_2" author="Andreas Persenius, Nat Pryce" ctrl="force" easy="false" id="nat5" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="12" _title="It's Magic" _xpath="enigma_ii/martin27_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin27" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="13" _title="Ice Skating" _xpath="enigma_i/siegfried22_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7a" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="14" _title="Lasers 101" _xpath="enigma_i/daniel08_2" author="Daniel Heck" ctrl="force" easy="false" id="lasers101" rel="2" rev="1" score="1" target="time" unit="duration"/>
@@ -89,7 +89,7 @@
     <level _seq="81" _title="Flood Gates" _xpath="enigma_iv/nat08_2" author="Nat Pryce" ctrl="force" easy="false" id="nat8" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="82" _title="Balancing Act" _xpath="enigma_i/nat09_2" author="Nat Pryce" ctrl="force" easy="false" id="nat9" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="83" _title="Automaton Magic" _xpath="enigma_ii/ant07_1" author="Petr Machata" ctrl="force" easy="false" id="ant07" rel="1" rev="6" score="1" target="time" unit="duration"/>
-    <level _seq="84" _title="Sheet Of Ice" _xpath="enigma_v/martin58_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin58" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="84" _title="Sheet Of Ice" _xpath="enigma_v/martin58_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin58" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="85" _title="No Trespassing" _xpath="enigma_peroxyd/peroxydlink65_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7c" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="86" _title=".J.U.M.P." _xpath="enigma_i/martin60_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin60" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="87" _title="Walk The Plank" _xpath="enigma_v/nat04_1" author="Nat Pryce" ctrl="force" easy="false" id="nat4" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -125,7 +125,7 @@
     <level _seq="117" _title="Islands" _xpath="enigma_i/duffy10_3" author="Jacob Scott" ctrl="force" easy="false" id="duffy10" rel="3" rev="3" score="2" target="time" unit="duration"/>
     <level _seq="118" _title="Space Walk" _xpath="enigma_iii/nat35_2" author="Nat Pryce" ctrl="force" easy="false" id="natmaze4" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="119" _title="- Meditation -" _xpath="enigma_i/siegfried36_2" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation15" rel="2" rev="3" score="1" target="time" unit="duration"/>
-    <level _seq="120" _title="Jump!" _xpath="enigma_i/duffy07_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy7" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="120" _title="Jump!" _xpath="enigma_i/duffy07_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy7" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="121" _title="Checkerboard" _xpath="enigma_iii/duffy08_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy8" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="122" _title="Circularity" _xpath="enigma_iv/ant10_1" author="Petr Machata" ctrl="force" easy="false" id="ant10" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="123" _title="Just Moving Blocks?" _xpath="enigma_iv/duffy05_2" author="Jacob Scott" ctrl="force" easy="true" id="duffy5" rel="2" rev="4" score="2" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/enigma0_92_2.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_2.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_cross/enigma0_92_2.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -163,7 +163,7 @@
     <level _seq="155" _title="Annoying little balls" _xpath="enigma_i/wb09_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb9" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="156" _title="Bridge Builders" _xpath="enigma_iii/wb04_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb4" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="157" _title="Easy Skyscraper" _xpath="enigma_iii/wb07_1" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb7" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="158" _title="Spiral Race" _xpath="enigma_i/wb06_1" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb6" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="158" _title="Spiral Race" _xpath="enigma_i/wb06_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb6" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="159" _title="Block its way!" _xpath="enigma_iii/wb05_2" author="Jon 'WB' Sneyers" ctrl="force" easy="true" id="wb5" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="160" _title="Little Puzzles" _xpath="enigma_iv/wb11_1" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb11" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="161" _title="- Meditation -" _xpath="enigma_ii/wb10_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb10" rel="2" rev="1" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_cross/newlevels.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -36,7 +36,7 @@
     <level _seq="28" _title="Growing Boxes" _xpath="enigma_ii/luc26_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc26" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="29" _title="Enigmastermind" _xpath="enigma_ii/alain16_1" author="Alain Busser" ctrl="force" easy="false" id="alain16" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="30" _title="Guitar" _xpath="enigma_ii/guy01_1" author="Guy Busser" ctrl="force" easy="false" id="guy01" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="31" _title="Koosnab" _xpath="enigma_ii/rb02_1" author="Roberto Bardin" ctrl="force" easy="false" id="rb02" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="31" _title="Koosnab" _xpath="enigma_ii/rb02_2" author="Roberto Bardin" ctrl="force" easy="false" id="rb02" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="32" _title="More Black Holes" _xpath="enigma_ii/luc18_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc18" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="33" _title="Robin's Wood" _xpath="enigma_ii/andreas13_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas13" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="34" _title="Road to Eden" _xpath="enigma_ii/alain22_1" author="Alain Busser" ctrl="force" easy="false" id="alain22" rel="1" rev="2" score="1" target="time" unit="duration"/>
@@ -63,7 +63,7 @@
     <level _seq="55" _title="The Ditch" _xpath="enigma_iii/richi01_2" author="Richi B?tzer" ctrl="force" easy="false" id="richi01" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="56" _title="Set Me Free" _xpath="enigma_iii/illmind06_2" author="illmind" ctrl="force" easy="false" id="illmind06" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="57" _title="Danger Slide" _xpath="enigma_iii/luc15_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc15" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="58" _title="White Contrast" _xpath="enigma_iii/illmind07_1" author="illmind" ctrl="force" easy="false" id="illmind07" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="58" _title="White Contrast" _xpath="enigma_iii/illmind07_2" author="illmind" ctrl="force" easy="false" id="illmind07" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="59" _title="Manamana" _xpath="enigma_iii/just07_1" author="JuSt" ctrl="force" easy="false" id="just07" rel="1" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="60" _title="Bad Flowers" _xpath="enigma_iii/nat30_2" author="Nat Pryce" ctrl="force" easy="true" id="nat30" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="61" _title="Don't Touch" _xpath="enigma_iii/raoul07_3" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul07" rel="3" rev="3" score="3" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels_1.0.1.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.0.1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_cross/newlevels_1.0.1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -28,7 +28,7 @@
     <level _seq="20" _title="Cold Meditation" _xpath="enigma_vii/ral18_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20070314ral728" rel="1" rev="67" score="1" target="time" unit="duration"/>
     <level _seq="21" _title="Same task ..." _xpath="enigma_vi/raoul29_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul29" rel="1" rev="11" score="1" target="time" unit="duration"/>
     <level _seq="22" _title="Industrial Puzzles" _xpath="enigma_vi/raoul30_2" author="Raoul Bourquin" ctrl="force" easy="false" id="raoul30" rel="2" rev="7" score="2" target="time" unit="duration"/>
-    <level _seq="23" _title="Odyssey" _xpath="enigma_vi/ant39_1" author="Petr Machata" ctrl="force" easy="false" id="ant39" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="23" _title="Odyssey" _xpath="enigma_vi/ant39_2" author="Petr Machata" ctrl="force" easy="false" id="ant39" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="24" _title="Tandem Chess" _xpath="enigma_vi/luc34_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc342007" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="25" _title="Magic Trinity" _xpath="enigma_vi/duffy146_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy146" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="26" _title="Rotor Guards" _xpath="enigma_vi/duffy144_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy144" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -174,6 +174,7 @@
     <level _seq="166" _title="Missing Oxyds?" _xpath="enigma_viii/manfi01_1" author="Manfredi Carta" ctrl="force" easy="true" id="manfi01" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="167" _title="Path Through Flood" _xpath="enigma_viii/pulley24_1" author="Mark Pulley" ctrl="force" easy="false" id="20080803pulley001" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="168" _title="Sunrise Sunset" _xpath="enigma_viii/pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="169" _title="Filler" _xpath="enigma_viii/devnull33_1" author="/dev/null" ctrl="force" easy="false" id="devnull33" rel="1" rev="3" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Deleted: trunk/data/levels/enigma_i/duffy07_1.xml
===================================================================
--- trunk/data/levels/enigma_i/duffy07_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_i/duffy07_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -1,143 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Jump!" el:subtitle="" el:id="duffy7"/>
-      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
-      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-rooms_wide=3
-rooms_high=3
-
-levelw=1+(19*rooms_wide)
-levelh=1+(12*rooms_high)
-
-create_world(levelw, levelh)
-
-draw_border("st-brownie")
-fill_floor("fl-hay")
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-        if c =="#" then
-            abyss(i-1,line)
-        elseif c == "o" then
-            oxyd( i-1, line)
-        elseif c == "s" then
-            set_item("it-spring1",i-1,line)
-        elseif c == "m" then
-            fill_floor("fl-metal", i-1,line, 1,1)
-        elseif c == "i" then
-            set_stone( "st-invisible", i-1, line)
-        elseif c == "h" then
-            set_item("it-trigger", i-1,line, {action="openclose",target="door1"})
-        elseif c == "H" then
-            set_stone("st-door", i-1, line , {name="door1", type="v"})
-        elseif c == "*" then
-            set_stone("st-brownie", i-1, line)
-        elseif c == "g" then
-            draw_stones("st-grate1",{i-1,line}, {1,1}, 1)
-        elseif c == "u" then
-            set_floor("fl-gradient",  i-1,  line, {type=2})
-        elseif c == "r" then
-            set_floor("fl-gradient",  i-1,  line, {type=3})
-        elseif c == "b" then
-            set_floor("fl-gradient",  i-1,  line, {type=1})
-        elseif c == "l" then
-            set_floor("fl-gradient",  i-1,  line, {type=4})
-        elseif c == "d" then
-            set_stone("st-death", i-1,line)
-        elseif c == "1" then
-            oneway(i-1,line, enigma.NORTH)
-        elseif c == "4" then
-            oneway(i-1,line, enigma.SOUTH)
-        elseif c == "3" then
-            oneway(i-1,line, enigma.WEST)
-        elseif c == "2" then
-            oneway(i-1,line, enigma.EAST)
-        elseif c == "~" then
-            fill_floor("fl-water", i-1,line, 1,1)
-        elseif c == "!" then
-            abyss(i-1,line)
-        elseif c == "@" then
-            document(i-1,line,"text1")
-        elseif c == "+" then
-            set_stone("st-greenbrown",i-1,line)
-        elseif c == "f" then
-            fakeoxyd(i-1,line)
-        elseif c == "v" then
-            oneway(i-1,line, enigma.WEST)
-        elseif c == "y" then
-            oneway(i-1,line, enigma.NORTH)
-        elseif c == "z" then
-            set_actor("ac-blackball" ,i-1, line)
-        end
-    end
-end
-
--- Floor:  " "
--- Border: "#"
--- Oxyd:   "o"
-
-renderLine(00,"dddddddddddddddddddddddddddddddddddddddddddddddddddddddddd")
-renderLine(01,"d########################+###########++++++++++++++######d")
-renderLine(02,"d#o    ##################+o####                    ######d")
-renderLine(03,"d#     ##    ############+###########              ######d")
-renderLine(04,"d#  z  ##    ############+###########              ######d")
-renderLine(05,"d# s   ##   ###  ########ddd#########              ######d")
-renderLine(06,"d#     ##   ###     #######+#########              ######d")
-renderLine(07,"d##############      ######+#########++##########++######d")
-renderLine(08,"d#######+########    ####################################d")
-renderLine(09,"d######+##   ############################################d")
-renderLine(10,"d#####+###   ############################################d")
-renderLine(11,"d####+####   ##    ######################################d")
-renderLine(12,"d###+##########   #######m########d########  ############d")
-renderLine(13,"d#########  ##   ####mmmmm########d########  ############d")
-renderLine(14,"d########    #    ###mmmmmmmm+#############  ############d")
-renderLine(15,"d#######    ##    vvvmmmmm#################  ############d")
-renderLine(16,"d#######  #####################d###########  ############d")
-renderLine(17,"d###########+++########     ###d###########  ############d")
-renderLine(18,"d###########+f+########     ###d###########  ############d")
-renderLine(19,"d######################     ##+d###########  ############d")
-renderLine(20,"d###########   ########yyoyy##+############  ############d")
-renderLine(21,"d###########        ###      #+############  ############d")
-renderLine(22,"dd ######            #       #+############  ############d")
-renderLine(23,"dd ######       ######       #+d####   #         #  +  ##d")
-renderLine(24,"dd ###################     ####d####   #         #     ##d")
-renderLine(25,"d# ########    ################d#### f ###########     ##d")
-renderLine(26,"d# #######    ########rrrrrbb#######iii###########     ##d")
-renderLine(27,"d#           #########rrrrrbb#######iii###########     ##d")
-renderLine(28,"d#######    ##########uu###bb############################d")
-renderLine(29,"d#####################uu###bb############################d")
-renderLine(30,"d#####################uu###bb###           ### ##### ####d")
-renderLine(31,"d####    #############uulllll##            ### ##### ####d")
-renderLine(32,"d###    ##############uulllll##              #       ####d")
-renderLine(33,"d##    ############################################# ####d")
-renderLine(34,"d#o   ############################################## ####d")
-renderLine(35,"d########################################################d")
-renderLine(36,"dddddddddddddddddddddddddddddddddddddddddddddddddddddddddd")
-
-oxyd_shuffle()
-display.SetFollowMode(display.FOLLOW_SCROLLING)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-      <el:string el:key="text1">
-        <el:english el:translate="true">It's a race!</el:english>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_i/duffy07_2.xml (from rev 1713, trunk/data/levels/enigma_i/duffy07_1.xml)
===================================================================
--- trunk/data/levels/enigma_i/duffy07_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_i/duffy07_2.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,84 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Jump!" el:subtitle="" el:id="duffy7"/>
+      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
+      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by /dev/null</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["FollowGrid"] = true
+wo["FollowMethod"] = FOLLOW_SCROLL
+wo["FollowAction"] = FOLLOW_HALFSCREEN
+
+ti[" "] = {"fl_hay"}
+ti["."] = {"fl_abyss"}
+ti["-"] = {"fl_metal"}
+ti["#"] = ti["."] .. {"st_death"}
+ti["+"] = {"st_greenbrown"}
+ti["I"] = {"st_invisible"}
+ti["<"] = {"st_oneway", orientation = WEST}
+ti["^"] = {"st_oneway", orientation = NORTH}
+ti["8"] = {"fl_slope_pn"}
+ti["6"] = {"fl_slope_pe"}
+ti["2"] = {"fl_slope_ps"}
+ti["4"] = {"fl_slope_pw"}
+ti["s"] = {"it_spring_keep"}
+ti["F"] = {"st_fake_quake"}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+    "##########################################################",
+    "#........................+...........++++++++++++++......#",
+    "#.O    ..................+O....                    ......#",
+    "#.     ..    ............+...........              ......#",
+    "#.  @  ..    ............+...........              ......#",
+    "#. s   ..   ...  ........###.........              ......#",
+    "#.     ..   ...     .......+.........              ......#",
+    "#..............      ......+.........++..........++......#",
+    "#.......+........    ....................................#",
+    "#......+..   ............................................#",
+    "#.....+...   ............................................#",
+    "#....+....   ..    ......................................#",
+    "#...+..........   .......-........#........  ............#",
+    "#.........  ..   ....-----........#........  ............#",
+    "#........    .    ...--------+.............  ............#",
+    "#.......    ..    <<<-----.................  ............#",
+    "#.......  .....................#...........  ............#",
+    "#...........+++........     ...#...........  ............#",
+    "#...........+F+........     ...#...........  ............#",
+    "#......................     ..+#...........  ............#",
+    "#...........   ........^^O^^..+............  ............#",
+    "#...........        ...      .+............  ............#",
+    "## ......            .       .+............  ............#",
+    "## ......       ......       .+#....   .         .  +  ..#",
+    "## ...................     ....#....   .         .     ..#",
+    "#. ........    ................#.... F ...........     ..#",
+    "#. .......    ........6666622.......III...........     ..#",
+    "#.           .........6666622.......III...........     ..#",
+    "#.......    ..........88...22............................#",
+    "#.....................88...22............................#",
+    "#.....................88...22...           ... ..... ....#",
+    "#....    .............8844444..            ... ..... ....#",
+    "#...    ..............8844444..              .       ....#",
+    "#..    ............................................. ....#",
+    "#.O   .............................................. ....#",
+    "#........................................................#",
+    "##########################################################"})
+
+wo:shuffleOxyd()
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_i/index.xml
===================================================================
--- trunk/data/levels/enigma_i/index.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_i/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -76,7 +76,7 @@
     <level _seq="68" _title="Laser Arena" _xpath="./andreas14_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas14" rel="2" rev="5" score="1" target="time" unit="duration"/>
     <level _seq="69" _title="Advanced Lasers" _xpath="./luc23_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc23" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="70" _title="- Meditation -" _xpath="./ant24_2" author="Petr Machata" ctrl="force" easy="false" id="ant24" rel="2" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="71" _title="Spiral Race" _xpath="./wb06_1" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb6" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="71" _title="Spiral Race" _xpath="./wb06_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb6" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="72" _title="Way To Go" _xpath="./daniel09_1" author="Daniel Heck" ctrl="force" easy="false" id="mirrors" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="73" _title="Formentera!" _xpath="./luc06_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc06" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="74" _title="If They'd Just Hold Still" _xpath="./duffy21_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy21" rel="1" rev="2" score="1" target="time" unit="duration"/>
@@ -101,7 +101,7 @@
     <level _seq="93" _title="Time is Money" _xpath="./nat11_2" author="Nat Pryce" ctrl="force" easy="false" id="nat11" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="94" _title="Growing The Doors" _xpath="./martin88_3" author="Martin Hawlisch" ctrl="force" easy="false" id="martin88" rel="3" rev="3" score="2" target="time" unit="duration"/>
     <level _seq="95" _title="Impulsive" _xpath="./ant13_1" author="Petr Machata" ctrl="force" easy="false" id="ant13" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="96" _title="Jump!" _xpath="./duffy07_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy7" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="96" _title="Jump!" _xpath="./duffy07_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy7" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="97" _title="Hit the Right One" _xpath="./martin77_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin77" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="98" _title="Island Paradise" _xpath="./duffy100_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy100" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="99" _title="The Racetrack" _xpath="./martin31_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin31" rel="1" rev="0" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_i/wb06_1.xml
===================================================================
--- trunk/data/levels/enigma_i/wb06_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_i/wb06_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Spiral Race" el:subtitle="" el:id="wb6"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Jon 'WB' Sneyers" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Jon 'WB' Sneyers</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-cells={}
-
-cells[" "]=cell{floor="fl-tigris"}
-cells[";"]=cell{floor="fl-samba"}
-cells[":"]=cell{floor="fl-stone"}
-cells["w"]=cell{stone="st-wood"}
-cells["i"]=cell{stone="st-stoneimpulse"}
-
-cells["="]=cell{stone="st-rock5"}
-cells["G"]=cell{stone="st-grate1"}
-cells["#"]=cell{stone="st-rock6"}
-cells["."]=cell{floor="fl-abyss"}
-
-cells["H"]=cell{stone="st-chameleon"}
-
-cells["&"]=cell{{{oneway, EAST}}}
-cells["%"]=cell{{{oneway, WEST}}}
-
-cells["V"]=cell{parent=cells[" "], stone="st-bolder-s"}
-cells[">"]=cell{parent=cells[" "], stone="st-bolder-e"}
-cells["<"]=cell{parent=cells[" "], stone="st-bolder-w"}
-cells["^"]=cell{parent=cells[" "], stone="st-bolder-n"}
-
-cells["O"]=cell{actor={face="ac-blackball", attr={player=0}}}
-cells["0"]=oxyd
-
-level = {      
-   "iiiiiiiiiiiiiiiiiiii",
-   "i                  i",
-   "i iiiiiiiiiiiiiiii i",
-   "i i              i i",
-   "i i iiiiiiiiiiii i i",
-   "i i i#00000#wiii i i",
-   "i i i#     G %   i i",
-   "i i i#00000##iiiii i",
-   "i i iiiiiiiiii     i",
-   "i i            iii i",
-   "i iiiiiiiiiiiiii iii",
-   "i               w Oi",
-   "iiiiiiiiiiiiiiiiiii#",
-}
---  01234567890123456789
-
-oxyd_default_flavor = "c"
-set_default_parent(cells[" "])
-create_world_by_map(level)
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_i/wb06_2.xml (from rev 1712, trunk/data/levels/enigma_i/wb06_1.xml)
===================================================================
--- trunk/data/levels/enigma_i/wb06_1.xml	2009-06-06 22:35:36 UTC (rev 1712)
+++ trunk/data/levels/enigma_i/wb06_2.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,48 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Spiral Race" el:subtitle="" el:id="wb6"/>
+      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Jon 'WB' Sneyers" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Jon 'WB' Sneyers</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by /dev/null</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_tigris"}
+ti["#"] = {"st_stoneimpulse"}
+ti["="] = {"st_purplegray"}
+ti["+"] = {"st_box"}
+ti["X"] = {"st_grate", flavor="cross"}
+ti["<"] = {"st_oneway", orientation=WEST}
+ti["O"] = {"st_oxyd_c"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+   "####################",
+   "#                  #",
+   "# ################ #",
+   "# #              # #",
+   "# # ############ # #",
+   "# # #=OOOOO=+### # #",
+   "# # #=     X <   # #",
+   "# # #=OOOOO==##### #",
+   "# # ##########     #",
+   "# #            ### #",
+   "# ############## ###",
+   "#               + @#",
+   "###################="})
+   
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_ii/index.xml
===================================================================
--- trunk/data/levels/enigma_ii/index.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_ii/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -12,7 +12,7 @@
     <level _seq="4" _title=".-R-.-U-.-N-." _xpath="./martin103_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin103" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="5" _title="Gateway" _xpath="./martin85_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin85" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="6" _title="Sentinels" _xpath="./siegfried23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8d" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="7" _title="Push Them In" _xpath="./nat05_1" author="Andreas Persenius, Nat Pryce" ctrl="force" easy="false" id="nat5" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="7" _title="Push Them In" _xpath="./nat05_2" author="Andreas Persenius, Nat Pryce" ctrl="force" easy="false" id="nat5" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Rollercoaster" _xpath="./jc02_1" author="Jens-Christian Korth" ctrl="force" easy="false" id="jc02" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="9" _title="Dancers" _xpath="./ant14_2" author="Petr Machata" ctrl="force" easy="false" id="ant14" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="10" _title="- Meditation -" _xpath="./wb10_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb10" rel="2" rev="1" score="1" target="time" unit="duration"/>
@@ -41,7 +41,7 @@
     <level _seq="33" _title="Black Holes" _xpath="./siegfried03_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level2a" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="34" _title="When Gravity Fails" _xpath="./nat10_2" author="Nat Pryce" ctrl="force" easy="false" id="nat10" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="35" _title="Alien Glyphs 2" _xpath="./duffy96_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy96" rel="2" rev="1" score="2" target="time" unit="duration"/>
-    <level _seq="36" _title="Koosnab" _xpath="./rb02_1" author="Roberto Bardin" ctrl="force" easy="false" id="rb02" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="36" _title="Koosnab" _xpath="./rb02_2" author="Roberto Bardin" ctrl="force" easy="false" id="rb02" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="37" _title="More Black Holes" _xpath="./luc18_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc18" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="38" _title="Alien Glyphs 3" _xpath="./duffy97_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy97" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="39" _title="Solar System" _xpath="./duffy98_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy98" rel="1" rev="1" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_ii/nat05_1.xml
===================================================================
--- trunk/data/levels/enigma_ii/nat05_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_ii/nat05_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -1,82 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Push Them In" el:subtitle="" el:id="nat5"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Andreas Persenius, Nat Pryce" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 1999,2000,2002 Andreas Persenius, Nat Pryce</el:copyright>
-      <el:license el:type="Donated to Enigma under the projects license" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- A GSokoban level adapted for Enigma
-
-INNER_FLOOR = "fl-normal"
-OUTER_FLOOR = "fl-leaves"
-WALL = "st-metal"
-
-level = {
-    "                    ",
-    "          ########  ",
-    "          #.....o#  ",
-    "          #.+#+.##  ",
-    "   ########.+..+#   ",
-    "   #x~~...##+.+.#   ",
-    " #######..#.+.#.### ",
-    " #x~~~~..##.+..+..# ",
-    " ##x~~~....+..+...# ",
-    " #x~~~~..########## ",
-    " #########          ",
-    "                    ",
-    "                    "
-}
-
-cells = {}
-cells["."] = function( x, y )
-    set_floor( INNER_FLOOR, x, y )
-end
-cells["#"] = function( x, y )
-    set_stone( WALL, x, y )
-end
-cells["o"] = function( x, y )
-    set_floor( INNER_FLOOR, x, y )
-    set_actor( "ac-blackball", x+0.5, y+0.5 )
-end
-cells["x"] = function( x, y )
-    set_floor( INNER_FLOOR, x, y )
-    oxyd(x,y)
-end
-cells["+"] = function( x, y )
-    set_floor( INNER_FLOOR, x, y )
-    set_stone( "st-wood", x, y )
-end
-cells["~"] = function( x, y )
-    set_floor( "fl-water", x, y )
-end
-cells[" "] = function( x, y )
-    set_floor( OUTER_FLOOR, x,y )
-end
-
-create_world( strlen(level[1]), getn(level) )
-for y,line in pairs(level) do
-    for x = 1,strlen(line) do
-        cell = strchar(strbyte(line,x))
-        cells[cell]( x-1, y-1 )
-    end
-end
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_ii/nat05_2.xml (from rev 1712, trunk/data/levels/enigma_ii/nat05_1.xml)
===================================================================
--- trunk/data/levels/enigma_ii/nat05_1.xml	2009-06-06 22:35:36 UTC (rev 1712)
+++ trunk/data/levels/enigma_ii/nat05_2.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,52 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Push Them In" el:subtitle="" el:id="nat5"/>
+      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Andreas Persenius, Nat Pryce" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 1999,2000,2002 Andreas Persenius, Nat Pryce</el:copyright>
+      <el:license el:type="Donated to Enigma under the projects license" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>
+          A Sokoban level adapted for Enigma
+          New API converted by /dev/null
+        </el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_metal_7"}
+ti["."] = {"fl_lawn"}
+ti["~"] = {"fl_water"}
+ti["#"] = {"st_metal"}
+ti["+"] = {"st_box"}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+    "....................",
+    "..........########..",
+    "..........#     @#..",
+    "..........# +#+ ##..",
+    "...######## +  +#...",
+    "...#O~~   ##+ + #...",
+    ".#######  # + # ###.",
+    ".#O~~~~  ## +  +  #.",
+    ".##O~~~    +  +   #.",
+    ".#O~~~~  ##########.",
+    ".#########..........",
+    "....................",
+    "...................."})
+
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_ii/pento05_1.xml
===================================================================
--- trunk/data/levels/enigma_ii/pento05_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_ii/pento05_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -17,8 +17,9 @@
       <el:score el:easy="-" el:difficult="-"/>
     </el:info>
     <el:luamain><![CDATA[
+wo["FollowGrid"] = true
 wo["FollowMethod"] = FOLLOW_SCROLL
-wo["ConserveLevel"] = true
+wo["FollowAction"] = FOLLOW_HALFSCREEN
 
 ti[" "] = {"fl_plank"}
 ti["+"] = {"fl_bluegreen", "source#"}
@@ -35,7 +36,6 @@
 ti["w"] = {"it_puller_w"}
 ti["N"] = ti["n"] .. ti({"fl_plank","pullers"})
 ti["!"] = {"it_sensor", target="addpullers", invisible=true}
-
 ti["@"] = {"#ac_marble"}
 
 pento = res.pento(ti, "source", "target")

Deleted: trunk/data/levels/enigma_ii/rb02_1.xml
===================================================================
--- trunk/data/levels/enigma_ii/rb02_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_ii/rb02_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -1,82 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Koosnab" el:subtitle="" el:id="rb02"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Roberto Bardin" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2005 Roberto Bardin</el:copyright>
-      <el:license el:type="GPL version 2" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-levelw = 20
-levelh = 13
-
-create_world( levelw, levelh)
-oxyd_default_flavor="a"
-fill_floor("fl-space", 0,0,levelw,levelh)
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-        if c =="#" then
-            set_stone( "st-rock7", i-1, line)
-        elseif c == "o" then
-            oxyd( i-1, line)
-        elseif c == "-" then
-            set_stone("st-glass1", i-1, line)
-        elseif c == "." then
-            set_floor("fl-normal", i-1, line)
-        elseif c == ":" then
-            set_floor("fl-bluegray", i-1, line)
-        elseif c == "s" then
-            set_floor("fl-red", i-1, line)
-        elseif c == "m" then
-            set_floor("fl-normal", i-1, line)
-            set_stone( "st-wood-growing", i-1, line)
-        end
-    end
-end
-
-renderLine(  0, "   o             -  ");
-renderLine(  1, "  #:########    -   ");
-renderLine(  2, "  #...##...#     -  ");
-renderLine(  3, "  #.#.##.m.#      - ");
-renderLine(  4, "  #........:o      -");
-renderLine(  5, "  ###.##.###      - ");
-renderLine(  6, "  ###.##.###     -  ");
-renderLine(  7, "  #....ssss#    -   ");
-renderLine(  8, "  #.m.##.#.#   -    ");
-renderLine(  9, " o:...##...#  -     ");
-renderLine( 10, "  ########:#   -    ");
-renderLine( 11, "          o     -   ");
-renderLine( 12, "               -    ");
-
-set_stone("st-door", 11, 4, {name="door1", type="v"})
-set_stone("st-door", 3, 1, {name="door2", type="h"})
-set_stone("st-door", 2, 9, {name="door3", type="v"})
-set_stone("st-door", 10, 10, {name="door4", type="h"})
-
-set_item("it-trigger", 7,7, {action="openclose", target="door3"})
-set_item("it-trigger", 8,7, {action="openclose", target="door4"})
-set_item("it-trigger", 9,7, {action="openclose", target="door2"})
-set_item("it-trigger",10,7, {action="openclose", target="door1"})
-
-ac1=set_actor("ac-blackball", 3.5, 3.5)
-
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_ii/rb02_2.xml (from rev 1712, trunk/data/levels/enigma_ii/rb02_1.xml)
===================================================================
--- trunk/data/levels/enigma_ii/rb02_1.xml	2009-06-06 22:35:36 UTC (rev 1712)
+++ trunk/data/levels/enigma_ii/rb02_2.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,50 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Koosnab" el:subtitle="" el:id="rb02"/>
+      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Roberto Bardin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2005 Roberto Bardin</el:copyright>
+      <el:license el:type="GPL version 2" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by /dev/null</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti["  "] = {"fl_metal_7"}
+ti[" ."] = {"fl_space"}
+ti["# "] = {"st_greengray"}
+ti["= "] = {"st_lightglass"}
+ti["doorsEW"] = {"st_door", "door%%#", faces="ew", state = CLOSED} .. ti({"fl_bluegray"})
+ti["doorsNS"] = {"st_door", "door%%#", faces="ns", state = CLOSED} .. ti({"fl_bluegray"})
+ti["triggers"] = {"it_trigger", target = "door%%#*"}
+ti["W "] = {"st_box_wood_growing"}
+ti["O "] = {"st_oxyd"}
+ti["@ "] = {"#ac_marble_black"}
+
+wo(res.composer(res.autotile(ti, {"-", "doorsNS"}, {"|", "doorsEW"}, {"T", "triggers"})), "  ", {
+    " . . .O. . . . . . . . . . . . . .=. . .",
+    " . .# -2# # # # # # # #  . . . .=. . . .",
+    " . .#       # #       #  . . . . .=. . .",
+    " . .# @ #   # #   W   #  . . . . . .=. .",
+    " . .#                 |1O. . . . . . .=.",
+    " . .# # #   # #   # # #  . . . . . .=. .",
+    " . .# # #   # #   # # #  . . . . .=. . .",
+    " . .#         T3T4T2T1#  . . . .=. . . .",
+    " . .#   W   # #   #   #  . . .=. . . . .",
+    " .O.|3      # #       #  . .=. . . . . .",
+    " . .# # # # # # # # -4#  . . .=. . . . .",
+    " . . . . . . . . . .O. . . . . .=. . . .",
+    " . . . . . . . . . . . . . . .=. . . . ."})
+
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Deleted: trunk/data/levels/enigma_iii/illmind07_1.xml
===================================================================
--- trunk/data/levels/enigma_iii/illmind07_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_iii/illmind07_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -1,114 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="White Contrast" el:subtitle="" el:id="illmind07"/>
-      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
-      <el:author  el:name="illmind" el:email="support at mag-heut.net" el:homepage="http://www.mag-heut.net/"/>
-      <el:copyright>Copyright ? illmind</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- !!BBE105!! Do not delete this line
-
-function file_oxyd(x,y,f)
-    oxyd_default_flavor=f
-    oxyd(x,y)
-end
-
-levelh=13
-levelw=20
-
-enigma.SlopeForce=30
-enigma.ElectricForce=30
-
-cells={}
-items={}
-stones={}
-
-stones[" "]=cell{}
-cells[" "]=cell{}
-items[" "]=cell{}
-
-cells["!"]=cell{floor="fl-acblack"}
-stones["!"]=cell{stone="st-rock6"}
-stones["#"]=cell{parent={{file_oxyd,"c"}}}
-stones["$"]=cell{stone="st-grate1"}
-stones["%"]=cell{stone="st-stone_break"}
-stones["&"]=cell{stone="st-swap"}
-stones["'"]=cell{stone="st-wood"}
-items["!"]=cell{item="it-hammer"}
-items["#"]=cell{item="it-document"}
-
-level={"!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!",
-       "!!!!!!!!!!!!!!!!!!!!"}
-
-  itmap={"                    ",
-         "                    ",
-         "                    ",
-         "                    ",
-         "                    ",
-         "                    ",
-         "                    ",
-         "              ! ##  ",
-         "                    ",
-         "                 !  ",
-         "                    ",
-         "                    ",
-         "                    "}
- stmap={"!!!!!!!!!!!!!!!!!!!!",
-        "!#$!$$!$!$$$$%%%%#!!",
-        "!!!!$$!#!$$&$%%%%!#!",
-        "!$$$$$!!!$&!$%%%!#%!",
-        "!$$$$$$$$$$&$%%!%%%!",
-        "!$$$$$$$$$$$$%!%%%%!",
-        "!%%%%%!!!!!!!!%%%%%!",
-        "!%#%%!  $$$  '  '  !",
-        "!%%%!$&$$$$$$$$$!!!!",
-        "!%%!%$!&$$$&!$$$!$$!",
-        "!#!%%$&$$$$$$$$$!!!!",
-        "!!#%%$$$$$$$$$$$$$$!",
-        "!!!!!!!!!!!!!!!!!!!!"}
-
-create_world_by_map(level)
-draw_map(0,0,stmap,stones)
-draw_map(0,0,itmap,items)
-
-SetAttrib(enigma.GetItem(16,7),"text","text1")
-SetAttrib(enigma.GetItem(17,7),"text","text2")
-
-set_actor("ac-whiteball",18.5,7.5,{player=0, controllers=1})
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-      <el:string el:key="text1">
-        <el:english el:translate="true">One  more  and  you  won't  get  this  hammer  until  you  don't  need  it  anymore!</el:english>
-      </el:string> 
-      <el:string el:key="text2">
-        <el:english el:translate="false">illmind's  white  contrast  ...</el:english>
-      </el:string> 
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_iii/illmind07_2.xml (from rev 1712, trunk/data/levels/enigma_iii/illmind07_1.xml)
===================================================================
--- trunk/data/levels/enigma_iii/illmind07_1.xml	2009-06-06 22:35:36 UTC (rev 1712)
+++ trunk/data/levels/enigma_iii/illmind07_2.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,58 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="White Contrast" el:subtitle="" el:id="illmind07"/>
+      <el:version el:score="1" el:release="2" el:revision="2" el:status="released"/>
+      <el:author  el:name="illmind" el:email="support at mag-heut.net" el:homepage="http://www.mag-heut.net/"/>
+      <el:copyright>Copyright ? illmind</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by /dev/null</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_yinyang", state = YIN, invisible = true}
+ti["#"] = {"st_purplegray"}
+ti["+"] = {"st_box"}
+ti["h"] = {"it_hammer"}
+ti["d"] = {"it_document", text = "text2"}
+ti["D"] = ti["+"] .. {"it_document", text = "text1"}
+ti["x"] = {"st_grate", flavor = "cross"}
+ti["X"] = ti["x"] .. ti["h"]
+ti["B"] = {"st_break_oxydc"}
+ti["S"] = {"st_swap"}
+ti["O"] = {"st_oxyd_c"}
+ti["@"] = {"#ac_marble_white", controllers = CTRL_YIN, owner = YIN}
+
+wo(ti, " ", {
+    "####################",
+    "#Ox#xx#x#xxxxBBBBO##",
+    "####xx#O#xxSxBBBB#O#",
+    "#xxxxx###xS#xBBB#OB#",
+    "#xxxxxxxxxxSxBB#BBB#",
+    "#xxxxxxxxxxxxB#BBBB#",
+    "#BBBBB########BBBBB#",
+    "#BOBB#  xxx  +h Dd@#",
+    "#BBB#xSxxxxxxxxx####",
+    "#BB#Bx#SxxxS#xxx#Xx#",
+    "#O#BBxSxxxxxxxxx####",
+    "##OBBxxxxxxxxxxxxxx#",
+    "####################"})
+
+wo:shuffleOxyd()
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">One  more  and  you  won't  get  this  hammer  until  you  don't  need  it  anymore!</el:english>
+      </el:string>
+      <el:string el:key="text2">
+        <el:english el:translate="false">illmind's  white  contrast  ...</el:english>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_iii/index.xml
===================================================================
--- trunk/data/levels/enigma_iii/index.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_iii/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -59,7 +59,7 @@
     <level _seq="51" _title="Hexagony" _xpath="./nat22_2" author="Nat Pryce" ctrl="force" easy="true" id="nat22" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="52" _title="Set Me Free" _xpath="./illmind06_2" author="illmind" ctrl="force" easy="false" id="illmind06" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="53" _title="Danger Slide" _xpath="./luc15_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc15" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="54" _title="White Contrast" _xpath="./illmind07_1" author="illmind" ctrl="force" easy="false" id="illmind07" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="54" _title="White Contrast" _xpath="./illmind07_2" author="illmind" ctrl="force" easy="false" id="illmind07" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="55" _title="Laser Tricks" _xpath="./duffy84_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy84" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="56" _title="Space Fishing" _xpath="./martin73_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin73" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="57" _title="Manamana" _xpath="./just07_1" author="JuSt" ctrl="force" easy="false" id="just07" rel="1" rev="3" score="1" target="time" unit="duration"/>

Added: trunk/data/levels/enigma_ix/Makefile.am
===================================================================
--- trunk/data/levels/enigma_ix/Makefile.am	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_ix/Makefile.am	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,3 @@
+pkgdatadir = $(datadir)/@PACKAGE@/levels/enigma_ix
+pkgdata_DATA = $(wildcard $(srcdir)/*.xml)
+EXTRA_DIST = $(pkgdata_DATA)


Property changes on: trunk/data/levels/enigma_ix/Makefile.am
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_ix/index.xml
===================================================================
--- trunk/data/levels/enigma_ix/index.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_ix/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,12 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
+
+  <info enigma="1.00" group="Enigma" location="11100" network="false" owner="Enigma Team" release="1" revision="1" title="Enigma IX"/>
+
+  <attributes/>
+
+  <levels>
+    <level _seq="1" _title="Welcome" _xpath="./welcometopack9_1" author="Raoul Bourquin" ctrl="force" easy="true" id="welcometopack9" rel="1" rev="1" score="1" target="time" unit="duration"/>
+  </levels>
+
+</index>


Property changes on: trunk/data/levels/enigma_ix/index.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_ix/welcometopack9_1.xml
===================================================================
--- trunk/data/levels/enigma_ix/welcometopack9_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_ix/welcometopack9_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,58 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Welcome" el:subtitle="" el:id="welcometopack9"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
+      <el:author  el:name="Raoul Bourquin" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 Raoul Bourquin</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["MaxOxydColor"] = OXYD_ORANGE
+
+ti[" "] = {"fl_lawn"}
+ti["#"] = {"st_granite"}
+if wo["IsDifficult"] then
+    ti["Q"] = {"st_quake", name="quake"}
+    ti["T"] = {"st_timer", interval=50.0, target="quake"}
+else
+    ti["Q"] = ti["#"]
+    ti["T"] = ti["#"]
+end
+ti["d"] = {"it_document", text="text1"}
+ti["O"] = {"st_oxyd", name="left#"}
+ti["o"] = {"st_oxyd", name="right#"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+    "####################",
+    "#                  #",
+    "#  O  O      o  o  #",
+    "#                  #",
+    "#   O  O    o  o   #",
+    "#                  #",
+    "Q @  O  O  o  o  d T",
+    "#                  #",
+    "#   O  O    o  o   #",
+    "#                  #",
+    "#  O  O      o  o  #",
+    "#                  #",
+    "####################"})
+
+wo:shuffleOxyd({"left#*", "right#*", min=4, max=6})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="true"/>
+        <el:translation el:lang="de">Willkommen</el:translation>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Welcome to Enigma IX</el:english>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_ix/welcometopack9_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/data/levels/enigma_tutorial/index.xml
===================================================================
--- trunk/data/levels/enigma_tutorial/index.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_tutorial/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -31,14 +31,14 @@
     <level _seq="23" _title="Watery Grave" _xpath="enigma_i/martin37_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin37" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="24" _title="Blocks and Slopes" _xpath="./a_tut03_2" author="Andreas Lochmann" ctrl="force" easy="false" id="a_tut03" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="25" _title="Round Trip" _xpath="enigma_ii/martin35_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin35" rel="2" rev="2" score="2" target="time" unit="duration"/>
-    <level _seq="26" _title="Koosnab" _xpath="enigma_ii/rb02_1" author="Roberto Bardin" ctrl="force" easy="false" id="rb02" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="26" _title="Koosnab" _xpath="enigma_ii/rb02_2" author="Roberto Bardin" ctrl="force" easy="false" id="rb02" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="27" _title="Hanging In The Balance" _xpath="enigma_i/illmind03_2" author="illmind" ctrl="force" easy="false" id="illmind03" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="28" _title="Three Plugs" _xpath="enigma_i/martin83_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin83" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="29" _title="Black Is Beautiful" _xpath="enigma_iii/martin15_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin15" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="30" _title="- Meditation -" _xpath="enigma_i/siegfried39_2" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation6" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="31" _title="Indoor Pool" _xpath="enigma_ii/nat01_2" author="Nat Pryce" ctrl="force" easy="false" id="nat1" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="32" _title="Balance" _xpath="enigma_i/erich01_2" author="Erich Schubert" ctrl="force" easy="false" id="balance" rel="2" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="33" _title="Push Them In" _xpath="enigma_ii/nat05_1" author="Andreas Persenius, Nat Pryce" ctrl="force" easy="false" id="nat5" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="33" _title="Push Them In" _xpath="enigma_ii/nat05_2" author="Andreas Persenius, Nat Pryce" ctrl="force" easy="false" id="nat5" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="34" _title="Without Tremor" _xpath="enigma_i/richi04_2" author="Richi B?tzer" ctrl="force" easy="false" id="richi04" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="35" _title="Slippery Slopes" _xpath="enigma_i/martin38_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin38" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="36" _title="Ice Skating" _xpath="enigma_i/siegfried22_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level7a" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_v/index.xml
===================================================================
--- trunk/data/levels/enigma_v/index.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_v/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -86,7 +86,7 @@
     <level _seq="78" _title="Don't Be Greedy" _xpath="./duffy71_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy71" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="79" _title="Help Yourself" _xpath="./duffy113_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy113" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="80" _title="Catwalk Meditation" _xpath="./ral05_2" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060505ral007" rel="2" rev="159" score="2" target="time" unit="duration"/>
-    <level _seq="81" _title="Sheet Of Ice" _xpath="./martin58_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin58" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="81" _title="Sheet Of Ice" _xpath="./martin58_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin58" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="82" _title="Dynamice" _xpath="./andreas20_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas20" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="83" _title="Randomizer" _xpath="./duffy115_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy115" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="84" _title="Cold Mail" _xpath="./andreas18_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas18" rel="2" rev="2" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_v/martin58_1.xml
===================================================================
--- trunk/data/levels/enigma_v/martin58_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_v/martin58_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -1,63 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Sheet Of Ice" el:subtitle="" el:id="martin58"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Martin Hawlisch" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Martin Hawlisch</el:copyright>
-      <el:license el:type="GPL version 2" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-create_world( 20, 13)
-oxyd_default_flavor = "a"
-
-fill_floor( "fl-ice")
-
-draw_border( "st-actorimpulse")
-
-oxyd( 3, 0)
-oxyd( 7, 0)
-oxyd(12, 0)
-oxyd(16, 0)
-oxyd( 3,12)
-oxyd( 7,12)
-oxyd(12,12)
-oxyd(16,12)
-oxyd( 0, 3)
-oxyd(19, 3)
-oxyd( 0, 9)
-oxyd(19, 9)
-
-oxyd_shuffle()
-
-set_stone( "st-death", 1, 0)
-set_stone( "st-death", 0, 1)
-set_stone( "st-death",18, 0)
-set_stone( "st-death",19, 1)
-set_stone( "st-death", 1,12)
-set_stone( "st-death", 0,11)
-set_stone( "st-death",18,12)
-set_stone( "st-death",19,11)
-
-set_item( "it-magnet", 1, 1, {name="magnet1", on=1})
-set_item( "it-magnet",18, 1, {name="magnet2", on=1})
-set_item( "it-magnet", 1,11, {name="magnet3", on=1})
-set_item( "it-magnet",18,11, {name="magnet4", on=1})
-
-set_actor("ac-blackball", 10, 6.5)
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_v/martin58_2.xml (from rev 1712, trunk/data/levels/enigma_v/martin58_1.xml)
===================================================================
--- trunk/data/levels/enigma_v/martin58_1.xml	2009-06-06 22:35:36 UTC (rev 1712)
+++ trunk/data/levels/enigma_v/martin58_2.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,46 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Sheet Of Ice" el:subtitle="" el:id="martin58"/>
+      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Martin Hawlisch" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Martin Hawlisch</el:copyright>
+      <el:license el:type="GPL version 2" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by /dev/null</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_ice"}
+ti["#"] = {"st_actorimpulse"}
+ti["!"] = {"st_death"}
+ti["m"] = {"it_magnet", state = ON}
+ti["O"] = {"st_oxyd_a", name="oxyd#"}
+ti["@"] = {"ac_marble_black", 0.0, -0.5}
+
+wo(ti, " ", {
+    "#!#O###O####O###O#!#",
+    "!m                m!",
+    "#                  #",
+    "O                  O",
+    "#                  #",
+    "#                  #",
+    "#                  #",
+    "#         @        #",
+    "#                  #",
+    "O                  O",
+    "#                  #",
+    "!m                m!",
+    "#!#O###O####O###O#!#"})
+
+wo:shuffleOxyd({no["oxyd#*"]:sort("circular"), circular=true})
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Deleted: trunk/data/levels/enigma_vi/ant39_1.xml
===================================================================
--- trunk/data/levels/enigma_vi/ant39_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_vi/ant39_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -1,103 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Odyssey" el:subtitle="The Enigma Level" el:id="ant39"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Petr Machata" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Petr Machata</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-       <el:dependency el:path="lib/ant" el:id="lib/ant" el:release="1" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- 2003-02-10 -- keeping up to date with latest additions to ant.lua
-
-cells={}
-
-solidfloor=cell{floor={face="fl-leaves"}}
-abyssfloor=cell{floor={face="fl-abyss"}}
-wallstone=cell{stone={face="st-rock1"}}
-
-cells["#"]=cell{parent={solidfloor, wallstone}}
-cells[" "]=cell{parent={solidfloor}}
-cells["."]=cell{parent={abyssfloor}}
-cells["="]=cell{parent={solidfloor}, stone={face="st-glass"}}
-
-cells["X"]=cell{parent=cells[" "],stone={face="st-grate1"}}
-
-cells["+"]=cell{parent=cells[" "],stone={face="st-puzzle", attr={connections=PUZ_0000}}}
-cells["/"]=cell{parent=cells[" "],stone={face="st-puzzle", attr={connections=PUZ_0110}}}
-cells[")"]=cell{parent=cells[" "],stone={face="st-puzzle", attr={connections=PUZ_0001}}}
-cells["|"]=cell{parent=cells[" "],stone={face="st-puzzle", attr={connections=PUZ_1010}}}
-cells["L"]=cell{parent=cells[" "],stone={face="st-puzzle", attr={connections=PUZ_1100}}}
-
-cells["w"]=cell{parent=cells[" "],stone={face="st-wood"}}
-
-cells[">"]=cell{parent=cells[" "],stone={face="st-laser", attr={on=FALSE, dir=enigma.EAST, name="laser1"}}}
-cells["S"]=cell{parent=cells[" "],stone={face="st-switch", attr={action="onoff", target="laser1"}}}
-cells["F"]=cell{parent=cells[" "],stone={face="st-laserswitch", attr={action="openclose", target="doorF"}}}
-cells["G"]=cell{parent=cells[" "],stone={face="st-laserswitch", attr={action="openclose", target="doorG"}}}
-cells["f"]=cell{parent=cells[" "],stone={face="st-door", attr={type="h", name="doorF"}}}
-cells["g"]=cell{parent=cells[" "],stone={face="st-door", attr={type="h", name="doorG"}}}
-cells["s"]=cell{parent=cells["w"],item={face="it-seed"}}
-
-cells["M"]=cell{parent=cells[" "],stone={face="st-pmirror", attr={movable=TRUE, transparent=FALSE, orientation=NORTH}}}
-
-cells["0"]=cell{parent={cells[" "], oxyd}}
-cells["O"]=cell{parent=cells[" "],actor={face="ac-blackball", attr={player=0}, actor=1}}
-
-level = {
-   "####################",
-   "#                  #",
-   "# w w w w w  w w w #",
-   "#..................#",
-   "#..................#",
-   "#..................#",
-   "#..................#",
-   "#                  #",
-   "#     ###### ####  #",
-   "#     #G=       #  #",
-   "#     ###  +    #  #",
-   "#      O#  +    #  #",
-   "###|#####  |    ####",
-   "#X +  =    |      X#",
-   "#X M  =    |      X#",
-   "#X    =    |   /  X#",
-   ">X    =       ||  X#",
-   "#X    =       L   X#",
-   "##XXXX#====#w #===##",
-   "#X    =    w w    X#",
-   "SX w  =     w     X#",
-   "#Xw s =      ))   X#",
-   "#X s  =   M|  ww  X#",
-   "#X    =   M       X#",
-   "###g#####        ###",
-   "#       #        # #",
-   "#  w  ###        # #",
-   "# w w #F=        # #",
-   "#  w  ######f##### #",
-   "#        #         #",
-   "#........#.........#",
-   "#........#.........#",
-   "#........#.........#",
-   "#........#.........#",
-   "#        #         #",
-   "#        #         #",
-   "#0######0#0#######0#"
-}
-
-oxyd_default_flavor = "c"
-create_world_by_map(level, cells)
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_vi/ant39_2.xml (from rev 1713, trunk/data/levels/enigma_vi/ant39_1.xml)
===================================================================
--- trunk/data/levels/enigma_vi/ant39_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_vi/ant39_2.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,82 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Odyssey" el:subtitle="The Enigma Level" el:id="ant39"/>
+      <el:version el:score="2" el:release="2" el:revision="1" el:status="released"/>
+      <el:author  el:name="Petr Machata" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Petr Machata</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+        <el:dependency el:path="lib/libpuzzle" el:id="lib/libpuzzle" el:release="3" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by /dev/null</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti["  "] = {"fl_lawn"}
+ti[".."] = {"fl_abyss"}
+ti["##"] = {"st_granite"}
+ti["=="] = {"st_rawglass"}
+ti["XX"] = {"st_grate_cross"}
+ti["MM"] = {"st_mirror", movable = true}
+ti["doors"] = {"st_door", "door%%#", faces = "ns", state = CLOSED}
+ti["laserswitches"] = {"st_laserswitch", target = "door%%#*"}
+ti["LE"] = {"st_laser_e", "laserEast"}
+ti["SL"] = {"st_switch", target = "laserEast"}
+ti["++"] = {"st_box"}
+ti["ss"] = ti["++"] .. {"it_seed"}
+ti["P"] = {"st_puzzle_blue", intensity = 0}
+ti["OE"] = {"st_oxyd_c", "east#"}
+ti["OW"] = {"st_oxyd_c", "west#"}
+ti["@@"] = {"#ac_marble_black"}
+
+wo(res.autotile(res.puzzle(ti, "P"), {"D", "doors"}, {"T", "laserswitches"}), "  ", {
+   "########################################",
+   "##                                    ##",
+   "##  ++  ++  ++  ++  ++    ++  ++  ++  ##",
+   "##....................................##",
+   "##....................................##",
+   "##....................................##",
+   "##....................................##",
+   "##                                    ##",
+   "##          ############  ########    ##",
+   "##          ##T1==              ##    ##",
+   "##          ######    PO        ##    ##",
+   "##            @@##    PO        ##    ##",
+   "######Pj##########    Pj        ########",
+   "##XX  PO    ==        Pj            XX##",
+   "##XX  MM    ==        Pj            XX##",
+   "##XX        ==        Pj      Pf    XX##",
+   "LEXX        ==              PjPj    XX##",
+   "##XX        ==              Pl      XX##",
+   "####XXXXXXXX##========##++  ##======####",
+   "##XX        ==        ++  ++        XX##",
+   "SLXX  ++    ==          ++          XX##",
+   "##XX++  ss  ==            PaPa      XX##",
+   "##XX  ss    ==      MMPj    ++++    XX##",
+   "##XX        ==      MM              XX##",
+   "######D1##########                ######",
+   "##              ##                ##  ##",
+   "##    ++    ######                ##  ##",
+   "##  ++  ++  ##T2==                ##  ##",
+   "##    ++    ############D2##########  ##",
+   "##                ##                  ##",
+   "##................##..................##",
+   "##................##..................##",
+   "##................##..................##",
+   "##................##..................##",
+   "##                ##                  ##",
+   "##                ##                  ##",
+   "##OW############OW##OE##############OE##"})
+
+wo:shuffleOxyd({"west#*", max = 0}, {"east#*", max = 0})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_vi/index.xml
===================================================================
--- trunk/data/levels/enigma_vi/index.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_vi/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -44,7 +44,7 @@
     <level _seq="36" _title="Procrustes" _xpath="./andreas34_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas34" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="37" _title="Ariadne" _xpath="./andreas40_1" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas40" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="38" _title="Janus" _xpath="./andreas38_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas38" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="39" _title="Odyssey" _xpath="./ant39_1" author="Petr Machata" ctrl="force" easy="false" id="ant39" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="39" _title="Odyssey" _xpath="./ant39_2" author="Petr Machata" ctrl="force" easy="false" id="ant39" rel="2" rev="1" score="2" target="time" unit="duration"/>
     <level _seq="40" _title="- Meditation -" _xpath="./andreas36_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas36" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="41" _title="Laserpowered" _xpath="./raoul20_2" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul20" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="42" _title="Basketball" _xpath="./ral03_2" author="Ronald Lamprecht" ctrl="force" easy="true" id="20060213ral005" rel="2" rev="43" score="2" target="time" unit="duration"/>

Added: trunk/data/levels/enigma_viii/devnull33_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/devnull33_1.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_viii/devnull33_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -0,0 +1,51 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Filler" el:subtitle="" el:id="devnull33"/>
+      <el:version el:score="1" el:release="1" el:revision="3" el:status="released"/>
+      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 dev0</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="7:00"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["AllowSuicide"] = false
+
+ti[" "] = {"fl_wood"}
+ti["#"] = {"st_greenbrown"}
+ti["S"] = {"st_shogun_s"}
+ti["dot"] = {"it_shogun_s", target="bridge%%"}
+ti["bridge"] = {"fl_bridge_bw", name="bridge%%"}
+ti["1"] = {"st_oxyd", "north#"}
+ti["2"] = {"st_oxyd", "south#"}
+ti["3"] = {"st_oxyd", "west#"}
+ti["4"] = {"st_oxyd", "east#"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(res.autotile(ti, {"a", "q", "dot"}, {"A", "Q", "bridge"}), " ", {
+    "##################4#",
+    "#   k q l #   #b #L1",
+    "#i## ###  S   Snd#K1",
+    "#   c  # S####   #J1",
+    "# # #j     @ S SPAB1",
+    "3M#p  ###S### ####C1",
+    "# #     S # SNS  ###",
+    "3O h### S   #S## #D2",
+    "# ## S Sa ### # QFE2",
+    "#g#  #   S#     m#G2",
+    "# # ##### SS#f##o#H2",
+    "#  e             #I2",
+    "##################4#"})
+
+wo:shuffleOxyd({"north#*", max = 0}, {"south#*", max = 0}, {"west#*", "east#*", min = 2})
+    ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/devnull33_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/data/levels/enigma_viii/index.xml
===================================================================
--- trunk/data/levels/enigma_viii/index.xml	2009-06-08 00:05:05 UTC (rev 1713)
+++ trunk/data/levels/enigma_viii/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
@@ -100,6 +100,7 @@
     <level _seq="92" _title="Missing Oxyds?" _xpath="./manfi01_1" author="Manfredi Carta" ctrl="force" easy="true" id="manfi01" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="93" _title="Path Through Flood" _xpath="./pulley24_1" author="Mark Pulley" ctrl="force" easy="false" id="20080803pulley001" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="94" _title="Sunrise Sunset" _xpath="./pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="95" _title="Filler" _xpath="./devnull33_1" author="/dev/null" ctrl="force" easy="false" id="devnull33" rel="1" rev="3" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>



From raoulb at bluewin.ch  Mon Jun  8 02:40:36 2009
From: raoulb at bluewin.ch (Raoul)
Date: Mon, 8 Jun 2009 02:40:36 +0200
Subject: [Enigma-game-svn] r1713, r1714
Message-ID: <20090608024036.78c26996@amarok.loinet.zh>

rel 1713:
-> Filled pento pack with many more pentomino levels from /dev/null

rel 1714:
-> More rewrites mostly from /dev/null
-> Levelpack Enigma IX


From raoul at mail.berlios.de  Sat Jun 13 00:04:01 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 13 Jun 2009 00:04:01 +0200
Subject: [Enigma-game-svn] r1715 - in trunk/data/levels: enigma_cross
	enigma_i enigma_iv enigma_vi enigma_viii
Message-ID: <200906122204.n5CM41FQ017829@sheep.berlios.de>

Author: raoul
Date: 2009-06-13 00:03:59 +0200 (Sat, 13 Jun 2009)
New Revision: 1715

Added:
   trunk/data/levels/enigma_i/alain05_2.xml
   trunk/data/levels/enigma_i/duffy13_2.xml
   trunk/data/levels/enigma_iv/luc01_2.xml
   trunk/data/levels/enigma_vi/just10_4.xml
   trunk/data/levels/enigma_viii/devnull28_1.xml
   trunk/data/levels/enigma_viii/devnull34_1.xml
   trunk/data/levels/enigma_viii/devnull35_1.xml
Removed:
   trunk/data/levels/enigma_i/alain05_1.xml
   trunk/data/levels/enigma_i/duffy13_1.xml
   trunk/data/levels/enigma_iv/luc01_1.xml
   trunk/data/levels/enigma_vi/just10_3.xml
Modified:
   trunk/data/levels/enigma_cross/enigma0_92_1.xml
   trunk/data/levels/enigma_cross/newlevels.xml
   trunk/data/levels/enigma_cross/newlevels_1.0.1.xml
   trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
   trunk/data/levels/enigma_i/index.xml
   trunk/data/levels/enigma_iv/index.xml
   trunk/data/levels/enigma_vi/index.xml
   trunk/data/levels/enigma_viii/index.xml
Log:
-> 3 new levels from /dev/null
-> A few rewrites
-> Shortcutfixes for "Check the light"



Modified: trunk/data/levels/enigma_cross/enigma0_92_1.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="32" title="Enigma 0.92 - 1"/>
+  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="33" title="Enigma 0.92 - 1"/>
 
   <attributes/>
 
@@ -79,7 +79,7 @@
     <level _seq="71" _title="Light Switches" _xpath="enigma_iv/siegfried24_2" author="Siegfried Fennig" ctrl="force" easy="false" id="level8e" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="72" _title="A Narrow Path" _xpath="enigma_i/martin66_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin66" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="73" _title="MetaPuzzle" _xpath="enigma_iv/ant03_2" author="Petr Machata" ctrl="force" easy="false" id="ant03" rel="2" rev="3" score="1" target="time" unit="duration"/>
-    <level _seq="74" _title="Space Tubes" _xpath="enigma_i/duffy13_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy13" rel="1" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="74" _title="Space Tubes" _xpath="enigma_i/duffy13_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy13" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="75" _title="The Cage" _xpath="enigma_v/qq02_2" author="Andrzej Szombierski" ctrl="force" easy="false" id="qq2" rel="2" rev="3" score="2" target="time" unit="duration"/>
     <level _seq="76" _title="Sentinels" _xpath="enigma_ii/siegfried23_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level8d" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="77" _title="The Tomb" _xpath="enigma_iv/ant04_2" author="Petr Machata" ctrl="force" easy="false" id="ant04" rel="2" rev="1" score="2" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_cross/newlevels.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="46" title="Enigma 1.00 new"/>
+  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="47" title="Enigma 1.00 new"/>
 
   <attributes/>
 
@@ -20,7 +20,7 @@
     <level _seq="12" _title="- Meditation -" _xpath="enigma_i/alain04_1" author="Alain Busser" ctrl="force" easy="false" id="alain04" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="13" _title="Light Barrier" _xpath="enigma_i/richi03_1" author="Richi B?tzer" ctrl="force" easy="false" id="richi03" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="14" _title="Dead Ball Walking" _xpath="enigma_i/illmind08_2" author="illmind" ctrl="force" easy="false" id="illmind08" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="15" _title="The Enigmhanoi Towers" _xpath="enigma_i/alain05_1" author="Alain Busser" ctrl="force" easy="true" id="alain05" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="15" _title="The Enigmhanoi Towers" _xpath="enigma_i/alain05_2" author="Alain Busser" ctrl="force" easy="true" id="alain05" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="16" _title="Mirror Room" _xpath="enigma_i/luc12_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc12" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="17" _title="Mirror Room II" _xpath="enigma_i/luc17_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc17" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="18" _title="Castle Maze" _xpath="enigma_i/luc19_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc19" rel="1" rev="0" score="1" target="time" unit="duration"/>
@@ -93,7 +93,7 @@
     <level _seq="85" _title="The Dark Outside" _xpath="enigma_iv/andreas16_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas16" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="86" _title="Bolder Run" _xpath="enigma_iv/just02_1" author="JuSt" ctrl="force" easy="false" id="just02" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="87" _title="Laser Pushing" _xpath="enigma_iv/just04_1" author="JuSt" ctrl="force" easy="false" id="just04" rel="1" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="88" _title="Friction Nightmare" _xpath="enigma_iv/luc01_1" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc01" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="88" _title="Friction Nightmare" _xpath="enigma_iv/luc01_2" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc01" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="89" _title="Laser Games" _xpath="enigma_iv/mp03_1" author="moonpearl" ctrl="force" easy="false" id="mp03" rel="1" rev="10" score="1" target="time" unit="duration"/>
     <level _seq="90" _title="April 1st" _xpath="enigma_v/alain11_1" author="Alain Busser" ctrl="force" easy="false" id="alain11" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="91" _title="Send me the keys !" _xpath="enigma_v/alain09_1" author="Alain Busser" ctrl="force" easy="false" id="alain09" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels_1.0.1.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.0.1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_cross/newlevels_1.0.1.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15500" network="false" owner="Enigma Team" release="1" revision="30" title="Enigma 1.01 new"/>
+  <info enigma="1.00" group="Facets" location="15500" network="false" owner="Enigma Team" release="1" revision="31" title="Enigma 1.01 new"/>
 
   <attributes/>
 
@@ -15,7 +15,7 @@
     <level _seq="7" _title="Playing with Lasers" _xpath="enigma_vi/just09_1" author="JuSt" ctrl="force" easy="false" id="just09_1" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="8" _title="Hot Hurdle Race" _xpath="enigma_vi/ulf04_1" author="Ulf Stegemann" ctrl="force" easy="true" id="20070124ulf019" rel="1" rev="93" score="1" target="time" unit="duration"/>
     <level _seq="9" _title="Counterclockwise" _xpath="enigma_vi/ulf05_2" author="Ulf Stegemann" ctrl="force" easy="true" id="20070126ulf020" rel="2" rev="98" score="1" target="time" unit="duration"/>
-    <level _seq="10" _title="Check the light" _xpath="enigma_vi/just10_3" author="JuSt" ctrl="force" easy="false" id="just10" rel="3" rev="7" score="2" target="time" unit="duration"/>
+    <level _seq="10" _title="Check the light" _xpath="enigma_vi/just10_4" author="JuSt" ctrl="force" easy="false" id="just10" rel="4" rev="9" score="3" target="time" unit="duration"/>
     <level _seq="11" _title="Twokoban I" _xpath="enigma_vi/raoul28_2" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul28" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="12" _title="The Passage" _xpath="enigma_vi/just11_1" author="JuSt" ctrl="force" easy="false" id="just11" rel="1" rev="7" score="1" target="time" unit="duration"/>
     <level _seq="13" _title="Magic Triangle" _xpath="enigma_vi/just13_1" author="JuSt" ctrl="force" easy="false" id="just13" rel="1" rev="1" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="54" title="Enigma 1.1 new"/>
+  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="55" title="Enigma 1.1 new"/>
 
   <attributes/>
 
@@ -175,6 +175,8 @@
     <level _seq="167" _title="Path Through Flood" _xpath="enigma_viii/pulley24_1" author="Mark Pulley" ctrl="force" easy="false" id="20080803pulley001" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="168" _title="Sunrise Sunset" _xpath="enigma_viii/pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="169" _title="Filler" _xpath="enigma_viii/devnull33_1" author="/dev/null" ctrl="force" easy="false" id="devnull33" rel="1" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="170" _title="Help youself I" _xpath="enigma_viii/devnull34_1" author="/dev/null" ctrl="force" easy="true" id="devnull34" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="171" _title="Help youself II" _xpath="enigma_viii/devnull35_1" author="/dev/null" ctrl="force" easy="true" id="devnull35" rel="1" rev="1" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Deleted: trunk/data/levels/enigma_i/alain05_1.xml
===================================================================
--- trunk/data/levels/enigma_i/alain05_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_i/alain05_1.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,125 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="The Enigmhanoi Towers" el:subtitle="" el:id="alain05"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Alain Busser" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2006 Alain Busser</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="true" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="1:12" el:difficult="1:41"/>
-    </el:info>
-    <el:luamain><![CDATA[  
--- Modified fixed by Raoul
-
-levelw = 20
-levelh = 13
-
-create_world(levelw, levelh)
-oxyd_default_flavor = "a"
-draw_border("st-rock1")
-fill_floor("fl-tigris")
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-        if c =="*" then
-            set_stone( "st-rock1", i-1, line)
-        elseif c == "o" then
-            oxyd( i-1, line)
-            elseif c=="z" then
-            set_actor("ac-blackball", i-.5,line+.5, {player=0})
-        elseif c=="a" then
-            document(i-1,line, "text1") 
-        elseif c=="b" then
-            document(i-1,line, "text2") 
-        elseif c=="c" then
-            document(i-1,line, "text3") 
-        elseif c=="+" then
-            set_stone("st-grate1", i-1,line)
-        elseif c=="g" then
-            doorv(i-1,line, {name="door1"})
-        elseif c=="h" then
-            doorv(i-1,line, {name="door2"})
-        elseif c=="f" then
-            set_floor("fl-water",i-1,line)
-        elseif c=="l" then
-            set_floor("fl-leaves",i-1,line)
-             elseif c == "2" then
-                 set_item("it-banana",i-1,line)
-        elseif c == "T" then
-                 set_stone("st-switch",i-1,line, {action="open", target="door1"})
-             elseif c == "S" then
-                 set_stone("st-switch",i-1,line, {action="open", target="door2"})
-        end
-    end    
-end
-
---               01234567890123456789
-renderLine(00 , "                    ")
-renderLine(01 , "  *    a b c     *  ")
-renderLine(02 , "  *              *  ")
-renderLine(03 , "  * ll +++++ lll *  ")
-renderLine(04 , "  * ll +   + lzl *  ")
-renderLine(05 , "  * ll +   + l l *  ")  
-renderLine(06 , "  g ll +++++ lll h  ")
-renderLine(07 , "  *              *  ")
-renderLine(08 , "  *              *  ")
-renderLine(09 , "  f f        fff f  ")
-renderLine(10 , "  fff ff fff f f f  ")
-renderLine(11 , " of f ff f f fff fo ")
-renderLine(12 , "                    ") 
---               01234567890123456789
-
---shogun sektion:
-if difficult then
- set_stone("st-grate1",8,5)
- set_stone("st-grate1",10,5)
- set_stone("st-shogun-sml", 9,5)
- shogundot3(8,4,{action="openclose", target="door1"})
- shogundot3(10,4,{action="openclose", target="door2"})
-elseif not difficult then
- a=random()
- if a<=0.5 then
-  set_stone("st-grate1",8,5)
-  set_stone("st-grate1",10,4)
-  set_stone("st-shogun-sml", 9,5)
-  shogundot3(8,4,{action="openclose", target="door1"})
-  shogundot3(10,5,{action="openclose", target="door2"})
- else
-  set_stone("st-grate1",8,4)
-  set_stone("st-grate1",10,5)
-  set_stone("st-shogun-sml", 9,4)
-  shogundot3(8,5,{action="openclose", target="door1"})
-  shogundot3(10,4,{action="openclose", target="door2"})
- end
-end
-
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="true" el:comment="wordplay between 'enigma' and the 'hanoi towers' solitary game"/>
-        <el:translation el:lang="fr">Les tours d'Enigmhanoi</el:translation>
-      </el:string>
-      <el:string el:key="text1">
-        <el:english el:translate="true">Who speaks, does not know (Lao Tse)</el:english>
-        <el:translation el:lang="fr">Celui qui parle ne sait pas (Lao Tseu)</el:translation>
-      </el:string> 
-      <el:string el:key="text2">
-        <el:english el:translate="true">The wise man laughs (Lao Tse)</el:english>
-        <el:translation el:lang="fr">L'homme sage rit (Lao Tseu)</el:translation>
-      </el:string> 
-      <el:string el:key="text3">
-        <el:english el:translate="true">Who knows, does not speak (Lao Tse)</el:english>
-        <el:translation el:lang="fr">Celui qui sait ne parle pas (Lao Tseu)</el:translation>
-      </el:string> 
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_i/alain05_2.xml (from rev 1714, trunk/data/levels/enigma_i/alain05_1.xml)
===================================================================
--- trunk/data/levels/enigma_i/alain05_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_i/alain05_2.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -0,0 +1,72 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="The Enigmhanoi Towers" el:subtitle="" el:id="alain05"/>
+      <el:version el:score="1" el:release="2" el:revision="3" el:status="released"/>
+      <el:author  el:name="Alain Busser" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2006 Alain Busser</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by /dev/null</el:code></el:comments>
+      <el:score el:easy="1:12" el:difficult="1:41"/>
+    </el:info>
+    <el:luamain><![CDATA[  
+ti[" "] = {"fl_tigris"}
+ti["."] = {"fl_lawn"}
+ti["~"] = {"fl_water"}
+ti["#"] = {"st_granite"}
+ti["X"] = {"st_grate_cross"}
+ti["S"] = {"st_shogun_sml"}
+ti["w"] = {"it_shogun_l", target = "west"}
+ti["e"] = {"it_shogun_l", target = "east"}
+ti["W"] = {"st_door", "west", faces = "ew", state = CLOSED}
+ti["E"] = {"st_door", "east", faces = "ew", state = CLOSED}
+ti["1"] = {"it_document", "anchor", text = "text1"}
+ti["2"] = {"it_document", text = "text2"}
+ti["3"] = {"it_document", text = "text3"}
+ti["O"] = {"st_oxyd_a"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+    "####################",
+    "# #    1 2 3     # #",
+    "# #              # #",
+    "# # ..       ... # #",
+    "# # ..       . at . # #",
+    "# # ..       . . # #",  
+    "# W ..       ... E #",
+    "# #              # #",
+    "# #              # #",
+    "# ~ ~        ~~~ ~ #",
+    "# ~~~ ~~ ~~~ ~ ~ ~ #",
+    "#O~ ~ ~~ ~ ~ ~~~ ~O#",
+    "####################"}) 
+
+if wo["IsDifficult"] then
+    wo:drawMap(ti, no["anchor"] + 2 * S, " ", {"XXXXX", "Xw eX", "XXSXX", "XXXXX"})
+else
+    wo:drawMap(ti, no["anchor"] + 2 * S, " ", {"XXXXX", "XXSeX", "Xw XX", "XXXXX"}, cond(random() < 0.5, MAP_MIRROR_VERTICAL, MAP_IDENT))
+end
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="true" el:comment="wordplay between 'enigma' and the 'hanoi towers' solitary game"/>
+        <el:translation el:lang="fr">Les tours d'Enigmhanoi</el:translation>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Who speaks, does not know (Lao Tse)</el:english>
+        <el:translation el:lang="fr">Celui qui parle ne sait pas (Lao Tseu)</el:translation>
+      </el:string> 
+      <el:string el:key="text2">
+        <el:english el:translate="true">The wise man laughs (Lao Tse)</el:english>
+        <el:translation el:lang="fr">L'homme sage rit (Lao Tseu)</el:translation>
+      </el:string> 
+      <el:string el:key="text3">
+        <el:english el:translate="true">Who knows, does not speak (Lao Tse)</el:english>
+        <el:translation el:lang="fr">Celui qui sait ne parle pas (Lao Tseu)</el:translation>
+      </el:string> 
+    </el:i18n>
+  </el:protected>
+</el:level>

Deleted: trunk/data/levels/enigma_i/duffy13_1.xml
===================================================================
--- trunk/data/levels/enigma_i/duffy13_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_i/duffy13_1.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,115 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Space Tubes" el:subtitle="" el:id="duffy13"/>
-      <el:version el:score="1" el:release="1" el:revision="2" el:status="released"/>
-      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-rooms_wide=2
-rooms_high=2
-
-levelw=1+(19*rooms_wide)
-levelh=1+(12*rooms_high)
-
-create_world( levelw, levelh)
-display.SetFollowMode(display.FOLLOW_SCROLLING)
-
-fill_floor("fl-bluegreen", 0,0,levelw,levelh)
-
-function renderLine( line, pattern)
-    for i=1, strlen(pattern) do
-        local c = strsub( pattern, i, i)
-        if c =="#" then
-            set_stone( "st-greenbrown", i-1, line)
-        elseif c == "o" then
-            oxyd( i-1, line)
-        elseif c == "!" then
-            abyss(i-1,line)
-        elseif c == "=" then
-            fill_floor("fl-bluegreen", i-1,line, 1,1)
-        elseif c == "+" then
-            fill_floor("fl-space", i-1,line, 1,1)
-        elseif c == "a" then
-            set_stone("st-switch", i-1,line, {action="openclose", target="door1"})
-        elseif c == "A" then
-            set_stone("st-door", i-1, line , {name="door1", type="h"})
-        elseif c == "z" then
-            set_actor("ac-blackball", i-1-.5,line+.5)
-        elseif c == "d" then --1-d
-            set_floor("fl-gradient",  i-1,  line, {type=1})
-        elseif c == "u" then --2-u
-            set_floor("fl-gradient",  i-1,  line, {type=2})
-        elseif c == "r" then --3-r
-            set_floor("fl-gradient",  i-1,  line, {type=3})
-        elseif c == "l" then --4-l
-            set_floor("fl-gradient",  i-1,  line, {type=4})
-        elseif c == "1" then --ur
-            set_floor("fl-gradient",  i-1,  line, {type=6})
-        elseif c == "3" then --dl
-            set_floor("fl-gradient",  i-1,  line, {type=5})
-        elseif c == "7" then --dr
-            set_floor("fl-gradient",  i-1,  line, {type=8})
-        elseif c == "9" then --ul
-            set_floor("fl-gradient",  i-1,  line, {type=7})
-        elseif c == "2" then --small ur
-            set_floor("fl-gradient",  i-1,  line, {type=11})
-        elseif c == "4" then --small dl
-            set_floor("fl-gradient",  i-1,  line, {type=9})
-        elseif c == "6" then --small dr
-            set_floor("fl-gradient",  i-1,  line, {type=12})
-        elseif c == "8" then --small ul
-            set_floor("fl-gradient",  i-1,  line, {type=10})
-        end
-    end
-end
-
--- Floor:  " "
--- Border: "#"
--- Oxyd:   "o"
-
-renderLine(00,"#######################################")
-renderLine(01,"#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#")
-renderLine(02,"#!a+==llrr==rr++ll=======r==rr++ll===!#")
-renderLine(03,"#!!!!!!!!!!!!!!!!!!!!!!==r==rr++ll=+=!#")
-renderLine(04,"#!3ddd1!!3ddddd!!dddd1!!!r==rr++ll+++!#")
-renderLine(05,"#!r===2dd4++++++++===l!!!!!#A#!!!!rul!#")
-renderLine(06,"#!r=z=++++++++++++===l!3dd1#=#3d1!rul!#")
-renderLine(07,"#!r===6uu8++++++++===l!r++++++++l!rul!#")
-renderLine(08,"#!9uuu7!!9uuuuu!!r+++l!!u8++3d1+!!rul!#")
-renderLine(09,"#!!!!!!!!!!!!!!!!98+67!!+r++r+l+!!rul!#")
-renderLine(10,"#!==r=l+=r+llll=!!r+l!!!d4++9u7+!!rul!#")
-renderLine(11,"#!=!!!!!!!!!!!!=!!r+l!!!+3d1++6u!!rul!#")
-renderLine(12,"#!===!!!!3dddd4+l!r+l!!!+r+l++l+!!rul!#")
-renderLine(13,"#!===!!!!r++++++l!r+l!!!+9u7++2d!!rul!#")
-renderLine(14,"#!===!!!!r+6uuuu7!r+l!!!++3dd1++!!rul!#")
-renderLine(15,"#!8+6!!!!r+l!!!!!!r+l!!!l+r++l+r!!rul!#")
-renderLine(16,"#!r+l!!!!4+2!!!!!!!+!!!!l+9uu7+r!!rul!#")
-renderLine(17,"#!r+l!!!!===!##!13===8!!++++++++!!rul!#")
-renderLine(18,"#!r+l!!!!===ddu+++===r!r========l!rul!#")
-renderLine(19,"#!r+l!!!!===uud+++===4!o========o!rul!#")
-renderLine(20,"#!r+2dd1!!!!!!!!!!!!!!!!!!!!!!!!!!rul!#")
-renderLine(21,"#!r++++2ddddddlllddddudddduudddudd4ul!#")
-renderLine(22,"#!9uuuuuuuuuuullluuuuduuuudduuuuuduu7!#")
-renderLine(23,"#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#")
-renderLine(24,"#######################################")
-
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_i/duffy13_2.xml (from rev 1714, trunk/data/levels/enigma_i/duffy13_1.xml)
===================================================================
--- trunk/data/levels/enigma_i/duffy13_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_i/duffy13_2.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -0,0 +1,72 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Space Tubes" el:subtitle="" el:id="duffy13"/>
+      <el:version el:score="1" el:release="2" el:revision="3" el:status="released"/>
+      <el:author  el:name="Jacob Scott" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Jacob Scott</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by /dev/null</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["FollowMethod"] = FOLLOW_SCROLL
+
+ti["."] = {"fl_bluegreen"}
+ti["-"] = {"fl_space"}
+ti[" "] = {"fl_abyss"}
+ti["7"] = {"fl_slope_ose"}
+ti["8"] = {"fl_slope_ps"}
+ti["9"] = {"fl_slope_osw"}
+ti["6"] = {"fl_slope_pw"}
+ti["3"] = {"fl_slope_onw"}
+ti["2"] = {"fl_slope_pn"}
+ti["1"] = {"fl_slope_one"}
+ti["4"] = {"fl_slope_pe"}
+ti["u"] = {"fl_slope_ise"}
+ti["i"] = {"fl_slope_isw"}
+ti["m"] = {"fl_slope_inw"}
+ti["n"] = {"fl_slope_ine"}
+ti["#"] = {"st_greenbrown"}
+ti["d"] = {"st_switch", target = "doorD"}
+ti["D"] = {"st_door", "doorD", faces = "ns", state = CLOSED}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, ".", {
+    "#######################################",
+    "#                                     #",
+    "# d-..6644..44--66.......4..44--66... #",
+    "#                      ..4..44--66.-. #",
+    "# 78889  788888  88889   4..44--66--- #",
+    "# 4...i88u--------...6     #D#    426 #",
+    "# 4. at .------------...6 7889#.#789 426 #",
+    "# 4...m22n--------...6 4--------6 426 #",
+    "# 12223  122222  4---6  2n--789-  426 #",
+    "#                1n-m3  -4--4-6-  426 #",
+    "# ..4.6-.4-6666.  4-6   8u--123-  426 #",
+    "# .            .  4-6   -789--m2  426 #",
+    "# ...    78888u-6 4-6   -4-6--6-  426 #",
+    "# ...    4------6 4-6   -123--i8  426 #",
+    "# ...    4-m22223 4-6   --7889--  426 #",
+    "# n-m    4-6      4-6   6-4--6-4  426 #",
+    "# 4-6    u-i       -    6-1223-4  426 #",
+    "# 4-6    ... ## 97...n  --------  426 #",
+    "# 4-6    ...882---...4 4........6 426 #",
+    "# 4-6    ...228---...u O........O 426 #",
+    "# 4-i889                          426 #",
+    "# 4----i88888866688882888822888288u26 #",
+    "# 12222222222266622228222288222228223 #",
+    "#                                     #",
+    "#######################################"})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_i/index.xml
===================================================================
--- trunk/data/levels/enigma_i/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_i/index.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10200" network="false" owner="Enigma Team" release="1" revision="23" title="Enigma I"/>
+  <info enigma="1.00" group="Enigma" location="10200" network="false" owner="Enigma Team" release="1" revision="24" title="Enigma I"/>
 
   <attributes/>
 
@@ -57,7 +57,7 @@
     <level _seq="49" _title="Hall of Glass" _xpath="./martin86_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin86" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="50" _title="- Meditation -" _xpath="./siegfried36_2" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation15" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="51" _title="Deadly Cross" _xpath="./martin84_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin84" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="52" _title="The Enigmhanoi Towers" _xpath="./alain05_1" author="Alain Busser" ctrl="force" easy="true" id="alain05" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="52" _title="The Enigmhanoi Towers" _xpath="./alain05_2" author="Alain Busser" ctrl="force" easy="true" id="alain05" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="53" _title="Mirror Room" _xpath="./luc12_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc12" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="54" _title="Annoying little balls" _xpath="./wb09_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb9" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="55" _title="Mirror Room II" _xpath="./luc17_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc17" rel="2" rev="1" score="1" target="time" unit="duration"/>
@@ -92,7 +92,7 @@
     <level _seq="84" _title="Escher's World" _xpath="./ant09_2" author="Petr Machata" ctrl="force" easy="false" id="ant09" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="85" _title="Balancing Act" _xpath="./nat09_2" author="Nat Pryce" ctrl="force" easy="false" id="nat9" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="86" _title="Floppy Floors" _xpath="./andreas24_2" author="Andreas Lochmann" ctrl="force" easy="true" id="andreas24" rel="2" rev="4" score="1" target="time" unit="duration"/>
-    <level _seq="87" _title="Space Tubes" _xpath="./duffy13_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy13" rel="1" rev="2" score="1" target="time" unit="duration"/>
+    <level _seq="87" _title="Space Tubes" _xpath="./duffy13_2" author="Jacob Scott" ctrl="force" easy="false" id="duffy13" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="88" _title="Balance" _xpath="./erich01_2" author="Erich Schubert" ctrl="force" easy="false" id="balance" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="89" _title="More Space Tubes" _xpath="./duffy33_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy33" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="90" _title="- Meditation -" _xpath="./raoul04_1" author="Raoul Bourquin" ctrl="force" easy="true" id="raoul04" rel="1" rev="1" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_iv/index.xml
===================================================================
--- trunk/data/levels/enigma_iv/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_iv/index.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10500" network="false" owner="Enigma Team" release="1" revision="43" title="Enigma IV"/>
+  <info enigma="1.00" group="Enigma" location="10500" network="false" owner="Enigma Team" release="1" revision="44" title="Enigma IV"/>
 
   <attributes/>
 
@@ -88,7 +88,7 @@
     <level _seq="80" _title="Electric Funeral" _xpath="./ss15_1" author="Sven Siggelkow" ctrl="force" easy="false" id="ss15" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="81" _title="Be Faster!" _xpath="./martin98_2" author="Martin Hawlisch" ctrl="force" easy="true" id="martin98" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="82" _title="Laser Pushing" _xpath="./just04_1" author="JuSt" ctrl="force" easy="false" id="just04" rel="1" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="83" _title="Friction Nightmare" _xpath="./luc01_1" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc01" rel="1" rev="0" score="1" target="time" unit="duration"/>
+    <level _seq="83" _title="Friction Nightmare" _xpath="./luc01_2" author="Lukas Sch?ller" ctrl="force" easy="true" id="luc01" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="84" _title="Prison Yard" _xpath="./nat20_1" author="Nat Pryce" ctrl="force" easy="true" id="nat20" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="85" _title="Bad Nightmare" _xpath="./duffy117_3" author="Jacob Scott" ctrl="force" easy="true" id="duffy117" rel="3" rev="5" score="2" target="time" unit="duration"/>
     <level _seq="86" _title="Laser Games" _xpath="./mp03_1" author="moonpearl" ctrl="force" easy="false" id="mp03" rel="1" rev="10" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_iv/luc01_1.xml
===================================================================
--- trunk/data/levels/enigma_iv/luc01_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_iv/luc01_1.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,63 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Friction Nightmare" el:subtitle="" el:id="luc01"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="released"/>
-      <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
-      <el:copyright>Copyright ? 2005 Lukas Sch?ller</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="0.92">
-      </el:compatibility>
-      <el:modes el:easy="true" el:single="true" el:network="false"/>
-      <el:comments>
-        <el:code>Lua 5.1 and XML converted by Leveladministrators</el:code>
-      </el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
--- Dec.05: Changed floor and friction to match Jacobs Nightmare-pattern, Andreas
-
-function writeLine( line, cells)
-  for i=1, strlen(cells) do
-    local c = strsub(cells,i,i)
-    if(c =="a") then
-      set_stone("st-death",i-1,line)
-    elseif(c =="o") then
-      oxyd(i-1,line)
-    end
-  end
-end
-
-CreateWorld(20,13)
---fill_floor("fl-leaves",0,0,20,13)
-fill_floor("fl-rough-blue",0,0,20,13)
---enigma.FrictionFactor=-0.5
-if difficult then
-  enigma.FrictionFactor=-0.4
-else
-  enigma.FrictionFactor=-0.25
-end
-writeLine(00,"aaaaaaaaaaaaaaaaaaaa")
-writeLine(01,"o                  o")
-writeLine(02,"a  a               a")
-writeLine(03,"a        a         a")
-writeLine(04,"a              a   a")
-writeLine(05,"a                  a")
-writeLine(06,"a     a    a       a")
-writeLine(07,"a                  a")
-writeLine(08,"a       a          a")
-writeLine(09,"a            a     a")
-writeLine(10,"a     a            a")
-writeLine(11,"o                  o")
-writeLine(12,"aaaaaaaaaaaaaaaaaaaa")
-set_actor("ac-blackball",1.5,1.5,{player=0})
-oxyd_shuffle()
-    ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_iv/luc01_2.xml (from rev 1714, trunk/data/levels/enigma_iv/luc01_1.xml)
===================================================================
--- trunk/data/levels/enigma_iv/luc01_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_iv/luc01_2.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -0,0 +1,51 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Friction Nightmare" el:subtitle="" el:id="luc01"/>
+      <el:version el:score="1" el:release="2" el:revision="3" el:status="released"/>
+      <el:author  el:name="Lukas Sch?ller" el:email="Lucky_Luc at web.de" el:homepage=""/>
+      <el:copyright>Copyright ? 2005 Lukas Sch?ller</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:code>
+          Dec.05: Changed floor and friction to match Jacobs Nightmare-pattern, Andreas
+          Jun 09: New API converted by /dev/null
+        </el:code>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["FrictionStrength"] = cond(wo["IsDifficult"], -0.4, -0.25)
+
+ti["#"] = {"st_death"}
+ti[" "] = {"fl_blueslab"}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+    "####################",
+    "O@                 O",
+    "#  #               #",
+    "#        #         #",
+    "#              #   #",
+    "#                  #",
+    "#     #    #       #",
+    "#                  #",
+    "#       #          #",
+    "#            #     #",
+    "#     #            #",
+    "O                  O",
+    "####################"})
+
+wo:shuffleOxyd()
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_vi/index.xml
===================================================================
--- trunk/data/levels/enigma_vi/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_vi/index.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10700" network="false" owner="Enigma Team" release="1" revision="45" title="Enigma VI"/>
+  <info enigma="1.00" group="Enigma" location="10700" network="false" owner="Enigma Team" release="1" revision="46" title="Enigma VI"/>
 
   <attributes/>
 
@@ -72,7 +72,7 @@
     <level _seq="64" _title="Rotor Guards" _xpath="./duffy144_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy144" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="65" _title="Knight's Journey" _xpath="./johannes02_1" author="Johannes Laire" ctrl="force" easy="false" id="20061210johannes313" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="66" _title="A Cooler Spot in Hell" _xpath="./andreas43_3" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas43" rel="4" rev="7" score="3" target="time" unit="duration"/>
-    <level _seq="67" _title="Check the light" _xpath="./just10_3" author="JuSt" ctrl="force" easy="false" id="just10" rel="3" rev="7" score="2" target="time" unit="duration"/>
+    <level _seq="67" _title="Check the light" _xpath="./just10_4" author="JuSt" ctrl="force" easy="false" id="just10" rel="4" rev="9" score="3" target="time" unit="duration"/>
     <level _seq="68" _title="The Passage" _xpath="./just11_1" author="JuSt" ctrl="force" easy="false" id="just11" rel="1" rev="7" score="1" target="time" unit="duration"/>
     <level _seq="69" _title="Devil's Bolder" _xpath="./just14_1" author="JuSt" ctrl="force" easy="true" id="just14" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="70" _title="Twisting by the pool" _xpath="./alain23_1" author="Alain Busser" ctrl="force" easy="true" id="alain23" rel="1" rev="0" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_vi/just10_3.xml
===================================================================
--- trunk/data/levels/enigma_vi/just10_3.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_vi/just10_3.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,91 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Check the light" el:subtitle="how to play chess with lasers" el:id="just10"/>
-      <el:version el:score="2" el:release="3" el:revision="7" el:status="released"/>
-      <el:author  el:name="JuSt" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2007 JuSt</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10"/>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
-      <el:score el:easy="-" el:difficult="1:17"/>
-    </el:info>
-    <el:luamain><![CDATA[
-wo["ConserveLevel"] = false
-
-ti[" "] = {"fl_concrete"}
-ti["~"] = {"fl_water"}
-ti["-"] = {"fl_wood"}
-ti["#"] = {"st_redmarble"}
-ti["R"] = {"st_rawglass"}
-ti["+"] = {"st_box"}
-ti["*"] = ti["-"] .. ti["+"]
-ti["C"] = {"st_chess"}
-ti["B"] = {"st_break_oxydc"}
-ti["I"] = {"st_stoneimpulse"}
-ti["X"] = {"st_grate", flavor="cross"}
-ti["G"] = {"st_grate", flavor="framed"}
-ti["M"] = {"st_mirror", orientation=VERTICAL, movable=true}
-ti["P"] = ti["~"] .. {"st_lightpassenger"}
-ti["L"] = {"st_laserswitch", target="chess"}
-ti["^"] = {"st_laser", orientation=NORTH, state=ON}
-ti[">"] = {"st_laser", orientation=EAST, state=ON}
-ti["V"] = {"st_laser", orientation=SOUTH, state=ON}
-ti["<"] = {"st_laser", orientation=WEST, state=ON}
-ti["1"] = {"st_laser", orientation=WEST, name="laser1", state=ON}
-ti["2"] = {"st_laser", orientation=EAST, name="laser2", state=ON}
-ti["3"] = {"st_laser", orientation=NORTH, name="laser3"}
-ti["="] = {"st_door", flavor="d", faces="ns", name="door1"}
-ti["D"] = {"st_door", flavor="a", name="door2#"}
-ti["S"] = {"st_switch", target="dry"}
-ti["x"] = {"fl_bridge", name="bridge"} .. ti["X"]
-ti["a"] = {"it_trigger", target="door1", action="open"}
-ti["b"] = {"it_trigger", target="door1", action="close"}
-ti["c"] = {"it_trigger", action={"open", "on"}, target={"door2#*", "laser3"}}
-ti["t"] = {"it_document", text="text1"}
-ti["s"] = ti["~"] .. ti["G"] .. {"it_seed"}
-ti["O"] = {"st_oxyd"}
-ti["@"] = {"#ac_marble_black"}
-
-wo(ti, " ", {
-    "###Va+IIII########O#",
-    "#V#R##V##I#@#    B O",
-    "#~~~~~~<#I#      # O",
-    "#P#=#~ X#I2 # t  # O",
-    "#~#I#~ X#I# #    #D#",
-    "#~#IL~ X1I# #  C  s#",
-    "#~#II~ XRIBM#     G#",
-    "#~#+#~ x#B#  C    G#",
-    "#~#b#~           G #",
-    "#~# #~ X      #D##G#",
-    "#~###~ ######BS ##3#",
-    ">~~~~~~*~*~*~*~~~~c#",
-    "#####^##############"})
-
-wo:shuffleOxyd()
-
-function chess(value, sender)
-    if st(sender+E):is("st_chess") then
-        no["bridge"]:close()
-        grp(no["laser1"], no["laser2"]):off()
-    end
-end
-
-function dry(value, sender)
-    sender["target"] = DEFAULT
-    wo:drawMap(ti, po(5, 3), " ", {"-","-","-","-","-","-","-","-"})
-end
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-      <el:string el:key="text1">
-        <el:english el:translate="true">Are chess knights resistent to laser beams?</el:english>
-        <el:translation el:lang="de">Ob Schachfiguren laserresistent sind?</el:translation>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_vi/just10_4.xml (from rev 1714, trunk/data/levels/enigma_vi/just10_3.xml)
===================================================================
--- trunk/data/levels/enigma_vi/just10_3.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_vi/just10_4.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -0,0 +1,109 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Check the light" el:subtitle="how to play chess with lasers" el:id="just10"/>
+      <el:version el:score="3" el:release="4" el:revision="9" el:status="released"/>
+      <el:author  el:name="JuSt" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2007 JuSt</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="1:17"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ConserveLevel"] = false
+
+ti[" "] = {"fl_concrete"}
+ti["~"] = {"fl_water"}
+ti["-"] = {"fl_wood"}
+ti["#"] = {"st_redmarble"}
+ti["R"] = {"st_rawglass"}
+ti["+"] = {"st_box"}
+ti["*"] = ti["-"] .. ti["+"]
+ti["C"] = {"st_chess"}
+ti["B"] = {"st_break_oxydc"}
+ti["I"] = {"st_stoneimpulse"}
+ti["X"] = {"st_grate", flavor="cross"}
+ti["G"] = {"st_grate", flavor="framed"}
+ti["M"] = {"st_mirror", orientation=VERTICAL, movable=true}
+ti["P"] = ti["~"] .. {"st_lightpassenger"}
+ti["L"] = {"st_laserswitch", target="check_first_chess"}
+ti["J"] = {"st_laserswitch", target="check_second_chess"}
+ti["K"] = {"st_laserswitch", target="check_mirror"}
+ti["="] = {"st_door", flavor="d", faces="ns", name="door1"}
+ti["D"] = {"st_door", flavor="a", name="door2#"}
+ti["Y"] = ti["~"] .. {"st_door", flavor="a", name="door3", state=CLOSED}
+ti["Z"] = {"st_door", flavor="a", name="door4", state=OPEN}
+ti["^"] = {"st_laser", orientation=NORTH, state=ON}
+ti[">"] = {"st_laser", orientation=EAST, state=ON}
+ti["V"] = {"st_laser", orientation=SOUTH, state=ON}
+ti["<"] = {"st_laser", orientation=WEST, state=ON}
+ti["1"] = {"st_laser", orientation=WEST, name="laser1", state=ON}
+ti["2"] = {"st_laser", orientation=EAST, name="laser2", state=ON}
+ti["3"] = {"st_laser", orientation=NORTH, name="laser3"}
+ti["4"] = {"st_laser", orientation=WEST, name="laser4", state=ON}
+ti["S"] = {"st_switch", target="dry"}
+ti["x"] = {"fl_bridge", name="bridge"} .. ti["X"]
+ti["a"] = {"it_trigger", target="door1", action="open"}
+ti["b"] = {"it_trigger", target="door1", action="close"}
+ti["c"] = {"it_trigger", action={"open", "open", "on"}, target={"door2#*", "door4", "laser3"}}
+ti["t"] = {"it_document", text="text1"}
+ti["s"] = ti["~"] .. ti["G"] .. {"it_seed"}
+ti["O"] = {"st_oxyd"}
+ti["@"] = {"#ac_marble_black"}
+
+wo(ti, " ", {
+    "###Va+IIII########O#",
+    "#V#R##V##I#@#    B O",
+    "#~~~~~~<#I#      # O",
+    "#P#=#~ X#I2 # t  # O",
+    "#~#I#~ X#I# #    #D#",
+    "#~#IL~ Z1I# #  C  s#",
+    "#~#II~ XYIBM#     G#",
+    "#~#+J~ x4B#  C    G#",
+    "#~#b#~           G #",
+    "#~# #~ X      #D##G#",
+    "#~###~ ######BS ##3#",
+    ">~~~~~~*~*~*~*~~~~c#",
+    "#####^K#############"})
+
+wo:shuffleOxyd()
+
+function check_first_chess(value, sender)
+    if st(sender+E):is("st_chess") then
+        no["bridge"]:close()
+        grp(no["laser1"], no["laser2"]):off()
+    end
+end
+
+function check_second_chess(value, sender)
+    if st(sender+E):is("st_chess") then
+        no["laser4"]:off()
+    end
+end
+
+function check_mirror(value, sender)
+    if st(sender+4*N):is("st_mirror") then
+        no["door4"]:close()
+        no["door3"]:open()
+    end
+end
+
+function dry(value, sender)
+    sender["target"] = DEFAULT
+    wo:drawMap(ti, po(5, 3), " ", {"-","-","-","-","-","-","-","-"})
+end
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Are chess knights resistent to laser beams?</el:english>
+        <el:translation el:lang="de">Ob Schachfiguren laserresistent sind?</el:translation>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Added: trunk/data/levels/enigma_viii/devnull28_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/devnull28_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_viii/devnull28_1.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -0,0 +1,59 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Two Is A Company IV" el:subtitle="" el:id="devnull28"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
+      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2008 dev0</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="false" el:single="true" el:network="true"/>
+      <el:score el:easy="-" el:difficult="6:54"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ConserveLevel"] = false
+wo["ProvideExtralifes"] = false
+
+ti["#"] = {"st_redrock"}
+ti[" "] = {"fl_concrete"}
+ti["~"] = {"fl_water"}
+ti["R"] = {"st_box_rock"}
+ti["box"] = {"st_box_rock", "box%%"}
+ti["pull"] = {"st_pull", "pull%%"}
+ti["B"] = {"st_box_rock", "black"}
+ti["W"] = {"st_box_rock", "white"}
+ti["o"] = {"st_oxyd_a", name = "left#", static = true}
+ti["O"] = {"st_oxyd_a", name = "right#", static = true}
+ti["@"] = {"#ac_marble_black", essential = INDISPENSIBLE}
+ti["*"] = {"#ac_marble_white", essential = INDISPENSIBLE}
+
+local resolver = res.autotile(ti, {"1", "2", "box"}, {"3", "4", "pull"})
+wo(resolver, " ", {
+    "####################",
+    "#          ~~~~~# @#",
+    "# ###      ~~~~~#32#",
+    "#   #~~~~~~~~~~## ~#",
+    "#   #~~~~~~~~~~#   #",
+    "###~#~~~~BO~~~~# # #",
+    "#   #~~~~oO~~~~#   #",
+    "# R #~~~~oW~~~~###~#",
+    "# ~ #~~~~~~~~~~# RR#",
+    "#~###~~~~~~~~~~#   #",
+    "#41 #~~~~      #####",
+    "#*  #~~~~          #",
+    "####################"})
+
+wo:shuffleOxyd({"left#*", max = 0}, {"right#*", max = 0})
+wo:add({"ot_wire", anchor1 = "box%1", anchor2 = "pull%1"})
+wo:add({"ot_wire", anchor1 = "pull%1", anchor2 = "black"})
+wo:add({"ot_wire", anchor1 = "box%2", anchor2 = "pull%2"})
+wo:add({"ot_wire", anchor1 = "pull%2", anchor2 = "white"})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/devnull28_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_viii/devnull34_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/devnull34_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_viii/devnull34_1.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -0,0 +1,52 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Help youself I" el:subtitle="" el:id="devnull34"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
+      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 dev0</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:score el:easy="3:00" el:difficult="5:00"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_rock"}
+ti["-"] = {"fl_water"}
+ti["#"] = ti["-"] .. {"st_redrock"}
+ti["~"] = cond(wo["IsDifficult"], ti["-"], ti["#"])
+ti["."] = cond(wo["IsDifficult"], ti["-"], ti[" "])
+ti["R"] = {"st_box_rock"}
+ti["S"] = {"st_granite_movable"}
+ti["X"] = {"st_grate_cross"}
+ti["box"] = {"st_box_hay", "box%%"}
+ti["pull"] = {"st_pull", "pull%%"}
+ti["O"] = {"st_oxyd_a", static = true, oxydcolor = OXYD_RED}
+ti["@"] = {"#ac_marble_black", essential = INDISPENSIBLE}
+
+wo(res.autotile(ti, {"1", "2", "box"}, {"3", "4", "pull"}), " ", {
+    "####################",
+    "#        -#- ~     #",
+    "#        -#~   #   #",
+    "# 3 @     -   ~# 1 #",
+    "#        -#~   #   #",
+    "#        -#- ~     #",
+    "##################X#",
+    "# ~R   --#         #",
+    "#      --#         #",
+    "# 4  ~--R-    S  2 #",
+    "#   .~---#         #",
+    "O-  R~---#         #",
+    "#O##################"})
+
+wo:add({"ot_wire", anchor1 = "box%1", anchor2 = "pull%1"})
+wo:add({"ot_wire", anchor1 = "box%2", anchor2 = "pull%2"})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/devnull34_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/levels/enigma_viii/devnull35_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/devnull35_1.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_viii/devnull35_1.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -0,0 +1,51 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Help youself II" el:subtitle="" el:id="devnull35"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
+      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 dev0</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:score el:easy="3:00" el:difficult="5:00"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_rock"}
+ti["-"] = {"fl_water"}
+ti["#"] = ti({"fl_abyss"}) .. {"st_rawglass"}
+ti["~"] = cond(wo["IsDifficult"], ti["-"], ti["#"])
+ti["."] = cond(wo["IsDifficult"], ti["-"], ti[" "])
+ti["X"] = {"st_grate_cross"}
+ti["R"] = {"st_box_rock"}
+ti["box"] = {"st_box_hay", "box%%"}
+ti["pull"] = {"st_pull", "pull%%"}
+ti["O"] = {"st_oxyd_a", static = true, oxydcolor = OXYD_RED}
+ti["@"] = {"#ac_marble_black", essential = INDISPENSIBLE}
+
+wo(res.autotile(ti, {"1", "2", "box"}, {"3", "4", "pull"}), " ", {
+    "####################",
+    "#         #        #",
+    "# 3       # ~  ~   #",
+    "#         - ~  ~  ~#",
+    "# @       # ~   #  #",
+    "#         #     ~  #",
+    "################# ##",
+    "#  .#.    # #      #",
+    "#  .R-  ###    ##~##",
+    "#   #  R-XX   ~    #",
+    "#R  #   ###  #   1 #",
+    "#-  #     #        #",
+    "O4################2O"})
+
+wo:add({"ot_wire", anchor1 = "box%1", anchor2 = "pull%1"})
+wo:add({"ot_wire", anchor1 = "box%2", anchor2 = "pull%2"})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_viii/devnull35_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/data/levels/enigma_viii/index.xml
===================================================================
--- trunk/data/levels/enigma_viii/index.xml	2009-06-08 00:37:30 UTC (rev 1714)
+++ trunk/data/levels/enigma_viii/index.xml	2009-06-12 22:03:59 UTC (rev 1715)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="49" title="Enigma VIII"/>
+  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="50" title="Enigma VIII"/>
 
   <attributes/>
 
@@ -101,6 +101,9 @@
     <level _seq="93" _title="Path Through Flood" _xpath="./pulley24_1" author="Mark Pulley" ctrl="force" easy="false" id="20080803pulley001" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="94" _title="Sunrise Sunset" _xpath="./pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="95" _title="Filler" _xpath="./devnull33_1" author="/dev/null" ctrl="force" easy="false" id="devnull33" rel="1" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="96" _title="Two Is A Company IV" _xpath="./devnull28_1" author="/dev/null" ctrl="force" easy="false" id="devnull28" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="97" _title="Help youself I" _xpath="./devnull34_1" author="/dev/null" ctrl="force" easy="true" id="devnull34" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="98" _title="Help youself II" _xpath="./devnull35_1" author="/dev/null" ctrl="force" easy="true" id="devnull35" rel="1" rev="1" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>



From ral at mail.berlios.de  Sat Jun 13 00:19:26 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Sat, 13 Jun 2009 00:19:26 +0200
Subject: [Enigma-game-svn] r1716 - in trunk/doc/reference: . images
Message-ID: <200906122219.n5CMJQDc018730@sheep.berlios.de>

Author: ral
Date: 2009-06-13 00:19:19 +0200 (Sat, 13 Jun 2009)
New Revision: 1716

Modified:
   trunk/doc/reference/enigma-ref.texi
   trunk/doc/reference/images/Makefile.am
Log:
Trunk 1.1: refman
- stone images part I
- assert usage in stable and released status

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-12 22:03:59 UTC (rev 1715)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-12 22:19:19 UTC (rev 1716)
@@ -7464,12 +7464,18 @@
 @item @b{Details:}
 Assertions help you to detect coding errors. They are heavily used on argument
 checks of library functions and resolver implementations. As the assertions
-should not lead to performance penalties during runtime they are just evaluated
-when the level's @samp{status} is declared in the XML header element @ref{<version>}
-with a value of either @code{"test"} or @code{"experimental"}. For @code{"stable"} 
-and @code{"released"} levels assert statements are simply skipped on compilation
-like Lua comments.
+should not lead to performance penalties during runtime they are usually just
+evaluated when the level's @samp{status} is declared in the XML header element 
+ at ref{<version>} with a value of either @code{"test"} or @code{"experimental"}. 
 
+For @code{"stable"} and @code{"released"} levels standard assert statements are
+simply skipped on compilation like Lua comments. But you can enforce assert
+statements to be executed even in these modes by the following pattern of
+assignment and additional braces:
+ at example
+ at var{dummy} = (@i{assert_bool})(@i{no}["@var{mystone}"]:@b{exists}(), "@var{Stone 'mystone' has disappeared.}")
+ at end example
+
 Similar to @ref{cond}, all side effects within the evaluation of @samp{message}
 and @samp{level} will appear.
 
@@ -7518,12 +7524,18 @@
 @item @b{Details:}
 Assertions help you to detect coding errors. They are heavily used on argument
 checks of library functions and resolver implementations. As the assertions
-should not lead to performance penalties during runtime they are just evaluated
-when the level's @samp{status} is declared in the XML header element @ref{<version>}
-with a value of either @code{"test"} or @code{"experimental"}. For @code{"stable"} 
-and @code{"released"} levels assert statements are simply skipped on compilation
-like Lua comments.
+should not lead to performance penalties during runtime they are usually just
+evaluated when the level's @samp{status} is declared in the XML header element
+ at ref{<version>} with a value of either @code{"test"} or @code{"experimental"}. 
 
+For @code{"stable"} and @code{"released"} levels standard assert statements are
+simply skipped on compilation like Lua comments. But you can enforce assert
+statements to be executed even in these modes by the following pattern of
+assignment and additional braces:
+ at example
+ at var{dummy} = (@i{assert_type})(@var{arg1}, "@var{myfunction first argument}", @var{1}, "@b{integer}")
+ at end example
+
 Possible types are all Lua types (like @code{"nil"}, @code{"number"},
 @code{"boolean"}, @code{"string"}, @code{"table"}, @code{"function"}) except
 @code{"userdata"}, all Enigma-own user types (@code{"object"},
@@ -13838,25 +13850,64 @@
 WORK IN PROGRESS - The follwing table is still incomplete!
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
 @item @image{images/st_ancient} @tab @yref{st_ancient}
+ at tab @image{images/st_beads} @tab @yref{st_beads}
 @tab @image{images/st_bluegray} @tab @yref{st_bluegray}
+ at item @image{images/st_blur_cross} @tab @yref{st_blur}_cross
+ at tab @image{images/st_blur_straight} @tab @yref{st_blur}_straight
+ at tab @image{images/st_brake} @tab @yref{st_brake}
+ at item @image{images/st_break_black} @tab @yref{st_break}_black
+ at tab @image{images/st_break_boulder} @tab @yref{st_break}_boulder
+ at tab @image{images/st_break_oxydc} @tab @yref{st_break}_oxydc
+ at item @image{images/st_break_plain} @tab @yref{st_break}_plain
+ at tab @image{images/st_break_white} @tab @yref{st_break}_white
 @tab @image{images/st_brownie} @tab @yref{st_brownie}
 @item @image{images/st_brownmarble} @tab @yref{st_brownmarble}
+ at tab @image{images/st_brownpyramide} @tab @yref{st_brownpyramide}
 @tab @image{images/st_camouflage} @tab @yref{st_camouflage}
- at tab @image{images/st_concrete} @tab @yref{st_concrete}
- at item @image{images/st_darkgray} @tab @yref{st_darkgray}
- at tab @image{images/st_granite} @tab @yref{st_granite}
+ at item @image{images/st_concrete} @tab @yref{st_concrete}
+ at tab @image{images/st_darkglass} @tab @yref{st_darkglass}
+ at tab @image{images/st_darkgray} @tab @yref{st_darkgray}
+ at item @image{images/st_death} @tab @yref{st_death}
+ at tab @image{images/st_dispenser_bombblack} @tab @yref{st_dispenser}_bombblack
+ at tab @image{images/st_dispenser_bombwhite} @tab @yref{st_dispenser}_bombwhite
+ at item @image{images/st_dispenser_dynamite} @tab @yref{st_dispenser}_dynamite
+ at tab @image{images/st_flash} @tab @yref{st_flash}
+ at tab @image{images/st_flat} @tab @yref{st_flat}
+ at item @image{images/st_granite} @tab @yref{st_granite}
+ at tab @image{images/st_grate_cross} @tab @yref{st_grate}_cross
+ at tab @image{images/st_grate_framed} @tab @yref{st_grate}_framed
+ at item @image{images/st_greenbrown} @tab @yref{st_greenbrown}
 @tab @image{images/st_greengray} @tab @yref{st_greengray}
+ at tab @image{images/st_ice} @tab @yref{st_ice}
 @item                            @tab @yref{st_invisible}
+ at tab @image{images/st_jamb_black} @tab @yref{st_jamb}_black
+ at tab @image{images/st_jamb_white} @tab @yref{st_jamb}_white
+ at item @image{images/st_lightglass} @tab @yref{st_lightglass}
 @tab @image{images/st_metal} @tab @yref{st_metal}
+ at tab @image{images/st_oxyda} @tab @yref{st_oxyd}_a
+ at item @image{images/st_oxydb} @tab @yref{st_oxyd}_b
+ at tab @image{images/st_oxydc} @tab @yref{st_oxyd}_c
+ at tab @image{images/st_oxydd} @tab @yref{st_oxyd}_d
+ at item @image{images/st_oxyde} @tab @yref{st_oxyd}_e
 @tab @image{images/st_pinkbumps} @tab @yref{st_pinkbumps}
- at item @image{images/st_purplegray} @tab @yref{st_purplegray}
- at tab @image{images/st_purplemarble} @tab @yref{st_purplemarble}
- at tab @image{images/st_redbrown} @tab @yref{st_redbrown}
- at item @image{images/st_redmarble} @tab @yref{st_redmarble}
- at tab @image{images/st_redrock} @tab @yref{st_redrock}
- at tab @image{images/st_tigris} @tab @yref{st_tigris}
- at item @image{images/st_woven} @tab @yref{st_woven}
+ at tab @image{images/st_plaster} @tab @yref{st_plaster}
+ at item @image{images/st_plop_slate} @tab @yref{st_plop}_slate
+ at tab @image{images/st_portal_horse} @tab @yref{st_portal}
+ at tab @image{images/st_purplegray} @tab @yref{st_purplegray}
+ at item @image{images/st_purplemarble} @tab @yref{st_purplemarble}
+ at tab @image{images/st_rawglass} @tab @yref{st_rawglass}
+ at tab @image{images/st_rawglass_quad} @tab @yref{st_rawglass}_quad
+ at item @image{images/st_redbrown} @tab @yref{st_redbrown}
+ at tab @image{images/st_redfiber} @tab @yref{st_redfiber}
+ at tab @image{images/st_redmarble} @tab @yref{st_redmarble}
+ at item @image{images/st_redrock} @tab @yref{st_redrock}
+ at tab @image{images/st_spitter_idle} @tab @yref{st_spitter}
+ at tab @image{images/st_surprise} @tab @yref{st_surprise}
+ at item @image{images/st_tigris} @tab @yref{st_tigris}
+ at tab @image{images/st_woven} @tab @yref{st_woven}
 @tab @image{images/st_yellow} @tab @yref{st_yellow}
+ at item @image{images/st_yinyang} @tab @yref{st_yinyang}
+ at tab @image{images/st_yinyang_inactive} @tab @yref{st_yinyang}_inactive 
 @end multitable
 
 @c ----------------- Stone Attributes --------------------
@@ -14634,10 +14685,9 @@
 
 @item @b{Messages:} none
 
- at item @b{Variants:}
-
+ at item @b{Variants:} 
 @table @asis
- at item @b{st_beads}
+ at item @image{images/st_beads} @b{st_beads}
 @end table
 
 @end table
@@ -14756,10 +14806,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_blur}: flavor = @code{"straight"}
- at item @b{st_blur_straight}: flavor = @code{"straight"}
- at item @b{st_blur_cross}: flavor = @code{"cross"}
- at item @b{st_blur_magic}: flavor = @code{"magic"}
+ at item @image{images/st_blur_straight} @b{st_blur}: flavor = @code{"straight"}
+ at item @image{images/st_blur_straight} @b{st_blur_straight}: flavor = @code{"straight"}
+ at item @image{images/st_blur_cross} @b{st_blur_cross}: flavor = @code{"cross"}
+ at item @image{images/st_blur_cross} @b{st_blur_magic}: flavor = @code{"magic"}
 @end table
 
 @end table
@@ -14939,7 +14989,11 @@
 
 @item @b{Action:} none
 
+ at item @b{Variants:} none
+ at table @asis
+ at item @image{images/st_brake} @b{st_brake}
 @end table
+ at end table
 
 @c ----------------- Break Stone --------------------
 @node st_break
@@ -14998,14 +15052,14 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_break}: flavor=@code{"plain"}
- at item @b{st_break_plain}: flavor=@code{"plain"}
- at item @b{st_break_black}: flavor=@code{"black"}
- at item @b{st_break_white}: flavor=@code{"white"}
- at item @b{st_break_oxydc}: flavor=@code{"oxydc"}
- at item @b{st_break_boulder}: flavor=@code{"boulder"}
- at item @b{st_break_bug}: flavor=@code{"bug"}
- at item @b{st_break_laser}: flavor=@code{"laser"}
+ at item @image{images/st_break_plain} @b{st_break}: flavor=@code{"plain"}
+ at item @image{images/st_break_plain} @b{st_break_plain}: flavor=@code{"plain"}
+ at item @image{images/st_break_black} @b{st_break_black}: flavor=@code{"black"}
+ at item @image{images/st_break_white} @b{st_break_white}: flavor=@code{"white"}
+ at item @image{images/st_break_oxydc} @b{st_break_oxydc}: flavor=@code{"oxydc"}
+ at item @image{images/st_break_boulder} @b{st_break_boulder}: flavor=@code{"boulder"}
+ at item @image{images/fl_white} @b{st_break_bug}: flavor=@code{"bug"}
+ at item @image{images/fl_white} @b{st_break_laser}: flavor=@code{"laser"}
 @end table
 
 @end table
@@ -15022,7 +15076,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @b{st_brownpyramide}
+ at item @image{images/st_brownpyramide} @b{st_brownpyramide}
 @end table
 @end table
 
@@ -15239,11 +15293,10 @@
 @item @b{Messages:} none
 
 @item @b{Variants:}
-
 @table @asis
- at item @b{st_darkglass}: hollow = @code{false}, movable = @code{false}
- at item @b{st_darkglass_hollow}: hollow = @code{true}, movable = @code{false}
- at item @b{st_darkglass_movable}: hollow = @code{false}, movable = @code{true}
+ at item @image{images/st_darkglass} @b{st_darkglass}: hollow = @code{false}, movable = @code{false}
+ at item @image{images/st_darkglass} @b{st_darkglass_hollow}: hollow = @code{true}, movable = @code{false}
+ at item @image{images/st_darkglass} @b{st_darkglass_movable}: hollow = @code{false}, movable = @code{true}
 @end table
 
 @end table
@@ -15313,9 +15366,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{st_death}: invisible = @code{false}
- at item @b{st_death_invisible}: invisible = @code{true}
- at item @b{st_death_movable}: movable = @code{true}
+ at item @image{images/st_death} @b{st_death}: invisible = @code{false}
+ at item @image{images/fl_white} @b{st_death_invisible}: invisible = @code{true}
+ at item @image{images/st_death_light} @b{st_death_movable}: movable = @code{true}
 @end table
 
 @end table
@@ -15412,10 +15465,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_dispenser}: flavor=@code{"bombblack"}
- at item @b{st_dispenser_bombblack}: flavor=@code{"bombblack"}
- at item @b{st_dispenser_bombwhite}: flavor=@code{"bombwhite"}
- at item @b{st_dispenser_dynamite}: flavor=@code{"dynamite"}
+ at item @image{images/st_dispenser_bombblack} @b{st_dispenser}: flavor=@code{"bombblack"}
+ at item @image{images/st_dispenser_bombblack} @b{st_dispenser_bombblack}: flavor=@code{"bombblack"}
+ at item @image{images/st_dispenser_bombwhite} @b{st_dispenser_bombwhite}: flavor=@code{"bombwhite"}
+ at item @image{images/st_dispenser_dynamite} @b{st_dispenser_dynamite}: flavor=@code{"dynamite"}
 @end table
 
 @end table
@@ -15603,7 +15656,11 @@
 
 @item @b{Action:}  none
 
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_flash} @b{st_flash}:
 @end table
+ at end table
 
 @c ----------------- Flat Stone --------------------
 @node st_flat
@@ -15653,18 +15710,16 @@
 @item @b{Action:} none
 
 @item @b{Variants:}
-
 @table @asis
- at item @b{st_flat}:
- at item @b{st_flat_hollow}: hollow=@code{true}
- at item @b{st_flat_movable}: movable=@code{"true"}
+ at item @image{images/st_flat} @b{st_flat}:
+ at item @image{images/st_flat} @b{st_flat_hollow}: hollow=@code{true}
+ at item @image{images/st_flat} @b{st_flat_movable}: movable=@code{"true"}
 @item @b{st_flat_breakable}: breakable=@code{"true"}
 @item @b{st_flat_cracked}: 
 @item @b{st_flat_burnable}: burnable=@code{"true"}
 @item @b{st_flat_moveburnable}: movable=@code{"true"}, burnable=@code{"true"}
 @item @b{st_flat_breaking}: breakable=@code{"true"}
 @end table
-
 @end table
 
 @c ----------------- Floppy Stone --------------------
@@ -15840,9 +15895,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_grate}: flavor=@code{"cross"}
- at item @b{st_grate_cross}: flavor=@code{"cross"}
- at item @b{st_grate_framed}: flavor=@code{"framed"}
+ at item @image{images/st_grate_cross} @b{st_grate}: flavor=@code{"cross"}
+ at item @image{images/st_grate_cross} @b{st_grate_cross}: flavor=@code{"cross"}
+ at item @image{images/st_grate_framed} @b{st_grate_framed}: flavor=@code{"framed"}
 @end table
 
 @end table
@@ -15866,10 +15921,10 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @b{st_greenbrown}
- at item @b{st_greenbrown_hollow}
- at item @b{st_greenbrown_movable}
- at item @b{st_greenbrown_growing}
+ at item @image{images/st_greenbrown} @b{st_greenbrown}
+ at item @image{images/st_greenbrown} @b{st_greenbrown_hollow}
+ at item @image{images/st_greenbrown} @b{st_greenbrown_movable}
+ at item @image{images/fl_white} @b{st_greenbrown_growing}
 @end table
 @end table
 
@@ -15949,7 +16004,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{st_ice}
+ at item @image{images/st_ice} @b{st_ice}
 @end table
 @end table
 
@@ -16016,9 +16071,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_jamb}: color=@code{BLACK}
- at item @b{st_jamb_black}: color=@code{BLACK}
- at item @b{st_jamb_white}: color=@code{WHITE}
+ at item @image{images/st_jamb_black} @b{st_jamb}: color=@code{BLACK}
+ at item @image{images/st_jamb_black} @b{st_jamb_black}: color=@code{BLACK}
+ at item @image{images/st_jamb_white} @b{st_jamb_white}: color=@code{WHITE}
 @end table
 
 @end table
@@ -16256,9 +16311,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_lightglass}: hollow = @code{false}, movable = @code{false}
- at item @b{st_lightglass_hollow}: hollow = @code{true}, movable = @code{false}
- at item @b{st_lightglass_movable}: hollow = @code{false}, movable = @code{true}
+ at item @image{images/st_lightglass} @b{st_lightglass}: hollow = @code{false}, movable = @code{false}
+ at item @image{images/st_lightglass} @b{st_lightglass_hollow}: hollow = @code{true}, movable = @code{false}
+ at item @image{images/st_lightglass} @b{st_lightglass_movable}: hollow = @code{false}, movable = @code{true}
 @end table
 
 @end table
@@ -16759,12 +16814,12 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_oxyd}: flavor = @code{"b"}
- at item @b{st_oxyd_a}: flavor = @code{"a"}
- at item @b{st_oxyd_b}: flavor = @code{"b"}
- at item @b{st_oxyd_c}: flavor = @code{"c"}
- at item @b{st_oxyd_d}: flavor = @code{"d"}
- at item @b{st_oxyd_e}: flavor = @code{"e"}
+ at item @image{images/st_oxydb} @b{st_oxyd}: flavor = @code{"b"}
+ at item @image{images/st_oxyda} @b{st_oxyd_a}: flavor = @code{"a"}
+ at item @image{images/st_oxydb} @b{st_oxyd_b}: flavor = @code{"b"}
+ at item @image{images/st_oxydc} @b{st_oxyd_c}: flavor = @code{"c"}
+ at item @image{images/st_oxydd} @b{st_oxyd_d}: flavor = @code{"d"}
+ at item @image{images/st_oxyde} @b{st_oxyd_e}: flavor = @code{"e"}
 @end table
 
 @end table
@@ -16853,11 +16908,11 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_plaster}:
- at item @b{st_plaster_hollow}: hollow=@code{true}
- at item @b{st_plaster_movable}: movable=@code{"true"}
- at item @b{st_plaster_breakable}: breakable=@code{"true"}
- at item @b{st_plaster_movebreakable}: movable=@code{"true"}, breakable=@code{"true"}
+ at item @image{images/st_plaster} @b{st_plaster}:
+ at item @image{images/st_plaster} @b{st_plaster_hollow}: hollow=@code{true}
+ at item @image{images/st_plaster} @b{st_plaster_movable}: movable=@code{"true"}
+ at item @image{images/st_plaster} @b{st_plaster_breakable}: breakable=@code{"true"}
+ at item @image{images/st_plaster} @b{st_plaster_movebreakable}: movable=@code{"true"}, breakable=@code{"true"}
 @end table
 
 @end table
@@ -16880,8 +16935,8 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @b{st_plop}
- at item @b{st_plop_slate}
+ at item @image{images/st_plop_slate} @b{st_plop}
+ at item @image{images/st_plop_slate} @b{st_plop_slate}
 @end table
 @end table
 
@@ -16953,9 +17008,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_portal}: flavor=@code{"horse"}
- at item @b{st_portal_horse}: flavor=@code{"horse"}
- at item @b{st_portal_pearl}: flavor=@code{"pearl"}
+ at item @image{images/st_portal_horse} @b{st_portal}: flavor=@code{"horse"}
+ at item @image{images/st_portal_horse} @b{st_portal_horse}: flavor=@code{"horse"}
+ at item @image{images/st_portal_horse} @b{st_portal_pearl}: flavor=@code{"pearl"}
 @end table
 
 @end table
@@ -17215,9 +17270,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_rawglass}: movable = @code{false}
- at item @b{st_rawglass_quad}: movable = @code{false}
- at item @b{st_rawglass_movable}: movable = @code{true}
+ at item @image{images/st_rawglass} @b{st_rawglass}: movable = @code{false}
+ at item @image{images/st_rawglass_quad} @b{st_rawglass_quad}: movable = @code{false}
+ at item @image{images/st_rawglass} @b{st_rawglass_movable}: movable = @code{true}
 @end table
 
 @end table
@@ -17239,7 +17294,7 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_redfiber}
+ at item @image{images/st_redfiber} @b{st_redfiber}
 @end table
 
 @end table
@@ -17523,7 +17578,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{st_spitter}: secure = @code{false}, state = @code{ACTIVE}
+ at item @image{images/st_spitter_idle} @b{st_spitter}: secure = @code{false}, state = @code{ACTIVE}
 @end table
 
 @end table
@@ -17616,7 +17671,6 @@
 @item @b{Action:} none
 
 @item @b{Variants:}
-
 @table @asis
 @item @b{st_stoneimpulse}
 @item @b{st_stoneimpulse_movable}: movable = @code{true}
@@ -17669,7 +17723,11 @@
 
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_surprise} @b{st_surprise}
 @end table
+ at end table
 
 @c ----------------- Swap Stone --------------------
 @node st_swap
@@ -18232,10 +18290,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_yinyang}: state = @code{IDLE}
- at item @b{st_yinyang_active}: state = @code{ACTIVE}
- at item @b{st_yinyang_inactive}: state = @code{INACTIVE}
- at item @b{st_yinyang_instant}: instant = @code{true}, state = @code{IDLE}
+ at item @image{images/st_yinyang} @b{st_yinyang}: state = @code{IDLE}
+ at item @image{images/st_yinyang} @b{st_yinyang_active}: state = @code{ACTIVE}
+ at item @image{images/st_yinyang_inactive} @b{st_yinyang_inactive}: state = @code{INACTIVE}
+ at item @image{images/st_yinyang} @b{st_yinyang_instant}: instant = @code{true}, state = @code{IDLE}
 @end table
 @end table
 

Modified: trunk/doc/reference/images/Makefile.am
===================================================================
--- trunk/doc/reference/images/Makefile.am	2009-06-12 22:03:59 UTC (rev 1715)
+++ trunk/doc/reference/images/Makefile.am	2009-06-12 22:19:19 UTC (rev 1716)
@@ -128,25 +128,64 @@
 	it_wrench.png \
 	it_yinyang.png \
 	st_ancient.png \
+	st_beads.png \
 	st_bluegray.png \
+	st_blur_cross.png \
+	st_blur_straight.png \
 	st_brake.png \
+	st_break_black.png \
+	st_break_boulder.png \
+	st_break_oxydc.png \
+	st_break_plain.png \
+	st_break_white.png \
 	st_brownie.png \
 	st_brownmarble.png \
+	st_brownpyramide.png \
 	st_camouflage.png \
 	st_concrete.png \
+	st_darkglass.png \
 	st_darkgray.png \
+	st_death.png \
+	st_death_light.png \
+	st_dispenser_bombblack.png \
+	st_dispenser_bombwhite.png \
+	st_dispenser_dynamite.png \
+	st_flash.png \
+	st_flat.png \
 	st_granite.png \
+	st_grate_cross.png \
+	st_grate_framed.png \
+	st_greenbrown.png \
 	st_greengray.png \
+	st_ice.png \
+	st_jamb_black.png \
+	st_jamb_white.png \
+	st_lightglass.png \
 	st_metal.png \
+	st_oxyda.png \
+	st_oxydb.png \
+	st_oxydc.png \
+	st_oxydd.png \
+	st_oxyde.png \
 	st_pinkbumps.png \
+	st_plaster.png \
+	st_plop_slate.png \
+	st_portal_horse.png \
 	st_purplegray.png \
 	st_purplemarble.png \
+	st_rawglass.png \
+	st_rawglass_quad.png \
 	st_redbrown.png \
+	st_redfiber.png \
 	st_redmarble.png \
 	st_redrock.png \
+	st_spitter_idle.png \
+	st_surprise.png \
 	st_tigris.png \
 	st_woven.png \
-	st_yellow.png
+	st_yellow.png \
+	st_yinyang.png \
+	st_yinyang_inactive.png
 
 PNGSOURCE = $(addprefix $(GFXDIR), $(PNGLIST))
 



From andreasl at mail.berlios.de  Sat Jun 13 21:38:34 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Sat, 13 Jun 2009 21:38:34 +0200
Subject: [Enigma-game-svn] r1717 - in trunk/data: . levels/enigma_i
	levels/enigma_viii levels/lib
Message-ID: <200906131938.n5DJcYS3009737@sheep.berlios.de>

Author: andreasl
Date: 2009-06-13 21:38:31 +0200 (Sat, 13 Jun 2009)
New Revision: 1717

Modified:
   trunk/data/api2init.lua
   trunk/data/levels/enigma_i/alain05_2.xml
   trunk/data/levels/enigma_viii/andreas48_2.xml
   trunk/data/levels/lib/libmap.xml
   trunk/data/levels/lib/libpento_1.xml
Log:
Trunk:
 - Extending map transformations: Type (always), composition,
   inverses and random (with libmap only).
    - adaptions in libmap, libpento, alain05, andreas48, api2init
Note:
 - Half of the constants have been renamed from MAP_MIRROR_* to MAP_FLIP_*.
   Refman-entry will follow soon.


Modified: trunk/data/api2init.lua
===================================================================
--- trunk/data/api2init.lua	2009-06-12 22:19:19 UTC (rev 1716)
+++ trunk/data/api2init.lua	2009-06-13 19:38:31 UTC (rev 1717)
@@ -199,17 +199,27 @@
 FOLLOW_FULLSCREEN = po(19, 12)
 FOLLOW_HALFSCREEN = po(9.5, 6)
 
--- Read directions for maps
-MAP_IDENT = 0
-MAP_ROT_CW = 1
-MAP_ROT_180 = 2
-MAP_ROT_CCW = 3
-MAP_MIRROR_BACKSLASH = 4
-MAP_MIRROR_HORIZONTAL = 5
-MAP_MIRROR_SLASH = 6
-MAP_MIRROR_VERTICAL = 7
-MAP_COUNT = 7
+-- map transformations, aka. read directions
+MAP_IDENT = {1}
+MAP_ROT_CW = {2}
+MAP_ROT_180 = {3}
+MAP_ROT_CCW = {4}
+MAP_FLIP_BACKSLASH = {5}
+MAP_FLIP_HORIZONTAL = {6}
+MAP_FLIP_SLASH = {7}
+MAP_FLIP_VERTICAL = {8}
+MAP_COUNT = 8
+-- Note: The sequence is of importance for lib.map.transformation_compose.
+MAP_ALL = {MAP_IDENT, MAP_ROT_CW, MAP_ROT_180, MAP_ROT_CCW, MAP_FLIP_BACKSLASH,
+           MAP_FLIP_HORIZONTAL, MAP_FLIP_SLASH, MAP_FLIP_VERTICAL}
 
+for _, transformation in ipairs(MAP_ALL) do
+    setmetatable(transformation, {_type = "maptransformation",
+        __mul = (function() error("You have to load libmap to use \"*\" on map transformations.", 2) end),
+        __pow = (function() error("You have to load libmap to use \"^\" on map transformations.", 2) end),
+        __unm = (function() error("You have to load libmap to use \"-\" on map transformations.", 2) end)})
+end
+
 ---------------------
 -- Utility Methods --
 ---------------------
@@ -226,13 +236,13 @@
         -- Analyse arguments 4 to 6
         local ignore, map, readdir
         if (etype(arg3) == "map") then
-            assert_type(arg4, "wo:drawMap fourth argument (read direction)", 2, "nil", "integer")
+            assert_type(arg4, "wo:drawMap fourth argument (read direction)", 2, "nil", "maptransformation")
             map = arg3
             ignore = map.defaultkey
             readdir = arg4 or MAP_IDENT
         else
             assert_type(arg4, "wo:drawMap fourth argument (map)", 2, "table", "map")
-            assert_type(arg5, "wo:drawMap fifth argument (read direction)", 2, "nil", "integer")
+            assert_type(arg5, "wo:drawMap fifth argument (read direction)", 2, "nil", "maptransformation")
             ignore = arg3
             map = arg4
             readdir = arg5 or MAP_IDENT
@@ -240,21 +250,20 @@
                 "wo:drawMap: Ignore key and default key differ in length.", 2)
         end
         local len = string.len(ignore)
-        assert_bool((readdir >= MAP_IDENT) and (readdir <= MAP_COUNT), "wo:drawMap: Unknown read direction.", 2)
         -- Prepare read direction rotation
         local w, h = 0, 0
         local function rot(x, y)
             -- The difference of this function to the one in libmap
             -- results among others from different coordinate origins
             -- and different application of rot.
-            return ({[MAP_IDENT]             = {x,         y},
-                     [MAP_ROT_CW]            = {h + 1 - y, x},
-                     [MAP_ROT_180]           = {w + 1 - x, h + 1 - y},
-                     [MAP_ROT_CCW]           = {y,         w + 1 - x},
-                     [MAP_MIRROR_HORIZONTAL] = {w + 1 - x, y},
-                     [MAP_MIRROR_VERTICAL]   = {x,         h + 1 - y},
-                     [MAP_MIRROR_SLASH]      = {y,         x},
-                     [MAP_MIRROR_BACKSLASH]  = {h + 1 - y, w + 1 - x} })[readdir]
+            return ({[MAP_IDENT]           = {x,         y},
+                     [MAP_ROT_CW]          = {h + 1 - y, x},
+                     [MAP_ROT_180]         = {w + 1 - x, h + 1 - y},
+                     [MAP_ROT_CCW]         = {y,         w + 1 - x},
+                     [MAP_FLIP_HORIZONTAL] = {w + 1 - x, y},
+                     [MAP_FLIP_VERTICAL]   = {x,         h + 1 - y},
+                     [MAP_FLIP_SLASH]      = {y,         x},
+                     [MAP_FLIP_BACKSLASH]  = {h + 1 - y, w + 1 - x} })[readdir]
         end
         if readdir ~= MAP_IDENT then
             -- Calculate height and width for rotation if neccessary

Modified: trunk/data/levels/enigma_i/alain05_2.xml
===================================================================
--- trunk/data/levels/enigma_i/alain05_2.xml	2009-06-12 22:19:19 UTC (rev 1716)
+++ trunk/data/levels/enigma_i/alain05_2.xml	2009-06-13 19:38:31 UTC (rev 1717)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="The Enigmhanoi Towers" el:subtitle="" el:id="alain05"/>
-      <el:version el:score="1" el:release="2" el:revision="3" el:status="released"/>
+      <el:version el:score="1" el:release="2" el:revision="4" el:status="released"/>
       <el:author  el:name="Alain Busser" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2006 Alain Busser</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -47,7 +47,8 @@
 if wo["IsDifficult"] then
     wo:drawMap(ti, no["anchor"] + 2 * S, " ", {"XXXXX", "Xw eX", "XXSXX", "XXXXX"})
 else
-    wo:drawMap(ti, no["anchor"] + 2 * S, " ", {"XXXXX", "XXSeX", "Xw XX", "XXXXX"}, cond(random() < 0.5, MAP_MIRROR_VERTICAL, MAP_IDENT))
+    wo:drawMap(ti, no["anchor"] + 2 * S, " ", {"XXXXX", "XXSeX", "Xw XX", "XXXXX"},
+               cond(random() < 0.5, MAP_FLIP_VERTICAL, MAP_IDENT))
 end
  ]]></el:luamain>
     <el:i18n>

Modified: trunk/data/levels/enigma_viii/andreas48_2.xml
===================================================================
--- trunk/data/levels/enigma_viii/andreas48_2.xml	2009-06-12 22:19:19 UTC (rev 1716)
+++ trunk/data/levels/enigma_viii/andreas48_2.xml	2009-06-13 19:38:31 UTC (rev 1717)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Styles Change" el:subtitle="But dynamite is forever" el:id="andreas48"/>
-      <el:version el:score="2" el:release="2" el:revision="19" el:status="released"/>
+      <el:version el:score="2" el:release="2" el:revision="20" el:status="released"/>
       <el:author el:name="Andreas Lochmann" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2008 Andreas Lochmann</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -293,10 +293,10 @@
   replace_key_in_map(j, " ", "H", 2*glasses2 + maze_offset)
   replace_key_in_map(j, " ", "E", 2*extralife + maze_offset)
   if random(2) == 1 then
-    maze_maps[j] = maze_maps[j] ^ MAP_MIRROR_VERTICAL
+    maze_maps[j] = maze_maps[j] ^ MAP_FLIP_VERTICAL
   end
   if random(2) == 1 then
-    maze_maps[j] = maze_maps[j] ^ MAP_MIRROR_HORIZONTAL
+    maze_maps[j] = maze_maps[j] ^ MAP_FLIP_HORIZONTAL
   end
   maze_maps[j] = maze_maps[j] * (""..j)
 end

Modified: trunk/data/levels/lib/libmap.xml
===================================================================
--- trunk/data/levels/lib/libmap.xml	2009-06-12 22:19:19 UTC (rev 1716)
+++ trunk/data/levels/lib/libmap.xml	2009-06-13 19:38:31 UTC (rev 1717)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="library">
       <el:identity el:title="" el:id="lib/libmap"/>
-      <el:version el:score="1" el:release="1" el:revision="3" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="4" el:status="released"/>
       <el:author  el:name="Enigma Team" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2008 Enigma Team</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -127,24 +127,21 @@
 
 function lib.map.transform(map, op)
     assert_type(map, "lib.map.transform first argument", 2, "map")
-    assert_type(op, "lib.map.transform second argument", 2, "natural")
-    if op > 7 then
-        error("lib.map.transform: Unknown transformation request.", 2)
-    end
+    assert_type(op, "lib.map.transform second argument", 2, "maptransformation")
     local w, h = map.width, map.height
     local function rot(x, y)
-        return ({[MAP_IDENT]             = {x,         y},
-                 [MAP_ROT_CW]            = {y,         h - 1 - x},
-                 [MAP_ROT_180]           = {w - 1 - x, h - 1 - y},
-                 [MAP_ROT_CCW]           = {w - 1 - y, x},
-                 [MAP_MIRROR_HORIZONTAL] = {w - 1 - x, y},
-                 [MAP_MIRROR_VERTICAL]   = {x,         h - 1 - y},
-                 [MAP_MIRROR_SLASH]      = {y,         x},
-                 [MAP_MIRROR_BACKSLASH]  = {w - 1 - y, h - 1 - x}     })[op]
+        return ({[MAP_IDENT]           = {x,         y},
+                 [MAP_ROT_CW]          = {y,         h - 1 - x},
+                 [MAP_ROT_180]         = {w - 1 - x, h - 1 - y},
+                 [MAP_ROT_CCW]         = {w - 1 - y, x},
+                 [MAP_FLIP_HORIZONTAL] = {w - 1 - x, y},
+                 [MAP_FLIP_VERTICAL]   = {x,         h - 1 - y},
+                 [MAP_FLIP_SLASH]      = {y,         x},
+                 [MAP_FLIP_BACKSLASH]  = {w - 1 - y, h - 1 - x}     })[op]
     end
     local new_w, new_h = w, h
-    if    (op == MAP_ROT_CW) or (op == MAP_ROT_CCW)
-         or (op == MAP_MIRROR_SLASH) or (op == MAP_MIRROR_BACKSLASH) then
+    if      (op == MAP_ROT_CW)     or (op == MAP_ROT_CCW)
+         or (op == MAP_FLIP_SLASH) or (op == MAP_FLIP_BACKSLASH) then
         new_w, new_h = h, w
     end
     local result = {}
@@ -632,6 +629,59 @@
     end
 )
 
+-----------------------------
+-- Transformation handling --
+-----------------------------
+
+function lib.map.random_transformation()
+    return MAP_ALL[random(MAP_COUNT)]
+end
+
+function lib.map.transformation_inverse(x)
+    assert_type(x, "lib.map.transformation_inverse first argument", 2, "maptransformation")
+    return MAP_ALL[({[1] = 1, 4, 3, 2, 5, 6, 7, 8})[x[1]]]
+end
+
+function lib.map.transformation_compose(x, y)
+    assert_type(x, "lib.map.transformation_compose first argument", 2, "maptransformation")
+    assert_type(y, "lib.map.transformation_compose second argument", 2, "maptransformation")    
+    return MAP_ALL[({{1, 2, 3, 4, 5, 6, 7, 8},
+                     {2, 3, 4, 1, 6, 7, 8, 5},
+                     {3, 4, 1, 2, 7, 8, 5, 6},
+                     {4, 1, 2, 3, 8, 5, 6, 7},
+                     {5, 8, 7, 6, 1, 4, 3, 2},
+                     {6, 5, 8, 7, 2, 1, 4, 3},
+                     {7, 6, 5, 8, 3, 2, 1, 4},
+                     {8, 7, 6, 5, 4, 3, 2, 1}}) [x[1]] [y[1]] ]
+end
+
+function lib.map.transformation_power(x, y)
+    assert_type(x, "lib.map.transformation_power first argument", 2, "maptransformation")
+    assert_type(y, "lib.map.transformation_power second argument", 2, "maptransformation", "integer")
+    if type(y) == "number" then
+        local result = MAP_IDENT
+        -- Any 4th power of any element is trivial, so we mod by 4.
+        -- Note that negative powers work as expected.
+        for j = 1, y % 4 do
+            result = result * x
+        end
+        return result
+    else
+        return x*y
+    end
+end
+
+lib.map.transformation_metatable = {
+    __mul = lib.map.transformation_compose,
+    __pow = lib.map.transformation_power,
+    __unm = lib.map.transformation_inverse,
+    _type = "maptransformation"
+}
+
+for _, transformation in ipairs(MAP_ALL) do
+    setmetatable(transformation, lib.map.transformation_metatable)
+end
+
     ]]></el:luamain>
     <el:i18n>
     </el:i18n>

Modified: trunk/data/levels/lib/libpento_1.xml
===================================================================
--- trunk/data/levels/lib/libpento_1.xml	2009-06-12 22:19:19 UTC (rev 1716)
+++ trunk/data/levels/lib/libpento_1.xml	2009-06-13 19:38:31 UTC (rev 1717)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="library">
       <el:identity el:title="" el:id="lib/libpento"/>
-      <el:version el:score="1" el:release="1" el:revision="3" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="4" el:status="released"/>
       <el:author  el:name="Ronald Lamprecht" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2009 Ronald Lamprecht</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -118,10 +118,9 @@
         {"  SS","SSS"},{"T","TTT","T"},{"U U","UUU"},{"VVV","V","V"},
         {"W","WW"," WW"},{" X","XXX"," X"},{"YYYY"," Y"},{"ZZ"," Z"," ZZ"}}
     context.rotations = {MAP_ROT_CW, MAP_ROT_180, MAP_ROT_CCW, MAP_IDENT, 
-        MAP_MIRROR_VERTICAL, MAP_MIRROR_BACKSLASH, MAP_MIRROR_HORIZONTAL, 
-        MAP_MIRROR_SLASH}
-    context.mirrors = {MAP_MIRROR_HORIZONTAL, MAP_MIRROR_SLASH, MAP_MIRROR_VERTICAL,
-        MAP_MIRROR_BACKSLASH, MAP_ROT_CCW, MAP_IDENT, MAP_ROT_CW, MAP_ROT_180}
+        MAP_FLIP_VERTICAL, MAP_FLIP_BACKSLASH, MAP_FLIP_HORIZONTAL, MAP_FLIP_SLASH}
+    context.mirrors = {MAP_FLIP_HORIZONTAL, MAP_FLIP_SLASH, MAP_FLIP_VERTICAL,
+        MAP_FLIP_BACKSLASH, MAP_ROT_CCW, MAP_IDENT, MAP_ROT_CW, MAP_ROT_180}
     setmetatable(context, res.metatable)
     return context
 end



From andreasl at mail.berlios.de  Sat Jun 13 22:03:28 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Sat, 13 Jun 2009 22:03:28 +0200
Subject: [Enigma-game-svn] r1718 - in trunk/data: gfx32 gfx40 gfx48
Message-ID: <200906132003.n5DK3SFR013903@sheep.berlios.de>

Author: andreasl
Date: 2009-06-13 22:02:47 +0200 (Sat, 13 Jun 2009)
New Revision: 1718

Modified:
   trunk/data/gfx32/fl_ice_heating.png
   trunk/data/gfx32/fl_swamp_heating.png
   trunk/data/gfx32/fl_water_heating.png
   trunk/data/gfx32/it_burnable_oil.png
   trunk/data/gfx32/sh-actorimpulse.png
   trunk/data/gfx32/sh-doorh.png
   trunk/data/gfx32/sh-doorv.png
   trunk/data/gfx32/sh_pull.png
   trunk/data/gfx32/st-flhay.png
   trunk/data/gfx32/st-flrock.png
   trunk/data/gfx32/st-lightpassenger-break.png
   trunk/data/gfx32/st-lightpassenger.png
   trunk/data/gfx32/st-lightpassenger_off.png
   trunk/data/gfx32/st-oneway.png
   trunk/data/gfx32/st_camouflage.png
   trunk/data/gfx32/st_dispenser_bombblack.png
   trunk/data/gfx32/st_dispenser_bombwhite.png
   trunk/data/gfx32/st_dispenser_dynamite.png
   trunk/data/gfx32/st_flat_fire.png
   trunk/data/gfx32/st_flhay_growing.png
   trunk/data/gfx32/thief_capture_template.png
   trunk/data/gfx32/thief_drunken_template.png
   trunk/data/gfx32/thief_template.png
   trunk/data/gfx40/fl_ice_heating.png
   trunk/data/gfx40/fl_swamp_heating.png
   trunk/data/gfx40/fl_water_heating.png
   trunk/data/gfx40/it_burnable_oil.png
   trunk/data/gfx40/sh-actorimpulse.png
   trunk/data/gfx40/sh-doorh.png
   trunk/data/gfx40/sh-doorv.png
   trunk/data/gfx40/sh_pull.png
   trunk/data/gfx40/st-flhay.png
   trunk/data/gfx40/st-flrock.png
   trunk/data/gfx40/st-lightpassenger-break.png
   trunk/data/gfx40/st-lightpassenger.png
   trunk/data/gfx40/st-lightpassenger_off.png
   trunk/data/gfx40/st-oneway.png
   trunk/data/gfx40/st_camouflage.png
   trunk/data/gfx40/st_dispenser_bombblack.png
   trunk/data/gfx40/st_dispenser_bombwhite.png
   trunk/data/gfx40/st_dispenser_dynamite.png
   trunk/data/gfx40/st_flat_fire.png
   trunk/data/gfx40/st_flhay_growing.png
   trunk/data/gfx40/thief_capture_template.png
   trunk/data/gfx40/thief_drunken_template.png
   trunk/data/gfx40/thief_template.png
   trunk/data/gfx48/fl_ice_heating.png
   trunk/data/gfx48/fl_swamp_heating.png
   trunk/data/gfx48/fl_water_heating.png
   trunk/data/gfx48/it_burnable_oil.png
   trunk/data/gfx48/sh-actorimpulse.png
   trunk/data/gfx48/sh-doorh.png
   trunk/data/gfx48/sh-doorv.png
   trunk/data/gfx48/sh_pull.png
   trunk/data/gfx48/st-flhay.png
   trunk/data/gfx48/st-flrock.png
   trunk/data/gfx48/st-lightpassenger-break.png
   trunk/data/gfx48/st-lightpassenger.png
   trunk/data/gfx48/st-lightpassenger_off.png
   trunk/data/gfx48/st-oneway.png
   trunk/data/gfx48/st_camouflage.png
   trunk/data/gfx48/st_dispenser_bombblack.png
   trunk/data/gfx48/st_dispenser_bombwhite.png
   trunk/data/gfx48/st_dispenser_dynamite.png
   trunk/data/gfx48/st_flat_fire.png
   trunk/data/gfx48/st_flhay_growing.png
   trunk/data/gfx48/thief_capture_template.png
   trunk/data/gfx48/thief_drunken_template.png
   trunk/data/gfx48/thief_template.png
Log:
Trunk:
 - Should fix bug #9679 "Wrong coded Images".
Note:
 - Renaming from "-"- to "_"-pattern will soon follow.
   (Separated from this commit to circumvent "svn mv"-warnings.)


Modified: trunk/data/gfx32/fl_ice_heating.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/fl_swamp_heating.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/fl_water_heating.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/it_burnable_oil.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/sh-actorimpulse.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/sh-doorh.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/sh-doorv.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/sh_pull.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st-flhay.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st-flrock.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st-lightpassenger-break.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st-lightpassenger.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st-lightpassenger_off.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st-oneway.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st_camouflage.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st_dispenser_bombblack.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st_dispenser_bombwhite.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st_dispenser_dynamite.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st_flat_fire.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/st_flhay_growing.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/thief_capture_template.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/thief_drunken_template.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/thief_template.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/fl_ice_heating.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/fl_swamp_heating.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/fl_water_heating.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/it_burnable_oil.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/sh-actorimpulse.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/sh-doorh.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/sh-doorv.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/sh_pull.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st-flhay.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st-flrock.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st-lightpassenger-break.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st-lightpassenger.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st-lightpassenger_off.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st-oneway.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st_camouflage.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st_dispenser_bombblack.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st_dispenser_bombwhite.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st_dispenser_dynamite.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st_flat_fire.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/st_flhay_growing.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/thief_capture_template.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/thief_drunken_template.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/thief_template.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/fl_ice_heating.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/fl_swamp_heating.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/fl_water_heating.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/it_burnable_oil.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/sh-actorimpulse.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/sh-doorh.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/sh-doorv.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/sh_pull.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st-flhay.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st-flrock.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st-lightpassenger-break.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st-lightpassenger.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st-lightpassenger_off.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st-oneway.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st_camouflage.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st_dispenser_bombblack.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st_dispenser_bombwhite.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st_dispenser_dynamite.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st_flat_fire.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/st_flhay_growing.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/thief_capture_template.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/thief_drunken_template.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/thief_template.png
===================================================================
(Binary files differ)



From andreasl at mail.berlios.de  Sun Jun 14 01:23:45 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Sun, 14 Jun 2009 01:23:45 +0200
Subject: [Enigma-game-svn] r1719 - in trunk: data data/gfx16 data/gfx32
	data/gfx40 data/gfx48 data/gfx64 src/stones
Message-ID: <200906132323.n5DNNjZA019018@sheep.berlios.de>

Author: andreasl
Date: 2009-06-14 01:22:12 +0200 (Sun, 14 Jun 2009)
New Revision: 1719

Added:
   trunk/data/gfx16/sh_glass.png
   trunk/data/gfx32/sh_actorimpulse.png
   trunk/data/gfx32/sh_doorh.png
   trunk/data/gfx32/sh_doorv.png
   trunk/data/gfx32/sh_horse.png
   trunk/data/gfx32/sh_rotor.png
   trunk/data/gfx32/sh_top.png
   trunk/data/gfx32/st_box_hay.png
   trunk/data/gfx32/st_box_hay_growing.png
   trunk/data/gfx32/st_box_rock.png
   trunk/data/gfx32/st_box_wood.png
   trunk/data/gfx32/st_box_wood_growing.png
   trunk/data/gfx32/st_lightpassenger.png
   trunk/data/gfx32/st_lightpassenger_break.png
   trunk/data/gfx32/st_lightpassenger_off.png
   trunk/data/gfx32/st_oneway.png
   trunk/data/gfx40/sh_actorimpulse.png
   trunk/data/gfx40/sh_doorh.png
   trunk/data/gfx40/sh_doorv.png
   trunk/data/gfx40/sh_horse.png
   trunk/data/gfx40/sh_rotor.png
   trunk/data/gfx40/sh_top.png
   trunk/data/gfx40/st_box_hay.png
   trunk/data/gfx40/st_box_hay_growing.png
   trunk/data/gfx40/st_box_rock.png
   trunk/data/gfx40/st_box_wood.png
   trunk/data/gfx40/st_box_wood_growing.png
   trunk/data/gfx40/st_lightpassenger.png
   trunk/data/gfx40/st_lightpassenger_break.png
   trunk/data/gfx40/st_lightpassenger_off.png
   trunk/data/gfx40/st_oneway.png
   trunk/data/gfx48/sh_actorimpulse.png
   trunk/data/gfx48/sh_doorh.png
   trunk/data/gfx48/sh_doorv.png
   trunk/data/gfx48/sh_horse.png
   trunk/data/gfx48/sh_rotor.png
   trunk/data/gfx48/sh_top.png
   trunk/data/gfx48/st_box_hay.png
   trunk/data/gfx48/st_box_hay_growing.png
   trunk/data/gfx48/st_box_rock.png
   trunk/data/gfx48/st_box_wood.png
   trunk/data/gfx48/st_box_wood_growing.png
   trunk/data/gfx48/st_lightpassenger.png
   trunk/data/gfx48/st_lightpassenger_break.png
   trunk/data/gfx48/st_lightpassenger_off.png
   trunk/data/gfx48/st_oneway.png
   trunk/data/gfx64/sh_glass.png
Removed:
   trunk/data/gfx16/sh-glass.png
   trunk/data/gfx32/sh-actorimpulse.png
   trunk/data/gfx32/sh-doorh.png
   trunk/data/gfx32/sh-doorv.png
   trunk/data/gfx32/sh-horse.png
   trunk/data/gfx32/sh-rotor.png
   trunk/data/gfx32/sh-top.png
   trunk/data/gfx32/st-flhay.png
   trunk/data/gfx32/st-flrock.png
   trunk/data/gfx32/st-lightpassenger-break.png
   trunk/data/gfx32/st-lightpassenger.png
   trunk/data/gfx32/st-lightpassenger_off.png
   trunk/data/gfx32/st-oneway.png
   trunk/data/gfx32/st-wood.png
   trunk/data/gfx32/st_flhay_growing.png
   trunk/data/gfx32/st_wood_growing.png
   trunk/data/gfx40/sh-actorimpulse.png
   trunk/data/gfx40/sh-doorh.png
   trunk/data/gfx40/sh-doorv.png
   trunk/data/gfx40/sh-horse.png
   trunk/data/gfx40/sh-rotor.png
   trunk/data/gfx40/sh-top.png
   trunk/data/gfx40/st-flhay.png
   trunk/data/gfx40/st-flrock.png
   trunk/data/gfx40/st-lightpassenger-break.png
   trunk/data/gfx40/st-lightpassenger.png
   trunk/data/gfx40/st-lightpassenger_off.png
   trunk/data/gfx40/st-oneway.png
   trunk/data/gfx40/st-wood.png
   trunk/data/gfx40/st_flhay_growing.png
   trunk/data/gfx40/st_wood_growing.png
   trunk/data/gfx48/sh-actorimpulse.png
   trunk/data/gfx48/sh-doorh.png
   trunk/data/gfx48/sh-doorv.png
   trunk/data/gfx48/sh-horse.png
   trunk/data/gfx48/sh-rotor.png
   trunk/data/gfx48/sh-top.png
   trunk/data/gfx48/st-flhay.png
   trunk/data/gfx48/st-flrock.png
   trunk/data/gfx48/st-lightpassenger-break.png
   trunk/data/gfx48/st-lightpassenger.png
   trunk/data/gfx48/st-lightpassenger_off.png
   trunk/data/gfx48/st-oneway.png
   trunk/data/gfx48/st-wood.png
   trunk/data/gfx48/st_flhay_growing.png
   trunk/data/gfx48/st_wood_growing.png
   trunk/data/gfx64/sh-glass.png
Modified:
   trunk/data/models-2d.lua
   trunk/src/stones/BoxStone.cc
   trunk/src/stones/LightPassengerStone.cc
   trunk/src/stones/OneWayStone.cc
Log:
Trunk:
 - Some graphics renaming to replace "-" by "_":
    - all shadow models except "blackball*" and "whiteball*"
    - all st_box* (includes renaming st_wood_growing -> st_box_wood_growing)
    - st_oneway
    - st_lightpassenger*
Todo:
 - Adapt refman to new file names.


Deleted: trunk/data/gfx16/sh-glass.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx16/sh_glass.png (from rev 1717, trunk/data/gfx16/sh-glass.png)


Property changes on: trunk/data/gfx16/sh_glass.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx32/sh-actorimpulse.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-doorh.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-doorv.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-horse.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-rotor.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/sh-top.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/sh_actorimpulse.png (from rev 1718, trunk/data/gfx32/sh-actorimpulse.png)


Property changes on: trunk/data/gfx32/sh_actorimpulse.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/sh_doorh.png (from rev 1718, trunk/data/gfx32/sh-doorh.png)


Property changes on: trunk/data/gfx32/sh_doorh.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/sh_doorv.png (from rev 1718, trunk/data/gfx32/sh-doorv.png)


Property changes on: trunk/data/gfx32/sh_doorv.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/sh_horse.png (from rev 1717, trunk/data/gfx32/sh-horse.png)


Property changes on: trunk/data/gfx32/sh_horse.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/sh_rotor.png (from rev 1717, trunk/data/gfx32/sh-rotor.png)


Property changes on: trunk/data/gfx32/sh_rotor.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/sh_top.png (from rev 1717, trunk/data/gfx32/sh-top.png)


Property changes on: trunk/data/gfx32/sh_top.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx32/st-flhay.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-flrock.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-lightpassenger-break.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-lightpassenger.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-lightpassenger_off.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-oneway.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-wood.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/st_box_hay.png (from rev 1718, trunk/data/gfx32/st-flhay.png)


Property changes on: trunk/data/gfx32/st_box_hay.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/st_box_hay_growing.png (from rev 1718, trunk/data/gfx32/st_flhay_growing.png)


Property changes on: trunk/data/gfx32/st_box_hay_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/st_box_rock.png (from rev 1718, trunk/data/gfx32/st-flrock.png)


Property changes on: trunk/data/gfx32/st_box_rock.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/st_box_wood.png (from rev 1717, trunk/data/gfx32/st-wood.png)


Property changes on: trunk/data/gfx32/st_box_wood.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/st_box_wood_growing.png (from rev 1717, trunk/data/gfx32/st_wood_growing.png)


Property changes on: trunk/data/gfx32/st_box_wood_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx32/st_flhay_growing.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/st_lightpassenger.png (from rev 1718, trunk/data/gfx32/st-lightpassenger.png)


Property changes on: trunk/data/gfx32/st_lightpassenger.png
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/st_lightpassenger_break.png (from rev 1718, trunk/data/gfx32/st-lightpassenger-break.png)


Property changes on: trunk/data/gfx32/st_lightpassenger_break.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/st_lightpassenger_off.png (from rev 1718, trunk/data/gfx32/st-lightpassenger_off.png)


Property changes on: trunk/data/gfx32/st_lightpassenger_off.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx32/st_oneway.png (from rev 1718, trunk/data/gfx32/st-oneway.png)


Property changes on: trunk/data/gfx32/st_oneway.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx32/st_wood_growing.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-actorimpulse.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-doorh.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-doorv.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-horse.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-rotor.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/sh-top.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/sh_actorimpulse.png (from rev 1718, trunk/data/gfx40/sh-actorimpulse.png)


Property changes on: trunk/data/gfx40/sh_actorimpulse.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/sh_doorh.png (from rev 1718, trunk/data/gfx40/sh-doorh.png)


Property changes on: trunk/data/gfx40/sh_doorh.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/sh_doorv.png (from rev 1718, trunk/data/gfx40/sh-doorv.png)


Property changes on: trunk/data/gfx40/sh_doorv.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/sh_horse.png (from rev 1717, trunk/data/gfx40/sh-horse.png)


Property changes on: trunk/data/gfx40/sh_horse.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/sh_rotor.png (from rev 1717, trunk/data/gfx40/sh-rotor.png)


Property changes on: trunk/data/gfx40/sh_rotor.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/sh_top.png (from rev 1717, trunk/data/gfx40/sh-top.png)


Property changes on: trunk/data/gfx40/sh_top.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx40/st-flhay.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-flrock.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-lightpassenger-break.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-lightpassenger.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-lightpassenger_off.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-oneway.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-wood.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/st_box_hay.png (from rev 1718, trunk/data/gfx40/st-flhay.png)


Property changes on: trunk/data/gfx40/st_box_hay.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/st_box_hay_growing.png (from rev 1718, trunk/data/gfx40/st_flhay_growing.png)


Property changes on: trunk/data/gfx40/st_box_hay_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/st_box_rock.png (from rev 1718, trunk/data/gfx40/st-flrock.png)


Property changes on: trunk/data/gfx40/st_box_rock.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/st_box_wood.png (from rev 1717, trunk/data/gfx40/st-wood.png)


Property changes on: trunk/data/gfx40/st_box_wood.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/st_box_wood_growing.png (from rev 1717, trunk/data/gfx40/st_wood_growing.png)


Property changes on: trunk/data/gfx40/st_box_wood_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx40/st_flhay_growing.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/st_lightpassenger.png (from rev 1718, trunk/data/gfx40/st-lightpassenger.png)


Property changes on: trunk/data/gfx40/st_lightpassenger.png
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/st_lightpassenger_break.png (from rev 1718, trunk/data/gfx40/st-lightpassenger-break.png)


Property changes on: trunk/data/gfx40/st_lightpassenger_break.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/st_lightpassenger_off.png (from rev 1718, trunk/data/gfx40/st-lightpassenger_off.png)


Property changes on: trunk/data/gfx40/st_lightpassenger_off.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx40/st_oneway.png (from rev 1718, trunk/data/gfx40/st-oneway.png)


Property changes on: trunk/data/gfx40/st_oneway.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx40/st_wood_growing.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-actorimpulse.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-doorh.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-doorv.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-horse.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-rotor.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/sh-top.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/sh_actorimpulse.png (from rev 1718, trunk/data/gfx48/sh-actorimpulse.png)


Property changes on: trunk/data/gfx48/sh_actorimpulse.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/sh_doorh.png (from rev 1718, trunk/data/gfx48/sh-doorh.png)


Property changes on: trunk/data/gfx48/sh_doorh.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/sh_doorv.png (from rev 1718, trunk/data/gfx48/sh-doorv.png)


Property changes on: trunk/data/gfx48/sh_doorv.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/sh_horse.png (from rev 1717, trunk/data/gfx48/sh-horse.png)


Property changes on: trunk/data/gfx48/sh_horse.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/sh_rotor.png (from rev 1717, trunk/data/gfx48/sh-rotor.png)


Property changes on: trunk/data/gfx48/sh_rotor.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/sh_top.png (from rev 1717, trunk/data/gfx48/sh-top.png)


Property changes on: trunk/data/gfx48/sh_top.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx48/st-flhay.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-flrock.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-lightpassenger-break.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-lightpassenger.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-lightpassenger_off.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-oneway.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-wood.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/st_box_hay.png (from rev 1718, trunk/data/gfx48/st-flhay.png)


Property changes on: trunk/data/gfx48/st_box_hay.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/st_box_hay_growing.png (from rev 1718, trunk/data/gfx48/st_flhay_growing.png)


Property changes on: trunk/data/gfx48/st_box_hay_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/st_box_rock.png (from rev 1718, trunk/data/gfx48/st-flrock.png)


Property changes on: trunk/data/gfx48/st_box_rock.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/st_box_wood.png (from rev 1717, trunk/data/gfx48/st-wood.png)


Property changes on: trunk/data/gfx48/st_box_wood.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/st_box_wood_growing.png (from rev 1717, trunk/data/gfx48/st_wood_growing.png)


Property changes on: trunk/data/gfx48/st_box_wood_growing.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx48/st_flhay_growing.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/st_lightpassenger.png (from rev 1718, trunk/data/gfx48/st-lightpassenger.png)


Property changes on: trunk/data/gfx48/st_lightpassenger.png
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/st_lightpassenger_break.png (from rev 1718, trunk/data/gfx48/st-lightpassenger-break.png)


Property changes on: trunk/data/gfx48/st_lightpassenger_break.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/st_lightpassenger_off.png (from rev 1718, trunk/data/gfx48/st-lightpassenger_off.png)


Property changes on: trunk/data/gfx48/st_lightpassenger_off.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream
Name: svn:mergeinfo
   + 

Copied: trunk/data/gfx48/st_oneway.png (from rev 1718, trunk/data/gfx48/st-oneway.png)


Property changes on: trunk/data/gfx48/st_oneway.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Deleted: trunk/data/gfx48/st_wood_growing.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx64/sh-glass.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx64/sh_glass.png (from rev 1717, trunk/data/gfx64/sh-glass.png)


Property changes on: trunk/data/gfx64/sh_glass.png
___________________________________________________________________
Name: svn:mime-type
   + image/png
Name: svn:mergeinfo
   + 

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-06-13 20:02:47 UTC (rev 1718)
+++ trunk/data/models-2d.lua	2009-06-13 23:22:12 UTC (rev 1719)
@@ -195,14 +195,14 @@
 -- ac-horse --
 do
     SpriteImage("fg-horse",0.5,0.18)
-    SpriteImage("sh-horse", 0.4)
-    DefShModel("ac_horse", "fg-horse", "sh-horse")
+    SpriteImage("sh_horse", 0.4)
+    DefShModel("ac_horse", "fg-horse", "sh_horse")
 end
 
 -- ac-rotor --
 do
     local fg = SpriteImages("fg-rotor",9)
-    local bg = SpriteImages("sh-rotor", 9, 0.4)
+    local bg = SpriteImages("sh_rotor", 9, 0.4)
 
     frames = {}
     for i=1,9 do
@@ -215,7 +215,7 @@
 -- ac-top --
 do
     local fg = SpriteImages("fg-top", 9, 0.5, 0.3)
-    local bg = SpriteImage("sh-top", 0.4, 0.3)
+    local bg = SpriteImage("sh_top", 0.4, 0.3)
 
     frames = {}
     for i=1,9 do
@@ -798,7 +798,7 @@
     DefStone("st_flat_fire")
     DefStone("st-floppy0", "sh_round", {filename="st-floppy1"})
     DefStone("st-floppy1", "sh_round", {filename="st-floppy2"})
-    DefStone("st-flrock", "sh_round")
+    DefStone("st_box_rock", "sh_round")
     DefStone("st_rawglass", "sh_glass")
     DefStone("st_rawglass_quad", "sh_rawglass_quad")
     DefStone("st_lightglass", "sh_glass")
@@ -848,7 +848,7 @@
 -- st-actorimpulse --
 do
     namelist = DefSubimages("st-actorimpulse", {h=3})
-    shnamelist = DefSubimages("sh-actorimpulse", {h=3,imgw=ShadowSize,imgh=ShadowSize})
+    shnamelist = DefSubimages("sh_actorimpulse", {h=3,imgw=ShadowSize,imgh=ShadowSize})
 
     DefAnim("st-ai-fg", PingPong(BuildFrames(namelist, 30)))
     DefAnim("st-ai-sh", PingPong(BuildFrames(shnamelist, 30)))
@@ -1076,31 +1076,31 @@
     DefShModel("st-laserswitch1", "laserswitch-blink", "sh_round")
 end
 
--- st-lightpassenger --
+-- st_lightpassenger --
 do
-    local img = DefSubimages("st-lightpassenger", {h=7})
-    DefShModel("st-lightpassenger", img[1], "sh_glass")
-    DefImage("st-lightpassenger_offx", {filename = "st-lightpassenger_off"})
-    DefShModel("st-lightpassenger_off", "st-lightpassenger_offx", "sh_glass")
-    DefAlias("st-lightpassenger_hidden", "st_darkglass")
+    local img = DefSubimages("st_lightpassenger", {h=7})
+    DefShModel("st_lightpassenger", img[1], "sh_glass")
+    DefImage("st_lightpassenger_offx", {filename = "st_lightpassenger_off"})
+    DefShModel("st_lightpassenger_off", "st_lightpassenger_offx", "sh_glass")
+    DefAlias("st_lightpassenger_hidden", "st_darkglass")
     -- Blink animation
     local frames = {img[2], img[3], img[4], img[5], img[6], img[7]}
-    DefAnim("st-lightpassenger-blink1", PingPong(BuildFrames(frames, 75)), true)
-    DefShModel("st-lightpassenger-blink", "st-lightpassenger-blink1", "sh_glass")
+    DefAnim("st_lightpassenger_blink1", PingPong(BuildFrames(frames, 75)), true)
+    DefShModel("st_lightpassenger_blink", "st_lightpassenger_blink1", "sh_glass")
     -- Break animation
-    img = DefSubimages("st-lightpassenger-break", {h=7})
+    img = DefSubimages("st_lightpassenger_break", {h=7})
     local anim_v, anim_h, anim_hv = {}, {}, {}
     for j = 1, 7 do
-      anim_v[j] = "st-lightpassenger-break-v"..j
+      anim_v[j] = "st_lightpassenger_break_v"..j
       display.DefineComposite(anim_v[j], "it_laser_v", img[j])
-      anim_h[j] = "st-lightpassenger-break-h"..j
+      anim_h[j] = "st_lightpassenger_break_h"..j
       display.DefineComposite(anim_h[j], "it_laser_h", img[j])
-      anim_hv[j] = "st-lightpassenger-break-hv"..j
+      anim_hv[j] = "st_lightpassenger_break_hv"..j
       display.DefineComposite(anim_hv[j], "it_laser_hv", img[j])
     end
-    DefAnim("st-lightpassenger-break-v", BuildFrames(anim_v, 50), false)
-    DefAnim("st-lightpassenger-break-h", BuildFrames(anim_h, 50), false)
-    DefAnim("st-lightpassenger-break-hv", BuildFrames(anim_hv, 50), false)
+    DefAnim("st_lightpassenger_break_v", BuildFrames(anim_v, 50), false)
+    DefAnim("st_lightpassenger_break_h", BuildFrames(anim_h, 50), false)
+    DefAnim("st_lightpassenger_break_hv", BuildFrames(anim_hv, 50), false)
 end
 
 -- st_dongle :-) --
@@ -1123,15 +1123,15 @@
     DefSolidStone("st-mail-s", images[4])
 end
 
--- st-oneway, st-oneway_black, st-oneway_white --
+-- st_oneway, st_oneway_black, st_oneway_white --
 do
     local model_names = {
-        "st-oneway-e", "st-oneway-n", "st-oneway-s", "st-oneway-w",
-        "st-oneway_black-e", "st-oneway_black-n", "st-oneway_black-s", "st-oneway_black-w",
-        "st-oneway_white-e", "st-oneway_white-n", "st-oneway_white-s", "st-oneway_white-w"
+        "st_oneway_e", "st_oneway_n", "st_oneway_s", "st_oneway_w",
+        "st_oneway_black_e", "st_oneway_black_n", "st_oneway_black_s", "st_oneway_black_w",
+        "st_oneway_white_e", "st_oneway_white_n", "st_oneway_white_s", "st_oneway_white_w"
     }
-    DefSubimages("st-oneway", {modelname="st-onewayx",w=3,h=4})
-    for i=1,12 do DefFloatingStone(model_names[i], "st-onewayx"..i) end
+    DefSubimages("st_oneway", {modelname="st_onewayx",w=3,h=4})
+    for i=1,12 do DefFloatingStone(model_names[i], "st_onewayx"..i) end
 end
 
 -- st-pull, st-swap --
@@ -1307,32 +1307,32 @@
 
    -- Wooden (box) stones --
    do
-      DefSubimages("st-wood", {modelname="st-wood-fg",h=2})
-      DefShModel("st-wood1", "st-wood-fg1", "sh_round")
-      DefShModel("st-wood2", "st-wood-fg2", "sh_round")
+      DefSubimages("st_box_wood", {modelname="st_box_wood_fg",h=2})
+      DefShModel("st_box_wood1", "st_box_wood_fg1", "sh_round")
+      DefShModel("st_box_wood2", "st_box_wood_fg2", "sh_round")
 
-      local images=DefSubimages("st_wood_growing", {h=3})
-      DefAnim("wood-growing-fg", BuildFrames(images, 130))
-      DefAnim("wood-growing-bg", BuildFrames(shadows, 130))
-      DefShModel("st_wood_growing", "wood-growing-fg", "wood-growing-bg")
+      local images=DefSubimages("st_box_wood_growing", {h=3})
+      DefAnim("st_box_wood_growing_fg", BuildFrames(images, 130))
+      DefAnim("st_box_wood_growing_bg", BuildFrames(shadows, 130))
+      DefShModel("st_box_wood_growing", "st_box_wood_growing_fg", "st_box_wood_growing_bg")
    end
 
    -- Greenbrown seed growing --
    do
       local images=DefSubimages("st_greenbrown_growing", {h=3})
-      DefAnim("greenbrown-growing-fg", BuildFrames(images, 130))
-      DefAnim("greenbrown-growing-bg", BuildFrames(shadows, 130))
-      DefShModel("st_greenbrown_growing", "greenbrown-growing-fg", "greenbrown-growing-bg")
+      DefAnim("st_greenbrown_growing_fg", BuildFrames(images, 130))
+      DefAnim("st_greenbrown_growing_bg", BuildFrames(shadows, 130))
+      DefShModel("st_greenbrown_growing", "st_greenbrown_growing_fg", "st_greenbrown_growing_bg")
    end
 
-   -- st_flhay, hay seed growing --
+   -- st_box_hay, hay seed growing --
    do
-      DefStone("st-flhay", "sh_round")
+      DefStone("st_box_hay", "sh_round")
 
-      local images=DefSubimages("st_flhay_growing", {h=3})
-      DefAnim("hay-growing-fg", BuildFrames(images, 130))
-      DefAnim("hay-growing-bg", BuildFrames(shadows, 130))
-      DefShModel("st_flhay_growing", "hay-growing-fg", "hay-growing-bg")
+      local images=DefSubimages("st_box_hay_growing", {h=3})
+      DefAnim("st_box_hay_growing_fg", BuildFrames(images, 130))
+      DefAnim("st_box_hay_growing_bg", BuildFrames(shadows, 130))
+      DefShModel("st_box_hay_growing", "st_box_hay_growing_fg", "st_box_hay_growing_bg")
    end
 
    -- volcano growing --
@@ -1642,7 +1642,7 @@
     local f,img,sh
 
     img=DefSubimages("st-doorh", {h=7})
-    sh=DefSubimages("sh-doorh", {h=7,imgw=ShadowSize,imgh=ShadowSize})
+    sh=DefSubimages("sh_doorh", {h=7,imgw=ShadowSize,imgh=ShadowSize})
     DefShModel("st-doorh-open", img[1], sh[1])
     DefShModel("st-doorh-closed", img[7], sh[7])
     DefAnim("doorh-opening-fg", ReverseFrames(BuildFrames(img, 60)))
@@ -1653,7 +1653,7 @@
     DefShModel("st-doorh-closing", "doorh-closing-fg", "doorh-closing-bg")
 
     img=DefSubimages("st-doorv", {w=7})
-    sh=DefSubimages("sh-doorv", {w=7,imgw=ShadowSize,imgh=ShadowSize})
+    sh=DefSubimages("sh_doorv", {w=7,imgw=ShadowSize,imgh=ShadowSize})
     DefShModel("st-doorv-open", img[1], sh[1])
     DefShModel("st-doorv-closed", img[7], sh[7])
     DefAnim("doorv-opening-fg", ReverseFrames(BuildFrames(img, 60)))

Modified: trunk/src/stones/BoxStone.cc
===================================================================
--- trunk/src/stones/BoxStone.cc	2009-06-13 20:02:47 UTC (rev 1718)
+++ trunk/src/stones/BoxStone.cc	2009-06-13 23:22:12 UTC (rev 1719)
@@ -31,7 +31,7 @@
     
     BoxStone* BoxStone::clone() {
         if ((BoxStoneTyp)((objFlags & OBJBIT_SUBTYP) >> 25) == WOOD) { 
-             // When st_wood is created it randomly becomes st_wood1 or st_wood2.
+             // When st_box_wood is created it randomly becomes st_box_wood1 or st_box_wood2.
              if (IntegerRand(0, 1) == 0)
                 return new BoxStone(WOOD1, state);
             else
@@ -107,24 +107,24 @@
                 ASSERT(false, XLevelRuntime, "Wood stone init model state error");
             case WOOD1:
                 if (state == GROWING)
-                    set_anim("st_wood_growing");
+                    set_anim("st_box_wood_growing");
                 else
-                    set_model("st-wood1");
+                    set_model("st_box_wood1");
                 break;
             case WOOD2:
                 if (state == GROWING)
-                    set_anim("st_wood_growing");
+                    set_anim("st_box_wood_growing");
                 else
-                    set_model("st-wood2");
+                    set_model("st_box_wood2");
                 break;
             case HAY:
                 if (state == GROWING)
-                    set_anim("st_flhay_growing");
+                    set_anim("st_box_hay_growing");
                 else
-                    set_model("st-flhay"); break;
+                    set_model("st_box_hay"); break;
                 break;
             case ROCK:
-                set_model("st-flrock"); break;
+                set_model("st_box_rock"); break;
         }
     }
     

Modified: trunk/src/stones/LightPassengerStone.cc
===================================================================
--- trunk/src/stones/LightPassengerStone.cc	2009-06-13 20:02:47 UTC (rev 1718)
+++ trunk/src/stones/LightPassengerStone.cc	2009-06-13 23:22:12 UTC (rev 1719)
@@ -87,21 +87,21 @@
         switch(state) {
             case OFF:
                 set_model(objFlags & OBJBIT_VISIBLE ?
-                    "st-lightpassenger_off" : "st-lightpassenger_hidden"); break;
+                    "st_lightpassenger_off" : "st_lightpassenger_hidden"); break;
             case ON:
-                set_model("st-lightpassenger"); break;
+                set_model("st_lightpassenger"); break;
             case BLINK:
-                set_model("st-lightpassenger-blink"); break;
+                set_model("st_lightpassenger_blink"); break;
             case BREAK:
                 bool NorthSouth = objFlags & (NORTHBIT | SOUTHBIT);
                 bool EastWest = objFlags & (WESTBIT | EASTBIT);
                 sound_event ("stonedestroy");
                 if (NorthSouth && !EastWest)
-                    set_anim("st-lightpassenger-break-v");
+                    set_anim("st_lightpassenger_break_v");
                 else if (!NorthSouth && EastWest)
-                    set_anim("st-lightpassenger-break-h");
+                    set_anim("st_lightpassenger_break_h");
                 else // and this even in case the laser recently disappeared
-                    set_anim("st-lightpassenger-break-hv");
+                    set_anim("st_lightpassenger_break_hv");
                 break;
         }
     }

Modified: trunk/src/stones/OneWayStone.cc
===================================================================
--- trunk/src/stones/OneWayStone.cc	2009-06-13 20:02:47 UTC (rev 1718)
+++ trunk/src/stones/OneWayStone.cc	2009-06-13 23:22:12 UTC (rev 1719)
@@ -67,7 +67,7 @@
     }
 
     void OneWayStone::init_model() {
-        set_model(ecl::strf("st-oneway%s%s", colorName(), to_suffix((Direction)state).c_str()));
+        set_model(ecl::strf("st_oneway%s%s", colorName(), toSuffix((Direction)state).c_str()));
     }
     
     bool OneWayStone::is_floating() const {



From ral at mail.berlios.de  Sun Jun 14 01:55:36 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 14 Jun 2009 01:55:36 +0200
Subject: [Enigma-game-svn] r1720 - trunk/src
Message-ID: <200906132355.n5DNtalK013850@sheep.berlios.de>

Author: ral
Date: 2009-06-14 01:55:35 +0200 (Sun, 14 Jun 2009)
New Revision: 1720

Modified:
   trunk/src/client.cc
   trunk/src/client_internal.hh
   trunk/src/server.cc
   trunk/src/server.hh
Log:
Trunk 1.1:
- another ESC DOS protection - less mouse control, mark cheat on 10th attempt


Modified: trunk/src/client.cc
===================================================================
--- trunk/src/client.cc	2009-06-13 23:22:12 UTC (rev 1719)
+++ trunk/src/client.cc	2009-06-13 23:55:35 UTC (rev 1720)
@@ -54,7 +54,7 @@
 using namespace std;
 
 #include "client_internal.hh"
-
+
 /* -------------------- Auxiliary functions -------------------- */
 
 namespace
@@ -212,7 +212,7 @@
         case SDL_ACTIVEEVENT: {
             update_mouse_button_state();
             if (e.active.gain == 0 && !video::IsFullScreen())
-                show_menu();
+                show_menu(false);
             break;
         }
 
@@ -426,7 +426,7 @@
                 app.bossKeyPressed = true;
                 abort();
             } else {
-                show_menu();
+                show_menu(true);
             }
             break;
         case SDLK_LEFT:   set_mousespeed(options::GetMouseSpeed() - 1); break;
@@ -524,8 +524,16 @@
 }
 
 
-void Client::show_menu() 
-{
+void Client::show_menu(bool isESC) {
+    if (isESC && server::LastMenuTime != 0.0 && server::LevelTime - server::LastMenuTime < 0.3) {
+        return; // protection against ESC D.o.S. attacks
+    }
+    if (isESC && server::LastMenuTime != 0.0 && server::LevelTime - server::LastMenuTime < 0.35) {
+        server::MenuCount++;
+        if (server::MenuCount > 10)
+            mark_cheater();
+    }
+    
     server::Msg_Pause (true);
 
     ecl::Screen *screen = video::GetScreen();
@@ -545,7 +553,9 @@
 
     server::Msg_Pause (false);
     game::ResetGameTimer();
-
+    
+    if (isESC)  // protection against ESC D.o.S. attacks
+        server::LastMenuTime = server::LevelTime;
 }
 
 void Client::draw_screen()

Modified: trunk/src/client_internal.hh
===================================================================
--- trunk/src/client_internal.hh	2009-06-13 23:22:12 UTC (rev 1719)
+++ trunk/src/client_internal.hh	2009-06-13 23:55:35 UTC (rev 1720)
@@ -126,7 +126,7 @@
 
         /* ---------- Private methods ---------- */
 
-        void show_menu();
+        void show_menu(bool isESC);
         void show_help();
 
         // Screen update (state dependant)

Modified: trunk/src/server.cc
===================================================================
--- trunk/src/server.cc	2009-06-13 23:22:12 UTC (rev 1719)
+++ trunk/src/server.cc	2009-06-13 23:55:35 UTC (rev 1720)
@@ -75,10 +75,11 @@
 
 /* -------------------- Global variables -------------------- */
 
+double   server::LastMenuTime;
+int      server::MenuCount;
 
+bool     server::NoCollisions = false;
 
-bool server::NoCollisions = false;
-
 bool     server::AllowSingleOxyds;
 bool     server::AllowSuicide;
 bool     server::AllowTogglePlayer;
@@ -249,7 +250,9 @@
 {
     state = sv_waiting_for_clients;
     
-    server::NoCollisions = false;
+    server::LastMenuTime      = 0.0;
+    server::MenuCount         = 0;
+    server::NoCollisions      = false;
     server::WorldInitialized  = false;
     server::LevelTime         = 0.0;
     server::ConserveLevel     = true;
@@ -302,13 +305,13 @@
     lua::ShutdownLevel();
     lua_State *L = lua::InitLevel(api);
     if (api == 1 && lua::DoSysFile(L, "compat.lua") != lua::NO_LUAERROR) {
-        throw XLevelLoading("While processing 'compat.lua':\n"+lua::LastError(L));
+        throw XLevelLoading("While processing 'compat.lua':\n" + lua::LastError(L));
     }
     if (lua::DoSysFile(L, ecl::strf("api%dinit.lua", api)) != lua::NO_LUAERROR) {
-        throw XLevelLoading("While processing 'init.lua':\n"+lua::LastError(L));
+        throw XLevelLoading(ecl::strf("While processing 'api%dinit.lua':\n", api) + lua::LastError(L));
     }
     if (lua::DoSysFile(L, "security.lua") != lua::NO_LUAERROR) {
-        throw XLevelLoading("While processing 'security.lua':\n"+lua::LastError(L));
+        throw XLevelLoading("While processing 'security.lua':\n" + lua::LastError(L));
     }
 }
 

Modified: trunk/src/server.hh
===================================================================
--- trunk/src/server.hh	2009-06-13 23:22:12 UTC (rev 1719)
+++ trunk/src/server.hh	2009-06-13 23:55:35 UTC (rev 1720)
@@ -53,6 +53,8 @@
 
     // The number of seconds passed since the level game started.
     extern double LevelTime;
+    extern double LastMenuTime;
+    extern int MenuCount;
     
     extern int32_t  RandomState;
 



From ral at mail.berlios.de  Mon Jun 15 00:22:07 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Mon, 15 Jun 2009 00:22:07 +0200
Subject: [Enigma-game-svn] r1721 - in trunk/src: . items
Message-ID: <200906142222.n5EMM7KF016738@sheep.berlios.de>

Author: ral
Date: 2009-06-15 00:22:06 +0200 (Mon, 15 Jun 2009)
New Revision: 1721

Modified:
   trunk/src/WorldProxy.cc
   trunk/src/items/Magnet.cc
   trunk/src/items/Magnet.hh
   trunk/src/items/WormHole.cc
   trunk/src/items/WormHole.hh
   trunk/src/player.cc
   trunk/src/server.cc
   trunk/src/server.hh
   trunk/src/world.cc
   trunk/src/world.hh
Log:
Trunk 1.1:
- fix wormhole, magnet: for actors on same grid the doubled force had been 
    applied due to a name clash between force fields and item forces
- new global attribute "InfiniteReincarnation", default false, resurrect
    actors without removal of extralife, but extralife must be present

Modified: trunk/src/WorldProxy.cc
===================================================================
--- trunk/src/WorldProxy.cc	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/WorldProxy.cc	2009-06-14 22:22:06 UTC (rev 1721)
@@ -70,6 +70,8 @@
             return server::LevelTime;    // read only
         } else if (key == "ProvideExtralifes") {
             return server::ProvideExtralifes;
+        } else if (key == "InfiniteReincarnation") {
+            return server::InfiniteReincarnation;
         } else if (key == "ShowMoves") {
             return server::ShowMoves;
         } else if (key == "SurviveFinish") {
@@ -172,7 +174,8 @@
             ASSERT(server::ProvideExtralifes || !newFlag, XLevelRuntime, 
                 "Attribute 'ProvideExtralifes': toggling from false to true not allowed");
             server::ProvideExtralifes = newFlag;
-            
+        } else if (key == "InfiniteReincarnation") {
+            server::InfiniteReincarnation = val.to_bool();            
         } else if (key == "ShowMoves") {
             server::ShowMoves = val.to_bool();
             STATUSBAR->show_move_counter (server::ShowMoves);

Modified: trunk/src/items/Magnet.cc
===================================================================
--- trunk/src/items/Magnet.cc	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/items/Magnet.cc	2009-06-14 22:22:06 UTC (rev 1721)
@@ -56,6 +56,20 @@
         }
         return Item::message(m);
     }
+    
+    void Magnet::setState(int extState) {
+        // switch force on and off
+        if (extState != state) {          // react only on force changes
+            state = extState;
+            if (isDisplayable()) {
+                if (extState == 1)
+                    AddForceField(this);
+                else
+                    RemoveForceField(this);
+            }
+        }
+    }
+    
     void Magnet::init_model() {
         set_model(ecl::strf("it_magnet_%s", state == ON ? "on" : "off"));
     }
@@ -68,23 +82,25 @@
             correctedStrength = 0.6 * server::MagnetForce;
         }
 
-        AddForceField(this);
+        if (state == ON)
+            AddForceField(this);
+            
         Item::on_creation(p);
     }
     
     void Magnet::on_removal(GridPos p) {
         Item::on_removal(p);
-        RemoveForceField(this);
+        if (state == ON)
+            RemoveForceField(this);
     }
     
-    void Magnet::add_force(Actor *a, V2 &f) {
-        if (state == ON) {
-            V2 dv = get_pos().center() - a->get_pos_force();
-            double squareDist = square(dv);
+    ecl::V2 Magnet::globalForce(Actor *a) {
+        // only switched on magnets are registered
+        ecl::V2 dv = get_pos().center() - a->get_pos_force();
+        double squareDist = square(dv);
 
-            if (squareDist >= 0.04 && squareDist < squareRange)
-                f += (correctedStrength / squareDist) * dv;
-        }
+        return (squareDist >= 0.04 && squareDist < squareRange) ?
+                (correctedStrength / squareDist) * dv : ecl::V2();
     }
     
     ItemTraits Magnet::traits[2] = {

Modified: trunk/src/items/Magnet.hh
===================================================================
--- trunk/src/items/Magnet.hh	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/items/Magnet.hh	2009-06-14 22:22:06 UTC (rev 1721)
@@ -43,13 +43,16 @@
         virtual void setAttr(const std::string &key, const Value &val);
         virtual Value message(const Message &m);
 
+        // StateObject interface
+        virtual void setState(int extState);
+
         // GridObject interface
         virtual void on_creation(GridPos p);
         virtual void on_removal(GridPos p);
         virtual void init_model();
 
         // ForceField interface
-        virtual void add_force(Actor *a, V2 &f);
+        virtual ecl::V2 globalForce(Actor *a);
         
     private:
         double correctedStrength;     // 0.6 * strength

Modified: trunk/src/items/WormHole.cc
===================================================================
--- trunk/src/items/WormHole.cc	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/items/WormHole.cc	2009-06-14 22:22:06 UTC (rev 1721)
@@ -135,12 +135,13 @@
         return results;
     }
     
-    void WormHole::add_force(Actor *a, V2 &f) {
-        V2 dv = get_pos().center() - a->get_pos_force();
+    ecl::V2 WormHole::globalForce(Actor *a) {
+        // only switched on wormholes are registered
+        ecl::V2 dv = get_pos().center() - a->get_pos_force();
         double squareDist = square(dv);
 
-        if (squareDist >= 0.025 && squareDist < squareRange)
-            f += (correctedStrength / squareDist) * dv;
+        return (squareDist >= 0.025 && squareDist < squareRange) ?
+                (correctedStrength / squareDist) * dv : ecl::V2();
     }
     
     void WormHole::alarm() {

Modified: trunk/src/items/WormHole.hh
===================================================================
--- trunk/src/items/WormHole.hh	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/items/WormHole.hh	2009-06-14 22:22:06 UTC (rev 1721)
@@ -64,7 +64,7 @@
         virtual std::list<GridPos> warpSpreadPos(bool isWater);
 
         // ForceField interface
-        virtual void add_force(Actor *a, V2 &f);
+        virtual ecl::V2 globalForce(Actor *a);
         
         // TimeHandler interface
         virtual void alarm();

Modified: trunk/src/player.cc
===================================================================
--- trunk/src/player.cc	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/player.cc	2009-06-14 22:22:06 UTC (rev 1721)
@@ -116,7 +116,8 @@
 
 //    a->find_respawnpos();
     SendMessage(a, "_resurrect");
-    remove_extralife(a);
+    if (!server::InfiniteReincarnation)
+        remove_extralife(a);
     respawn_list.push_back(RespawnInfo(a, RESPAWN_TIME));
 }
 

Modified: trunk/src/server.cc
===================================================================
--- trunk/src/server.cc	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/server.cc	2009-06-14 22:22:06 UTC (rev 1721)
@@ -88,6 +88,7 @@
 bool     server::IsDifficult;               // read only for Lua
 bool     server::IsLevelRestart;            // no Lua access
 bool     server::ProvideExtralifes;
+bool     server::InfiniteReincarnation;
 bool     server::SurviveFinish;
 
 Value    server::FollowAction;
@@ -257,6 +258,7 @@
     server::LevelTime         = 0.0;
     server::ConserveLevel     = true;
     server::ProvideExtralifes = true;
+    server::InfiniteReincarnation = false;
     server::SurviveFinish     = true;
     server::TwoPlayerGame     = false;
     server::SingleComputerGame= true;

Modified: trunk/src/server.hh
===================================================================
--- trunk/src/server.hh	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/server.hh	2009-06-14 22:22:06 UTC (rev 1721)
@@ -64,6 +64,7 @@
     extern bool     IsDifficult;
     extern bool     IsLevelRestart;
     extern bool     ProvideExtralifes;
+    extern bool     InfiniteReincarnation;  // do not remove extralife on respawn
     extern bool     SurviveFinish;
     extern bool     TwoPlayerGame;
 

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/world.cc	2009-06-14 22:22:06 UTC (rev 1721)
@@ -644,7 +644,7 @@
 
     // All other force fields.
     for (ForceList::iterator i=forces.begin(); i != forces.end(); ++i) 
-        (*i)->add_force(a, f);
+        f += (*i)->globalForce(a);
 
     return f;
 }

Modified: trunk/src/world.hh
===================================================================
--- trunk/src/world.hh	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/src/world.hh	2009-06-14 22:22:06 UTC (rev 1721)
@@ -128,7 +128,7 @@
     class ForceField {
     public:
         virtual ~ForceField() {}
-        virtual void add_force(Actor *a, V2 &force) = 0;
+        virtual ecl::V2 globalForce(Actor *a) = 0;
         virtual void tick(double /*dtime*/) {}
     };
 



From raoul at mail.berlios.de  Mon Jun 15 20:06:18 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Mon, 15 Jun 2009 20:06:18 +0200
Subject: [Enigma-game-svn] r1722 - in trunk/data/levels: enigma_cross
	enigma_i enigma_ii enigma_ix enigma_viii
Message-ID: <200906151806.n5FI6IEU015949@sheep.berlios.de>

Author: raoul
Date: 2009-06-15 20:06:17 +0200 (Mon, 15 Jun 2009)
New Revision: 1722

Added:
   trunk/data/levels/enigma_ii/ant16_3.xml
   trunk/data/levels/enigma_ix/ais33_1.xml
   trunk/data/levels/enigma_viii/devnull34_2.xml
   trunk/data/levels/enigma_viii/devnull35_2.xml
Removed:
   trunk/data/levels/enigma_ii/ant16_2.xml
   trunk/data/levels/enigma_viii/devnull34_1.xml
   trunk/data/levels/enigma_viii/devnull35_1.xml
Modified:
   trunk/data/levels/enigma_cross/enigma0_92_1.xml
   trunk/data/levels/enigma_cross/newlevels.xml
   trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
   trunk/data/levels/enigma_i/index.xml
   trunk/data/levels/enigma_ii/index.xml
   trunk/data/levels/enigma_ix/index.xml
   trunk/data/levels/enigma_viii/index.xml
Log:
-> New level from Alex
-> Shortcutfixes from devnull
-> Rewritings



Modified: trunk/data/levels/enigma_cross/enigma0_92_1.xml
===================================================================
--- trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_cross/enigma0_92_1.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="33" title="Enigma 0.92 - 1"/>
+  <info enigma="1.00" group="Facets" location="15100" network="false" owner="Enigma Team" release="1" revision="34" title="Enigma 0.92 - 1"/>
 
   <attributes/>
 
@@ -94,7 +94,7 @@
     <level _seq="86" _title=".J.U.M.P." _xpath="enigma_i/martin60_1" author="Martin Hawlisch" ctrl="force" easy="false" id="martin60" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="87" _title="Walk The Plank" _xpath="enigma_v/nat04_1" author="Nat Pryce" ctrl="force" easy="false" id="nat4" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="88" _title="Shipwreck" _xpath="enigma_v/nat33_2" author="Nat Pryce" ctrl="force" easy="false" id="natmaze2" rel="2" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="89" _title="- Meditation -" _xpath="enigma_ii/ant16_2" author="Petr Machata" ctrl="force" easy="false" id="ant16" rel="2" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="89" _title="- Meditation -" _xpath="enigma_ii/ant16_3" author="Petr Machata" ctrl="force" easy="false" id="ant16" rel="3" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="90" _title="Dancers" _xpath="enigma_ii/ant14_2" author="Petr Machata" ctrl="force" easy="false" id="ant14" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="91" _title="Running Stone" _xpath="enigma_iv/christophanita01_1" author="Christoph &amp; Anita" ctrl="force" easy="false" id="christophanita_runningstone" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="92" _title="Where's The Gardener?" _xpath="enigma_i/siegfried28_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level9e" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_cross/newlevels.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="47" title="Enigma 1.00 new"/>
+  <info enigma="1.00" group="Facets" location="15400" network="false" owner="Enigma Team" release="1" revision="48" title="Enigma 1.00 new"/>
 
   <attributes/>
 
@@ -20,7 +20,7 @@
     <level _seq="12" _title="- Meditation -" _xpath="enigma_i/alain04_1" author="Alain Busser" ctrl="force" easy="false" id="alain04" rel="1" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="13" _title="Light Barrier" _xpath="enigma_i/richi03_1" author="Richi B?tzer" ctrl="force" easy="false" id="richi03" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="14" _title="Dead Ball Walking" _xpath="enigma_i/illmind08_2" author="illmind" ctrl="force" easy="false" id="illmind08" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="15" _title="The Enigmhanoi Towers" _xpath="enigma_i/alain05_2" author="Alain Busser" ctrl="force" easy="true" id="alain05" rel="2" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="15" _title="The Enigmhanoi Towers" _xpath="enigma_i/alain05_2" author="Alain Busser" ctrl="force" easy="true" id="alain05" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="16" _title="Mirror Room" _xpath="enigma_i/luc12_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc12" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="17" _title="Mirror Room II" _xpath="enigma_i/luc17_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc17" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="18" _title="Castle Maze" _xpath="enigma_i/luc19_1" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc19" rel="1" rev="0" score="1" target="time" unit="duration"/>

Modified: trunk/data/levels/enigma_cross/newlevels_1.1.0.xml
===================================================================
--- trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_cross/newlevels_1.1.0.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="55" title="Enigma 1.1 new"/>
+  <info enigma="1.00" group="Facets" location="15600" network="false" owner="Enigma Team" release="1" revision="56" title="Enigma 1.1 new"/>
 
   <attributes/>
 
@@ -109,7 +109,7 @@
     <level _seq="101" _title="Freestyle Microwire" _xpath="enigma_viii/ral29_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20080719ral530" rel="1" rev="129" score="1" target="time" unit="duration"/>
     <level _seq="102" _title="Balance Beam" _xpath="enigma_viii/mecke03_1" author="mecke" ctrl="force" easy="true" id="mecke03" rel="1" rev="37" score="1" target="time" unit="duration"/>
     <level _seq="103" _title="Colored Oxyds" _xpath="enigma_viii/andreas50_1" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas50" rel="1" rev="8" score="1" target="time" unit="duration"/>
-    <level _seq="104" _title="Styles Change" _xpath="enigma_viii/andreas48_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas48" rel="2" rev="19" score="2" target="time" unit="duration"/>
+    <level _seq="104" _title="Styles Change" _xpath="enigma_viii/andreas48_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas48" rel="2" rev="20" score="2" target="time" unit="duration"/>
     <level _seq="105" _title="Colored Turnstiles" _xpath="enigma_viii/andreas51_1" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas51" rel="1" rev="7" score="1" target="time" unit="duration"/>
     <level _seq="106" _title="Sanssouci" _xpath="enigma_viii/mecke05_1" author="mecke" ctrl="force" easy="true" id="mecke05" rel="1" rev="40" score="1" target="time" unit="duration"/>
     <level _seq="107" _title="Wired Shogun" _xpath="enigma_viii/ral34_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20080828ral417" rel="1" rev="129" score="1" target="time" unit="duration"/>
@@ -175,8 +175,9 @@
     <level _seq="167" _title="Path Through Flood" _xpath="enigma_viii/pulley24_1" author="Mark Pulley" ctrl="force" easy="false" id="20080803pulley001" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="168" _title="Sunrise Sunset" _xpath="enigma_viii/pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="169" _title="Filler" _xpath="enigma_viii/devnull33_1" author="/dev/null" ctrl="force" easy="false" id="devnull33" rel="1" rev="3" score="1" target="time" unit="duration"/>
-    <level _seq="170" _title="Help youself I" _xpath="enigma_viii/devnull34_1" author="/dev/null" ctrl="force" easy="true" id="devnull34" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="171" _title="Help youself II" _xpath="enigma_viii/devnull35_1" author="/dev/null" ctrl="force" easy="true" id="devnull35" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="170" _title="Crabwise I" _xpath="enigma_viii/devnull34_2" author="/dev/null" ctrl="force" easy="true" id="devnull34" rel="2" rev="3" score="2" target="time" unit="duration"/>
+    <level _seq="171" _title="Crabwise II" _xpath="enigma_viii/devnull35_2" author="/dev/null" ctrl="force" easy="true" id="devnull35" rel="2" rev="3" score="2" target="time" unit="duration"/>
+    <level _seq="172" _title="Su Dyxo" _xpath="enigma_ix/ais33_1" author="Alex Smith" ctrl="force" easy="true" id="20090525ais523001" rel="1" rev="2" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Modified: trunk/data/levels/enigma_i/index.xml
===================================================================
--- trunk/data/levels/enigma_i/index.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_i/index.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10200" network="false" owner="Enigma Team" release="1" revision="24" title="Enigma I"/>
+  <info enigma="1.00" group="Enigma" location="10200" network="false" owner="Enigma Team" release="1" revision="25" title="Enigma I"/>
 
   <attributes/>
 
@@ -57,7 +57,7 @@
     <level _seq="49" _title="Hall of Glass" _xpath="./martin86_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin86" rel="2" rev="2" score="1" target="time" unit="duration"/>
     <level _seq="50" _title="- Meditation -" _xpath="./siegfried36_2" author="Siegfried Fennig" ctrl="force" easy="false" id="meditation15" rel="2" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="51" _title="Deadly Cross" _xpath="./martin84_2" author="Martin Hawlisch" ctrl="force" easy="false" id="martin84" rel="2" rev="2" score="1" target="time" unit="duration"/>
-    <level _seq="52" _title="The Enigmhanoi Towers" _xpath="./alain05_2" author="Alain Busser" ctrl="force" easy="true" id="alain05" rel="2" rev="3" score="1" target="time" unit="duration"/>
+    <level _seq="52" _title="The Enigmhanoi Towers" _xpath="./alain05_2" author="Alain Busser" ctrl="force" easy="true" id="alain05" rel="2" rev="4" score="1" target="time" unit="duration"/>
     <level _seq="53" _title="Mirror Room" _xpath="./luc12_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc12" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="54" _title="Annoying little balls" _xpath="./wb09_2" author="Jon 'WB' Sneyers" ctrl="force" easy="false" id="wb9" rel="2" rev="0" score="2" target="time" unit="duration"/>
     <level _seq="55" _title="Mirror Room II" _xpath="./luc17_2" author="Lukas Sch?ller" ctrl="force" easy="false" id="luc17" rel="2" rev="1" score="1" target="time" unit="duration"/>

Deleted: trunk/data/levels/enigma_ii/ant16_2.xml
===================================================================
--- trunk/data/levels/enigma_ii/ant16_2.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_ii/ant16_2.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,48 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="- Meditation -" el:subtitle="" el:id="ant16"/>
-      <el:version el:score="1" el:release="2" el:revision="1" el:status="released"/>
-      <el:author  el:name="Petr Machata" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2003 Petr Machata</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10">
-        <el:dependency el:path="lib/libmaze" el:id="lib/libmaze" el:release="2" el:preload="true"/>
-      </el:compatibility>
-      <el:modes el:easy="false" el:single="true" el:network="false"/>
-      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
-      <el:score el:easy="-" el:difficult="-"/>
-    </el:info>
-    <el:luamain><![CDATA[
-ti[" "] = {"fl_bluegray"}
-ti["-"] = {"fl_samba"}
-ti["~"] = {"fl_water"}
-ti["#"] = {"st_granite"}
-ti["o"] = {"it_meditation_hollow"}
-ti["@"] = {"it_magnet", state=ON} .. ti({"#ac_pearl", essential=INDISPENSIBLE})
-
-maze = res.maze(ti, {area={"~"}, render={"-", "~", "-"}})
-
-wo(maze, " ", {
-    "####################",
-    "#   ~~~~~~~~~~~~~  #",
-    "# @ ~~~~~~~~~~~~~ o#",
-    "#   ~~~~~~~~~~~~~  #",
-    "#   ~~~~~~~~~~~~~  #",
-    "#   ~~~~~~~~~~~~~  #",
-    "# @ ~~~~~~~~~~~~~ o#",
-    "#   ~~~~~~~~~~~~~  #",
-    "#   ~~~~~~~~~~~~~  #",
-    "#   ~~~~~~~~~~~~~  #",
-    "# @ ~~~~~~~~~~~~~ o#",
-    "#   ~~~~~~~~~~~~~  #",
-    "####################"})
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_ii/ant16_3.xml (from rev 1716, trunk/data/levels/enigma_ii/ant16_2.xml)
===================================================================
--- trunk/data/levels/enigma_ii/ant16_2.xml	2009-06-12 22:19:19 UTC (rev 1716)
+++ trunk/data/levels/enigma_ii/ant16_3.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -0,0 +1,57 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="- Meditation -" el:subtitle="" el:id="ant16"/>
+      <el:version el:score="2" el:release="3" el:revision="2" el:status="released"/>
+      <el:author  el:name="Petr Machata" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2003 Petr Machata</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+        <el:dependency el:path="lib/libmaze" el:id="lib/libmaze" el:release="2" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments><el:code>New API converted by R. Bourquin</el:code></el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_bluegray"}
+ti["-"] = {"fl_samba"}
+ti["~"] = {"fl_water"}
+ti["="] = ti["~"] .. {"st_death"}      -- no maze water
+ti["#"] = {"st_granite"}
+ti["o"] = {"it_meditation_hollow"}
+ti["@"] = {"it_magnet", state=ON} .. ti({"#ac_pearl", essential=INDISPENSIBLE})
+
+maze = res.maze(ti, {area={"~"}, render={"-", "~", "-"}})
+
+map = wo:newMap(" ", {
+    "####################",
+    "#   ~~~~~~~~~~~~~  #",
+    "# @ ~~~~~~~~~~~~~ o#",
+    "#   ~~~~~~~~~~~~~  #",
+    "#   ~~~~~~~~~~~~~  #",
+    "#   ~~~~~~~~~~~~~  #",
+    "# @ ~~~~~~~~~~~~~ o#",
+    "#   ~~~~~~~~~~~~~  #",
+    "#   ~~~~~~~~~~~~~  #",
+    "#   ~~~~~~~~~~~~~  #",
+    "# @ ~~~~~~~~~~~~~ o#",
+    "#   ~~~~~~~~~~~~~  #",
+    "####################"})
+
+-- prohibit straight west-east paths
+columns = lib.lua.shuffle({5,7,9,11,13,15})
+for i=1,6 do
+    map[{columns[i], 2*i - 1}] = "="
+end
+
+wo(maze, map)
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_ii/index.xml
===================================================================
--- trunk/data/levels/enigma_ii/index.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_ii/index.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10300" network="false" owner="Enigma Team" release="1" revision="28" title="Enigma II"/>
+  <info enigma="1.00" group="Enigma" location="10300" network="false" owner="Enigma Team" release="1" revision="29" title="Enigma II"/>
 
   <attributes/>
 
@@ -75,7 +75,7 @@
     <level _seq="67" _title="Khun Phan" _xpath="./ralf10_1" author="Ralf Westram" ctrl="force" easy="false" id="ralf10" rel="1" rev="0" score="1" target="time" unit="duration"/>
     <level _seq="68" _title="Almost There" _xpath="./duffy89_1" author="Jacob Scott" ctrl="force" easy="false" id="duffy89" rel="1" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="69" _title="Question of Speed" _xpath="./siegfried32_1" author="Siegfried Fennig" ctrl="force" easy="false" id="level11b" rel="1" rev="0" score="1" target="time" unit="duration"/>
-    <level _seq="70" _title="- Meditation -" _xpath="./ant16_2" author="Petr Machata" ctrl="force" easy="false" id="ant16" rel="2" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="70" _title="- Meditation -" _xpath="./ant16_3" author="Petr Machata" ctrl="force" easy="false" id="ant16" rel="3" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="71" _title="Come To Me" _xpath="./ant20_2" author="Petr Machata" ctrl="force" easy="false" id="ant20" rel="2" rev="2" score="2" target="time" unit="duration"/>
     <level _seq="72" _title="Water Holes" _xpath="./siegfried10_2" author="Siegfried Fennig" ctrl="force" easy="false" id="level3f" rel="2" rev="1" score="1" target="time" unit="duration"/>
     <level _seq="73" _title="Follow the Leader" _xpath="./martin71_2" author="Martin Hawlisch" ctrl="force" easy="true" id="martin71" rel="2" rev="4" score="2" target="time" unit="duration"/>

Added: trunk/data/levels/enigma_ix/ais33_1.xml
===================================================================
--- trunk/data/levels/enigma_ix/ais33_1.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_ix/ais33_1.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -0,0 +1,741 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?> <!-- -*- mode:lua; lua-indent-level:4 -*- -->
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Su Dyxo" el:subtitle="" el:id="20090525ais523001"/>
+      <el:version el:score="1" el:release="1" el:revision="2" el:status="released"/>
+      <el:author  el:name="Alex Smith" el:email="ais523 at bham.ac.uk" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 Alex Smith</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:score el:easy="-" el:difficult="10:20"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["ConserveLevel"] = false
+wo["ProvideExtralifes"] = false
+
+-- Defining cells
+basefloor = "fl_bright"
+ti[" "] = {basefloor,adhesion=2,friction=5}
+ti["#"] = {"st_fake_oxydc",state=OPEN}
+ti["."] = {"fl_dark",adhesion=2,friction=5}
+ti["|"] = {"it_strip_ns"}
+ti["-"] = {"it_strip_ew"}
+ti["+"] = {"it_strip_nesw"}
+ti["D"] = {"st_door_b"}
+ti["="] = {"st_lightglass"}
+ti["T"] = {"st_thief"}
+ti["x"] = {"st_oxyd_c"}
+if wo["IsDifficult"] then
+    ti["O"] = ti({"#ac_marble"}) .. {"it_document",text="text1"}
+    ti["S"] = ti["#"]
+else
+    ti["O"] = ti({"#ac_marble"}) .. {"it_document",text="text2"}
+    ti["S"] = {"st_monoflop",interval=60,action="callback",target="clue"}
+end
+-- The items used
+items = {"it_banana", "it_brush", "it_coffee", "it_floppy", "it_hammer",
+         "it_magicwand", "it_key", "it_sword", "it_glasses"}
+for v = 1,9 do
+    ti[""..v] = {items[v]}
+end
+
+w, h = wo(ti," ",{
+    ".............S######",
+    ".   |   |   .OD#D Dx",
+    ".   |   |   .#D#D#D#",
+    ".   |   |   .#D#D#D#",
+    ".---+---+---.# # # #",
+    ".   |   |   .#D#D#D#",
+    ".   |   |   .#D#D#D#",
+    ".   |   |   .#D#D#D#",
+    ".---+---+---.# # # #",
+    ".   |   |   .#D#D#D#",
+    ".   |   |   .#D#D#D#",
+    ".   |   |   .#D D#Dx",
+    ".............#######"})
+
+wo:add({"ot_timer",interval=0.1,action="callback",target="checkitems"})
+
+-------------------------------------------------------------------------------
+-- Code for generating a Sudoku puzzle
+
+-- Helper functions
+function boxof(x,y)
+    local b = 1
+    if x > 3 then b = b + 1 end
+    if x > 6 then b = b + 1 end
+    if y > 3 then b = b + 3 end
+    if y > 6 then b = b + 3 end
+    return b
+end
+
+function randomlegal(f,m)
+    local legalcount = 0
+    local rv = nil
+    for c = 1,m do
+        if f(c) then
+            legalcount = legalcount + 1
+            if random(1,legalcount) == 1 then
+                rv = c
+            end
+        end
+    end
+    return rv
+end
+
+function randomlegalpair(f,m1,m2)
+    local legalcount = 0
+    local rv1 = nil
+    local rv2 = nil
+    for c1 = 1,m1 do for c2 = 1,m2 do
+        if f(c1,c2) then
+            legalcount = legalcount + 1
+            if random(1,legalcount) == 1 then
+                rv1 = c1; rv2 = c2
+            end
+        end
+    end end
+    return rv1, rv2
+end
+
+-- Global variables
+-- Numbers unused in each row
+ru = {{true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true}}
+-- Numbers unused in each column
+cu = {{true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true}}
+-- Numbers unused in each box
+bu = {{true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true},
+      {true,true,true,true,true,true,true,true,true}}
+-- The answer grid
+g  = {{0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0}}
+-- The puzzle grid
+pg = {{0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0},
+      {0,0,0,0,0,0,0,0,0}}
+-- Calculating a puzzle
+-- Setting the puzzle consists of alternately adding a random legal value to
+-- a random location, and then deducing all the numbers that we can.
+-- Most iterations of this will be correct; occasionally it will make a mistake,
+-- and when a mistake is detected, it will randomly remove numbers in the same
+-- row or column and re-solve the puzzle, which leads to a correct solution
+-- eventually. Even with debug data, this program generally runs in less than
+-- about a second; without, I've never seen it take longer than 0.3s, and it
+-- normally beats a quarter of a second.
+cellcount = 0
+-- Debug?
+-- dprint = print
+dprint = function(x) end
+
+cluecount = 99
+rededuce = false
+-- We want exactly 33 clues.
+while cluecount > 33 do
+    -- Favour filling the centre cell of all (this makes it overwhelmingly likely,
+    -- although not guaranteed as it might be removed later); that tends to lead to
+    -- slightly more aesthetic puzzles (odd number of clues = even number of items)
+    oldx = 5
+    oldy = 5
+    while cellcount < 81 do
+        if not rededuce then
+        -- Pick a cell to fill, symmetrically if possible
+        if oldx > 0 and g[10-oldx][10-oldy] == 0 then
+        x = 10-oldx
+        y = 10-oldy
+        choicetype = "Symmetrically "
+        else
+        -- Find a random unoccupied cell
+        x,y = randomlegalpair(function(xi,yi) return g[xi][yi] == 0 end, 9, 9)
+        choicetype = "Randomly "
+        end
+        oldx = x
+        oldy = y
+        b = boxof(x,y)
+        -- Verify that there is a legal value
+        v = randomlegal(function(i) return ru[y][i] and cu[x][i] and bu[b][i] end, 9)
+        if not(v==nil) then
+        -- There is a legal value, use it
+        dprint(choicetype .. "setting "..v.." at ("..x..","..y..")")
+        g[x][y] = v
+        pg[x][y] = v
+        ru[y][v] = false
+        cu[x][v] = false
+        bu[b][v] = false
+        cellcount = cellcount + 1
+        else
+        -- We have a contradiction; pick a random filled cell in the same row
+        -- or column, clear it, then clear our deductions
+        xi = x
+        yi = y
+        oldx = 0
+        oldy = 0
+        while pg[xi][yi] == 0 do
+            if random(1,2) == 1 then
+            xi = x; yi = random(1,9)
+            else
+            yi = y; xi = random(1,9)
+            end
+        end
+        dprint("Clearing the cell at ("..xi..","..yi..") as there's a contradiction")
+        pg[xi][yi] = 0
+        pg[10-xi][10-yi] = 0
+        for x = 1,9 do for y = 1,9 do
+            if pg[x][y] == 0 and g[x][y] > 0 then
+            b = boxof(x,y)
+            v = g[x][y]
+            g[x][y] = 0
+            ru[y][v] = true
+            cu[x][v] = true
+            bu[b][v] = true
+            cellcount = cellcount - 1
+            end
+        end end
+        end
+        else
+            rededuce = false
+        end
+    -- Loop, deducing all the cells we can
+    changemade = true
+    while changemade do
+        changemade = false
+        -- Look for cells with only one possible value
+        for x = 1,9 do for y = 1,9 do if g[x][y] == 0 then
+        b = boxof(x,y)
+        vcount = 0
+        lastv = 0
+        for v = 1,9 do
+            if ru[y][v] and cu[x][v] and bu[b][v] then
+            vcount = vcount + 1
+            lastv = v
+            end
+        end
+        if vcount == 1 then
+            -- Only one possible value, set the cell
+            dprint("Setting "..lastv.." at ("..x..","..y..") as the only possibility")
+            g[x][y] = lastv
+            ru[y][lastv] = false
+            cu[x][lastv] = false
+            bu[b][lastv] = false
+            cellcount = cellcount + 1
+            changemade = true
+        end
+        end end end
+        -- Look for columns with only one place to put a given value
+        for x = 1,9 do for v = 1,9 do if cu[x][v] then
+        ycount = 0
+        lasty = 0
+        for y = 1,9 do
+            if ru[y][v] and bu[boxof(x,y)][v] and g[x][y] == 0 then
+            ycount = ycount + 1
+            lasty = y
+            end
+        end
+        if ycount == 1 then
+            -- Only one possible location, set the cell
+            dprint("Setting "..v.." at ("..x..","..lasty..") as the only place in the column")
+            g[x][lasty] = v
+            ru[lasty][v] = false
+            cu[x][v] = false
+            bu[boxof(x,lasty)][v] = false
+            cellcount = cellcount + 1
+            changemade = true
+        end
+        end end end
+        -- Look for rows with only one place to put a given value
+        for y = 1,9 do for v = 1,9 do if ru[y][v] then
+        xcount = 0
+        lastx = 0
+        for x = 1,9 do
+            if cu[x][v] and bu[boxof(x,y)][v] and g[x][y] == 0 then
+            xcount = xcount + 1
+            lastx = x
+            end
+        end
+        if xcount == 1 then
+            -- Only one possible location, set the cell
+            dprint("Setting "..v.." at ("..lastx..","..y..") as the only place in the row")
+            g[lastx][y] = v
+            ru[y][v] = false
+            cu[lastx][v] = false
+            bu[boxof(lastx,y)][v] = false
+            cellcount = cellcount + 1
+            changemade = true
+        end
+        end end end
+    end
+    end
+    -- Symmetrize the puzzle
+    for x = 1,9 do for y = 1,9 do
+    if pg[10-x][10-y] > 0 and pg[x][y] == 0 then
+        dprint("Making the puzzle symmetrical at ("..x..","..y..")")
+        pg[x][y] = g[x][y]
+    end
+    end end
+    -- Fill in unreachable squares and count clues
+    cluecount = 0
+    for x = 1,9 do for y = 1,9 do
+    -- If this cell is unreachable, give it to the player as another hint cell
+    if (x == 2 or x == 5 or x == 8) and (y == 2 or y == 5 or y == 8) then
+        if pg[x-1][y] > 0 and pg[x+1][y] > 0 and pg[x][y-1] > 0 and pg[x][y+1] > 0 then
+        dprint("Filling in unreachable square at ("..x..","..y..")")
+        pg[x][y] = g[x][y]
+        end
+    end
+    -- Count clue cells
+    if pg[x][y] > 0 then cluecount = cluecount + 1 end
+    end end
+    -- If we have too many clues, then eliminate some clues in crowded squares.
+    -- (if we have too /few/, then we can add more later.)
+    -- To randomly favour crowded squares, we pick random clues to eliminate
+    -- until we pick two in the same box.
+    if cluecount > 33 then
+        b = 10
+        boxpicked = {}
+        while boxpicked[b] == nil do
+            boxpicked[b] = 1
+            x, y = randomlegalpair(function(xi,yi) return pg[xi][yi] > 0 end, 9, 9)
+            b = boxof(x,y)
+        end
+        -- Clear all deductions; we'll rededuce next time through the loop.
+        dprint("Eliminating clue at ("..x..","..y..") and opposite to increase difficulty")
+    pg[x][y] = 0
+    pg[10-x][10-y] = 0
+        rededuce = true
+    for x = 1,9 do for y = 1,9 do
+        if pg[x][y] == 0 and g[x][y] > 0 then
+        b = boxof(x,y)
+        v = g[x][y]
+        g[x][y] = 0
+        ru[y][v] = true
+        cu[x][v] = true
+        bu[b][v] = true
+        cellcount = cellcount - 1
+        end
+    end end
+    end
+end
+
+-- Give extra clues if necessary; there must be at least (81-48) = 33 clues so
+-- we have space to fit all the items. Note that this only fills corner and centre
+-- squares of a box, so as not to cause unreachability. (There must be one of those
+-- left; filling all the corner and centre squares would be 45 clues.)
+while cluecount < 33 do
+    if pg[5][5] == 0 then
+        -- (5,5) must be filled, or we'll end up with an even number of clues
+        x = 5
+        y = 5
+    else
+        x,y = randomlegalpair(function(xi,yi)
+            local xc = (xi % 3 == 2)
+            local yc = (yi % 3 == 2)
+            return pg[xi][yi] == 0 and ((xc and yc) or ((not xc) and (not yc)))
+        end, 9, 9)
+    end
+    pg[x][y] = g[x][y]
+    dprint("Adding extra clue at ("..x..","..y..") to make up numbers")
+    cluecount = cluecount + 1
+    if pg[10-x][10-y] == 0 then -- it might not be if this is (5,5)
+        pg[10-x][10-y] = g[10-x][10-y]
+        dprint("Adding extra clue at ("..(10-x)..","..(10-y)..") for symmetry")
+        cluecount = cluecount + 1
+    end
+end
+
+-------------------------------------------------------------------------------
+
+neededcount = {0,0,0,0,0,0,0,0,0}
+
+-- Now the puzzle's been generated, set up the grid accordingly
+for x = 1,9 do for y = 1,9 do
+    -- Deduce the world coordinates for this puzzle cell
+    xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+    yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+    if pg[x][y] > 0 then
+        -- Place the item on the grid, using glass so it can't be moved
+        wo[{xi,yi}] = ti["="]..ti[""..pg[x][y]]
+    else
+        neededcount[g[x][y]] = neededcount[g[x][y]] + 1
+    end
+end end
+
+-- Add the items to place to the map, in a cyclic manner
+function firstneeded()
+    for v=1,9 do
+        if neededcount[v] > 0 then
+            neededcount[v] = neededcount[v] - 1
+            return v
+        end
+    end
+end
+
+for x = 0,11 do
+    wo[{x,0}] = ti[""..firstneeded()]
+end
+for y = 0,11 do
+    wo[{12,y}] = ti[""..firstneeded()]
+end
+for x = 0,11 do
+    wo[{12-x,12}] = ti[""..firstneeded()]
+end
+for y = 0,11 do
+    wo[{0,12-y}] = ti[""..firstneeded()]
+end
+
+-------------------------------------------------------------------------------
+
+-- Things that happen during the level
+
+-- Maintain a list of items that the user can pick up whenever they want
+
+-- The x/y coordinates which hold Sudoku locations
+coords = {1,2,3,5,6,7,9,10,11}
+
+-- Where the items were last iteration: a table of x*11+y to item names,
+-- or "nil" if there are no items
+itemlocations = {}
+
+-- Check the map to see which rows/columns/boxes are correct
+function checkitems()
+    local needchange = false
+    for x = 1,11 do for y = 1,11 do
+        local k = nil
+        if -it({x,y}) then k = it({x,y}):kind() end
+        if not (itemlocations[x*11+y] == k) then
+            itemlocations[x*11+y] = k
+            needchange = true
+        end
+    end end
+    if not needchange then return end
+    -- the ._k attribute is used to store the kind of floor that we
+    -- want to set the floor to; this allows the floor to be updated
+    -- only if it would actually change
+    for x = 1,11 do for y = 1,11 do fl({x,y})._k = basefloor end end
+    -- Check columns
+    for i = 1,#coords do x = coords[i]
+        -- t counts how many of each item there are
+        -- c counts different items, d counts duplicates
+        local t = {}
+        local c = 0
+        local d = 0
+        for j = 1,#coords do y = coords[j]
+            if itemlocations[x*11+y] ~= nil then
+                local k = itemlocations[x*11+y]
+                if t[k] == nil then
+                    t[k] = 1; c = c + 1
+                else
+                    t[k] = t[k] + 1; d = d + 1
+                end
+            end
+        end
+        -- Set floor colour appropriately:
+        -- A correct line shows green where it crosses the strips
+        -- An incorrect line shows red where it crosses the strips and
+        -- under each offending item
+        for y = 1,11 do
+            if itemlocations[x*11+y] ~= nil then
+                local k = itemlocations[x*11+y]
+                if t[k] == nil then
+                    if c==9 then
+                        fl({x,y})._k = "fl_lawn"
+                    elseif d>0 then
+                        fl({x,y})._k = "fl_red"
+                    end
+                elseif t[k]>1 then fl({x,y})._k = "fl_red"
+                end
+            end
+        end
+        -- Open/close the door according to if this column is correct
+        if c==9 then st({16,x}):open() else st({16,x}):close() end
+    end
+    -- Check rows; this is identical to checking the columns, but
+    -- with x and y swapped
+    for i = 1,#coords do y = coords[i]
+        local t = {}
+        local c = 0
+        local d = 0
+        for j = 1,#coords do x = coords[j]
+            if itemlocations[x*11+y] ~= nil then
+                local k = itemlocations[x*11+y]
+                if t[k] == nil then
+                    t[k] = 1; c = c + 1
+                else
+                    t[k] = t[k] + 1; d = d + 1
+                end
+            end
+        end
+        for x = 1,11 do
+            if itemlocations[x*11+y] ~= nil then
+                local k = itemlocations[x*11+y]
+                if t[k] == nil then
+                    if c==9 then
+                        fl({x,y})._k = "fl_lawn"
+                    elseif d>0 then
+                        fl({x,y})._k = "fl_red"
+                    end
+                elseif t[k]>1 then fl({x,y})._k = "fl_red"
+                end
+            end
+        end
+        if c==9 then st({14,y}):open() else st({14,y}):close() end
+    end
+    -- Check boxes
+    for i=1,3 do for j=1,3 do
+        local t = {}
+        local c = 0
+        local d = 0
+        for x=(i*4-3),(i*4-1) do for y=(j*4-3),(j*4-1) do
+            if itemlocations[x*11+y] ~= nil then
+                local k = itemlocations[x*11+y]
+                if t[k] == nil then
+                    t[k] = 1; c = c + 1
+                else
+                    t[k] = t[k] + 1; d = d + 1
+                end
+            end
+        end end
+        -- Colouring rules for boxes are slightly different:
+        -- A correct box marks the whole box green, except
+        -- for cells already marked red by a previous step
+        -- An incorrect box marks the offending items in red
+        for x=(i*4-3),(i*4-1) do for y=(j*4-3),(j*4-1) do
+            if itemlocations[x*11+y] ~= nil and fl({x,y})._k == basefloor then
+                local k = itemlocations[x*11+y]
+                if t[k]>1 then fl({x,y})._k = "fl_red"
+                elseif c==9 then fl({x,y})._k = "fl_lawn"
+                end
+            end
+        end end
+        if c==9 then st({18,(j-1)*4+i}):open() else st({18,(j-1)*4+i}):close() end
+    end end
+    -- Now do the actual colouring, changing the kind of cells
+    -- only if it's different from what's already there (to avoid the
+    -- visual effect of repeatedly replacing floors with a different
+    -- variant, and to improve performance slightly)
+    for x = 1,11 do for y = 1,11 do
+        if fl({x,y})._k ~= fl({x,y}):kind() then
+            wo[{x,y}]={fl({x,y})._k,adhesion=2,friction=5}
+        end
+    end end
+end
+
+-- Give the user a clue, in easy mode, by marking all misplaced items and
+-- squares which can be deduced
+function clue(value, caller)
+    local continuemarking = false
+    if value then
+        -- Look for misplaced items
+        continuemarking = 1
+        for x = 1,9 do
+            for y = 1,9 do
+                -- Deduce the world coordinates for this puzzle cell
+                xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+                yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+                -- Check which item is here, and if it's wrong
+                if -it({xi,yi}) and it({xi,yi}):kind() ~= items[g[x][y]] then
+                    wo[{xi,yi}] = {"fl_red",adhesion=2,friction=5,_k="fl_red"}
+                    continuemarking = false
+                end
+            end
+        end
+    end
+    -- If all items are correct, then go onto orange and yellow marks
+    if continuemarking then
+        -- Numbers unused in each row
+        ru = {{true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true}}
+        -- Numbers unused in each column
+        cu = {{true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true}}
+        -- Numbers unused in each box
+        bu = {{true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true},
+              {true,true,true,true,true,true,true,true,true}}
+        -- Find out what numbers are unused in each row/column/box
+        for x = 1,9 do
+            for y = 1,9 do
+                xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+                yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+                if -it({xi,yi}) then
+                    for v = 1,9 do
+                        if it({xi,yi}):kind() == items[v] then
+                            ru[y][v] = false
+                            cu[x][v] = false
+                            bu[boxof(x,y)][v] = false
+                        end
+                    end
+                end
+            end
+        end
+        -- Mark only-position-in-row/column/box yellow
+        -- row
+        for x = 1,9 do
+            for v = 1,9 do
+                -- Find all possible positions for v on row x
+                -- (ypos holds 0 = no positions, position = 1 position, 10 = more than 1)
+                ypos = 0
+                for y = 1,9 do
+                    xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+                    yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+                    if ru[y][v] and cu[x][v] and bu[boxof(x,y)][v] and not -it({xi,yi}) then
+                        if ypos == 0 then ypos = y else ypos = 10 end
+                    end
+                end
+                -- Draw the yellow marking if there's exactly one
+                if ypos > 0 and ypos < 10 then
+                    y = ypos
+                    xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+                    yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+                    if not -it({xi,yi}) then
+                        wo[{xi,yi}] = {"fl_sahara",adhesion=2,friction=5,_k="fl_sahara"}
+                    end
+                end
+            end
+        end
+        -- column
+        for y = 1,9 do
+            for v = 1,9 do
+                -- Find all possible positions for v on column y
+                xpos = 0
+                for x = 1,9 do
+                    xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+                    yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+                    if ru[y][v] and cu[x][v] and bu[boxof(x,y)][v] and not -it({xi,yi}) then
+                        if xpos == 0 then xpos = x else xpos = 10 end
+                    end
+                end
+                -- Draw the yellow marking if there's exactly one
+                if xpos > 0 and xpos < 10 then
+                    x = xpos
+                    xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+                    yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+                    if not -it({xi,yi}) then
+                        wo[{xi,yi}] = {"fl_sahara",adhesion=2,friction=5,_k="fl_sahara"}
+                    end
+                end
+            end
+        end
+        -- box
+        for xb = 1,3 do
+            for yb = 1,3 do
+                b = boxof(x*3,y*3)
+                for v = 1,9 do
+                    -- Find all possible positions in this box
+                    xpos = 0
+                    ypos = 0
+                    for x = xb*3-2,xb*3 do
+                        for y = yb*3-2,yb*3 do
+                            xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+                            yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+                            if ru[y][v] and cu[x][v] and bu[boxof(x,y)][v] and not -it({xi,yi}) then
+                                if xpos == 0 then xpos = x else xpos = 10 end
+                                if ypos == 0 then ypos = y else ypos = 10 end
+                            end
+                        end
+                    end
+                    -- Draw the yellow marking if there's exactly one
+                    if xpos > 0 and xpos < 10 then
+                        x = xpos
+                        y = ypos
+                        xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+                        yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+                        if not -it({xi,yi}) then
+                            wo[{xi,yi}] = {"fl_sahara",adhesion=2,friction=5,_k="fl_sahara"}
+                        end
+                    end
+                end
+            end
+        end
+        -- Mark unfillable cells in red, fillable-now cells in orange
+        for x = 1,9 do
+            for y = 1,9 do
+                xi = x; if xi > 6 then xi = xi + 1 end; if xi > 3 then xi = xi + 1 end
+                yi = y; if yi > 6 then yi = yi + 1 end; if yi > 3 then yi = yi + 1 end
+                if not -it({xi,yi}) then
+                    pcount = 0
+                    for v = 1,9 do
+                        if ru[y][v] and cu[x][v] and bu[boxof(x,y)][v] then pcount = pcount + 1 end
+                    end
+                    if pcount == 0 then
+                        -- should never happen; a space can't be unfillable if
+                        -- all items are placed directly
+                        wo[{xi,yi}] = {"fl_red",adhesion=2,friction=5,_k="fl_red"}
+                    elseif pcount == 1 then
+                        wo[{xi,yi}] = {"fl_sand",adhesion=2,friction=5,_k="fl_sand"}
+                    end
+                end
+            end
+        end
+    end
+end
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="false"/>
+      </el:string>
+      <el:string el:key="text1">
+        <el:english el:translate="true">Place 9 different items in each row, column, and 3x3 box.</el:english>
+      </el:string>
+      <el:string el:key="text2">
+        <el:english el:translate="true">Place 9 different items in each row, column, and 3x3 box. Hit the switch to see if any of your items are misplaced, or which locations you can deduce items for next; you can only get 1 hint per minute this way, though.</el:english>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>


Property changes on: trunk/data/levels/enigma_ix/ais33_1.xml
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/data/levels/enigma_ix/index.xml
===================================================================
--- trunk/data/levels/enigma_ix/index.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_ix/index.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,12 +1,13 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="11100" network="false" owner="Enigma Team" release="1" revision="1" title="Enigma IX"/>
+  <info enigma="1.00" group="Enigma" location="11100" network="false" owner="Enigma Team" release="1" revision="2" title="Enigma IX"/>
 
   <attributes/>
 
   <levels>
     <level _seq="1" _title="Welcome" _xpath="./welcometopack9_1" author="Raoul Bourquin" ctrl="force" easy="true" id="welcometopack9" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="2" _title="Su Dyxo" _xpath="./ais33_1" author="Alex Smith" ctrl="force" easy="true" id="20090525ais523001" rel="1" rev="2" score="1" target="time" unit="duration"/>
   </levels>
 
 </index>

Deleted: trunk/data/levels/enigma_viii/devnull34_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/devnull34_1.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_viii/devnull34_1.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,52 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Help youself I" el:subtitle="" el:id="devnull34"/>
-      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
-      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2009 dev0</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10"/>
-      <el:modes el:easy="true" el:single="true" el:network="false"/>
-      <el:score el:easy="3:00" el:difficult="5:00"/>
-    </el:info>
-    <el:luamain><![CDATA[
-ti[" "] = {"fl_rock"}
-ti["-"] = {"fl_water"}
-ti["#"] = ti["-"] .. {"st_redrock"}
-ti["~"] = cond(wo["IsDifficult"], ti["-"], ti["#"])
-ti["."] = cond(wo["IsDifficult"], ti["-"], ti[" "])
-ti["R"] = {"st_box_rock"}
-ti["S"] = {"st_granite_movable"}
-ti["X"] = {"st_grate_cross"}
-ti["box"] = {"st_box_hay", "box%%"}
-ti["pull"] = {"st_pull", "pull%%"}
-ti["O"] = {"st_oxyd_a", static = true, oxydcolor = OXYD_RED}
-ti["@"] = {"#ac_marble_black", essential = INDISPENSIBLE}
-
-wo(res.autotile(ti, {"1", "2", "box"}, {"3", "4", "pull"}), " ", {
-    "####################",
-    "#        -#- ~     #",
-    "#        -#~   #   #",
-    "# 3 @     -   ~# 1 #",
-    "#        -#~   #   #",
-    "#        -#- ~     #",
-    "##################X#",
-    "# ~R   --#         #",
-    "#      --#         #",
-    "# 4  ~--R-    S  2 #",
-    "#   .~---#         #",
-    "O-  R~---#         #",
-    "#O##################"})
-
-wo:add({"ot_wire", anchor1 = "box%1", anchor2 = "pull%1"})
-wo:add({"ot_wire", anchor1 = "box%2", anchor2 = "pull%2"})
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_viii/devnull34_2.xml (from rev 1720, trunk/data/levels/enigma_viii/devnull34_1.xml)
===================================================================
--- trunk/data/levels/enigma_viii/devnull34_1.xml	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/data/levels/enigma_viii/devnull34_2.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -0,0 +1,57 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Crabwise I" el:subtitle="" el:id="devnull34"/>
+      <el:version el:score="2" el:release="2" el:revision="3" el:status="released"/>
+      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 dev0</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:credits el:showinfo="true" el:showstart="true">Thanks to daydreamer (CMoSCR)</el:credits>
+      </el:comments>
+      <el:score el:easy="3:00" el:difficult="5:00"/>
+    </el:info>
+    <el:luamain><![CDATA[
+ti[" "] = {"fl_rock"}
+ti["-"] = {"fl_water"}
+ti["#"] = ti({"fl_abyss"}) .. {"st_redrock"}
+ti["="] = ti["#"] .. {"it_death"}
+ti["~"] = cond(wo["IsDifficult"], ti["-"], ti["#"])
+ti["."] = cond(wo["IsDifficult"], ti["-"], ti[" "])
+ti["R"] = {"st_box_rock"}
+ti["S"] = {"st_granite_movable"}
+ti["X"] = {"st_grate_cross"}
+ti["box"] = {"st_box_hay", "box%%"}
+ti["pull"] = {"st_pull", "pull%%"}
+ti["O"] = {"st_oxyd_a", static = true, oxydcolor = OXYD_RED}
+ti["@"] = {"#ac_marble_black"}
+
+wo(res.autotile(ti, {"1", "2", "box"}, {"3", "4", "pull"}), " ", {
+    "####################",
+    "#        -=- ~     #",
+    "#        -=~   #   #",
+    "# 3 @     -   ~# 1 #",
+    "#        -=~   #   #",
+    "#        -=- ~     #",
+    "#=================X#",
+    "# ~R   --=         #",
+    "#      --=         #",
+    "# 4  ~--R-    S  2 #",
+    "#   .~---=         #",
+    "O-  R~---=         #",
+    "#O##################"})
+
+wo:add({"ot_wire", anchor1 = "box%1", anchor2 = "pull%1"})
+wo:add({"ot_wire", anchor1 = "box%2", anchor2 = "pull%2"})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="true"/>
+        <el:translation el:lang="de">Hintenrum I</el:translation>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Deleted: trunk/data/levels/enigma_viii/devnull35_1.xml
===================================================================
--- trunk/data/levels/enigma_viii/devnull35_1.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_viii/devnull35_1.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,51 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
-<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
-  <el:protected>
-    <el:info el:type="level">
-      <el:identity el:title="Help youself II" el:subtitle="" el:id="devnull35"/>
-      <el:version el:score="1" el:release="1" el:revision="1" el:status="released"/>
-      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
-      <el:copyright>Copyright ? 2009 dev0</el:copyright>
-      <el:license el:type="GPL v2.0 or above" el:open="true"/>
-      <el:compatibility el:enigma="1.10"/>
-      <el:modes el:easy="true" el:single="true" el:network="false"/>
-      <el:score el:easy="3:00" el:difficult="5:00"/>
-    </el:info>
-    <el:luamain><![CDATA[
-ti[" "] = {"fl_rock"}
-ti["-"] = {"fl_water"}
-ti["#"] = ti({"fl_abyss"}) .. {"st_rawglass"}
-ti["~"] = cond(wo["IsDifficult"], ti["-"], ti["#"])
-ti["."] = cond(wo["IsDifficult"], ti["-"], ti[" "])
-ti["X"] = {"st_grate_cross"}
-ti["R"] = {"st_box_rock"}
-ti["box"] = {"st_box_hay", "box%%"}
-ti["pull"] = {"st_pull", "pull%%"}
-ti["O"] = {"st_oxyd_a", static = true, oxydcolor = OXYD_RED}
-ti["@"] = {"#ac_marble_black", essential = INDISPENSIBLE}
-
-wo(res.autotile(ti, {"1", "2", "box"}, {"3", "4", "pull"}), " ", {
-    "####################",
-    "#         #        #",
-    "# 3       # ~  ~   #",
-    "#         - ~  ~  ~#",
-    "# @       # ~   #  #",
-    "#         #     ~  #",
-    "################# ##",
-    "#  .#.    # #      #",
-    "#  .R-  ###    ##~##",
-    "#   #  R-XX   ~    #",
-    "#R  #   ###  #   1 #",
-    "#-  #     #        #",
-    "O4################2O"})
-
-wo:add({"ot_wire", anchor1 = "box%1", anchor2 = "pull%1"})
-wo:add({"ot_wire", anchor1 = "box%2", anchor2 = "pull%2"})
- ]]></el:luamain>
-    <el:i18n>
-      <el:string el:key="title">
-        <el:english el:translate="false"/>
-      </el:string>
-    </el:i18n>
-  </el:protected>
-</el:level>

Copied: trunk/data/levels/enigma_viii/devnull35_2.xml (from rev 1720, trunk/data/levels/enigma_viii/devnull35_1.xml)
===================================================================
--- trunk/data/levels/enigma_viii/devnull35_1.xml	2009-06-13 23:55:35 UTC (rev 1720)
+++ trunk/data/levels/enigma_viii/devnull35_2.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -0,0 +1,58 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Crabwise II" el:subtitle="" el:id="devnull35"/>
+      <el:version el:score="2" el:release="2" el:revision="3" el:status="released"/>
+      <el:author  el:name="/dev/null" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2009 dev0</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10"/>
+      <el:modes el:easy="true" el:single="true" el:network="false"/>
+      <el:comments>
+        <el:credits el:showinfo="true" el:showstart="true">Thanks to daydreamer (CMoSCR)</el:credits>
+      </el:comments>
+      <el:score el:easy="3:00" el:difficult="5:00"/>
+    </el:info>
+    <el:luamain><![CDATA[
+wo["AllowSuicide"] = false
+
+ti[" "] = {"fl_rock"}
+ti["-"] = {"fl_water"}
+ti["#"] = ti({"fl_abyss"}) .. {"st_redrock"}
+ti["="] = ti["#"] .. {"it_death"}
+ti["~"] = cond(wo["IsDifficult"], ti["-"], ti["#"])
+ti["."] = cond(wo["IsDifficult"], ti["-"], ti[" "])
+ti["X"] = {"st_grate_cross"}
+ti["R"] = {"st_box_rock"}
+ti["box"] = {"st_box_hay", "box%%"}
+ti["pull"] = {"st_pull", "pull%%"}
+ti["O"] = {"st_oxyd_a", static = true, oxydcolor = OXYD_RED}
+ti["@"] = {"#ac_marble_black"}
+
+wo(res.autotile(ti, {"1", "2", "box"}, {"3", "4", "pull"}), " ", {
+    "####################",
+    "#         =        #",
+    "# 3       = ~  ~   #",
+    "#         - ~  ~  ~#",
+    "# @       = ~   #  #",
+    "#         =     ~  #",
+    "#================ =#",
+    "#  .#.    = #      #",
+    "#  .R-  ##=    ##~##",
+    "#   #  R-XX   ~    #",
+    "#R  #   ##=  #   1 #",
+    "#-  #     =        #",
+    "O4################2O"})
+
+wo:add({"ot_wire", anchor1 = "box%1", anchor2 = "pull%1"})
+wo:add({"ot_wire", anchor1 = "box%2", anchor2 = "pull%2"})
+ ]]></el:luamain>
+    <el:i18n>
+      <el:string el:key="title">
+        <el:english el:translate="true"/>
+        <el:translation el:lang="de">Hintenrum II</el:translation>
+      </el:string>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/enigma_viii/index.xml
===================================================================
--- trunk/data/levels/enigma_viii/index.xml	2009-06-14 22:22:06 UTC (rev 1721)
+++ trunk/data/levels/enigma_viii/index.xml	2009-06-15 18:06:17 UTC (rev 1722)
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
 <index xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="index.xsd">
 
-  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="50" title="Enigma VIII"/>
+  <info enigma="1.00" group="Enigma" location="10900" network="false" owner="Enigma Team" release="1" revision="51" title="Enigma VIII"/>
 
   <attributes/>
 
@@ -35,7 +35,7 @@
     <level _seq="27" _title="Freestyle Microwire" _xpath="./ral29_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20080719ral530" rel="1" rev="129" score="1" target="time" unit="duration"/>
     <level _seq="28" _title="Balance Beam" _xpath="./mecke03_1" author="mecke" ctrl="force" easy="true" id="mecke03" rel="1" rev="37" score="1" target="time" unit="duration"/>
     <level _seq="29" _title="Colored Oxyds" _xpath="./andreas50_1" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas50" rel="1" rev="8" score="1" target="time" unit="duration"/>
-    <level _seq="30" _title="Styles Change" _xpath="./andreas48_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas48" rel="2" rev="19" score="2" target="time" unit="duration"/>
+    <level _seq="30" _title="Styles Change" _xpath="./andreas48_2" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas48" rel="2" rev="20" score="2" target="time" unit="duration"/>
     <level _seq="31" _title="Colored Turnstiles" _xpath="./andreas51_1" author="Andreas Lochmann" ctrl="force" easy="false" id="andreas51" rel="1" rev="7" score="1" target="time" unit="duration"/>
     <level _seq="32" _title="Sanssouci" _xpath="./mecke05_1" author="mecke" ctrl="force" easy="true" id="mecke05" rel="1" rev="40" score="1" target="time" unit="duration"/>
     <level _seq="33" _title="Wired Shogun" _xpath="./ral34_1" author="Ronald Lamprecht" ctrl="force" easy="true" id="20080828ral417" rel="1" rev="129" score="1" target="time" unit="duration"/>
@@ -102,8 +102,8 @@
     <level _seq="94" _title="Sunrise Sunset" _xpath="./pulley18_1" author="Mark Pulley" ctrl="force" easy="false" id="pulley18" rel="1" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="95" _title="Filler" _xpath="./devnull33_1" author="/dev/null" ctrl="force" easy="false" id="devnull33" rel="1" rev="3" score="1" target="time" unit="duration"/>
     <level _seq="96" _title="Two Is A Company IV" _xpath="./devnull28_1" author="/dev/null" ctrl="force" easy="false" id="devnull28" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="97" _title="Help youself I" _xpath="./devnull34_1" author="/dev/null" ctrl="force" easy="true" id="devnull34" rel="1" rev="1" score="1" target="time" unit="duration"/>
-    <level _seq="98" _title="Help youself II" _xpath="./devnull35_1" author="/dev/null" ctrl="force" easy="true" id="devnull35" rel="1" rev="1" score="1" target="time" unit="duration"/>
+    <level _seq="97" _title="Crabwise I" _xpath="./devnull34_2" author="/dev/null" ctrl="force" easy="true" id="devnull34" rel="2" rev="3" score="2" target="time" unit="duration"/>
+    <level _seq="98" _title="Crabwise II" _xpath="./devnull35_2" author="/dev/null" ctrl="force" easy="true" id="devnull35" rel="2" rev="3" score="2" target="time" unit="duration"/>
   </levels>
 
 </index>



From ral at mail.berlios.de  Wed Jun 17 00:33:25 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Wed, 17 Jun 2009 00:33:25 +0200
Subject: [Enigma-game-svn] r1723 - in trunk: data data/gfx32 data/gfx40
	data/gfx48 src src/actors src/items src/stones
Message-ID: <200906162233.n5GMXP8n031004@sheep.berlios.de>

Author: ral
Date: 2009-06-17 00:33:11 +0200 (Wed, 17 Jun 2009)
New Revision: 1723

Added:
   trunk/data/gfx32/st_actorimpulse.png
   trunk/data/gfx32/st_break_bug.png
   trunk/data/gfx32/st_charge_minus.png
   trunk/data/gfx32/st_charge_plus.png
   trunk/data/gfx32/st_charge_zero.png
   trunk/data/gfx32/st_chess_black.png
   trunk/data/gfx32/st_chess_white.png
   trunk/data/gfx32/st_fourswitch.png
   trunk/data/gfx32/st_knight.png
   trunk/data/gfx32/st_passage_black_cross.png
   trunk/data/gfx32/st_passage_black_frame.png
   trunk/data/gfx32/st_passage_black_slash.png
   trunk/data/gfx32/st_passage_black_square.png
   trunk/data/gfx32/st_passage_white_cross.png
   trunk/data/gfx32/st_passage_white_frame.png
   trunk/data/gfx32/st_passage_white_slash.png
   trunk/data/gfx32/st_passage_white_square.png
   trunk/data/gfx40/st_actorimpulse.png
   trunk/data/gfx40/st_break_bug.png
   trunk/data/gfx40/st_charge_minus.png
   trunk/data/gfx40/st_charge_plus.png
   trunk/data/gfx40/st_charge_zero.png
   trunk/data/gfx40/st_chess_black.png
   trunk/data/gfx40/st_chess_white.png
   trunk/data/gfx40/st_fourswitch.png
   trunk/data/gfx40/st_knight.png
   trunk/data/gfx40/st_passage_black_cross.png
   trunk/data/gfx40/st_passage_black_frame.png
   trunk/data/gfx40/st_passage_black_slash.png
   trunk/data/gfx40/st_passage_black_square.png
   trunk/data/gfx40/st_passage_white_cross.png
   trunk/data/gfx40/st_passage_white_frame.png
   trunk/data/gfx40/st_passage_white_slash.png
   trunk/data/gfx40/st_passage_white_square.png
   trunk/data/gfx48/st_actorimpulse.png
   trunk/data/gfx48/st_break_bug.png
   trunk/data/gfx48/st_charge_minus.png
   trunk/data/gfx48/st_charge_plus.png
   trunk/data/gfx48/st_charge_zero.png
   trunk/data/gfx48/st_chess_black.png
   trunk/data/gfx48/st_chess_white.png
   trunk/data/gfx48/st_fourswitch.png
   trunk/data/gfx48/st_knight.png
   trunk/data/gfx48/st_passage_black_cross.png
   trunk/data/gfx48/st_passage_black_frame.png
   trunk/data/gfx48/st_passage_black_slash.png
   trunk/data/gfx48/st_passage_black_square.png
   trunk/data/gfx48/st_passage_white_cross.png
   trunk/data/gfx48/st_passage_white_frame.png
   trunk/data/gfx48/st_passage_white_slash.png
   trunk/data/gfx48/st_passage_white_square.png
Removed:
   trunk/data/gfx32/st-actorimpulse.png
   trunk/data/gfx32/st-black1.png
   trunk/data/gfx32/st-black2.png
   trunk/data/gfx32/st-black3.png
   trunk/data/gfx32/st-black4.png
   trunk/data/gfx32/st-bug.png
   trunk/data/gfx32/st-chargeminus.png
   trunk/data/gfx32/st-chargeplus.png
   trunk/data/gfx32/st-chargezero.png
   trunk/data/gfx32/st-chess_black.png
   trunk/data/gfx32/st-chess_white.png
   trunk/data/gfx32/st-fourswitch.png
   trunk/data/gfx32/st-knight.png
   trunk/data/gfx32/st-white1.png
   trunk/data/gfx32/st-white2.png
   trunk/data/gfx32/st-white3.png
   trunk/data/gfx32/st-white4.png
   trunk/data/gfx40/st-actorimpulse.png
   trunk/data/gfx40/st-black1.png
   trunk/data/gfx40/st-black2.png
   trunk/data/gfx40/st-black3.png
   trunk/data/gfx40/st-black4.png
   trunk/data/gfx40/st-bug.png
   trunk/data/gfx40/st-chargeminus.png
   trunk/data/gfx40/st-chargeplus.png
   trunk/data/gfx40/st-chargezero.png
   trunk/data/gfx40/st-chess_black.png
   trunk/data/gfx40/st-chess_white.png
   trunk/data/gfx40/st-fourswitch.png
   trunk/data/gfx40/st-knight.png
   trunk/data/gfx40/st-white1.png
   trunk/data/gfx40/st-white2.png
   trunk/data/gfx40/st-white3.png
   trunk/data/gfx40/st-white4.png
   trunk/data/gfx48/st-actorimpulse.png
   trunk/data/gfx48/st-black1.png
   trunk/data/gfx48/st-black2.png
   trunk/data/gfx48/st-black3.png
   trunk/data/gfx48/st-black4.png
   trunk/data/gfx48/st-bug.png
   trunk/data/gfx48/st-chargeminus.png
   trunk/data/gfx48/st-chargeplus.png
   trunk/data/gfx48/st-chargezero.png
   trunk/data/gfx48/st-chess_black.png
   trunk/data/gfx48/st-chess_white.png
   trunk/data/gfx48/st-fourswitch.png
   trunk/data/gfx48/st-knight.png
   trunk/data/gfx48/st-white1.png
   trunk/data/gfx48/st-white2.png
   trunk/data/gfx48/st-white3.png
   trunk/data/gfx48/st-white4.png
Modified:
   trunk/data/models-2d.lua
   trunk/src/WorldProxy.cc
   trunk/src/actors.hh
   trunk/src/actors/Balls.cc
   trunk/src/actors/Balls.hh
   trunk/src/items/SimpleItems.cc
   trunk/src/items/Umbrella.cc
   trunk/src/lua.cc
   trunk/src/player.cc
   trunk/src/server.cc
   trunk/src/server.hh
   trunk/src/stones/ActorImpulseStone.cc
   trunk/src/stones/FourSwitch.cc
   trunk/src/stones/KnightStone.cc
   trunk/src/stones/PassageStone.cc
   trunk/src/stones/PassageStone.hh
   trunk/src/stones/PuzzleStone.cc
   trunk/src/stones/SimpleStones.cc
   trunk/src/world.cc
Log:
Trunk 1.1:
- it_ring, it_umbrella: no more activation while actor is moribund
- engine internal renaming of GlobalForce to ConstantForce
- image renaming: st_actorimpulse, st_passage, st_break_bug, st_chess,
    st_charge, st_knight, st_fourswitch
- st_puzzle: propagate impulses on blue puzzles on actor hits, even if the
    puzzle stone cannot move itself

Deleted: trunk/data/gfx32/st-actorimpulse.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-black1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-black2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-black3.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-black4.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-bug.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-chargeminus.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-chargeplus.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-chargezero.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-chess_black.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-chess_white.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-fourswitch.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-knight.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-white1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-white2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-white3.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-white4.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/st_actorimpulse.png (from rev 1722, trunk/data/gfx32/st-actorimpulse.png)

Added: trunk/data/gfx32/st_break_bug.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_break_bug.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx32/st_charge_minus.png (from rev 1722, trunk/data/gfx32/st-chargeminus.png)

Copied: trunk/data/gfx32/st_charge_plus.png (from rev 1722, trunk/data/gfx32/st-chargeplus.png)

Copied: trunk/data/gfx32/st_charge_zero.png (from rev 1722, trunk/data/gfx32/st-chargezero.png)

Copied: trunk/data/gfx32/st_chess_black.png (from rev 1722, trunk/data/gfx32/st-chess_black.png)

Copied: trunk/data/gfx32/st_chess_white.png (from rev 1722, trunk/data/gfx32/st-chess_white.png)

Copied: trunk/data/gfx32/st_fourswitch.png (from rev 1722, trunk/data/gfx32/st-fourswitch.png)

Copied: trunk/data/gfx32/st_knight.png (from rev 1722, trunk/data/gfx32/st-knight.png)

Added: trunk/data/gfx32/st_passage_black_cross.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_passage_black_cross.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_passage_black_frame.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_passage_black_frame.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_passage_black_slash.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_passage_black_slash.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_passage_black_square.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_passage_black_square.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_passage_white_cross.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_passage_white_cross.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_passage_white_frame.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_passage_white_frame.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_passage_white_slash.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_passage_white_slash.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx32/st_passage_white_square.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_passage_white_square.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Deleted: trunk/data/gfx40/st-actorimpulse.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-black1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-black2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-black3.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-black4.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-bug.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-chargeminus.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-chargeplus.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-chargezero.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-chess_black.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-chess_white.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-fourswitch.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-knight.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-white1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-white2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-white3.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-white4.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/st_actorimpulse.png (from rev 1722, trunk/data/gfx40/st-actorimpulse.png)

Copied: trunk/data/gfx40/st_break_bug.png (from rev 1722, trunk/data/gfx40/st-bug.png)

Copied: trunk/data/gfx40/st_charge_minus.png (from rev 1722, trunk/data/gfx40/st-chargeminus.png)

Copied: trunk/data/gfx40/st_charge_plus.png (from rev 1722, trunk/data/gfx40/st-chargeplus.png)

Copied: trunk/data/gfx40/st_charge_zero.png (from rev 1722, trunk/data/gfx40/st-chargezero.png)

Copied: trunk/data/gfx40/st_chess_black.png (from rev 1722, trunk/data/gfx40/st-chess_black.png)

Copied: trunk/data/gfx40/st_chess_white.png (from rev 1722, trunk/data/gfx40/st-chess_white.png)

Copied: trunk/data/gfx40/st_fourswitch.png (from rev 1722, trunk/data/gfx40/st-fourswitch.png)

Copied: trunk/data/gfx40/st_knight.png (from rev 1722, trunk/data/gfx40/st-knight.png)

Copied: trunk/data/gfx40/st_passage_black_cross.png (from rev 1722, trunk/data/gfx40/st-black3.png)

Copied: trunk/data/gfx40/st_passage_black_frame.png (from rev 1722, trunk/data/gfx40/st-black4.png)

Copied: trunk/data/gfx40/st_passage_black_slash.png (from rev 1722, trunk/data/gfx40/st-black2.png)

Copied: trunk/data/gfx40/st_passage_black_square.png (from rev 1722, trunk/data/gfx40/st-black1.png)

Added: trunk/data/gfx40/st_passage_white_cross.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_passage_white_cross.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_passage_white_frame.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_passage_white_frame.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_passage_white_slash.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_passage_white_slash.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Added: trunk/data/gfx40/st_passage_white_square.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/st_passage_white_square.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Deleted: trunk/data/gfx48/st-actorimpulse.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-black1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-black2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-black3.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-black4.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-bug.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-chargeminus.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-chargeplus.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-chargezero.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-chess_black.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-chess_white.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-fourswitch.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-knight.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-white1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-white2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-white3.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-white4.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/st_actorimpulse.png (from rev 1722, trunk/data/gfx48/st-actorimpulse.png)

Copied: trunk/data/gfx48/st_break_bug.png (from rev 1722, trunk/data/gfx48/st-bug.png)

Copied: trunk/data/gfx48/st_charge_minus.png (from rev 1722, trunk/data/gfx48/st-chargeminus.png)

Copied: trunk/data/gfx48/st_charge_plus.png (from rev 1722, trunk/data/gfx48/st-chargeplus.png)

Copied: trunk/data/gfx48/st_charge_zero.png (from rev 1722, trunk/data/gfx48/st-chargezero.png)

Copied: trunk/data/gfx48/st_chess_black.png (from rev 1722, trunk/data/gfx48/st-chess_black.png)

Copied: trunk/data/gfx48/st_chess_white.png (from rev 1722, trunk/data/gfx48/st-chess_white.png)

Copied: trunk/data/gfx48/st_fourswitch.png (from rev 1722, trunk/data/gfx48/st-fourswitch.png)

Copied: trunk/data/gfx48/st_knight.png (from rev 1722, trunk/data/gfx48/st-knight.png)

Added: trunk/data/gfx48/st_passage_black_cross.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_passage_black_cross.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx48/st_passage_black_frame.png (from rev 1722, trunk/data/gfx48/st-black4.png)

Copied: trunk/data/gfx48/st_passage_black_slash.png (from rev 1722, trunk/data/gfx48/st-black2.png)

Added: trunk/data/gfx48/st_passage_black_square.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/st_passage_black_square.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx48/st_passage_white_cross.png (from rev 1722, trunk/data/gfx48/st-white3.png)

Copied: trunk/data/gfx48/st_passage_white_frame.png (from rev 1722, trunk/data/gfx48/st-white4.png)

Copied: trunk/data/gfx48/st_passage_white_slash.png (from rev 1722, trunk/data/gfx48/st-white2.png)

Copied: trunk/data/gfx48/st_passage_white_square.png (from rev 1722, trunk/data/gfx48/st-white1.png)

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/data/models-2d.lua	2009-06-16 22:33:11 UTC (rev 1723)
@@ -781,16 +781,16 @@
 -------------------
 do
     DefStone("st_beads", "sh_glass")
-    DefStone("st-black1", "sh_round")
-    DefStone("st-black2", "sh_passage_slash")
-    DefStone("st-black3", "sh_passage_cross")
-    DefStone("st-black4", "sh_passage_frame")
+    DefStone("st_passage_black_square", "sh_round")
+    DefStone("st_passage_black_slash", "sh_passage_slash")
+    DefStone("st_passage_black_cross", "sh_passage_cross")
+    DefStone("st_passage_black_frame", "sh_passage_frame")
     DefStone("st_jamb_black", "sh_jamb")
     DefStone("st_plop_slate")
     DefStone("st_bluegray", "sh_round")
     DefStone("st_brake", "sh_brake")
     DefStone("st_brownie", "sh_round")
-    DefStone("st-bug")
+    DefStone("st_break_bug")
     DefStone("st_pinkbumps")
     DefStone("st_camouflage")
     DefStone("st_dummy")
@@ -829,10 +829,10 @@
     DefStone("st_brownpyramide")
     DefStone("st_redmarble")
     DefStone("st_surprise", "sh_round")
-    DefStone("st-white1", "sh_round")
-    DefStone("st-white2", "sh_passage_slash")
-    DefStone("st-white3", "sh_passage_cross")
-    DefStone("st-white4", "sh_passage_frame")
+    DefStone("st_passage_white_square", "sh_round")
+    DefStone("st_passage_white_slash", "sh_passage_slash")
+    DefStone("st_passage_white_cross", "sh_passage_cross")
+    DefStone("st_passage_white_frame", "sh_passage_frame")
     DefStone("st_jamb_white", "sh_jamb")
     DefStone("st_woven")
     DefStone("st_yellow")
@@ -845,16 +845,16 @@
 -- Animated stones --
 ---------------------
 
--- st-actorimpulse --
+-- st_actorimpulse --
 do
-    namelist = DefSubimages("st-actorimpulse", {h=3})
+    namelist = DefSubimages("st_actorimpulse", {h=3})
     shnamelist = DefSubimages("sh_actorimpulse", {h=3,imgw=ShadowSize,imgh=ShadowSize})
 
     DefAnim("st-ai-fg", PingPong(BuildFrames(namelist, 30)))
     DefAnim("st-ai-sh", PingPong(BuildFrames(shnamelist, 30)))
-    DefShModel("st-actorimpulse-anim", "st-ai-fg", "st-ai-sh")
+    DefShModel("st_actorimpulse_anim", "st-ai-fg", "st-ai-sh")
 
-    DefShModel("st-actorimpulse", namelist[1], shnamelist[1])
+    DefShModel("st_actorimpulse", namelist[1], shnamelist[1])
 end
 
 -- st-bigbluesand --
@@ -933,25 +933,25 @@
     DefRoundStoneWithAnim ("st_break_plain", 10, 50)
 end
 
--- st-chage-plus, st-charge-zero, st-charge-minus --
+-- st_chage_plus, st_charge_zero, st_charge_minus --
 do
     function def_chargestone(basename)
         local n=DefSubimages(basename, {h=2})
         DefSolidStone(basename, n[1])
         DefAnim(basename.."-animfg", {{n[2], 140}})
-        DefSolidStone(basename.."-anim", basename.."-animfg")
+        DefSolidStone(basename.."_anim", basename.."-animfg")
     end
 
-    def_chargestone("st-chargeplus")
-    def_chargestone("st-chargeminus")
-    def_chargestone("st-chargezero")
+    def_chargestone("st_charge_plus")
+    def_chargestone("st_charge_minus")
+    def_chargestone("st_charge_zero")
 end
 
--- st-chess_black, st-chess_white --
+-- st_chess_black, st_chess_white --
 do
     function make_chess(colour)
-        local img1 = DefSubimages("st-chess"..colour, {h=5});
-        --local img2 = DefSubimages("st-chess"..colour.."-capture", {h=5});
+        local img1 = DefSubimages("st_chess"..colour, {h=5});
+        --local img2 = DefSubimages("st_chess"..colour.."-capture", {h=5});
         local f1 = BuildFrames(img1, 120)
         --local f2 = BuildFrames(img2, 40)
         local f2 = f1
@@ -1011,13 +1011,13 @@
     DefSolidStone("st_flash", "st_flash1")
 end
 
--- st-fourswitch --
+-- st_fourswitch --
 do
-    DefSubimages("st-fourswitch",{h=4})
-    DefShModel("st-fourswitch-n", "st-fourswitch1", "sh_round")
-    DefShModel("st-fourswitch-e", "st-fourswitch2", "sh_round")
-    DefShModel("st-fourswitch-s", "st-fourswitch3", "sh_round")
-    DefShModel("st-fourswitch-w", "st-fourswitch4", "sh_round")
+    DefSubimages("st_fourswitch",{h=4})
+    DefShModel("st_fourswitch-n", "st_fourswitch1", "sh_round")
+    DefShModel("st_fourswitch-e", "st_fourswitch2", "sh_round")
+    DefShModel("st_fourswitch-s", "st_fourswitch3", "sh_round")
+    DefShModel("st_fourswitch-w", "st_fourswitch4", "sh_round")
 end
 
 -- st_ice --
@@ -1035,11 +1035,11 @@
     DefShModel("st_ice_melting", "st_ice_melt-anim", "sh_glass")
 end
 
--- st-knight --
+-- st_knight --
 do
-    local images = DefSubimages("st-knight", {modelname="knight", h=5})
+    local images = DefSubimages("st_knight", {modelname="knight", h=5})
     for i=1, table.getn(images) do
-        DefShModel("st-knight"..i, images[i], "sh_round")
+        DefShModel("st_knight"..i, images[i], "sh_round")
     end
 end
 
@@ -1864,7 +1864,6 @@
 -- Simple stone aliases --
 --------------------------
 do
-    DefAlias("st_break_bug", "st-bug")
     DefAlias("st_break_bug-anim", "st_flat_breaking")
     DefAlias("st-explosion", "it_explosion")
     DefAlias("st-glass_move", "st-glass");

Modified: trunk/src/WorldProxy.cc
===================================================================
--- trunk/src/WorldProxy.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/WorldProxy.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -91,7 +91,7 @@
         } else if (key == "FrictionStrength") {
             return server::FrictionFactor;
         } else if (key == "GlobalForce") {
-            return server::GlobalForce;
+            return server::ConstantForce;
         } else if (key == "MeditationStrength") {
             return server::HoleForce;
         } else if (key == "MagnetStrength") {
@@ -194,7 +194,7 @@
         } else if (key == "FrictionStrength") {
             server::FrictionFactor = val;
         } else if (key == "GlobalForce") {
-            server::GlobalForce = val;
+            server::ConstantForce = val;
         } else if (key == "MeditationStrength") {
             server::HoleForce = val;
         } else if (key == "MagnetStrength") {

Modified: trunk/src/actors/Balls.cc
===================================================================
--- trunk/src/actors/Balls.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/actors/Balls.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -1,6 +1,6 @@
 /*
  * Copyright (C) 2002,2003,2004 Daniel Heck
- * Copyright (C) 2008 Ronald Lamprecht
+ * Copyright (C) 2008,2009 Ronald Lamprecht
  *
  * This program is free software; you can redistribute it and/or
  * modify it under the terms of the GNU General Public License
@@ -150,6 +150,10 @@
         return state == DEAD;
     }
     
+    bool BasicBall::isMoribund() const {
+        return state == DEAD || state == SHATTERING || state==BUBBLING || state==FALLING || state==RESURRECTED;
+    }
+    
     bool BasicBall::is_movable() const {
         return (state!=DEAD && state!=RESURRECTED && state!=APPEARING && state!=DISAPPEARING); 
     }
@@ -169,6 +173,7 @@
     bool BasicBall::is_invisible() const {
         return m_invisible_rest_time>0;
     }
+    
     bool BasicBall::can_drop_items() const {
         return state == NORMAL || state == JUMP_VORTEX || state==JUMPING;
     }

Modified: trunk/src/actors/Balls.hh
===================================================================
--- trunk/src/actors/Balls.hh	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/actors/Balls.hh	2009-06-16 22:33:11 UTC (rev 1723)
@@ -63,6 +63,7 @@
 
         // Actor interface
         virtual bool is_dead() const;
+        virtual bool isMoribund() const;
         virtual bool is_movable() const;
         virtual bool is_flying() const;
         virtual bool is_on_floor() const;

Modified: trunk/src/actors.hh
===================================================================
--- trunk/src/actors.hh	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/actors.hh	2009-06-16 22:33:11 UTC (rev 1723)
@@ -132,6 +132,7 @@
         virtual void on_respawn (const ecl::V2 &pos);
 
         virtual bool is_dead() const = 0;
+        virtual bool isMoribund() const {return is_dead(); }
         virtual bool is_movable() const { return true; }
         virtual bool is_flying() const { return false; }
         virtual bool is_on_floor() const { return true; }

Modified: trunk/src/items/SimpleItems.cc
===================================================================
--- trunk/src/items/SimpleItems.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/items/SimpleItems.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -281,13 +281,17 @@
     }
     
     ItemAction Ring::activate(Actor *a, GridPos p) {
-        if (ExchangeMarbles(a)) {
-            sound_event("switchmarbles");
-        }
+        if (a->isMoribund())
+            return ITEM_KEEP;
         else {
-            RespawnActor(a);
+            if (ExchangeMarbles(a)) {
+                sound_event("switchmarbles");
+            }
+            else {
+                RespawnActor(a);
+            }
+            return ITEM_DROP;
         }
-        return ITEM_DROP;
     }
 
     DEF_ITEMTRAITS(Ring, "it_ring", it_ring);

Modified: trunk/src/items/Umbrella.cc
===================================================================
--- trunk/src/items/Umbrella.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/items/Umbrella.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -62,8 +62,12 @@
     }
     
     ItemAction Umbrella::activate(Actor *a, GridPos) {
-        BroadcastMessage("_shield", a->getAttr("owner"), GRID_NONE_BIT, true);
-        return ITEM_KILL;
+        if (a->isMoribund())
+            return ITEM_KEEP;
+        else {
+            BroadcastMessage("_shield", a->getAttr("owner"), GRID_NONE_BIT, true);
+            return ITEM_KILL;
+        }
     }
     
     void Umbrella::on_pickup(Actor *a) {

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/lua.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -832,7 +832,7 @@
     ecl::V2 v;
     v[0] = lua_tonumber(L, 1);
     v[1] = lua_tonumber(L, 2);
-    server::GlobalForce = v;
+    server::ConstantForce = v;
     return 0;
 }
 

Modified: trunk/src/player.cc
===================================================================
--- trunk/src/player.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/player.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -1,5 +1,6 @@
 /*
  * Copyright (C) 2002,2003,2004,2006 Daniel Heck
+ * Copyright (C) 2007,2008,2009 Ronald Lamprecht
  *
  * This program is free software; you can redistribute it and/or
  * modify it under the terms of the GNU General Public License
@@ -616,21 +617,21 @@
         }
 
         switch (it->activate(ac, p)) {
-        case ITEM_DROP:
-            // only drop if no item underneath and actor allows it
-            if (it->can_drop_at(p) && can_drop_item) {
-                it = inv.yield_first ();
+            case ITEM_DROP:
+                // only drop if no item underneath and actor allows it
+                if (it->can_drop_at(p) && can_drop_item) {
+                    it = inv.yield_first ();
+                    RedrawInventory (&inv);
+                    it->drop(ac, p);
+                }
+                break;
+            case ITEM_KILL:
+                DisposeObject (inv.yield_first ());
                 RedrawInventory (&inv);
-                it->drop(ac, p);
+                break;
+            case ITEM_KEEP:
+                break;
             }
-            break;
-        case ITEM_KILL:
-            DisposeObject (inv.yield_first ());
-            RedrawInventory (&inv);
-            break;
-        case ITEM_KEEP:
-            break;
-        }
     }
 }
 

Modified: trunk/src/server.cc
===================================================================
--- trunk/src/server.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/server.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -1,5 +1,6 @@
 /*
  * Copyright (C) 2004,2005 Daniel Heck
+ * Copyright (C) 2007,2008,2009 Ronald Lamprecht
  *
  * This program is free software; you can redistribute it and/or
  * modify it under the terms of the GNU General Public License
@@ -106,7 +107,7 @@
 double   server::Brittleness;
 double   server::Fragility;
 double   server::CrackSpreading;
-ecl::V2  server::GlobalForce;
+ecl::V2  server::ConstantForce;
 double   server::BumperForce;
 double   server::ElectricForce;
 double   server::EnigmaCompatibility;       // no Lua access
@@ -273,7 +274,7 @@
     server::Brittleness       = 0.5;
     server::Fragility         = 1.0;
     server::CrackSpreading    = 0.5;
-    server::GlobalForce       = ecl::V2(0, 0);
+    server::ConstantForce       = ecl::V2(0, 0);
     server::SlopeForce        = 25.0;
     server::FlatForce         = 0.0;
     server::FrictionFactor    = 1.0;

Modified: trunk/src/server.hh
===================================================================
--- trunk/src/server.hh	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/server.hh	2009-06-16 22:33:11 UTC (rev 1723)
@@ -1,5 +1,6 @@
 /*
  * Copyright (C) 2003,2004,2005 Daniel Heck
+ * Copyright (C) 2007,2008,2009 Ronald Lamprecht
  *
  * This program is free software; you can redistribute it and/or
  * modify it under the terms of the GNU General Public License
@@ -104,7 +105,7 @@
     // 1.10 crack variables
     extern double   Fragility;
     extern double   CrackSpreading;
-    extern ecl::V2  GlobalForce;
+    extern ecl::V2  ConstantForce;  // global gravitation
     
     extern int      MaxOxydColor;
 

Modified: trunk/src/stones/ActorImpulseStone.cc
===================================================================
--- trunk/src/stones/ActorImpulseStone.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/stones/ActorImpulseStone.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -66,7 +66,7 @@
                 boulder->setAttr("orientation", reverse(to_direction(boulder->getAttr("orientation"))));
                 sound_event("bumper");
                 state = PULSING;
-                set_anim("st-actorimpulse-anim");
+                set_anim("st_actorimpulse_anim");
             }
         } else if (m.message == "_glasses") {
             init_model();
@@ -114,7 +114,7 @@
             if ((objFlags & OBJBIT_INVISIBLE) && ((server::GlassesVisibility & Glasses::ACTORIMPULSE) == 0))
                 set_model("invisible");
             else
-                set_model("st-actorimpulse");
+                set_model("st_actorimpulse");
         }
         // PULSING anim is always visible and should continue independent on init_model calls
     }
@@ -141,7 +141,7 @@
 
             sound_event("bumper");
             state = PULSING;
-            set_anim("st-actorimpulse-anim");
+            set_anim("st_actorimpulse_anim");
         }
     }
 

Modified: trunk/src/stones/FourSwitch.cc
===================================================================
--- trunk/src/stones/FourSwitch.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/stones/FourSwitch.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -62,7 +62,7 @@
     }
     
     void FourSwitch::init_model() {
-        set_model(std::string("st-fourswitch") + to_suffix((Direction)state));
+        set_model(std::string("st_fourswitch") + to_suffix((Direction)state));
     }
     
     void FourSwitch::actor_hit(const StoneContact &sc) {

Modified: trunk/src/stones/KnightStone.cc
===================================================================
--- trunk/src/stones/KnightStone.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/stones/KnightStone.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -43,7 +43,7 @@
     }
      
     void KnightStone::init_model()  {
-        set_model(ecl::strf("st-knight%d", state + 1));
+        set_model(ecl::strf("st_knight%d", state + 1));
     }
     
     StoneResponse KnightStone::collision_response(const StoneContact &) {

Modified: trunk/src/stones/PassageStone.cc
===================================================================
--- trunk/src/stones/PassageStone.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/stones/PassageStone.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -19,6 +19,7 @@
 
 #include "stones/PassageStone.hh"
 
+#include "errors.hh"
 //#include "main.hh"
 
 namespace enigma {
@@ -57,13 +58,7 @@
         if (key == "color") {
             return state;
         } else if (key == "flavor") {
-            switch ((objFlags & OBJBIT_FLAVOR) >> 24) {
-                case 0 : return "square";
-                case 1 : return "slash";
-                case 2 : return "cross";
-                case 3 : return "frame";
-            }
-            return Value();
+            return flavor();
         }
         return Stone::getAttr(key);
     }
@@ -77,8 +72,7 @@
     }
     
     void PassageStone::init_model()  {
-        // the models are still encoded in the old API notation
-        set_model(ecl::strf("st-%s%d", (state == BLACK) ? "black" : "white", (int)(((objFlags & OBJBIT_FLAVOR) >> 24)+1)));
+        set_model(ecl::strf("st_passage_%s_%s", (state == BLACK) ? "black" : "white", flavor().c_str()));
     }
 
     bool PassageStone::is_floating() const {
@@ -98,6 +92,16 @@
             return (accolor && accolor == WHITE) ?  STONE_PASS : STONE_REBOUND;
         }
     }
+    
+    std::string PassageStone::flavor() const {
+        switch ((objFlags & OBJBIT_FLAVOR) >> 24) {
+            case 0 : return "square";
+            case 1 : return "slash";
+            case 2 : return "cross";
+            case 3 : return "frame";
+        }
+        ASSERT(false, XLevelRuntime, "PassageStone unknown flavor");
+    }
 
     int PassageStone::traitsIdx() const {
         return ((objFlags & OBJBIT_FLAVOR) >> 24) + 4 * state;

Modified: trunk/src/stones/PassageStone.hh
===================================================================
--- trunk/src/stones/PassageStone.hh	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/stones/PassageStone.hh	2009-06-16 22:33:11 UTC (rev 1723)
@@ -59,6 +59,7 @@
                
     private:
         // Private methods.
+        std::string flavor() const;
         int traitsIdx() const;
     };
 

Modified: trunk/src/stones/PuzzleStone.cc
===================================================================
--- trunk/src/stones/PuzzleStone.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/stones/PuzzleStone.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -215,6 +215,7 @@
                 // -> move it if dest pos is free
                 GridPos dest = move(get_pos(), move_dir);
                 if (GetStone(dest) == NULL) {
+                    // move without falling in water or abyss
                     Stone *puzz = YieldStone(get_pos());
                     SetStone(dest, puzz);
                     puzz->on_move(get_pos());
@@ -243,6 +244,10 @@
             // 3) Last chance: try to rotate the row or column
             if (has_magic_wand) {
                 rotateLine(rotate_dir);
+            } else {
+                // we can not move - otherwise we would have send the impulse in 2)
+                // but we need to propagate the impulse
+                sc.actor->send_impulse(get_pos(), move_dir);
             }
         }
     }

Modified: trunk/src/stones/SimpleStones.cc
===================================================================
--- trunk/src/stones/SimpleStones.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/stones/SimpleStones.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -133,7 +133,7 @@
     
     void ChargeStone::init_model() {
         double charge = getAttr("charge");
-        set_model(ecl::strf("st-charge%s", (charge == 0) ? "zero" : ((charge > 0.0) ? "plus" : "minus")).c_str());
+        set_model(ecl::strf("st_charge_%s", (charge == 0) ? "zero" : ((charge > 0.0) ? "plus" : "minus")).c_str());
     }
     
     void ChargeStone::animcb() {
@@ -143,7 +143,7 @@
     void ChargeStone::actor_hit(const StoneContact &sc) {
         double charge = getAttr("charge");
         sc.actor->setAttr("charge", charge);
-        set_anim(ecl::strf("st-charge%s-anim", (charge == 0) ? "zero" : ((charge > 0.0) ? "plus" : "minus")).c_str());
+        set_anim(ecl::strf("st_charge_%s_anim", (charge == 0) ? "zero" : ((charge > 0.0) ? "plus" : "minus")).c_str());
     }
     
 

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2009-06-15 18:06:17 UTC (rev 1722)
+++ trunk/src/world.cc	2009-06-16 22:33:11 UTC (rev 1723)
@@ -584,16 +584,13 @@
   that the position and velocity entries in ActorInfo will be updated
   only after a *successful* time step, so they cannot be used
   here.] */
-V2 World::get_local_force (Actor *a) {
-    V2 f;
-    V2 m;
+ecl::V2 World::get_local_force (Actor *a) {
+    ecl::V2 f;
+    ecl::V2 m;
     double friction = 0;
 
     if (a->is_on_floor()) {
         if (Floor *floor = a->m_actorinfo.field->floor) {
-            // Constant force
-            f += server::GlobalForce;
-
             // Mouse force
             if (a->get_controllers() != 0) {
                 m = floor->process_mouseforce(a, m_mouseforce.get_force(a));
@@ -624,9 +621,12 @@
    only once every four time steps, cf. move_actors().  They are used
    for forces that are more time consuming to calculate, i.e.,
    actor-actor interactions and external force fields. */
-V2 World::get_global_force (Actor *a)
-{
-    V2 f;
+ecl::V2 World::get_global_force (Actor *a){
+    ecl::V2 f;
+    
+    // Constant force
+    f += server::ConstantForce;
+    
     // Electrostatic forces between actors.
     if (double q = get_charge(a)) {
         for (ActorList::iterator i=actorlist.begin();



From ral at mail.berlios.de  Thu Jun 18 00:25:59 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Thu, 18 Jun 2009 00:25:59 +0200
Subject: [Enigma-game-svn] r1724 - in trunk/doc/reference: . images
Message-ID: <200906172225.n5HMPxZO003554@sheep.berlios.de>

Author: ral
Date: 2009-06-18 00:25:51 +0200 (Thu, 18 Jun 2009)
New Revision: 1724

Modified:
   trunk/doc/reference/enigma-ref.texi
   trunk/doc/reference/images/Makefile.am
Log:
Trunk 1.1: refman
- some typo fixes
- fix pdf object image sizes
- stone images part II
- st_puzzle corrections
- InfiniteReincarnation


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-16 22:33:11 UTC (rev 1723)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-17 22:25:51 UTC (rev 1724)
@@ -19,6 +19,10 @@
 @defindex at
 @defindex ms
 
+ at macro oisize {}
+10 mm
+ at end macro
+
 @contents
 
 @ifnottex
@@ -8748,6 +8752,7 @@
 * FrictionStrength::
 * GlobalForce::
 * Height::
+* InfiniteReincarnation::
 * IsDifficult::
 * MagnetRange::
 * MagnetStrength::
@@ -9057,6 +9062,25 @@
 @item @b{Support:} @ @ object independent
 @end table
 
+ at node InfiniteReincarnation
+ at subsection InfiniteReincarnation
+
+A global variable that switches off the @ref{it_extralife} consumption on
+resurrection of a dead actor. Usually the number of extralifes is counted,
+the items are explicitly set or an @ref{st_dispenser} for extralifes is located
+at strategic positions. The main purpose of this flag is the support of easy
+modes for very lethal levels, that should give the user the opportunity to
+exercise difficult patterns. Usage of this flag for the regular difficult mode
+is depreceated.
+
+ at table @asis
+ at item @b{Type:} @ @ bool
+ at item @b{Values:} @ @ @code{true}, @code{false}
+ at item @b{Default:} @ @ @code{false}
+ at item @b{Access:} @ @ read/write
+ at item @b{Support:} @ @ object independent
+ at end table
+
 @node IsDifficult
 @subsection IsDifficult
 
@@ -9328,54 +9352,54 @@
 @c
 WORK IN PROGRESS - The follwing table is still incomplete!
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
- at item @image{images/fl_abyss} @tab @yref{fl_abyss}
- at tab @image{images/fl_adhesionless} @tab @yref{fl_adhesionless}
- at tab @image{images/fl_aquamarine} @tab @yref{fl_aquamarine}
- at item @image{images/fl_bast} @tab @yref{fl_bast}
- at tab @image{images/fl_bluegray} @tab @yref{fl_bluegray}
- at tab @image{images/fl_bluegreen} @tab @yref{fl_bluegreen}
- at item @image{images/fl_blueslab} @tab @yref{fl_blueslab}
- at tab @image{images/fl_brick} @tab @yref{fl_brick}
- at tab @image{images/fl_bright} @tab @yref{fl_bright}
- at item @image{images/fl_concrete} @tab @yref{fl_concrete}
- at tab @image{images/fl_darkgray} @tab @yref{fl_darkgray}
- at tab @image{images/fl_dark} @tab @yref{fl_dark}
- at item @image{images/fl_dunes} @tab @yref{fl_dunes}
- at tab @image{images/fl_fake_trigger} @tab @yref{fl_fake_trigger}
- at tab @image{images/fl_gravel} @tab @yref{fl_gravel}
- at item @image{images/fl_gray} @tab @yref{fl_gray}
- at tab @image{images/fl_hay} @tab @yref{fl_hay}
- at tab @image{images/fl_himalaya} @tab @yref{fl_himalaya}
- at item @image{images/fl_ice_heating} @tab @yref{fl_ice_heating}
- at tab @image{images/fl_ice} @tab @yref{fl_ice}
- at tab @image{images/fl_inverse_gray} @tab @yref{fl_inverse_gray}
- at item @image{images/fl_inverse_white} @tab @yref{fl_inverse_white}
- at tab @image{images/fl_ivory} @tab @yref{fl_ivory}
- at tab @image{images/fl_lawn} @tab @yref{fl_lawn}
- at item @image{images/fl_marble} @tab @yref{fl_marble}
- at tab @image{images/fl_metal} @tab @yref{fl_metal}
- at tab @image{images/fl_mortar} @tab @yref{fl_mortar}
- at item @image{images/fl_pinkbumps} @tab @yref{fl_pinkbumps}
- at tab @image{images/fl_plank} @tab @yref{fl_plank}
- at tab @image{images/fl_platinum} @tab @yref{fl_platinum}
- at item @image{images/fl_red} @tab @yref{fl_red}
- at tab @image{images/fl_redslab} @tab @yref{fl_redslab}
- at tab @image{images/fl_rock} @tab @yref{fl_rock}
- at item @image{images/fl_rough} @tab @yref{fl_rough}
- at tab @image{images/fl_sahara} @tab @yref{fl_sahara}
- at tab @image{images/fl_samba} @tab @yref{fl_samba}
- at item @image{images/fl_sand} @tab @yref{fl_sand}
- at tab @image{images/fl_space} @tab @yref{fl_space}
- at tab @image{images/fl_stone} @tab @yref{fl_stone}
- at item @image{images/fl_swamp_heating} @tab @yref{fl_swamp_heating}
- at tab @image{images/fl_swamp} @tab @yref{fl_swamp}
- at tab @image{images/fl_tigris} @tab @yref{fl_tigris}
- at item @image{images/fl_water_heating} @tab @yref{fl_water_heating}
- at tab @image{images/fl_water} @tab @yref{fl_water}
- at tab @image{images/fl_white} @tab @yref{fl_white}
- at item @image{images/fl_woven} @tab @yref{fl_woven}
- at tab @image{images/fl_yinyang_yang} @tab @yref{fl_yinyang_yang}
- at tab @image{images/fl_yinyang_yin} @tab @yref{fl_yinyang_yin}
+ at item @image{images/fl_abyss, @oisize{}} @tab @yref{fl_abyss}
+ at tab @image{images/fl_adhesionless, @oisize{}} @tab @yref{fl_adhesionless}
+ at tab @image{images/fl_aquamarine, @oisize{}} @tab @yref{fl_aquamarine}
+ at item @image{images/fl_bast, @oisize{}} @tab @yref{fl_bast}
+ at tab @image{images/fl_bluegray, @oisize{}} @tab @yref{fl_bluegray}
+ at tab @image{images/fl_bluegreen, @oisize{}} @tab @yref{fl_bluegreen}
+ at item @image{images/fl_blueslab, @oisize{}} @tab @yref{fl_blueslab}
+ at tab @image{images/fl_brick, @oisize{}} @tab @yref{fl_brick}
+ at tab @image{images/fl_bright, @oisize{}} @tab @yref{fl_bright}
+ at item @image{images/fl_concrete, @oisize{}} @tab @yref{fl_concrete}
+ at tab @image{images/fl_darkgray, @oisize{}} @tab @yref{fl_darkgray}
+ at tab @image{images/fl_dark, @oisize{}} @tab @yref{fl_dark}
+ at item @image{images/fl_dunes, @oisize{}} @tab @yref{fl_dunes}
+ at tab @image{images/fl_fake_trigger, @oisize{}} @tab @yref{fl_fake_trigger}
+ at tab @image{images/fl_gravel, @oisize{}} @tab @yref{fl_gravel}
+ at item @image{images/fl_gray, @oisize{}} @tab @yref{fl_gray}
+ at tab @image{images/fl_hay, @oisize{}} @tab @yref{fl_hay}
+ at tab @image{images/fl_himalaya, @oisize{}} @tab @yref{fl_himalaya}
+ at item @image{images/fl_ice_heating, @oisize{}} @tab @yref{fl_ice_heating}
+ at tab @image{images/fl_ice, @oisize{}} @tab @yref{fl_ice}
+ at tab @image{images/fl_inverse_gray, @oisize{}} @tab @yref{fl_inverse_gray}
+ at item @image{images/fl_inverse_white, @oisize{}} @tab @yref{fl_inverse_white}
+ at tab @image{images/fl_ivory, @oisize{}} @tab @yref{fl_ivory}
+ at tab @image{images/fl_lawn, @oisize{}} @tab @yref{fl_lawn}
+ at item @image{images/fl_marble, @oisize{}} @tab @yref{fl_marble}
+ at tab @image{images/fl_metal, @oisize{}} @tab @yref{fl_metal}
+ at tab @image{images/fl_mortar, @oisize{}} @tab @yref{fl_mortar}
+ at item @image{images/fl_pinkbumps, @oisize{}} @tab @yref{fl_pinkbumps}
+ at tab @image{images/fl_plank, @oisize{}} @tab @yref{fl_plank}
+ at tab @image{images/fl_platinum, @oisize{}} @tab @yref{fl_platinum}
+ at item @image{images/fl_red, @oisize{}} @tab @yref{fl_red}
+ at tab @image{images/fl_redslab, @oisize{}} @tab @yref{fl_redslab}
+ at tab @image{images/fl_rock, @oisize{}} @tab @yref{fl_rock}
+ at item @image{images/fl_rough, @oisize{}} @tab @yref{fl_rough}
+ at tab @image{images/fl_sahara, @oisize{}} @tab @yref{fl_sahara}
+ at tab @image{images/fl_samba, @oisize{}} @tab @yref{fl_samba}
+ at item @image{images/fl_sand, @oisize{}} @tab @yref{fl_sand}
+ at tab @image{images/fl_space, @oisize{}} @tab @yref{fl_space}
+ at tab @image{images/fl_stone, @oisize{}} @tab @yref{fl_stone}
+ at item @image{images/fl_swamp_heating, @oisize{}} @tab @yref{fl_swamp_heating}
+ at tab @image{images/fl_swamp, @oisize{}} @tab @yref{fl_swamp}
+ at tab @image{images/fl_tigris, @oisize{}} @tab @yref{fl_tigris}
+ at item @image{images/fl_water_heating, @oisize{}} @tab @yref{fl_water_heating}
+ at tab @image{images/fl_water, @oisize{}} @tab @yref{fl_water}
+ at tab @image{images/fl_white, @oisize{}} @tab @yref{fl_white}
+ at item @image{images/fl_woven, @oisize{}} @tab @yref{fl_woven}
+ at tab @image{images/fl_yinyang_yang, @oisize{}} @tab @yref{fl_yinyang_yang}
+ at tab @image{images/fl_yinyang_yin, @oisize{}} @tab @yref{fl_yinyang_yin}
 @end multitable
 
 @c ----------------- Floor Attributes --------------------
@@ -9737,7 +9761,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_adhesionless} @b{fl_adhesionless} 
+ at item @image{images/fl_adhesionless, @oisize{}} @b{fl_adhesionless} 
 @end table
 @end table
 
@@ -9758,7 +9782,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_aquamarine} @b{fl_aquamarine}
+ at item @image{images/fl_aquamarine, @oisize{}} @b{fl_aquamarine}
 @item @b{fl_aquamarine_framed} 
 @end table
 @end table
@@ -9782,7 +9806,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_bast} @b{fl_bast} 
+ at item @image{images/fl_bast, @oisize{}} @b{fl_bast} 
 @item @b{fl_bast_framed}
 @end table
 @end table
@@ -9804,7 +9828,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_bluegray} @b{fl_bluegray}
+ at item @image{images/fl_bluegray, @oisize{}} @b{fl_bluegray}
 @item @b{fl_bluegray_framed}
 @end table
 @end table
@@ -9826,7 +9850,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_bluegreen} @b{fl_bluegreen}
+ at item @image{images/fl_bluegreen, @oisize{}} @b{fl_bluegreen}
 @item @b{fl_bluegreen_framed}
 @end table
 @end table
@@ -9849,7 +9873,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_blueslab} @b{fl_blueslab}
+ at item @image{images/fl_blueslab, @oisize{}} @b{fl_blueslab}
 @item @b{fl_blueslab_framed}
 @end table
 @end table
@@ -9871,7 +9895,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_brick} @b{fl_brick}
+ at item @image{images/fl_brick, @oisize{}} @b{fl_brick}
 @item @b{fl_brick_framed}
 @end table
 @end table
@@ -9894,7 +9918,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_bright} @b{fl_bright}
+ at item @image{images/fl_bright, @oisize{}} @b{fl_bright}
 @item @b{fl_bright_framed}
 @end table
 @end table
@@ -9916,7 +9940,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_concrete} @b{fl_concrete}
+ at item @image{images/fl_concrete, @oisize{}} @b{fl_concrete}
 @item @b{fl_concrete_framed}
 @end table
 @end table
@@ -9939,7 +9963,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_dark} @b{fl_dark}
+ at item @image{images/fl_dark, @oisize{}} @b{fl_dark}
 @item @b{fl_dark_framed}
 @end table
 @end table
@@ -9961,7 +9985,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_darkgray} @b{fl_darkgray}
+ at item @image{images/fl_darkgray, @oisize{}} @b{fl_darkgray}
 @item @b{fl_darkgray_framed}
 @end table
 @end table
@@ -9983,7 +10007,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_dunes} @b{fl_dunes}
+ at item @image{images/fl_dunes, @oisize{}} @b{fl_dunes}
 @item @b{fl_dunes_framed}
 @end table
 @end table
@@ -10005,7 +10029,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_gravel} @b{fl_gravel}
+ at item @image{images/fl_gravel, @oisize{}} @b{fl_gravel}
 @item @b{fl_gravel_framed}
 @end table
 @end table
@@ -10027,7 +10051,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_gray} @b{fl_gray}
+ at item @image{images/fl_gray, @oisize{}} @b{fl_gray}
 @item @b{fl_gray_framed}
 @end table
 @end table
@@ -10049,7 +10073,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_himalaya} @b{fl_himalaya}
+ at item @image{images/fl_himalaya, @oisize{}} @b{fl_himalaya}
 @item @b{fl_himalaya_framed}
 @end table
 @end table
@@ -10071,7 +10095,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_ivory} @b{fl_ivory}
+ at item @image{images/fl_ivory, @oisize{}} @b{fl_ivory}
 @item @b{fl_ivory_framed}
 @end table
 @end table
@@ -10131,7 +10155,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_marble} @b{fl_marble}
+ at item @image{images/fl_marble, @oisize{}} @b{fl_marble}
 @item @b{fl_marble_framed}
 @end table
 @end table
@@ -10191,7 +10215,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_mortar} @b{fl_mortar}
+ at item @image{images/fl_mortar, @oisize{}} @b{fl_mortar}
 @item @b{fl_mortar_framed}
 @end table
 @end table
@@ -10213,7 +10237,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_pinkbumps} @b{fl_pinkbumps}
+ at item @image{images/fl_pinkbumps, @oisize{}} @b{fl_pinkbumps}
 @item @b{fl_pinkbumps_framed}
 @end table
 @end table
@@ -10237,7 +10261,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_plank} @b{fl_plank}
+ at item @image{images/fl_plank, @oisize{}} @b{fl_plank}
 @item @b{fl_plank_framed}
 @end table
 @end table
@@ -10259,7 +10283,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_platinum} @b{fl_platinum}
+ at item @image{images/fl_platinum, @oisize{}} @b{fl_platinum}
 @item @b{fl_platinum_framed}
 @end table
 @end table
@@ -10281,7 +10305,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_red} @b{fl_red}
+ at item @image{images/fl_red, @oisize{}} @b{fl_red}
 @item @b{fl_red_framed}
 @end table
 @end table
@@ -10304,7 +10328,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_redslab} @b{fl_redslab}
+ at item @image{images/fl_redslab, @oisize{}} @b{fl_redslab}
 @item @b{fl_redslab_framed}
 @end table
 @end table
@@ -10326,7 +10350,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_rough} @b{fl_rough}
+ at item @image{images/fl_rough, @oisize{}} @b{fl_rough}
 @item @b{fl_rough_framed}
 @end table
 @end table
@@ -10348,7 +10372,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_sahara} @b{fl_sahara}
+ at item @image{images/fl_sahara, @oisize{}} @b{fl_sahara}
 @item @b{fl_sahara_framed}
 @end table
 @end table
@@ -10400,7 +10424,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_sand} @b{fl_sand}
+ at item @image{images/fl_sand, @oisize{}} @b{fl_sand}
 @item @b{fl_sand_framed}
 @end table
 @end table
@@ -10445,7 +10469,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_stone} @b{fl_stone}
+ at item @image{images/fl_stone, @oisize{}} @b{fl_stone}
 @item @b{fl_stone_framed}
 @end table
 @end table
@@ -10467,7 +10491,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_tigris} @b{fl_tigris}
+ at item @image{images/fl_tigris, @oisize{}} @b{fl_tigris}
 @item @b{fl_tigris_framed}
 @end table
 @end table
@@ -10489,7 +10513,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_white} @b{fl_white}
+ at item @image{images/fl_white, @oisize{}} @b{fl_white}
 @item @b{fl_white_framed}
 @end table
 @end table
@@ -10511,7 +10535,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_woven} @b{fl_woven}
+ at item @image{images/fl_woven, @oisize{}} @b{fl_woven}
 @item @b{fl_woven_framed}
 @end table
 @end table
@@ -11113,78 +11137,78 @@
 @section Item Overview
 
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
- at item @image{images/it_bag} @tab @yref{it_bag}
- at tab @image{images/it_banana} @tab @yref{it_banana}
- at tab @image{images/it_blocker} @tab @yref{it_blocker}
- at item @image{images/it_bomb_black} @tab @yref{it_bomb}_black
- at tab @image{images/it_bomb_white} @tab @yref{it_bomb}_white
- at tab @image{images/it_bottle_idle} @tab @yref{it_bottle}
- at item @image{images/it_bottle_broken} @tab @yref{it_bottle}_broken
- at tab @image{images/st_brake} @tab @yref{it_brake}
- at tab @image{images/it_brush} @tab @yref{it_brush}
- at item @image{images/it_burnable_ash} @tab @yref{it_burnable}_ash
- at tab @image{images/it_burnable_burning} @tab @yref{it_burnable}_burning
- at tab @image{images/it_burnable_fireproof} @tab @yref{it_burnable}_fireproof
- at item @image{images/it_burnable_oil} @tab @yref{it_burnable}_oil
- at tab @image{images/it_cherry} @tab @yref{it_cherry}
- at tab @image{images/it_coffee} @tab @yref{it_coffee}
- at item @image{images/it_coin_s} @tab @yref{it_coin}_s
- at tab @image{images/it_coin_m} @tab @yref{it_coin}_m
- at tab @image{images/it_coin_l} @tab @yref{it_coin}_l
- at item @image{images/it_crack_abyss} @tab @yref{it_crack}_abyss
- at tab @image{images/it_crack_water} @tab @yref{it_crack}_water
- at tab @image{images/it_cross} @tab @yref{it_cross}
- at item @image{images/it_death} @tab @yref{it_death}
- at tab @image{images/it_document} @tab @yref{it_document}
- at tab @image{images/it_drop} @tab @yref{it_drop}
- at item @image{images/it_dynamite} @tab @yref{it_dynamite}
- at tab @image{images/it_explosion} @tab @yref{it_explosion}
- at tab @image{images/it_extralife} @tab @yref{it_extralife}
- at item @image{images/it_extinguisher} @tab @yref{it_extinguisher}
- at tab @image{images/it_flag_black} @tab @yref{it_flag}_black
- at tab @image{images/it_flag_white} @tab @yref{it_flag}_white
- at item @image{images/it_floppy} @tab @yref{it_floppy}
- at tab @image{images/it_glasses} @tab @yref{it_glasses}
- at tab @image{images/it_glasses_broken} @tab @yref{it_glasses}_broken
- at item @image{images/it_hammer} @tab @yref{it_hammer}
- at tab @image{images/it_key} @tab @yref{it_key}
- at tab @image{images/it_landmine} @tab @yref{it_landmine}
- at item @image{images/it_laser} @tab @yref{it_laserbeam}
- at tab @image{images/it_magicwand} @tab @yref{it_magicwand}
- at tab @image{images/it_magnet_off} @tab @yref{it_magnet}
- at item @image{images/it_meditation_bump} @tab @yref{it_meditation}_bump
- at tab @image{images/it_meditation_caldera} @tab @yref{it_meditation}_caledera
- at tab @image{images/it_meditation_dent} @tab @yref{it_meditation}_dent
- at item @image{images/it_meditation_hill} @tab @yref{it_meditation}_hill
- at tab @image{images/it_meditation_hollow} @tab @yref{it_meditation}_hollow
- at tab @image{images/it_meditation_volcano} @tab @yref{it_meditation}_volcano
- at item @image{images/it_pencil} @tab @yref{it_pencil}
- at tab @image{images/it_pin} @tab @yref{it_pin}
- at tab @image{images/it_pipe} @tab @yref{it_pipe}
- at item @image{images/it_puller} @tab @yref{it_puller}
- at tab @image{images/it_ring} @tab @yref{it_ring}
- at tab @image{images/it_rubberband} @tab @yref{it_rubberband}
- at item @image{images/it_seed} @tab @yref{it_seed}
- at tab @image{images/it_sensor} @tab @yref{it_sensor}
- at tab @image{images/it_sensor_exit} @tab @yref{it_sensor}_exit
- at item @image{images/it_shogun_m} @tab @yref{it_shogun}
- at tab @image{images/it_spade} @tab @yref{it_spade}
- at tab @image{images/it_spoon} @tab @yref{it_spoon}
- at item @image{images/it_springboard} @tab @yref{it_springboard}
- at tab @image{images/it_spring_drop} @tab @yref{it_spring}_drop
- at tab @image{images/it_spring_keep} @tab @yref{it_spring}_keep
- at item @image{images/it_squashed} @tab @yref{it_squashed}
- at tab @image{images/it_strip} @tab @yref{it_strip}
- at tab @image{images/it_surprise} @tab @yref{it_surprise}
- at item @image{images/it_sword} @tab @yref{it_sword}
- at tab @image{images/it_trap} @tab @yref{it_trap}
- at tab @image{images/it_trigger} @tab @yref{it_trigger}
- at item @image{images/it_umbrella} @tab @yref{it_umbrella}
- at tab @image{images/it_vortex} @tab @yref{it_vortex}
- at tab @image{images/it_weight} @tab @yref{it_weight}
- at item @image{images/it_wormhole} @tab @yref{it_wormhole}
- at tab @image{images/it_wrench} @tab @yref{it_wrench}
- at tab @image{images/it_yinyang} @tab @yref{it_yinyang}
+ at item @image{images/it_bag, @oisize{}} @tab @yref{it_bag}
+ at tab @image{images/it_banana, @oisize{}} @tab @yref{it_banana}
+ at tab @image{images/it_blocker, @oisize{}} @tab @yref{it_blocker}
+ at item @image{images/it_bomb_black, @oisize{}} @tab @yref{it_bomb}_black
+ at tab @image{images/it_bomb_white, @oisize{}} @tab @yref{it_bomb}_white
+ at tab @image{images/it_bottle_idle, @oisize{}} @tab @yref{it_bottle}
+ at item @image{images/it_bottle_broken, @oisize{}} @tab @yref{it_bottle}_broken
+ at tab @image{images/st_brake, @oisize{}} @tab @yref{it_brake}
+ at tab @image{images/it_brush, @oisize{}} @tab @yref{it_brush}
+ at item @image{images/it_burnable_ash, @oisize{}} @tab @yref{it_burnable}_ash
+ at tab @image{images/it_burnable_burning, @oisize{}} @tab @yref{it_burnable}_burning
+ at tab @image{images/it_burnable_fireproof, @oisize{}} @tab @yref{it_burnable}_fireproof
+ at item @image{images/it_burnable_oil, @oisize{}} @tab @yref{it_burnable}_oil
+ at tab @image{images/it_cherry, @oisize{}} @tab @yref{it_cherry}
+ at tab @image{images/it_coffee, @oisize{}} @tab @yref{it_coffee}
+ at item @image{images/it_coin_s, @oisize{}} @tab @yref{it_coin}_s
+ at tab @image{images/it_coin_m, @oisize{}} @tab @yref{it_coin}_m
+ at tab @image{images/it_coin_l, @oisize{}} @tab @yref{it_coin}_l
+ at item @image{images/it_crack_abyss, @oisize{}} @tab @yref{it_crack}_abyss
+ at tab @image{images/it_crack_water, @oisize{}} @tab @yref{it_crack}_water
+ at tab @image{images/it_cross, @oisize{}} @tab @yref{it_cross}
+ at item @image{images/it_death, @oisize{}} @tab @yref{it_death}
+ at tab @image{images/it_document, @oisize{}} @tab @yref{it_document}
+ at tab @image{images/it_drop, @oisize{}} @tab @yref{it_drop}
+ at item @image{images/it_dynamite, @oisize{}} @tab @yref{it_dynamite}
+ at tab @image{images/it_explosion, @oisize{}} @tab @yref{it_explosion}
+ at tab @image{images/it_extralife, @oisize{}} @tab @yref{it_extralife}
+ at item @image{images/it_extinguisher, @oisize{}} @tab @yref{it_extinguisher}
+ at tab @image{images/it_flag_black, @oisize{}} @tab @yref{it_flag}_black
+ at tab @image{images/it_flag_white, @oisize{}} @tab @yref{it_flag}_white
+ at item @image{images/it_floppy, @oisize{}} @tab @yref{it_floppy}
+ at tab @image{images/it_glasses, @oisize{}} @tab @yref{it_glasses}
+ at tab @image{images/it_glasses_broken, @oisize{}} @tab @yref{it_glasses}_broken
+ at item @image{images/it_hammer, @oisize{}} @tab @yref{it_hammer}
+ at tab @image{images/it_key, @oisize{}} @tab @yref{it_key}
+ at tab @image{images/it_landmine, @oisize{}} @tab @yref{it_landmine}
+ at item @image{images/it_laser, @oisize{}} @tab @yref{it_laserbeam}
+ at tab @image{images/it_magicwand, @oisize{}} @tab @yref{it_magicwand}
+ at tab @image{images/it_magnet_off, @oisize{}} @tab @yref{it_magnet}
+ at item @image{images/it_meditation_bump, @oisize{}} @tab @yref{it_meditation}_bump
+ at tab @image{images/it_meditation_caldera, @oisize{}} @tab @yref{it_meditation}_caledera
+ at tab @image{images/it_meditation_dent, @oisize{}} @tab @yref{it_meditation}_dent
+ at item @image{images/it_meditation_hill, @oisize{}} @tab @yref{it_meditation}_hill
+ at tab @image{images/it_meditation_hollow, @oisize{}} @tab @yref{it_meditation}_hollow
+ at tab @image{images/it_meditation_volcano, @oisize{}} @tab @yref{it_meditation}_volcano
+ at item @image{images/it_pencil, @oisize{}} @tab @yref{it_pencil}
+ at tab @image{images/it_pin, @oisize{}} @tab @yref{it_pin}
+ at tab @image{images/it_pipe, @oisize{}} @tab @yref{it_pipe}
+ at item @image{images/it_puller, @oisize{}} @tab @yref{it_puller}
+ at tab @image{images/it_ring, @oisize{}} @tab @yref{it_ring}
+ at tab @image{images/it_rubberband, @oisize{}} @tab @yref{it_rubberband}
+ at item @image{images/it_seed, @oisize{}} @tab @yref{it_seed}
+ at tab @image{images/it_sensor, @oisize{}} @tab @yref{it_sensor}
+ at tab @image{images/it_sensor_exit, @oisize{}} @tab @yref{it_sensor}_exit
+ at item @image{images/it_shogun_m, @oisize{}} @tab @yref{it_shogun}
+ at tab @image{images/it_spade, @oisize{}} @tab @yref{it_spade}
+ at tab @image{images/it_spoon, @oisize{}} @tab @yref{it_spoon}
+ at item @image{images/it_springboard, @oisize{}} @tab @yref{it_springboard}
+ at tab @image{images/it_spring_drop, @oisize{}} @tab @yref{it_spring}_drop
+ at tab @image{images/it_spring_keep, @oisize{}} @tab @yref{it_spring}_keep
+ at item @image{images/it_squashed, @oisize{}} @tab @yref{it_squashed}
+ at tab @image{images/it_strip, @oisize{}} @tab @yref{it_strip}
+ at tab @image{images/it_surprise, @oisize{}} @tab @yref{it_surprise}
+ at item @image{images/it_sword, @oisize{}} @tab @yref{it_sword}
+ at tab @image{images/it_trap, @oisize{}} @tab @yref{it_trap}
+ at tab @image{images/it_trigger, @oisize{}} @tab @yref{it_trigger}
+ at item @image{images/it_umbrella, @oisize{}} @tab @yref{it_umbrella}
+ at tab @image{images/it_vortex, @oisize{}} @tab @yref{it_vortex}
+ at tab @image{images/it_weight, @oisize{}} @tab @yref{it_weight}
+ at item @image{images/it_wormhole, @oisize{}} @tab @yref{it_wormhole}
+ at tab @image{images/it_wrench, @oisize{}} @tab @yref{it_wrench}
+ at tab @image{images/it_yinyang, @oisize{}} @tab @yref{it_yinyang}
 @end multitable
 
 @c ----------------- Item Attributes --------------------
@@ -11379,7 +11403,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_bag} @b{it_bag}
+ at item @image{images/it_bag, @oisize{}} @b{it_bag}
 @end table
 @end table
 
@@ -11403,7 +11427,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_banana} @b{it_banana}
+ at item @image{images/it_banana, @oisize{}} @b{it_banana}
 @end table
 @end table
 
@@ -11456,9 +11480,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_bottle_idle} @b{it_bottle}: state = @code{IDLE}
- at item @image{images/it_bottle_idle} @b{it_bottle_idle}: state = @code{IDLE}
- at item @image{images/it_bottle_broken} @b{it_bottle_broken}: state = @code{BROKEN}
+ at item @image{images/it_bottle_idle, @oisize{}} @b{it_bottle}: state = @code{IDLE}
+ at item @image{images/it_bottle_idle, @oisize{}} @b{it_bottle_idle}: state = @code{IDLE}
+ at item @image{images/it_bottle_broken, @oisize{}} @b{it_bottle_broken}: state = @code{BROKEN}
 @end table
 
 @end table
@@ -11503,7 +11527,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_brake} @b{it_brake}
+ at item @image{images/st_brake, @oisize{}} @b{it_brake}
 @end table
 
 @end table
@@ -11549,7 +11573,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_brush} @b{it_brush}
+ at item @image{images/it_brush, @oisize{}} @b{it_brush}
 @end table
 
 @end table
@@ -11582,7 +11606,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_cherry} @b{it_cherry}
+ at item @image{images/it_cherry, @oisize{}} @b{it_cherry}
 @end table
 @end table
 
@@ -11605,7 +11629,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_coffee} @b{it_coffee}
+ at item @image{images/it_coffee, @oisize{}} @b{it_coffee}
 @end table
 @end table
 
@@ -11646,10 +11670,10 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_coin_s} @b{it_coin}: state = @code{SMALL}
- at item @image{images/it_coin_s} @b{it_coin_s}: state = @code{SMALL}
- at item @image{images/it_coin_m} @b{it_coin_m}: state = @code{MEDIUM}
- at item @image{images/it_coin_l} @b{it_coin_l}: state = @code{LARGE}
+ at item @image{images/it_coin_s, @oisize{}} @b{it_coin}: state = @code{SMALL}
+ at item @image{images/it_coin_s, @oisize{}} @b{it_coin_s}: state = @code{SMALL}
+ at item @image{images/it_coin_m, @oisize{}} @b{it_coin_m}: state = @code{MEDIUM}
+ at item @image{images/it_coin_l, @oisize{}} @b{it_coin_l}: state = @code{LARGE}
 @end table
 
 @end table
@@ -11687,7 +11711,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_document} @b{it_document}
+ at item @image{images/it_document, @oisize{}} @b{it_document}
 @end table
 @end table
 
@@ -11722,7 +11746,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_drop} @b{it_drop}
+ at item @image{images/it_drop, @oisize{}} @b{it_drop}
 @end table
 
 @end table
@@ -11777,8 +11801,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_dynamite} @b{it_dynamite}: state = @code{IDLE}
- at item @image{images/fl_white} @b{it_dynamite_burning}: state = @code{ACTIVE}
+ at item @image{images/it_dynamite, @oisize{}} @b{it_dynamite}: state = @code{IDLE}
+ at item @image{images/fl_white, @oisize{}} @b{it_dynamite_burning}: state = @code{ACTIVE}
 @end table
 
 @end table
@@ -11823,10 +11847,10 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_extinguisher} @b{it_extinguisher}: state = @code{FULL}
- at item @image{images/it_extinguisher} @b{it_extinguisher_empty}: state = @code{FULL}
- at item @image{images/fl_white} @b{it_extinguisher_medium}: state = @code{MEDIUM}
- at item @image{images/fl_white} @b{it_extinguisher_full}: state = @code{FULL}
+ at item @image{images/it_extinguisher, @oisize{}} @b{it_extinguisher}: state = @code{FULL}
+ at item @image{images/it_extinguisher, @oisize{}} @b{it_extinguisher_empty}: state = @code{FULL}
+ at item @image{images/fl_white, @oisize{}} @b{it_extinguisher_medium}: state = @code{MEDIUM}
+ at item @image{images/fl_white, @oisize{}} @b{it_extinguisher_full}: state = @code{FULL}
 @end table
 
 @end table
@@ -11859,8 +11883,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_extralife} @b{it_extralife}
- at item @image{images/it_extralife} @b{it_extralife_new}: An extralife that is immune to light destruction for a short latency period.
+ at item @image{images/it_extralife, @oisize{}} @b{it_extralife}
+ at item @image{images/it_extralife, @oisize{}} @b{it_extralife_new}: An extralife that is immune to light destruction for a short latency period.
 @end table
 
 @end table
@@ -11892,9 +11916,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_flag_black} @b{it_flag}: color = @code{BLACK}
- at item @image{images/it_flag_black} @b{it_flag_black}: color = @code{BLACK}
- at item @image{images/it_flag_white} @b{it_flag_white}: color = @code{WHITE}
+ at item @image{images/it_flag_black, @oisize{}} @b{it_flag}: color = @code{BLACK}
+ at item @image{images/it_flag_black, @oisize{}} @b{it_flag_black}: color = @code{BLACK}
+ at item @image{images/it_flag_white, @oisize{}} @b{it_flag_white}: color = @code{WHITE}
 @end table
 @end table
 
@@ -11916,7 +11940,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_floppy} @b{it_floppy}
+ at item @image{images/it_floppy, @oisize{}} @b{it_floppy}
 @end table
 
 @end table
@@ -11969,8 +11993,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_glasses} @b{it_glasses} Active glasses item.
- at item @image{images/it_glasses_broken} @b{it_glasses_broken} Broken glasses that spot nothing.
+ at item @image{images/it_glasses, @oisize{}} @b{it_glasses} Active glasses item.
+ at item @image{images/it_glasses_broken, @oisize{}} @b{it_glasses_broken} Broken glasses that spot nothing.
 @end table
 
 @end table
@@ -12005,8 +12029,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_hammer} @b{it_hammer} A standard hammer item.
- at item @image{images/it_hammer} @b{it_hammer_new} A hammer that is immune to light transformations for a short latency period.
+ at item @image{images/it_hammer, @oisize{}} @b{it_hammer} A standard hammer item.
+ at item @image{images/it_hammer, @oisize{}} @b{it_hammer_new} A hammer that is immune to light transformations for a short latency period.
 @end table
 
 @end table
@@ -12037,7 +12061,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_key} @b{it_key}
+ at item @image{images/it_key, @oisize{}} @b{it_key}
 @end table
 @end table
 
@@ -12074,7 +12098,7 @@
 @item @b{Action:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_magicwand} @b{it_magicwand}
+ at item @image{images/it_magicwand, @oisize{}} @b{it_magicwand}
 @end table
 
 @end table
@@ -12110,7 +12134,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_pencil} @b{it_pencil}
+ at item @image{images/it_pencil, @oisize{}} @b{it_pencil}
 @end table
 
 @end table
@@ -12141,7 +12165,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_pin} @b{it_pin}
+ at item @image{images/it_pin, @oisize{}} @b{it_pin}
 @end table
 
 @end table
@@ -12178,17 +12202,17 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_white} @b{it_pipe} connections = @code{"ew"} The horizontal pipe.
- at item @image{images/fl_white} @b{it_pipe_w} connections = @code{"w"}
- at item @image{images/fl_white} @b{it_pipe_s} connections = @code{"s"}
- at item @image{images/fl_white} @b{it_pipe_sw} connections = @code{"sw"}
- at item @image{images/it_pipe} @b{it_pipe_e} connections = @code{"e"}
- at item @image{images/fl_white} @b{it_pipe_ew} connections = @code{"ew"} The horizontal pipe.
- at item @image{images/fl_white} @b{it_pipe_es} connections = @code{"es"}
- at item @image{images/fl_white} @b{it_pipe_n} connections = @code{"n"}
- at item @image{images/fl_white} @b{it_pipe_nw} connections = @code{"nw"}
- at item @image{images/fl_white} @b{it_pipe_ns} connections = @code{"ns"} The vertical pipe.
- at item @image{images/fl_white}@b{it_pipe_ne} connections = @code{"ne"}
+ at item @image{images/fl_white, @oisize{}} @b{it_pipe} connections = @code{"ew"} The horizontal pipe.
+ at item @image{images/fl_white, @oisize{}} @b{it_pipe_w} connections = @code{"w"}
+ at item @image{images/fl_white, @oisize{}} @b{it_pipe_s} connections = @code{"s"}
+ at item @image{images/fl_white, @oisize{}} @b{it_pipe_sw} connections = @code{"sw"}
+ at item @image{images/it_pipe, @oisize{}} @b{it_pipe_e} connections = @code{"e"}
+ at item @image{images/fl_white, @oisize{}} @b{it_pipe_ew} connections = @code{"ew"} The horizontal pipe.
+ at item @image{images/fl_white, @oisize{}} @b{it_pipe_es} connections = @code{"es"}
+ at item @image{images/fl_white, @oisize{}} @b{it_pipe_n} connections = @code{"n"}
+ at item @image{images/fl_white, @oisize{}} @b{it_pipe_nw} connections = @code{"nw"}
+ at item @image{images/fl_white, @oisize{}} @b{it_pipe_ns} connections = @code{"ns"} The vertical pipe.
+ at item @image{images/fl_white, @oisize{}}@b{it_pipe_ne} connections = @code{"ne"}
 @end table
 @end table
 
@@ -12223,11 +12247,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_white} @b{it_puller} orientation = @code{WEST}
- at item @image{images/fl_white}@b{it_puller_w} orientation = @code{WEST}
- at item @image{images/fl_white}@b{it_puller_s} orientation = @code{SOUTH}
- at item @image{images/fl_white}@b{it_puller_e} orientation = @code{EAST}
- at item @image{images/it_puller} @b{it_puller_n} orientation = @code{NORTH}
+ at item @image{images/fl_white, @oisize{}} @b{it_puller} orientation = @code{WEST}
+ at item @image{images/fl_white, @oisize{}} @b{it_puller_w} orientation = @code{WEST}
+ at item @image{images/fl_white, @oisize{}} @b{it_puller_s} orientation = @code{SOUTH}
+ at item @image{images/fl_white, @oisize{}} @b{it_puller_e} orientation = @code{EAST}
+ at item @image{images/it_puller, @oisize{}} @b{it_puller_n} orientation = @code{NORTH}
 @end table
 @end table
 
@@ -12265,7 +12289,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_ring} @b{it_ring}
+ at item @image{images/it_ring, @oisize{}} @b{it_ring}
 @end table
 
 @end table
@@ -12324,7 +12348,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_rubberband} @b{it_rubberband}
+ at item @image{images/it_rubberband, @oisize{}} @b{it_rubberband}
 @end table
 @end table
 
@@ -12377,11 +12401,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_seed} @b{it_seed} flavor = @code{"wood"}
- at item @image{images/it_seed} @b{it_seed_wood} flavor = @code{"wood"}
- at item @image{images/it_seed} @b{it_seed_hay} flavor = @code{"hay"}
- at item @image{images/it_seed} @b{it_seed_greenbrown} flavor = @code{"greenbrown"}
- at item @image{images/it_seed} @b{it_seed_volcano} flavor = @code{"volcano"}
+ at item @image{images/it_seed, @oisize{}} @b{it_seed} flavor = @code{"wood"}
+ at item @image{images/it_seed, @oisize{}} @b{it_seed_wood} flavor = @code{"wood"}
+ at item @image{images/it_seed, @oisize{}} @b{it_seed_hay} flavor = @code{"hay"}
+ at item @image{images/it_seed, @oisize{}} @b{it_seed_greenbrown} flavor = @code{"greenbrown"}
+ at item @image{images/it_seed, @oisize{}} @b{it_seed_volcano} flavor = @code{"volcano"}
 @end table
 
 @end table
@@ -12405,7 +12429,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_spade} @b{it_spade}
+ at item @image{images/it_spade, @oisize{}} @b{it_spade}
 @end table
 
 @end table
@@ -12437,7 +12461,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_spoon} @b{it_spoon}
+ at item @image{images/it_spoon, @oisize{}} @b{it_spoon}
 @end table
 
 @end table
@@ -12464,9 +12488,9 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_spring_keep} @b{it_spring}
- at item @image{images/it_spring_keep} @b{it_spring_keep}
- at item @image{images/it_spring_drop} @b{it_spring_drop}
+ at item @image{images/it_spring_keep, @oisize{}} @b{it_spring}
+ at item @image{images/it_spring_keep, @oisize{}} @b{it_spring_keep}
+ at item @image{images/it_spring_drop, @oisize{}} @b{it_spring_drop}
 @end table
 @end table
 
@@ -12515,7 +12539,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_surprise} @b{it_surprise}
+ at item @image{images/it_surprise, @oisize{}} @b{it_surprise}
 @end table
 
 @end table
@@ -12548,8 +12572,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_sword} @b{it_sword} A standard sword item.
- at item @image{images/it_sword} @b{it_sword_new} A sword that is immune to light transformations for a short latency period.
+ at item @image{images/it_sword, @oisize{}} @b{it_sword} A standard sword item.
+ at item @image{images/it_sword, @oisize{}} @b{it_sword_new} A sword that is immune to light transformations for a short latency period.
 @end table
 
 @end table
@@ -12588,8 +12612,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_umbrella} @b{it_umbrella} A standard umbrella item.
- at item @image{images/it_umbrella} @b{it_umbrella_new} An umbrella that is immune to light destruction for a short latency period.
+ at item @image{images/it_umbrella, @oisize{}} @b{it_umbrella} A standard umbrella item.
+ at item @image{images/it_umbrella, @oisize{}} @b{it_umbrella_new} An umbrella that is immune to light destruction for a short latency period.
 @end table
 
 @end table
@@ -12624,7 +12648,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_weight} @b{it_weight}
+ at item @image{images/it_weight, @oisize{}} @b{it_weight}
 @end table
 
 @end table
@@ -12651,7 +12675,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_wrench} @b{it_wrench}
+ at item @image{images/it_wrench, @oisize{}} @b{it_wrench}
 @end table
 
 @end table
@@ -12683,7 +12707,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_yinyang} @b{it_yinyang}
+ at item @image{images/it_yinyang, @oisize{}} @b{it_yinyang}
 @end table
 
 @end table
@@ -12789,9 +12813,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_blocker} @b{it_blocker}
+ at item @image{images/it_blocker, @oisize{}} @b{it_blocker}
 A standard blocker item.
- at item @image{images/it_blocker} @b{it_blocker_new}
+ at item @image{images/it_blocker, @oisize{}} @b{it_blocker_new}
 A blocker that just finished shrinking. Mainly used internally as the direct
 successor of an @ref{st_blocker}. But it may be useful to generate an initial
 snapshot of a moving boulder over a blocker line, too. See example levels.
@@ -12849,9 +12873,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_bomb_black} @b{it_bomb}: color = @code{BLACK}
- at item @image{images/it_bomb_black} @b{it_bomb_black}: color = @code{BLACK}
- at item @image{images/it_bomb_white} @b{it_bomb_white}: color = @code{WHITE}
+ at item @image{images/it_bomb_black, @oisize{}} @b{it_bomb}: color = @code{BLACK}
+ at item @image{images/it_bomb_black, @oisize{}} @b{it_bomb_black}: color = @code{BLACK}
+ at item @image{images/it_bomb_white, @oisize{}} @b{it_bomb_white}: color = @code{WHITE}
 @end table
 
 @end table
@@ -12912,13 +12936,13 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_white} @b{it_burnable}: state = @code{0}
- at item @image{images/fl_white} @b{it_burnable_invisible}: state = @code{0}
- at item @image{images/it_burnable_oil} @b{it_burnable_oil}: state = @code{1}
- at item @image{images/fl_white} @b{it_burnable_ignited}: state = @code{2}
- at item @image{images/it_burnable_burning} @b{it_burnable_burning}: state = @code{3}
- at item @image{images/it_burnable_ash} @b{it_burnable_ash}: state = @code{4}
- at item @image{images/it_burnable_fireproof} @b{it_burnable_fireproof}: state = @code{5}
+ at item @image{images/fl_white, @oisize{}} @b{it_burnable}: state = @code{0}
+ at item @image{images/fl_white, @oisize{}} @b{it_burnable_invisible}: state = @code{0}
+ at item @image{images/it_burnable_oil, @oisize{}} @b{it_burnable_oil}: state = @code{1}
+ at item @image{images/fl_white, @oisize{}} @b{it_burnable_ignited}: state = @code{2}
+ at item @image{images/it_burnable_burning, @oisize{}} @b{it_burnable_burning}: state = @code{3}
+ at item @image{images/it_burnable_ash, @oisize{}} @b{it_burnable_ash}: state = @code{4}
+ at item @image{images/it_burnable_fireproof, @oisize{}} @b{it_burnable_fireproof}: state = @code{5}
 @end table
 
 @end table
@@ -13008,11 +13032,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_crack_abyss} @b{it_crack}: state = @code{SMALL}
- at item @image{images/fl_white} @b{it_crack_i}: state = @code{INVISIBLE}
- at item @image{images/it_crack_abyss} @b{it_crack_s}: state = @code{SMALL}
- at item @image{images/fl_white} @b{it_crack_m}: state = @code{MEDIUM}
- at item @image{images/fl_white} @b{it_crack_l}: state = @code{LARGE}
+ at item @image{images/it_crack_abyss, @oisize{}} @b{it_crack}: state = @code{SMALL}
+ at item @image{images/fl_white, @oisize{}} @b{it_crack_i}: state = @code{INVISIBLE}
+ at item @image{images/it_crack_abyss, @oisize{}} @b{it_crack_s}: state = @code{SMALL}
+ at item @image{images/fl_white, @oisize{}} @b{it_crack_m}: state = @code{MEDIUM}
+ at item @image{images/fl_white, @oisize{}} @b{it_crack_l}: state = @code{LARGE}
 @end table
 
 @end table
@@ -13053,7 +13077,7 @@
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_cross} @b{it_cross}
+ at item @image{images/it_cross, @oisize{}} @b{it_cross}
 @end table
 @end table
 
@@ -13085,7 +13109,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_death} @b{it_death}
+ at item @image{images/it_death, @oisize{}} @b{it_death}
 @end table
 
 @end table
@@ -13126,11 +13150,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_explosion} @b{it_explosion}: state = @code{0}
- at item @image{images/it_explosion} @b{it_explosion_nil}: state = @code{0}
- at item @image{images/it_explosion} @b{it_explosion_hollow}: state = @code{1}
- at item @image{images/it_explosion} @b{it_explosion_crack}: state = @code{2}
- at item @image{images/it_explosion} @b{it_explosion_debris}: state = @code{3}
+ at item @image{images/it_explosion, @oisize{}} @b{it_explosion}: state = @code{0}
+ at item @image{images/it_explosion, @oisize{}} @b{it_explosion_nil}: state = @code{0}
+ at item @image{images/it_explosion, @oisize{}} @b{it_explosion_hollow}: state = @code{1}
+ at item @image{images/it_explosion, @oisize{}} @b{it_explosion_crack}: state = @code{2}
+ at item @image{images/it_explosion, @oisize{}} @b{it_explosion_debris}: state = @code{3}
 @end table
 
 @end table
@@ -13163,7 +13187,7 @@
 @item @b{Action:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_landmine} @b{it_landmine}
+ at item @image{images/it_landmine, @oisize{}} @b{it_landmine}
 @end table
 
 @end table
@@ -13189,7 +13213,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_laser} @b{it_laserbeam} can not be instanciated by levels
+ at item @image{images/it_laser, @oisize{}} @b{it_laserbeam} can not be instanciated by levels
 @end table
 @end table
 
@@ -13242,9 +13266,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_magnet_off} @b{it_magnet} state = @samp{OFF}.
- at item @image{images/it_magnet_on} @b{it_magnet_on} state = @samp{ON}.
- at item @image{images/it_magnet_off} @b{it_magnet_off} state = @samp{OFF}.
+ at item @image{images/it_magnet_off, @oisize{}} @b{it_magnet} state = @samp{OFF}.
+ at item @image{images/it_magnet_on, @oisize{}} @b{it_magnet_on} state = @samp{ON}.
+ at item @image{images/it_magnet_off, @oisize{}} @b{it_magnet_off} state = @samp{OFF}.
 @end table
 
 @end table
@@ -13330,13 +13354,13 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_meditation_hollow} @b{it_meditation} state = @code{MEDITATION_HOLLOW}
- at item @image{images/it_meditation_caldera} @b{it_meditation_caldera} state = @code{MEDITATION_CALDERA}
- at item @image{images/it_meditation_hollow} @b{it_meditation_hollow} state = @code{MEDITATION_HOLLOW}
- at item @image{images/it_meditation_dent} @b{it_meditation_dent} state = @code{MEDITATION_DENT}
- at item @image{images/it_meditation_bump} @b{it_meditation_bump} state = @code{MEDITATION_BUMP}
- at item @image{images/it_meditation_hill} @b{it_meditation_hill} state = @code{MEDITATION_HILL}
- at item @image{images/it_meditation_volcano} @b{it_meditation_volcano} state = @code{MEDITATION_VOLCANO}
+ at item @image{images/it_meditation_hollow, @oisize{}} @b{it_meditation} state = @code{MEDITATION_HOLLOW}
+ at item @image{images/it_meditation_caldera, @oisize{}} @b{it_meditation_caldera} state = @code{MEDITATION_CALDERA}
+ at item @image{images/it_meditation_hollow, @oisize{}} @b{it_meditation_hollow} state = @code{MEDITATION_HOLLOW}
+ at item @image{images/it_meditation_dent, @oisize{}} @b{it_meditation_dent} state = @code{MEDITATION_DENT}
+ at item @image{images/it_meditation_bump, @oisize{}} @b{it_meditation_bump} state = @code{MEDITATION_BUMP}
+ at item @image{images/it_meditation_hill, @oisize{}} @b{it_meditation_hill} state = @code{MEDITATION_HILL}
+ at item @image{images/it_meditation_volcano, @oisize{}} @b{it_meditation_volcano} state = @code{MEDITATION_VOLCANO}
 @end table
 
 @end table
@@ -13389,8 +13413,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_sensor} @b{it_sensor}: exit = @code{false}
- at item @image{images/it_sensor_exit} @b{it_sensor_exit}: exit = @code{true}
+ at item @image{images/it_sensor, @oisize{}} @b{it_sensor}: exit = @code{false}
+ at item @image{images/it_sensor_exit, @oisize{}} @b{it_sensor_exit}: exit = @code{true}
 @end table
 
 @end table
@@ -13439,10 +13463,10 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_shogun_s} @b{it_shogun}: flavor = @code{"s"}
- at item @image{images/it_shogun_s} @b{it_shogun_s}: flavor = @code{"s"}
- at item @image{images/it_shogun_m} @b{it_shogun_m}: flavor = @code{"m"}
- at item @image{images/it_shogun_l} @b{it_shogun_l}: flavor = @code{"l"}
+ at item @image{images/it_shogun_s, @oisize{}} @b{it_shogun}: flavor = @code{"s"}
+ at item @image{images/it_shogun_s, @oisize{}} @b{it_shogun_s}: flavor = @code{"s"}
+ at item @image{images/it_shogun_m, @oisize{}} @b{it_shogun_m}: flavor = @code{"m"}
+ at item @image{images/it_shogun_l, @oisize{}} @b{it_shogun_l}: flavor = @code{"l"}
 @end table
 
 @end table
@@ -13469,7 +13493,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_springboard} @b{it_springboard}
+ at item @image{images/it_springboard, @oisize{}} @b{it_springboard}
 @end table
 
 @end table
@@ -13496,7 +13520,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_squashed} @b{it_squashed}
+ at item @image{images/it_squashed, @oisize{}} @b{it_squashed}
 @end table
 @end table
 
@@ -13540,22 +13564,22 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_strip} @b{it_strip}: connections = @code{""}
- at item @image{images/fl_white} @b{it_strip_w}: connections = @code{"w"}
- at item @image{images/fl_white} @b{it_strip_s}: connections = @code{"s"}
- at item @image{images/fl_white} @b{it_strip_sw}: connections = @code{"sw"}
- at item @image{images/fl_white} @b{it_strip_e}: connections = @code{"e"}
- at item @image{images/fl_white} @b{it_strip_ew}: connections = @code{"ew"}
- at item @image{images/fl_white} @b{it_strip_es}: connections = @code{"es"}
- at item @image{images/fl_white} @b{it_strip_esw}: connections = @code{"esw"}
- at item @image{images/fl_white} @b{it_strip_n}: connections = @code{"n"}
- at item @image{images/fl_white} @b{it_strip_nw}: connections = @code{"nw"}
- at item @image{images/fl_white} @b{it_strip_ns}: connections = @code{"ns"}
- at item @image{images/fl_white} @b{it_strip_nsw}: connections = @code{"nsw"}
- at item @image{images/fl_white} @b{it_strip_ne}: connections = @code{"ne"}
- at item @image{images/fl_white} @b{it_strip_new}: connections = @code{"new"}
- at item @image{images/fl_white} @b{it_strip_nes}: connections = @code{"nes"}
- at item @image{images/fl_white} @b{it_strip_nesw}: connections = @code{"nesw"}
+ at item @image{images/it_strip, @oisize{}} @b{it_strip}: connections = @code{""}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_w}: connections = @code{"w"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_s}: connections = @code{"s"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_sw}: connections = @code{"sw"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_e}: connections = @code{"e"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_ew}: connections = @code{"ew"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_es}: connections = @code{"es"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_esw}: connections = @code{"esw"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_n}: connections = @code{"n"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_nw}: connections = @code{"nw"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_ns}: connections = @code{"ns"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_nsw}: connections = @code{"nsw"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_ne}: connections = @code{"ne"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_new}: connections = @code{"new"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_nes}: connections = @code{"nes"}
+ at item @image{images/fl_white, @oisize{}} @b{it_strip_nesw}: connections = @code{"nesw"}
 
 @end table
 
@@ -13603,7 +13627,7 @@
 @end table
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_trap} @b{it_trap}
+ at item @image{images/it_trap, @oisize{}} @b{it_trap}
 @end table
 
 @end table
@@ -13662,7 +13686,7 @@
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_trigger} @b{it_trigger}
+ at item @image{images/it_trigger, @oisize{}} @b{it_trigger}
 @end table
 
 @end table
@@ -13748,9 +13772,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_vortex} @b{it_vortex}:  state = @code{OPEN}.
- at item @image{images/it_vortex} @b{it_vortex_open}: state = @code{OPEN}.
- at item @image{images/fl_white} @b{it_vortex_closed}: state @samp{CLOSED}.
+ at item @image{images/it_vortex, @oisize{}} @b{it_vortex}:  state = @code{OPEN}.
+ at item @image{images/it_vortex, @oisize{}} @b{it_vortex_open}: state = @code{OPEN}.
+ at item @image{images/fl_white, @oisize{}} @b{it_vortex_closed}: state @samp{CLOSED}.
 @end table
 @end table
 
@@ -13823,9 +13847,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_wormhole} @b{it_wormhole}: state = @code{OFF}.
- at item @image{images/it_wormhole} @b{it_wormhole_on}: state = @code{ON}.
- at item @image{images/fl_white} @b{it_wormhole_off}: state @code{OFF}.
+ at item @image{images/it_wormhole, @oisize{}} @b{it_wormhole}: state = @code{OFF}.
+ at item @image{images/it_wormhole, @oisize{}} @b{it_wormhole_on}: state = @code{ON}.
+ at item @image{images/fl_white, @oisize{}} @b{it_wormhole_off}: state @code{OFF}.
 @end table
 @end table
 
@@ -13849,65 +13873,86 @@
 
 WORK IN PROGRESS - The follwing table is still incomplete!
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
- at item @image{images/st_ancient} @tab @yref{st_ancient}
- at tab @image{images/st_beads} @tab @yref{st_beads}
- at tab @image{images/st_bluegray} @tab @yref{st_bluegray}
- at item @image{images/st_blur_cross} @tab @yref{st_blur}_cross
- at tab @image{images/st_blur_straight} @tab @yref{st_blur}_straight
- at tab @image{images/st_brake} @tab @yref{st_brake}
- at item @image{images/st_break_black} @tab @yref{st_break}_black
- at tab @image{images/st_break_boulder} @tab @yref{st_break}_boulder
- at tab @image{images/st_break_oxydc} @tab @yref{st_break}_oxydc
- at item @image{images/st_break_plain} @tab @yref{st_break}_plain
- at tab @image{images/st_break_white} @tab @yref{st_break}_white
- at tab @image{images/st_brownie} @tab @yref{st_brownie}
- at item @image{images/st_brownmarble} @tab @yref{st_brownmarble}
- at tab @image{images/st_brownpyramide} @tab @yref{st_brownpyramide}
- at tab @image{images/st_camouflage} @tab @yref{st_camouflage}
- at item @image{images/st_concrete} @tab @yref{st_concrete}
- at tab @image{images/st_darkglass} @tab @yref{st_darkglass}
- at tab @image{images/st_darkgray} @tab @yref{st_darkgray}
- at item @image{images/st_death} @tab @yref{st_death}
- at tab @image{images/st_dispenser_bombblack} @tab @yref{st_dispenser}_bombblack
- at tab @image{images/st_dispenser_bombwhite} @tab @yref{st_dispenser}_bombwhite
- at item @image{images/st_dispenser_dynamite} @tab @yref{st_dispenser}_dynamite
- at tab @image{images/st_flash} @tab @yref{st_flash}
- at tab @image{images/st_flat} @tab @yref{st_flat}
- at item @image{images/st_granite} @tab @yref{st_granite}
- at tab @image{images/st_grate_cross} @tab @yref{st_grate}_cross
- at tab @image{images/st_grate_framed} @tab @yref{st_grate}_framed
- at item @image{images/st_greenbrown} @tab @yref{st_greenbrown}
- at tab @image{images/st_greengray} @tab @yref{st_greengray}
- at tab @image{images/st_ice} @tab @yref{st_ice}
- at item                            @tab @yref{st_invisible}
- at tab @image{images/st_jamb_black} @tab @yref{st_jamb}_black
- at tab @image{images/st_jamb_white} @tab @yref{st_jamb}_white
- at item @image{images/st_lightglass} @tab @yref{st_lightglass}
- at tab @image{images/st_metal} @tab @yref{st_metal}
- at tab @image{images/st_oxyda} @tab @yref{st_oxyd}_a
- at item @image{images/st_oxydb} @tab @yref{st_oxyd}_b
- at tab @image{images/st_oxydc} @tab @yref{st_oxyd}_c
- at tab @image{images/st_oxydd} @tab @yref{st_oxyd}_d
- at item @image{images/st_oxyde} @tab @yref{st_oxyd}_e
- at tab @image{images/st_pinkbumps} @tab @yref{st_pinkbumps}
- at tab @image{images/st_plaster} @tab @yref{st_plaster}
- at item @image{images/st_plop_slate} @tab @yref{st_plop}_slate
- at tab @image{images/st_portal_horse} @tab @yref{st_portal}
- at tab @image{images/st_purplegray} @tab @yref{st_purplegray}
- at item @image{images/st_purplemarble} @tab @yref{st_purplemarble}
- at tab @image{images/st_rawglass} @tab @yref{st_rawglass}
- at tab @image{images/st_rawglass_quad} @tab @yref{st_rawglass}_quad
- at item @image{images/st_redbrown} @tab @yref{st_redbrown}
- at tab @image{images/st_redfiber} @tab @yref{st_redfiber}
- at tab @image{images/st_redmarble} @tab @yref{st_redmarble}
- at item @image{images/st_redrock} @tab @yref{st_redrock}
- at tab @image{images/st_spitter_idle} @tab @yref{st_spitter}
- at tab @image{images/st_surprise} @tab @yref{st_surprise}
- at item @image{images/st_tigris} @tab @yref{st_tigris}
- at tab @image{images/st_woven} @tab @yref{st_woven}
- at tab @image{images/st_yellow} @tab @yref{st_yellow}
- at item @image{images/st_yinyang} @tab @yref{st_yinyang}
- at tab @image{images/st_yinyang_inactive} @tab @yref{st_yinyang}_inactive 
+ at item @image{images/st_actorimpulse, @oisize{}} @tab @yref{st_actorimpulse}
+ at tab @image{images/st_ancient, @oisize{}} @tab @yref{st_ancient}
+ at tab @image{images/st_beads, @oisize{}} @tab @yref{st_beads}
+ at item @image{images/st_bluegray, @oisize{}} @tab @yref{st_bluegray}
+ at tab @image{images/st_blur_cross, @oisize{}} @tab @yref{st_blur}_cross
+ at tab @image{images/st_blur_straight, @oisize{}} @tab @yref{st_blur}_straight
+ at item @image{images/st_box_hay, @oisize{}} @tab @yref{st_box}_hay
+ at tab @image{images/st_box_rock, @oisize{}} @tab @yref{st_box}_rock
+ at tab @image{images/st_box_wood, @oisize{}} @tab @yref{st_box}_wood
+ at item @image{images/st_brake, @oisize{}} @tab @yref{st_brake}
+ at tab @image{images/st_break_black, @oisize{}} @tab @yref{st_break}_black
+ at tab @image{images/st_break_boulder, @oisize{}} @tab @yref{st_break}_boulder
+ at item @image{images/st_break_bug, @oisize{}} @tab @yref{st_break}_bug
+ at tab @image{images/st_break_oxydc, @oisize{}} @tab @yref{st_break}_oxydc
+ at tab @image{images/st_break_plain, @oisize{}} @tab @yref{st_break}_plain
+ at item @image{images/st_break_white, @oisize{}} @tab @yref{st_break}_white
+ at tab @image{images/st_brownie, @oisize{}} @tab @yref{st_brownie}
+ at tab @image{images/st_brownmarble, @oisize{}} @tab @yref{st_brownmarble}
+ at item @image{images/st_brownpyramide, @oisize{}} @tab @yref{st_brownpyramide}
+ at tab @image{images/st_camouflage, @oisize{}} @tab @yref{st_camouflage}
+ at tab @image{images/st_charge_minus, @oisize{}} @tab @yref{st_charge}_minus
+ at item @image{images/st_charge_plus, @oisize{}} @tab @yref{st_charge}_plus
+ at tab @image{images/st_charge_zero, @oisize{}} @tab @yref{st_charge}_zero
+ at tab @image{images/st_chess_black, @oisize{}} @tab @yref{st_chess}_black
+ at item @image{images/st_chess_white, @oisize{}} @tab @yref{st_chess}_white
+ at tab @image{images/st_concrete, @oisize{}} @tab @yref{st_concrete}
+ at tab @image{images/st_darkglass, @oisize{}} @tab @yref{st_darkglass}
+ at item @image{images/st_darkgray, @oisize{}} @tab @yref{st_darkgray}
+ at tab @image{images/st_death, @oisize{}} @tab @yref{st_death}
+ at tab @image{images/st_dispenser_bombblack, @oisize{}} @tab @yref{st_dispenser}_bombblack
+ at item @image{images/st_dispenser_bombwhite, @oisize{}} @tab @yref{st_dispenser}_bombwhite
+ at tab @image{images/st_dispenser_dynamite, @oisize{}} @tab @yref{st_dispenser}_dynamite
+ at tab @image{images/st_flash, @oisize{}} @tab @yref{st_flash}
+ at item @image{images/st_flat, @oisize{}} @tab @yref{st_flat}
+ at tab @image{images/st_fourswitch, @oisize{}} @tab @yref{st_fourswitch}
+ at tab @image{images/st_granite, @oisize{}} @tab @yref{st_granite}
+ at item @image{images/st_grate_cross, @oisize{}} @tab @yref{st_grate}_cross
+ at tab @image{images/st_grate_framed, @oisize{}} @tab @yref{st_grate}_framed
+ at tab @image{images/st_greenbrown, @oisize{}} @tab @yref{st_greenbrown}
+ at item @image{images/st_greengray, @oisize{}} @tab @yref{st_greengray}
+ at tab @image{images/st_ice, @oisize{}} @tab @yref{st_ice}
+ at tab                            @tab @yref{st_invisible}
+ at item @image{images/st_jamb_black, @oisize{}} @tab @yref{st_jamb}_black
+ at tab @image{images/st_jamb_white, @oisize{}} @tab @yref{st_jamb}_white
+ at tab @image{images/st_knight, @oisize{}} @tab @yref{st_knight}
+ at item @image{images/st_lightglass, @oisize{}} @tab @yref{st_lightglass}
+ at tab @image{images/st_lightpassenger, @oisize{}} @tab @yref{st_lightpassenger}
+ at tab @image{images/st_metal, @oisize{}} @tab @yref{st_metal}
+ at item @image{images/st_oxyda, @oisize{}} @tab @yref{st_oxyd}_a
+ at tab @image{images/st_oxydb, @oisize{}} @tab @yref{st_oxyd}_b
+ at tab @image{images/st_oxydc, @oisize{}} @tab @yref{st_oxyd}_c
+ at item @image{images/st_oxydd, @oisize{}} @tab @yref{st_oxyd}_d
+ at tab @image{images/st_oxyde, @oisize{}} @tab @yref{st_oxyd}_e
+ at tab @image{images/st_passage_black_square, @oisize{}} @tab @yref{st_passage}_black
+ at item @image{images/st_passage_black_slash, @oisize{}} @tab @yref{st_passage}_black
+ at tab @image{images/st_passage_black_cross, @oisize{}} @tab @yref{st_passage}_black
+ at tab @image{images/st_passage_black_frame, @oisize{}} @tab @yref{st_passage}_black
+ at item @image{images/st_passage_white_square, @oisize{}} @tab @yref{st_passage}_white
+ at tab @image{images/st_passage_white_slash, @oisize{}} @tab @yref{st_passage}_white
+ at tab @image{images/st_passage_white_cross, @oisize{}} @tab @yref{st_passage}_white
+ at item @image{images/st_passage_white_frame, @oisize{}} @tab @yref{st_passage}_white
+ at tab @image{images/st_pinkbumps, @oisize{}} @tab @yref{st_pinkbumps}
+ at tab @image{images/st_plaster, @oisize{}} @tab @yref{st_plaster}
+ at item @image{images/st_plop_slate, @oisize{}} @tab @yref{st_plop}_slate
+ at tab @image{images/st_portal_horse, @oisize{}} @tab @yref{st_portal}
+ at tab @image{images/st_purplegray, @oisize{}} @tab @yref{st_purplegray}
+ at item @image{images/st_purplemarble, @oisize{}} @tab @yref{st_purplemarble}
+ at tab @image{images/st_rawglass, @oisize{}} @tab @yref{st_rawglass}
+ at tab @image{images/st_rawglass_quad, @oisize{}} @tab @yref{st_rawglass}_quad
+ at item @image{images/st_redbrown, @oisize{}} @tab @yref{st_redbrown}
+ at tab @image{images/st_redfiber, @oisize{}} @tab @yref{st_redfiber}
+ at tab @image{images/st_redmarble, @oisize{}} @tab @yref{st_redmarble}
+ at item @image{images/st_redrock, @oisize{}} @tab @yref{st_redrock}
+ at tab @image{images/st_spitter_idle, @oisize{}} @tab @yref{st_spitter}
+ at tab @image{images/st_surprise, @oisize{}} @tab @yref{st_surprise}
+ at item @image{images/st_tigris, @oisize{}} @tab @yref{st_tigris}
+ at tab @image{images/st_woven, @oisize{}} @tab @yref{st_woven}
+ at tab @image{images/st_yellow, @oisize{}} @tab @yref{st_yellow}
+ at item @image{images/st_yinyang, @oisize{}} @tab @yref{st_yinyang}
+ at tab @image{images/st_yinyang_inactive, @oisize{}} @tab @yref{st_yinyang}_inactive 
 @end multitable
 
 @c ----------------- Stone Attributes --------------------
@@ -14078,7 +14123,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_ancient} @b{st_ancient}
+ at item @image{images/st_ancient, @oisize{}} @b{st_ancient}
 @end table
 @end table
 
@@ -14093,8 +14138,8 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_bluegray} @b{st_bluegray}
- at item @image{images/st_bluegray} @b{st_bluegray_hollow}
+ at item @image{images/st_bluegray, @oisize{}} @b{st_bluegray}
+ at item @image{images/st_bluegray, @oisize{}} @b{st_bluegray_hollow}
 @end table
 @end table
 
@@ -14108,7 +14153,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_brownie} @b{st_brownie}
+ at item @image{images/st_brownie, @oisize{}} @b{st_brownie}
 @end table
 @end table
 
@@ -14122,7 +14167,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_brownmarble} @b{st_brownmarble}
+ at item @image{images/st_brownmarble, @oisize{}} @b{st_brownmarble}
 @end table
 @end table
 
@@ -14136,7 +14181,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_camouflage} @b{st_camouflage}
+ at item @image{images/st_camouflage, @oisize{}} @b{st_camouflage}
 @item @b{st_camouflage_hollow}
 @item @b{st_camouflage_movable}
 @end table
@@ -14152,7 +14197,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_concrete} @b{st_concrete}
+ at item @image{images/st_concrete, @oisize{}} @b{st_concrete}
 @end table
 @end table
 
@@ -14166,7 +14211,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_darkgray} @b{st_darkgray}
+ at item @image{images/st_darkgray, @oisize{}} @b{st_darkgray}
 @item @b{st_darkgray_hollow}
 @end table
 @end table
@@ -14181,7 +14226,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_granite} @b{st_granite}
+ at item @image{images/st_granite, @oisize{}} @b{st_granite}
 @item @b{st_granite_hollow}
 @item @b{st_granite_movable}
 @end table
@@ -14197,7 +14242,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_greengray} @b{st_greengray}
+ at item @image{images/st_greengray, @oisize{}} @b{st_greengray}
 @end table
 @end table
 
@@ -14233,7 +14278,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_metal} @b{st_metal}
+ at item @image{images/st_metal, @oisize{}} @b{st_metal}
 @item @b{st_metal_hollow}
 @end table
 @end table
@@ -14248,7 +14293,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_pinkbumps} @b{st_pinkbumps}
+ at item @image{images/st_pinkbumps, @oisize{}} @b{st_pinkbumps}
 @end table
 @end table
 
@@ -14262,7 +14307,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_purplegray} @b{st_purplegray}
+ at item @image{images/st_purplegray, @oisize{}} @b{st_purplegray}
 @end table
 @end table
 
@@ -14276,7 +14321,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_purplemarble} @b{st_purplemarble}
+ at item @image{images/st_purplemarble, @oisize{}} @b{st_purplemarble}
 @end table
 @end table
 
@@ -14290,7 +14335,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_redbrown} @b{st_redbrown}
+ at item @image{images/st_redbrown, @oisize{}} @b{st_redbrown}
 @item @b{st_redbrown_hollow}
 @item @b{st_redbrown_movable}
 @end table
@@ -14306,7 +14351,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_redmarble} @b{st_redmarble}
+ at item @image{images/st_redmarble, @oisize{}} @b{st_redmarble}
 @end table
 @end table
 
@@ -14320,7 +14365,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_redrock} @b{st_redrock}
+ at item @image{images/st_redrock, @oisize{}} @b{st_redrock}
 @end table
 @end table
 
@@ -14334,7 +14379,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_tigris} @b{st_tigris}
+ at item @image{images/st_tigris, @oisize{}} @b{st_tigris}
 @end table
 @end table
 
@@ -14348,7 +14393,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_woven} @b{st_woven}
+ at item @image{images/st_woven, @oisize{}} @b{st_woven}
 @end table
 @end table
 
@@ -14363,7 +14408,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_yellow} @b{st_yellow}
+ at item @image{images/st_yellow, @oisize{}} @b{st_yellow}
 @end table
 @end table
 
@@ -14663,8 +14708,8 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_actorimpulse}: invisible = @code{false}
- at item @b{st_actorimpulse_invisible}: invisible = @code{true}
+ at item @image{images/st_actorimpulse, @oisize{}} @b{st_actorimpulse}: invisible = @code{false}
+ at item @image{images/fl_white, @oisize{}} @b{st_actorimpulse_invisible}: invisible = @code{true}
 @end table
 
 @end table
@@ -14687,7 +14732,7 @@
 
 @item @b{Variants:} 
 @table @asis
- at item @image{images/st_beads} @b{st_beads}
+ at item @image{images/st_beads, @oisize{}} @b{st_beads}
 @end table
 
 @end table
@@ -14806,10 +14851,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_blur_straight} @b{st_blur}: flavor = @code{"straight"}
- at item @image{images/st_blur_straight} @b{st_blur_straight}: flavor = @code{"straight"}
- at item @image{images/st_blur_cross} @b{st_blur_cross}: flavor = @code{"cross"}
- at item @image{images/st_blur_cross} @b{st_blur_magic}: flavor = @code{"magic"}
+ at item @image{images/st_blur_straight, @oisize{}} @b{st_blur}: flavor = @code{"straight"}
+ at item @image{images/st_blur_straight, @oisize{}} @b{st_blur_straight}: flavor = @code{"straight"}
+ at item @image{images/st_blur_cross, @oisize{}} @b{st_blur_cross}: flavor = @code{"cross"}
+ at item @image{images/st_blur_cross, @oisize{}} @b{st_blur_magic}: flavor = @code{"magic"}
 @end table
 
 @end table
@@ -14913,7 +14958,7 @@
 over a ditch. Boxes will fall if the floor beneath them vanishes. E.g. an 
 @ref{it_bomb} explosion beneath a box may change the floor to @ref{fl_abyss} or
 a flood stream may change the floor to @ref{fl_water}. In all these cases the
-box above falls immediately buildings its kind of floor.
+box above falls immediately building its kind of floor.
 
 Note that all boxes do actively support @ref{Flood Spreading}. That means that
 they let an arriving flood stream flow beneath them. In case the floor beneath
@@ -14945,14 +14990,14 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_box}: flavor=@code{"wood"}
- at item @b{st_box_wood}: flavor=@code{"wood"}
- at item @b{st_box_wood_h}: flavor=@code{"wood"}
- at item @b{st_box_wood_v}: flavor=@code{"wood"}
- at item @b{st_box_wood_growing}: flavor=@code{"wood"}
- at item @b{st_box_hay}: flavor=@code{"hay"}
- at item @b{st_box_hay_growing}: flavor=@code{"hay"}
- at item @b{st_box_rock}: flavor=@code{"rock"}
+ at item @image{images/st_box_wood, @oisize{}} @b{st_box}: flavor=@code{"wood"}
+ at item @image{images/st_box_wood, @oisize{}} @b{st_box_wood}: flavor=@code{"wood"}
+ at item @image{images/st_box_wood, @oisize{}} @b{st_box_wood_h}: flavor=@code{"wood"}
+ at item @image{images/fl_white, @oisize{}} @b{st_box_wood_v}: flavor=@code{"wood"}
+ at item @image{images/fl_white, @oisize{}} @b{st_box_wood_growing}: flavor=@code{"wood"}
+ at item @image{images/st_box_hay, @oisize{}} @b{st_box_hay}: flavor=@code{"hay"}
+ at item @image{images/fl_white, @oisize{}} @b{st_box_hay_growing}: flavor=@code{"hay"}
+ at item @image{images/st_box_rock, @oisize{}} @b{st_box_rock}: flavor=@code{"rock"}
 @end table
 
 @end table
@@ -14991,7 +15036,7 @@
 
 @item @b{Variants:} none
 @table @asis
- at item @image{images/st_brake} @b{st_brake}
+ at item @image{images/st_brake, @oisize{}} @b{st_brake}
 @end table
 @end table
 
@@ -15000,7 +15045,7 @@
 @subsection st_break
 @obindex st_break
 
-A stone of various flavors that just breakable under various conditions. The
+A stone of various flavors that is breakable under various conditions. The
 stone may be breakable by actors of some kind, with or without an item, by an
 igniting explosion on a neighboring grid and in most cases by laser light.
 Besides being breakable the stone is a standard stone. The different flavors let
@@ -15009,7 +15054,7 @@
 The flavor @code{"plain"} is a grey stone that is breakable by any actor hit 
 with a revealed @ref{it_hammer} and by a laser beam hitting any side.
 
-The flavors @code{"black"} and @code{"white"} looks similar to the @code{"plain"}
+The flavors @code{"black"} and @code{"white"} look similar to the @code{"plain"}
 variant just with a small colored ball sitting on top. But these variants are
 just breakable by any actors of matching color. Of course the actors need a
 revealed @ref{it_hammer}. Laser beams do break the stone, too.
@@ -15024,7 +15069,7 @@
 
 The flavor @code{"bug"} looks like an @ref{st_flat} with a bug symbol on top.
 It is just breakable by an @ref{ac_bug}. No other actor and no laser light will 
-will break it.
+break it.
 
 The flavor @code{"laser"} looks identical to an @ref{st_flat}. It is not 
 breakable by actors. Just laser light beams on one of its faces will break this
@@ -15052,14 +15097,14 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_break_plain} @b{st_break}: flavor=@code{"plain"}
- at item @image{images/st_break_plain} @b{st_break_plain}: flavor=@code{"plain"}
- at item @image{images/st_break_black} @b{st_break_black}: flavor=@code{"black"}
- at item @image{images/st_break_white} @b{st_break_white}: flavor=@code{"white"}
- at item @image{images/st_break_oxydc} @b{st_break_oxydc}: flavor=@code{"oxydc"}
- at item @image{images/st_break_boulder} @b{st_break_boulder}: flavor=@code{"boulder"}
- at item @image{images/fl_white} @b{st_break_bug}: flavor=@code{"bug"}
- at item @image{images/fl_white} @b{st_break_laser}: flavor=@code{"laser"}
+ at item @image{images/st_break_plain, @oisize{}} @b{st_break}: flavor=@code{"plain"}
+ at item @image{images/st_break_plain, @oisize{}} @b{st_break_plain}: flavor=@code{"plain"}
+ at item @image{images/st_break_black, @oisize{}} @b{st_break_black}: flavor=@code{"black"}
+ at item @image{images/st_break_white, @oisize{}} @b{st_break_white}: flavor=@code{"white"}
+ at item @image{images/st_break_oxydc, @oisize{}} @b{st_break_oxydc}: flavor=@code{"oxydc"}
+ at item @image{images/st_break_boulder, @oisize{}} @b{st_break_boulder}: flavor=@code{"boulder"}
+ at item @image{images/st_break_bug, @oisize{}} @b{st_break_bug}: flavor=@code{"bug"}
+ at item @image{images/st_flat, @oisize{}} @b{st_break_laser}: flavor=@code{"laser"}
 @end table
 
 @end table
@@ -15076,7 +15121,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_brownpyramide} @b{st_brownpyramide}
+ at item @image{images/st_brownpyramide, @oisize{}} @b{st_brownpyramide}
 @end table
 @end table
 
@@ -15091,14 +15136,14 @@
 @ref{it_trigger} and lets pass any actors and laser light, too.
 
 Please make rare usage of this stone in Enigma 1.1* as the current display 
-engine does not really support this stone. All dynamic floor and floor changes
+engine does not really support this stone. All dynamic floors and floor changes
 do cause faulty displays. Thus use it currently only in patterns without any
 floor dynamics.
 
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @b{st_chameleon}
+ at item @image{images/fl_white, @oisize{}} @b{st_chameleon}
 @end table
 @end table
 
@@ -15111,7 +15156,7 @@
 @samp{charge} attribute.
 
 Any actor hitting this stone will recharge its @ref{charge} attribute to the
-value given by the stones @samp{charge} attribute. 
+value given by the stone's @samp{charge} attribute. 
 
 The stone itself does not cause any electrical forces. It is neither attracting
 nor repelling for charged actors. Electrical forces applied to actors just
@@ -15133,10 +15178,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_charge}: charge = @code{0.0}
- at item @b{st_charge_zero}: charge = @code{0.0}
- at item @b{st_charge_plus}: charge = @code{+1.0}
- at item @b{st_charge_minus}: charge = @code{-1.0}
+ at item @image{images/st_charge_zero, @oisize{}} @b{st_charge}: charge = @code{0.0}
+ at item @image{images/st_charge_zero, @oisize{}} @b{st_charge_zero}: charge = @code{0.0}
+ at item @image{images/st_charge_plus, @oisize{}} @b{st_charge_plus}: charge = @code{+1.0}
+ at item @image{images/st_charge_minus, @oisize{}} @b{st_charge_minus}: charge = @code{-1.0}
 @end table
 
 @end table
@@ -15197,9 +15242,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_chess}: color = @code{BLACK}
- at item @b{st_chess_black}: color = @code{BLACK}
- at item @b{st_chess_white}: color = @code{WHITE}
+ at item @image{images/st_chess_black, @oisize{}} @b{st_chess}: color = @code{BLACK}
+ at item @image{images/st_chess_black, @oisize{}} @b{st_chess_black}: color = @code{BLACK}
+ at item @image{images/st_chess_white, @oisize{}} @b{st_chess_white}: color = @code{WHITE}
 @end table
 
 @end table
@@ -15294,9 +15339,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_darkglass} @b{st_darkglass}: hollow = @code{false}, movable = @code{false}
- at item @image{images/st_darkglass} @b{st_darkglass_hollow}: hollow = @code{true}, movable = @code{false}
- at item @image{images/st_darkglass} @b{st_darkglass_movable}: hollow = @code{false}, movable = @code{true}
+ at item @image{images/st_darkglass, @oisize{}} @b{st_darkglass}: hollow = @code{false}, movable = @code{false}
+ at item @image{images/st_darkglass, @oisize{}} @b{st_darkglass_hollow}: hollow = @code{true}, movable = @code{false}
+ at item @image{images/st_darkglass, @oisize{}} @b{st_darkglass_movable}: hollow = @code{false}, movable = @code{true}
 @end table
 
 @end table
@@ -15366,9 +15411,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_death} @b{st_death}: invisible = @code{false}
- at item @image{images/fl_white} @b{st_death_invisible}: invisible = @code{true}
- at item @image{images/st_death_light} @b{st_death_movable}: movable = @code{true}
+ at item @image{images/st_death, @oisize{}} @b{st_death}: invisible = @code{false}
+ at item @image{images/fl_white, @oisize{}} @b{st_death_invisible}: invisible = @code{true}
+ at item @image{images/st_death_light, @oisize{}} @b{st_death_movable}: movable = @code{true}
 @end table
 
 @end table
@@ -15438,7 +15483,7 @@
 @samp{flavor}, namely @ref{it_bomb} in color black or white, or @ref{it_dynamite},
 to the inventory of the actor's owner. Of course an item will just be added
 if the inventory is capable of adding a further item. Additionally the 
-dispensers @samp{stock} must supply a further item. The default stock of 1000
+dispenser's @samp{stock} must supply a further item. The default stock of 1000
 items should be enough for usual demands. But you can limit the supply to just
 a few counted items. This @samp{stock} attribute gets decremented every time
 an actor takes an item.
@@ -15465,10 +15510,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_dispenser_bombblack} @b{st_dispenser}: flavor=@code{"bombblack"}
- at item @image{images/st_dispenser_bombblack} @b{st_dispenser_bombblack}: flavor=@code{"bombblack"}
- at item @image{images/st_dispenser_bombwhite} @b{st_dispenser_bombwhite}: flavor=@code{"bombwhite"}
- at item @image{images/st_dispenser_dynamite} @b{st_dispenser_dynamite}: flavor=@code{"dynamite"}
+ at item @image{images/st_dispenser_bombblack, @oisize{}} @b{st_dispenser}: flavor=@code{"bombblack"}
+ at item @image{images/st_dispenser_bombblack, @oisize{}} @b{st_dispenser_bombblack}: flavor=@code{"bombblack"}
+ at item @image{images/st_dispenser_bombwhite, @oisize{}} @b{st_dispenser_bombwhite}: flavor=@code{"bombwhite"}
+ at item @image{images/st_dispenser_dynamite, @oisize{}} @b{st_dispenser_dynamite}: flavor=@code{"dynamite"}
 @end table
 
 @end table
@@ -15589,13 +15634,13 @@
 stone may even mimic state dependent behaviour with state dependent models
 and animations.
 
-The flavor @code{"quake"} mimics a @ref{st_quake} inclusive the pulsing 
+The flavor @code{"quake"} mimics a @ref{st_quake} including the pulsing 
 animation on actor hits and state changes, but does not cause any @ref{st_oxyd}
 to close.
 
 The flavors @code{"oxyda"}, @code{"oxydb"}, @code{"oxydc"}, @code{"oxydd"},
 @code{"oxyde"} mimic @ref{st_oxyd} of appropriate flavor, but they are just
-passive stones. Nevertheless they are aware of an state @samp{OPEN} and will
+passive stones. Nevertheless they are aware of a state @samp{OPEN} and will
 display the corresponding base image of the open oxyd stone, of course without
 any color spot.
 
@@ -15658,7 +15703,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_flash} @b{st_flash}:
+ at item @image{images/st_flash, @oisize{}} @b{st_flash}:
 @end table
 @end table
 
@@ -15680,7 +15725,9 @@
 distinguishable by small cracks. But further laser light will not break a
 cracked variant. Ignitions and explosions will shatter breakable, cracked and
 movable variants. An actor with a revealed @ref{it_hammer} is able to shatter
-both the breakable and the cracked variant.
+both the breakable and the cracked variant. Note that the visually 
+indistinguishable @ref{st_break}_laser breaks on a laser hit, too, but without
+being breakable by actors.
 
 An actor with a revealed @ref{it_pencil} will mark a plain or movable variant
 as burnable what is hinted for the player by a fire symbol on the flat stone
@@ -15711,14 +15758,14 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_flat} @b{st_flat}:
- at item @image{images/st_flat} @b{st_flat_hollow}: hollow=@code{true}
- at item @image{images/st_flat} @b{st_flat_movable}: movable=@code{"true"}
- at item @b{st_flat_breakable}: breakable=@code{"true"}
- at item @b{st_flat_cracked}: 
- at item @b{st_flat_burnable}: burnable=@code{"true"}
- at item @b{st_flat_moveburnable}: movable=@code{"true"}, burnable=@code{"true"}
- at item @b{st_flat_breaking}: breakable=@code{"true"}
+ at item @image{images/st_flat, @oisize{}} @b{st_flat}:
+ at item @image{images/st_flat, @oisize{}} @b{st_flat_hollow}: hollow=@code{true}
+ at item @image{images/st_flat, @oisize{}} @b{st_flat_movable}: movable=@code{"true"}
+ at item @image{images/st_flat, @oisize{}} @b{st_flat_breakable}: breakable=@code{"true"}
+ at item @image{images/st_flat_cracked, @oisize{}} @b{st_flat_cracked}: 
+ at item @image{images/st_flat_fire, @oisize{}} @b{st_flat_burnable}: burnable=@code{"true"}
+ at item @image{images/st_flat_fire, @oisize{}} @b{st_flat_moveburnable}: movable=@code{"true"}, burnable=@code{"true"}
+ at item @image{images/fl_white, @oisize{}} @b{st_flat_breaking}: breakable=@code{"true"}
 @end table
 @end table
 
@@ -15810,7 +15857,12 @@
 a value of 0, then for the state representing the new orientation the given
 action messages will be sent with a value of 1. This allows you to switch on
 and off alternative sources by a fourswitch.
+
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_fourswitch, @oisize{}} @b{st_fourswitch}
 @end table
+ at end table
 
 @c ----------------- Ghost Stone --------------------
 @node st_ghost
@@ -15893,11 +15945,10 @@
 @item @b{Action:} none
 
 @item @b{Variants:}
-
 @table @asis
- at item @image{images/st_grate_cross} @b{st_grate}: flavor=@code{"cross"}
- at item @image{images/st_grate_cross} @b{st_grate_cross}: flavor=@code{"cross"}
- at item @image{images/st_grate_framed} @b{st_grate_framed}: flavor=@code{"framed"}
+ at item @image{images/st_grate_cross, @oisize{}} @b{st_grate}: flavor=@code{"cross"}
+ at item @image{images/st_grate_cross, @oisize{}} @b{st_grate_cross}: flavor=@code{"cross"}
+ at item @image{images/st_grate_framed, @oisize{}} @b{st_grate_framed}: flavor=@code{"framed"}
 @end table
 
 @end table
@@ -15912,7 +15963,7 @@
 
 On one hand an @ref{it_seed} of flavor @code{"fake"} will grow to a standard,
 unmovable greenbrown. Just for level initialization purpose you can even set
-an variant @samp{st_greenbrown_growing} due to the @ref{Snapshot Principle}.
+a variant @samp{st_greenbrown_growing} due to the @ref{Snapshot Principle}.
 
 On the other hand a @ref{st_ghost} of flavor @code{"greenbrown"} will transform
 to standard, unmovable greenbrown on an actor hit with a revealed 
@@ -15921,10 +15972,10 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_greenbrown} @b{st_greenbrown}
- at item @image{images/st_greenbrown} @b{st_greenbrown_hollow}
- at item @image{images/st_greenbrown} @b{st_greenbrown_movable}
- at item @image{images/fl_white} @b{st_greenbrown_growing}
+ at item @image{images/st_greenbrown, @oisize{}} @b{st_greenbrown}
+ at item @image{images/st_greenbrown, @oisize{}} @b{st_greenbrown_hollow}
+ at item @image{images/st_greenbrown, @oisize{}} @b{st_greenbrown_movable}
+ at item @image{images/fl_white, @oisize{}} @b{st_greenbrown_growing}
 @end table
 @end table
 
@@ -15938,9 +15989,9 @@
 being pushed over it. But a block of ice can be destroyed by explosions and by
 heating fire leaving either @ref{fl_ice} or @ref{fl_water}.
 
-When an ice block without frozen item is pushed onto a grid with an 
+When an ice block without frozen item is pushed onto a grid with a 
 @ref{freezable} item, the ice will freeze the item and will move it beneath
-itself on subsequent pushes. All items that the user can cary in his inventory
+itself on subsequent pushes. All items that the user can carry in his inventory
 are @ref{freezable} and even some @ref{Static Items} like @ref{it_magnet}, 
 @ref{it_springboard}, etc. But a few items react in a special manner when an
 ice block is pushed onto them:
@@ -15955,7 +16006,7 @@
 by an ice block and becomes frozen in its idle state.
 @end itemize
 
-But what happens when an ice block with a frozen items gets pushed onto a grid
+But what happens when an ice block with a frozen item gets pushed onto a grid
 with another item? The stronger item wins and survives beneath the ice block
 on the new position while the weaker item will be killed. The sequence from
 weak to strong is quite simple:
@@ -16004,7 +16055,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_ice} @b{st_ice}
+ at item @image{images/st_ice, @oisize{}} @b{st_ice}
 @end table
 @end table
 
@@ -16022,7 +16073,7 @@
 configured to send the message @code{"hit"} to the adjacent jambs as their
 targets. Whenever an actor knocks the door, the jamb receives the message and
 checks the actor for matching color. On success it sends opening signals to
-the door being knocked and to a door being located on the opposite site of the
+the door being knocked and to a door being located on the opposite side of the
 jamb. Additionally doors located on the remaining two adjacent positions of the
 jamb will receive a closing signal. E.g.:
 
@@ -16071,9 +16122,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_jamb_black} @b{st_jamb}: color=@code{BLACK}
- at item @image{images/st_jamb_black} @b{st_jamb_black}: color=@code{BLACK}
- at item @image{images/st_jamb_white} @b{st_jamb_white}: color=@code{WHITE}
+ at item @image{images/st_jamb_black, @oisize{}} @b{st_jamb}: color=@code{BLACK}
+ at item @image{images/st_jamb_black, @oisize{}} @b{st_jamb_black}: color=@code{BLACK}
+ at item @image{images/st_jamb_white, @oisize{}} @b{st_jamb_white}: color=@code{WHITE}
 @end table
 
 @end table
@@ -16140,8 +16191,13 @@
 
 @item @b{Action:} none
 
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_knight, @oisize{}} @b{st_knight}
 @end table
 
+ at end table
+
 @c ----------------- Laser Stone --------------------
 @node st_laser
 @subsection st_laser
@@ -16311,9 +16367,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_lightglass} @b{st_lightglass}: hollow = @code{false}, movable = @code{false}
- at item @image{images/st_lightglass} @b{st_lightglass_hollow}: hollow = @code{true}, movable = @code{false}
- at item @image{images/st_lightglass} @b{st_lightglass_movable}: hollow = @code{false}, movable = @code{true}
+ at item @image{images/st_lightglass, @oisize{}} @b{st_lightglass}: hollow = @code{false}, movable = @code{false}
+ at item @image{images/st_lightglass, @oisize{}} @b{st_lightglass_hollow}: hollow = @code{true}, movable = @code{false}
+ at item @image{images/st_lightglass, @oisize{}} @b{st_lightglass_movable}: hollow = @code{false}, movable = @code{true}
 @end table
 
 @end table
@@ -16401,9 +16457,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_lightpassenger}: state = @code{ON}
- at item @b{st_lightpassenger_on}: state = @code{ON}
- at item @b{st_lightpassenger_off}: state = @code{OFF}
+ at item @image{images/st_lightpassenger, @oisize{}} @b{st_lightpassenger}: state = @code{ON}
+ at item @image{images/st_lightpassenger, @oisize{}} @b{st_lightpassenger_on}: state = @code{ON}
+ at item @image{images/st_darkglass, @oisize{}} @b{st_lightpassenger_off}: state = @code{OFF}
 @end table
 
 @end table
@@ -16814,12 +16870,12 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_oxydb} @b{st_oxyd}: flavor = @code{"b"}
- at item @image{images/st_oxyda} @b{st_oxyd_a}: flavor = @code{"a"}
- at item @image{images/st_oxydb} @b{st_oxyd_b}: flavor = @code{"b"}
- at item @image{images/st_oxydc} @b{st_oxyd_c}: flavor = @code{"c"}
- at item @image{images/st_oxydd} @b{st_oxyd_d}: flavor = @code{"d"}
- at item @image{images/st_oxyde} @b{st_oxyd_e}: flavor = @code{"e"}
+ at item @image{images/st_oxydb, @oisize{}} @b{st_oxyd}: flavor = @code{"b"}
+ at item @image{images/st_oxyda, @oisize{}} @b{st_oxyd_a}: flavor = @code{"a"}
+ at item @image{images/st_oxydb, @oisize{}} @b{st_oxyd_b}: flavor = @code{"b"}
+ at item @image{images/st_oxydc, @oisize{}} @b{st_oxyd_c}: flavor = @code{"c"}
+ at item @image{images/st_oxydd, @oisize{}} @b{st_oxyd_d}: flavor = @code{"d"}
+ at item @image{images/st_oxyde, @oisize{}} @b{st_oxyd_e}: flavor = @code{"e"}
 @end table
 
 @end table
@@ -16866,9 +16922,15 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_passage}: color = @code{BLACK}
- at item @b{st_passage_black}: color = @code{BLACK}
- at item @b{st_passage_black}: color = @code{WHITE}
+ at item @image{images/st_passage_black_square, @oisize{}} @b{st_passage}: color = @code{BLACK}, flavor = @code{"square"}
+ at item @image{images/st_passage_black_square, @oisize{}} @b{st_passage_black}: color = @code{BLACK}, flavor = @code{"square"}
+ at item @image{images/st_passage_black_slash, @oisize{}} @b{st_passage_black}: color = @code{BLACK}, flavor = @code{"slash"}
+ at item @image{images/st_passage_black_cross, @oisize{}} @b{st_passage_black}: color = @code{BLACK} - flavor = @code{"cross"}
+ at item @image{images/st_passage_black_frame, @oisize{}} @b{st_passage_black}: color = @code{BLACK} - flavor = @code{"frame"}
+ at item @image{images/st_passage_white_square, @oisize{}} @b{st_passage_white}: color = @code{WHITE}, flavor = @code{"square"}
+ at item @image{images/st_passage_white_slash, @oisize{}} @b{st_passage_white}: color = @code{WHITE} - flavor = @code{"slash"}
+ at item @image{images/st_passage_white_cross, @oisize{}} @b{st_passage_white}: color = @code{WHITE} - flavor = @code{"cross"}
+ at item @image{images/st_passage_white_frame, @oisize{}} @b{st_passage_white}: color = @code{WHITE} - flavor = @code{"frame"}
 @end table
 
 @end table
@@ -16908,11 +16970,11 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_plaster} @b{st_plaster}:
- at item @image{images/st_plaster} @b{st_plaster_hollow}: hollow=@code{true}
- at item @image{images/st_plaster} @b{st_plaster_movable}: movable=@code{"true"}
- at item @image{images/st_plaster} @b{st_plaster_breakable}: breakable=@code{"true"}
- at item @image{images/st_plaster} @b{st_plaster_movebreakable}: movable=@code{"true"}, breakable=@code{"true"}
+ at item @image{images/st_plaster, @oisize{}} @b{st_plaster}:
+ at item @image{images/st_plaster, @oisize{}} @b{st_plaster_hollow}: hollow=@code{true}
+ at item @image{images/st_plaster, @oisize{}} @b{st_plaster_movable}: movable=@code{"true"}
+ at item @image{images/st_plaster, @oisize{}} @b{st_plaster_breakable}: breakable=@code{"true"}
+ at item @image{images/st_plaster, @oisize{}} @b{st_plaster_movebreakable}: movable=@code{"true"}, breakable=@code{"true"}
 @end table
 
 @end table
@@ -16935,8 +16997,8 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_plop_slate} @b{st_plop}
- at item @image{images/st_plop_slate} @b{st_plop_slate}
+ at item @image{images/st_plop_slate, @oisize{}} @b{st_plop}
+ at item @image{images/st_plop_slate, @oisize{}} @b{st_plop_slate}
 @end table
 @end table
 
@@ -17008,9 +17070,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_portal_horse} @b{st_portal}: flavor=@code{"horse"}
- at item @image{images/st_portal_horse} @b{st_portal_horse}: flavor=@code{"horse"}
- at item @image{images/st_portal_horse} @b{st_portal_pearl}: flavor=@code{"pearl"}
+ at item @image{images/st_portal_horse, @oisize{}} @b{st_portal}: flavor=@code{"horse"}
+ at item @image{images/st_portal_horse, @oisize{}} @b{st_portal_horse}: flavor=@code{"horse"}
+ at item @image{images/st_portal_horse, @oisize{}} @b{st_portal_pearl}: flavor=@code{"pearl"}
 @end table
 
 @end table
@@ -17090,20 +17152,21 @@
 complete clusters by an actor pushing or a stone impulse by @ref{ot_wire} or
 @ref{st_stoneimpulse}. Of course all new positions of the moving puzzle must be
 free of other stones. If all new positions are @ref{fl_water} the blue puzzle
-will sink and leave @ref{fl_gray} thus building a bridge over water. If all new
-positions are @ref{fl_abyss} just complete blue clusters will sink and build
-a bridge. If all new positions are either abyss or water with at least one
-abyss floor just complete blue clusters will sink. Note that puzzles just sink
-on moves. Moving a blue fragment besides another fragment on abyss so that both
-fragments build a complete cluster will not sink the new cluster. It will sink
-as a whole on the next move. If two or more stones of a cluster are receive
-wire impulses originating from a single event, the whole cluster will move
-multiple times. But it will sink on the first opportunity.
+will sink and leave @ref{fl_gray} thus building a bridge over water. The user
+can prohibit the sinking of the puzzle into water by pushing with a revealed
+ at ref{it_magicwand}. If all new positions are @ref{fl_abyss} just complete blue
+clusters will sink and build a bridge. If all new positions are either abyss or
+water with at least one abyss floor just complete blue clusters will sink. Note
+that puzzles just sink on moves. Moving a blue fragment besides another fragment
+on abyss so that both fragments build a complete cluster will not sink the new
+cluster. It will sink as a whole on the next move. If two or more stones of a 
+cluster receive wire impulses originating from a single event, the whole cluster
+will move multiple times. But it will sink on the first opportunity.
 
-Just single unconnected yellow puzzle stones can be moved by actors. Any yellow
-cluster of 2 or more stones can not moved by actor hits. But on stone impulses
-they move like blue puzzles with the exception that just complete yellow clusters
-will sink on water.
+Just single unconnected yellow puzzle stones can be moved by actors. They will
+neither sink in @ref{fl_water} nor fall in @ref{fl_abyss}. Any yellow cluster of
+two or more stones can not be moved by actor hits. But on receiving stone
+impulses they move like blue puzzles.
 
 All puzzle stone moves do not cause standard item transformations, like
 @ref{it_coin} value changes, @ref{it_bomb} explosions, etc. But they all are not
@@ -17120,7 +17183,7 @@
 @ref{ot_cannonball} emitted by an @ref{st_spitter} happens to fall on top of
 one of the puzzle stones of the cluster.
 
-Exploding puzzles will stay on place and do not interact any more. The exploding
+Exploding puzzles will stay in place and do not interact any more. The exploding
 stones are lethal for actors hitting them, but an actor can start an explosion
 beneath a hollow puzzle stone and stay beneath this hollow exploding stone
 without harm until the puzzle dissolved.
@@ -17136,7 +17199,10 @@
 operations. Thus you need to touch a blue puzzle row carefully with a revealed
 wand if the row is part of a movable cluster fragment. If the speed is
 sufficient for a hit operation, the cluster will move instead of an expected
-row rotation.
+row rotation. An actor hit on a blue puzzle that did neither cause an explosion
+or a rotation will be propagated by an @ref{ot_wire} connected to this puzzle
+stone. Hits on yellow puzzle stones will never propagate to @ref{ot_wire}
+connected other stones.
 
 Like @ref{Cluster Stones} puzzles accept a @samp{cluster} attribute. A new set
 puzzle stone autoconnects to adjacent, same colored puzzle stones belonging to
@@ -17270,9 +17336,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_rawglass} @b{st_rawglass}: movable = @code{false}
- at item @image{images/st_rawglass_quad} @b{st_rawglass_quad}: movable = @code{false}
- at item @image{images/st_rawglass} @b{st_rawglass_movable}: movable = @code{true}
+ at item @image{images/st_rawglass, @oisize{}} @b{st_rawglass}: movable = @code{false}
+ at item @image{images/st_rawglass_quad, @oisize{}} @b{st_rawglass_quad}: movable = @code{false}
+ at item @image{images/st_rawglass, @oisize{}} @b{st_rawglass_movable}: movable = @code{true}
 @end table
 
 @end table
@@ -17294,7 +17360,7 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_redfiber} @b{st_redfiber}
+ at item @image{images/st_redfiber, @oisize{}} @b{st_redfiber}
 @end table
 
 @end table
@@ -17525,13 +17591,13 @@
 Actors will not be harmed by falling cannonballs.
 
 The spitting can be initiated by the message @code{"hit"}, too. No 
- at ref{it_extralife} is needed in this case. The hit messages takes either a
+ at ref{it_extralife} is needed in this case. The hit message takes either a
 destination as message value or in case no value is given it evaluates the
 @samp{destination} attribute. The second case is suitable for usage of 
 @samp{hit} as an action message.
 
 The destination can be any value that evaluates to a valid position, object
-references and object names included. In case of an @samp{destination}
+references and object names included. In case of a @samp{destination}
 attribute you can even supply tokens describing a series of destination
 positions. The destinations will be targeted by the cannonballs in turn on
 a sequence of @samp{hit} actions.
@@ -17546,7 +17612,7 @@
 still existing brown pyramid, the second one, as target. This one will be
 destroyed on the next spit as the spitter starts again on the first (remaining)
 destination when the end of list is reached. This may be no problem if you
-wand to destroy objects randomly or if you use named destinations with
+want to destroy objects randomly or if you use named destinations with
 wildcards. But if you need control about the sequence you need either 
 destinations targets that get not destroyed or floor object references, as
 they represent @ref{Named Positions} that are persistent to object destruction.
@@ -17578,7 +17644,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_spitter_idle} @b{st_spitter}: secure = @code{false}, state = @code{ACTIVE}
+ at item @image{images/st_spitter_idle, @oisize{}} @b{st_spitter}: secure = @code{false}, state = @code{ACTIVE}
 @end table
 
 @end table
@@ -17725,7 +17791,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_surprise} @b{st_surprise}
+ at item @image{images/st_surprise, @oisize{}} @b{st_surprise}
 @end table
 @end table
 
@@ -18290,10 +18356,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_yinyang} @b{st_yinyang}: state = @code{IDLE}
- at item @image{images/st_yinyang} @b{st_yinyang_active}: state = @code{ACTIVE}
- at item @image{images/st_yinyang_inactive} @b{st_yinyang_inactive}: state = @code{INACTIVE}
- at item @image{images/st_yinyang} @b{st_yinyang_instant}: instant = @code{true}, state = @code{IDLE}
+ at item @image{images/st_yinyang, @oisize{}} @b{st_yinyang}: state = @code{IDLE}
+ at item @image{images/st_yinyang, @oisize{}} @b{st_yinyang_active}: state = @code{ACTIVE}
+ at item @image{images/st_yinyang_inactive, @oisize{}} @b{st_yinyang_inactive}: state = @code{INACTIVE}
+ at item @image{images/st_yinyang, @oisize{}} @b{st_yinyang_instant}: instant = @code{true}, state = @code{IDLE}
 @end table
 @end table
 

Modified: trunk/doc/reference/images/Makefile.am
===================================================================
--- trunk/doc/reference/images/Makefile.am	2009-06-16 22:33:11 UTC (rev 1723)
+++ trunk/doc/reference/images/Makefile.am	2009-06-17 22:25:51 UTC (rev 1724)
@@ -127,14 +127,19 @@
 	it_wormhole.png \
 	it_wrench.png \
 	it_yinyang.png \
+	st_actorimpulse.png \
 	st_ancient.png \
 	st_beads.png \
 	st_bluegray.png \
 	st_blur_cross.png \
 	st_blur_straight.png \
+	st_box_hay.png \
+	st_box_rock.png \
+	st_box_wood.png \
 	st_brake.png \
 	st_break_black.png \
 	st_break_boulder.png \
+	st_break_bug.png \
 	st_break_oxydc.png \
 	st_break_plain.png \
 	st_break_white.png \
@@ -142,6 +147,11 @@
 	st_brownmarble.png \
 	st_brownpyramide.png \
 	st_camouflage.png \
+	st_charge_minus.png \
+	st_charge_plus.png \
+	st_charge_zero.png \
+	st_chess_black.png \
+	st_chess_white.png \
 	st_concrete.png \
 	st_darkglass.png \
 	st_darkgray.png \
@@ -152,6 +162,9 @@
 	st_dispenser_dynamite.png \
 	st_flash.png \
 	st_flat.png \
+	st_flat_cracked.png \
+	st_flat_fire.png \
+	st_fourswitch.png \
 	st_granite.png \
 	st_grate_cross.png \
 	st_grate_framed.png \
@@ -160,13 +173,23 @@
 	st_ice.png \
 	st_jamb_black.png \
 	st_jamb_white.png \
+	st_knight.png \
 	st_lightglass.png \
+	st_lightpassenger.png \
 	st_metal.png \
 	st_oxyda.png \
 	st_oxydb.png \
 	st_oxydc.png \
 	st_oxydd.png \
 	st_oxyde.png \
+	st_passage_black_cross.png \
+	st_passage_black_frame.png \
+	st_passage_black_slash.png \
+	st_passage_black_square.png \
+	st_passage_white_cross.png \
+	st_passage_white_frame.png \
+	st_passage_white_slash.png \
+	st_passage_white_square.png \
 	st_pinkbumps.png \
 	st_plaster.png \
 	st_plop_slate.png \



From andreasl at mail.berlios.de  Thu Jun 18 15:56:32 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Thu, 18 Jun 2009 15:56:32 +0200
Subject: [Enigma-game-svn] r1725 - team_levelpacks/team_test_new_api
Message-ID: <200906181356.n5IDuWdW021013@sheep.berlios.de>

Author: andreasl
Date: 2009-06-18 15:56:29 +0200 (Thu, 18 Jun 2009)
New Revision: 1725

Added:
   team_levelpacks/team_test_new_api/andreasT04_1.xml
   team_levelpacks/team_test_new_api/andreasT05_1.xml
Modified:
   team_levelpacks/team_test_new_api/andreasT02_1.xml
Log:
Test Level new API:
 - New test levels for libimport and map transformation compositions.
 - Test switch for lib.map.match in andreasT02.


Modified: team_levelpacks/team_test_new_api/andreasT02_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/andreasT02_1.xml	2009-06-17 22:25:51 UTC (rev 1724)
+++ team_levelpacks/team_test_new_api/andreasT02_1.xml	2009-06-18 13:56:29 UTC (rev 1725)
@@ -30,6 +30,7 @@
 ti["H "] = {"fl_bast"}
 ti["I "] = {"fl_abyss"}
 ti["J "] = {"fl_water"}
+ti["v "] = {"it_banana"}
 
 ti[" "] = {"fl_sahara"}
 ti["A"] = {"fl_lawn"}
@@ -41,6 +42,7 @@
 ti["G"] = {"fl_rough"}
 ti["H"] = {"fl_bast"}
 ti["R"] = {"fl_red"}
+ti["v"] = {"it_banana"}
 
 ti[" @"] = {"#ac_marble", "marble"}
 ti[" d"] = {"st_death", "death#"}
@@ -48,6 +50,7 @@
 ti[" S"] = {"st_switch", target = "call_switch1"}
 ti[" T"] = {"st_switch", target = "call_switch2"}
 ti[" U"] = {"st_switch", target = "call_switch3"}
+ti[" V"] = {"st_switch", target = "call_switch4"}
 
 ti["@"] = {"#ac_marble", "marble"}
 ti["d"] = {"st_death", "death#"}
@@ -65,7 +68,7 @@
 "   FFFF  GGGG  HHHH ",
 "                    ",
 "                    ",
-"                    ",
+"    v               ",
 "                    "})
 
 map2a = wo:newMap(" ", {
@@ -98,6 +101,7 @@
 map3[{0,0}] = "BS"
 map3[{0, map3.height-1}] = "BT"
 map3[{map3.width-1, 0}] = "BU"
+map3:replace("v ", " V")
 
 with_bars = map3 * "|"
 with_bars:print(true, "|")
@@ -133,6 +137,29 @@
   map1:replace("G", "A")
   wo:drawMap(res.composer(ti), {0,0}, map1)
 end
+
+switch4_counter = 0
+function call_switch4()
+  switch4_counter = switch4_counter + 1
+      if switch4_counter == 1 then
+    wo[map1:match("C")] = {"it_cherry"}
+  elseif switch4_counter == 2 then
+    wo[map1:match({NEIGHBORS_4, " ", "G", "B"})] = {"it_banana"}
+  elseif switch4_counter == 3 then
+    wo[map1:match({po(0,1), "G"}, {po(0,-1), "B"})] = {"it_extralife"}
+  elseif switch4_counter == 4 then
+    wo[map1:match({po(0,1), "G"})] = {"it_sword"}
+  elseif switch4_counter == 5 then
+    wo[map1:match({po(0,1), "G"})] = {"it_hammer"}
+  elseif switch4_counter == 6 then
+    wo[map1:match({po(0,1), "G"}, {NEIGHBORS_4, " ", "G"})] = {"it_sword"}
+  elseif switch4_counter == 7 then
+    wo[map1:match({{po(0,1), "G"}, {NEIGHBORS_4, " ", "G"}})] = {"it_hammer"}
+  elseif switch4_counter == 8 then
+    wo[map1:match()] = {"it_nil"}
+    switch4_counter = 0
+  end
+end
   
   ]]></el:luamain>
     <el:i18n>

Added: team_levelpacks/team_test_new_api/andreasT04_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/andreasT04_1.xml	2009-06-17 22:25:51 UTC (rev 1724)
+++ team_levelpacks/team_test_new_api/andreasT04_1.xml	2009-06-18 13:56:29 UTC (rev 1725)
@@ -0,0 +1,211 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Test libimport" el:subtitle="" el:id="test_libimport"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="experimental"/>
+      <el:author  el:name="Andreas Lochmann" el:email=""/>
+      <el:copyright>Copyright ? 2009 Andreas Lochmann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+        <el:dependency el:path="lib/libimport" el:id="lib/libimport" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+
+wo["ConserveLevel"] = true
+
+--    - _ space  space
+--    #          wall
+--    .          goal
+--    $ *        box, box with goal
+--    n N        st_chess, st_chess with goal
+--    @ +        player, player with goal
+
+ti["-"] = {"fl_sahara"}
+ti[" "] = {"fl_space"}
+ti["#"] = {"st_granite"}
+ti["."] = {"it_trigger"}
+ti["$"] = {"st_box"}
+ti["n"] = {"st_chess"}
+ti["@"] = {"#ac_marble"}
+ti["*"] = ti["$"] .. ti["."]
+ti["N"] = ti["n"] .. ti["."]
+ti["+"] = ti["@"] .. ti["."]
+
+multilevel =
+  "> 1\n"
+.."###################\n"
+.."###################\n"
+.."###          ######\n"
+.."## $######## ######\n"
+.."##  $     #......##\n"
+.."##  $@$ # $.*.#..##\n"
+.."### ###$$ #......##\n"
+.."######    #......##\n"
+.."######$ ###.#######\n"
+.."###     $      ####\n"
+.."#### $ ####$ # ####\n"
+.."###  $$ # $  $ ####\n"
+.."### $$  # $#$  ####\n"
+.."###  $$ #  $ $ ####\n"
+.."####    ##     ####\n"
+.."###################\n"
+.."###################\n"
+.."> 2\n"
+.."###################\n"
+.."###################\n"
+.."##   #     ########\n"
+.."##     $ $ ###  ..#\n"
+.."###  ## # #### ...#\n"
+.."#### ## $  ###$ #.#\n"
+.."##    #$$$ ### ...#\n"
+.."## $$ #    ###$ #.#\n"
+.."##  $  ##  ##  ...#\n"
+.."##   $ ##   $  $#.#\n"
+.."### $######### ...#\n"
+.."###     $ $ ##$$#.#\n"
+.."###  $$ #   ## ...#\n"
+.."#####  ##$$@##$ #.#\n"
+.."#####      ###  ..#\n"
+.."###################\n"
+.."###################\n"
+.."> 3\n"
+.."###################\n"
+.."###################\n"
+.."#    ##...$...#   #\n"
+.."# $$ ##$# ##..$ $ #\n"
+.."###  #......... $ #\n"
+.."#   ##....@####$  #\n"
+.."# $$ ##...#####   #\n"
+.."# #  ###.#######$ #\n"
+.."# $ $     #       #\n"
+.."#   #  $$ # $$ $$ #\n"
+.."# ### ##  #  # # ##\n"
+.."#   #  ## #    $ ##\n"
+.."##     ##### # # ##\n"
+.."####$$ ##### $$$  #\n"
+.."####   #####      #\n"
+.."###################\n"
+.."###################\n"
+.."> 4\n"
+.."###################\n"
+.."#  *....#       ###\n"
+.."# $**....*  $ #@###\n"
+.."# #.#...## #$$# ###\n"
+.."# $.**##   #    ###\n"
+.."# #.#.## $$# ######\n"
+.."#  ....###   ######\n"
+.."# $ # $# # $#######\n"
+.."# # #    #  #######\n"
+.."#    $ $ ##########\n"
+.."# $##$# ## ########\n"
+.."#   # # #  ########\n"
+.."# $      $ ########\n"
+.."# ## ## #$ ########\n"
+.."# $  ##$   ########\n"
+.."#         #########\n"
+.."###################\n"
+.."> 5\n"
+.."###################\n"
+.."###################\n"
+.."###################\n"
+.."###################\n"
+.."###################\n"
+.."#####   ###   #####\n"
+.."#####  $  $ # #####\n"
+.."###### ##   $ #####\n"
+.."###### #  # .######\n"
+.."##### $#  ##.######\n"
+.."#####  @$ *..######\n"
+.."##### #$ *.*.######\n"
+.."#####   ###########\n"
+.."###################\n"
+.."###################\n"
+.."###################\n"
+.."###################\n"
+.."> 6\n"
+.."#################\n"
+.."#  *....#       #\n"
+.."# $**....*  $ #@#\n"
+.."# #.#...## #$$# #\n"
+.."# $.**##   #    ##\n"
+.."# #.#.## $$# ##  #\n"
+.."# .....###     $ #\n"
+.."# $ #.*# # $#$$ $##\n"
+.."# #.#... #      $ #\n"
+.."# ...$ $ ###$$$   #\n"
+.."# $## # ## #   $ ##\n"
+.."#   # # #  # #$  #\n"
+.."# $      $ #    ##\n"
+.."# ##$## #$ ######\n"
+.."# $  ##$   #\n"
+.."#         ##\n"
+.."###########\n"
+.."> 7\n"
+.." ########\n"
+.." #  #   #\n"
+.."##  .$  #\n"
+.."# $#.#$##\n"
+.."#@ . . #\n"
+.."# $$.###\n"
+.."## # #\n"
+.." #   #\n"
+.." #####\n"
+.."> 8\n"
+.." #######\n"
+.." #   * #\n"
+.." #$# # ##\n"
+.."## . $. #\n"
+.."# @#..  #\n"
+.."# $$  ###\n"
+.."##   ##\n"
+.." #####\n"
+.."> 9\n"
+.."  #####\n"
+.."  #   #\n"
+.."  #   #\n"
+.." ## # #\n"
+.."##   @##\n"
+.."#  $#  #\n"
+.."# #.   #\n"
+.."#    # #\n"
+.."#  #   #\n"
+.."##   ###\n"
+.." #####\n"
+.."#10: Chess 1\n"
+.."########\n"
+.."#  NN@ #\n"
+.."#  ##  #\n"
+.."##    ##\n"
+.."#  ##  #\n"
+.."# #  # #\n"
+.."#      #\n"
+.."########\n"
+.."\n\n"
+.."#11: Chess 2\n"
+.."#######\n"
+.."#     #\n"
+.."#  #  #\n"
+.."##n#n##\n"
+.."#  @  #\n"
+.."#.   .#\n"
+.."#######\n"
+.."#12: Chess 2 compressed\n"
+.."#|7#|#5 1#3|#  #  #|2#n#1n2#|#2 @  1#|#.3 .#|9#|#"
+
+wo(ti, "-", lib.import.map_sokoban(multilevel, 12))
+  
+  ]]></el:luamain>
+    <el:i18n>
+     <el:string el:key="title">
+       <el:english el:translate="false"/>
+     </el:string>
+   </el:i18n>
+  </el:protected>
+</el:level>
+

Added: team_levelpacks/team_test_new_api/andreasT05_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/andreasT05_1.xml	2009-06-17 22:25:51 UTC (rev 1724)
+++ team_levelpacks/team_test_new_api/andreasT05_1.xml	2009-06-18 13:56:29 UTC (rev 1725)
@@ -0,0 +1,98 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="level">
+      <el:identity el:title="Test map transformations" el:subtitle="" el:id="test_maptransformations"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="experimental"/>
+      <el:author  el:name="Andreas Lochmann" el:email=""/>
+      <el:copyright>Copyright ? 2009 Andreas Lochmann</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.10">
+        <el:dependency el:path="lib/libmap" el:id="lib/libmap" el:release="1" el:preload="true"/>
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="true" el:network="false"/>
+      <el:comments>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+
+wo["ConserveLevel"] = true
+
+ti[" "] = {"fl_sahara"}
+ti["@"] = {"#ac_marble", "marble"}
+ti["B"] = {"st_brick", cluster = 1}
+ti["S"] = {"st_switch", target = "turn_trafo"}
+ti["R"] = {"st_switch", target = "random_trafo"}
+ti["T"] = {"st_switch", target = "cycle_trafos"}
+ti["-"] = {"st_nil"} .. ti{"fl_red"}
+ti["a"] = {"fl_sahara", "anchor1"}
+ti["b"] = {"fl_sahara", "anchor2"}
+ti["c"] = {"fl_sahara", "anchor3"}
+ti["d"] = {"fl_sahara", "anchor4"}
+ti["e"] = {"fl_sahara", "anchor5"}
+
+wo(ti, " ", {
+" S R T              ",
+"                    ",
+"  @     d     e     ",
+"                    ",
+"                    ",
+"                    ",
+"                    ",
+"  a     b     c     ",
+"                    ",
+"                    ",
+"                    ",
+"                    ",
+"                    "})
+
+empty = wo:newMap(" ", {"----", "----", "----", "----"})
+complex = wo:newMap(" ", {"    ", "BBBB", "B   ", "    "})
+current_complex = complex ^ MAP_IDENT
+total_transformations = MAP_IDENT
+cycle_state = 1
+
+function do_trafo(op)
+    wo:drawMap(ti, po["anchor1"], empty)
+    wo:drawMap(ti, po["anchor2"], empty)
+    wo:drawMap(ti, po["anchor3"], empty)
+    old_trafo = total_transformations
+    total_transformations = total_transformations ^ op
+    current_complex = current_complex ^ op
+    wo:drawMap(ti, po["anchor1"], current_complex)
+    wo:drawMap(ti, po["anchor2"], complex ^ total_transformations)
+    wo:drawMap(ti, po["anchor3"], complex, total_transformations)
+end
+
+function turn_trafo()
+    do_trafo(MAP_ROT_CW)
+end
+
+function random_trafo()
+    do_trafo(lib.map.random_transformation())
+end
+
+function cycle_trafos()
+    wo:drawMap(ti, po["anchor4"], empty)
+    wo:drawMap(ti, po["anchor4"], complex, MAP_ALL[cycle_state])
+    wo:drawMap(ti, po["anchor5"], empty)
+    wo:drawMap(ti, po["anchor5"], complex)
+    cycle_state = cond(cycle_state == MAP_COUNT, 1, cycle_state + 1)
+end
+
+function postinit()
+    -- Check associativity.
+    wo:drawMap(ti, po["anchor4"], (complex ^ MAP_ROT_CW) ^ MAP_FLIP_SLASH)
+    wo:drawMap(ti, po["anchor5"], complex ^ (MAP_ROT_CW ^ MAP_FLIP_SLASH))
+end
+
+  ]]></el:luamain>
+    <el:i18n>
+     <el:string el:key="title">
+       <el:english el:translate="false"/>
+     </el:string>
+   </el:i18n>
+  </el:protected>
+</el:level>
+



From ral at mail.berlios.de  Fri Jun 19 00:17:47 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Fri, 19 Jun 2009 00:17:47 +0200
Subject: [Enigma-game-svn] r1726 - in trunk: data data/gfx32 data/gfx40
	data/gfx48 data/schemas doc/reference src src/floors src/stones
Message-ID: <200906182217.n5IMHlLG013956@sheep.berlios.de>

Author: ral
Date: 2009-06-19 00:17:39 +0200 (Fri, 19 Jun 2009)
New Revision: 1726

Added:
   trunk/data/gfx32/fl_bridge_bn.png
   trunk/data/gfx32/fl_bridge_bw.png
   trunk/data/gfx32/fl_bridge_bw_closed.png
   trunk/data/gfx32/fl_bridge_bw_open.png
   trunk/data/gfx32/fl_bridge_gc.png
   trunk/data/gfx32/fl_bridge_gc_closed.png
   trunk/data/gfx32/fl_bridge_gc_open.png
   trunk/data/gfx32/st_blocker.png
   trunk/data/gfx32/st_boulder.png
   trunk/data/gfx32/st_boulder_fall.png
   trunk/data/gfx32/st_pull.png
   trunk/data/gfx32/st_rotator_ccw.png
   trunk/data/gfx32/st_rotator_cw.png
   trunk/data/gfx32/st_rubberband.png
   trunk/data/gfx32/st_scissors.png
   trunk/data/gfx32/st_scissors_snip.png
   trunk/data/gfx32/st_swap.png
   trunk/data/gfx32/st_switch.png
   trunk/data/gfx32/st_switch_black.png
   trunk/data/gfx32/st_switch_white.png
   trunk/data/gfx32/st_turnstile.png
   trunk/data/gfx32/st_turnstile_green.png
   trunk/data/gfx40/fl_bridge_bn.png
   trunk/data/gfx40/fl_bridge_bw.png
   trunk/data/gfx40/fl_bridge_bw_closed.png
   trunk/data/gfx40/fl_bridge_bw_open.png
   trunk/data/gfx40/fl_bridge_gc.png
   trunk/data/gfx40/fl_bridge_gc_closed.png
   trunk/data/gfx40/fl_bridge_gc_open.png
   trunk/data/gfx40/st_blocker.png
   trunk/data/gfx40/st_boulder.png
   trunk/data/gfx40/st_boulder_fall.png
   trunk/data/gfx40/st_pull.png
   trunk/data/gfx40/st_rotator_ccw.png
   trunk/data/gfx40/st_rotator_cw.png
   trunk/data/gfx40/st_rubberband.png
   trunk/data/gfx40/st_scissors.png
   trunk/data/gfx40/st_scissors_snip.png
   trunk/data/gfx40/st_swap.png
   trunk/data/gfx40/st_switch.png
   trunk/data/gfx40/st_switch_black.png
   trunk/data/gfx40/st_switch_white.png
   trunk/data/gfx40/st_turnstile.png
   trunk/data/gfx40/st_turnstile_green.png
   trunk/data/gfx48/fl_bridge_bn.png
   trunk/data/gfx48/fl_bridge_bw.png
   trunk/data/gfx48/fl_bridge_bw_closed.png
   trunk/data/gfx48/fl_bridge_bw_open.png
   trunk/data/gfx48/fl_bridge_gc.png
   trunk/data/gfx48/fl_bridge_gc_closed.png
   trunk/data/gfx48/fl_bridge_gc_open.png
   trunk/data/gfx48/st_blocker.png
   trunk/data/gfx48/st_boulder.png
   trunk/data/gfx48/st_boulder_fall.png
   trunk/data/gfx48/st_pull.png
   trunk/data/gfx48/st_rotator_ccw.png
   trunk/data/gfx48/st_rotator_cw.png
   trunk/data/gfx48/st_rubberband.png
   trunk/data/gfx48/st_scissors.png
   trunk/data/gfx48/st_scissors_snip.png
   trunk/data/gfx48/st_swap.png
   trunk/data/gfx48/st_switch.png
   trunk/data/gfx48/st_switch_black.png
   trunk/data/gfx48/st_switch_white.png
   trunk/data/gfx48/st_turnstile.png
   trunk/data/gfx48/st_turnstile_green.png
Removed:
   trunk/data/gfx32/fl-bridgea-closed.png
   trunk/data/gfx32/fl-bridgea-open.png
   trunk/data/gfx32/fl-bridgea.png
   trunk/data/gfx32/fl-bridgex-closed.png
   trunk/data/gfx32/fl-bridgex-open.png
   trunk/data/gfx32/fl-bridgex.png
   trunk/data/gfx32/fl-bridgey-closed.png
   trunk/data/gfx32/fl-bridgey-open.png
   trunk/data/gfx32/fl-bridgey.png
   trunk/data/gfx32/st-blocker.png
   trunk/data/gfx32/st-bolder-fall.png
   trunk/data/gfx32/st-bolder.png
   trunk/data/gfx32/st-pull.png
   trunk/data/gfx32/st-rotator-left.png
   trunk/data/gfx32/st-rotator-right.png
   trunk/data/gfx32/st-rubberband.png
   trunk/data/gfx32/st-scissors-snip.png
   trunk/data/gfx32/st-scissors.png
   trunk/data/gfx32/st-swap.png
   trunk/data/gfx32/st-switch.png
   trunk/data/gfx32/st-switch_black.png
   trunk/data/gfx32/st-switch_white.png
   trunk/data/gfx32/st-turnstile-green.png
   trunk/data/gfx32/st-turnstile.png
   trunk/data/gfx40/fl-bridgea-closed.png
   trunk/data/gfx40/fl-bridgea-open.png
   trunk/data/gfx40/fl-bridgea.png
   trunk/data/gfx40/fl-bridgex-closed.png
   trunk/data/gfx40/fl-bridgex-open.png
   trunk/data/gfx40/fl-bridgex.png
   trunk/data/gfx40/fl-bridgey-closed.png
   trunk/data/gfx40/fl-bridgey-open.png
   trunk/data/gfx40/fl-bridgey.png
   trunk/data/gfx40/st-blocker.png
   trunk/data/gfx40/st-bolder-fall.png
   trunk/data/gfx40/st-bolder.png
   trunk/data/gfx40/st-pull.png
   trunk/data/gfx40/st-rotator-left.png
   trunk/data/gfx40/st-rotator-right.png
   trunk/data/gfx40/st-rubberband.png
   trunk/data/gfx40/st-scissors-snip.png
   trunk/data/gfx40/st-scissors.png
   trunk/data/gfx40/st-swap.png
   trunk/data/gfx40/st-switch.png
   trunk/data/gfx40/st-switch_black.png
   trunk/data/gfx40/st-switch_white.png
   trunk/data/gfx40/st-turnstile-green.png
   trunk/data/gfx40/st-turnstile.png
   trunk/data/gfx48/fl-bridgea-closed.png
   trunk/data/gfx48/fl-bridgea-open.png
   trunk/data/gfx48/fl-bridgea.png
   trunk/data/gfx48/fl-bridgex-closed.png
   trunk/data/gfx48/fl-bridgex-open.png
   trunk/data/gfx48/fl-bridgex.png
   trunk/data/gfx48/fl-bridgey-closed.png
   trunk/data/gfx48/fl-bridgey-open.png
   trunk/data/gfx48/fl-bridgey.png
   trunk/data/gfx48/st-blocker.png
   trunk/data/gfx48/st-bolder-fall.png
   trunk/data/gfx48/st-bolder.png
   trunk/data/gfx48/st-pull.png
   trunk/data/gfx48/st-rotator-left.png
   trunk/data/gfx48/st-rotator-right.png
   trunk/data/gfx48/st-rubberband.png
   trunk/data/gfx48/st-scissors-snip.png
   trunk/data/gfx48/st-scissors.png
   trunk/data/gfx48/st-swap.png
   trunk/data/gfx48/st-switch.png
   trunk/data/gfx48/st-switch_black.png
   trunk/data/gfx48/st-switch_white.png
   trunk/data/gfx48/st-turnstile-green.png
   trunk/data/gfx48/st-turnstile.png
Modified:
   trunk/data/models-2d.lua
   trunk/data/schemas/objects.xml
   trunk/doc/reference/enigma-ref.texi
   trunk/src/floors/BridgeFloor.cc
   trunk/src/ox_magnum.cc
   trunk/src/stones/BlockerStone.cc
   trunk/src/stones/BoulderStone.cc
   trunk/src/stones/PullStone.cc
   trunk/src/stones/RotatorStone.cc
   trunk/src/stones/RubberbandStone.cc
   trunk/src/stones/ScissorsStone.cc
   trunk/src/stones/SwapStone.cc
   trunk/src/stones/Switch.cc
   trunk/src/stones/Turnstile.cc
Log:
Trunk 1.1:
- image renaming: st_pull, st_swap, st_switch, st_scissors,
    st_rubberband, st_turnstile, st_rotator, st_blocker, st_boulder
- pdf image patch: remove macro that is not resolved by all processors
- fl_bridge: add support for variants _bs, _be - images are missing
- fix oxyd magnum slope floor assignment

Deleted: trunk/data/gfx32/fl-bridgea-closed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-bridgea-open.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-bridgea.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-bridgex-closed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-bridgex-open.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-bridgex.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-bridgey-closed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-bridgey-open.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/fl-bridgey.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/fl_bridge_bn.png (from rev 1725, trunk/data/gfx32/fl-bridgey.png)

Copied: trunk/data/gfx32/fl_bridge_bw.png (from rev 1725, trunk/data/gfx32/fl-bridgex.png)

Copied: trunk/data/gfx32/fl_bridge_bw_closed.png (from rev 1725, trunk/data/gfx32/fl-bridgex-closed.png)

Copied: trunk/data/gfx32/fl_bridge_bw_open.png (from rev 1725, trunk/data/gfx32/fl-bridgex-open.png)

Copied: trunk/data/gfx32/fl_bridge_gc.png (from rev 1725, trunk/data/gfx32/fl-bridgea.png)

Copied: trunk/data/gfx32/fl_bridge_gc_closed.png (from rev 1725, trunk/data/gfx32/fl-bridgea-closed.png)

Copied: trunk/data/gfx32/fl_bridge_gc_open.png (from rev 1725, trunk/data/gfx32/fl-bridgea-open.png)

Deleted: trunk/data/gfx32/st-blocker.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-bolder-fall.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-bolder.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-pull.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-rotator-left.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-rotator-right.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-rubberband.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-scissors-snip.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-scissors.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-swap.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-switch.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-switch_black.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-switch_white.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-turnstile-green.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-turnstile.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx32/st_blocker.png (from rev 1725, trunk/data/gfx32/st-blocker.png)

Copied: trunk/data/gfx32/st_boulder.png (from rev 1725, trunk/data/gfx32/st-bolder.png)

Copied: trunk/data/gfx32/st_boulder_fall.png (from rev 1725, trunk/data/gfx32/st-bolder-fall.png)

Copied: trunk/data/gfx32/st_pull.png (from rev 1722, trunk/data/gfx32/st-pull.png)

Added: trunk/data/gfx32/st_rotator_ccw.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_rotator_ccw.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx32/st_rotator_cw.png (from rev 1725, trunk/data/gfx32/st-rotator-right.png)

Copied: trunk/data/gfx32/st_rubberband.png (from rev 1722, trunk/data/gfx32/st-rubberband.png)

Copied: trunk/data/gfx32/st_scissors.png (from rev 1722, trunk/data/gfx32/st-scissors.png)

Copied: trunk/data/gfx32/st_scissors_snip.png (from rev 1722, trunk/data/gfx32/st-scissors-snip.png)

Copied: trunk/data/gfx32/st_swap.png (from rev 1722, trunk/data/gfx32/st-swap.png)

Copied: trunk/data/gfx32/st_switch.png (from rev 1722, trunk/data/gfx32/st-switch.png)

Copied: trunk/data/gfx32/st_switch_black.png (from rev 1722, trunk/data/gfx32/st-switch_black.png)

Copied: trunk/data/gfx32/st_switch_white.png (from rev 1722, trunk/data/gfx32/st-switch_white.png)

Copied: trunk/data/gfx32/st_turnstile.png (from rev 1722, trunk/data/gfx32/st-turnstile.png)

Copied: trunk/data/gfx32/st_turnstile_green.png (from rev 1722, trunk/data/gfx32/st-turnstile-green.png)

Deleted: trunk/data/gfx40/fl-bridgea-closed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/fl-bridgea-open.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/fl-bridgea.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/fl-bridgex-closed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/fl-bridgex-open.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/fl-bridgex.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/fl-bridgey-closed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/fl-bridgey-open.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/fl-bridgey.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/fl_bridge_bn.png (from rev 1725, trunk/data/gfx40/fl-bridgey.png)

Copied: trunk/data/gfx40/fl_bridge_bw.png (from rev 1725, trunk/data/gfx40/fl-bridgex.png)

Copied: trunk/data/gfx40/fl_bridge_bw_closed.png (from rev 1725, trunk/data/gfx40/fl-bridgex-closed.png)

Copied: trunk/data/gfx40/fl_bridge_bw_open.png (from rev 1725, trunk/data/gfx40/fl-bridgex-open.png)

Copied: trunk/data/gfx40/fl_bridge_gc.png (from rev 1725, trunk/data/gfx40/fl-bridgea.png)

Copied: trunk/data/gfx40/fl_bridge_gc_closed.png (from rev 1725, trunk/data/gfx40/fl-bridgea-closed.png)

Copied: trunk/data/gfx40/fl_bridge_gc_open.png (from rev 1725, trunk/data/gfx40/fl-bridgea-open.png)

Deleted: trunk/data/gfx40/st-blocker.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-bolder-fall.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-bolder.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-pull.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-rotator-left.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-rotator-right.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-rubberband.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-scissors-snip.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-scissors.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-swap.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-switch.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-switch_black.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-switch_white.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-turnstile-green.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-turnstile.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/st_blocker.png (from rev 1725, trunk/data/gfx40/st-blocker.png)

Copied: trunk/data/gfx40/st_boulder.png (from rev 1725, trunk/data/gfx40/st-bolder.png)

Copied: trunk/data/gfx40/st_boulder_fall.png (from rev 1725, trunk/data/gfx40/st-bolder-fall.png)

Copied: trunk/data/gfx40/st_pull.png (from rev 1722, trunk/data/gfx40/st-pull.png)

Copied: trunk/data/gfx40/st_rotator_ccw.png (from rev 1725, trunk/data/gfx40/st-rotator-left.png)

Copied: trunk/data/gfx40/st_rotator_cw.png (from rev 1725, trunk/data/gfx40/st-rotator-right.png)

Copied: trunk/data/gfx40/st_rubberband.png (from rev 1722, trunk/data/gfx40/st-rubberband.png)

Copied: trunk/data/gfx40/st_scissors.png (from rev 1722, trunk/data/gfx40/st-scissors.png)

Copied: trunk/data/gfx40/st_scissors_snip.png (from rev 1722, trunk/data/gfx40/st-scissors-snip.png)

Copied: trunk/data/gfx40/st_swap.png (from rev 1722, trunk/data/gfx40/st-swap.png)

Copied: trunk/data/gfx40/st_switch.png (from rev 1722, trunk/data/gfx40/st-switch.png)

Copied: trunk/data/gfx40/st_switch_black.png (from rev 1722, trunk/data/gfx40/st-switch_black.png)

Copied: trunk/data/gfx40/st_switch_white.png (from rev 1722, trunk/data/gfx40/st-switch_white.png)

Copied: trunk/data/gfx40/st_turnstile.png (from rev 1722, trunk/data/gfx40/st-turnstile.png)

Copied: trunk/data/gfx40/st_turnstile_green.png (from rev 1722, trunk/data/gfx40/st-turnstile-green.png)

Deleted: trunk/data/gfx48/fl-bridgea-closed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/fl-bridgea-open.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/fl-bridgea.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/fl-bridgex-closed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/fl-bridgex-open.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/fl-bridgex.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/fl-bridgey-closed.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/fl-bridgey-open.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/fl-bridgey.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/fl_bridge_bn.png (from rev 1725, trunk/data/gfx48/fl-bridgey.png)

Copied: trunk/data/gfx48/fl_bridge_bw.png (from rev 1725, trunk/data/gfx48/fl-bridgex.png)

Copied: trunk/data/gfx48/fl_bridge_bw_closed.png (from rev 1725, trunk/data/gfx48/fl-bridgex-closed.png)

Copied: trunk/data/gfx48/fl_bridge_bw_open.png (from rev 1725, trunk/data/gfx48/fl-bridgex-open.png)

Copied: trunk/data/gfx48/fl_bridge_gc.png (from rev 1725, trunk/data/gfx48/fl-bridgea.png)

Copied: trunk/data/gfx48/fl_bridge_gc_closed.png (from rev 1725, trunk/data/gfx48/fl-bridgea-closed.png)

Copied: trunk/data/gfx48/fl_bridge_gc_open.png (from rev 1725, trunk/data/gfx48/fl-bridgea-open.png)

Deleted: trunk/data/gfx48/st-blocker.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-bolder-fall.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-bolder.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-pull.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-rotator-left.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-rotator-right.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-rubberband.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-scissors-snip.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-scissors.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-swap.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-switch.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-switch_black.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-switch_white.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-turnstile-green.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-turnstile.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/st_blocker.png (from rev 1725, trunk/data/gfx48/st-blocker.png)

Copied: trunk/data/gfx48/st_boulder.png (from rev 1725, trunk/data/gfx48/st-bolder.png)

Copied: trunk/data/gfx48/st_boulder_fall.png (from rev 1725, trunk/data/gfx48/st-bolder-fall.png)

Copied: trunk/data/gfx48/st_pull.png (from rev 1722, trunk/data/gfx48/st-pull.png)

Copied: trunk/data/gfx48/st_rotator_ccw.png (from rev 1725, trunk/data/gfx48/st-rotator-left.png)

Copied: trunk/data/gfx48/st_rotator_cw.png (from rev 1725, trunk/data/gfx48/st-rotator-right.png)

Copied: trunk/data/gfx48/st_rubberband.png (from rev 1722, trunk/data/gfx48/st-rubberband.png)

Copied: trunk/data/gfx48/st_scissors.png (from rev 1722, trunk/data/gfx48/st-scissors.png)

Copied: trunk/data/gfx48/st_scissors_snip.png (from rev 1722, trunk/data/gfx48/st-scissors-snip.png)

Copied: trunk/data/gfx48/st_swap.png (from rev 1722, trunk/data/gfx48/st-swap.png)

Copied: trunk/data/gfx48/st_switch.png (from rev 1722, trunk/data/gfx48/st-switch.png)

Copied: trunk/data/gfx48/st_switch_black.png (from rev 1722, trunk/data/gfx48/st-switch_black.png)

Copied: trunk/data/gfx48/st_switch_white.png (from rev 1722, trunk/data/gfx48/st-switch_white.png)

Copied: trunk/data/gfx48/st_turnstile.png (from rev 1722, trunk/data/gfx48/st-turnstile.png)

Copied: trunk/data/gfx48/st_turnstile_green.png (from rev 1722, trunk/data/gfx48/st-turnstile-green.png)

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/data/models-2d.lua	2009-06-18 22:17:39 UTC (rev 1726)
@@ -429,30 +429,52 @@
 
 -- bridges --
 do
-    DefImage("fl-bridgea-open")
-    DefImage("fl-bridgea-closed")
-    local namelist=DefSubimages("fl-bridgea", {h=10})
+    DefImage("fl_bridge_gc_open")
+    DefImage("fl_bridge_gc_closed")
+    local namelist=DefSubimages("fl_bridge_gc", {h=10})
     local frames = BuildFrames(namelist,70)
-    DefAnim("fl-bridgea-opening", ReverseFrames(frames))
-    DefAnim("fl-bridgea-closing", frames)
+    DefAnim("fl_bridge_gc_opening", ReverseFrames(frames))
+    DefAnim("fl_bridge_gc_closing", frames)
 end
 
 do
-    DefImage("fl-bridgex-open")
-    DefImage("fl-bridgex-closed")
-    local namelist=DefSubimages("fl-bridgex", {h=9})
+    DefImage("fl_bridge_bw_open")
+    DefImage("fl_bridge_bw_closed")
+    local namelist=DefSubimages("fl_bridge_bw", {h=9})
     local frames = BuildFrames(namelist,70)
-    DefAnim("fl-bridgex-opening", frames)
-    DefAnim("fl-bridgex-closing", ReverseFrames(frames))
+    DefAnim("fl_bridge_bw_opening", frames)
+    DefAnim("fl_bridge_bw_closing", ReverseFrames(frames))
 end
 
 do
-    DefImage("fl-bridgey-open")
-    DefImage("fl-bridgey-closed")
-    local namelist=DefSubimages("fl-bridgey", {h=9})
+    DefAlias("fl_bridge_bs_open", "fl_bridge_bw_open")
+    DefAlias("fl_bridge_bs_closed", "fl_bridge_bw_closed")
+--    local namelist=DefSubimages("fl_bridge_bs", {h=9})
+--    local frames = BuildFrames(namelist,70)
+--    DefAnim("fl_bridge_bs_opening", frames)
+--    DefAnim("fl_bridge_bs_closing", ReverseFrames(frames))
+    DefAlias("fl_bridge_bs_opening", "fl_bridge_bn_opening")
+    DefAlias("fl_bridge_bs_opening", "fl_bridge_bn_closing")
+end
+
+do
+    DefAlias("fl_bridge_be_open", "fl_bridge_bw_open")
+    DefAlias("fl_bridge_be_closed", "fl_bridge_bw_closed")
+--    local namelist=DefSubimages("fl_bridge_be", {h=9})
+--    local frames = BuildFrames(namelist,70)
+--    DefAnim("fl_bridge_be_opening", frames)
+--    DefAnim("fl_bridge_be_closing", ReverseFrames(frames))
+    DefAlias("fl_bridge_be_opening", "fl_bridge_bw_opening")
+    DefAlias("fl_bridge_be_closing", "fl_bridge_bw_closing")
+end
+
+do
+    DefAlias("fl_bridge_bn_open", "fl_bridge_bw_open")
+    DefAlias("fl_bridge_bn_closed", "fl_bridge_bw_closed")
+    local namelist=DefSubimages("fl_bridge_bn", {h=9})
     local frames = BuildFrames(namelist,70)
-    DefAnim("fl-bridgey-opening", frames)
-    DefAnim("fl-bridgey-closing", ReverseFrames(frames))
+    DefAnim("fl_bridge_bn_opening", frames)
+    DefAnim("fl_bridge_bn_closing", ReverseFrames(frames))
 end
 
 ------------------------
@@ -825,7 +847,7 @@
     DefStone("st_concrete", "sh_round")
     DefStone("st_ancient", "sh_round")
     DefStone("st_brownmarble")
-    DefStone("st-rubberband")
+    DefStone("st_rubberband")
     DefStone("st_brownpyramide")
     DefStone("st_redmarble")
     DefStone("st_surprise", "sh_round")
@@ -902,26 +924,26 @@
     DefSolidStone("st_panel", "st_panelx1")
 end
 
--- st-bolder --
+-- st_boulder --
 do
-    local img=DefSubimages("st-bolder", {w=4,h=3})
-    local imgfall=DefSubimages("st-bolder-fall", {w=4,h=3})
+    local img=DefSubimages("st_boulder", {w=4,h=3})
+    local imgfall=DefSubimages("st_boulder_fall", {w=4,h=3})
 
-    function def_bolder(orient, start)
-        local animname="st-bolder"..orient.."a"
+    function def_boulder(orient, start)
+        local animname="st_boulder"..orient.."a"
         local frames={img[start], img[start+1], img[start+2]}
         DefAnim(animname, BuildFrames(frames, 120), false)
-        DefShModel("st-bolder-"..orient, animname, "sh_round")
+        DefShModel("st_boulder_"..orient, animname, "sh_round")
 
-        animname="st-bolder-"..orient.."-fall-anim"
+        animname="st_boulder_"..orient.."_fall_anim"
         frames={imgfall[start],imgfall[start+1],imgfall[start+2]}
         DefAnim(animname, BuildFrames(frames, 120), false)
     end
 
-    def_bolder("n",1)
-    def_bolder("e",4)
-    def_bolder("s",7)
-    def_bolder("w",10)
+    def_boulder("n",1)
+    def_boulder("e",4)
+    def_boulder("s",7)
+    def_boulder("w",10)
 end
 
 -- st-break_*, breakable stones --
@@ -1134,23 +1156,23 @@
     for i=1,12 do DefFloatingStone(model_names[i], "st_onewayx"..i) end
 end
 
--- st-pull, st-swap --
+-- st_pull, st_swap --
 do
-   DefSubimages("st-pull",{modelname="st-pull-fg",h=5})
-   DefSubimages("st-swap",{modelname="st-swap-fg",h=5})
+   DefSubimages("st_pull",{modelname="st-pull-fg",h=5})
+   DefSubimages("st_swap",{modelname="st-swap-fg",h=5})
    DefSubimages("sh_pull",{h=4, imgw=ShadowSize, imgh=ShadowSize})
 
-   DefShModel("st-pull",   "st-pull-fg1", "sh_glass")
-   DefShModel("st-pull-n", "st-pull-fg2", "sh_pull1")
-   DefShModel("st-pull-s", "st-pull-fg3", "sh_pull2")
-   DefShModel("st-pull-e", "st-pull-fg4", "sh_pull3")
-   DefShModel("st-pull-w", "st-pull-fg5", "sh_pull4")
+   DefShModel("st_pull",   "st-pull-fg1", "sh_glass")
+   DefShModel("st_pull_n", "st-pull-fg2", "sh_pull1")
+   DefShModel("st_pull_s", "st-pull-fg3", "sh_pull2")
+   DefShModel("st_pull_e", "st-pull-fg4", "sh_pull3")
+   DefShModel("st_pull_w", "st-pull-fg5", "sh_pull4")
 
-   DefShModel("st-swap",   "st-swap-fg1", "sh_round")
-   DefShModel("st-swap-n", "st-swap-fg2", "sh_pull1")
-   DefShModel("st-swap-s", "st-swap-fg3", "sh_pull2")
-   DefShModel("st-swap-e", "st-swap-fg4", "sh_pull3")
-   DefShModel("st-swap-w", "st-swap-fg5", "sh_pull4")
+   DefShModel("st_swap",   "st-swap-fg1", "sh_round")
+   DefShModel("st_swap_n", "st-swap-fg2", "sh_pull1")
+   DefShModel("st_swap_s", "st-swap-fg3", "sh_pull2")
+   DefShModel("st_swap_e", "st-swap-fg4", "sh_pull3")
+   DefShModel("st_swap_w", "st-swap-fg5", "sh_pull4")
 end
 
 -- st-puzzle* --
@@ -1176,23 +1198,23 @@
     DefAnim("st_flat_falling", BuildFrames(images, 100))
 end
 
--- st-rotator --
+-- st_rotator --
 do
-    local images = DefSubimages("st-rotator-left", {h=8})
-    DefAnim("st-rotator-left-anim", BuildFrames(images, 70), false)
-    DefRoundStone("st-rotator-left", "st-rotator-left-anim")
-    local images = DefSubimages("st-rotator-right", {h=8})
-    DefAnim("st-rotator-right-anim", BuildFrames(images, 70), false)
-    DefRoundStone("st-rotator-right", "st-rotator-right-anim")
+    local images = DefSubimages("st_rotator_ccw", {h=8})
+    DefAnim("st_rotator_ccw_anim", BuildFrames(images, 70), false)
+    DefRoundStone("st_rotator_ccw", "st_rotator_ccw_anim")
+    local images = DefSubimages("st_rotator_cw", {h=8})
+    DefAnim("st_rotator_cw_anim", BuildFrames(images, 70), false)
+    DefRoundStone("st_rotator_cw", "st_rotator_cw_anim")
 end
 
--- st-scissors --
+-- st_scissors --
 do
-    DefStone("st-scissors", "sh_round")
+    DefStone("st_scissors", "sh_round")
 
-    local images = DefSubimages("st-scissors-snip", {h=1})
-    DefAnim("st-scissors-snip-anim", BuildFrames(images, 130))
-    DefShModel("st-scissors-snip", "st-scissors-snip-anim", "sh_round")
+    local images = DefSubimages("st_scissors_snip", {h=1})
+    DefAnim("st_scissors_snip_anim", BuildFrames(images, 130))
+    DefShModel("st_scissors_snip", "st_scissors_snip_anim", "sh_round")
 end
 
 -- st-shogun* --
@@ -1245,21 +1267,21 @@
     DefAnim("st_stoneimpulse_breaking", BuildFrames(images,50))
 end
 
--- st-switch, st-switch_black, st-switch_white --
+-- st_switch, st_switch_black, st_switch_white --
 do
     function mkswitch(modelname, basename)
         local n = DefSubimages(modelname, {h=3, modelname=basename.."-fg"})
         local f = BuildFrames(n, 60)
-        DefRoundStone(modelname.."-off", n[1])
-        DefRoundStone(modelname.."-on", n[3])
-        DefAnim(basename.."-turnon", f)
-            DefAnim(basename.."-turnoff", ReverseFrames(f))
-            DefRoundStone(modelname.."-turnon", basename.."-turnon")
-            DefRoundStone(modelname.."-turnoff", basename.."-turnoff")
+        DefRoundStone(modelname.."_off", n[1])
+        DefRoundStone(modelname.."_on", n[3])
+        DefAnim(basename.."_turnon", f)
+        DefAnim(basename.."_turnoff", ReverseFrames(f))
+        DefRoundStone(modelname.."_turnon", basename.."_turnon")
+        DefRoundStone(modelname.."_turnoff", basename.."_turnoff")
     end
-    mkswitch("st-switch", "switch")
-    mkswitch("st-switch_black", "switch_black")
-    mkswitch("st-switch_white", "switch_white")
+    mkswitch("st_switch", "switch")
+    mkswitch("st_switch_black", "switch_black")
+    mkswitch("st_switch_white", "switch_white")
 end
 
 -- st-timer --
@@ -1279,26 +1301,26 @@
     DefShModel("st-time1switch", "st-time1switch-anim", "sh_round")
 end
 
--- st-turnstile --
+-- st_turnstile --
 do
-    local images = DefSubimages("st-turnstile", {h=2})
-    DefAnim("turnstile-anim", ReverseFrames(BuildFrames(images, 30)))
-    DefSolidStone("st-turnstile", images[1])
-    DefSolidStone("st-turnstile-anim", "turnstile-anim")
+    local images = DefSubimages("st_turnstile", {h=2})
+    DefAnim("turnstile_anim", ReverseFrames(BuildFrames(images, 30)))
+    DefSolidStone("st_turnstile", images[1])
+    DefSolidStone("st_turnstile_anim", "turnstile_anim")
 end
 
 -- st-turnstle, arms --
-DefAlias("st-turnstile-e", "st_puzzle1")
-DefAlias("st-turnstile-w", "st_puzzle4")
-DefAlias("st-turnstile-s", "st_puzzle8")
-DefAlias("st-turnstile-n", "st_puzzle2")
+DefAlias("st_turnstile_e", "st_puzzle1")
+DefAlias("st_turnstile_w", "st_puzzle4")
+DefAlias("st_turnstile_s", "st_puzzle8")
+DefAlias("st_turnstile_n", "st_puzzle2")
 
 -- st-turnstile-green --
 do
-    local images = DefSubimages("st-turnstile-green", {h=2})
-    DefAnim("turnstile-green-anim", ReverseFrames(BuildFrames(images, 30)))
-    DefSolidStone("st-turnstile-green", images[1])
-    DefSolidStone("st-turnstile-green-anim", "turnstile-green-anim")
+    local images = DefSubimages("st_turnstile_green", {h=2})
+    DefAnim("turnstile_green_anim", ReverseFrames(BuildFrames(images, 30)))
+    DefSolidStone("st_turnstile_green", images[1])
+    DefSolidStone("st_turnstile_green_anim", "turnstile_green_anim")
 end
 
 -- growing stones, st_box, st_flhay, greenbrown seed, st-volcano, st-blocker --
@@ -1345,18 +1367,18 @@
 
    -- Blocker stone --
    do
-      local n=DefSubimages("st-blocker", {h=4})
-      DefShModel("st-blocker", n[1], "sh_round")
+      local n=DefSubimages("st_blocker", {h=4})
+      DefShModel("st_blocker", n[1], "sh_round")
       frames={}
       for i=4,2,-1 do
-         table.insert(frames, "st-blocker"..i)
+         table.insert(frames, "st_blocker"..i)
       end
-      DefAnim("blocker-growing-fg", BuildFrames(frames, 60))
-      DefAnim("blocker-growing-bg", BuildFrames(shadows, 60))
-      DefAnim("blocker-shrinking-fg", ReverseFrames(BuildFrames(frames, 60)))
-      DefAnim("blocker-shrinking-bg", ReverseFrames(BuildFrames(shadows, 60)))
-      DefShModel("st-blocker-shrinking", "blocker-shrinking-fg", "blocker-shrinking-bg");
-      DefShModel("st-blocker-growing", "blocker-growing-fg", "blocker-growing-bg");
+      DefAnim("blocker_growing_fg", BuildFrames(frames, 60))
+      DefAnim("blocker_growing_bg", BuildFrames(shadows, 60))
+      DefAnim("blocker_shrinking_fg", ReverseFrames(BuildFrames(frames, 60)))
+      DefAnim("blocker_shrinking_bg", ReverseFrames(BuildFrames(shadows, 60)))
+      DefShModel("st_blocker_shrinking", "blocker_shrinking_fg", "blocker_shrinking_bg");
+      DefShModel("st_blocker_growing", "blocker_growing_fg", "blocker_growing_bg");
    end
 end
 

Modified: trunk/data/schemas/objects.xml
===================================================================
--- trunk/data/schemas/objects.xml	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/data/schemas/objects.xml	2009-06-18 22:17:39 UTC (rev 1726)
@@ -322,6 +322,12 @@
     <object name="fl_bridge_bw">
       <attr name="flavor" value="bw"/>
     </object>
+    <object name="fl_bridge_bs">
+      <attr name="flavor" value="bs"/>
+    </object>
+    <object name="fl_bridge_be">
+      <attr name="flavor" value="be"/>
+    </object>
     <object name="fl_bridge_bn">
       <attr name="flavor" value="bn"/>
     </object>

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-18 22:17:39 UTC (rev 1726)
@@ -19,10 +19,6 @@
 @defindex at
 @defindex ms
 
- at macro oisize {}
-10 mm
- at end macro
-
 @contents
 
 @ifnottex
@@ -9352,54 +9348,54 @@
 @c
 WORK IN PROGRESS - The follwing table is still incomplete!
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
- at item @image{images/fl_abyss, @oisize{}} @tab @yref{fl_abyss}
- at tab @image{images/fl_adhesionless, @oisize{}} @tab @yref{fl_adhesionless}
- at tab @image{images/fl_aquamarine, @oisize{}} @tab @yref{fl_aquamarine}
- at item @image{images/fl_bast, @oisize{}} @tab @yref{fl_bast}
- at tab @image{images/fl_bluegray, @oisize{}} @tab @yref{fl_bluegray}
- at tab @image{images/fl_bluegreen, @oisize{}} @tab @yref{fl_bluegreen}
- at item @image{images/fl_blueslab, @oisize{}} @tab @yref{fl_blueslab}
- at tab @image{images/fl_brick, @oisize{}} @tab @yref{fl_brick}
- at tab @image{images/fl_bright, @oisize{}} @tab @yref{fl_bright}
- at item @image{images/fl_concrete, @oisize{}} @tab @yref{fl_concrete}
- at tab @image{images/fl_darkgray, @oisize{}} @tab @yref{fl_darkgray}
- at tab @image{images/fl_dark, @oisize{}} @tab @yref{fl_dark}
- at item @image{images/fl_dunes, @oisize{}} @tab @yref{fl_dunes}
- at tab @image{images/fl_fake_trigger, @oisize{}} @tab @yref{fl_fake_trigger}
- at tab @image{images/fl_gravel, @oisize{}} @tab @yref{fl_gravel}
- at item @image{images/fl_gray, @oisize{}} @tab @yref{fl_gray}
- at tab @image{images/fl_hay, @oisize{}} @tab @yref{fl_hay}
- at tab @image{images/fl_himalaya, @oisize{}} @tab @yref{fl_himalaya}
- at item @image{images/fl_ice_heating, @oisize{}} @tab @yref{fl_ice_heating}
- at tab @image{images/fl_ice, @oisize{}} @tab @yref{fl_ice}
- at tab @image{images/fl_inverse_gray, @oisize{}} @tab @yref{fl_inverse_gray}
- at item @image{images/fl_inverse_white, @oisize{}} @tab @yref{fl_inverse_white}
- at tab @image{images/fl_ivory, @oisize{}} @tab @yref{fl_ivory}
- at tab @image{images/fl_lawn, @oisize{}} @tab @yref{fl_lawn}
- at item @image{images/fl_marble, @oisize{}} @tab @yref{fl_marble}
- at tab @image{images/fl_metal, @oisize{}} @tab @yref{fl_metal}
- at tab @image{images/fl_mortar, @oisize{}} @tab @yref{fl_mortar}
- at item @image{images/fl_pinkbumps, @oisize{}} @tab @yref{fl_pinkbumps}
- at tab @image{images/fl_plank, @oisize{}} @tab @yref{fl_plank}
- at tab @image{images/fl_platinum, @oisize{}} @tab @yref{fl_platinum}
- at item @image{images/fl_red, @oisize{}} @tab @yref{fl_red}
- at tab @image{images/fl_redslab, @oisize{}} @tab @yref{fl_redslab}
- at tab @image{images/fl_rock, @oisize{}} @tab @yref{fl_rock}
- at item @image{images/fl_rough, @oisize{}} @tab @yref{fl_rough}
- at tab @image{images/fl_sahara, @oisize{}} @tab @yref{fl_sahara}
- at tab @image{images/fl_samba, @oisize{}} @tab @yref{fl_samba}
- at item @image{images/fl_sand, @oisize{}} @tab @yref{fl_sand}
- at tab @image{images/fl_space, @oisize{}} @tab @yref{fl_space}
- at tab @image{images/fl_stone, @oisize{}} @tab @yref{fl_stone}
- at item @image{images/fl_swamp_heating, @oisize{}} @tab @yref{fl_swamp_heating}
- at tab @image{images/fl_swamp, @oisize{}} @tab @yref{fl_swamp}
- at tab @image{images/fl_tigris, @oisize{}} @tab @yref{fl_tigris}
- at item @image{images/fl_water_heating, @oisize{}} @tab @yref{fl_water_heating}
- at tab @image{images/fl_water, @oisize{}} @tab @yref{fl_water}
- at tab @image{images/fl_white, @oisize{}} @tab @yref{fl_white}
- at item @image{images/fl_woven, @oisize{}} @tab @yref{fl_woven}
- at tab @image{images/fl_yinyang_yang, @oisize{}} @tab @yref{fl_yinyang_yang}
- at tab @image{images/fl_yinyang_yin, @oisize{}} @tab @yref{fl_yinyang_yin}
+ at item @image{images/fl_abyss, 12mm} @tab @yref{fl_abyss}
+ at tab @image{images/fl_adhesionless, 12mm} @tab @yref{fl_adhesionless}
+ at tab @image{images/fl_aquamarine, 12mm} @tab @yref{fl_aquamarine}
+ at item @image{images/fl_bast, 12mm} @tab @yref{fl_bast}
+ at tab @image{images/fl_bluegray, 12mm} @tab @yref{fl_bluegray}
+ at tab @image{images/fl_bluegreen, 12mm} @tab @yref{fl_bluegreen}
+ at item @image{images/fl_blueslab, 12mm} @tab @yref{fl_blueslab}
+ at tab @image{images/fl_brick, 12mm} @tab @yref{fl_brick}
+ at tab @image{images/fl_bright, 12mm} @tab @yref{fl_bright}
+ at item @image{images/fl_concrete, 12mm} @tab @yref{fl_concrete}
+ at tab @image{images/fl_darkgray, 12mm} @tab @yref{fl_darkgray}
+ at tab @image{images/fl_dark, 12mm} @tab @yref{fl_dark}
+ at item @image{images/fl_dunes, 12mm} @tab @yref{fl_dunes}
+ at tab @image{images/fl_fake_trigger, 12mm} @tab @yref{fl_fake_trigger}
+ at tab @image{images/fl_gravel, 12mm} @tab @yref{fl_gravel}
+ at item @image{images/fl_gray, 12mm} @tab @yref{fl_gray}
+ at tab @image{images/fl_hay, 12mm} @tab @yref{fl_hay}
+ at tab @image{images/fl_himalaya, 12mm} @tab @yref{fl_himalaya}
+ at item @image{images/fl_ice_heating, 12mm} @tab @yref{fl_ice_heating}
+ at tab @image{images/fl_ice, 12mm} @tab @yref{fl_ice}
+ at tab @image{images/fl_inverse_gray, 12mm} @tab @yref{fl_inverse_gray}
+ at item @image{images/fl_inverse_white, 12mm} @tab @yref{fl_inverse_white}
+ at tab @image{images/fl_ivory, 12mm} @tab @yref{fl_ivory}
+ at tab @image{images/fl_lawn, 12mm} @tab @yref{fl_lawn}
+ at item @image{images/fl_marble, 12mm} @tab @yref{fl_marble}
+ at tab @image{images/fl_metal, 12mm} @tab @yref{fl_metal}
+ at tab @image{images/fl_mortar, 12mm} @tab @yref{fl_mortar}
+ at item @image{images/fl_pinkbumps, 12mm} @tab @yref{fl_pinkbumps}
+ at tab @image{images/fl_plank, 12mm} @tab @yref{fl_plank}
+ at tab @image{images/fl_platinum, 12mm} @tab @yref{fl_platinum}
+ at item @image{images/fl_red, 12mm} @tab @yref{fl_red}
+ at tab @image{images/fl_redslab, 12mm} @tab @yref{fl_redslab}
+ at tab @image{images/fl_rock, 12mm} @tab @yref{fl_rock}
+ at item @image{images/fl_rough, 12mm} @tab @yref{fl_rough}
+ at tab @image{images/fl_sahara, 12mm} @tab @yref{fl_sahara}
+ at tab @image{images/fl_samba, 12mm} @tab @yref{fl_samba}
+ at item @image{images/fl_sand, 12mm} @tab @yref{fl_sand}
+ at tab @image{images/fl_space, 12mm} @tab @yref{fl_space}
+ at tab @image{images/fl_stone, 12mm} @tab @yref{fl_stone}
+ at item @image{images/fl_swamp_heating, 12mm} @tab @yref{fl_swamp_heating}
+ at tab @image{images/fl_swamp, 12mm} @tab @yref{fl_swamp}
+ at tab @image{images/fl_tigris, 12mm} @tab @yref{fl_tigris}
+ at item @image{images/fl_water_heating, 12mm} @tab @yref{fl_water_heating}
+ at tab @image{images/fl_water, 12mm} @tab @yref{fl_water}
+ at tab @image{images/fl_white, 12mm} @tab @yref{fl_white}
+ at item @image{images/fl_woven, 12mm} @tab @yref{fl_woven}
+ at tab @image{images/fl_yinyang_yang, 12mm} @tab @yref{fl_yinyang_yang}
+ at tab @image{images/fl_yinyang_yin, 12mm} @tab @yref{fl_yinyang_yin}
 @end multitable
 
 @c ----------------- Floor Attributes --------------------
@@ -9761,7 +9757,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_adhesionless, @oisize{}} @b{fl_adhesionless} 
+ at item @image{images/fl_adhesionless, 12mm} @b{fl_adhesionless} 
 @end table
 @end table
 
@@ -9782,7 +9778,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_aquamarine, @oisize{}} @b{fl_aquamarine}
+ at item @image{images/fl_aquamarine, 12mm} @b{fl_aquamarine}
 @item @b{fl_aquamarine_framed} 
 @end table
 @end table
@@ -9806,7 +9802,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_bast, @oisize{}} @b{fl_bast} 
+ at item @image{images/fl_bast, 12mm} @b{fl_bast} 
 @item @b{fl_bast_framed}
 @end table
 @end table
@@ -9828,7 +9824,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_bluegray, @oisize{}} @b{fl_bluegray}
+ at item @image{images/fl_bluegray, 12mm} @b{fl_bluegray}
 @item @b{fl_bluegray_framed}
 @end table
 @end table
@@ -9850,7 +9846,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_bluegreen, @oisize{}} @b{fl_bluegreen}
+ at item @image{images/fl_bluegreen, 12mm} @b{fl_bluegreen}
 @item @b{fl_bluegreen_framed}
 @end table
 @end table
@@ -9873,7 +9869,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_blueslab, @oisize{}} @b{fl_blueslab}
+ at item @image{images/fl_blueslab, 12mm} @b{fl_blueslab}
 @item @b{fl_blueslab_framed}
 @end table
 @end table
@@ -9895,7 +9891,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_brick, @oisize{}} @b{fl_brick}
+ at item @image{images/fl_brick, 12mm} @b{fl_brick}
 @item @b{fl_brick_framed}
 @end table
 @end table
@@ -9918,7 +9914,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_bright, @oisize{}} @b{fl_bright}
+ at item @image{images/fl_bright, 12mm} @b{fl_bright}
 @item @b{fl_bright_framed}
 @end table
 @end table
@@ -9940,7 +9936,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_concrete, @oisize{}} @b{fl_concrete}
+ at item @image{images/fl_concrete, 12mm} @b{fl_concrete}
 @item @b{fl_concrete_framed}
 @end table
 @end table
@@ -9963,7 +9959,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_dark, @oisize{}} @b{fl_dark}
+ at item @image{images/fl_dark, 12mm} @b{fl_dark}
 @item @b{fl_dark_framed}
 @end table
 @end table
@@ -9985,7 +9981,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_darkgray, @oisize{}} @b{fl_darkgray}
+ at item @image{images/fl_darkgray, 12mm} @b{fl_darkgray}
 @item @b{fl_darkgray_framed}
 @end table
 @end table
@@ -10007,7 +10003,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_dunes, @oisize{}} @b{fl_dunes}
+ at item @image{images/fl_dunes, 12mm} @b{fl_dunes}
 @item @b{fl_dunes_framed}
 @end table
 @end table
@@ -10029,7 +10025,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_gravel, @oisize{}} @b{fl_gravel}
+ at item @image{images/fl_gravel, 12mm} @b{fl_gravel}
 @item @b{fl_gravel_framed}
 @end table
 @end table
@@ -10051,7 +10047,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_gray, @oisize{}} @b{fl_gray}
+ at item @image{images/fl_gray, 12mm} @b{fl_gray}
 @item @b{fl_gray_framed}
 @end table
 @end table
@@ -10073,7 +10069,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_himalaya, @oisize{}} @b{fl_himalaya}
+ at item @image{images/fl_himalaya, 12mm} @b{fl_himalaya}
 @item @b{fl_himalaya_framed}
 @end table
 @end table
@@ -10095,7 +10091,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_ivory, @oisize{}} @b{fl_ivory}
+ at item @image{images/fl_ivory, 12mm} @b{fl_ivory}
 @item @b{fl_ivory_framed}
 @end table
 @end table
@@ -10155,7 +10151,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_marble, @oisize{}} @b{fl_marble}
+ at item @image{images/fl_marble, 12mm} @b{fl_marble}
 @item @b{fl_marble_framed}
 @end table
 @end table
@@ -10215,7 +10211,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_mortar, @oisize{}} @b{fl_mortar}
+ at item @image{images/fl_mortar, 12mm} @b{fl_mortar}
 @item @b{fl_mortar_framed}
 @end table
 @end table
@@ -10237,7 +10233,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_pinkbumps, @oisize{}} @b{fl_pinkbumps}
+ at item @image{images/fl_pinkbumps, 12mm} @b{fl_pinkbumps}
 @item @b{fl_pinkbumps_framed}
 @end table
 @end table
@@ -10261,7 +10257,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_plank, @oisize{}} @b{fl_plank}
+ at item @image{images/fl_plank, 12mm} @b{fl_plank}
 @item @b{fl_plank_framed}
 @end table
 @end table
@@ -10283,7 +10279,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_platinum, @oisize{}} @b{fl_platinum}
+ at item @image{images/fl_platinum, 12mm} @b{fl_platinum}
 @item @b{fl_platinum_framed}
 @end table
 @end table
@@ -10305,7 +10301,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_red, @oisize{}} @b{fl_red}
+ at item @image{images/fl_red, 12mm} @b{fl_red}
 @item @b{fl_red_framed}
 @end table
 @end table
@@ -10328,7 +10324,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_redslab, @oisize{}} @b{fl_redslab}
+ at item @image{images/fl_redslab, 12mm} @b{fl_redslab}
 @item @b{fl_redslab_framed}
 @end table
 @end table
@@ -10350,7 +10346,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_rough, @oisize{}} @b{fl_rough}
+ at item @image{images/fl_rough, 12mm} @b{fl_rough}
 @item @b{fl_rough_framed}
 @end table
 @end table
@@ -10372,7 +10368,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_sahara, @oisize{}} @b{fl_sahara}
+ at item @image{images/fl_sahara, 12mm} @b{fl_sahara}
 @item @b{fl_sahara_framed}
 @end table
 @end table
@@ -10424,7 +10420,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_sand, @oisize{}} @b{fl_sand}
+ at item @image{images/fl_sand, 12mm} @b{fl_sand}
 @item @b{fl_sand_framed}
 @end table
 @end table
@@ -10469,7 +10465,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_stone, @oisize{}} @b{fl_stone}
+ at item @image{images/fl_stone, 12mm} @b{fl_stone}
 @item @b{fl_stone_framed}
 @end table
 @end table
@@ -10491,7 +10487,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_tigris, @oisize{}} @b{fl_tigris}
+ at item @image{images/fl_tigris, 12mm} @b{fl_tigris}
 @item @b{fl_tigris_framed}
 @end table
 @end table
@@ -10513,7 +10509,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_white, @oisize{}} @b{fl_white}
+ at item @image{images/fl_white, 12mm} @b{fl_white}
 @item @b{fl_white_framed}
 @end table
 @end table
@@ -10535,7 +10531,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_woven, @oisize{}} @b{fl_woven}
+ at item @image{images/fl_woven, 12mm} @b{fl_woven}
 @item @b{fl_woven_framed}
 @end table
 @end table
@@ -11137,78 +11133,78 @@
 @section Item Overview
 
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
- at item @image{images/it_bag, @oisize{}} @tab @yref{it_bag}
- at tab @image{images/it_banana, @oisize{}} @tab @yref{it_banana}
- at tab @image{images/it_blocker, @oisize{}} @tab @yref{it_blocker}
- at item @image{images/it_bomb_black, @oisize{}} @tab @yref{it_bomb}_black
- at tab @image{images/it_bomb_white, @oisize{}} @tab @yref{it_bomb}_white
- at tab @image{images/it_bottle_idle, @oisize{}} @tab @yref{it_bottle}
- at item @image{images/it_bottle_broken, @oisize{}} @tab @yref{it_bottle}_broken
- at tab @image{images/st_brake, @oisize{}} @tab @yref{it_brake}
- at tab @image{images/it_brush, @oisize{}} @tab @yref{it_brush}
- at item @image{images/it_burnable_ash, @oisize{}} @tab @yref{it_burnable}_ash
- at tab @image{images/it_burnable_burning, @oisize{}} @tab @yref{it_burnable}_burning
- at tab @image{images/it_burnable_fireproof, @oisize{}} @tab @yref{it_burnable}_fireproof
- at item @image{images/it_burnable_oil, @oisize{}} @tab @yref{it_burnable}_oil
- at tab @image{images/it_cherry, @oisize{}} @tab @yref{it_cherry}
- at tab @image{images/it_coffee, @oisize{}} @tab @yref{it_coffee}
- at item @image{images/it_coin_s, @oisize{}} @tab @yref{it_coin}_s
- at tab @image{images/it_coin_m, @oisize{}} @tab @yref{it_coin}_m
- at tab @image{images/it_coin_l, @oisize{}} @tab @yref{it_coin}_l
- at item @image{images/it_crack_abyss, @oisize{}} @tab @yref{it_crack}_abyss
- at tab @image{images/it_crack_water, @oisize{}} @tab @yref{it_crack}_water
- at tab @image{images/it_cross, @oisize{}} @tab @yref{it_cross}
- at item @image{images/it_death, @oisize{}} @tab @yref{it_death}
- at tab @image{images/it_document, @oisize{}} @tab @yref{it_document}
- at tab @image{images/it_drop, @oisize{}} @tab @yref{it_drop}
- at item @image{images/it_dynamite, @oisize{}} @tab @yref{it_dynamite}
- at tab @image{images/it_explosion, @oisize{}} @tab @yref{it_explosion}
- at tab @image{images/it_extralife, @oisize{}} @tab @yref{it_extralife}
- at item @image{images/it_extinguisher, @oisize{}} @tab @yref{it_extinguisher}
- at tab @image{images/it_flag_black, @oisize{}} @tab @yref{it_flag}_black
- at tab @image{images/it_flag_white, @oisize{}} @tab @yref{it_flag}_white
- at item @image{images/it_floppy, @oisize{}} @tab @yref{it_floppy}
- at tab @image{images/it_glasses, @oisize{}} @tab @yref{it_glasses}
- at tab @image{images/it_glasses_broken, @oisize{}} @tab @yref{it_glasses}_broken
- at item @image{images/it_hammer, @oisize{}} @tab @yref{it_hammer}
- at tab @image{images/it_key, @oisize{}} @tab @yref{it_key}
- at tab @image{images/it_landmine, @oisize{}} @tab @yref{it_landmine}
- at item @image{images/it_laser, @oisize{}} @tab @yref{it_laserbeam}
- at tab @image{images/it_magicwand, @oisize{}} @tab @yref{it_magicwand}
- at tab @image{images/it_magnet_off, @oisize{}} @tab @yref{it_magnet}
- at item @image{images/it_meditation_bump, @oisize{}} @tab @yref{it_meditation}_bump
- at tab @image{images/it_meditation_caldera, @oisize{}} @tab @yref{it_meditation}_caledera
- at tab @image{images/it_meditation_dent, @oisize{}} @tab @yref{it_meditation}_dent
- at item @image{images/it_meditation_hill, @oisize{}} @tab @yref{it_meditation}_hill
- at tab @image{images/it_meditation_hollow, @oisize{}} @tab @yref{it_meditation}_hollow
- at tab @image{images/it_meditation_volcano, @oisize{}} @tab @yref{it_meditation}_volcano
- at item @image{images/it_pencil, @oisize{}} @tab @yref{it_pencil}
- at tab @image{images/it_pin, @oisize{}} @tab @yref{it_pin}
- at tab @image{images/it_pipe, @oisize{}} @tab @yref{it_pipe}
- at item @image{images/it_puller, @oisize{}} @tab @yref{it_puller}
- at tab @image{images/it_ring, @oisize{}} @tab @yref{it_ring}
- at tab @image{images/it_rubberband, @oisize{}} @tab @yref{it_rubberband}
- at item @image{images/it_seed, @oisize{}} @tab @yref{it_seed}
- at tab @image{images/it_sensor, @oisize{}} @tab @yref{it_sensor}
- at tab @image{images/it_sensor_exit, @oisize{}} @tab @yref{it_sensor}_exit
- at item @image{images/it_shogun_m, @oisize{}} @tab @yref{it_shogun}
- at tab @image{images/it_spade, @oisize{}} @tab @yref{it_spade}
- at tab @image{images/it_spoon, @oisize{}} @tab @yref{it_spoon}
- at item @image{images/it_springboard, @oisize{}} @tab @yref{it_springboard}
- at tab @image{images/it_spring_drop, @oisize{}} @tab @yref{it_spring}_drop
- at tab @image{images/it_spring_keep, @oisize{}} @tab @yref{it_spring}_keep
- at item @image{images/it_squashed, @oisize{}} @tab @yref{it_squashed}
- at tab @image{images/it_strip, @oisize{}} @tab @yref{it_strip}
- at tab @image{images/it_surprise, @oisize{}} @tab @yref{it_surprise}
- at item @image{images/it_sword, @oisize{}} @tab @yref{it_sword}
- at tab @image{images/it_trap, @oisize{}} @tab @yref{it_trap}
- at tab @image{images/it_trigger, @oisize{}} @tab @yref{it_trigger}
- at item @image{images/it_umbrella, @oisize{}} @tab @yref{it_umbrella}
- at tab @image{images/it_vortex, @oisize{}} @tab @yref{it_vortex}
- at tab @image{images/it_weight, @oisize{}} @tab @yref{it_weight}
- at item @image{images/it_wormhole, @oisize{}} @tab @yref{it_wormhole}
- at tab @image{images/it_wrench, @oisize{}} @tab @yref{it_wrench}
- at tab @image{images/it_yinyang, @oisize{}} @tab @yref{it_yinyang}
+ at item @image{images/it_bag, 12mm} @tab @yref{it_bag}
+ at tab @image{images/it_banana, 12mm} @tab @yref{it_banana}
+ at tab @image{images/it_blocker, 12mm} @tab @yref{it_blocker}
+ at item @image{images/it_bomb_black, 12mm} @tab @yref{it_bomb}_black
+ at tab @image{images/it_bomb_white, 12mm} @tab @yref{it_bomb}_white
+ at tab @image{images/it_bottle_idle, 12mm} @tab @yref{it_bottle}
+ at item @image{images/it_bottle_broken, 12mm} @tab @yref{it_bottle}_broken
+ at tab @image{images/st_brake, 12mm} @tab @yref{it_brake}
+ at tab @image{images/it_brush, 12mm} @tab @yref{it_brush}
+ at item @image{images/it_burnable_ash, 12mm} @tab @yref{it_burnable}_ash
+ at tab @image{images/it_burnable_burning, 12mm} @tab @yref{it_burnable}_burning
+ at tab @image{images/it_burnable_fireproof, 12mm} @tab @yref{it_burnable}_fireproof
+ at item @image{images/it_burnable_oil, 12mm} @tab @yref{it_burnable}_oil
+ at tab @image{images/it_cherry, 12mm} @tab @yref{it_cherry}
+ at tab @image{images/it_coffee, 12mm} @tab @yref{it_coffee}
+ at item @image{images/it_coin_s, 12mm} @tab @yref{it_coin}_s
+ at tab @image{images/it_coin_m, 12mm} @tab @yref{it_coin}_m
+ at tab @image{images/it_coin_l, 12mm} @tab @yref{it_coin}_l
+ at item @image{images/it_crack_abyss, 12mm} @tab @yref{it_crack}_abyss
+ at tab @image{images/it_crack_water, 12mm} @tab @yref{it_crack}_water
+ at tab @image{images/it_cross, 12mm} @tab @yref{it_cross}
+ at item @image{images/it_death, 12mm} @tab @yref{it_death}
+ at tab @image{images/it_document, 12mm} @tab @yref{it_document}
+ at tab @image{images/it_drop, 12mm} @tab @yref{it_drop}
+ at item @image{images/it_dynamite, 12mm} @tab @yref{it_dynamite}
+ at tab @image{images/it_explosion, 12mm} @tab @yref{it_explosion}
+ at tab @image{images/it_extralife, 12mm} @tab @yref{it_extralife}
+ at item @image{images/it_extinguisher, 12mm} @tab @yref{it_extinguisher}
+ at tab @image{images/it_flag_black, 12mm} @tab @yref{it_flag}_black
+ at tab @image{images/it_flag_white, 12mm} @tab @yref{it_flag}_white
+ at item @image{images/it_floppy, 12mm} @tab @yref{it_floppy}
+ at tab @image{images/it_glasses, 12mm} @tab @yref{it_glasses}
+ at tab @image{images/it_glasses_broken, 12mm} @tab @yref{it_glasses}_broken
+ at item @image{images/it_hammer, 12mm} @tab @yref{it_hammer}
+ at tab @image{images/it_key, 12mm} @tab @yref{it_key}
+ at tab @image{images/it_landmine, 12mm} @tab @yref{it_landmine}
+ at item @image{images/it_laser, 12mm} @tab @yref{it_laserbeam}
+ at tab @image{images/it_magicwand, 12mm} @tab @yref{it_magicwand}
+ at tab @image{images/it_magnet_off, 12mm} @tab @yref{it_magnet}
+ at item @image{images/it_meditation_bump, 12mm} @tab @yref{it_meditation}_bump
+ at tab @image{images/it_meditation_caldera, 12mm} @tab @yref{it_meditation}_caledera
+ at tab @image{images/it_meditation_dent, 12mm} @tab @yref{it_meditation}_dent
+ at item @image{images/it_meditation_hill, 12mm} @tab @yref{it_meditation}_hill
+ at tab @image{images/it_meditation_hollow, 12mm} @tab @yref{it_meditation}_hollow
+ at tab @image{images/it_meditation_volcano, 12mm} @tab @yref{it_meditation}_volcano
+ at item @image{images/it_pencil, 12mm} @tab @yref{it_pencil}
+ at tab @image{images/it_pin, 12mm} @tab @yref{it_pin}
+ at tab @image{images/it_pipe, 12mm} @tab @yref{it_pipe}
+ at item @image{images/it_puller, 12mm} @tab @yref{it_puller}
+ at tab @image{images/it_ring, 12mm} @tab @yref{it_ring}
+ at tab @image{images/it_rubberband, 12mm} @tab @yref{it_rubberband}
+ at item @image{images/it_seed, 12mm} @tab @yref{it_seed}
+ at tab @image{images/it_sensor, 12mm} @tab @yref{it_sensor}
+ at tab @image{images/it_sensor_exit, 12mm} @tab @yref{it_sensor}_exit
+ at item @image{images/it_shogun_m, 12mm} @tab @yref{it_shogun}
+ at tab @image{images/it_spade, 12mm} @tab @yref{it_spade}
+ at tab @image{images/it_spoon, 12mm} @tab @yref{it_spoon}
+ at item @image{images/it_springboard, 12mm} @tab @yref{it_springboard}
+ at tab @image{images/it_spring_drop, 12mm} @tab @yref{it_spring}_drop
+ at tab @image{images/it_spring_keep, 12mm} @tab @yref{it_spring}_keep
+ at item @image{images/it_squashed, 12mm} @tab @yref{it_squashed}
+ at tab @image{images/it_strip, 12mm} @tab @yref{it_strip}
+ at tab @image{images/it_surprise, 12mm} @tab @yref{it_surprise}
+ at item @image{images/it_sword, 12mm} @tab @yref{it_sword}
+ at tab @image{images/it_trap, 12mm} @tab @yref{it_trap}
+ at tab @image{images/it_trigger, 12mm} @tab @yref{it_trigger}
+ at item @image{images/it_umbrella, 12mm} @tab @yref{it_umbrella}
+ at tab @image{images/it_vortex, 12mm} @tab @yref{it_vortex}
+ at tab @image{images/it_weight, 12mm} @tab @yref{it_weight}
+ at item @image{images/it_wormhole, 12mm} @tab @yref{it_wormhole}
+ at tab @image{images/it_wrench, 12mm} @tab @yref{it_wrench}
+ at tab @image{images/it_yinyang, 12mm} @tab @yref{it_yinyang}
 @end multitable
 
 @c ----------------- Item Attributes --------------------
@@ -11403,7 +11399,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_bag, @oisize{}} @b{it_bag}
+ at item @image{images/it_bag, 12mm} @b{it_bag}
 @end table
 @end table
 
@@ -11427,7 +11423,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_banana, @oisize{}} @b{it_banana}
+ at item @image{images/it_banana, 12mm} @b{it_banana}
 @end table
 @end table
 
@@ -11480,9 +11476,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_bottle_idle, @oisize{}} @b{it_bottle}: state = @code{IDLE}
- at item @image{images/it_bottle_idle, @oisize{}} @b{it_bottle_idle}: state = @code{IDLE}
- at item @image{images/it_bottle_broken, @oisize{}} @b{it_bottle_broken}: state = @code{BROKEN}
+ at item @image{images/it_bottle_idle, 12mm} @b{it_bottle}: state = @code{IDLE}
+ at item @image{images/it_bottle_idle, 12mm} @b{it_bottle_idle}: state = @code{IDLE}
+ at item @image{images/it_bottle_broken, 12mm} @b{it_bottle_broken}: state = @code{BROKEN}
 @end table
 
 @end table
@@ -11527,7 +11523,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_brake, @oisize{}} @b{it_brake}
+ at item @image{images/st_brake, 12mm} @b{it_brake}
 @end table
 
 @end table
@@ -11573,7 +11569,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_brush, @oisize{}} @b{it_brush}
+ at item @image{images/it_brush, 12mm} @b{it_brush}
 @end table
 
 @end table
@@ -11606,7 +11602,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_cherry, @oisize{}} @b{it_cherry}
+ at item @image{images/it_cherry, 12mm} @b{it_cherry}
 @end table
 @end table
 
@@ -11629,7 +11625,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_coffee, @oisize{}} @b{it_coffee}
+ at item @image{images/it_coffee, 12mm} @b{it_coffee}
 @end table
 @end table
 
@@ -11670,10 +11666,10 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_coin_s, @oisize{}} @b{it_coin}: state = @code{SMALL}
- at item @image{images/it_coin_s, @oisize{}} @b{it_coin_s}: state = @code{SMALL}
- at item @image{images/it_coin_m, @oisize{}} @b{it_coin_m}: state = @code{MEDIUM}
- at item @image{images/it_coin_l, @oisize{}} @b{it_coin_l}: state = @code{LARGE}
+ at item @image{images/it_coin_s, 12mm} @b{it_coin}: state = @code{SMALL}
+ at item @image{images/it_coin_s, 12mm} @b{it_coin_s}: state = @code{SMALL}
+ at item @image{images/it_coin_m, 12mm} @b{it_coin_m}: state = @code{MEDIUM}
+ at item @image{images/it_coin_l, 12mm} @b{it_coin_l}: state = @code{LARGE}
 @end table
 
 @end table
@@ -11711,7 +11707,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_document, @oisize{}} @b{it_document}
+ at item @image{images/it_document, 12mm} @b{it_document}
 @end table
 @end table
 
@@ -11746,7 +11742,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_drop, @oisize{}} @b{it_drop}
+ at item @image{images/it_drop, 12mm} @b{it_drop}
 @end table
 
 @end table
@@ -11801,8 +11797,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_dynamite, @oisize{}} @b{it_dynamite}: state = @code{IDLE}
- at item @image{images/fl_white, @oisize{}} @b{it_dynamite_burning}: state = @code{ACTIVE}
+ at item @image{images/it_dynamite, 12mm} @b{it_dynamite}: state = @code{IDLE}
+ at item @image{images/fl_white, 12mm} @b{it_dynamite_burning}: state = @code{ACTIVE}
 @end table
 
 @end table
@@ -11847,10 +11843,10 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_extinguisher, @oisize{}} @b{it_extinguisher}: state = @code{FULL}
- at item @image{images/it_extinguisher, @oisize{}} @b{it_extinguisher_empty}: state = @code{FULL}
- at item @image{images/fl_white, @oisize{}} @b{it_extinguisher_medium}: state = @code{MEDIUM}
- at item @image{images/fl_white, @oisize{}} @b{it_extinguisher_full}: state = @code{FULL}
+ at item @image{images/it_extinguisher, 12mm} @b{it_extinguisher}: state = @code{FULL}
+ at item @image{images/it_extinguisher, 12mm} @b{it_extinguisher_empty}: state = @code{FULL}
+ at item @image{images/fl_white, 12mm} @b{it_extinguisher_medium}: state = @code{MEDIUM}
+ at item @image{images/fl_white, 12mm} @b{it_extinguisher_full}: state = @code{FULL}
 @end table
 
 @end table
@@ -11883,8 +11879,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_extralife, @oisize{}} @b{it_extralife}
- at item @image{images/it_extralife, @oisize{}} @b{it_extralife_new}: An extralife that is immune to light destruction for a short latency period.
+ at item @image{images/it_extralife, 12mm} @b{it_extralife}
+ at item @image{images/it_extralife, 12mm} @b{it_extralife_new}: An extralife that is immune to light destruction for a short latency period.
 @end table
 
 @end table
@@ -11916,9 +11912,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_flag_black, @oisize{}} @b{it_flag}: color = @code{BLACK}
- at item @image{images/it_flag_black, @oisize{}} @b{it_flag_black}: color = @code{BLACK}
- at item @image{images/it_flag_white, @oisize{}} @b{it_flag_white}: color = @code{WHITE}
+ at item @image{images/it_flag_black, 12mm} @b{it_flag}: color = @code{BLACK}
+ at item @image{images/it_flag_black, 12mm} @b{it_flag_black}: color = @code{BLACK}
+ at item @image{images/it_flag_white, 12mm} @b{it_flag_white}: color = @code{WHITE}
 @end table
 @end table
 
@@ -11940,7 +11936,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_floppy, @oisize{}} @b{it_floppy}
+ at item @image{images/it_floppy, 12mm} @b{it_floppy}
 @end table
 
 @end table
@@ -11993,8 +11989,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_glasses, @oisize{}} @b{it_glasses} Active glasses item.
- at item @image{images/it_glasses_broken, @oisize{}} @b{it_glasses_broken} Broken glasses that spot nothing.
+ at item @image{images/it_glasses, 12mm} @b{it_glasses} Active glasses item.
+ at item @image{images/it_glasses_broken, 12mm} @b{it_glasses_broken} Broken glasses that spot nothing.
 @end table
 
 @end table
@@ -12029,8 +12025,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_hammer, @oisize{}} @b{it_hammer} A standard hammer item.
- at item @image{images/it_hammer, @oisize{}} @b{it_hammer_new} A hammer that is immune to light transformations for a short latency period.
+ at item @image{images/it_hammer, 12mm} @b{it_hammer} A standard hammer item.
+ at item @image{images/it_hammer, 12mm} @b{it_hammer_new} A hammer that is immune to light transformations for a short latency period.
 @end table
 
 @end table
@@ -12061,7 +12057,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_key, @oisize{}} @b{it_key}
+ at item @image{images/it_key, 12mm} @b{it_key}
 @end table
 @end table
 
@@ -12098,7 +12094,7 @@
 @item @b{Action:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_magicwand, @oisize{}} @b{it_magicwand}
+ at item @image{images/it_magicwand, 12mm} @b{it_magicwand}
 @end table
 
 @end table
@@ -12134,7 +12130,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_pencil, @oisize{}} @b{it_pencil}
+ at item @image{images/it_pencil, 12mm} @b{it_pencil}
 @end table
 
 @end table
@@ -12165,7 +12161,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_pin, @oisize{}} @b{it_pin}
+ at item @image{images/it_pin, 12mm} @b{it_pin}
 @end table
 
 @end table
@@ -12202,17 +12198,17 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_white, @oisize{}} @b{it_pipe} connections = @code{"ew"} The horizontal pipe.
- at item @image{images/fl_white, @oisize{}} @b{it_pipe_w} connections = @code{"w"}
- at item @image{images/fl_white, @oisize{}} @b{it_pipe_s} connections = @code{"s"}
- at item @image{images/fl_white, @oisize{}} @b{it_pipe_sw} connections = @code{"sw"}
- at item @image{images/it_pipe, @oisize{}} @b{it_pipe_e} connections = @code{"e"}
- at item @image{images/fl_white, @oisize{}} @b{it_pipe_ew} connections = @code{"ew"} The horizontal pipe.
- at item @image{images/fl_white, @oisize{}} @b{it_pipe_es} connections = @code{"es"}
- at item @image{images/fl_white, @oisize{}} @b{it_pipe_n} connections = @code{"n"}
- at item @image{images/fl_white, @oisize{}} @b{it_pipe_nw} connections = @code{"nw"}
- at item @image{images/fl_white, @oisize{}} @b{it_pipe_ns} connections = @code{"ns"} The vertical pipe.
- at item @image{images/fl_white, @oisize{}}@b{it_pipe_ne} connections = @code{"ne"}
+ at item @image{images/fl_white, 12mm} @b{it_pipe} connections = @code{"ew"} The horizontal pipe.
+ at item @image{images/fl_white, 12mm} @b{it_pipe_w} connections = @code{"w"}
+ at item @image{images/fl_white, 12mm} @b{it_pipe_s} connections = @code{"s"}
+ at item @image{images/fl_white, 12mm} @b{it_pipe_sw} connections = @code{"sw"}
+ at item @image{images/it_pipe, 12mm} @b{it_pipe_e} connections = @code{"e"}
+ at item @image{images/fl_white, 12mm} @b{it_pipe_ew} connections = @code{"ew"} The horizontal pipe.
+ at item @image{images/fl_white, 12mm} @b{it_pipe_es} connections = @code{"es"}
+ at item @image{images/fl_white, 12mm} @b{it_pipe_n} connections = @code{"n"}
+ at item @image{images/fl_white, 12mm} @b{it_pipe_nw} connections = @code{"nw"}
+ at item @image{images/fl_white, 12mm} @b{it_pipe_ns} connections = @code{"ns"} The vertical pipe.
+ at item @image{images/fl_white, 12mm}@b{it_pipe_ne} connections = @code{"ne"}
 @end table
 @end table
 
@@ -12247,11 +12243,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_white, @oisize{}} @b{it_puller} orientation = @code{WEST}
- at item @image{images/fl_white, @oisize{}} @b{it_puller_w} orientation = @code{WEST}
- at item @image{images/fl_white, @oisize{}} @b{it_puller_s} orientation = @code{SOUTH}
- at item @image{images/fl_white, @oisize{}} @b{it_puller_e} orientation = @code{EAST}
- at item @image{images/it_puller, @oisize{}} @b{it_puller_n} orientation = @code{NORTH}
+ at item @image{images/fl_white, 12mm} @b{it_puller} orientation = @code{WEST}
+ at item @image{images/fl_white, 12mm} @b{it_puller_w} orientation = @code{WEST}
+ at item @image{images/fl_white, 12mm} @b{it_puller_s} orientation = @code{SOUTH}
+ at item @image{images/fl_white, 12mm} @b{it_puller_e} orientation = @code{EAST}
+ at item @image{images/it_puller, 12mm} @b{it_puller_n} orientation = @code{NORTH}
 @end table
 @end table
 
@@ -12289,7 +12285,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_ring, @oisize{}} @b{it_ring}
+ at item @image{images/it_ring, 12mm} @b{it_ring}
 @end table
 
 @end table
@@ -12348,7 +12344,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_rubberband, @oisize{}} @b{it_rubberband}
+ at item @image{images/it_rubberband, 12mm} @b{it_rubberband}
 @end table
 @end table
 
@@ -12401,11 +12397,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_seed, @oisize{}} @b{it_seed} flavor = @code{"wood"}
- at item @image{images/it_seed, @oisize{}} @b{it_seed_wood} flavor = @code{"wood"}
- at item @image{images/it_seed, @oisize{}} @b{it_seed_hay} flavor = @code{"hay"}
- at item @image{images/it_seed, @oisize{}} @b{it_seed_greenbrown} flavor = @code{"greenbrown"}
- at item @image{images/it_seed, @oisize{}} @b{it_seed_volcano} flavor = @code{"volcano"}
+ at item @image{images/it_seed, 12mm} @b{it_seed} flavor = @code{"wood"}
+ at item @image{images/it_seed, 12mm} @b{it_seed_wood} flavor = @code{"wood"}
+ at item @image{images/it_seed, 12mm} @b{it_seed_hay} flavor = @code{"hay"}
+ at item @image{images/it_seed, 12mm} @b{it_seed_greenbrown} flavor = @code{"greenbrown"}
+ at item @image{images/it_seed, 12mm} @b{it_seed_volcano} flavor = @code{"volcano"}
 @end table
 
 @end table
@@ -12429,7 +12425,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_spade, @oisize{}} @b{it_spade}
+ at item @image{images/it_spade, 12mm} @b{it_spade}
 @end table
 
 @end table
@@ -12461,7 +12457,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_spoon, @oisize{}} @b{it_spoon}
+ at item @image{images/it_spoon, 12mm} @b{it_spoon}
 @end table
 
 @end table
@@ -12488,9 +12484,9 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_spring_keep, @oisize{}} @b{it_spring}
- at item @image{images/it_spring_keep, @oisize{}} @b{it_spring_keep}
- at item @image{images/it_spring_drop, @oisize{}} @b{it_spring_drop}
+ at item @image{images/it_spring_keep, 12mm} @b{it_spring}
+ at item @image{images/it_spring_keep, 12mm} @b{it_spring_keep}
+ at item @image{images/it_spring_drop, 12mm} @b{it_spring_drop}
 @end table
 @end table
 
@@ -12539,7 +12535,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_surprise, @oisize{}} @b{it_surprise}
+ at item @image{images/it_surprise, 12mm} @b{it_surprise}
 @end table
 
 @end table
@@ -12572,8 +12568,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_sword, @oisize{}} @b{it_sword} A standard sword item.
- at item @image{images/it_sword, @oisize{}} @b{it_sword_new} A sword that is immune to light transformations for a short latency period.
+ at item @image{images/it_sword, 12mm} @b{it_sword} A standard sword item.
+ at item @image{images/it_sword, 12mm} @b{it_sword_new} A sword that is immune to light transformations for a short latency period.
 @end table
 
 @end table
@@ -12612,8 +12608,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_umbrella, @oisize{}} @b{it_umbrella} A standard umbrella item.
- at item @image{images/it_umbrella, @oisize{}} @b{it_umbrella_new} An umbrella that is immune to light destruction for a short latency period.
+ at item @image{images/it_umbrella, 12mm} @b{it_umbrella} A standard umbrella item.
+ at item @image{images/it_umbrella, 12mm} @b{it_umbrella_new} An umbrella that is immune to light destruction for a short latency period.
 @end table
 
 @end table
@@ -12648,7 +12644,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_weight, @oisize{}} @b{it_weight}
+ at item @image{images/it_weight, 12mm} @b{it_weight}
 @end table
 
 @end table
@@ -12675,7 +12671,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_wrench, @oisize{}} @b{it_wrench}
+ at item @image{images/it_wrench, 12mm} @b{it_wrench}
 @end table
 
 @end table
@@ -12707,7 +12703,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_yinyang, @oisize{}} @b{it_yinyang}
+ at item @image{images/it_yinyang, 12mm} @b{it_yinyang}
 @end table
 
 @end table
@@ -12813,9 +12809,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_blocker, @oisize{}} @b{it_blocker}
+ at item @image{images/it_blocker, 12mm} @b{it_blocker}
 A standard blocker item.
- at item @image{images/it_blocker, @oisize{}} @b{it_blocker_new}
+ at item @image{images/it_blocker, 12mm} @b{it_blocker_new}
 A blocker that just finished shrinking. Mainly used internally as the direct
 successor of an @ref{st_blocker}. But it may be useful to generate an initial
 snapshot of a moving boulder over a blocker line, too. See example levels.
@@ -12873,9 +12869,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_bomb_black, @oisize{}} @b{it_bomb}: color = @code{BLACK}
- at item @image{images/it_bomb_black, @oisize{}} @b{it_bomb_black}: color = @code{BLACK}
- at item @image{images/it_bomb_white, @oisize{}} @b{it_bomb_white}: color = @code{WHITE}
+ at item @image{images/it_bomb_black, 12mm} @b{it_bomb}: color = @code{BLACK}
+ at item @image{images/it_bomb_black, 12mm} @b{it_bomb_black}: color = @code{BLACK}
+ at item @image{images/it_bomb_white, 12mm} @b{it_bomb_white}: color = @code{WHITE}
 @end table
 
 @end table
@@ -12936,13 +12932,13 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_white, @oisize{}} @b{it_burnable}: state = @code{0}
- at item @image{images/fl_white, @oisize{}} @b{it_burnable_invisible}: state = @code{0}
- at item @image{images/it_burnable_oil, @oisize{}} @b{it_burnable_oil}: state = @code{1}
- at item @image{images/fl_white, @oisize{}} @b{it_burnable_ignited}: state = @code{2}
- at item @image{images/it_burnable_burning, @oisize{}} @b{it_burnable_burning}: state = @code{3}
- at item @image{images/it_burnable_ash, @oisize{}} @b{it_burnable_ash}: state = @code{4}
- at item @image{images/it_burnable_fireproof, @oisize{}} @b{it_burnable_fireproof}: state = @code{5}
+ at item @image{images/fl_white, 12mm} @b{it_burnable}: state = @code{0}
+ at item @image{images/fl_white, 12mm} @b{it_burnable_invisible}: state = @code{0}
+ at item @image{images/it_burnable_oil, 12mm} @b{it_burnable_oil}: state = @code{1}
+ at item @image{images/fl_white, 12mm} @b{it_burnable_ignited}: state = @code{2}
+ at item @image{images/it_burnable_burning, 12mm} @b{it_burnable_burning}: state = @code{3}
+ at item @image{images/it_burnable_ash, 12mm} @b{it_burnable_ash}: state = @code{4}
+ at item @image{images/it_burnable_fireproof, 12mm} @b{it_burnable_fireproof}: state = @code{5}
 @end table
 
 @end table
@@ -13032,11 +13028,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_crack_abyss, @oisize{}} @b{it_crack}: state = @code{SMALL}
- at item @image{images/fl_white, @oisize{}} @b{it_crack_i}: state = @code{INVISIBLE}
- at item @image{images/it_crack_abyss, @oisize{}} @b{it_crack_s}: state = @code{SMALL}
- at item @image{images/fl_white, @oisize{}} @b{it_crack_m}: state = @code{MEDIUM}
- at item @image{images/fl_white, @oisize{}} @b{it_crack_l}: state = @code{LARGE}
+ at item @image{images/it_crack_abyss, 12mm} @b{it_crack}: state = @code{SMALL}
+ at item @image{images/fl_white, 12mm} @b{it_crack_i}: state = @code{INVISIBLE}
+ at item @image{images/it_crack_abyss, 12mm} @b{it_crack_s}: state = @code{SMALL}
+ at item @image{images/fl_white, 12mm} @b{it_crack_m}: state = @code{MEDIUM}
+ at item @image{images/fl_white, 12mm} @b{it_crack_l}: state = @code{LARGE}
 @end table
 
 @end table
@@ -13077,7 +13073,7 @@
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_cross, @oisize{}} @b{it_cross}
+ at item @image{images/it_cross, 12mm} @b{it_cross}
 @end table
 @end table
 
@@ -13109,7 +13105,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_death, @oisize{}} @b{it_death}
+ at item @image{images/it_death, 12mm} @b{it_death}
 @end table
 
 @end table
@@ -13150,11 +13146,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_explosion, @oisize{}} @b{it_explosion}: state = @code{0}
- at item @image{images/it_explosion, @oisize{}} @b{it_explosion_nil}: state = @code{0}
- at item @image{images/it_explosion, @oisize{}} @b{it_explosion_hollow}: state = @code{1}
- at item @image{images/it_explosion, @oisize{}} @b{it_explosion_crack}: state = @code{2}
- at item @image{images/it_explosion, @oisize{}} @b{it_explosion_debris}: state = @code{3}
+ at item @image{images/it_explosion, 12mm} @b{it_explosion}: state = @code{0}
+ at item @image{images/it_explosion, 12mm} @b{it_explosion_nil}: state = @code{0}
+ at item @image{images/it_explosion, 12mm} @b{it_explosion_hollow}: state = @code{1}
+ at item @image{images/it_explosion, 12mm} @b{it_explosion_crack}: state = @code{2}
+ at item @image{images/it_explosion, 12mm} @b{it_explosion_debris}: state = @code{3}
 @end table
 
 @end table
@@ -13187,7 +13183,7 @@
 @item @b{Action:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_landmine, @oisize{}} @b{it_landmine}
+ at item @image{images/it_landmine, 12mm} @b{it_landmine}
 @end table
 
 @end table
@@ -13213,7 +13209,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_laser, @oisize{}} @b{it_laserbeam} can not be instanciated by levels
+ at item @image{images/it_laser, 12mm} @b{it_laserbeam} can not be instanciated by levels
 @end table
 @end table
 
@@ -13266,9 +13262,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_magnet_off, @oisize{}} @b{it_magnet} state = @samp{OFF}.
- at item @image{images/it_magnet_on, @oisize{}} @b{it_magnet_on} state = @samp{ON}.
- at item @image{images/it_magnet_off, @oisize{}} @b{it_magnet_off} state = @samp{OFF}.
+ at item @image{images/it_magnet_off, 12mm} @b{it_magnet} state = @samp{OFF}.
+ at item @image{images/it_magnet_on, 12mm} @b{it_magnet_on} state = @samp{ON}.
+ at item @image{images/it_magnet_off, 12mm} @b{it_magnet_off} state = @samp{OFF}.
 @end table
 
 @end table
@@ -13354,13 +13350,13 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_meditation_hollow, @oisize{}} @b{it_meditation} state = @code{MEDITATION_HOLLOW}
- at item @image{images/it_meditation_caldera, @oisize{}} @b{it_meditation_caldera} state = @code{MEDITATION_CALDERA}
- at item @image{images/it_meditation_hollow, @oisize{}} @b{it_meditation_hollow} state = @code{MEDITATION_HOLLOW}
- at item @image{images/it_meditation_dent, @oisize{}} @b{it_meditation_dent} state = @code{MEDITATION_DENT}
- at item @image{images/it_meditation_bump, @oisize{}} @b{it_meditation_bump} state = @code{MEDITATION_BUMP}
- at item @image{images/it_meditation_hill, @oisize{}} @b{it_meditation_hill} state = @code{MEDITATION_HILL}
- at item @image{images/it_meditation_volcano, @oisize{}} @b{it_meditation_volcano} state = @code{MEDITATION_VOLCANO}
+ at item @image{images/it_meditation_hollow, 12mm} @b{it_meditation} state = @code{MEDITATION_HOLLOW}
+ at item @image{images/it_meditation_caldera, 12mm} @b{it_meditation_caldera} state = @code{MEDITATION_CALDERA}
+ at item @image{images/it_meditation_hollow, 12mm} @b{it_meditation_hollow} state = @code{MEDITATION_HOLLOW}
+ at item @image{images/it_meditation_dent, 12mm} @b{it_meditation_dent} state = @code{MEDITATION_DENT}
+ at item @image{images/it_meditation_bump, 12mm} @b{it_meditation_bump} state = @code{MEDITATION_BUMP}
+ at item @image{images/it_meditation_hill, 12mm} @b{it_meditation_hill} state = @code{MEDITATION_HILL}
+ at item @image{images/it_meditation_volcano, 12mm} @b{it_meditation_volcano} state = @code{MEDITATION_VOLCANO}
 @end table
 
 @end table
@@ -13413,8 +13409,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_sensor, @oisize{}} @b{it_sensor}: exit = @code{false}
- at item @image{images/it_sensor_exit, @oisize{}} @b{it_sensor_exit}: exit = @code{true}
+ at item @image{images/it_sensor, 12mm} @b{it_sensor}: exit = @code{false}
+ at item @image{images/it_sensor_exit, 12mm} @b{it_sensor_exit}: exit = @code{true}
 @end table
 
 @end table
@@ -13463,10 +13459,10 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_shogun_s, @oisize{}} @b{it_shogun}: flavor = @code{"s"}
- at item @image{images/it_shogun_s, @oisize{}} @b{it_shogun_s}: flavor = @code{"s"}
- at item @image{images/it_shogun_m, @oisize{}} @b{it_shogun_m}: flavor = @code{"m"}
- at item @image{images/it_shogun_l, @oisize{}} @b{it_shogun_l}: flavor = @code{"l"}
+ at item @image{images/it_shogun_s, 12mm} @b{it_shogun}: flavor = @code{"s"}
+ at item @image{images/it_shogun_s, 12mm} @b{it_shogun_s}: flavor = @code{"s"}
+ at item @image{images/it_shogun_m, 12mm} @b{it_shogun_m}: flavor = @code{"m"}
+ at item @image{images/it_shogun_l, 12mm} @b{it_shogun_l}: flavor = @code{"l"}
 @end table
 
 @end table
@@ -13493,7 +13489,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_springboard, @oisize{}} @b{it_springboard}
+ at item @image{images/it_springboard, 12mm} @b{it_springboard}
 @end table
 
 @end table
@@ -13520,7 +13516,7 @@
 @item @b{Messages:} none
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_squashed, @oisize{}} @b{it_squashed}
+ at item @image{images/it_squashed, 12mm} @b{it_squashed}
 @end table
 @end table
 
@@ -13564,22 +13560,22 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_strip, @oisize{}} @b{it_strip}: connections = @code{""}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_w}: connections = @code{"w"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_s}: connections = @code{"s"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_sw}: connections = @code{"sw"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_e}: connections = @code{"e"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_ew}: connections = @code{"ew"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_es}: connections = @code{"es"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_esw}: connections = @code{"esw"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_n}: connections = @code{"n"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_nw}: connections = @code{"nw"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_ns}: connections = @code{"ns"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_nsw}: connections = @code{"nsw"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_ne}: connections = @code{"ne"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_new}: connections = @code{"new"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_nes}: connections = @code{"nes"}
- at item @image{images/fl_white, @oisize{}} @b{it_strip_nesw}: connections = @code{"nesw"}
+ at item @image{images/it_strip, 12mm} @b{it_strip}: connections = @code{""}
+ at item @image{images/fl_white, 12mm} @b{it_strip_w}: connections = @code{"w"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_s}: connections = @code{"s"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_sw}: connections = @code{"sw"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_e}: connections = @code{"e"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_ew}: connections = @code{"ew"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_es}: connections = @code{"es"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_esw}: connections = @code{"esw"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_n}: connections = @code{"n"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_nw}: connections = @code{"nw"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_ns}: connections = @code{"ns"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_nsw}: connections = @code{"nsw"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_ne}: connections = @code{"ne"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_new}: connections = @code{"new"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_nes}: connections = @code{"nes"}
+ at item @image{images/fl_white, 12mm} @b{it_strip_nesw}: connections = @code{"nesw"}
 
 @end table
 
@@ -13627,7 +13623,7 @@
 @end table
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_trap, @oisize{}} @b{it_trap}
+ at item @image{images/it_trap, 12mm} @b{it_trap}
 @end table
 
 @end table
@@ -13686,7 +13682,7 @@
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_trigger, @oisize{}} @b{it_trigger}
+ at item @image{images/it_trigger, 12mm} @b{it_trigger}
 @end table
 
 @end table
@@ -13772,9 +13768,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_vortex, @oisize{}} @b{it_vortex}:  state = @code{OPEN}.
- at item @image{images/it_vortex, @oisize{}} @b{it_vortex_open}: state = @code{OPEN}.
- at item @image{images/fl_white, @oisize{}} @b{it_vortex_closed}: state @samp{CLOSED}.
+ at item @image{images/it_vortex, 12mm} @b{it_vortex}:  state = @code{OPEN}.
+ at item @image{images/it_vortex, 12mm} @b{it_vortex_open}: state = @code{OPEN}.
+ at item @image{images/fl_white, 12mm} @b{it_vortex_closed}: state @samp{CLOSED}.
 @end table
 @end table
 
@@ -13847,9 +13843,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/it_wormhole, @oisize{}} @b{it_wormhole}: state = @code{OFF}.
- at item @image{images/it_wormhole, @oisize{}} @b{it_wormhole_on}: state = @code{ON}.
- at item @image{images/fl_white, @oisize{}} @b{it_wormhole_off}: state @code{OFF}.
+ at item @image{images/it_wormhole, 12mm} @b{it_wormhole}: state = @code{OFF}.
+ at item @image{images/it_wormhole, 12mm} @b{it_wormhole_on}: state = @code{ON}.
+ at item @image{images/fl_white, 12mm} @b{it_wormhole_off}: state @code{OFF}.
 @end table
 @end table
 
@@ -13873,86 +13869,86 @@
 
 WORK IN PROGRESS - The follwing table is still incomplete!
 @multitable @columnfractions .08 .25 .08 .25 .09 .25
- at item @image{images/st_actorimpulse, @oisize{}} @tab @yref{st_actorimpulse}
- at tab @image{images/st_ancient, @oisize{}} @tab @yref{st_ancient}
- at tab @image{images/st_beads, @oisize{}} @tab @yref{st_beads}
- at item @image{images/st_bluegray, @oisize{}} @tab @yref{st_bluegray}
- at tab @image{images/st_blur_cross, @oisize{}} @tab @yref{st_blur}_cross
- at tab @image{images/st_blur_straight, @oisize{}} @tab @yref{st_blur}_straight
- at item @image{images/st_box_hay, @oisize{}} @tab @yref{st_box}_hay
- at tab @image{images/st_box_rock, @oisize{}} @tab @yref{st_box}_rock
- at tab @image{images/st_box_wood, @oisize{}} @tab @yref{st_box}_wood
- at item @image{images/st_brake, @oisize{}} @tab @yref{st_brake}
- at tab @image{images/st_break_black, @oisize{}} @tab @yref{st_break}_black
- at tab @image{images/st_break_boulder, @oisize{}} @tab @yref{st_break}_boulder
- at item @image{images/st_break_bug, @oisize{}} @tab @yref{st_break}_bug
- at tab @image{images/st_break_oxydc, @oisize{}} @tab @yref{st_break}_oxydc
- at tab @image{images/st_break_plain, @oisize{}} @tab @yref{st_break}_plain
- at item @image{images/st_break_white, @oisize{}} @tab @yref{st_break}_white
- at tab @image{images/st_brownie, @oisize{}} @tab @yref{st_brownie}
- at tab @image{images/st_brownmarble, @oisize{}} @tab @yref{st_brownmarble}
- at item @image{images/st_brownpyramide, @oisize{}} @tab @yref{st_brownpyramide}
- at tab @image{images/st_camouflage, @oisize{}} @tab @yref{st_camouflage}
- at tab @image{images/st_charge_minus, @oisize{}} @tab @yref{st_charge}_minus
- at item @image{images/st_charge_plus, @oisize{}} @tab @yref{st_charge}_plus
- at tab @image{images/st_charge_zero, @oisize{}} @tab @yref{st_charge}_zero
- at tab @image{images/st_chess_black, @oisize{}} @tab @yref{st_chess}_black
- at item @image{images/st_chess_white, @oisize{}} @tab @yref{st_chess}_white
- at tab @image{images/st_concrete, @oisize{}} @tab @yref{st_concrete}
- at tab @image{images/st_darkglass, @oisize{}} @tab @yref{st_darkglass}
- at item @image{images/st_darkgray, @oisize{}} @tab @yref{st_darkgray}
- at tab @image{images/st_death, @oisize{}} @tab @yref{st_death}
- at tab @image{images/st_dispenser_bombblack, @oisize{}} @tab @yref{st_dispenser}_bombblack
- at item @image{images/st_dispenser_bombwhite, @oisize{}} @tab @yref{st_dispenser}_bombwhite
- at tab @image{images/st_dispenser_dynamite, @oisize{}} @tab @yref{st_dispenser}_dynamite
- at tab @image{images/st_flash, @oisize{}} @tab @yref{st_flash}
- at item @image{images/st_flat, @oisize{}} @tab @yref{st_flat}
- at tab @image{images/st_fourswitch, @oisize{}} @tab @yref{st_fourswitch}
- at tab @image{images/st_granite, @oisize{}} @tab @yref{st_granite}
- at item @image{images/st_grate_cross, @oisize{}} @tab @yref{st_grate}_cross
- at tab @image{images/st_grate_framed, @oisize{}} @tab @yref{st_grate}_framed
- at tab @image{images/st_greenbrown, @oisize{}} @tab @yref{st_greenbrown}
- at item @image{images/st_greengray, @oisize{}} @tab @yref{st_greengray}
- at tab @image{images/st_ice, @oisize{}} @tab @yref{st_ice}
+ at item @image{images/st_actorimpulse, 12mm} @tab @yref{st_actorimpulse}
+ at tab @image{images/st_ancient, 12mm} @tab @yref{st_ancient}
+ at tab @image{images/st_beads, 12mm} @tab @yref{st_beads}
+ at item @image{images/st_bluegray, 12mm} @tab @yref{st_bluegray}
+ at tab @image{images/st_blur_cross, 12mm} @tab @yref{st_blur}_cross
+ at tab @image{images/st_blur_straight, 12mm} @tab @yref{st_blur}_straight
+ at item @image{images/st_box_hay, 12mm} @tab @yref{st_box}_hay
+ at tab @image{images/st_box_rock, 12mm} @tab @yref{st_box}_rock
+ at tab @image{images/st_box_wood, 12mm} @tab @yref{st_box}_wood
+ at item @image{images/st_brake, 12mm} @tab @yref{st_brake}
+ at tab @image{images/st_break_black, 12mm} @tab @yref{st_break}_black
+ at tab @image{images/st_break_boulder, 12mm} @tab @yref{st_break}_boulder
+ at item @image{images/st_break_bug, 12mm} @tab @yref{st_break}_bug
+ at tab @image{images/st_break_oxydc, 12mm} @tab @yref{st_break}_oxydc
+ at tab @image{images/st_break_plain, 12mm} @tab @yref{st_break}_plain
+ at item @image{images/st_break_white, 12mm} @tab @yref{st_break}_white
+ at tab @image{images/st_brownie, 12mm} @tab @yref{st_brownie}
+ at tab @image{images/st_brownmarble, 12mm} @tab @yref{st_brownmarble}
+ at item @image{images/st_brownpyramide, 12mm} @tab @yref{st_brownpyramide}
+ at tab @image{images/st_camouflage, 12mm} @tab @yref{st_camouflage}
+ at tab @image{images/st_charge_minus, 12mm} @tab @yref{st_charge}_minus
+ at item @image{images/st_charge_plus, 12mm} @tab @yref{st_charge}_plus
+ at tab @image{images/st_charge_zero, 12mm} @tab @yref{st_charge}_zero
+ at tab @image{images/st_chess_black, 12mm} @tab @yref{st_chess}_black
+ at item @image{images/st_chess_white, 12mm} @tab @yref{st_chess}_white
+ at tab @image{images/st_concrete, 12mm} @tab @yref{st_concrete}
+ at tab @image{images/st_darkglass, 12mm} @tab @yref{st_darkglass}
+ at item @image{images/st_darkgray, 12mm} @tab @yref{st_darkgray}
+ at tab @image{images/st_death, 12mm} @tab @yref{st_death}
+ at tab @image{images/st_dispenser_bombblack, 12mm} @tab @yref{st_dispenser}_bombblack
+ at item @image{images/st_dispenser_bombwhite, 12mm} @tab @yref{st_dispenser}_bombwhite
+ at tab @image{images/st_dispenser_dynamite, 12mm} @tab @yref{st_dispenser}_dynamite
+ at tab @image{images/st_flash, 12mm} @tab @yref{st_flash}
+ at item @image{images/st_flat, 12mm} @tab @yref{st_flat}
+ at tab @image{images/st_fourswitch, 12mm} @tab @yref{st_fourswitch}
+ at tab @image{images/st_granite, 12mm} @tab @yref{st_granite}
+ at item @image{images/st_grate_cross, 12mm} @tab @yref{st_grate}_cross
+ at tab @image{images/st_grate_framed, 12mm} @tab @yref{st_grate}_framed
+ at tab @image{images/st_greenbrown, 12mm} @tab @yref{st_greenbrown}
+ at item @image{images/st_greengray, 12mm} @tab @yref{st_greengray}
+ at tab @image{images/st_ice, 12mm} @tab @yref{st_ice}
 @tab                            @tab @yref{st_invisible}
- at item @image{images/st_jamb_black, @oisize{}} @tab @yref{st_jamb}_black
- at tab @image{images/st_jamb_white, @oisize{}} @tab @yref{st_jamb}_white
- at tab @image{images/st_knight, @oisize{}} @tab @yref{st_knight}
- at item @image{images/st_lightglass, @oisize{}} @tab @yref{st_lightglass}
- at tab @image{images/st_lightpassenger, @oisize{}} @tab @yref{st_lightpassenger}
- at tab @image{images/st_metal, @oisize{}} @tab @yref{st_metal}
- at item @image{images/st_oxyda, @oisize{}} @tab @yref{st_oxyd}_a
- at tab @image{images/st_oxydb, @oisize{}} @tab @yref{st_oxyd}_b
- at tab @image{images/st_oxydc, @oisize{}} @tab @yref{st_oxyd}_c
- at item @image{images/st_oxydd, @oisize{}} @tab @yref{st_oxyd}_d
- at tab @image{images/st_oxyde, @oisize{}} @tab @yref{st_oxyd}_e
- at tab @image{images/st_passage_black_square, @oisize{}} @tab @yref{st_passage}_black
- at item @image{images/st_passage_black_slash, @oisize{}} @tab @yref{st_passage}_black
- at tab @image{images/st_passage_black_cross, @oisize{}} @tab @yref{st_passage}_black
- at tab @image{images/st_passage_black_frame, @oisize{}} @tab @yref{st_passage}_black
- at item @image{images/st_passage_white_square, @oisize{}} @tab @yref{st_passage}_white
- at tab @image{images/st_passage_white_slash, @oisize{}} @tab @yref{st_passage}_white
- at tab @image{images/st_passage_white_cross, @oisize{}} @tab @yref{st_passage}_white
- at item @image{images/st_passage_white_frame, @oisize{}} @tab @yref{st_passage}_white
- at tab @image{images/st_pinkbumps, @oisize{}} @tab @yref{st_pinkbumps}
- at tab @image{images/st_plaster, @oisize{}} @tab @yref{st_plaster}
- at item @image{images/st_plop_slate, @oisize{}} @tab @yref{st_plop}_slate
- at tab @image{images/st_portal_horse, @oisize{}} @tab @yref{st_portal}
- at tab @image{images/st_purplegray, @oisize{}} @tab @yref{st_purplegray}
- at item @image{images/st_purplemarble, @oisize{}} @tab @yref{st_purplemarble}
- at tab @image{images/st_rawglass, @oisize{}} @tab @yref{st_rawglass}
- at tab @image{images/st_rawglass_quad, @oisize{}} @tab @yref{st_rawglass}_quad
- at item @image{images/st_redbrown, @oisize{}} @tab @yref{st_redbrown}
- at tab @image{images/st_redfiber, @oisize{}} @tab @yref{st_redfiber}
- at tab @image{images/st_redmarble, @oisize{}} @tab @yref{st_redmarble}
- at item @image{images/st_redrock, @oisize{}} @tab @yref{st_redrock}
- at tab @image{images/st_spitter_idle, @oisize{}} @tab @yref{st_spitter}
- at tab @image{images/st_surprise, @oisize{}} @tab @yref{st_surprise}
- at item @image{images/st_tigris, @oisize{}} @tab @yref{st_tigris}
- at tab @image{images/st_woven, @oisize{}} @tab @yref{st_woven}
- at tab @image{images/st_yellow, @oisize{}} @tab @yref{st_yellow}
- at item @image{images/st_yinyang, @oisize{}} @tab @yref{st_yinyang}
- at tab @image{images/st_yinyang_inactive, @oisize{}} @tab @yref{st_yinyang}_inactive 
+ at item @image{images/st_jamb_black, 12mm} @tab @yref{st_jamb}_black
+ at tab @image{images/st_jamb_white, 12mm} @tab @yref{st_jamb}_white
+ at tab @image{images/st_knight, 12mm} @tab @yref{st_knight}
+ at item @image{images/st_lightglass, 12mm} @tab @yref{st_lightglass}
+ at tab @image{images/st_lightpassenger, 12mm} @tab @yref{st_lightpassenger}
+ at tab @image{images/st_metal, 12mm} @tab @yref{st_metal}
+ at item @image{images/st_oxyda, 12mm} @tab @yref{st_oxyd}_a
+ at tab @image{images/st_oxydb, 12mm} @tab @yref{st_oxyd}_b
+ at tab @image{images/st_oxydc, 12mm} @tab @yref{st_oxyd}_c
+ at item @image{images/st_oxydd, 12mm} @tab @yref{st_oxyd}_d
+ at tab @image{images/st_oxyde, 12mm} @tab @yref{st_oxyd}_e
+ at tab @image{images/st_passage_black_square, 12mm} @tab @yref{st_passage}_black
+ at item @image{images/st_passage_black_slash, 12mm} @tab @yref{st_passage}_black
+ at tab @image{images/st_passage_black_cross, 12mm} @tab @yref{st_passage}_black
+ at tab @image{images/st_passage_black_frame, 12mm} @tab @yref{st_passage}_black
+ at item @image{images/st_passage_white_square, 12mm} @tab @yref{st_passage}_white
+ at tab @image{images/st_passage_white_slash, 12mm} @tab @yref{st_passage}_white
+ at tab @image{images/st_passage_white_cross, 12mm} @tab @yref{st_passage}_white
+ at item @image{images/st_passage_white_frame, 12mm} @tab @yref{st_passage}_white
+ at tab @image{images/st_pinkbumps, 12mm} @tab @yref{st_pinkbumps}
+ at tab @image{images/st_plaster, 12mm} @tab @yref{st_plaster}
+ at item @image{images/st_plop_slate, 12mm} @tab @yref{st_plop}_slate
+ at tab @image{images/st_portal_horse, 12mm} @tab @yref{st_portal}
+ at tab @image{images/st_purplegray, 12mm} @tab @yref{st_purplegray}
+ at item @image{images/st_purplemarble, 12mm} @tab @yref{st_purplemarble}
+ at tab @image{images/st_rawglass, 12mm} @tab @yref{st_rawglass}
+ at tab @image{images/st_rawglass_quad, 12mm} @tab @yref{st_rawglass}_quad
+ at item @image{images/st_redbrown, 12mm} @tab @yref{st_redbrown}
+ at tab @image{images/st_redfiber, 12mm} @tab @yref{st_redfiber}
+ at tab @image{images/st_redmarble, 12mm} @tab @yref{st_redmarble}
+ at item @image{images/st_redrock, 12mm} @tab @yref{st_redrock}
+ at tab @image{images/st_spitter_idle, 12mm} @tab @yref{st_spitter}
+ at tab @image{images/st_surprise, 12mm} @tab @yref{st_surprise}
+ at item @image{images/st_tigris, 12mm} @tab @yref{st_tigris}
+ at tab @image{images/st_woven, 12mm} @tab @yref{st_woven}
+ at tab @image{images/st_yellow, 12mm} @tab @yref{st_yellow}
+ at item @image{images/st_yinyang, 12mm} @tab @yref{st_yinyang}
+ at tab @image{images/st_yinyang_inactive, 12mm} @tab @yref{st_yinyang}_inactive 
 @end multitable
 
 @c ----------------- Stone Attributes --------------------
@@ -14123,7 +14119,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_ancient, @oisize{}} @b{st_ancient}
+ at item @image{images/st_ancient, 12mm} @b{st_ancient}
 @end table
 @end table
 
@@ -14138,8 +14134,8 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_bluegray, @oisize{}} @b{st_bluegray}
- at item @image{images/st_bluegray, @oisize{}} @b{st_bluegray_hollow}
+ at item @image{images/st_bluegray, 12mm} @b{st_bluegray}
+ at item @image{images/st_bluegray, 12mm} @b{st_bluegray_hollow}
 @end table
 @end table
 
@@ -14153,7 +14149,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_brownie, @oisize{}} @b{st_brownie}
+ at item @image{images/st_brownie, 12mm} @b{st_brownie}
 @end table
 @end table
 
@@ -14167,7 +14163,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_brownmarble, @oisize{}} @b{st_brownmarble}
+ at item @image{images/st_brownmarble, 12mm} @b{st_brownmarble}
 @end table
 @end table
 
@@ -14181,7 +14177,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_camouflage, @oisize{}} @b{st_camouflage}
+ at item @image{images/st_camouflage, 12mm} @b{st_camouflage}
 @item @b{st_camouflage_hollow}
 @item @b{st_camouflage_movable}
 @end table
@@ -14197,7 +14193,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_concrete, @oisize{}} @b{st_concrete}
+ at item @image{images/st_concrete, 12mm} @b{st_concrete}
 @end table
 @end table
 
@@ -14211,7 +14207,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_darkgray, @oisize{}} @b{st_darkgray}
+ at item @image{images/st_darkgray, 12mm} @b{st_darkgray}
 @item @b{st_darkgray_hollow}
 @end table
 @end table
@@ -14226,7 +14222,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_granite, @oisize{}} @b{st_granite}
+ at item @image{images/st_granite, 12mm} @b{st_granite}
 @item @b{st_granite_hollow}
 @item @b{st_granite_movable}
 @end table
@@ -14242,7 +14238,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_greengray, @oisize{}} @b{st_greengray}
+ at item @image{images/st_greengray, 12mm} @b{st_greengray}
 @end table
 @end table
 
@@ -14278,7 +14274,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_metal, @oisize{}} @b{st_metal}
+ at item @image{images/st_metal, 12mm} @b{st_metal}
 @item @b{st_metal_hollow}
 @end table
 @end table
@@ -14293,7 +14289,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_pinkbumps, @oisize{}} @b{st_pinkbumps}
+ at item @image{images/st_pinkbumps, 12mm} @b{st_pinkbumps}
 @end table
 @end table
 
@@ -14307,7 +14303,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_purplegray, @oisize{}} @b{st_purplegray}
+ at item @image{images/st_purplegray, 12mm} @b{st_purplegray}
 @end table
 @end table
 
@@ -14321,7 +14317,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_purplemarble, @oisize{}} @b{st_purplemarble}
+ at item @image{images/st_purplemarble, 12mm} @b{st_purplemarble}
 @end table
 @end table
 
@@ -14335,7 +14331,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_redbrown, @oisize{}} @b{st_redbrown}
+ at item @image{images/st_redbrown, 12mm} @b{st_redbrown}
 @item @b{st_redbrown_hollow}
 @item @b{st_redbrown_movable}
 @end table
@@ -14351,7 +14347,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_redmarble, @oisize{}} @b{st_redmarble}
+ at item @image{images/st_redmarble, 12mm} @b{st_redmarble}
 @end table
 @end table
 
@@ -14365,7 +14361,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_redrock, @oisize{}} @b{st_redrock}
+ at item @image{images/st_redrock, 12mm} @b{st_redrock}
 @end table
 @end table
 
@@ -14379,7 +14375,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_tigris, @oisize{}} @b{st_tigris}
+ at item @image{images/st_tigris, 12mm} @b{st_tigris}
 @end table
 @end table
 
@@ -14393,7 +14389,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_woven, @oisize{}} @b{st_woven}
+ at item @image{images/st_woven, 12mm} @b{st_woven}
 @end table
 @end table
 
@@ -14408,7 +14404,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_yellow, @oisize{}} @b{st_yellow}
+ at item @image{images/st_yellow, 12mm} @b{st_yellow}
 @end table
 @end table
 
@@ -14708,8 +14704,8 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_actorimpulse, @oisize{}} @b{st_actorimpulse}: invisible = @code{false}
- at item @image{images/fl_white, @oisize{}} @b{st_actorimpulse_invisible}: invisible = @code{true}
+ at item @image{images/st_actorimpulse, 12mm} @b{st_actorimpulse}: invisible = @code{false}
+ at item @image{images/fl_white, 12mm} @b{st_actorimpulse_invisible}: invisible = @code{true}
 @end table
 
 @end table
@@ -14732,7 +14728,7 @@
 
 @item @b{Variants:} 
 @table @asis
- at item @image{images/st_beads, @oisize{}} @b{st_beads}
+ at item @image{images/st_beads, 12mm} @b{st_beads}
 @end table
 
 @end table
@@ -14851,10 +14847,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_blur_straight, @oisize{}} @b{st_blur}: flavor = @code{"straight"}
- at item @image{images/st_blur_straight, @oisize{}} @b{st_blur_straight}: flavor = @code{"straight"}
- at item @image{images/st_blur_cross, @oisize{}} @b{st_blur_cross}: flavor = @code{"cross"}
- at item @image{images/st_blur_cross, @oisize{}} @b{st_blur_magic}: flavor = @code{"magic"}
+ at item @image{images/st_blur_straight, 12mm} @b{st_blur}: flavor = @code{"straight"}
+ at item @image{images/st_blur_straight, 12mm} @b{st_blur_straight}: flavor = @code{"straight"}
+ at item @image{images/st_blur_cross, 12mm} @b{st_blur_cross}: flavor = @code{"cross"}
+ at item @image{images/st_blur_cross, 12mm} @b{st_blur_magic}: flavor = @code{"magic"}
 @end table
 
 @end table
@@ -14990,14 +14986,14 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_box_wood, @oisize{}} @b{st_box}: flavor=@code{"wood"}
- at item @image{images/st_box_wood, @oisize{}} @b{st_box_wood}: flavor=@code{"wood"}
- at item @image{images/st_box_wood, @oisize{}} @b{st_box_wood_h}: flavor=@code{"wood"}
- at item @image{images/fl_white, @oisize{}} @b{st_box_wood_v}: flavor=@code{"wood"}
- at item @image{images/fl_white, @oisize{}} @b{st_box_wood_growing}: flavor=@code{"wood"}
- at item @image{images/st_box_hay, @oisize{}} @b{st_box_hay}: flavor=@code{"hay"}
- at item @image{images/fl_white, @oisize{}} @b{st_box_hay_growing}: flavor=@code{"hay"}
- at item @image{images/st_box_rock, @oisize{}} @b{st_box_rock}: flavor=@code{"rock"}
+ at item @image{images/st_box_wood, 12mm} @b{st_box}: flavor=@code{"wood"}
+ at item @image{images/st_box_wood, 12mm} @b{st_box_wood}: flavor=@code{"wood"}
+ at item @image{images/st_box_wood, 12mm} @b{st_box_wood_h}: flavor=@code{"wood"}
+ at item @image{images/fl_white, 12mm} @b{st_box_wood_v}: flavor=@code{"wood"}
+ at item @image{images/fl_white, 12mm} @b{st_box_wood_growing}: flavor=@code{"wood"}
+ at item @image{images/st_box_hay, 12mm} @b{st_box_hay}: flavor=@code{"hay"}
+ at item @image{images/fl_white, 12mm} @b{st_box_hay_growing}: flavor=@code{"hay"}
+ at item @image{images/st_box_rock, 12mm} @b{st_box_rock}: flavor=@code{"rock"}
 @end table
 
 @end table
@@ -15036,7 +15032,7 @@
 
 @item @b{Variants:} none
 @table @asis
- at item @image{images/st_brake, @oisize{}} @b{st_brake}
+ at item @image{images/st_brake, 12mm} @b{st_brake}
 @end table
 @end table
 
@@ -15097,14 +15093,14 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_break_plain, @oisize{}} @b{st_break}: flavor=@code{"plain"}
- at item @image{images/st_break_plain, @oisize{}} @b{st_break_plain}: flavor=@code{"plain"}
- at item @image{images/st_break_black, @oisize{}} @b{st_break_black}: flavor=@code{"black"}
- at item @image{images/st_break_white, @oisize{}} @b{st_break_white}: flavor=@code{"white"}
- at item @image{images/st_break_oxydc, @oisize{}} @b{st_break_oxydc}: flavor=@code{"oxydc"}
- at item @image{images/st_break_boulder, @oisize{}} @b{st_break_boulder}: flavor=@code{"boulder"}
- at item @image{images/st_break_bug, @oisize{}} @b{st_break_bug}: flavor=@code{"bug"}
- at item @image{images/st_flat, @oisize{}} @b{st_break_laser}: flavor=@code{"laser"}
+ at item @image{images/st_break_plain, 12mm} @b{st_break}: flavor=@code{"plain"}
+ at item @image{images/st_break_plain, 12mm} @b{st_break_plain}: flavor=@code{"plain"}
+ at item @image{images/st_break_black, 12mm} @b{st_break_black}: flavor=@code{"black"}
+ at item @image{images/st_break_white, 12mm} @b{st_break_white}: flavor=@code{"white"}
+ at item @image{images/st_break_oxydc, 12mm} @b{st_break_oxydc}: flavor=@code{"oxydc"}
+ at item @image{images/st_break_boulder, 12mm} @b{st_break_boulder}: flavor=@code{"boulder"}
+ at item @image{images/st_break_bug, 12mm} @b{st_break_bug}: flavor=@code{"bug"}
+ at item @image{images/st_flat, 12mm} @b{st_break_laser}: flavor=@code{"laser"}
 @end table
 
 @end table
@@ -15121,7 +15117,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_brownpyramide, @oisize{}} @b{st_brownpyramide}
+ at item @image{images/st_brownpyramide, 12mm} @b{st_brownpyramide}
 @end table
 @end table
 
@@ -15143,7 +15139,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/fl_white, @oisize{}} @b{st_chameleon}
+ at item @image{images/fl_white, 12mm} @b{st_chameleon}
 @end table
 @end table
 
@@ -15178,10 +15174,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_charge_zero, @oisize{}} @b{st_charge}: charge = @code{0.0}
- at item @image{images/st_charge_zero, @oisize{}} @b{st_charge_zero}: charge = @code{0.0}
- at item @image{images/st_charge_plus, @oisize{}} @b{st_charge_plus}: charge = @code{+1.0}
- at item @image{images/st_charge_minus, @oisize{}} @b{st_charge_minus}: charge = @code{-1.0}
+ at item @image{images/st_charge_zero, 12mm} @b{st_charge}: charge = @code{0.0}
+ at item @image{images/st_charge_zero, 12mm} @b{st_charge_zero}: charge = @code{0.0}
+ at item @image{images/st_charge_plus, 12mm} @b{st_charge_plus}: charge = @code{+1.0}
+ at item @image{images/st_charge_minus, 12mm} @b{st_charge_minus}: charge = @code{-1.0}
 @end table
 
 @end table
@@ -15242,9 +15238,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_chess_black, @oisize{}} @b{st_chess}: color = @code{BLACK}
- at item @image{images/st_chess_black, @oisize{}} @b{st_chess_black}: color = @code{BLACK}
- at item @image{images/st_chess_white, @oisize{}} @b{st_chess_white}: color = @code{WHITE}
+ at item @image{images/st_chess_black, 12mm} @b{st_chess}: color = @code{BLACK}
+ at item @image{images/st_chess_black, 12mm} @b{st_chess_black}: color = @code{BLACK}
+ at item @image{images/st_chess_white, 12mm} @b{st_chess_white}: color = @code{WHITE}
 @end table
 
 @end table
@@ -15339,9 +15335,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_darkglass, @oisize{}} @b{st_darkglass}: hollow = @code{false}, movable = @code{false}
- at item @image{images/st_darkglass, @oisize{}} @b{st_darkglass_hollow}: hollow = @code{true}, movable = @code{false}
- at item @image{images/st_darkglass, @oisize{}} @b{st_darkglass_movable}: hollow = @code{false}, movable = @code{true}
+ at item @image{images/st_darkglass, 12mm} @b{st_darkglass}: hollow = @code{false}, movable = @code{false}
+ at item @image{images/st_darkglass, 12mm} @b{st_darkglass_hollow}: hollow = @code{true}, movable = @code{false}
+ at item @image{images/st_darkglass, 12mm} @b{st_darkglass_movable}: hollow = @code{false}, movable = @code{true}
 @end table
 
 @end table
@@ -15411,9 +15407,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_death, @oisize{}} @b{st_death}: invisible = @code{false}
- at item @image{images/fl_white, @oisize{}} @b{st_death_invisible}: invisible = @code{true}
- at item @image{images/st_death_light, @oisize{}} @b{st_death_movable}: movable = @code{true}
+ at item @image{images/st_death, 12mm} @b{st_death}: invisible = @code{false}
+ at item @image{images/fl_white, 12mm} @b{st_death_invisible}: invisible = @code{true}
+ at item @image{images/st_death_light, 12mm} @b{st_death_movable}: movable = @code{true}
 @end table
 
 @end table
@@ -15510,10 +15506,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_dispenser_bombblack, @oisize{}} @b{st_dispenser}: flavor=@code{"bombblack"}
- at item @image{images/st_dispenser_bombblack, @oisize{}} @b{st_dispenser_bombblack}: flavor=@code{"bombblack"}
- at item @image{images/st_dispenser_bombwhite, @oisize{}} @b{st_dispenser_bombwhite}: flavor=@code{"bombwhite"}
- at item @image{images/st_dispenser_dynamite, @oisize{}} @b{st_dispenser_dynamite}: flavor=@code{"dynamite"}
+ at item @image{images/st_dispenser_bombblack, 12mm} @b{st_dispenser}: flavor=@code{"bombblack"}
+ at item @image{images/st_dispenser_bombblack, 12mm} @b{st_dispenser_bombblack}: flavor=@code{"bombblack"}
+ at item @image{images/st_dispenser_bombwhite, 12mm} @b{st_dispenser_bombwhite}: flavor=@code{"bombwhite"}
+ at item @image{images/st_dispenser_dynamite, 12mm} @b{st_dispenser_dynamite}: flavor=@code{"dynamite"}
 @end table
 
 @end table
@@ -15703,7 +15699,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_flash, @oisize{}} @b{st_flash}:
+ at item @image{images/st_flash, 12mm} @b{st_flash}:
 @end table
 @end table
 
@@ -15758,14 +15754,14 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_flat, @oisize{}} @b{st_flat}:
- at item @image{images/st_flat, @oisize{}} @b{st_flat_hollow}: hollow=@code{true}
- at item @image{images/st_flat, @oisize{}} @b{st_flat_movable}: movable=@code{"true"}
- at item @image{images/st_flat, @oisize{}} @b{st_flat_breakable}: breakable=@code{"true"}
- at item @image{images/st_flat_cracked, @oisize{}} @b{st_flat_cracked}: 
- at item @image{images/st_flat_fire, @oisize{}} @b{st_flat_burnable}: burnable=@code{"true"}
- at item @image{images/st_flat_fire, @oisize{}} @b{st_flat_moveburnable}: movable=@code{"true"}, burnable=@code{"true"}
- at item @image{images/fl_white, @oisize{}} @b{st_flat_breaking}: breakable=@code{"true"}
+ at item @image{images/st_flat, 12mm} @b{st_flat}:
+ at item @image{images/st_flat, 12mm} @b{st_flat_hollow}: hollow=@code{true}
+ at item @image{images/st_flat, 12mm} @b{st_flat_movable}: movable=@code{"true"}
+ at item @image{images/st_flat, 12mm} @b{st_flat_breakable}: breakable=@code{"true"}
+ at item @image{images/st_flat_cracked, 12mm} @b{st_flat_cracked}: 
+ at item @image{images/st_flat_fire, 12mm} @b{st_flat_burnable}: burnable=@code{"true"}
+ at item @image{images/st_flat_fire, 12mm} @b{st_flat_moveburnable}: movable=@code{"true"}, burnable=@code{"true"}
+ at item @image{images/fl_white, 12mm} @b{st_flat_breaking}: breakable=@code{"true"}
 @end table
 @end table
 
@@ -15860,7 +15856,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_fourswitch, @oisize{}} @b{st_fourswitch}
+ at item @image{images/st_fourswitch, 12mm} @b{st_fourswitch}
 @end table
 @end table
 
@@ -15946,9 +15942,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_grate_cross, @oisize{}} @b{st_grate}: flavor=@code{"cross"}
- at item @image{images/st_grate_cross, @oisize{}} @b{st_grate_cross}: flavor=@code{"cross"}
- at item @image{images/st_grate_framed, @oisize{}} @b{st_grate_framed}: flavor=@code{"framed"}
+ at item @image{images/st_grate_cross, 12mm} @b{st_grate}: flavor=@code{"cross"}
+ at item @image{images/st_grate_cross, 12mm} @b{st_grate_cross}: flavor=@code{"cross"}
+ at item @image{images/st_grate_framed, 12mm} @b{st_grate_framed}: flavor=@code{"framed"}
 @end table
 
 @end table
@@ -15972,10 +15968,10 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_greenbrown, @oisize{}} @b{st_greenbrown}
- at item @image{images/st_greenbrown, @oisize{}} @b{st_greenbrown_hollow}
- at item @image{images/st_greenbrown, @oisize{}} @b{st_greenbrown_movable}
- at item @image{images/fl_white, @oisize{}} @b{st_greenbrown_growing}
+ at item @image{images/st_greenbrown, 12mm} @b{st_greenbrown}
+ at item @image{images/st_greenbrown, 12mm} @b{st_greenbrown_hollow}
+ at item @image{images/st_greenbrown, 12mm} @b{st_greenbrown_movable}
+ at item @image{images/fl_white, 12mm} @b{st_greenbrown_growing}
 @end table
 @end table
 
@@ -16055,7 +16051,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_ice, @oisize{}} @b{st_ice}
+ at item @image{images/st_ice, 12mm} @b{st_ice}
 @end table
 @end table
 
@@ -16122,9 +16118,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_jamb_black, @oisize{}} @b{st_jamb}: color=@code{BLACK}
- at item @image{images/st_jamb_black, @oisize{}} @b{st_jamb_black}: color=@code{BLACK}
- at item @image{images/st_jamb_white, @oisize{}} @b{st_jamb_white}: color=@code{WHITE}
+ at item @image{images/st_jamb_black, 12mm} @b{st_jamb}: color=@code{BLACK}
+ at item @image{images/st_jamb_black, 12mm} @b{st_jamb_black}: color=@code{BLACK}
+ at item @image{images/st_jamb_white, 12mm} @b{st_jamb_white}: color=@code{WHITE}
 @end table
 
 @end table
@@ -16193,7 +16189,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_knight, @oisize{}} @b{st_knight}
+ at item @image{images/st_knight, 12mm} @b{st_knight}
 @end table
 
 @end table
@@ -16367,9 +16363,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_lightglass, @oisize{}} @b{st_lightglass}: hollow = @code{false}, movable = @code{false}
- at item @image{images/st_lightglass, @oisize{}} @b{st_lightglass_hollow}: hollow = @code{true}, movable = @code{false}
- at item @image{images/st_lightglass, @oisize{}} @b{st_lightglass_movable}: hollow = @code{false}, movable = @code{true}
+ at item @image{images/st_lightglass, 12mm} @b{st_lightglass}: hollow = @code{false}, movable = @code{false}
+ at item @image{images/st_lightglass, 12mm} @b{st_lightglass_hollow}: hollow = @code{true}, movable = @code{false}
+ at item @image{images/st_lightglass, 12mm} @b{st_lightglass_movable}: hollow = @code{false}, movable = @code{true}
 @end table
 
 @end table
@@ -16457,9 +16453,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_lightpassenger, @oisize{}} @b{st_lightpassenger}: state = @code{ON}
- at item @image{images/st_lightpassenger, @oisize{}} @b{st_lightpassenger_on}: state = @code{ON}
- at item @image{images/st_darkglass, @oisize{}} @b{st_lightpassenger_off}: state = @code{OFF}
+ at item @image{images/st_lightpassenger, 12mm} @b{st_lightpassenger}: state = @code{ON}
+ at item @image{images/st_lightpassenger, 12mm} @b{st_lightpassenger_on}: state = @code{ON}
+ at item @image{images/st_darkglass, 12mm} @b{st_lightpassenger_off}: state = @code{OFF}
 @end table
 
 @end table
@@ -16870,12 +16866,12 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_oxydb, @oisize{}} @b{st_oxyd}: flavor = @code{"b"}
- at item @image{images/st_oxyda, @oisize{}} @b{st_oxyd_a}: flavor = @code{"a"}
- at item @image{images/st_oxydb, @oisize{}} @b{st_oxyd_b}: flavor = @code{"b"}
- at item @image{images/st_oxydc, @oisize{}} @b{st_oxyd_c}: flavor = @code{"c"}
- at item @image{images/st_oxydd, @oisize{}} @b{st_oxyd_d}: flavor = @code{"d"}
- at item @image{images/st_oxyde, @oisize{}} @b{st_oxyd_e}: flavor = @code{"e"}
+ at item @image{images/st_oxydb, 12mm} @b{st_oxyd}: flavor = @code{"b"}
+ at item @image{images/st_oxyda, 12mm} @b{st_oxyd_a}: flavor = @code{"a"}
+ at item @image{images/st_oxydb, 12mm} @b{st_oxyd_b}: flavor = @code{"b"}
+ at item @image{images/st_oxydc, 12mm} @b{st_oxyd_c}: flavor = @code{"c"}
+ at item @image{images/st_oxydd, 12mm} @b{st_oxyd_d}: flavor = @code{"d"}
+ at item @image{images/st_oxyde, 12mm} @b{st_oxyd_e}: flavor = @code{"e"}
 @end table
 
 @end table
@@ -16922,15 +16918,15 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_passage_black_square, @oisize{}} @b{st_passage}: color = @code{BLACK}, flavor = @code{"square"}
- at item @image{images/st_passage_black_square, @oisize{}} @b{st_passage_black}: color = @code{BLACK}, flavor = @code{"square"}
- at item @image{images/st_passage_black_slash, @oisize{}} @b{st_passage_black}: color = @code{BLACK}, flavor = @code{"slash"}
- at item @image{images/st_passage_black_cross, @oisize{}} @b{st_passage_black}: color = @code{BLACK} - flavor = @code{"cross"}
- at item @image{images/st_passage_black_frame, @oisize{}} @b{st_passage_black}: color = @code{BLACK} - flavor = @code{"frame"}
- at item @image{images/st_passage_white_square, @oisize{}} @b{st_passage_white}: color = @code{WHITE}, flavor = @code{"square"}
- at item @image{images/st_passage_white_slash, @oisize{}} @b{st_passage_white}: color = @code{WHITE} - flavor = @code{"slash"}
- at item @image{images/st_passage_white_cross, @oisize{}} @b{st_passage_white}: color = @code{WHITE} - flavor = @code{"cross"}
- at item @image{images/st_passage_white_frame, @oisize{}} @b{st_passage_white}: color = @code{WHITE} - flavor = @code{"frame"}
+ at item @image{images/st_passage_black_square, 12mm} @b{st_passage}: color = @code{BLACK}, flavor = @code{"square"}
+ at item @image{images/st_passage_black_square, 12mm} @b{st_passage_black}: color = @code{BLACK}, flavor = @code{"square"}
+ at item @image{images/st_passage_black_slash, 12mm} @b{st_passage_black}: color = @code{BLACK}, flavor = @code{"slash"}
+ at item @image{images/st_passage_black_cross, 12mm} @b{st_passage_black}: color = @code{BLACK} - flavor = @code{"cross"}
+ at item @image{images/st_passage_black_frame, 12mm} @b{st_passage_black}: color = @code{BLACK} - flavor = @code{"frame"}
+ at item @image{images/st_passage_white_square, 12mm} @b{st_passage_white}: color = @code{WHITE}, flavor = @code{"square"}
+ at item @image{images/st_passage_white_slash, 12mm} @b{st_passage_white}: color = @code{WHITE} - flavor = @code{"slash"}
+ at item @image{images/st_passage_white_cross, 12mm} @b{st_passage_white}: color = @code{WHITE} - flavor = @code{"cross"}
+ at item @image{images/st_passage_white_frame, 12mm} @b{st_passage_white}: color = @code{WHITE} - flavor = @code{"frame"}
 @end table
 
 @end table
@@ -16970,11 +16966,11 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_plaster, @oisize{}} @b{st_plaster}:
- at item @image{images/st_plaster, @oisize{}} @b{st_plaster_hollow}: hollow=@code{true}
- at item @image{images/st_plaster, @oisize{}} @b{st_plaster_movable}: movable=@code{"true"}
- at item @image{images/st_plaster, @oisize{}} @b{st_plaster_breakable}: breakable=@code{"true"}
- at item @image{images/st_plaster, @oisize{}} @b{st_plaster_movebreakable}: movable=@code{"true"}, breakable=@code{"true"}
+ at item @image{images/st_plaster, 12mm} @b{st_plaster}:
+ at item @image{images/st_plaster, 12mm} @b{st_plaster_hollow}: hollow=@code{true}
+ at item @image{images/st_plaster, 12mm} @b{st_plaster_movable}: movable=@code{"true"}
+ at item @image{images/st_plaster, 12mm} @b{st_plaster_breakable}: breakable=@code{"true"}
+ at item @image{images/st_plaster, 12mm} @b{st_plaster_movebreakable}: movable=@code{"true"}, breakable=@code{"true"}
 @end table
 
 @end table
@@ -16997,8 +16993,8 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_plop_slate, @oisize{}} @b{st_plop}
- at item @image{images/st_plop_slate, @oisize{}} @b{st_plop_slate}
+ at item @image{images/st_plop_slate, 12mm} @b{st_plop}
+ at item @image{images/st_plop_slate, 12mm} @b{st_plop_slate}
 @end table
 @end table
 
@@ -17070,9 +17066,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_portal_horse, @oisize{}} @b{st_portal}: flavor=@code{"horse"}
- at item @image{images/st_portal_horse, @oisize{}} @b{st_portal_horse}: flavor=@code{"horse"}
- at item @image{images/st_portal_horse, @oisize{}} @b{st_portal_pearl}: flavor=@code{"pearl"}
+ at item @image{images/st_portal_horse, 12mm} @b{st_portal}: flavor=@code{"horse"}
+ at item @image{images/st_portal_horse, 12mm} @b{st_portal_horse}: flavor=@code{"horse"}
+ at item @image{images/st_portal_horse, 12mm} @b{st_portal_pearl}: flavor=@code{"pearl"}
 @end table
 
 @end table
@@ -17336,9 +17332,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_rawglass, @oisize{}} @b{st_rawglass}: movable = @code{false}
- at item @image{images/st_rawglass_quad, @oisize{}} @b{st_rawglass_quad}: movable = @code{false}
- at item @image{images/st_rawglass, @oisize{}} @b{st_rawglass_movable}: movable = @code{true}
+ at item @image{images/st_rawglass, 12mm} @b{st_rawglass}: movable = @code{false}
+ at item @image{images/st_rawglass_quad, 12mm} @b{st_rawglass_quad}: movable = @code{false}
+ at item @image{images/st_rawglass, 12mm} @b{st_rawglass_movable}: movable = @code{true}
 @end table
 
 @end table
@@ -17360,7 +17356,7 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_redfiber, @oisize{}} @b{st_redfiber}
+ at item @image{images/st_redfiber, 12mm} @b{st_redfiber}
 @end table
 
 @end table
@@ -17644,7 +17640,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_spitter_idle, @oisize{}} @b{st_spitter}: secure = @code{false}, state = @code{ACTIVE}
+ at item @image{images/st_spitter_idle, 12mm} @b{st_spitter}: secure = @code{false}, state = @code{ACTIVE}
 @end table
 
 @end table
@@ -17791,7 +17787,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @image{images/st_surprise, @oisize{}} @b{st_surprise}
+ at item @image{images/st_surprise, 12mm} @b{st_surprise}
 @end table
 @end table
 
@@ -18356,10 +18352,10 @@
 @item @b{Variants:}
 
 @table @asis
- at item @image{images/st_yinyang, @oisize{}} @b{st_yinyang}: state = @code{IDLE}
- at item @image{images/st_yinyang, @oisize{}} @b{st_yinyang_active}: state = @code{ACTIVE}
- at item @image{images/st_yinyang_inactive, @oisize{}} @b{st_yinyang_inactive}: state = @code{INACTIVE}
- at item @image{images/st_yinyang, @oisize{}} @b{st_yinyang_instant}: instant = @code{true}, state = @code{IDLE}
+ at item @image{images/st_yinyang, 12mm} @b{st_yinyang}: state = @code{IDLE}
+ at item @image{images/st_yinyang, 12mm} @b{st_yinyang_active}: state = @code{ACTIVE}
+ at item @image{images/st_yinyang_inactive, 12mm} @b{st_yinyang_inactive}: state = @code{INACTIVE}
+ at item @image{images/st_yinyang, 12mm} @b{st_yinyang_instant}: instant = @code{true}, state = @code{IDLE}
 @end table
 @end table
 

Modified: trunk/src/floors/BridgeFloor.cc
===================================================================
--- trunk/src/floors/BridgeFloor.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/floors/BridgeFloor.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -39,7 +39,7 @@
     void BridgeFloor::setAttr(const string& key, const Value &val) {
         if (key == "flavor") {
             std::string flavor = val.to_string();
-            ASSERT(flavor == "gc" || flavor == "bw" || flavor == "bn", XLevelRuntime, "BridgeFloor illegal flavor value");
+            ASSERT(flavor == "gc" || flavor == "bw" || flavor == "bs"|| flavor == "be" || flavor == "bn", XLevelRuntime, "BridgeFloor illegal flavor value");
             Floor::setAttr("flavor", val);
             Floor::setAttr("burnable", flavor != "gc");
             if (isDisplayable() && state <= OPEN) {
@@ -134,11 +134,15 @@
     std::string BridgeFloor::model_basename() const {
         std::string flavor = getAttr("flavor").to_string();
         if (flavor == "gc")
-            return "fl-bridgea-";
+            return "fl_bridge_g_";
         else if (flavor == "bw")
-            return "fl-bridgex-";
+            return "fl_bridge_w_";
+        else if (flavor == "bs")
+            return "fl_bridge_s_";
+        else if (flavor == "be")
+            return "fl_bridge_e_";
         else if (flavor == "bn")
-            return "fl-bridgey-";
+            return "fl_bridge_n_";
         return "";
     }
     
@@ -169,6 +173,8 @@
         BootRegister(new BridgeFloor("gc"), "fl_bridge");
         BootRegister(new BridgeFloor("gc"), "fl_bridge_gc");
         BootRegister(new BridgeFloor("bn"), "fl_bridge_bn");
+        BootRegister(new BridgeFloor("be"), "fl_bridge_be");
+        BootRegister(new BridgeFloor("bs"), "fl_bridge_bs");
         BootRegister(new BridgeFloor("bw"), "fl_bridge_bw");
     BOOT_REGISTER_END
 

Modified: trunk/src/ox_magnum.cc
===================================================================
--- trunk/src/ox_magnum.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/ox_magnum.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -70,7 +70,7 @@
     UNUSED,                     // OxydMagnum floor 0x21
     UNUSED,                     // OxydMagnum floor 0x22
     "fl_slope_ps",             // OxydMagnum floor 0x23
-    "fl_slope_ps",             // OxydMagnum floor 0x24
+    "fl_slope_pn",             // OxydMagnum floor 0x24
     "fl_slope_pe",             // OxydMagnum floor 0x25
     "fl_slope_pw",             // OxydMagnum floor 0x26
     "fl_slope_ose",             // OxydMagnum floor 0x27

Modified: trunk/src/stones/BlockerStone.cc
===================================================================
--- trunk/src/stones/BlockerStone.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/stones/BlockerStone.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -80,13 +80,13 @@
     void BlockerStone::init_model() {
         switch (state) {
             case SOLID:
-                set_model("st-blocker");
+                set_model("st_blocker");
                 break;
             case SHRINKING:
-                set_anim("st-blocker-shrinking");
+                set_anim("st_blocker_shrinking");
                 break;
             case GROWING:
-                set_anim("st-blocker-growing");
+                set_anim("st_blocker_growing");
                 break;
         }
     }

Modified: trunk/src/stones/BoulderStone.cc
===================================================================
--- trunk/src/stones/BoulderStone.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/stones/BoulderStone.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -85,9 +85,9 @@
     }
 
     void BoulderStone::init_model() {
-        std::string mname  = "st-bolder" + to_suffix(getDir());
+        std::string mname  = "st_boulder" + toSuffix(getDir());
         if (state == FALLING)
-            mname += "-fall-anim";
+            mname += "_fall_anim";
         set_anim(mname);
     }
 

Modified: trunk/src/stones/PullStone.cc
===================================================================
--- trunk/src/stones/PullStone.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/stones/PullStone.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -45,7 +45,7 @@
     }
     
     void PullStone::init_model() {
-        set_model("st-pull");
+        set_model("st_pull");
     }
     
     bool PullStone::is_floating() const {
@@ -92,12 +92,12 @@
         YieldStone(oldPos);
         SetStone(oldPos, vanishStone);
         vanishStone->yieldStone(otherStone);
-        vanishStone->set_model(std::string("st-pull") + to_suffix(impulse.dir));
+        vanishStone->set_model(std::string("st_pull") + toSuffix(impulse.dir));
         GameTimer.set_alarm(vanishStone, 0.09, false);
         
         SetStone(newPos, this);
         state = APPEARING;
-        set_model(std::string("st-pull") + to_suffix(reverse(impulse.dir)));
+        set_model(std::string("st_pull") + toSuffix(reverse(impulse.dir)));
         GameTimer.set_alarm(this, 0.09, false);
 
         // search for affected actors

Modified: trunk/src/stones/RotatorStone.cc
===================================================================
--- trunk/src/stones/RotatorStone.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/stones/RotatorStone.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -73,7 +73,7 @@
     }
 
     void RotatorStone::init_model() {
-        set_anim(state == CW ? "st-rotator-right" : "st-rotator-left");
+        set_anim(state == CW ? "st_rotator_cw" : "st_rotator_ccw");
     }
     
     void RotatorStone::on_creation(GridPos p) {

Modified: trunk/src/stones/RubberbandStone.cc
===================================================================
--- trunk/src/stones/RubberbandStone.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/stones/RubberbandStone.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -31,7 +31,7 @@
     }
         
     void RubberbandStone::init_model() {
-        set_model("st-rubberband");
+        set_model("st_rubberband");
     }
     
     void RubberbandStone::actor_hit(const StoneContact &sc) {

Modified: trunk/src/stones/ScissorsStone.cc
===================================================================
--- trunk/src/stones/ScissorsStone.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/stones/ScissorsStone.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -30,16 +30,16 @@
     }
         
     void ScissorsStone::init_model() {
-        set_model("st-scissors");
+        set_model("st_scissors");
     }
     
     void ScissorsStone::animcb() {
-        set_model("st-scissors");
+        init_model();
     }
     
     void ScissorsStone::actor_hit(const StoneContact &sc) {
         sound_event("scissors");
-        set_anim("st-scissors-snip");
+        set_anim("st_scissors_snip");
         if (SendMessage(sc.actor, "disconnect").to_bool())
             performAction(true);
     }

Modified: trunk/src/stones/SwapStone.cc
===================================================================
--- trunk/src/stones/SwapStone.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/stones/SwapStone.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -45,7 +45,7 @@
     }
     
     void SwapStone::init_model() {
-        set_model("st-swap");
+        set_model("st_swap");
     }
     
     bool SwapStone::is_floating() const {
@@ -91,12 +91,12 @@
         YieldStone(oldPos);
         SetStone(oldPos, vanishStone);
         vanishStone->yieldStone(otherStone);
-        vanishStone->set_model(std::string("st-swap") + to_suffix(reverse(impulse.dir)));
+        vanishStone->set_model(std::string("st_swap") + toSuffix(reverse(impulse.dir)));
         GameTimer.set_alarm(vanishStone, 0.1, false);
         
         SetStone(newPos, this);
         state = APPEARING;
-        set_model(std::string("st-swap") + to_suffix(impulse.dir));
+        set_model(std::string("st_swap") + toSuffix(impulse.dir));
         GameTimer.set_alarm(this, 0.1, false);
         if (server::GameCompatibility == GAMET_PEROXYD)
             if (Item *it = GetItem(newPos))

Modified: trunk/src/stones/Switch.cc
===================================================================
--- trunk/src/stones/Switch.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/stones/Switch.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -69,7 +69,7 @@
             if (state <= ON && extState != state) {
                 sound_event ("switchon");
                 state += 2;  // OFF->TURNON, ON->TURNOFF
-                set_anim(ecl::strf("st-switch%s%s", colorName(), extState ? "-turnon" : "-turnoff"));
+                set_anim(ecl::strf("st_switch%s%s", colorName(), extState ? "_turnon" : "_turnoff"));
                 if (isInstant()) {
                     performAction(externalState() == ON);   // immediate action
                 }
@@ -89,7 +89,7 @@
     }
 
     void Switch::init_model() {
-        set_model(ecl::strf("st-switch%s%s", colorName(), state == ON ? "-on" : "-off"));
+        set_model(ecl::strf("st_switch%s%s", colorName(), state == ON ? "_on" : "_off"));
     }
     
     void Switch::animcb() {

Modified: trunk/src/stones/Turnstile.cc
===================================================================
--- trunk/src/stones/Turnstile.cc	2009-06-18 13:56:29 UTC (rev 1725)
+++ trunk/src/stones/Turnstile.cc	2009-06-18 22:17:39 UTC (rev 1726)
@@ -71,7 +71,7 @@
     }
 
     void TurnstilePivot::init_model() {
-        set_model(std::string("red") == getAttr("flavor").to_string() ? "st-turnstile" : "st-turnstile-green");
+        set_model(std::string("red") == getAttr("flavor").to_string() ? "st_turnstile" : "st_turnstile_green");
     }
 
 
@@ -149,7 +149,7 @@
             sound_event("movesmall");
 
             state = ROTATING;
-            set_anim(ecl::strf("st-turnstile%s-anim", (std::string("red") == getAttr("flavor").to_string()) ? "" : "-green"));
+            set_anim(ecl::strf("st_turnstile%s_anim", (std::string("red") == getAttr("flavor").to_string()) ? "" : "_green"));
             rotate_arms(arms, clockwise);
             handleActorsAndItems(clockwise, impulse_sender);
 
@@ -413,7 +413,7 @@
     }
 
     void TurnstileArm::init_model() {
-        set_model(ecl::strf("st-turnstile%s", to_suffix((Direction)state).c_str()));
+        set_model(ecl::strf("st_turnstile%s", toSuffix((Direction)state).c_str()));
     }
 
     void TurnstileArm::on_impulse(const Impulse& impulse) {



From andreasl at mail.berlios.de  Fri Jun 19 01:38:14 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Fri, 19 Jun 2009 01:38:14 +0200
Subject: [Enigma-game-svn] r1727 - trunk/doc/reference
Message-ID: <200906182338.n5INcEQI027077@sheep.berlios.de>

Author: andreasl
Date: 2009-06-19 01:38:11 +0200 (Fri, 19 Jun 2009)
New Revision: 1727

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Refman (trunk):
 - Extended section about libmap.


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-18 22:17:39 UTC (rev 1726)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-18 23:38:11 UTC (rev 1727)
@@ -8712,18 +8712,20 @@
 @node map read directions
 @subsection map read directions
 
-Number constants for map based method parameters. Please choose the constant
-that is appropriate for an object and do avoid using numbers. 
+Constants for map read directions (see @ref{drawMap}) and map transformations (see
+ at ref{Rotating and Mirroring Maps} and @ref{Map Transformation}). They
+are not numbers, to allow advanced operations on them when libmap is loaded, see
+ at ref{Map Transformation Composition and Powers}.
 
 @itemize @bullet
- at item @samp{MAP_IDENT} = @code{0}, by @ref{drawMap} and @ref{Rotating and Mirroring Maps}
- at item @samp{MAP_ROT_CW} = @code{1}, by all @ref{drawMap} and @ref{Rotating and Mirroring Maps}
- at item @samp{MAP_ROT_180} = @code{2}, by all @ref{drawMap} and @ref{Rotating and Mirroring Maps}
- at item @samp{MAP_ROT_CCW} = @code{3}, by all @ref{drawMap} and @ref{Rotating and Mirroring Maps}
- at item @samp{MAP_MIRROR_BACKSLASH} = @code{4}, by @ref{drawMap} and @ref{Rotating and Mirroring Maps}
- at item @samp{MAP_MIRROR_HORIZONTAL} = @code{5}, by @ref{drawMap} and @ref{Rotating and Mirroring Maps}
- at item @samp{MAP_MIRROR_SLASH} = @code{6}, by @ref{drawMap} and @ref{Rotating and Mirroring Maps}
- at item @samp{MAP_MIRROR_VERTICAL} = @code{7}, by @ref{drawMap} and @ref{Rotating and Mirroring Maps}
+ at item @samp{MAP_IDENT} = no transformation
+ at item @samp{MAP_ROT_CW} = rotate map 90 degrees clockwise
+ at item @samp{MAP_ROT_180} = rotate map 180 degrees
+ at item @samp{MAP_ROT_CCW} = rotate map 90 degrees counter-clockwise
+ at item @samp{MAP_FLIP_BACKSLASH} = flip upper-left and lower-right corners
+ at item @samp{MAP_FLIP_HORIZONTAL} = flip right and left
+ at item @samp{MAP_FLIP_SLASH} = flip upper-right and lower-left corners
+ at item @samp{MAP_FLIP_VERTICAL} = flip up and down
 @end itemize
 
 
@@ -20007,6 +20009,8 @@
 
 It preloads automatically the library @ref{liblua}.
 
+We first give six task-oriented sections, then describe each function in detail.
+
 @menu
 * Creating Maps::
 * Drawing Maps::
@@ -20014,6 +20018,27 @@
 * Requesting and Changing Single Map Entries::
 * Connecting Two Maps::
 * Other Map Tasks::
+* newMap::
+* Map Entry Request:: Index Operator @samp{[]} read and write
+* Map Transformation:: Operator @samp{^}
+* Map Horizontal Concatenation:: Operator @samp{..}
+* Map Vertical Concatenation:: Operator @samp{+}
+* Map Fusing:: Operator @samp{*}
+* Map Default Keys::
+* Map Width and Height::
+* lib.map.covers::
+* lib.map.defuse::
+* lib.map.extend::
+* lib.map.match::
+* lib.map.paste::
+* lib.map.print::
+* lib.map.replace::
+* lib.map.replace_outside::
+* lib.map.sub::
+* lib.map.trim::
+* Map Transformation Composition and Powers:: Operators @samp{*} and @samp{^}
+* Map Transformation Inverse::                Operator @samp{-}
+* Random and All Map Transformations::
 @end menu
 
 @c ----------------- Creating Maps --------------------
@@ -20077,46 +20102,66 @@
 
 We can transform a single map simply by using one of the following commands:
 @example
-newmap = lib.map.transform(mymap, operation)
-newmap = mymap ^ operation
+newmap = lib.map.transform(mymap, maptransformation)
+newmap = mymap ^ maptransformation
 @end example
- at samp{operation} can be any of the following constants:
+ at samp{maptransformation} can be any of the following constants:
 @table @asis
 @item @samp{MAP_IDENT}
 No transformation.
 @item @samp{MAP_ROT_CW}
 Rotate 90 degrees clockwise.
 @item @samp{MAP_ROT_180}
-Rotate 180 degrees (i.e. a point reflection around the midpoint)
+Rotate 180 degrees (i.e. a point reflection around the midpoint).
 @item @samp{MAP_ROT_CCW}
 Rotate 90 degrees counter-clockwise.
- at item @samp{MAP_MIRROR_HORIZONTAL}
-Mirror along a vertical axis, i.e. left and right are swapped.
- at item @samp{MAP_MIRROR_VERTICAL}
-Mirror along a horizontal axis, i.e. up and down are swapped.
- at item @samp{MAP_MIRROR_SLASH}
-Mirror along the diagonal from upper-left to lower-right corner.
- at item @samp{MAP_MIRROR_BACKSLASH}
-Mirror along the diagonal from upper-right to lower-left corner.
+ at item @samp{MAP_FLIP_HORIZONTAL}
+Flip each horizontal line, i.e. mirror against a vertical mirror: left and right are swapped.
+ at item @samp{MAP_FLIP_VERTICAL}
+Flip each vertical line, i.e. mirror against a horizontal mirror: up and down are swapped.
+ at item @samp{MAP_FLIP_SLASH}
+Flip each @code{/}-diagonal, i.e. mirror against a @code{\}-mirror: upper-right and
+lower-left corners are swapped.
+ at item @samp{MAP_FLIP_BACKSLASH}
+Flip each @code{\}-diagonal, i.e. mirror against a @code{/}-mirror: upper-left
+and lower-right corners are swapped.
 @end table
-The mirror-constants might seem inverse to their meaning, however it's meant in
-the following sense: @samp{MAP_MIRROR_HORIZONTAL} flips left and right, i.e. the
-reflection is done in horizontal direction, with a vertical axis.
 
-When you want to perform two transformations after each other, remember that
-neither
+When you apply multiple transformations, remember that their sequence
+matters. If you use
 @example
-newmap = mymap ^ operation1 ^ operation2
+newmap = mymap ^ maptransformation1 ^ maptransformation2 ^ maptransformation3
 @end example
-nor
+then @code{maptransformation1} acts first on @code{mymap}, then comes
+ at code{maptransformation2}, and @code{maptransformation3} is
+last. However, composing transformations is associative, so you can use
 @example
-newmap = mymap ^ (operation1 * operation2)
+newmap = mymap ^ ((maptransformation1 ^ maptransformation2) ^ maptransformation3)
 @end example
-will work. The correct syntax is:
+or
 @example
-newmap = (mymap ^ operation1) ^ operation2
+newmap = (mymap ^ maptransformation1) ^ (maptransformation2 ^ maptransformation3)
 @end example
+to the same effect. Keep in mind that composing transformations is by far faster than
+applying transformations to maps. So the first example is faster than the
+second. Due to Lua's sequence of evaluating operators, 
+ at example
+newmap = mymap ^ maptransformation1 ^ maptransformation2 ^ maptransformation3
+ at end example
+equals
+ at example
+newmap = mymap ^ (maptransformation1 ^ (maptransformation2 ^ maptransformation3))
+ at end example
+and hence already is the fastest possible sequence.
 
+For composing transformations you may use @code{^} as well as @code{*}. You
+can also use @code{maptransformation ^ n} to calculate the n-th power of
+ at code{maptransformation} for any integer n. The inverse of a transformation is
+given by @code{-maptransformation}, so
+ at example
+MAP_ROT_CW * (-MAP_ROT_CW) == MAP_IDENT
+ at end example
+
 @c ----------------- Requesting and Changing Single Map Entries --------------------
 
 @node Requesting and Changing Single Map Entries
@@ -20158,7 +20203,7 @@
 You can omit @samp{tile2}, then any occurrence of @samp{tile1} will be replaced
 by the default key.
 
-You can also search for positions in a map which fulfils given conditions by
+You can also search for positions in a map which fulfill given conditions by
 using @samp{match}, the return value is a position list. The syntax is simple:
 @example
 mymap:match()
@@ -20337,7 +20382,7 @@
 The default key of the submap of course is the default key of the original map.
 
 @samp{lib.map.trim} or @samp{mymap:trim(tilekey)} removes all lines and
-columns from the North, South, East and West that consist of @code{tilekey}
+columns from the North, South, East, and West that consist of @code{tilekey}
 only; it's like trimming a string from white spaces. You can omit
 @samp{tilekey}, then the default key is used instead.
 
@@ -20351,18 +20396,19 @@
                        "F# D ## # #",
                        "#       # #",
                        "########   "@})
-map2 = map1:replace_outside(" ", ".")
-map3 = map1:replace_outside(" ", "#")
-map3 = map3:replace_outside("#", ".")
+map2 = wo:newMap(" ", map1)
+map1:replace_outside(" ", ".")
+map2:replace_outside(" ", "#")
+map2:replace_outside("#", ".")
 @end example
 will yield:
 @example
-map2 = @{".##########",
+map1 = @{".##########",
         "###      ##",
         "F# D ## #.#",
         "#       #.#",
         "########..."@})
-map3 = @{"...........",
+map2 = @{"...........",
         "...      ..",
         "F. D ## ...",
         ".       ...",
@@ -20380,10 +20426,10 @@
 will yield:
 @example
 map1 = @{"---######-",
-         "--#      #",
-         "F# D ## #-",
-         "#       #-",
-         "-#######--"@})
+        "--#      #",
+        "F# D ## #-",
+        "#       #-",
+        "-#######--"@})
 @end example
 
 Finally, you can use @samp{mymap:print()} to print @samp{mymap} to standard
@@ -20398,6 +20444,1112 @@
 be strings to be put between the left coordinate axis and the map, and behind
 the map (to analyse space characters).
 
+ at c ----------------- newMap --------------------
+
+ at node newMap
+ at subsection newMap
+
+ at samp{wo:newMap} takes a default key, and a premap or width and height as
+arguments, and returns a libmap-map.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{mymap} = @b{wo:newMap}(@i{defaultkey}, @i{premap})
+
+ at i{mymap} = @b{wo:newMap}(@i{defaultkey}, @i{width}, @i{height})
+
+ at i{mymap} = @b{wo:newMap}(@i{defaultkey})
+
+ at table @asis
+ at item @i{defaultkey}
+A non-empty string, which becomes the default key of the new map.
+
+ at item @i{premap}
+A table of strings. It may have lines of varying length, but each line length
+must be divisible by the length of the default key.
+
+ at item @i{width}, @i{height}
+Positive integers. If width and height are given instead of a premap, a
+rectangular map consisting of the default key only is returned.
+ at end table
+
+If neither a premap, nor width and height are given, a 1x1-map with the default
+key is returned.
+
+ at item @b{Syntax Samples:}
+See @ref{Creating Maps}.
+
+ at item @b{Details:}
+The syntax with neither premap nor width and height is useful in conjunction
+with @ref{Map Fusing}.
+
+A libmap-map is always rectangular. But you may use an ignore-key when you draw
+the map with @ref{drawMap} to create arbitrarily shaped areas.
+
+If the premap is not rectangular, missing positions are set to the default key.
+
+As each libmap-map can be used to replace a premap, you may also use
+ at code{wo:newMap} to copy a libmap-map with:
+ at example
+newcopy = wo:newMap(mymap.defaultkey, mymap)
+ at end example
+ at end table
+
+ at c ----------------- Map Entry Request --------------------
+
+ at node Map Entry Request
+ at subsection Map Entry Request
+
+You may request and set single entries within a libmap-map, using the
+index-operator @samp{[]}.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{entry} = @i{mymap}@b{[}@i{posarg}@b{]}
+
+ at i{entry} = @b{lib.map.get}(@i{mymap}, @i{posarg})
+
+ at i{mymap}@b{[}@i{posarg}@b{]} = @b{newentry}
+
+ at b{lib.map.set}(@i{mymap}, @i{posarg}, @i{newentry})
+
+ at table @asis
+ at item @i{entry}, @i{newentry}
+Non-empty strings of the same length as the default key of @code{mymap}.
+
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{posarg}
+A position, object, group, position list, or table (interpretable as single
+position).
+ at end table
+
+ at item @b{Syntax Samples:}
+See @ref{Requesting and Changing Single Map Entries}.
+
+ at item @b{Details:}
+A read-access with a group or position list will return a table of all key
+entries at the positions in the group or position list, in their corresponding
+sequence. Empty groups and position lists will return empty tables.
+
+Correspondingly, a write-access with a group or position list changes the key
+at each position in the group or position list to the given string.
+
+You may request any position outside of the scope of the map, even with
+negative coordinates. If you do so, the default key is returned.
+
+If you try to set an entry to a position with a negative coordinate, an error
+is returned. However, if you use non-negative coordinates outside of the scope
+of the map, the map is subsequently extended to the new position, setting
+the default key as entry where necessary.
+
+Floating-point coordinates are always rounded to a grid position
+(see @ref{Position Grid Rounding}).
+ at end table
+
+ at c ----------------- Map Transformation --------------------
+
+ at node Map Transformation
+ at subsection Map Transformation
+
+You may transform any libmap-map according to the eight map transformation
+constants given in @ref{Rotating and Mirroring Maps}.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{newmap} = @i{mymap}@b{^}@i{maptransformation}
+
+ at i{newmap} = @b{lib.map.transform}(@i{mymap}, @i{maptransformation})
+
+ at table @asis
+ at item @i{mymap}, @i{newmap}
+libmap-maps.
+
+ at item @i{maptransformation}
+One of the following eight constants: @code{MAP_IDENT}, @code{MAP_ROT_CW},
+ at code{MAP_ROT_180}, @code{MAP_ROT_CCW}, @code{MAP_FLIP_HORIZONTAL},
+ at code{MAP_FLIP_VERTICAL}, @code{MAP_FLIP_SLASH}, @code{MAP_FLIP_BACKSLASH}.
+ at end table
+
+ at item @b{Syntax Samples:}
+See @ref{Rotating and Mirroring Maps}.
+
+ at item @b{Details:}
+As map transformations can be composed with @samp{^}, it is possible to combine
+several transformations without brackets; it's only important to always have the
+map on the left side of the @samp{^}-sign:
+ at example
+newmap = mymap ^ MAP_ROT_CW ^ MAP_FLIP_HORIZONTAL
+ at end example
+However, each such combination can equally well be expressed with a single constant.
+
+After a transformation, height and width of a map might have swapped.
+ at end table
+
+ at c ----------------- Map Horizontal Concatenation --------------------
+
+ at node Map Horizontal Concatenation
+ at subsection Map Horizontal Concatenation
+
+You may glue libmap-maps one after another in horizontal direction using
+ at samp{..}. Note the similarity to the meaning of @samp{..} in the context of
+strings to remember its meaning in contrast to @samp{+} (see
+ at ref{Map Vertical Concatenation}).
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{newmap} = @i{mymap1} @b{..} @i{mymap2}
+
+ at i{newmap} = @b{lib.map.concat_horizontally}(@i{mymap1}, @i{mymap2})
+
+ at table @asis
+ at item @i{mymap1}, @i{mymap2}, @i{newmap}
+libmap-maps.
+ at end table
+
+ at item @b{Syntax Samples:}
+See @ref{Connecting Two Maps}.
+
+ at item @b{Details:}
+The upper-left corner of the second map is set beneath the upper-right corner
+of the first, i.e. the bottom lines of the maps are aligned. If you want to
+align them in another way, you may first vertically concat a map of suitable
+height to the second (or first) map, like in this example:
+ at example
+newmap = mymap1 .. (wo:newMap(" ", 1, 13) + mymap2)
+ at end example
+
+The default key of the new map is the default key of the first map. Any missing
+position to gain a rectangular map is subsequently set to this default key.
+ at end table
+
+ at c ----------------- Map Vertical Concatenation --------------------
+
+ at node Map Vertical Concatenation
+ at subsection Map Vertical Concatenation
+
+You may glue libmap-maps on top of each other in vertical direction using
+ at samp{+}. Compare with the meaning of @samp{..} (see
+ at ref{Map Horizontal Concatenation}).
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{newmap} = @i{mymap1} @b{+} @i{mymap2}
+
+ at i{newmap} = @b{lib.map.concat_vertically}(@i{mymap1}, @i{mymap2})
+
+ at table @asis
+ at item @i{mymap1}, @i{mymap2}, @i{newmap}
+libmap-maps.
+ at end table
+
+ at item @b{Syntax Samples:}
+See @ref{Connecting Two Maps}.
+
+ at item @b{Details:}
+The upper-left corner of the second map is set below the lower-left corner
+of the first, i.e. the left borders of the maps are aligned. If you want to
+align them in another way, you may first horizontally concat a map of suitable
+width to the second (or first) map, like in this example:
+ at example
+newmap = mymap1 + (wo:newMap(" ", 13, 1) .. mymap2)
+ at end example
+
+The default key of the new map is the default key of the first map. Any missing
+position to gain a rectangular map is subsequently set to this default key.
+ at end table
+
+ at c ----------------- Map Fusing --------------------
+
+ at node Map Fusing
+ at subsection Map Fusing
+
+You may fuse libmap-maps in the way described in @ref{Connecting Two Maps}, by
+interpreting the two keys of the two maps at a position as parts of a combined
+(fused) key at this position.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{newmap} = @i{mymap1} @b{*} @i{mymap2}
+
+ at i{newmap} = @b{lib.map.fuse}(@i{mymap1}, @i{mymap2})
+
+ at table @asis
+ at item @i{mymap1}, @i{mymap2}, @i{newmap}
+libmap-maps.
+ at end table
+
+ at item @b{Syntax Samples:}
+See @ref{Connecting Two Maps}.
+
+ at item @b{Details:}
+Missing keys in one map are replaced by the default key of this map.
+
+The default key of the result is the concatenation of the default key of the
+first map with the default key of the second map (as expected).
+
+The inverse of the fusing operation is given by @ref{lib.map.defuse}.
+
+One of the maps is allowed to be a string, which is then interpreted as a
+1x1-map with the given string as default key. The result of the fusing process
+then is that each tile key is concatenated with the given string.
+ at end table
+
+ at c ----------------- Map Default Keys --------------------
+
+ at node Map Default Keys
+ at subsection Map Default Keys
+
+A libmap-map always includes a default key, which is used in various places
+throughout the library. It is the placeholder whenever a key out of scope of
+the map is requested, or when @ref{drawMap} or @code{wo} (see
+ at ref{World Creation}) are invoked without a default or ignore key. Hence, it is
+sometimes necessary to retrieve or change the default key of a map.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{defaultkey} = @i{mymap}@b{.defaultkey}
+
+ at i{defaultkey} = @i{mymap}@b{["defaultkey"]}
+
+ at i{keylength} = @i{mymap}@b{.keylength}
+
+ at i{keylength} = @i{mymap}@b{["keylength"]}
+
+ at i{mymap}@b{.defaultkey} = @i{newkey}
+
+ at i{mymap}@b{["defaultkey"]} = @i{newkey}
+
+ at i{mymap}:@b{set_default_key}(@i{newkey})
+
+ at b{lib.map.set_default_key}(@i{mymap}, @i{newkey})
+
+ at table @asis
+ at item @i{defaultkey}, @i{newkey}
+A non-empty string.
+
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{keylength}
+A positive integer, which equals the length of the default key.
+ at end table
+
+ at item @b{Syntax Samples:}
+See @ref{Other Map Tasks}.
+
+ at item @b{Details:}
+It typically makes sense to change the default key of a map, when two or more
+keys can be equally well thought of as being "default". Such an example occurs
+during the import of Sokoban levels: While the canonical default key would be
+the key of the inner free tiles, it is temporarily set to the key of the outer
+area to allow a simple matching and trimming. It is then set back again:
+ at example
+local map = lib.import.level_to_map(level, "\n", " ")
+map:replace("_")
+map:replace("-")
+map:replace_outside(" ", "-")
+-- Remove redundant walls by outside:
+-- A wall is redundant, if it is surrounded by "-" or "#".
+-- In this case, it can be replaced by "-".
+map.defaultkey = "-"
+map[map:match(@{@{po(0,0), "#"@}, @{NEIGHBORS_8, "-", "#"@}@})] = "-"
+map = map:trim()
+map.defaultkey = " "
+ at end example
+See @ref{lib.map.match} and @ref{lib.map.trim} for details on their use of
+default keys.
+
+The keylength of a map can be read, but not written. To change the keylength,
+a new default key has to be assigned. On the other hand, it is possible to
+change the default key to a key of different length; however, this rarely makes
+sense, as each line will be reinterpreted, and the width of the map changes.
+Still, the width has to fit to the new keylength, otherwise an error is
+thrown.
+
+If you want to change the keylength without reinterpreting each line, you
+should instead fuse or defuse the map (see @ref{Map Fusing},
+ at ref{lib.map.defuse}). @ref{newMap} allows this quite easily:
+ at example
+extendedmap = mymap * wo:newMap(" ")
+restrictedmap = (mymap:defuse())[1] * (mymap:defuse())[3]
+ at end example
+ at end table
+
+ at c ----------------- Map Width and Height --------------------
+
+ at node Map Width and Height
+ at subsection Map Width and Height
+
+A libmap-map always includes its width and height. These determine for example
+the exact position of the second map during a concatenation (see
+ at ref{Connecting Two Maps}).
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{width} = @i{mymap}@b{.width}
+
+ at i{width} = @i{mymap}@b{["width"]}
+
+ at i{height} = @i{mymap}@b{.height}
+
+ at i{height} = @i{mymap}@b{["height"]}
+
+ at table @asis
+ at item @i{width}, @i{height}
+Positive integers.
+
+ at item @i{mymap}
+A libmap-map.
+ at end table
+
+ at item @b{Details:}
+See also @ref{Other Map Tasks}.
+
+It is not possible (and rarely necessary) to directly change width and height
+of a map. Instead, you might use @ref{lib.map.extend} to extend a map to a
+given position, @ref{lib.map.sub} to retrieve a rectangular part of a map, or
+ at ref{lib.map.trim} to remove unused lines and columns from the map.
+
+Note that width and height are not invariant. They change with many operations,
+like transformations, concatenations or setting a key outside the former scope
+of a map.
+
+Also note that the upper-left corner of a map has coordinates @code{@{0, 0@}},
+so the lower-right corner is @code{@{width - 1, height - 1@}}.
+ at end table
+
+ at c ----------------- lib.map.covers --------------------
+
+ at node lib.map.covers
+ at subsection lib.map.covers
+
+ at code{covers} checks whether a position is within the scope of a map.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{result} = @i{mymap}:@b{covers}(@i{position})
+
+ at i{result} = @b{lib.map.covers}(@i{mymap}, @i{position})
+
+ at table @asis
+ at item @i{result}
+A boolean value: @code{true}, if @i{position} is within the rectangle of grids
+spanned by @code{(0,0)} and @code{(mymap.width - 1, mymap.height - 1)},
+otherwise @code{false}.
+
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{position}
+A positional value (position or table with two entries).
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+if map1:covers(po(no["mycoin"]) - po(no["anchor1"])) then
+    wo(no["mycoin"]) = ti["-"]
+end
+ at end example
+
+ at item @b{Details:}
+Floating-point positions are handled as expected, i.e. the position of a marble
+which is on a grid corresponding to the map lets @code{cover} return
+ at code{true}.
+
+Remember to subtract the anchor of an already drawn map to get the correct
+information when you use positions of the level world.
+ at end table
+
+ at c ----------------- lib.map.defuse --------------------
+
+ at node lib.map.defuse
+ at subsection lib.map.defuse
+
+ at code{defuse} returns a table of maps of keylength one, which correspond to the
+first, second, n-th character of each key at each position, respectively.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{result} = @i{mymap}:@b{defuse}()
+
+ at i{result} = @b{lib.map.defuse}(@i{mymap})
+
+ at table @asis
+ at item @i{result}
+A non-empty table with maps as entries at integer positions. There are as many
+maps as the keylength of @code{mymap}.
+
+ at item @i{mymap}
+A libmap-map.
+ at end table
+
+ at item @b{Full Example:}
+Given the following map,
+ at example
+mymap = wo:newMap(" .", @{"#C# # # # # #C",
+                         "# w1.1# .2.2# ",
+                         "# .1.1D3.2.2# ",
+                         "# .1.1# .2w2# ",
+                         "#C# # # # # #C"@})
+ at end example
+ at code{mymap:defuse()} will return a table
+ at example
+result = @{map1, map2@}
+ at end example
+containing the following two maps:
+ at example
+map1 = wo:newMap(".", @{"#######",
+                       "#w.#..#",
+                       "#..D..#",
+                       "#..#.w#",
+                       "#######"@})
+map2  = wo:newMap(".", @{"C     C",
+                        " 11 22 ",
+                        " 11322 ",
+                        " 11 22 ",
+                        "C     C"@})
+ at end example
+
+ at item @b{Details:}
+The default keys of the defused maps are the single characters of the default
+key, in corresponding sequence.
+
+The inverse of defusing is @ref{Map Fusing}.
+ at end table
+
+ at c ----------------- lib.map.extend --------------------
+
+ at node lib.map.extend
+ at subsection lib.map.extend
+
+ at code{extend} changes a map in-place such that it covers a given position. If
+the position already is within the scope of the map, nothing happens.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{mymap}:@b{extend}(@i{position})
+
+ at b{lib.map.extend}(@i{mymap}, @i{position})
+
+ at table @asis
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{position}
+A positional value (position, table with two entries, valid object, or string).
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+mymap:extend(po(no["mycoin1"]) - po(no["anchor1"]))
+mymap:extend("secondanchor")
+ at end example
+
+ at item @b{Details:}
+Negative coordinates are silently ignored. However, if the other coordinate
+makes sense, the map might still get extended.
+
+Floating-point coordinates are rounded to a grid position
+(see @ref{Position Grid Rounding}).
+ at end table
+
+ at c ----------------- lib.map.match --------------------
+
+ at node lib.map.match
+ at subsection lib.map.match
+
+You may use @code{match} to search for patterns or keys within a map.
+ at code{match} then returns a position list of grid positions.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{result} = @i{mymap}:@b{match}()
+
+ at i{result} = @i{mymap}:@b{match}(@i{tilekey})
+
+ at i{result} = @i{mymap}:@b{match}(@i{conditionlist})
+
+ at i{result} = @i{mymap}:@b{match}(@{conditionlist@})
+
+ at i{result} = @b{lib.map.match}(@i{mymap}, @i{conditionlist})
+
+ at table @asis
+ at item @i{result}
+The position list of all matched positions.
+
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{conditionlist} = condition, condition, ...
+A list of conditions. A position is matched if and only if all conditions of the
+ at i{conditionlist} are matched.
+
+ at item @i{condition} = @{@i{positionlist}, @i{tilekey}, @i{tilekey}, ...@}
+A position @code{pos} is matched by this condition if and only if for each position
+ at code{relativepos} in @code{positionlist} the tilekey
+ at code{mymap[pos + relativepos]} equals one of the tilekeys in the list. If
+ at code{pos + relativepos} is outside the scope of @i{mymap}, its tilekey is the
+default key.
+
+ at item @i{tilekey}
+Non-empty string of the same length as the default key of @code{mymap}
+(no wildcards).
+
+ at item @i{positionlist}
+A single relative position or a position list of relative positions.
+ at end table
+
+ at item @b{Full Example:}
+Given the following map,
+ at example
+mymap = wo:newMap(" ", @{"#####",
+                        "#w# #",
+                        "# D #",
+                        "# #w#",
+                        "#####"@})
+ at end example
+ at code{mymap:match("#")} will return a position list of all walls @code{"#"}, it
+is identical to @code{mymap:match(@{po(0, 0), "#"@})} and
+ at code{mymap:match(@{@{po(0, 0), "#"@}@})}.
+
+We may search for all positions @code{pos} which are between two walls with:
+ at example
+result = mymap:match(@{po(-1, 0), "#"@}, @{po(1, 0), "#"@})
+ at end example
+The two positions @code{po(-1, 0)} and @code{po(1, 0)} are relative to the
+returned position. This returns a position list including positions like the
+wall at @code{@{1,0@}} (which indeed is between two walls at @code{po(1, 0) +
+po(-1, 0)} and @code{po(1, 0) + po(1, 0)}), but also @code{@{1,1@}}. If we want
+to exclude walls at our position, we have to give all other keys instead:
+ at example
+result = mymap:match(@{po(-1, 0), "#"@}, @{po(1, 0), "#"@}, @{po(0, 0), "w", " ", "D"@})
+ at end example
+
+Finally, @code{mymap:match()} will return all positions of the map, i.e. a
+position list with all positions between @code{@{0,0@}} and
+ at code{@{mymap.width - 1, mymap.height - 1@}}.
+
+See also @ref{Requesting and Changing Single Map Entries}.
+
+ at item @b{Details:}
+You can, but need not pack the condition list @code{match} into a single table.
+This possibility exists to easily work with automatically generated condition
+lists, but should be avoided in other cases due to readability.
+
+The result of @code{match} is sorted primarily vertical, and secondarily
+horizontal, i.e. a typical result would be:
+ at example
+po(1, 1) .. po(1, 3) .. po(1, 4) .. po(2, 2) .. po(2, 3) .. po(5, 1)
+ at end example
+
+If you feed the position list back into a replacing command, like in
+ at example
+mymap = wo:newMap(" ", @{"####",
+                        "#  #",
+                        "####"@})
+mymap[mymap:match(@{NEIGHBORS_8, "#"@})] = "#"
+ at end example
+remember that the newly added changes could not be respected by the
+ at code{match}; so in the above example, the match returns an empty position list
+and no tilekey is subsequently replaced.
+
+Floating-point coordinates are rounded to a grid position
+(see @ref{Position Grid Rounding}).
+ at end table
+
+ at c ----------------- lib.map.paste --------------------
+
+ at node lib.map.paste
+ at subsection lib.map.paste
+
+ at code{paste} copies a map into another map at a given position. This command
+works in-place, i.e. the receiving map is changed, instead of returning a new map.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{map1}:@b{paste}(@i{map2}, @i{position})
+
+ at b{lib.map.paste}(@i{map1}, @i{map2}, @i{position})
+
+ at table @asis
+ at item @i{map1}
+The libmap-map to receive the copy.
+
+ at item @i{map2}
+The libmap-map which is to be copied into @code{map1}.
+
+ at item @i{position}
+A positional value (position, table with two entries, valid object, position
+list, group, or string). The upper-left position @code{@{0, 0@}} of @code{map2}
+is inserted at this position (or these positions) into @code{map1}.
+ at end table
+
+ at item @b{Full Example:}
+ at example
+map1 = wo:newMap(" ", @{"#######",
+                       "#w #  #",
+                       "#  D  #",
+                       "#  # w#",
+                       "#######"@})
+map2 = wo:newMap(".", @{"F.E",
+                       "E.E"@})
+ at end example
+In this situation, @code{map1:paste(map2, po(1, 1) .. po(5, 3)} will change
+map1 into:
+ at example
+@{"####### ",
+ "#F E  # ",
+ "#E E  # ",
+ "#  # F#E",
+ "#####E#E"@}
+ at end example
+
+ at item @b{Details:}
+The receiving map will be extended with its default key as necessary.
+
+Each tilekey of the copied map which equals its default key will be ignored
+during the pasting process.
+
+Floating-point coordinates are rounded to a grid position
+(see @ref{Position Grid Rounding}).
+
+If a part of a map is to be copied to a position with negative coordinates, an
+error is thrown. However, if this part is to be ignored anyway (because it is
+the default key), then the negative coordinate is silently ignored.
+If for example we have
+ at example
+map1 = wo:newMap(" ", @{"#######",
+                       "#w #  #",
+                       "#  D  #",
+                       "#  # w#",
+                       "#######"@})
+map2 = wo:newMap(".", @{".FE",
+                       ".EE"@})
+ at end example
+then @code{map1:paste(map2, po(-1, 0))} will change
+map1 into
+ at example
+@{"FE#####",
+ "EE #  #",
+ "#  D  #",
+ "#  #  #",
+ "#######"@}
+ at end example
+while @code{map1:paste(map2, po(0, -1))} throws an error.
+
+A map can be pasted multiple times into another map by providing a position
+list or object group. The sequence of pastings is then given by the sequence of
+the list or group, so the pasting at the second entry might overwrite the
+changes done by the first entry.
+ at end table
+
+ at c ----------------- lib.map.print --------------------
+
+ at node lib.map.print
+ at subsection lib.map.print
+
+ at code{print} prints a map to standard output. You may use this command for
+debugging purposes, or to support development or translation of a level, but it
+should not be used in the released form of a level.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{mymap}:@b{print}([@i{withXYCounts} [, @i{left_separator} [, @i{right_separator}]]])
+
+ at b{lib.map.print}(@i{mymap} [, @i{withXYCounts} [, @i{left_separator} [, @i{right_separator}]]])
+
+ at table @asis
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{withXYCounts}
+A boolean value, @code{false} by default.
+
+ at item @i{left_separator}, @i{right_separator}
+Strings to be printed on the left and on the right side of the map, empty
+strings by default.
+ at end table
+
+ at item @b{Full Example:}
+ at example
+mymap = wo:newMap(" ", @{"#######",
+                        "#w #  #",
+                        "#  D  #",
+                        "#  # w#",
+                        "#######"@})
+ at end example
+Then @code{mymap:print(true, " -> ", "|")} prints the following to standard output:
+ at example
+  -> 0123456|
+0 -> #######|
+1 -> #w #  #|
+2 -> #  D  #|
+3 -> #  # w#|
+4 -> #######|
+ at end example
+
+ at item @b{Details:}
+If you use maps wider than ten times its keylength, the x-count will show
+only the last digits of the x coordinate.
+
+If you want to insert lines between the columns, you can fuse the map
+with your desired character, like in @code{(mymap * "|"):print(...)}.
+
+You can actually use @code{print} to generate a map for a level file if you
+provide appropriate separators:
+ at example
+mymap:print(false, "    \"", "\",")
+ at end example
+ at end table
+
+ at c ----------------- lib.map.replace --------------------
+
+ at node lib.map.replace
+ at subsection lib.map.replace
+
+ at code{replace} replaces all occurrences of a single tile key in a map in-place
+with another tile key.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{mymap}:@b{replace}(@i{oldkey} [, @i{newkey}])
+
+ at b{lib.map.replace}(@i{mymap}, @i{oldkey} [, @i{newkey}])
+
+ at table @asis
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{oldkey}
+A non-empty string of the same length as @code{mymap}'s default key.
+
+ at item @i{newkey}
+A non-empty string of the same length as @code{mymap}'s default key, which is the
+replacement for @code{oldkey}. The default replacement key is the default key itself.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+mymap:replace("#", "-")
+ at end example
+will change @code{mymap} in such a way that each @code{"#"} is replaced by
+ at code{"-"}. If @code{"-"} is omitted, each @code{"#"} is replaced by the
+default key instead.
+
+ at item @b{Details:}
+ at samp{mymap:replace(tile1, tile2)} is equivalent to
+ at example
+mymap[mymap:match(tile1)] = tile2 or mymap.defaultkey
+ at end example
+but faster, because no position list is constructed in between (see
+ at ref{lib.map.match}).
+
+See also @ref{lib.map.replace_outside} and
+ at ref{Requesting and Changing Single Map Entries}.
+ at end table
+
+ at c ----------------- lib.map.replace_outside --------------------
+
+ at node lib.map.replace_outside
+ at subsection lib.map.replace_outside
+
+ at code{replace_outside} is a very specialized command, which is used to replace
+all occurrences of a tile key which are connected to the border of the map by a
+path of this tile key with another tile key. The replacement is done in-place,
+i.e. no new map is created or returned.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{mymap}:@b{replace_outside}(@i{oldkey} [, @i{newkey}])
+
+ at b{lib.map.replace_outside}(@i{mymap}, @i{oldkey} [, @i{newkey}])
+
+ at table @asis
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{oldkey}
+A non-empty string of the same length as @code{mymap}'s default key.
+
+ at item @i{newkey}
+A non-empty string of the same length as @code{mymap}'s default key, which is the
+replacement for @code{oldkey}. The default replacement key is the default key itself.
+ at end table
+
+ at item @b{Syntax Samples:}
+See @ref{Other Map Tasks}.
+
+ at item @b{Details:}
+ at code{replace_outside} shows similarities with @ref{lib.map.replace} and
+ at ref{lib.map.trim}. It is the only universal way to handle the area near
+the border of a map, and can be combined with @ref{lib.map.match} and
+ at ref{lib.map.trim} to show its full potential.
+
+Because of its recursive nature, old and new tile key must be different; in
+contrast to the situation of @ref{lib.map.replace} identical tile keys are not
+silently ignored, but throw an error message.
+ at end table
+
+ at c ----------------- lib.map.sub --------------------
+
+ at node lib.map.sub
+ at subsection lib.map.sub
+
+ at code{sub} returns a copy of a rectangular section of a map as a new map.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{submap} = @i{mymap}:@b{sub}(@i{upperleft}, @i{lowerright})
+
+ at i{submap} = @i{mymap}:@b{sub}(@i{upperleft}, @i{width}, @i{height})
+
+ at i{submap} = @b{lib.map.sub}(@i{mymap}, @i{upperleft}, @i{lowerright})
+
+ at i{submap} = @b{lib.map.sub}(@i{mymap}, @i{upperleft}, @i{width}, @i{height})
+
+ at table @asis
+ at item @i{submap}
+A libmap-map, the rectangular section of @code{mymap}.
+
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{upperleft}, @i{lowerright}
+Positional values (position, valid object, table with two entries, or name of a
+named position.
+
+ at item @i{width}, @i{height}
+Positive integers.
+ at end table
+
+ at item @b{Syntax Samples:}
+See @ref{Other Map Tasks}.
+
+ at item @b{Details:}
+If the bottom right-hand corner overlaps the area of @code{mymap}, the resulting
+ at code{submap} will still be just the rectangular section of @code{mymap}, i.e.
+width and height can be less than the arguments specified. Use
+ at code{submap:extend(width, height)} to ensure the full width and height.
+
+Floating point positions are rounded to grid positions, and the lower-right
+corner may not have coordinates less than those of the upper-left corner,
+otherwise an error is thrown.
+
+The default key of the submap is the default key of the original map.
+
+The upper-left corner of the submap of course is @code{@{0,0@}}, i.e. the
+coordinates are shifted accordingly.
+ at end table
+
+ at c ----------------- lib.map.trim --------------------
+
+ at node lib.map.trim
+ at subsection lib.map.trim
+
+ at code{trim} returns the smallest rectangular section of a map as new map such
+that its border consists of a given tile key only, i.e. it trims the original
+map from the North, East, South, and West.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{trimmedmap} = @i{mymap}:@b{trim}([@i{tilekey}])
+
+ at i{trimmedmap} = @b{lib.map.trim}(@i{mymap} [, @i{tilekey}])
+
+ at table @asis
+ at item @i{trimmedmap}
+A libmap-map, the trimmed copy of @code{mymap}.
+
+ at item @i{mymap}
+A libmap-map.
+
+ at item @i{tilekey}
+A non-empty string of the same length as the default key. If omitted, the
+default key is used instead.
+ at end table
+
+ at item @b{Full Example:}
+With the following map:
+ at example
+mymap = wo:newMap(" ", @{"#######",
+                        "#w #  #",
+                        "#  D  #",
+                        "#  # w#",
+                        "#######"@})
+ at end example
+Trimming with @samp{mymap:trim()} will return just a copy of the original map,
+but @samp{mymap:trim("#")} returns a map as follows:
+ at example
+@{"w #  ",
+ "  D  ",
+ "  # w"@})
+ at end example
+
+ at item @b{Details:}
+The default key of the trimmed map is the default key of the original map.
+
+If the original map consists of the trimmed key only, then @code{trim} returns
+a 1x1-map with the trimmed key as only entry, and the default key of the
+original map.
+ at end table
+
+* Map Transformation Composition and Powers:: Operators @samp{*} and @samp{^}
+
+ at c ----------------- Map Transformation Composition and Powers --------------------
+
+ at node Map Transformation Composition and Powers
+ at subsection Map Transformation Composition and Powers
+
+The transformation constants (see @ref{map read directions},
+ at ref{Rotating and Mirroring Maps}, @ref{Map Transformation}) can be composed
+according to their true operation on a map, as soon as libmap is loaded. The
+composition is returned by the operations @samp{*} and @samp{^}.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{composition} = @i{maptransformation1} @b{*} @i{maptransformation2}
+
+ at i{composition} = @i{maptransformation1} @b{^} @i{maptransformation2}
+
+ at i{composition} = @b{lib.map.transformation_compose}(@i{maptransformation1}, @i{maptransformation2})
+
+ at i{composition} = @b{lib.map.transformation_power}(@i{maptransformation1}, @i{maptransformation2})
+
+ at i{power} = @i{maptransformation} @b{^} @i{exponent}
+
+ at i{power} = @b{lib.map.transformation_power}(@i{maptransformation}, @i{exponent})
+
+ at table @asis
+ at item @i{composition}
+The result of composing two map transformations.
+
+ at item @i{maptransformation1}, @i{maptransformation2}, @i{maptransformation}
+Map transformations.
+
+ at item @i{power}
+The @code{exponent}-th power of @code{maptransformation} (again a map
+transformation).
+
+ at item @i{exponent}
+An integer.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+new_transformation = (MAP_ROT_CW * MAP_FLIP_HORIZONTAL) ^ 2
+another_transformation = (new_transformation ^ MAP_ROT_180) ^ (-1)
+ at end example
+
+ at item @b{Details:}
+The eight possible map transformations are the elements of a mathematical
+group, the dihedral group of order 8. Composition of any two map
+transformations therefore yields another one of the eight map transformations.
+An @i{n}-th power of a map transformation is the composition of @i{n} such
+transformations. In the case of the dihedral group, any 4-th power returns the
+original element. This fact is applied during calculating a power, so it
+doesn't make a difference to the performance when you use large numbers as
+exponents.
+
+Composing with @code{MAP_IDENT} doesn't change the value; it's like adding zero
+to a number, or multiplying with one.
+
+Keeping to group theoretic notions, the operation @samp{^} between map
+transformations should denote conjugation instead of composition. Instead of
+this, it is chosen to be synonymous to @samp{*} to allow for associativity of
+expressions like:
+ at example
+new_map = old_map ^ MAP_ROT_CCW ^ MAP_FLIP_VERTICAL
+ at end example
+(Remember that Lua evaluates @samp{^} from the right.)
+
+The inverse can be calculated with a power to @code{-1}, but also by @samp{-},
+see @ref{Map Transformation Inverse}.
+ at end table
+  
+ at c ----------------- Map Transformation Inverse --------------------
+
+ at node Map Transformation Inverse
+ at subsection Map Transformation Inverse
+
+The transformation constants (see @ref{map read directions},
+ at ref{Rotating and Mirroring Maps}, @ref{Map Transformation}) have proper
+inverses, i.e. map transformations that reverse their action. These inverse
+transformations are returned by @samp{-}.
+
+ at table @asis
+ at item @b{Syntax:}
+ at i{inverse} = @b{-}@i{maptransformation}
+
+ at i{inverse} = @b{lib.map.transformation_inverse}(@i{maptransformation})
+
+ at table @asis
+ at item @i{inverse}
+The inverse map transformation of @code{maptransformation}.
+
+ at item @i{maptransformation}
+A map transformation.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+reverse_transformation = -MAP_ROT_CW
+ at end example
+In this case, @code{reverse_transformation} equals @code{MAP_ROT_CCW}, because
+their composition @code{MAP_ROT_CW * MAP_ROT_CCW} equals the trivial
+transformation (or identity) @code{MAP_IDENT}.
+
+ at item @b{Details:}
+The eight possible map transformations are the elements of a mathematical
+group, the dihedral group of order 8. The inverse of any map transformation
+therefore yields another one of the eight map transformations. Composition of
+any map transformation with its inverse results in @code{MAP_IDENT}. However,
+within the dihedral group of order 8, only two elements have inverses that are
+not their own inverses: the two rotations by 90 degrees.
+
+Keeping to group theoretic notions, the inverse is denoted by @samp{^ (-1)},
+which works just as well(see @ref{Map Transformation Composition and Powers}).
+ at end table
+
+ at c ----------------- Random and All Map Transformations --------------------
+
+ at node Random and All Map Transformations
+ at subsection Random and All Map Transformations
+
+All eight transformation constants (see @ref{map read directions},
+ at ref{Rotating and Mirroring Maps}, @ref{Map Transformation}) are additionally
+packed into the table @code{MAP_ALL}, so a simple call to
+ at code{ipairs(MAP_ALL)} can iterate over all of them. @code{MAP_ALL} is provided
+without need to load libmap.
+
+In addition, libmap provides the function
+ at code{lib.map.random_transformation()} to pick one of the eight transformations
+by random.
+
+ at table @asis
+ at item @b{Syntax:}
+ at b{MAP_ALL} = @{@b{MAP_IDENT}, @b{MAP_ROT_CW}, @b{MAP_ROT_180}, @b{MAP_ROT_CCW}, @b{MAP_FLIP_BACKSLASH},
+           @b{MAP_FLIP_HORIZONTAL}, @b{MAP_FLIP_SLASH}, @b{MAP_FLIP_VERTICAL}@}
+
+ at i{randomtransformation} = @b{lib.map.random_transformation}()
+
+ at table @asis
+ at item @i{randomtransformation}
+A map transformation, randomly chosen from @code{MAP_ALL}.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+wo:drawMap(ti, po(5, 4), mymap, lib.map.random_transformation())
+ at end example
+
+ at item @b{Details:}
+When you use random map transformations, remember that four out of the eight map
+transformations switch height and width of the map they are applied to.
+ at end table
+
+
 @c ----------------- libimport --------------------
 @node libimport
 @section libimport
@@ -20445,6 +21597,7 @@
 @table @asis
 @item @b{Syntax:}
 @b{lib.import.unpack_multilevel}(@i{multilevel}, @i{sublevel_number}, @i{format})
+
 @table @asis
 @item @i{multilevel}
 A multilevel string.
@@ -20483,6 +21636,7 @@
 @table @asis
 @item @b{Syntax:}
 @b{lib.import.uncompress_rle}(@i{level}, @i{attribs})
+
 @table @asis
 @item @i{level}
 A level string.
@@ -20523,6 +21677,7 @@
 @table @asis
 @item @b{Syntax:}
 @b{lib.import.level_to_map}(@i{level}, @i{line_ending}, @i{default_key})
+
 @table @asis
 @item @i{level}
 A level string.
@@ -20558,6 +21713,7 @@
 @table @asis
 @item @b{Syntax:}
 @b{lib.import.map_sokoban}(@i{multilevel}, @i{sublevel_number}, @i{keylength_one})
+
 @table @asis
 @item @i{multilevel}
 A multilevel string.
@@ -20618,6 +21774,7 @@
 @table @asis
 @item @b{Syntax:}
 @b{lib.import.map_wanderer}(@i{monolevel})
+
 @table @asis
 @item @i{monolevel}
 A monolevel string.
@@ -20673,6 +21830,7 @@
 @table @asis
 @item @b{Syntax:}
 @b{lib.soko.create_sokoball}(@i{multilevel}, @i{sublevel_number}, @i{design}, @i{maxdesignnumber})
+
 @table @asis
 @item @i{multilevel}
 A multilevel string in the sense of @ref{libimport}.



From raoul at mail.berlios.de  Fri Jun 19 17:53:33 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Fri, 19 Jun 2009 17:53:33 +0200
Subject: [Enigma-game-svn] r1728 - in trunk: data data/gfx32 data/gfx40
	data/gfx48 data/levels/enigma_experimental src/floors
Message-ID: <200906191553.n5JFrXsb008413@sheep.berlios.de>

Author: raoul
Date: 2009-06-19 17:53:31 +0200 (Fri, 19 Jun 2009)
New Revision: 1728

Added:
   trunk/data/gfx32/fl_bridge_be.png
   trunk/data/gfx32/fl_bridge_bs.png
   trunk/data/gfx40/fl_bridge_be.png
   trunk/data/gfx40/fl_bridge_bs.png
   trunk/data/gfx48/fl_bridge_be.png
   trunk/data/gfx48/fl_bridge_bs.png
Modified:
   trunk/data/gfx32/fl_bridge_bn.png
   trunk/data/gfx32/fl_bridge_bw.png
   trunk/data/gfx32/fl_bridge_bw_closed.png
   trunk/data/gfx40/fl_bridge_bn.png
   trunk/data/gfx40/fl_bridge_bw.png
   trunk/data/gfx40/fl_bridge_bw_closed.png
   trunk/data/gfx48/fl_bridge_bn.png
   trunk/data/gfx48/fl_bridge_bw.png
   trunk/data/gfx48/fl_bridge_bw_closed.png
   trunk/data/levels/enigma_experimental/floors_1.xml
   trunk/data/models-2d.lua
   trunk/src/floors/BridgeFloor.cc
Log:
-> Added missing bridge images
-> Fixed bridge C++ model code
-> Added new bridge type to the all floors level


Added: trunk/data/gfx32/fl_bridge_be.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/fl_bridge_be.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/gfx32/fl_bridge_bn.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx32/fl_bridge_bs.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/fl_bridge_bs.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/gfx32/fl_bridge_bw.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx32/fl_bridge_bw_closed.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx40/fl_bridge_be.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/fl_bridge_be.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/gfx40/fl_bridge_bn.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx40/fl_bridge_bs.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx40/fl_bridge_bs.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/gfx40/fl_bridge_bw.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/fl_bridge_bw_closed.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx48/fl_bridge_be.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/fl_bridge_be.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/gfx48/fl_bridge_bn.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx48/fl_bridge_bs.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx48/fl_bridge_bs.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/gfx48/fl_bridge_bw.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/fl_bridge_bw_closed.png
===================================================================
(Binary files differ)

Modified: trunk/data/levels/enigma_experimental/floors_1.xml
===================================================================
--- trunk/data/levels/enigma_experimental/floors_1.xml	2009-06-18 23:38:11 UTC (rev 1727)
+++ trunk/data/levels/enigma_experimental/floors_1.xml	2009-06-19 15:53:31 UTC (rev 1728)
@@ -111,6 +111,8 @@
 {"fl_bridge", state=CLOSED, _text="fl_bridge, state=CLOSED"},
 {"fl_bridge", state=CLOSED, flavor="gc", _text="fl_bridge, flavor=\"gc\", state=CLOSED"},
 {"fl_bridge", state=CLOSED, flavor="bw", _text="fl_bridge, flavor=\"bw\", state=CLOSED"},
+{"fl_bridge", state=CLOSED, flavor="bs", _text="fl_bridge, flavor=\"bs\", state=CLOSED"},
+{"fl_bridge", state=CLOSED, flavor="be", _text="fl_bridge, flavor=\"be\", state=CLOSED"},
 {"fl_bridge", state=CLOSED, flavor="bn", _text="fl_bridge, flavor=\"bn\", state=CLOSED"},
 {"fl_fake_abyss", _text="fl_fake_abyss"},
 {"fl_fake_trigger", _text="fl_fake_trigger"},

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-06-18 23:38:11 UTC (rev 1727)
+++ trunk/data/models-2d.lua	2009-06-19 15:53:31 UTC (rev 1728)
@@ -438,43 +438,25 @@
 end
 
 do
-    DefImage("fl_bridge_bw_open")
-    DefImage("fl_bridge_bw_closed")
-    local namelist=DefSubimages("fl_bridge_bw", {h=9})
-    local frames = BuildFrames(namelist,70)
-    DefAnim("fl_bridge_bw_opening", frames)
-    DefAnim("fl_bridge_bw_closing", ReverseFrames(frames))
-end
+    local bridge_o = DefImage("fl_bridge_bw_open")
+    local bridge_c = DefImage("fl_bridge_bw_closed")
 
-do
-    DefAlias("fl_bridge_bs_open", "fl_bridge_bw_open")
-    DefAlias("fl_bridge_bs_closed", "fl_bridge_bw_closed")
---    local namelist=DefSubimages("fl_bridge_bs", {h=9})
---    local frames = BuildFrames(namelist,70)
---    DefAnim("fl_bridge_bs_opening", frames)
---    DefAnim("fl_bridge_bs_closing", ReverseFrames(frames))
-    DefAlias("fl_bridge_bs_opening", "fl_bridge_bn_opening")
-    DefAlias("fl_bridge_bs_opening", "fl_bridge_bn_closing")
-end
+    for key,suff in ipairs({"bw", "bs", "be", "bn"}) do
+        DefAlias("fl_bridge_"..suff.."_open", "fl_bridge_bw_open")
+        DefAlias("fl_bridge_"..suff.."_closed", "fl_bridge_bw_closed")
 
-do
-    DefAlias("fl_bridge_be_open", "fl_bridge_bw_open")
-    DefAlias("fl_bridge_be_closed", "fl_bridge_bw_closed")
---    local namelist=DefSubimages("fl_bridge_be", {h=9})
---    local frames = BuildFrames(namelist,70)
---    DefAnim("fl_bridge_be_opening", frames)
---    DefAnim("fl_bridge_be_closing", ReverseFrames(frames))
-    DefAlias("fl_bridge_be_opening", "fl_bridge_bw_opening")
-    DefAlias("fl_bridge_be_closing", "fl_bridge_bw_closing")
-end
+        local tmp=DefSubimages("fl_bridge_"..suff, {h=7})
+        local namelist = {}
+        namelist[1] = bridge_c
+        for i=1,7  do
+            namelist[i+1] = tmp[i]
+        end
+        namelist[9] = bridge_o
 
-do
-    DefAlias("fl_bridge_bn_open", "fl_bridge_bw_open")
-    DefAlias("fl_bridge_bn_closed", "fl_bridge_bw_closed")
-    local namelist=DefSubimages("fl_bridge_bn", {h=9})
-    local frames = BuildFrames(namelist,70)
-    DefAnim("fl_bridge_bn_opening", frames)
-    DefAnim("fl_bridge_bn_closing", ReverseFrames(frames))
+        local frames = BuildFrames(namelist,70)
+        DefAnim("fl_bridge_"..suff.."_opening", frames)
+        DefAnim("fl_bridge_"..suff.."_closing", ReverseFrames(frames))
+    end
 end
 
 ------------------------

Modified: trunk/src/floors/BridgeFloor.cc
===================================================================
--- trunk/src/floors/BridgeFloor.cc	2009-06-18 23:38:11 UTC (rev 1727)
+++ trunk/src/floors/BridgeFloor.cc	2009-06-19 15:53:31 UTC (rev 1728)
@@ -134,15 +134,15 @@
     std::string BridgeFloor::model_basename() const {
         std::string flavor = getAttr("flavor").to_string();
         if (flavor == "gc")
-            return "fl_bridge_g_";
+            return "fl_bridge_gc_";
         else if (flavor == "bw")
-            return "fl_bridge_w_";
+            return "fl_bridge_bw_";
         else if (flavor == "bs")
-            return "fl_bridge_s_";
+            return "fl_bridge_bs_";
         else if (flavor == "be")
-            return "fl_bridge_e_";
+            return "fl_bridge_be_";
         else if (flavor == "bn")
-            return "fl_bridge_n_";
+            return "fl_bridge_bn_";
         return "";
     }
     



From raoul at mail.berlios.de  Fri Jun 19 17:54:18 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Fri, 19 Jun 2009 17:54:18 +0200
Subject: [Enigma-game-svn] r1729 - team_levelpacks/team_test_new_api
Message-ID: <200906191554.n5JFsIpK008486@sheep.berlios.de>

Author: raoul
Date: 2009-06-19 17:54:18 +0200 (Fri, 19 Jun 2009)
New Revision: 1729

Modified:
   team_levelpacks/team_test_new_api/ralT068_1.xml
Log:
-> Added new bridge types in testlevel



Modified: team_levelpacks/team_test_new_api/ralT068_1.xml
===================================================================
--- team_levelpacks/team_test_new_api/ralT068_1.xml	2009-06-19 15:53:31 UTC (rev 1728)
+++ team_levelpacks/team_test_new_api/ralT068_1.xml	2009-06-19 15:54:18 UTC (rev 1729)
@@ -20,6 +20,8 @@
 ti[" "] = {"fl_sahara"}
 
 ti["-"] = {"fl_bridge_bw", "bridge#"}
+ti[","] = {"fl_bridge_bs", "bridge#"}
+ti["~"] = {"fl_bridge_be", "bridge#"}
 ti["|"] = {"fl_bridge_bn", "bridge#"}
 ti["."] = {"fl_bridge_gc", "bridge#"}
 
@@ -46,9 +48,9 @@
 ti["@"] = {"#ac_marble"}
 
 w, h = wo(ti, " ", {
-"    S    S     S    ",
+"  S S S S      S    ",
 "                    ",
-"    -    |     .    ",
+"  - , ~ |      .    ",
 "                    ",
 "    p  w   hhH      ",
 "    W    g     g    ",



From ral at mail.berlios.de  Sat Jun 20 00:28:30 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sat, 20 Jun 2009 00:28:30 +0200
Subject: [Enigma-game-svn] r1730 - in trunk/src: gui lev
Message-ID: <200906192228.n5JMSUAv023770@sheep.berlios.de>

Author: ral
Date: 2009-06-20 00:28:29 +0200 (Sat, 20 Jun 2009)
New Revision: 1730

Modified:
   trunk/src/gui/LevelMenu.cc
   trunk/src/gui/LevelPackConfig.cc
   trunk/src/lev/Index.hh
   trunk/src/lev/PersistentIndex.cc
   trunk/src/lev/PersistentIndex.hh
Log:
Trunk 1.1: 
- index update for auto generated levelpacks: press F7 in Levelmenu to
    detect new levels, remove deleted levels and update from level metadata.


Modified: trunk/src/gui/LevelMenu.cc
===================================================================
--- trunk/src/gui/LevelMenu.cc	2009-06-19 15:54:18 UTC (rev 1729)
+++ trunk/src/gui/LevelMenu.cc	2009-06-19 22:28:29 UTC (rev 1730)
@@ -193,10 +193,11 @@
         N_("Escape:"),              N_("Skip to main menu"),
         "F1:",                      N_("Show this help"),
         "F5:",                      0, // see below
+        "F7:",                      N_("Update levelpack"),
         N_("Arrows:"),              N_("Select level"),
         N_("Return:"),              N_("Play selected level"),
         N_("Back/Space:"),          N_("Previous/next levelpack"),
-        "u",                        N_("Mark current level as Unsolved"),
+        "u",                        N_("Mark current level as unsolved"),
     //    "s",                        N_("Mark current level as Solved"),
         N_("Alt+Return:"),          N_("Switch between fullscreen and window"),
         N_("Left click:"),               N_("Play selected level"),
@@ -227,6 +228,10 @@
                 case SDLK_F5:
                     next_unsolved();
                     break;
+                case SDLK_F7:
+                    lev::Index::getCurrentIndex()->updateFromProxies();
+                    draw_all();
+                    break;
                 case SDLK_u: {
                     lev::ScoreManager::instance()->markUnsolved(lev::Index::getCurrentProxy(), 
                             app.state->getInt("Difficulty"));

Modified: trunk/src/gui/LevelPackConfig.cc
===================================================================
--- trunk/src/gui/LevelPackConfig.cc	2009-06-19 15:54:18 UTC (rev 1729)
+++ trunk/src/gui/LevelPackConfig.cc	2009-06-19 22:28:29 UTC (rev 1730)
@@ -89,7 +89,7 @@
         
         if (indexName.empty())
             // new levelpack
-            packIndex = new lev::PersistentIndex(" ", false,
+            packIndex = new lev::PersistentIndex(" ", false, false,
                     INDEX_DEFAULT_PACK_LOCATION,  "", 
                     INDEX_STD_FILENAME, lev::Index::getCurrentGroup()); // mark as incomplete
         else

Modified: trunk/src/lev/Index.hh
===================================================================
--- trunk/src/lev/Index.hh	2009-06-19 15:54:18 UTC (rev 1729)
+++ trunk/src/lev/Index.hh	2009-06-19 22:28:29 UTC (rev 1730)
@@ -126,7 +126,7 @@
                 scoreUnitType varUnit = duration, std::string varTarget = "time",
                 std::map<std::string, std::string> varExtensions = nullExtensions);
         virtual void clear();
-        void updateFromProxies();
+        virtual void updateFromProxies();
 
         // ---------- LevelPack legacy methods ---to be renamed ------- */
         /*! Return the default SoundSet (see options::SoundSet for meaning) */

Modified: trunk/src/lev/PersistentIndex.cc
===================================================================
--- trunk/src/lev/PersistentIndex.cc	2009-06-19 15:54:18 UTC (rev 1729)
+++ trunk/src/lev/PersistentIndex.cc	2009-06-19 22:28:29 UTC (rev 1730)
@@ -66,27 +66,27 @@
     std::vector<PersistentIndex *> PersistentIndex::indexCandidates;
     
     void PersistentIndex::checkCandidate(PersistentIndex * candidate) {
-	if (candidate->getName().empty() ||
-		candidate->getCompatibility() > ENIGMACOMPATIBITLITY) {
-	    delete candidate;
-	} else {
-	    // check if new Index is an update of another
-	    for (int i = 0; i < indexCandidates.size(); i++) {
-		if (indexCandidates[i]->getName() != candidate->getName()) {
-		    continue;
-		} else if (indexCandidates[i]->getRelease() != candidate->getRelease() ||
-			indexCandidates[i]->getRevision() >= candidate->getRevision()) {
-		    delete candidate;
-		    return;
-		} else {
-		    // it is an update
-		    delete indexCandidates[i];
-		    indexCandidates[i] = candidate;
-		    return;
-		}
-	    }
-	    indexCandidates.push_back(candidate);
-	}
+        if (candidate->getName().empty() ||
+        	candidate->getCompatibility() > ENIGMACOMPATIBITLITY) {
+            delete candidate;
+        } else {
+            // check if new Index is an update of another
+            for (int i = 0; i < indexCandidates.size(); i++) {
+                if (indexCandidates[i]->getName() != candidate->getName()) {
+                    continue;
+                } else if (indexCandidates[i]->getRelease() != candidate->getRelease() ||
+                	indexCandidates[i]->getRevision() >= candidate->getRevision()) {
+                    delete candidate;
+                    return;
+                } else {
+                    // it is an update
+                    delete indexCandidates[i];
+                    indexCandidates[i] = candidate;
+                    return;
+                }
+            }
+            indexCandidates.push_back(candidate);
+        }
     }
     
     void PersistentIndex::registerPersistentIndices(bool onlySystemIndices) {
@@ -117,12 +117,12 @@
         for (std::set<std::string>::iterator i = candidates.begin(); 
                 i != candidates.end(); i++) {
             // register the index just on the system path even if the
-	    // user has an update on his path. We need to know the release to
-	    // decide if a user copy is an update
-	    PersistentIndex * anIndex = new PersistentIndex(*i, true);
+            // user has an update on his path. We need to know the release to
+            // decide if a user copy is an update
+            PersistentIndex * anIndex = new PersistentIndex(*i, true);
             anIndex->isUserOwned = false;
-	    Log << "precheck: " << *i << "\n";
-	    checkCandidate(anIndex);
+            Log << "precheck: " << *i << "\n";
+            checkCandidate(anIndex);
         }
 
         //add system cross indices
@@ -131,10 +131,10 @@
             while (dirIter->get_next(dirEntry)) {
                 if (!dirEntry.is_dir && dirEntry.name.size() > 4 && 
                         (dirEntry.name.rfind(".xml") == dirEntry.name.size() - 4)) {
-                    PersistentIndex * anIndex = new PersistentIndex("enigma_cross", true,
+                    PersistentIndex * anIndex = new PersistentIndex("enigma_cross", true, false,
                             INDEX_DEFAULT_PACK_LOCATION, "", dirEntry.name);
                     anIndex->isUserOwned = false;
-		    checkCandidate(anIndex);
+                    checkCandidate(anIndex);
                 }
             }
         }
@@ -171,7 +171,7 @@
         for (std::set<std::string>::iterator i = candidates2.begin(); 
                 i != candidates2.end(); i++) {
             PersistentIndex * anIndex = new PersistentIndex(*i, false);
-	    checkCandidate(anIndex);
+            checkCandidate(anIndex);
         }
        
         //add user cross indices
@@ -179,79 +179,39 @@
         while (dirIter->get_next(dirEntry)) {
             if (!dirEntry.is_dir && dirEntry.name.size() > 4 && 
                     (dirEntry.name.rfind(".xml") == dirEntry.name.size() - 4)) {
-                PersistentIndex * anIndex = new PersistentIndex("cross", false, 
+                PersistentIndex * anIndex = new PersistentIndex("cross", false, false,
                         INDEX_DEFAULT_PACK_LOCATION, "", dirEntry.name);
                 checkCandidate(anIndex);
             }
         }
         delete dirIter;
         
-	for (int i = 0; i < indexCandidates.size(); i++) {
-	    Index::registerIndex(indexCandidates[i]);
-	}
+        for (int i = 0; i < indexCandidates.size(); i++) {
+            Index::registerIndex(indexCandidates[i]);
+        }
 	
         // register auto not yet registered new files
-        PersistentIndex * autoIndex = new PersistentIndex("auto", false, 
+        PersistentIndex * autoIndex = new PersistentIndex("auto", false, true,
                 INDEX_AUTO_PACK_LOCATION, INDEX_AUTO_PACK_NAME);
         autoIndex->isEditable = false;
-        dirIter = DirIter::instance(app.userPath + "/levels/auto");
-        while (dirIter->get_next(dirEntry)) { 
-            if( !dirEntry.is_dir) {
-                if (dirEntry.name.size() > 4 && (
-                        (dirEntry.name.rfind(".xml") == dirEntry.name.size() - 4) ||
-                        (dirEntry.name.rfind(".lua") == dirEntry.name.size() - 4))) {
-                    Proxy * newProxy = Proxy::autoRegisterLevel("auto", 
-                            dirEntry.name.substr(0, dirEntry.name.size() - 4));
-                    if (newProxy != NULL) {
-                        // first check that the proxy is not in the index
-                        //  - may occur if the level is stored as .xml and .lua in the folder
-                        if (!autoIndex->containsProxy(newProxy)) {
-                            // it is new, add it
-                            autoIndex->appendProxy(newProxy);
-                        }
-                    }
-                }
-            }
-        }
-        delete dirIter;
         Index::registerIndex(autoIndex);
         
         // register team auto not yet registered new files
-        PersistentIndex * teamautoIndex = NULL;
-        dirIter = DirIter::instance(app.userPath + "/levels/team_test_new_api");
-        while (dirIter->get_next(dirEntry)) { 
-            if( !dirEntry.is_dir) {
-                if (dirEntry.name.size() > 4 && (
-                        (dirEntry.name.rfind(".xml") == dirEntry.name.size() - 4) ||
-                        (dirEntry.name.rfind(".lua") == dirEntry.name.size() - 4))) {
-                    if (teamautoIndex == NULL) {
-                        teamautoIndex = new PersistentIndex("team_test_new_api", false, 
-                                75000, "test_new_api");
-                        teamautoIndex->isEditable = false;
-                    }
-                    Proxy * newProxy = Proxy::autoRegisterLevel("team_test_new_api", 
-                            dirEntry.name.substr(0, dirEntry.name.size() - 4));
-                    if (newProxy != NULL) {
-                        // first check that the proxy is not in the index
-                        //  - may occur if the level is stored as .xml and .lua in the folder
-                        if (!teamautoIndex->containsProxy(newProxy)) {
-                            // it is new, add it
-                            teamautoIndex->appendProxy(newProxy);
-                        }
-                    }
-                }
-            }
-        }
-        delete dirIter;
-        if (teamautoIndex != NULL)
+        PersistentIndex * teamautoIndex = new PersistentIndex("team_test_new_api", false, true,
+                75000, "test_new_api");
+        if (teamautoIndex->size() > 0) {
+            teamautoIndex->isEditable = false;
             Index::registerIndex(teamautoIndex);
+        } else {
+            delete teamautoIndex;
+        }
         
         // check if history is available - else generate a new index
         Index * foundHistory = Index::findIndex("History");
         if ( foundHistory != NULL) {
             historyIndex = dynamic_cast<PersistentIndex *>(foundHistory);
         } else {
-            historyIndex = new PersistentIndex("cross", false, INDEX_HISTORY_PACK_LOCATION, 
+            historyIndex = new PersistentIndex("cross", false, false, INDEX_HISTORY_PACK_LOCATION, 
                     INDEX_HISTORY_PACK_NAME, "history.xml");
             Index::registerIndex(historyIndex);
         }
@@ -274,10 +234,10 @@
         }
     }
 
-    PersistentIndex::PersistentIndex(std::string thePackPath, bool systemOnly, 
+    PersistentIndex::PersistentIndex(std::string thePackPath, bool systemOnly, bool autoLoading,
             double defaultLocation, std::string anIndexName, 
             std::string theIndexFilename, std::string aGroupName) : 
-            Index(anIndexName, aGroupName, defaultLocation), packPath (thePackPath), 
+            Index(anIndexName, aGroupName, defaultLocation), packPath (thePackPath), isAuto (autoLoading),
             indexFilename(theIndexFilename), isModified (false),
             isUserOwned (true), isEditable (true), release (1), revision (1),
             compatibility (1.00), doc(NULL) {
@@ -290,9 +250,36 @@
             doc->release();
             doc = NULL;
         }
-        // auto and new levelpacks are not loadable
-        if (packPath == " " || packPath == "auto")
-            return;    // as long as Auto is not editable
+        // new levelpacks are not loadable
+        if (packPath == " ")
+            return;
+        
+        if (isAuto) {
+            DirIter * dirIter;
+            DirEntry dirEntry;
+            dirIter = DirIter::instance(app.userPath + "/levels/" + packPath);
+            while (dirIter->get_next(dirEntry)) { 
+                if( !dirEntry.is_dir) {
+                    if (dirEntry.name.size() > 4 && (
+                            (dirEntry.name.rfind(".xml") == dirEntry.name.size() - 4) ||
+                            (dirEntry.name.rfind(".lua") == dirEntry.name.size() - 4))) {
+                        Proxy * newProxy = Proxy::autoRegisterLevel(packPath, 
+                                dirEntry.name.substr(0, dirEntry.name.size() - 4));
+                        if (newProxy != NULL) {
+                            // first check that the proxy is not in the index
+                            //  - may occur if the level is stored as .xml and .lua in the folder
+                            if (!containsProxy(newProxy)) {
+                                // it is new, add it
+                                appendProxy(newProxy);
+                            }
+                            // do not delete Proxy if not used - we are not the owner!
+                        }
+                    }
+                }
+            }
+            delete dirIter;
+            return;
+        }
 
         std::auto_ptr<std::istream> isptr;
         ByteVec indexCode;
@@ -325,7 +312,7 @@
                     std::auto_ptr<DOMLSInput> domInputIndexSource ( new Wrapper4InputSource(
                             new MemBufInputSource(reinterpret_cast<const XMLByte *>(&(indexCode[0])),
                             indexCode.size(), absIndexPath.c_str(), false)));
-                 doc = app.domParser->parse(domInputIndexSource.get());
+                    doc = app.domParser->parse(domInputIndexSource.get());
 #else    
                     std::auto_ptr<Wrapper4InputSource> domInputIndexSource ( new Wrapper4InputSource(
                             new MemBufInputSource(reinterpret_cast<const XMLByte *>(&(indexCode[0])),
@@ -675,6 +662,15 @@
         }
     }
     
+    void PersistentIndex::updateFromProxies() {
+        if (!isAuto)
+            return;
+        
+        clear();
+        load(false);
+        Index::updateFromProxies();
+    }
+    
     bool PersistentIndex::save(bool allowOverwrite) {
         bool result = true;
         
@@ -864,7 +860,7 @@
             std::string thePackPath, bool isZip, std::string anIndexName, 
             std::string theIndexFilename) : 
             Index(anIndexName, INDEX_DEFAULT_GROUP, Index::getNextUserLocation()), 
-            indexFilename(theIndexFilename), isModified (false), 
+            indexFilename(theIndexFilename), isAuto (false), isModified (false), 
             isUserOwned (true), isEditable (true), release (1), revision (1),
             compatibility (1.00), doc(NULL) {
         Log << "PersistentIndex convert 0.92 index " << thePackPath << " - " << anIndexName <<"\n";

Modified: trunk/src/lev/PersistentIndex.hh
===================================================================
--- trunk/src/lev/PersistentIndex.hh	2009-06-19 15:54:18 UTC (rev 1729)
+++ trunk/src/lev/PersistentIndex.hh	2009-06-19 22:28:29 UTC (rev 1730)
@@ -60,7 +60,7 @@
          * 
          * thePackPath " " for a new not yet defined path
          */
-        PersistentIndex(std::string thePackPath, bool systemOnly, 
+        PersistentIndex(std::string thePackPath, bool systemOnly, bool isAuto =false,
                 double defaultLocation = INDEX_DEFAULT_PACK_LOCATION,
                 std::string anIndexName = "",
                 std::string theIndexFilename = INDEX_STD_FILENAME, 
@@ -101,6 +101,7 @@
         void erase(int pos);
         void exchange(int pos1, int pos2);
         virtual bool isSource(Proxy * aProxy);
+        virtual void updateFromProxies();
         bool save(bool allowOverwrite = true);
     protected:
         std::string packPath;  // "auto", "",...
@@ -113,16 +114,17 @@
         bool isModified;
         bool isUserOwned;
         bool isEditable;
+        bool isAuto;
         std::string indexUrl;
     private:
-	static std::vector<PersistentIndex *> indexCandidates;
+        static std::vector<PersistentIndex *> indexCandidates;
         std::string absIndexPath;
         XERCES_CPP_NAMESPACE_QUALIFIER DOMDocument *doc;
         XERCES_CPP_NAMESPACE_QUALIFIER DOMElement *infoElem;
         XERCES_CPP_NAMESPACE_QUALIFIER DOMElement *updateElem;
         XERCES_CPP_NAMESPACE_QUALIFIER DOMElement *levelsElem;
         
-	static void checkCandidate(PersistentIndex * candidate);
+        static void checkCandidate(PersistentIndex * candidate);
         // legacy 0.92
         void parsePar(const string& par, int& par_value, std::string& par_text);
     };



From ral at mail.berlios.de  Sun Jun 21 16:37:53 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 21 Jun 2009 16:37:53 +0200
Subject: [Enigma-game-svn] r1731 - in trunk: data data/gfx32 data/gfx40
	data/gfx48 src src/items src/stones
Message-ID: <200906211437.n5LEbreW022165@sheep.berlios.de>

Author: ral
Date: 2009-06-21 16:37:51 +0200 (Sun, 21 Jun 2009)
New Revision: 1731

Added:
   trunk/data/gfx32/st_bluesand.png
   trunk/data/gfx32/st_brick.png
   trunk/data/gfx32/st_coinslot.png
   trunk/data/gfx32/st_coinslot_insert.png
   trunk/data/gfx32/st_floppy_off.png
   trunk/data/gfx32/st_floppy_on.png
   trunk/data/gfx32/st_key_off.png
   trunk/data/gfx32/st_key_on.png
   trunk/data/gfx32/st_panel.png
   trunk/data/gfx32/st_stoneimpulse.png
   trunk/data/gfx32/st_stoneimpulse_hollow.png
   trunk/data/gfx40/st_bluesand.png
   trunk/data/gfx40/st_brick.png
   trunk/data/gfx40/st_coinslot.png
   trunk/data/gfx40/st_coinslot_insert.png
   trunk/data/gfx40/st_floppy_off.png
   trunk/data/gfx40/st_floppy_on.png
   trunk/data/gfx40/st_key_off.png
   trunk/data/gfx40/st_key_on.png
   trunk/data/gfx40/st_panel.png
   trunk/data/gfx40/st_stoneimpulse.png
   trunk/data/gfx40/st_stoneimpulse_hollow.png
   trunk/data/gfx48/st_bluesand.png
   trunk/data/gfx48/st_brick.png
   trunk/data/gfx48/st_coinslot.png
   trunk/data/gfx48/st_coinslot_insert.png
   trunk/data/gfx48/st_floppy_off.png
   trunk/data/gfx48/st_floppy_on.png
   trunk/data/gfx48/st_key_off.png
   trunk/data/gfx48/st_key_on.png
   trunk/data/gfx48/st_panel.png
   trunk/data/gfx48/st_stoneimpulse.png
   trunk/data/gfx48/st_stoneimpulse_hollow.png
Removed:
   trunk/data/gfx32/st-bigbluesand.png
   trunk/data/gfx32/st-bigbrick.png
   trunk/data/gfx32/st-bigpanel.png
   trunk/data/gfx32/st-coin2slot.png
   trunk/data/gfx32/st-coinslot.png
   trunk/data/gfx32/st-floppy1.png
   trunk/data/gfx32/st-floppy2.png
   trunk/data/gfx32/st-key1.png
   trunk/data/gfx32/st-key2.png
   trunk/data/gfx32/st-stoneimpulse-hollow.png
   trunk/data/gfx32/st-stoneimpulse.png
   trunk/data/gfx40/st-bigbluesand.png
   trunk/data/gfx40/st-bigbrick.png
   trunk/data/gfx40/st-bigpanel.png
   trunk/data/gfx40/st-coin2slot.png
   trunk/data/gfx40/st-coinslot.png
   trunk/data/gfx40/st-floppy1.png
   trunk/data/gfx40/st-floppy2.png
   trunk/data/gfx40/st-key1.png
   trunk/data/gfx40/st-key2.png
   trunk/data/gfx40/st-stoneimpulse-hollow.png
   trunk/data/gfx40/st-stoneimpulse.png
   trunk/data/gfx48/st-bigbluesand.png
   trunk/data/gfx48/st-bigbrick.png
   trunk/data/gfx48/st-bigpanel.png
   trunk/data/gfx48/st-coin2slot.png
   trunk/data/gfx48/st-coinslot.png
   trunk/data/gfx48/st-floppy1.png
   trunk/data/gfx48/st-floppy2.png
   trunk/data/gfx48/st-key1.png
   trunk/data/gfx48/st-key2.png
   trunk/data/gfx48/st-stoneimpulse-hollow.png
   trunk/data/gfx48/st-stoneimpulse.png
Modified:
   trunk/data/models-2d.lua
   trunk/src/items/Trigger.cc
   trunk/src/lua.cc
   trunk/src/stones/CoinSlot.cc
   trunk/src/stones/FloppySwitch.cc
   trunk/src/stones/KeySwitch.cc
   trunk/src/stones/StoneImpulse.cc
Log:
Trunk 1.1:
- fix trigger wrong count in case of dying actors being resurrected
- fix GCC 4.4.0 const warning in lua.cc
- simplify models-2d.lua bridge model definition
- image renaming: cluster stones, st_key, st_floppy, st_coinslot, st_stoneimpulse

Deleted: trunk/data/gfx32/st-bigbluesand.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-bigbrick.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-bigpanel.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-coin2slot.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-coinslot.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-floppy1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-floppy2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-key1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-key2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-stoneimpulse-hollow.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx32/st-stoneimpulse.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx32/st_bluesand.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx32/st_bluesand.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Copied: trunk/data/gfx32/st_brick.png (from rev 1730, trunk/data/gfx32/st-bigbrick.png)

Copied: trunk/data/gfx32/st_coinslot.png (from rev 1730, trunk/data/gfx32/st-coinslot.png)

Copied: trunk/data/gfx32/st_coinslot_insert.png (from rev 1730, trunk/data/gfx32/st-coin2slot.png)

Copied: trunk/data/gfx32/st_floppy_off.png (from rev 1730, trunk/data/gfx32/st-floppy1.png)

Copied: trunk/data/gfx32/st_floppy_on.png (from rev 1730, trunk/data/gfx32/st-floppy2.png)

Copied: trunk/data/gfx32/st_key_off.png (from rev 1730, trunk/data/gfx32/st-key1.png)

Copied: trunk/data/gfx32/st_key_on.png (from rev 1730, trunk/data/gfx32/st-key2.png)

Copied: trunk/data/gfx32/st_panel.png (from rev 1730, trunk/data/gfx32/st-bigpanel.png)

Copied: trunk/data/gfx32/st_stoneimpulse.png (from rev 1730, trunk/data/gfx32/st-stoneimpulse.png)

Copied: trunk/data/gfx32/st_stoneimpulse_hollow.png (from rev 1730, trunk/data/gfx32/st-stoneimpulse-hollow.png)

Deleted: trunk/data/gfx40/st-bigbluesand.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-bigbrick.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-bigpanel.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-coin2slot.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-coinslot.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-floppy1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-floppy2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-key1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-key2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-stoneimpulse-hollow.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx40/st-stoneimpulse.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx40/st_bluesand.png (from rev 1730, trunk/data/gfx40/st-bigbluesand.png)

Copied: trunk/data/gfx40/st_brick.png (from rev 1730, trunk/data/gfx40/st-bigbrick.png)

Copied: trunk/data/gfx40/st_coinslot.png (from rev 1730, trunk/data/gfx40/st-coinslot.png)

Copied: trunk/data/gfx40/st_coinslot_insert.png (from rev 1730, trunk/data/gfx40/st-coin2slot.png)

Copied: trunk/data/gfx40/st_floppy_off.png (from rev 1730, trunk/data/gfx40/st-floppy1.png)

Copied: trunk/data/gfx40/st_floppy_on.png (from rev 1730, trunk/data/gfx40/st-floppy2.png)

Copied: trunk/data/gfx40/st_key_off.png (from rev 1730, trunk/data/gfx40/st-key1.png)

Copied: trunk/data/gfx40/st_key_on.png (from rev 1730, trunk/data/gfx40/st-key2.png)

Copied: trunk/data/gfx40/st_panel.png (from rev 1730, trunk/data/gfx40/st-bigpanel.png)

Copied: trunk/data/gfx40/st_stoneimpulse.png (from rev 1730, trunk/data/gfx40/st-stoneimpulse.png)

Copied: trunk/data/gfx40/st_stoneimpulse_hollow.png (from rev 1730, trunk/data/gfx40/st-stoneimpulse-hollow.png)

Deleted: trunk/data/gfx48/st-bigbluesand.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-bigbrick.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-bigpanel.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-coin2slot.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-coinslot.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-floppy1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-floppy2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-key1.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-key2.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-stoneimpulse-hollow.png
===================================================================
(Binary files differ)

Deleted: trunk/data/gfx48/st-stoneimpulse.png
===================================================================
(Binary files differ)

Copied: trunk/data/gfx48/st_bluesand.png (from rev 1730, trunk/data/gfx48/st-bigbluesand.png)

Copied: trunk/data/gfx48/st_brick.png (from rev 1730, trunk/data/gfx48/st-bigbrick.png)

Copied: trunk/data/gfx48/st_coinslot.png (from rev 1730, trunk/data/gfx48/st-coinslot.png)

Copied: trunk/data/gfx48/st_coinslot_insert.png (from rev 1730, trunk/data/gfx48/st-coin2slot.png)

Copied: trunk/data/gfx48/st_floppy_off.png (from rev 1730, trunk/data/gfx48/st-floppy1.png)

Copied: trunk/data/gfx48/st_floppy_on.png (from rev 1730, trunk/data/gfx48/st-floppy2.png)

Copied: trunk/data/gfx48/st_key_off.png (from rev 1730, trunk/data/gfx48/st-key1.png)

Copied: trunk/data/gfx48/st_key_on.png (from rev 1730, trunk/data/gfx48/st-key2.png)

Copied: trunk/data/gfx48/st_panel.png (from rev 1730, trunk/data/gfx48/st-bigpanel.png)

Copied: trunk/data/gfx48/st_stoneimpulse.png (from rev 1730, trunk/data/gfx48/st-stoneimpulse.png)

Copied: trunk/data/gfx48/st_stoneimpulse_hollow.png (from rev 1730, trunk/data/gfx48/st-stoneimpulse-hollow.png)

Modified: trunk/data/models-2d.lua
===================================================================
--- trunk/data/models-2d.lua	2009-06-19 22:28:29 UTC (rev 1730)
+++ trunk/data/models-2d.lua	2009-06-21 14:37:51 UTC (rev 1731)
@@ -445,14 +445,9 @@
         DefAlias("fl_bridge_"..suff.."_open", "fl_bridge_bw_open")
         DefAlias("fl_bridge_"..suff.."_closed", "fl_bridge_bw_closed")
 
-        local tmp=DefSubimages("fl_bridge_"..suff, {h=7})
-        local namelist = {}
-        namelist[1] = bridge_c
-        for i=1,7  do
-            namelist[i+1] = tmp[i]
-        end
-        namelist[9] = bridge_o
-
+        local namelist=DefSubimages("fl_bridge_"..suff, {h=7})
+	table.insert(namelist, 1, bridge_c)
+	table.insert(namelist, bridge_o)
         local frames = BuildFrames(namelist,70)
         DefAnim("fl_bridge_"..suff.."_opening", frames)
         DefAnim("fl_bridge_"..suff.."_closing", ReverseFrames(frames))
@@ -800,8 +795,8 @@
     DefStone("st_dummy")
     DefImage("st-easymode")
     DefStone("st_flat_fire")
-    DefStone("st-floppy0", "sh_round", {filename="st-floppy1"})
-    DefStone("st-floppy1", "sh_round", {filename="st-floppy2"})
+    DefStone("st_floppy_off", "sh_round")
+    DefStone("st_floppy_on", "sh_round")
     DefStone("st_box_rock", "sh_round")
     DefStone("st_rawglass", "sh_glass")
     DefStone("st_rawglass_quad", "sh_rawglass_quad")
@@ -812,8 +807,8 @@
     DefStone("st_grate_framed", "sh_grate_framed")
     DefStone("st_portal_horse", "sh_portal_horse")
     DefStone("st_greenbrown", "sh_round")
-    DefStone("st-key0", "sh_round", {filename="st-key1"})
-    DefStone("st-key1", "sh_round", {filename="st-key2"})
+    DefStone("st_key_off", "sh_round")
+    DefStone("st_key_on", "sh_round")
     DefStone("st_redbrown", "sh_round")
     DefStone("st_metal")
     DefStone("st_redrock")
@@ -861,47 +856,23 @@
     DefShModel("st_actorimpulse", namelist[1], shnamelist[1])
 end
 
--- st-bigbluesand --
-do
-    DefSubimages("st-bigbluesand", {modelname="st-bigbluesandx",w=4,h=4})
-    for i=1,16 do DefSolidStone("st-bigbluesand"..i, "st-bigbluesandx"..i) end
-    DefSolidStone("st-blue-sand", "st-bigbluesandx1")
-end
-
--- st-bigbrick --
-do
-    DefSubimages("st-bigbrick", {modelname="st-bigbrickx",w=4,h=4})
-    for i=1,16 do DefSolidStone("st-bigbrick"..i, "st-bigbrickx"..i) end
-    DefSolidStone("st-brick", "st-bigbrickx1")
-    DefSolidStone("st_magic_brick", "st-bigbrickx1")
-end
-
--- st-bigpanel --
-do
-    DefSubimages("st-bigpanel", {modelname="st-bigpanelx",w=4,h=4})
-    for i=1,16 do DefSolidStone("st-bigpanel"..i, "st-bigpanelx"..i) end
-    DefSolidStone("st-panel", "st-bigpanelx1")
-    -- st-wood_001. Remove when it's time!
-    DefSolidStone("st-wood_001", "st-bigpanelx1")
-end
-
 -- st_bluesand --
 do
-    DefSubimages("st-bigbluesand", {modelname="st_bluesandx",w=4,h=4})
+    DefSubimages("st_bluesand", {modelname="st_bluesandx",w=4,h=4})
     for i=0,15 do DefSolidStone("st_bluesand"..i, "st_bluesandx"..(i+1)) end
     DefSolidStone("st_bluesand", "st_bluesandx1")
 end
 
 -- st_brick --
 do
-    DefSubimages("st-bigbrick", {modelname="st_brickx",w=4,h=4})
+    DefSubimages("st_brick", {modelname="st_brickx",w=4,h=4})
     for i=0,15 do DefSolidStone("st_brick"..i, "st_brickx"..(i+1)) end
     DefSolidStone("st_brick", "st_brickx1")
 end
 
 -- st_panel --
 do
-    DefSubimages("st-bigpanel", {modelname="st_panelx",w=4,h=4})
+    DefSubimages("st_panel", {modelname="st_panelx",w=4,h=4})
     for i=0,15 do DefSolidStone("st_panel"..i, "st_panelx"..(i+1)) end
     DefSolidStone("st_panel", "st_panelx1")
 end
@@ -971,13 +942,13 @@
     make_chess("_white")
 end
 
--- st-coinslot --
+-- st_coinslot --
 do
-    DefStone("st-coinslot")
-    local images = DefSubimages("st-coin2slot", {h=18})
-    DefAnim("st-coin2slot-anim", BuildFrames(images, 20))
-    DefSolidStone("st-coin2slot", "st-coin2slot-anim")
-    DefSolidStone("st-coinslot-active", "st-coin2slot18")
+    DefStone("st_coinslot")
+    local images = DefSubimages("st_coinslot_insert", {h=18})
+    DefAnim("st_coinslot_anim", BuildFrames(images, 20))
+    DefSolidStone("st_coinslot_insert", "st_coinslot_anim")
+    DefSolidStone("st_coinslot_active", "st_coinslot_insert18")
 end
 
 -- st-disco --
@@ -1213,35 +1184,35 @@
     DefShModel("st-shogun7", "st-shogun-fg7", "sh_shogun_s")
 end
 
--- st-stoneimpulse --
+-- st_stoneimpulse --
 --
 -- Note: It's important that the duration of the closing animation
 -- (anim2) is longer than the opening animation (anim1). Otherwise
 -- impulse stones do not work properly!
 do
-   local images = DefSubimages("st-stoneimpulse", {h=6})
-   DefRoundStone("st-stoneimpulse", images[1])
-   DefRoundStone("st-stoneimpulse-steady", images[6])
+   local images = DefSubimages("st_stoneimpulse", {h=6})
+   DefRoundStone("st_stoneimpulse", images[1])
+   DefRoundStone("st_stoneimpulse_steady", images[6])
    local frames = {}
    for i=1,4 do table.insert(frames, images[i]) end
-   DefAnim("stoneimpulse-anim1", BuildFrames(frames, 55))
-   DefRoundStone("st-stoneimpulse-anim1", "stoneimpulse-anim1")
+   DefAnim("stoneimpulse_anim1", BuildFrames(frames, 55))
+   DefRoundStone("st_stoneimpulse_anim1", "stoneimpulse_anim1")
    table.insert(frames, images[4]) -- add 1 frame to make closing anim longer!
-   DefAnim("stoneimpulse-anim2", ReverseFrames(BuildFrames(frames, 55)))
-   DefRoundStone("st-stoneimpulse-anim2", "stoneimpulse-anim2")
+   DefAnim("stoneimpulse_anim2", ReverseFrames(BuildFrames(frames, 55)))
+   DefRoundStone("st_stoneimpulse_anim2", "stoneimpulse_anim2")
 end
 
--- st-stoneimpulse-hollow --
+-- st_stoneimpulse_hollow --
 do
-   local images = DefSubimages("st-stoneimpulse-hollow", {h=4})
-   DefShModel("st-stoneimpulse-hollow", images[1], "sh_floating")
+   local images = DefSubimages("st_stoneimpulse_hollow", {h=4})
+   DefShModel("st_stoneimpulse_hollow", images[1], "sh_floating")
    local frames = {}
    for i=1,4 do table.insert(frames, images[i]) end
-   DefAnim("stoneimpulse-hollow-anim1", BuildFrames(frames, 55))
-   DefShModel("st-stoneimpulse-hollow-anim1", "stoneimpulse-hollow-anim1", "sh_floating")
+   DefAnim("stoneimpulse_hollow_anim1", BuildFrames(frames, 55))
+   DefShModel("st_stoneimpulse_hollow_anim1", "stoneimpulse_hollow_anim1", "sh_floating")
    table.insert(frames, images[4]) -- add 1 frame to make closing anim longer!
-   DefAnim("stoneimpulse-hollow-anim2", ReverseFrames(BuildFrames(frames, 55)))
-   DefShModel("st-stoneimpulse-hollow-anim2", "stoneimpulse-hollow-anim2", "sh_floating")
+   DefAnim("stoneimpulse_hollow_anim2", ReverseFrames(BuildFrames(frames, 55)))
+   DefShModel("st_stoneimpulse_hollow_anim2", "stoneimpulse_hollow_anim2", "sh_floating")
 end
 
 do

Modified: trunk/src/items/Trigger.cc
===================================================================
--- trunk/src/items/Trigger.cc	2009-06-19 22:28:29 UTC (rev 1730)
+++ trunk/src/items/Trigger.cc	2009-06-21 14:37:51 UTC (rev 1731)
@@ -87,12 +87,12 @@
     }
     
     void Trigger::actor_enter(Actor *a) {
-        if (!(a->is_flying() || a->is_dead()))
+        if (!(a->is_flying() || a->isMoribund()))
             updateIState(+1, !server::WorldInitialized);
     }
     
     void Trigger::actor_leave(Actor *a) {
-        if (!(a->is_flying() || a->is_dead()))
+        if (!(a->is_flying() || a->isMoribund()))
             updateIState(-1, !server::WorldInitialized);
     }
     
@@ -105,7 +105,7 @@
         GetActorsInsideField(get_pos(), actors);
         int count = 0;
         for (std::vector<Actor*>::iterator itr = actors.begin(); itr != actors.end(); ++itr)
-            if (!((*itr)->is_flying() || (*itr)->is_dead())) count++;
+            if (!((*itr)->is_flying() || (*itr)->isMoribund())) count++;
         return count;
     }
     

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2009-06-19 22:28:29 UTC (rev 1730)
+++ trunk/src/lua.cc	2009-06-21 14:37:51 UTC (rev 1731)
@@ -905,7 +905,7 @@
 
     const char *dir     = lua_tostring(L,3);
     const char *allowed = "wsen";
-    char       *found   = strchr(allowed, dir[0]);
+    const char *found   = strchr(allowed, dir[0]);
 
     if (found && found[0]) 
         AddScramble(GridPos(x,y), enigma::Direction(found-allowed));

Modified: trunk/src/stones/CoinSlot.cc
===================================================================
--- trunk/src/stones/CoinSlot.cc	2009-06-19 22:28:29 UTC (rev 1730)
+++ trunk/src/stones/CoinSlot.cc	2009-06-21 14:37:51 UTC (rev 1731)
@@ -80,7 +80,7 @@
     void CoinSlot::init_model() {
         // just static models
         if (state <= ON)
-            set_model(state==ON ? "st-coinslot-active" : "st-coinslot");
+            set_model(state==ON ? "st_coinslot_active" : "st_coinslot");
     }
 
     void CoinSlot::animcb() {
@@ -166,11 +166,11 @@
                 ASSERT(newIState != ON, XLevelRuntime, "Coinslot - illegal state change from OFF to ON");
                 actionValue = true;
                 doAction = (newIState == INSERT_ON);
-                set_anim("st-coin2slot");
+                set_anim("st_coinslot_insert");
                 break;
             case ON :
                 if (newIState == INSERT_ON)
-                    set_anim("st-coin2slot");
+                    set_anim("st_coinslot_insert");
                 else if (newIState == OFF) {
                     actionValue = false;
                     doAction = true;
@@ -187,7 +187,7 @@
             case INSERT_ON :
                 switch (newIState) {
                     case INSERT_ON :
-                        set_anim("st-coin2slot");  // may restart anim!
+                        set_anim("st_coinslot_insert");  // may restart anim!
                         break;
                     case ON :
                         doInit = true;

Modified: trunk/src/stones/FloppySwitch.cc
===================================================================
--- trunk/src/stones/FloppySwitch.cc	2009-06-19 22:28:29 UTC (rev 1730)
+++ trunk/src/stones/FloppySwitch.cc	2009-06-21 14:37:51 UTC (rev 1731)
@@ -41,7 +41,7 @@
     }
 
     void FloppySwitch::init_model() {
-        set_model(ecl::strf("st-floppy%s", state == ON ? "1" : "0"));
+        set_model(ecl::strf("st_floppy_%s", state == ON ? "on" : "off"));
     }
 
     void FloppySwitch::actor_hit(const StoneContact &sc) {

Modified: trunk/src/stones/KeySwitch.cc
===================================================================
--- trunk/src/stones/KeySwitch.cc	2009-06-19 22:28:29 UTC (rev 1730)
+++ trunk/src/stones/KeySwitch.cc	2009-06-21 14:37:51 UTC (rev 1731)
@@ -46,7 +46,7 @@
     }
 
     void KeySwitch::init_model() {
-        set_model(ecl::strf("st-key%s", state == ON ? "1" : "0"));
+        set_model(ecl::strf("st_key_%s", state == ON ? "on" : "off"));
     }
 
     void KeySwitch::actor_hit(const StoneContact &sc) {

Modified: trunk/src/stones/StoneImpulse.cc
===================================================================
--- trunk/src/stones/StoneImpulse.cc	2009-06-19 22:28:29 UTC (rev 1730)
+++ trunk/src/stones/StoneImpulse.cc	2009-06-21 14:37:51 UTC (rev 1731)
@@ -139,11 +139,11 @@
 
     void StoneImpulse::init_model() {
         if (state == IDLE)
-            set_model(ecl::strf("st-stoneimpulse%s", isHollow() ? "-hollow" : ((objFlags & OBJBIT_STEADY) ? "-steady" : "")));
+            set_model(ecl::strf("st_stoneimpulse%s", isHollow() ? "_hollow" : ((objFlags & OBJBIT_STEADY) ? "_steady" : "")));
         else if (state == BREAKING)
             set_anim("st_stoneimpulse_breaking");
         else
-            set_anim(ecl::strf("st-stoneimpulse%s-anim%d", isHollow() ? "-hollow" : "",
+            set_anim(ecl::strf("st_stoneimpulse%s_anim%d", isHollow() ? "_hollow" : "",
                     state == EXPANDING ? 1 : 2));
     }
     



From ral at mail.berlios.de  Sun Jun 21 17:19:06 2009
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 21 Jun 2009 17:19:06 +0200
Subject: [Enigma-game-svn] r1732 - trunk/src/lev
Message-ID: <200906211519.n5LFJ63O025406@sheep.berlios.de>

Author: ral
Date: 2009-06-21 17:19:05 +0200 (Sun, 21 Jun 2009)
New Revision: 1732

Modified:
   trunk/src/lev/PersistentIndex.cc
Log:
Trunk 1.1: 
- auto index sort based on filenames to achieve a stable sequence

Modified: trunk/src/lev/PersistentIndex.cc
===================================================================
--- trunk/src/lev/PersistentIndex.cc	2009-06-21 14:37:51 UTC (rev 1731)
+++ trunk/src/lev/PersistentIndex.cc	2009-06-21 15:19:05 UTC (rev 1732)
@@ -245,6 +245,10 @@
         load(systemOnly);
     }
     
+    int autoIndexProxyCompare(Proxy * first, Proxy * second) {
+        return first->getNormLevelPath() < second->getNormLevelPath();
+    }
+    
     void PersistentIndex::load(bool systemOnly, bool update) {
         if (doc != NULL) {
             doc->release();
@@ -278,6 +282,7 @@
                 }
             }
             delete dirIter;
+            std::sort(proxies.begin(), proxies.end(), autoIndexProxyCompare);
             return;
         }
 



From ral at mail.berlios.de  Mon Jun 22 00:35:11 2009
From: ral at mail.berlios.de (ral at mail.berlios.de)
Date: Mon, 22 Jun 2009 00:35:11 +0200
Subject: [Enigma-game-svn] r1733 - in trunk/doc/reference: . images
Message-ID: <200906212235.n5LMZBpG006773@sheep.berlios.de>

Author: ral
Date: 2009-06-22 00:35:00 +0200 (Mon, 22 Jun 2009)
New Revision: 1733

Modified:
   trunk/doc/reference/enigma-ref.texi
   trunk/doc/reference/images/Makefile.am
Log:
Trunk 1.1: refman
- section 4.4.3 level initialization
- floor images part II
- stone images part III


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-21 15:19:05 UTC (rev 1732)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-21 22:35:00 UTC (rev 1733)
@@ -7,9 +7,9 @@
 @titlepage
 @title Enigma Reference Manual
 @subtitle for version @value{VERSION}
- at author Daniel Heck
- at author Petr Machata
- at author Ralf Westram
+ at author Daniel Heck (old API v 0.92)
+ at author Petr Machata (old API v 0.92)
+ at author Ralf Westram (old API v 0.92)
 @author Ronald Lamprecht
 @author Andreas Lochmann
 @author Andreas Abraham
@@ -3513,9 +3513,11 @@
 * Ending Conditions::
 @end menu
 
+ at c ----------------- Library Preloading --------------------
 @node Library Preloading
 @subsection Library Preloading
 
+ at c ----------------- Snapshot Principle --------------------
 @node Snapshot Principle
 @subsection Snapshot Principle
 
@@ -3571,15 +3573,63 @@
 subkind on a kind request as they come into existence as a standard object.
 
 
+ at c ----------------- Level Initialization --------------------
 @node Level Initialization
 @subsection Level Initialization
 
-global variables
-tile declarations
-world init
-oxyd shuffle
-postinit()
+Knowing what has been preloaded and knowing exaktly which objects we have to
+set in which state, it is time to have a look on how your level code is 
+processed. The main issue is to guarantee that all parts referenced have been
+set up properly in advance.
 
+Prior execution of the first line of your code the world exists just as an
+abstract handle, but not as grid array able to accept objects. Thus the first
+lines of code should set up all @ref{Global Attributes} derivating from their
+defaults. Even though many attributes can be set or changes later on and even
+on runtime, there are some attributes like @ref{ProvideExtralifes} that take
+only effect if being set prior world creation, or others like @ref{MaxOxydColor}
+that must be set prior their first usage. Our recommendation is to collect all
+global attribut settings at the very beginning of the level.
+
+The second section of your level code should be the declaration of tiles. Being
+just declarations these code lines do not set objects to the world. They just
+depend on global attributes and may reference each other. Listing them all
+together in a code section makes it easy to maintain the overview and to avoid
+dependecy conflicts.
+
+If you use @ref{Resolvers} you should put their declarations in the next code
+section as they may refer to tiles and global attributes and need to be set up
+prior the world creation.
+
+The central statement of every level is the @ref{World Creation}. It sets up
+the world to its size and sets initial objects according to the given tile
+declarations to the grid array. While you are free to add and change any of
+these objects later on the size of the world is fixed and can not be changed.
+
+Thus subsequent code lines should @ref{add} other objects, draw additional
+maps of objects and finalize some objects. The most common statement for such
+a finialization is the @ref{shuffleOxyd} method. It needs to know all 
+ at ref{st_oxyd} to be able to color and shuffle them. Another finalization may
+be a custom rendering of a maze, that extracts the maze shape out of the
+level map (@pxref{res.maze}).
+
+This post world creation code may well have the need of loops or even some
+local used functions that need to be integrated to precede. Please keep such
+functions near by their usage and within the same code section.
+
+Another set of functions that you may want to add are @ref{Callbacks}. We 
+recommend to append these functions as the last section as they are not called
+within the level initialization itself.
+
+But there is one very special exception. The @code{postinit()} callback is
+called after the level initialization code has been processed and all subsequent
+engine internal initialization has been finished. If this function is present
+in a level it gets execute directly before the first mouse movement event gets
+processed. Thus you can rely within this function that all objects are set up
+in their final state. If you have need of such a postinit callback you should
+put it after all the level intialization code and in front of other callback
+functions that will be executed on subsequent events.
+
 @node Object Transformation
 @subsection Object Transformation
 
@@ -3623,12 +3673,15 @@
 Note that a request for a named position will include all positions of matching
 named objects as well as those named positions derived from killed floors.
 
+ at c ----------------- Callbacks and Timers --------------------
 @node Callbacks and Timers
 @subsection Callbacks and Timers
 
+ at c ----------------- Level Restart --------------------
 @node Level Restart
 @subsection Level Restart
 
+ at c ----------------- Ending Conditions --------------------
 @node Ending Conditions
 @subsection Ending Conditions
 
@@ -9358,46 +9411,45 @@
 @tab @image{images/fl_bluegreen, 12mm} @tab @yref{fl_bluegreen}
 @item @image{images/fl_blueslab, 12mm} @tab @yref{fl_blueslab}
 @tab @image{images/fl_brick, 12mm} @tab @yref{fl_brick}
+ at tab @image{images/fl_bridge_bw_closed, 12mm} @tab @yref{fl_bridge}_bw
+ at item @image{images/fl_bridge_gc_closed, 12mm} @tab @yref{fl_bridge}_gc
 @tab @image{images/fl_bright, 12mm} @tab @yref{fl_bright}
- at item @image{images/fl_concrete, 12mm} @tab @yref{fl_concrete}
- at tab @image{images/fl_darkgray, 12mm} @tab @yref{fl_darkgray}
+ at tab @image{images/fl_concrete, 12mm} @tab @yref{fl_concrete}
+ at item @image{images/fl_darkgray, 12mm} @tab @yref{fl_darkgray}
 @tab @image{images/fl_dark, 12mm} @tab @yref{fl_dark}
- at item @image{images/fl_dunes, 12mm} @tab @yref{fl_dunes}
- at tab @image{images/fl_fake_trigger, 12mm} @tab @yref{fl_fake_trigger}
+ at tab @image{images/fl_dunes, 12mm} @tab @yref{fl_dunes}
+ at item @image{images/fl_fake_trigger, 12mm} @tab @yref{fl_fake}_trigger
 @tab @image{images/fl_gravel, 12mm} @tab @yref{fl_gravel}
- at item @image{images/fl_gray, 12mm} @tab @yref{fl_gray}
- at tab @image{images/fl_hay, 12mm} @tab @yref{fl_hay}
+ at tab @image{images/fl_gray, 12mm} @tab @yref{fl_gray}
+ at item @image{images/fl_hay, 12mm} @tab @yref{fl_hay}
 @tab @image{images/fl_himalaya, 12mm} @tab @yref{fl_himalaya}
- at item @image{images/fl_ice_heating, 12mm} @tab @yref{fl_ice_heating}
 @tab @image{images/fl_ice, 12mm} @tab @yref{fl_ice}
- at tab @image{images/fl_inverse_gray, 12mm} @tab @yref{fl_inverse_gray}
- at item @image{images/fl_inverse_white, 12mm} @tab @yref{fl_inverse_white}
+ at item @image{images/fl_inverse_gray, 12mm} @tab @yref{fl_inverse}_gray
+ at tab @image{images/fl_inverse_white, 12mm} @tab @yref{fl_inverse}_white
 @tab @image{images/fl_ivory, 12mm} @tab @yref{fl_ivory}
- at tab @image{images/fl_lawn, 12mm} @tab @yref{fl_lawn}
- at item @image{images/fl_marble, 12mm} @tab @yref{fl_marble}
+ at item @image{images/fl_lawn, 12mm} @tab @yref{fl_lawn}
+ at tab @image{images/fl_marble, 12mm} @tab @yref{fl_marble}
 @tab @image{images/fl_metal, 12mm} @tab @yref{fl_metal}
- at tab @image{images/fl_mortar, 12mm} @tab @yref{fl_mortar}
- at item @image{images/fl_pinkbumps, 12mm} @tab @yref{fl_pinkbumps}
+ at item @image{images/fl_mortar, 12mm} @tab @yref{fl_mortar}
+ at tab @image{images/fl_pinkbumps, 12mm} @tab @yref{fl_pinkbumps}
 @tab @image{images/fl_plank, 12mm} @tab @yref{fl_plank}
- at tab @image{images/fl_platinum, 12mm} @tab @yref{fl_platinum}
- at item @image{images/fl_red, 12mm} @tab @yref{fl_red}
+ at item @image{images/fl_platinum, 12mm} @tab @yref{fl_platinum}
+ at tab @image{images/fl_red, 12mm} @tab @yref{fl_red}
 @tab @image{images/fl_redslab, 12mm} @tab @yref{fl_redslab}
- at tab @image{images/fl_rock, 12mm} @tab @yref{fl_rock}
- at item @image{images/fl_rough, 12mm} @tab @yref{fl_rough}
+ at item @image{images/fl_rock, 12mm} @tab @yref{fl_rock}
+ at tab @image{images/fl_rough, 12mm} @tab @yref{fl_rough}
 @tab @image{images/fl_sahara, 12mm} @tab @yref{fl_sahara}
- at tab @image{images/fl_samba, 12mm} @tab @yref{fl_samba}
- at item @image{images/fl_sand, 12mm} @tab @yref{fl_sand}
+ at item @image{images/fl_samba, 12mm} @tab @yref{fl_samba}
+ at tab @image{images/fl_sand, 12mm} @tab @yref{fl_sand}
 @tab @image{images/fl_space, 12mm} @tab @yref{fl_space}
- at tab @image{images/fl_stone, 12mm} @tab @yref{fl_stone}
- at item @image{images/fl_swamp_heating, 12mm} @tab @yref{fl_swamp_heating}
+ at item @image{images/fl_stone, 12mm} @tab @yref{fl_stone}
 @tab @image{images/fl_swamp, 12mm} @tab @yref{fl_swamp}
 @tab @image{images/fl_tigris, 12mm} @tab @yref{fl_tigris}
- at item @image{images/fl_water_heating, 12mm} @tab @yref{fl_water_heating}
- at tab @image{images/fl_water, 12mm} @tab @yref{fl_water}
+ at item @image{images/fl_water, 12mm} @tab @yref{fl_water}
 @tab @image{images/fl_white, 12mm} @tab @yref{fl_white}
- at item @image{images/fl_woven, 12mm} @tab @yref{fl_woven}
- at tab @image{images/fl_yinyang_yang, 12mm} @tab @yref{fl_yinyang_yang}
- at tab @image{images/fl_yinyang_yin, 12mm} @tab @yref{fl_yinyang_yin}
+ at tab @image{images/fl_woven, 12mm} @tab @yref{fl_woven}
+ at item @image{images/fl_yinyang_yang, 12mm} @tab @yref{fl_yinyang}_yang
+ at tab @image{images/fl_yinyang_yin, 12mm} @tab @yref{fl_yinyang}_yin
 @end multitable
 
 @c ----------------- Floor Attributes --------------------
@@ -10446,7 +10498,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_space}
+ at item @image{images/fl_space, 12mm} @b{fl_space}
 @end table
 @end table
 
@@ -10592,7 +10644,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_abyss}
+ at item @image{images/fl_abyss, 12mm} @b{fl_abyss}
 @end table
 @end table
 
@@ -10635,7 +10687,7 @@
 @table @asis
 @item @b{state}, @ @ @i{values}: @code{CLOSED}, @code{OPEN}; @ @ @i{default}: @code{OPEN} @ @ @xref{state}
 The state as visible and responsible for the actor ability to pass.
- at item @b{flavor}, @ @ @i{values}: @code{"gc"}, @code{"bw"}, @code{"bn"}; @ @ @i{default}: @code{"gc"}
+ at item @b{flavor}, @ @ @i{values}: @code{"gc"}, @code{"bw"}, @code{"bs"}, @code{"be"}, @code{"bn"}; @ @ @i{default}: @code{"gc"}
 The type of the bridge.
 @item @b{adhesion}, @ @ @i{values}: number; @ @ @i{default}: 1.0 @ @ @xref{adhesion}
 @item @b{friction}, @ @ @i{values}: number; @ @ @i{default}: 5.0 @ @ @xref{friction}
@@ -10664,10 +10716,12 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_bridge} flavor = @code{"gc"}
- at item @b{fl_bridge_gc} flavor = @code{"gc"}
- at item @b{fl_bridge_bw} flavor = @code{"bw"}
- at item @b{fl_bridge_bn} flavor = @code{"bn"}
+ at item @image{images/fl_bridge_gc_closed, 12mm} @b{fl_bridge} flavor = @code{"gc"}
+ at item @image{images/fl_bridge_gc_closed, 12mm} @b{fl_bridge_gc} flavor = @code{"gc"}
+ at item @image{images/fl_bridge_bw_closed, 12mm} @b{fl_bridge_bw} flavor = @code{"bw"}
+ at item @image{images/fl_bridge_bw_closed, 12mm} @b{fl_bridge_bs} flavor = @code{"bs"}
+ at item @image{images/fl_bridge_bw_closed, 12mm} @b{fl_bridge_be} flavor = @code{"be"}
+ at item @image{images/fl_bridge_bw_closed, 12mm} @b{fl_bridge_bn} flavor = @code{"bn"}
 @end table
 
 @end table
@@ -10697,8 +10751,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_fake_abyss}: flavor = @code{"abyss"}
- at item @b{fl_fake_trigger}: flavor = @code{"trigger"}
+ at item @image{images/fl_abyss, 12mm} @b{fl_fake_abyss}: flavor = @code{"abyss"}
+ at item @image{images/fl_fake_trigger, 12mm} @b{fl_fake_trigger}: flavor = @code{"trigger"}
 @end table
 @end table
 
@@ -10731,7 +10785,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_hay}
+ at item @image{images/fl_hay, 12mm} @b{fl_hay}
 @item @b{fl_hay_framed}: faces = @code{"nesw"}
 @end table
 @end table
@@ -10758,7 +10812,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_ice}
+ at item @image{images/fl_ice, 12mm} @b{fl_ice}
 @end table
 @end table
 
@@ -10781,9 +10835,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_inverse}: flavor = @code{"white"}
- at item @b{fl_inverse_white}: flavor = @code{"white"}
- at item @b{fl_inverse_gray}: flavor = @code{"gray"}
+ at item @image{images/fl_inverse_white, 12mm} @b{fl_inverse}: flavor = @code{"white"}
+ at item @image{images/fl_inverse_white, 12mm} @b{fl_inverse_white}: flavor = @code{"white"}
+ at item @image{images/fl_inverse_gray, 12mm} @b{fl_inverse_gray}: flavor = @code{"gray"}
 @end table
 @end table
 
@@ -10816,7 +10870,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_rock}
+ at item @image{images/fl_rock, 12mm} @b{fl_rock}
 @item @b{fl_rock_framed}: faces = @code{"nesw"}
 @end table
 @end table
@@ -10941,7 +10995,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_swamp}
+ at item @image{images/fl_swamp, 12mm} @b{fl_swamp}
 @end table
 @end table
 
@@ -10984,7 +11038,7 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_thief}
+ at item @image{images/fl_bluegray, 12mm} @b{fl_thief}
 @end table
 @end table
 
@@ -11039,8 +11093,8 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_water}: state = @code{IDLE}
- at item @b{fl_water_source}: state = @code{FLOODING}
+ at item @image{images/fl_water, 12mm} @b{fl_water}: state = @code{IDLE}
+ at item @image{images/fl_water, 12mm} @b{fl_water_source}: state = @code{FLOODING}
 @end table
 @end table
 
@@ -11112,9 +11166,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{fl_yinyang}: state = @code{YIN}
- at item @b{fl_yinyang_yin}: state = @code{YIN}
- at item @b{fl_yinyang_yang}: state = @code{YANG}
+ at item @image{images/fl_yinyang_yin, 12mm} @b{fl_yinyang}: state = @code{YIN}
+ at item @image{images/fl_yinyang_yin, 12mm} @b{fl_yinyang_yin}: state = @code{YIN}
+ at item @image{images/fl_yinyang_yang, 12mm} @b{fl_yinyang_yang}: state = @code{YANG}
 @end table
 @end table
 
@@ -13874,7 +13928,10 @@
 @item @image{images/st_actorimpulse, 12mm} @tab @yref{st_actorimpulse}
 @tab @image{images/st_ancient, 12mm} @tab @yref{st_ancient}
 @tab @image{images/st_beads, 12mm} @tab @yref{st_beads}
- at item @image{images/st_bluegray, 12mm} @tab @yref{st_bluegray}
+ at item @image{images/st_blocker, 12mm} @tab @yref{st_blocker}
+ at tab @image{images/st_boulder, 12mm} @tab @yref{st_boulder}
+ at tab @image{images/st_bluegray, 12mm} @tab @yref{st_bluegray}
+ at item @image{images/st_bluesand, 12mm} @tab @yref{st_bluesand}
 @tab @image{images/st_blur_cross, 12mm} @tab @yref{st_blur}_cross
 @tab @image{images/st_blur_straight, 12mm} @tab @yref{st_blur}_straight
 @item @image{images/st_box_hay, 12mm} @tab @yref{st_box}_hay
@@ -13887,34 +13944,40 @@
 @tab @image{images/st_break_oxydc, 12mm} @tab @yref{st_break}_oxydc
 @tab @image{images/st_break_plain, 12mm} @tab @yref{st_break}_plain
 @item @image{images/st_break_white, 12mm} @tab @yref{st_break}_white
+ at tab @image{images/st_brick, 12mm} @tab @yref{st_brick}
 @tab @image{images/st_brownie, 12mm} @tab @yref{st_brownie}
- at tab @image{images/st_brownmarble, 12mm} @tab @yref{st_brownmarble}
- at item @image{images/st_brownpyramide, 12mm} @tab @yref{st_brownpyramide}
+ at item @image{images/st_brownmarble, 12mm} @tab @yref{st_brownmarble}
+ at tab @image{images/st_brownpyramide, 12mm} @tab @yref{st_brownpyramide}
 @tab @image{images/st_camouflage, 12mm} @tab @yref{st_camouflage}
- at tab @image{images/st_charge_minus, 12mm} @tab @yref{st_charge}_minus
- at item @image{images/st_charge_plus, 12mm} @tab @yref{st_charge}_plus
+ at item @image{images/st_charge_minus, 12mm} @tab @yref{st_charge}_minus
+ at tab @image{images/st_charge_plus, 12mm} @tab @yref{st_charge}_plus
 @tab @image{images/st_charge_zero, 12mm} @tab @yref{st_charge}_zero
- at tab @image{images/st_chess_black, 12mm} @tab @yref{st_chess}_black
- at item @image{images/st_chess_white, 12mm} @tab @yref{st_chess}_white
- at tab @image{images/st_concrete, 12mm} @tab @yref{st_concrete}
+ at item @image{images/st_chess_black, 12mm} @tab @yref{st_chess}_black
+ at tab @image{images/st_chess_white, 12mm} @tab @yref{st_chess}_white
+ at tab @image{images/st_coinslot, 12mm} @tab @yref{st_coinslot}
+ at item @image{images/st_concrete, 12mm} @tab @yref{st_concrete}
 @tab @image{images/st_darkglass, 12mm} @tab @yref{st_darkglass}
- at item @image{images/st_darkgray, 12mm} @tab @yref{st_darkgray}
- at tab @image{images/st_death, 12mm} @tab @yref{st_death}
+ at tab @image{images/st_darkgray, 12mm} @tab @yref{st_darkgray}
+ at item @image{images/st_death, 12mm} @tab @yref{st_death}
 @tab @image{images/st_dispenser_bombblack, 12mm} @tab @yref{st_dispenser}_bombblack
- at item @image{images/st_dispenser_bombwhite, 12mm} @tab @yref{st_dispenser}_bombwhite
- at tab @image{images/st_dispenser_dynamite, 12mm} @tab @yref{st_dispenser}_dynamite
+ at tab @image{images/st_dispenser_bombwhite, 12mm} @tab @yref{st_dispenser}_bombwhite
+ at item @image{images/st_dispenser_dynamite, 12mm} @tab @yref{st_dispenser}_dynamite
 @tab @image{images/st_flash, 12mm} @tab @yref{st_flash}
- at item @image{images/st_flat, 12mm} @tab @yref{st_flat}
+ at tab @image{images/st_flat, 12mm} @tab @yref{st_flat}
+ at item @image{images/st_floppy_off, 12mm} @tab @yref{st_floppy}_off
+ at tab @image{images/st_floppy_on, 12mm} @tab @yref{st_floppy}_on
 @tab @image{images/st_fourswitch, 12mm} @tab @yref{st_fourswitch}
- at tab @image{images/st_granite, 12mm} @tab @yref{st_granite}
- at item @image{images/st_grate_cross, 12mm} @tab @yref{st_grate}_cross
+ at item @image{images/st_granite, 12mm} @tab @yref{st_granite}
+ at tab @image{images/st_grate_cross, 12mm} @tab @yref{st_grate}_cross
 @tab @image{images/st_grate_framed, 12mm} @tab @yref{st_grate}_framed
- at tab @image{images/st_greenbrown, 12mm} @tab @yref{st_greenbrown}
- at item @image{images/st_greengray, 12mm} @tab @yref{st_greengray}
+ at item @image{images/st_greenbrown, 12mm} @tab @yref{st_greenbrown}
+ at tab @image{images/st_greengray, 12mm} @tab @yref{st_greengray}
 @tab @image{images/st_ice, 12mm} @tab @yref{st_ice}
- at tab                            @tab @yref{st_invisible}
- at item @image{images/st_jamb_black, 12mm} @tab @yref{st_jamb}_black
+ at item                            @tab @yref{st_invisible}
+ at tab @image{images/st_jamb_black, 12mm} @tab @yref{st_jamb}_black
 @tab @image{images/st_jamb_white, 12mm} @tab @yref{st_jamb}_white
+ at item @image{images/st_key_off, 12mm} @tab @yref{st_key}_off
+ at tab @image{images/st_key_on, 12mm} @tab @yref{st_key}_on
 @tab @image{images/st_knight, 12mm} @tab @yref{st_knight}
 @item @image{images/st_lightglass, 12mm} @tab @yref{st_lightglass}
 @tab @image{images/st_lightpassenger, 12mm} @tab @yref{st_lightpassenger}
@@ -13924,33 +13987,47 @@
 @tab @image{images/st_oxydc, 12mm} @tab @yref{st_oxyd}_c
 @item @image{images/st_oxydd, 12mm} @tab @yref{st_oxyd}_d
 @tab @image{images/st_oxyde, 12mm} @tab @yref{st_oxyd}_e
- at tab @image{images/st_passage_black_square, 12mm} @tab @yref{st_passage}_black
- at item @image{images/st_passage_black_slash, 12mm} @tab @yref{st_passage}_black
+ at tab @image{images/st_panel, 12mm} @tab @yref{st_panel}
+ at item @image{images/st_passage_black_square, 12mm} @tab @yref{st_passage}_black
+ at tab @image{images/st_passage_black_slash, 12mm} @tab @yref{st_passage}_black
 @tab @image{images/st_passage_black_cross, 12mm} @tab @yref{st_passage}_black
- at tab @image{images/st_passage_black_frame, 12mm} @tab @yref{st_passage}_black
- at item @image{images/st_passage_white_square, 12mm} @tab @yref{st_passage}_white
+ at item @image{images/st_passage_black_frame, 12mm} @tab @yref{st_passage}_black
+ at tab @image{images/st_passage_white_square, 12mm} @tab @yref{st_passage}_white
 @tab @image{images/st_passage_white_slash, 12mm} @tab @yref{st_passage}_white
- at tab @image{images/st_passage_white_cross, 12mm} @tab @yref{st_passage}_white
- at item @image{images/st_passage_white_frame, 12mm} @tab @yref{st_passage}_white
+ at item @image{images/st_passage_white_cross, 12mm} @tab @yref{st_passage}_white
+ at tab @image{images/st_passage_white_frame, 12mm} @tab @yref{st_passage}_white
 @tab @image{images/st_pinkbumps, 12mm} @tab @yref{st_pinkbumps}
- at tab @image{images/st_plaster, 12mm} @tab @yref{st_plaster}
- at item @image{images/st_plop_slate, 12mm} @tab @yref{st_plop}_slate
+ at item @image{images/st_plaster, 12mm} @tab @yref{st_plaster}
+ at tab @image{images/st_plop_slate, 12mm} @tab @yref{st_plop}_slate
 @tab @image{images/st_portal_horse, 12mm} @tab @yref{st_portal}
+ at item @image{images/st_pull, 12mm} @tab @yref{st_pull}
 @tab @image{images/st_purplegray, 12mm} @tab @yref{st_purplegray}
- at item @image{images/st_purplemarble, 12mm} @tab @yref{st_purplemarble}
- at tab @image{images/st_rawglass, 12mm} @tab @yref{st_rawglass}
+ at tab @image{images/st_purplemarble, 12mm} @tab @yref{st_purplemarble}
+ at item @image{images/st_rawglass, 12mm} @tab @yref{st_rawglass}
 @tab @image{images/st_rawglass_quad, 12mm} @tab @yref{st_rawglass}_quad
- at item @image{images/st_redbrown, 12mm} @tab @yref{st_redbrown}
- at tab @image{images/st_redfiber, 12mm} @tab @yref{st_redfiber}
+ at tab @image{images/st_redbrown, 12mm} @tab @yref{st_redbrown}
+ at item @image{images/st_redfiber, 12mm} @tab @yref{st_redfiber}
 @tab @image{images/st_redmarble, 12mm} @tab @yref{st_redmarble}
- at item @image{images/st_redrock, 12mm} @tab @yref{st_redrock}
+ at tab @image{images/st_redrock, 12mm} @tab @yref{st_redrock}
+ at item @image{images/st_rotator_ccw, 12mm} @tab @yref{st_rotator}_ccw
+ at tab @image{images/st_rotator_cw, 12mm} @tab @yref{st_rotator}_cw
+ at tab @image{images/st_rubberband, 12mm} @tab @yref{st_rubberband}
+ at item @image{images/st_scissors, 12mm} @tab @yref{st_scissors}
 @tab @image{images/st_spitter_idle, 12mm} @tab @yref{st_spitter}
+ at tab @image{images/st_stoneimpulse, 12mm} @tab @yref{st_stoneimpulse}
+ at item @image{images/st_stoneimpulse_hollow, 12mm} @tab @yref{st_stoneimpulse}_hollow
 @tab @image{images/st_surprise, 12mm} @tab @yref{st_surprise}
+ at tab @image{images/st_swap, 12mm} @tab @yref{st_swap}
+ at item @image{images/st_switch, 12mm} @tab @yref{st_switch}
+ at tab @image{images/st_switch_black, 12mm} @tab @yref{st_switch}_black
+ at tab @image{images/st_switch_white, 12mm} @tab @yref{st_switch}_white
 @item @image{images/st_tigris, 12mm} @tab @yref{st_tigris}
- at tab @image{images/st_woven, 12mm} @tab @yref{st_woven}
+ at tab @image{images/st_turnstile, 12mm} @tab @yref{st_turnstile}
+ at tab @image{images/st_turnstile_green, 12mm} @tab @yref{st_turnstile}_green
+ at item @image{images/st_woven, 12mm} @tab @yref{st_woven}
 @tab @image{images/st_yellow, 12mm} @tab @yref{st_yellow}
- at item @image{images/st_yinyang, 12mm} @tab @yref{st_yinyang}
- at tab @image{images/st_yinyang_inactive, 12mm} @tab @yref{st_yinyang}_inactive 
+ at tab @image{images/st_yinyang, 12mm} @tab @yref{st_yinyang}
+ at item @image{images/st_yinyang_inactive, 12mm} @tab @yref{st_yinyang}_inactive 
 @end multitable
 
 @c ----------------- Stone Attributes --------------------
@@ -14490,7 +14567,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @b{st_bluesand}: connections = @code{""}
+ at item @image{images/st_bluesand, 12mm} @b{st_bluesand}: connections = @code{""}
 @item @b{st_bluesand_w}: connections = @code{"w"}
 @item @b{st_bluesand_s}: connections = @code{"s"}
 @item @b{st_bluesand_sw}: connections = @code{"sw"}
@@ -14522,7 +14599,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @b{st_brick}: connections = @code{""}
+ at item @image{images/st_brick, 12mm} @b{st_brick}: connections = @code{""}
 @item @b{st_brick_w}: connections = @code{"w"}
 @item @b{st_brick_s}: connections = @code{"s"}
 @item @b{st_brick_sw}: connections = @code{"sw"}
@@ -14553,7 +14630,7 @@
 @table @asis
 @item @b{Variants:}
 @table @asis
- at item @b{st_panel}: connections = @code{""}
+ at item @image{images/st_panel, 12mm} @b{st_panel}: connections = @code{""}
 @item @b{st_panel_w}: connections = @code{"w"}
 @item @b{st_panel_s}: connections = @code{"s"}
 @item @b{st_panel_sw}: connections = @code{"sw"}
@@ -14800,9 +14877,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{st_blocker}
+ at item @image{images/st_blocker, 12mm}  @b{st_blocker}
 A standard blocker stone.
- at item @b{st_blocker_new}
+ at item @image{images/st_blocker, 12mm}  @b{st_blocker_new}
 A blocker that just starts growing. Mainly used internally as the direct
 successor of an @ref{it_blocker}. But it may be useful to generate an initial
 snapshot of a moving boulder over a blocker line, too. See example levels.
@@ -14921,11 +14998,11 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_boulder}
- at item @b{st_boulder_n}: orientation = @code{NORTH}
- at item @b{st_boulder_e}: orientation = @code{EAST}
- at item @b{st_boulder_s}: orientation = @code{SOUTH}
- at item @b{st_boulder_w}: orientation = @code{WEST}
+ at item @image{images/st_boulder, 12mm} @b{st_boulder}
+ at item @image{images/st_boulder, 12mm} @b{st_boulder_n}: orientation = @code{NORTH}
+ at item @image{images/fl_white, 12mm} @b{st_boulder_e}: orientation = @code{EAST}
+ at item @image{images/fl_white, 12mm} @b{st_boulder_s}: orientation = @code{SOUTH}
+ at item @image{images/fl_white, 12mm} @b{st_boulder_w}: orientation = @code{WEST}
 @end table
 
 @end table
@@ -15306,8 +15383,8 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_coinslot}: instant = @code{false}
- at item @b{st_coinslot_instant}: instant = @code{true}
+ at item @image{images/st_coinslot, 12mm} @b{st_coinslot}: instant = @code{false}
+ at item @image{images/st_coinslot, 12mm} @b{st_coinslot_instant}: instant = @code{true}
 @end table
 
 @end table
@@ -15798,7 +15875,12 @@
 
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_floppy_off, 12mm} @b{st_floppy} with state=@code{OFF}
+ at item @image{images/st_floppy_on, 12mm} @b{st_floppy} with state=@code{ON}
 @end table
+ at end table
 
 @c ----------------- Fourswitch Stone --------------------
 @node st_fourswitch
@@ -16161,7 +16243,12 @@
 
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_key_off, 12mm} @b{st_key} with state=@code{OFF}
+ at item @image{images/st_key_on, 12mm} @b{st_key} with state=@code{ON}
 @end table
+ at end table
 @c ----------------- Knight Stone --------------------
 @node st_knight
 @subsection st_knight
@@ -17066,7 +17153,6 @@
 @item @b{Action:} none
 
 @item @b{Variants:}
-
 @table @asis
 @item @image{images/st_portal_horse, 12mm} @b{st_portal}: flavor=@code{"horse"}
 @item @image{images/st_portal_horse, 12mm} @b{st_portal_horse}: flavor=@code{"horse"}
@@ -17120,7 +17206,11 @@
 
 @item @b{Action:} none
 
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_pull, 12mm} @b{st_pull}
 @end table
+ at end table
 
 @c ----------------- Puzzle Stone --------------------
 @node st_puzzle
@@ -17400,13 +17490,11 @@
 @end table
 
 @item @b{Variants:}
-
 @table @asis
- at item @b{st_rotator}: state = @code{CW}
- at item @b{st_rotator_cw}: state = @code{CW}
- at item @b{st_rotator_ccw}: state = @code{CCW}
+ at item @image{images/st_rotator_cw, 12mm} @b{st_rotator}: state = @code{CW}
+ at item @image{images/st_rotator_cw, 12mm} @b{st_rotator_cw}: state = @code{CW}
+ at item @image{images/st_rotator_ccw, 12mm} @b{st_rotator_ccw}: state = @code{CCW}
 @end table
-
 @end table
 
 @c ----------------- Rubberband Stone --------------------
@@ -17449,7 +17537,11 @@
 
 @item @b{Messages:} none
 
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_rubberband, 12mm} @b{st_rubberband}
 @end table
+ at end table
 
 @c ----------------- Scissors Stone --------------------
 @node st_scissors
@@ -17469,7 +17561,11 @@
 Sends an action message with value @samp{true} on freeing an actor from its
 rubberbands.
 
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_scissors, 12mm} @b{st_scissors}
 @end table
+ at end table
 
 @c ----------------- Shogun Stone --------------------
 @node st_shogun
@@ -17736,11 +17832,11 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{st_stoneimpulse}
- at item @b{st_stoneimpulse_movable}: movable = @code{true}
- at item @b{st_stoneimpulse_hollow}: hollow = @code{true}
- at item @b{st_stoneimpulse_steady}: steady = @code{true}
- at item @b{st_stoneimpulse_new}:
+ at item @image{images/st_stoneimpulse, 12mm} @b{st_stoneimpulse}
+ at item @image{images/st_stoneimpulse, 12mm} @b{st_stoneimpulse_movable}: movable = @code{true}
+ at item @image{images/st_stoneimpulse_hollow, 12mm} @b{st_stoneimpulse_hollow}: hollow = @code{true}
+ at item @image{images/st_stoneimpulse, 12mm} @b{st_stoneimpulse_steady}: steady = @code{true}
+ at item @image{images/st_stoneimpulse, 12mm} @b{st_stoneimpulse_new}:
 A stone that is about to pulse when being set.
 @end table
 
@@ -17831,7 +17927,11 @@
 
 @item @b{Action:} none
 
+ at item @b{Variants:}
+ at table @asis
+ at item @image{images/st_swap, 12mm} @b{st_swap}
 @end table
+ at end table
 
 @c ----------------- Switch Stone --------------------
 @node st_switch
@@ -17878,9 +17978,9 @@
 @item @b{Variants:}
 
 @table @asis
- at item @b{st_switch}
- at item @b{st_switch_black}: color = @code{BLACK}
- at item @b{st_switch_white}: color = @code{WHITE}
+ at item @image{images/st_switch, 12mm} @b{st_switch}
+ at item @image{images/st_switch_black, 12mm} @b{st_switch_black}: color = @code{BLACK}
+ at item @image{images/st_switch_white, 12mm} @b{st_switch_white}: color = @code{WHITE}
 @end table
 
 @end table
@@ -18064,9 +18164,9 @@
 
 @item @b{Variants:}
 @table @asis
- at item @b{st_turnstile}: flavor = @code{"red"}
- at item @b{st_turnstile_red}: flavor = @code{"red"}
- at item @b{st_turnstile_green}: flavor = @code{"green"}
+ at item @image{images/st_turnstile, 12mm} @b{st_turnstile}: flavor = @code{"red"}
+ at item @image{images/st_turnstile, 12mm} @b{st_turnstile_red}: flavor = @code{"red"}
+ at item @image{images/st_turnstile_green, 12mm} @b{st_turnstile_green}: flavor = @code{"green"}
 @end table
 @end table
 

Modified: trunk/doc/reference/images/Makefile.am
===================================================================
--- trunk/doc/reference/images/Makefile.am	2009-06-21 15:19:05 UTC (rev 1732)
+++ trunk/doc/reference/images/Makefile.am	2009-06-21 22:35:00 UTC (rev 1733)
@@ -13,6 +13,8 @@
 	fl_bluegreen.png \
 	fl_blueslab.png \
 	fl_brick.png \
+	fl_bridge_bw_closed.png \
+	fl_bridge_gc_closed.png \
 	fl_bright.png \
 	fl_concrete.png \
 	fl_dark.png \
@@ -24,7 +26,6 @@
 	fl_hay.png \
 	fl_himalaya.png \
 	fl_ice.png \
-	fl_ice_heating.png \
 	fl_inverse_gray.png \
 	fl_inverse_white.png \
 	fl_ivory.png \
@@ -45,10 +46,8 @@
 	fl_space.png \
 	fl_stone.png \
 	fl_swamp.png \
-	fl_swamp_heating.png \
 	fl_tigris.png \
 	fl_water.png \
-	fl_water_heating.png \
 	fl_white.png \
 	fl_woven.png \
 	fl_yinyang_yang.png \
@@ -130,9 +129,12 @@
 	st_actorimpulse.png \
 	st_ancient.png \
 	st_beads.png \
+	st_blocker.png \
 	st_bluegray.png \
+	st_bluesand.png \
 	st_blur_cross.png \
 	st_blur_straight.png \
+	st_boulder.png \
 	st_box_hay.png \
 	st_box_rock.png \
 	st_box_wood.png \
@@ -143,6 +145,7 @@
 	st_break_oxydc.png \
 	st_break_plain.png \
 	st_break_white.png \
+	st_brick.png \
 	st_brownie.png \
 	st_brownmarble.png \
 	st_brownpyramide.png \
@@ -152,6 +155,7 @@
 	st_charge_zero.png \
 	st_chess_black.png \
 	st_chess_white.png \
+	st_coinslot.png \
 	st_concrete.png \
 	st_darkglass.png \
 	st_darkgray.png \
@@ -164,6 +168,8 @@
 	st_flat.png \
 	st_flat_cracked.png \
 	st_flat_fire.png \
+	st_floppy_off.png \
+	st_floppy_on.png \
 	st_fourswitch.png \
 	st_granite.png \
 	st_grate_cross.png \
@@ -173,6 +179,8 @@
 	st_ice.png \
 	st_jamb_black.png \
 	st_jamb_white.png \
+	st_key_off.png \
+	st_key_on.png \
 	st_knight.png \
 	st_lightglass.png \
 	st_lightpassenger.png \
@@ -182,6 +190,7 @@
 	st_oxydc.png \
 	st_oxydd.png \
 	st_oxyde.png \
+	st_panel.png \
 	st_passage_black_cross.png \
 	st_passage_black_frame.png \
 	st_passage_black_slash.png \
@@ -193,6 +202,7 @@
 	st_pinkbumps.png \
 	st_plaster.png \
 	st_plop_slate.png \
+	st_pull.png \
 	st_portal_horse.png \
 	st_purplegray.png \
 	st_purplemarble.png \
@@ -202,9 +212,21 @@
 	st_redfiber.png \
 	st_redmarble.png \
 	st_redrock.png \
+	st_rotator_ccw.png \
+	st_rotator_cw.png \
+	st_rubberband.png \
 	st_spitter_idle.png \
+	st_scissors.png \
+	st_stoneimpulse.png \
+	st_stoneimpulse_hollow.png \
 	st_surprise.png \
+	st_swap.png \
+	st_switch.png \
+	st_switch_black.png \
+	st_switch_white.png \
 	st_tigris.png \
+	st_turnstile.png \
+	st_turnstile_green.png \
 	st_woven.png \
 	st_yellow.png \
 	st_yinyang.png \



From andreasl at mail.berlios.de  Tue Jun 23 02:34:26 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Tue, 23 Jun 2009 02:34:26 +0200
Subject: [Enigma-game-svn] r1734 - in trunk: data data/levels/lib
	doc/reference
Message-ID: <200906230034.n5N0YQLW014007@sheep.berlios.de>

Author: andreasl
Date: 2009-06-23 02:34:20 +0200 (Tue, 23 Jun 2009)
New Revision: 1734

Modified:
   trunk/data/api2init.lua
   trunk/data/levels/lib/libmap.xml
   trunk/data/levels/lib/libmath.xml
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk:
 - Fix lib.math.digits: Argument "zero" now returns a table with the zero-th
   digit by default, optionally an empty table.
 - libmap:
    - Add assertions for lib.map.get, set, covers and print.
    - Remove undocumented and unused support for "user attributes" in maps,
      allow named positions instead.
    - Adapt Refman, and elaborate on read- and write-accesses to libmap-maps.
 - Remove Lua-5.0-references from Refman (except for comparison between
   modulo-functions).
 - Fix some typos.
Note:
 - Adaptions of levels andreas47 and ais06 will come with next level update.
   andreas47 ("Show Jumper") might behave different till then.


Modified: trunk/data/api2init.lua
===================================================================
--- trunk/data/api2init.lua	2009-06-21 22:35:00 UTC (rev 1733)
+++ trunk/data/api2init.lua	2009-06-23 00:34:20 UTC (rev 1734)
@@ -479,13 +479,13 @@
     --         replacements = {key, [key]*, [{key, frequency}]*}
     assert_bool(is_resolver(subresolver), "res.random first argument (subresolver)", 2)
     assert_type(hits, "res.random second argument (hits)", 2, "non-empty string", "table")
-    assert_type(hits, "res.random third argument (replacements)", 2, "string", "table")
+    assert_type(replacements, "res.random third argument (replacements)", 2, "string", "table")
     local hit_table = {}
     if type(hits) == "string" then
         hit_table[1] = {hits, nil}
     else  -- table
         for i, v in ipairs(hits) do
-            assert_type(v, "res.random seond argument (hits), entry " .. i, 2, "non-empty string", "table")
+            assert_type(v, "res.random second argument (hits), entry " .. i, 2, "non-empty string", "table")
             if type(v) == "string" then
                 hit_table[i] = {v, nil}
             elseif type(v) == "table" then

Modified: trunk/data/levels/lib/libmap.xml
===================================================================
--- trunk/data/levels/lib/libmap.xml	2009-06-21 22:35:00 UTC (rev 1733)
+++ trunk/data/levels/lib/libmap.xml	2009-06-23 00:34:20 UTC (rev 1734)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="library">
       <el:identity el:title="" el:id="lib/libmap"/>
-      <el:version el:score="1" el:release="1" el:revision="4" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="5" el:status="released"/>
       <el:author  el:name="Enigma Team" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2008 Enigma Team</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -340,6 +340,8 @@
 end
 
 function lib.map.covers(map, pos)
+    assert_type(map, "lib.map.covers first argument (map)", 2, "map")
+    assert_type(pos, "lib.map.covers second argument (position)", 2, "position", "table")
     if type(pos) == "table" then
         return (pos[1] >= 0) and (pos[2] >= 0)
             and (pos[1] < map.width) and (pos[2] < map.height)
@@ -349,8 +351,10 @@
     end
 end
 
--- TODO: Add string as posarg, maybe speed up.
 function lib.map.get(map, posarg)
+    assert_type(map, "lib.map.get first argument (map)", 2, "map")
+    assert_type(posarg, "lib.map.get second argument (index key)", 2, "number", "position",
+                "object", "group", "polist", "table", "string")
     if type(posarg) == "number" then
         return rawget(map, posarg)
     elseif (usertype(posarg) == "position") or (usertype(posarg) == "object") then
@@ -386,16 +390,21 @@
         elseif (posarg == "width") or (posarg == "height")
              or (posarg == "defaultkey") or (posarg == "keylength") then
             return rawget(map, "__"..posarg)
-        else  
-            return (rawget(map, "user_attributes"))[posarg]
+        else
+            local pos = po[posarg]
+            if pos then
+                return lib.map.get(map, pos)
+            else
+                return rawget(map, "__defaultkey")
+            end
         end
-    else
-        error("lib.map.get: Can't understand position argument.")
     end
 end
 
--- TODO: Add string as posarg, maybe speed up.
 function lib.map.set(map, posarg, value)
+    assert_type(map, "lib.map.set first argument (map)", 2, "map")
+    assert_type(posarg, "lib.map.set second argument (index key)", 2, "number", "position",
+                "object", "group", "polist", "table", "string")
     if type(posarg) == "string" then
         if (posarg == "type") then
             if tostring(value) ~= "map" then
@@ -411,12 +420,16 @@
         elseif (posarg == "defaultkey") then
             map:set_default_key(value)
             return
+        else
+            local pos = po[posarg]
+            if pos then
+                lib.map.set(map, pos, value)
+            else
+                error("lib.map.set: Named position '" .. posarg .. "' doesn't exist.", 2)
+            end
         end
-        map.user_attributes[posarg] = value
     else
-        if type(value) ~= "string" then
-            error("lib.map.set: Key must be of type string, is "..type(value)..".", 2)
-        end
+        assert_type(value, "lib.map.set third argument (value)", 2, "non-empty string")
         local kl = rawget(map, "__keylength")
         if string.len(value) ~= kl then
             error("lib.map.set: Key must be of the same length as default key "
@@ -512,9 +525,10 @@
 end  
 
 function lib.map.print(map, withXYCounts, left_separator, right_separator)
-    assert_type(map, "lib.map.print first argument", 2, "map")
-    assert_type(left_separator, "lib.map.print second argument", 2, "nil", "string")
-    assert_type(right_separator, "lib.map.print third argument", 2, "nil", "string")  
+    assert_type(map, "lib.map.print first argument (map)", 2, "map")
+    assert_type(withXYCounts, "lib.map.print second argument (with X-Y-counts)", 2, "nil", "boolean")
+    assert_type(left_separator, "lib.map.print third argument (left separator)", 2, "nil", "string")
+    assert_type(right_separator, "lib.map.print fourth argument (right separator)", 2, "nil", "string")  
     local w, h = map.width, map.height
     local kl = rawget(map, "__keylength")
     if withXYCounts then
@@ -561,7 +575,7 @@
 
 wo:_register("newMap",
     function(world, defaultKey, arg1, arg2)
-        local newmap = {user_attributes = {}}
+        local newmap = {}
         -- Check arguments, create map if necessary.
         assert_type(defaultKey, "wo:newMap first argument (default key)", 2, "non-empty string")
         local width = 0
@@ -570,8 +584,7 @@
         if (type(arg1) == "table") and (type(arg2) == "nil") then
             -- Interpret table as map.
             for key, entry in pairs(arg1) do
-                if type(key) == "number" then
-                    -- This line is going to be a real map entry.
+                if (type(key) == "number") and (key == math.ceil(key)) and (key > 0) then
                     height = math.max(height, key)
                     assert_type(entry, "wo:newMap line " .. key, 2, "string")
                     local line_width = string.len(entry) / kl
@@ -580,10 +593,6 @@
                     end
                     width = math.max(width, line_width)
                     newmap[key] = entry
-                elseif type(key) == "string" then
-                    newmap.user_attributes[key] = entry
-                else
-                    error("newMap: Strange type for a map table key: " .. etype(key) .. ".", 2)
                 end
             end
             -- Now complete the map, make it rectangular.

Modified: trunk/data/levels/lib/libmath.xml
===================================================================
--- trunk/data/levels/lib/libmath.xml	2009-06-21 22:35:00 UTC (rev 1733)
+++ trunk/data/levels/lib/libmath.xml	2009-06-23 00:34:20 UTC (rev 1734)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="library">
       <el:identity el:title="" el:id="lib/libmath"/>
-      <el:version el:score="1" el:release="1" el:revision="6" el:status="released"/>
+      <el:version el:score="1" el:release="1" el:revision="7" el:status="released"/>
       <el:author  el:name="Enigma Team" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2007, 2008 Enigma Team</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -85,10 +85,14 @@
 -- Hexadecimal would be:
 --   lib.math.digits(x, {0,1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F"})
 -- NUMBER is supposed to be a non-negative integer.
-function lib.math.digits(number, base)
+-- If NUMBER is zero, lib.math.digits returns the zero-digit as
+-- result, unless ZERO_IS_EMPTY is true - in this case, it returns
+-- an empty table.
+function lib.math.digits(number, base, zero_is_empty)
     -- Check arguments and calculate fullbase and exponent
     assert_type(number, "lib.math.digits first argument", 2, "natural")
     assert_type(base, "lib.math.digits second argument", 2, "integer", "table")
+    assert_type(zero_is_empty, "lib.math.digits third argument", 2, "boolean", "nil")
     local fullbase = {}
     local exponent = 0
     if type(base) == "number" then
@@ -105,6 +109,10 @@
         fullbase = base
     end
     exponent = table.getn(fullbase)
+    -- Handle zero
+    if number == 0 then
+        return cond(zero_is_empty, {}, {fullbase[1]})
+    end
     -- Decompose NUMBER
     local remains = number
     local result = {}

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-21 22:35:00 UTC (rev 1733)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-23 00:34:20 UTC (rev 1734)
@@ -19362,7 +19362,7 @@
 @node Basic Functions
 @section Basic Functions
 
-Enigma supports most Lua 5.0 and above statements, i.e. you can freely use
+Enigma supports most Lua 5.1 and above statements, i.e. you can freely use
 tables and control structures in your level, as you would expect. However, some
 Lua functions have been deactivated for security reasons or to ensure
 upwards compatibility. These are @samp{dofile}, @samp{module}, @samp{require}
@@ -19374,25 +19374,25 @@
 should not appear in the level's final version anymore.
 
 Of Lua's built-in mathematical functions you may use any of the following:
- at samp{math.abs}, @samp{math.acos}, @samp{math.asin}, @samp{math.atan}, @samp{math.atan2},
- at samp{math.ceil}, @samp{math.cos}, @samp{math.deg}, @samp{math.exp}, @samp{math.floor},
- at samp{math.frexp}, @samp{math.ldexp}, @samp{math.log}, @samp{math.log10}, @samp{math.max},
- at samp{math.min}, @samp{math.pow}, @samp{math.rad}, @samp{math.random}, @samp{math.sin},
- at samp{math.sqrt}, @samp{math.tan}. As of Lua 5.1, the following functions are
-additionally available: @samp{math.cosh}, @samp{math.fmod}, @samp{math.huge},
- at samp{math.modf}, @samp{math.pi}, @samp{math.sinh}, @samp{math.tanh}.
+ at samp{math.abs}, @samp{math.acos}, @samp{math.asin}, @samp{math.atan},
+ at samp{math.atan2}, @samp{math.ceil}, @samp{math.cos}, @samp{math.cosh},
+ at samp{math.deg}, @samp{math.exp}, @samp{math.floor}, @samp{math.fmod},
+ at samp{math.frexp}, @samp{math.huge}, @samp{math.ldexp}, @samp{math.log},
+ at samp{math.log10}, @samp{math.max}, @samp{math.min}, @samp{math.modf},
+ at samp{math.pi}, @samp{math.pow}, @samp{math.rad}, @samp{math.random},
+ at samp{math.sin}, @samp{math.sinh},  @samp{math.sqrt}, @samp{math.tan},
+ at samp{math.tanh}.
 
 All trigonometric functions use radians, you can use @samp{math.deg} and
 @samp{math.rad} to convert between radians and degrees. For the differences
-between @samp{math.mod} and @samp{math.fmod} see @ref{lib.lua.mod}.
+between @samp{math.mod}, @samp{%}, and @samp{math.fmod} see @ref{lib.lua.mod}.
 
 While you have access to nearly all mathematical functions Lua defines, Enigma
 uses an own random generator, which you access via @samp{math.random} with the
 same syntax as Lua's random generator. To ensure stability in future versions
 of Enigma, @samp{math.randomseed} is disabled.
 
-Please read the online manuals of
- at uref{http://www.lua.org/manual/5.0/, Lua 5.0} and 
+Please read the online manual of
 @uref{http://www.lua.org/manual/5.1/, Lua 5.1} for more detailed information.
 
 
@@ -19521,19 +19521,21 @@
 @end example
 
 @item @b{Details:}
-Lua 5.0 uses @samp{math.mod} as modulo operation, Lua 5.1 provides @samp{%} and
- at samp{math.fmod}. Whereas all three operations agree on positive numbers and
-zero as @samp{value}, there are differences on negative numbers:
+Lua 5.0 used @samp{math.mod} as modulo operation, this function is not
+available in Lua 5.1 anymore, and hence not available in Enigma. Lua 5.1
+provides @samp{%} and @samp{math.fmod}. Whereas all three operations agree on
+positive numbers and zero as @samp{value}, there are differences on negative
+numbers:
 @example
-math.mod(-1, 4) == -1
-math.fmod(-1, 4) == -1
-(-1)%4 == 3
-lib.lua.mod(-1, 4) == 3
+Lua 5.0:  math.mod(-1, 4) == -1
+Lua 5.1:  math.fmod(-1, 4) == -1
+Lua 5.1:  (-1)%4 == 3
+lib.lua:  lib.lua.mod(-1, 4) == 3
 @end example
 While the Lua-own modulo functions yield results even for negative
 @samp{modul} (with varying signs of the outcome), @samp{lib.lua.mod} will raise
 an error if @samp{modul <= 0}, and the result @samp{r} is otherwise guaranteed
-to be @samp{0 <= r < modul}.
+to be @code{0 <= r < modul}.
 
 @item @b{Full Example:}
 @example
@@ -19894,7 +19896,7 @@
 
 @table @asis
 @item @b{Syntax:}
- at b{lib.math.digits}(@i{number}, @i{base})
+ at b{lib.math.digits}(@i{number}, @i{base} [, @i{zero_is_empty}])
 
 @table @asis
 @item @i{number}
@@ -19903,6 +19905,10 @@
 @item @i{base}
 A positive integer other than 1, or a table with numerical keys.
 
+ at item @i{zero_is_empty}
+If @code{number} is zero, a table containing the zero-th digit is returned by
+default. If @code{zero_is_empty} is @code{true}, an empty table is returned
+instead.
 @end table
 
 @item @b{Syntax Samples:}
@@ -20587,10 +20593,22 @@
 the map with @ref{drawMap} to create arbitrarily shaped areas.
 
 If the premap is not rectangular, missing positions are set to the default key.
+However, each line length must be divisible by the default key's length, otherwise
+an error is thrown.
 
-As each libmap-map can be used to replace a premap, you may also use
- at code{wo:newMap} to copy a libmap-map with:
+You may feed arbitrary tables to @code{wo:newMap}, but only their positive
+integer entries are used, all other entries are ignored. You might even skip
+lines, like in this example:
 @example
+wo:newMap(" ", @{[25] = "g"@})
+ at end example
+This will return a map of width 1 and height 25 filled with spaces, except for
+the last line, which will be @code{"g"}.
+
+Each libmap-map is a table and can be used as a premap as well. Its default
+key is ignored when a libmap-map is considered as a premap. In particular,
+you may use @code{wo:newMap} to copy a libmap-map with:
+ at example
 newcopy = wo:newMap(mymap.defaultkey, mymap)
 @end example
 @end table
@@ -20621,8 +20639,8 @@
 A libmap-map.
 
 @item @i{posarg}
-A position, object, group, position list, or table (interpretable as single
-position).
+A position, object, group, position list, string, or table (interpretable as
+single position).
 @end table
 
 @item @b{Syntax Samples:}
@@ -20636,10 +20654,22 @@
 Correspondingly, a write-access with a group or position list changes the key
 at each position in the group or position list to the given string.
 
+A read-access with a string invokes a @ref{Positions Repository Request} to
+retrieve a named position, unless the string equals one of @code{"type"},
+ at code{"width"}, @code{"height"}, @code{"defaultkey"}, or @code{"keylength"},
+which return the corresponding properties of the map instead.
+
+A write-access with a string similarly is interpreted as access to a named
+position, unless the string equals @code{"defaultkey"}, see
+ at ref{Map Default Keys}. A write-access to a non-existing position throws an
+error.
+
 You may request any position outside of the scope of the map, even with
-negative coordinates. If you do so, the default key is returned.
+negative coordinates. If you do so, the default key is returned. This accounts
+for non-existing positions as well (for example positions of items in the
+inventory, or the position of a string which doesn't describe a named position).
 
-If you try to set an entry to a position with a negative coordinate, an error
+If you try to set an entry to a position with a negative coordinate an error
 is returned. However, if you use non-negative coordinates outside of the scope
 of the map, the map is subsequently extended to the new position, setting
 the default key as entry where necessary.
@@ -21196,7 +21226,7 @@
 map2 = wo:newMap(".", @{"F.E",
                        "E.E"@})
 @end example
-In this situation, @code{map1:paste(map2, po(1, 1) .. po(5, 3)} will change
+In this situation, @code{map1:paste(map2, po(1, 1) .. po(5, 3))} will change
 map1 into:
 @example
 @{"####### ",



From raoul at mail.berlios.de  Sat Jun 27 02:46:28 2009
From: raoul at mail.berlios.de (raoul at BerliOS)
Date: Sat, 27 Jun 2009 02:46:28 +0200
Subject: [Enigma-game-svn] r1735 - in trunk: attic/images-items data/gfx16
	data/gfx32 data/gfx40 data/gfx48 data/gfx64
Message-ID: <200906270046.n5R0kSCP027401@sheep.berlios.de>

Author: raoul
Date: 2009-06-27 02:46:26 +0200 (Sat, 27 Jun 2009)
New Revision: 1735

Added:
   trunk/attic/images-items/it_surprise_gfx16.xcf
   trunk/attic/images-items/it_surprise_gfx32.xcf
   trunk/attic/images-items/it_surprise_gfx40.xcf
   trunk/attic/images-items/it_surprise_gfx48.xcf
   trunk/attic/images-items/it_surprise_gfx64.xcf
   trunk/attic/images-items/it_surprise_sizes.txt
   trunk/data/gfx16/it_surprise.png
   trunk/data/gfx64/it_surprise.png
Modified:
   trunk/data/gfx32/it_surprise.png
   trunk/data/gfx40/it_surprise.png
   trunk/data/gfx48/it_surprise.png
Log:
-> New images for the surprise item



Added: trunk/attic/images-items/it_surprise_gfx16.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-items/it_surprise_gfx16.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-items/it_surprise_gfx32.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-items/it_surprise_gfx32.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-items/it_surprise_gfx40.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-items/it_surprise_gfx40.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-items/it_surprise_gfx48.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-items/it_surprise_gfx48.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-items/it_surprise_gfx64.xcf
===================================================================
(Binary files differ)


Property changes on: trunk/attic/images-items/it_surprise_gfx64.xcf
___________________________________________________________________
Name: svn:mime-type
   + image/x-xcf

Added: trunk/attic/images-items/it_surprise_sizes.txt
===================================================================
--- trunk/attic/images-items/it_surprise_sizes.txt	2009-06-23 00:34:20 UTC (rev 1734)
+++ trunk/attic/images-items/it_surprise_sizes.txt	2009-06-27 00:46:26 UTC (rev 1735)
@@ -0,0 +1,40 @@
+Gfx table with sizes for surprise item
+--------------------------------------
+<- : current image
+
+gfx16
+-----
+(8px  -> 50%   )
+(10px -> 62.5% )
+12px -> 75% <-
+
+
+gfx32
+-----
+16px -> 50%
+18px -> 56.25% <-
+20px -> 62.5%
+
+
+gfx40
+-----
+20px -> 50%
+22px -> 55%  <= orig
+24px -> 60%
+
+
+gfx48
+-----
+(22px -> 45.8% )
+24px -> 50%
+26px -> 54% <-
+28px -> 58%
+
+
+gfx64
+-----
+(28px -> 43.75% )
+30px -> 46.8%
+32px -> 50% <-
+34px -> 53%
+36px -> 56.25%


Property changes on: trunk/attic/images-items/it_surprise_sizes.txt
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/data/gfx16/it_surprise.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx16/it_surprise.png
___________________________________________________________________
Name: svn:mime-type
   + image/png

Modified: trunk/data/gfx32/it_surprise.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx40/it_surprise.png
===================================================================
(Binary files differ)

Modified: trunk/data/gfx48/it_surprise.png
===================================================================
(Binary files differ)

Added: trunk/data/gfx64/it_surprise.png
===================================================================
(Binary files differ)


Property changes on: trunk/data/gfx64/it_surprise.png
___________________________________________________________________
Name: svn:mime-type
   + image/png



From andreasl at mail.berlios.de  Sun Jun 28 01:19:34 2009
From: andreasl at mail.berlios.de (andreasl at mail.berlios.de)
Date: Sun, 28 Jun 2009 01:19:34 +0200
Subject: [Enigma-game-svn] r1736 - in trunk: data data/levels/lib
	doc/reference
Message-ID: <200906272319.n5RNJYlZ017702@sheep.berlios.de>

Author: andreasl
Date: 2009-06-28 01:19:26 +0200 (Sun, 28 Jun 2009)
New Revision: 1736

Modified:
   trunk/data/api2init.lua
   trunk/data/levels/lib/libmap.xml
   trunk/data/levels/lib/libpento_1.xml
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk:
 - Fix libpento: rotation and mirroring of shapes.
 - Use field "index" for map-transformation-constants instead of field 1.
 - Extend refman to include "index" and note that map transformations
   may not be safed directly to attributes, but must use their indices.


Modified: trunk/data/api2init.lua
===================================================================
--- trunk/data/api2init.lua	2009-06-27 00:46:26 UTC (rev 1735)
+++ trunk/data/api2init.lua	2009-06-27 23:19:26 UTC (rev 1736)
@@ -200,24 +200,25 @@
 FOLLOW_HALFSCREEN = po(9.5, 6)
 
 -- map transformations, aka. read directions
-MAP_IDENT = {1}
-MAP_ROT_CW = {2}
-MAP_ROT_180 = {3}
-MAP_ROT_CCW = {4}
-MAP_FLIP_BACKSLASH = {5}
-MAP_FLIP_HORIZONTAL = {6}
-MAP_FLIP_SLASH = {7}
-MAP_FLIP_VERTICAL = {8}
+MAP_IDENT            = {index = 1}
+MAP_ROT_CW           = {index = 2}
+MAP_ROT_180          = {index = 3}
+MAP_ROT_CCW          = {index = 4}
+MAP_FLIP_BACKSLASH   = {index = 5}
+MAP_FLIP_HORIZONTAL  = {index = 6}
+MAP_FLIP_SLASH       = {index = 7}
+MAP_FLIP_VERTICAL    = {index = 8}
 MAP_COUNT = 8
 -- Note: The sequence is of importance for lib.map.transformation_compose.
 MAP_ALL = {MAP_IDENT, MAP_ROT_CW, MAP_ROT_180, MAP_ROT_CCW, MAP_FLIP_BACKSLASH,
            MAP_FLIP_HORIZONTAL, MAP_FLIP_SLASH, MAP_FLIP_VERTICAL}
 
 for _, transformation in ipairs(MAP_ALL) do
-    setmetatable(transformation, {_type = "maptransformation",
+    setmetatable(transformation, {
         __mul = (function() error("You have to load libmap to use \"*\" on map transformations.", 2) end),
         __pow = (function() error("You have to load libmap to use \"^\" on map transformations.", 2) end),
-        __unm = (function() error("You have to load libmap to use \"-\" on map transformations.", 2) end)})
+        __unm = (function() error("You have to load libmap to use \"-\" on map transformations.", 2) end),
+        _type = "maptransformation"})
 end
 
 ---------------------

Modified: trunk/data/levels/lib/libmap.xml
===================================================================
--- trunk/data/levels/lib/libmap.xml	2009-06-27 00:46:26 UTC (rev 1735)
+++ trunk/data/levels/lib/libmap.xml	2009-06-27 23:19:26 UTC (rev 1736)
@@ -648,7 +648,7 @@
 
 function lib.map.transformation_inverse(x)
     assert_type(x, "lib.map.transformation_inverse first argument", 2, "maptransformation")
-    return MAP_ALL[({[1] = 1, 4, 3, 2, 5, 6, 7, 8})[x[1]]]
+    return MAP_ALL[({1, 4, 3, 2, 5, 6, 7, 8}) [x.index] ]
 end
 
 function lib.map.transformation_compose(x, y)
@@ -661,7 +661,7 @@
                      {5, 8, 7, 6, 1, 4, 3, 2},
                      {6, 5, 8, 7, 2, 1, 4, 3},
                      {7, 6, 5, 8, 3, 2, 1, 4},
-                     {8, 7, 6, 5, 4, 3, 2, 1}}) [x[1]] [y[1]] ]
+                     {8, 7, 6, 5, 4, 3, 2, 1}}) [x.index] [y.index] ]
 end
 
 function lib.map.transformation_power(x, y)
@@ -684,7 +684,7 @@
     __mul = lib.map.transformation_compose,
     __pow = lib.map.transformation_power,
     __unm = lib.map.transformation_inverse,
-    _type = "maptransformation"
+    _type = "maptransformation",
 }
 
 for _, transformation in ipairs(MAP_ALL) do

Modified: trunk/data/levels/lib/libpento_1.xml
===================================================================
--- trunk/data/levels/lib/libpento_1.xml	2009-06-27 00:46:26 UTC (rev 1735)
+++ trunk/data/levels/lib/libpento_1.xml	2009-06-27 23:19:26 UTC (rev 1736)
@@ -64,7 +64,7 @@
         wo:drawMap(context[3], context.src_anchor + offset, " ", shape_map)
     end
 
-    context.transform = function (transformations)
+    context.transform = function (transformation)
         local target = st(context.src_area)
         local cluster = nil
         if #target ~= 5 then return end
@@ -75,22 +75,22 @@
                 return
             end
         end
-        local oldtransform = target[1]["_transform"] or MAP_IDENT
-        local newtransform = transformations[oldtransform + 1]
+        local oldtransform = MAP_ALL[target[1]["_transform"]] or MAP_IDENT
+        local newtransform = oldtransform * transformation
         target[1]:get_cluster():kill()
         local shape = 0 + cluster:sub(2)
         local shape_map = wo:newMap(" ", context.shapes[shape]) ^ newtransform
         local offset = po(3 - shape_map.width/2, 3 - shape_map.height/2)
         wo:drawMap(context[3], context.src_anchor + offset, " ", shape_map)
-        st(context.src_area)["_transform"] = newtransform
+        st(context.src_area)["_transform"] = newtransform.index
     end
 
     context.rotate = function()
-        context.transform(context.rotations)
+        context.transform(MAP_ROT_CW)
     end
     
     context.mirror = function()
-        context.transform(context.mirrors)
+        context.transform(MAP_FLIP_HORIZONTAL)
     end
     
     context.check = function()
@@ -117,10 +117,6 @@
     context.shapes = {{"OOOOO"}, {"PP","PPP"}, {"QQQQ","Q"},{"R","RRR"," R"},
         {"  SS","SSS"},{"T","TTT","T"},{"U U","UUU"},{"VVV","V","V"},
         {"W","WW"," WW"},{" X","XXX"," X"},{"YYYY"," Y"},{"ZZ"," Z"," ZZ"}}
-    context.rotations = {MAP_ROT_CW, MAP_ROT_180, MAP_ROT_CCW, MAP_IDENT, 
-        MAP_FLIP_VERTICAL, MAP_FLIP_BACKSLASH, MAP_FLIP_HORIZONTAL, MAP_FLIP_SLASH}
-    context.mirrors = {MAP_FLIP_HORIZONTAL, MAP_FLIP_SLASH, MAP_FLIP_VERTICAL,
-        MAP_FLIP_BACKSLASH, MAP_ROT_CCW, MAP_IDENT, MAP_ROT_CW, MAP_ROT_180}
     setmetatable(context, res.metatable)
     return context
 end

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-27 00:46:26 UTC (rev 1735)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-27 23:19:26 UTC (rev 1736)
@@ -8781,6 +8781,9 @@
 @item @samp{MAP_FLIP_VERTICAL} = flip up and down
 @end itemize
 
+Because map transformations are not numbers, you may not safe them as
+attributes of objects. Instead, you have to use @samp{index} and
+ at samp{MAP_ALL}, see @ref{Map Transformation Index and MAP_ALL}.
 
 @c ----------------- Global Attributes --------------------
 @node Global Attributes
@@ -20142,9 +20145,10 @@
 * lib.map.replace_outside::
 * lib.map.sub::
 * lib.map.trim::
+* Map Transformation Index and MAP_ALL::
 * Map Transformation Composition and Powers:: Operators @samp{*} and @samp{^}
 * Map Transformation Inverse::                Operator @samp{-}
-* Random and All Map Transformations::
+* Random Map Transformations::
 @end menu
 
 @c ----------------- Creating Maps --------------------
@@ -21525,8 +21529,56 @@
 original map.
 @end table
 
-* Map Transformation Composition and Powers:: Operators @samp{*} and @samp{^}
+ at c ----------------- Map Transformation Index and MAP_ALL --------------------
 
+ at node Map Transformation Index and MAP_ALL
+ at subsection Map Transformation Index and MAP_ALL
+
+All eight transformation constants (see @ref{map read directions},
+ at ref{Rotating and Mirroring Maps}, @ref{Map Transformation}) are additionally
+packed into the table @code{MAP_ALL}, so a simple call to
+ at code{ipairs(MAP_ALL)} can iterate over all of them. @code{MAP_ALL} is provided
+without need to load libmap.
+
+Each transformation offers the field @code{"index"}, which returns the number at
+which the transformation appears in @code{MAP_ALL}. libmap is not needed to use
+ at code{"index"} either.
+
+ at table @asis
+ at item @b{Syntax:}
+ at b{MAP_ALL} = @{@b{MAP_IDENT}, @b{MAP_ROT_CW}, @b{MAP_ROT_180}, @b{MAP_ROT_CCW}, @b{MAP_FLIP_BACKSLASH},
+           @b{MAP_FLIP_HORIZONTAL}, @b{MAP_FLIP_SLASH}, @b{MAP_FLIP_VERTICAL}@}
+
+ at b{transformation_index} = @i{maptransformation}. at b{index}
+
+ at table @asis
+ at item @i{transformation_index}
+An integer between 1 and 8.
+
+ at item @i{maptransformation}
+A map transformation.
+ at end table
+
+ at item @b{Syntax Samples:}
+ at example
+MAP_ALL[MAP_ROT_CW.index] == MAP_ROT_CW
+ at end example
+
+ at item @b{Details:}
+You may not safe map transformations as attributes of objects, for example the
+following will throw an error:
+ at example
+no["stone_a"]["_mytrafo"] = MAP_ROT_CCW
+ at end example
+Instead, you have to use @code{index} and retrieve the correct transformation
+from @code{MAP_ALL}:
+ at example
+no["stone_a"]["_mytrafo"] = MAP_ROT_CCW.index
+...
+oldtrafo = MAP_ALL[no["stone_a"]["_mytrafo"]]
+ at end example
+ at end table
+
 @c ----------------- Map Transformation Composition and Powers --------------------
 
 @node Map Transformation Composition and Powers
@@ -21642,26 +21694,16 @@
 which works just as well(see @ref{Map Transformation Composition and Powers}).
 @end table
 
- at c ----------------- Random and All Map Transformations --------------------
+ at c ----------------- Random Map Transformations --------------------
 
- at node Random and All Map Transformations
- at subsection Random and All Map Transformations
+ at node Random Map Transformations
+ at subsection Random Map Transformations
 
-All eight transformation constants (see @ref{map read directions},
- at ref{Rotating and Mirroring Maps}, @ref{Map Transformation}) are additionally
-packed into the table @code{MAP_ALL}, so a simple call to
- at code{ipairs(MAP_ALL)} can iterate over all of them. @code{MAP_ALL} is provided
-without need to load libmap.
+libmap provides the function @code{lib.map.random_transformation()} to pick one
+of the eight transformations by random.
 
-In addition, libmap provides the function
- at code{lib.map.random_transformation()} to pick one of the eight transformations
-by random.
-
 @table @asis
 @item @b{Syntax:}
- at b{MAP_ALL} = @{@b{MAP_IDENT}, @b{MAP_ROT_CW}, @b{MAP_ROT_180}, @b{MAP_ROT_CCW}, @b{MAP_FLIP_BACKSLASH},
-           @b{MAP_FLIP_HORIZONTAL}, @b{MAP_FLIP_SLASH}, @b{MAP_FLIP_VERTICAL}@}
-
 @i{randomtransformation} = @b{lib.map.random_transformation}()
 
 @table @asis



