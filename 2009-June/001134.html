<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Enigma-game-svn] r1705 - trunk/doc/reference
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/enigma-game-svn/2009-June/index.html" >
   <LINK REL="made" HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1705%20-%20trunk/doc/reference&In-Reply-To=%3C200906052252.n55Mqtj0026672%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001133.html">
   <LINK REL="Next"  HREF="001135.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Enigma-game-svn] r1705 - trunk/doc/reference</H1>
    <B>ral at mail.berlios.de</B> 
    <A HREF="mailto:enigma-game-svn%40lists.berlios.de?Subject=Re%3A%20%5BEnigma-game-svn%5D%20r1705%20-%20trunk/doc/reference&In-Reply-To=%3C200906052252.n55Mqtj0026672%40sheep.berlios.de%3E"
       TITLE="[Enigma-game-svn] r1705 - trunk/doc/reference">ral at mail.berlios.de
       </A><BR>
    <I>Sat Jun  6 00:52:55 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001133.html">[Enigma-game-svn] r1704 - trunk/src/items
</A></li>
        <LI>Next message: <A HREF="001135.html">[Enigma-game-svn] r1706 - trunk/doc/reference
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1134">[ date ]</a>
              <a href="thread.html#1134">[ thread ]</a>
              <a href="subject.html#1134">[ subject ]</a>
              <a href="author.html#1134">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: ral
Date: 2009-06-06 00:52:36 +0200 (Sat, 06 Jun 2009)
New Revision: 1705

Modified:
   trunk/doc/reference/enigma-ref.texi
Log:
Trunk 1.1: refman
- updates to last trunk commits

Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2009-06-04 23:01:01 UTC (rev 1704)
+++ trunk/doc/reference/enigma-ref.texi	2009-06-05 22:52:36 UTC (rev 1705)
@@ -3088,6 +3088,7 @@
 But these unique names should never interfere with the user assigned object
 names.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Object Attributes --------------------
 @node Object Attributes
 @subsection Object Attributes
 
@@ -3117,7 +3118,7 @@
 If we speak of a bool value we do it in the sense of Lua 5, that means with the
 possible values @samp{true} and @samp{false}.
 
-Many enumerated values like directions and colors are covered by the integer
+Many enumerated values like orientations and colors are covered by the integer
 numbers.
 
 Of special interest is the value @samp{nil}. Just a few attributes make direct
@@ -3125,7 +3126,7 @@
 attribute to value @samp{nil} you do actually reset its value to the default
 value. E.g. if you set the attribute &quot;orientation&quot; of @ref{st_boulder} to
 @samp{nil} it will be set to its default, which is actually @samp{NORTH}, an
-enumerated direction value. A subsequent read of the attribute will return this
+enumerated orientation value. A subsequent read of the attribute will return this
 value. Just those attributes that allow a nil value will ever return @samp{nil}
 on a read access. As a direct consequence these attributes always default to
 @samp{nil}.
@@ -3217,6 +3218,7 @@
 * Object State::
 @end menu
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Messages --------------------
 @node Messages
 @subsection Messages
 
@@ -3259,6 +3261,7 @@
 All messages are listed and described in @ref{Common Messages} and the
 subsequent chapters.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Target - Action --------------------
 @node Target - Action
 @subsection Target - Action
 
@@ -3359,6 +3362,7 @@
 the sequence of actions. This can cause unexpected logical results on the other
 hand.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Callback Function --------------------
 @node Callback Function
 @subsection Callback Function
 
@@ -3402,6 +3406,7 @@
 The @ref{Advanced Lua Examples} will show examples of real powerful callback
 functions with a line by line comment.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Object State --------------------
 @node Object State
 @subsection Object State
 
@@ -3415,8 +3420,8 @@
 Even though states are usually named by appropriate uppercase names like above,
 the states are integer numbers starting with @samp{0} usually related to the
 default state. But some objects use another mapping due to historic reasons.
-E.g. states that are direction related use the state @samp{3} representing
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at samp</A>{NORTH} usually as the default and number the directions clockwise down to
+E.g. states that are orientation related use the state @samp{3} representing
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at samp</A>{NORTH} usually as the default and number the orientations clockwise down to
 @samp{0} representing @samp{WEST}.
 
 In most cases it is sufficient to perform a state independent common action
@@ -3642,7 +3647,7 @@
 reason to dig into this language at the very beginning.
 
 With the second Lua API version, as of Enigma 1.10, we designed an optimized
-way of describing levels in a very short and readable manner. Thus we do
+way of describing levels in a very short and readable manner. Thus we like to
 introduce you to this API by giving several examples from a basic level to most
 thrilling dynamic real Enigma levels. You should be able to start your first
 experiments just after reading the first example with its explanations.
@@ -3652,8 +3657,8 @@
 attribute or message names are colored in blue. Level specific variable names
 and value constants are colored in magenta.
 
-After the examples and a short overview we do give details of the language
-specific API part as you can expect it for a reference manual. Please note
+After the examples and a short overview the details of the language specific API
+part are given, as you can expect it for a reference manual. Please note
 that additional @ref{Advanced Features} are described in a separate chapter.
 
 @menu
@@ -5143,6 +5148,21 @@
 @node Introduction Datatypes
 @section Introduction Datatypes
 
+Before describing the datatypes in detail let us look at the used common 
+concepts and conventions.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at menu</A>
+* Syntax and Conventions::         Abbreviations in syntax descriptions
+* Value and Reference::            Basic differences of datatypes
+* Polymorphism and Overloading::   Methods of Object Orientation
+* Pseudo Datatypes::               Reinterpretation of datatypes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> menu
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Syntax and Conventions --------------------
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Syntax and Conventions
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Syntax and Conventions
+
 In the following subchapters we will describe the datatypes, their operators
 and methods, and global functions in detail. We need some syntax and
 conventions for an efficient description.
@@ -5189,6 +5209,11 @@
 still free to name your position variable and the resulting value variable
 whatever you like.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Value and Reference --------------------
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Value and Reference
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Value and Reference
+
 Another most important aspect of Lua data types is the difference between
 values and references. Values are numbers, booleans like @samp{true} and
 @samp{false}, strings and @samp{nil}. The only reference data type is the Lua
@@ -5213,6 +5238,11 @@
 reference. If you are unfamilar to the resulting effects you may want to read
 the appendix about @ref{Caveats}.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Polymorphism and Overloading --------------------
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Polymorphism and Overloading
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Polymorphism and Overloading
+
 @cindex polymorphism
 You may have noticed that in many operations you can use an @ref{Object} as
 a @ref{Position}. This is due to the fact that objects support most of the
@@ -5242,6 +5272,43 @@
 object either into a position or a group. Please read carefully the given
 syntax rules for a clear understanding of the results.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- Pseudo Datatypes --------------------
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> Pseudo Datatypes
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> Pseudo Datatypes
+
+Even though we introduce just the ten additional fundamental datatypes as
+described in the following subchapters, the API does additionally differ
+the same datatype according to its usage. E.g. a standard Lua number is used to
+describe the @ref{state} of an object. Just in rare occurences the state will 
+reflect a real number like the state of @ref{ot_counter}. For most objects
+the state will just be one of a given set of allowed values, which happen to
+be described by numbers by the API. Thus we speak of a pseudo datatype
+in the case of @ref{state} values. 
+
+The API provides @ref{Common Constants} for all pseudo datatypes, all written in
+upper case letters only. You should use exclusively these constants and never
+their equivalent basic number or other type values. The usage of the constants
+makes the level code readable and upward compatible if we ever should have the
+need of changing the assigned values or transforming the pseudo datatype to a
+another datatype.
+
+There is one abstract datatype that needs to be mentioned, as it uses two 
+different pseudo datatypes at the same time. This special case is the datatype
+used to describe the @samp{direction} or @samp{orientation}. Both are 
+essentially the same. But we speak of @samp{orientation} if we are just 
+interested in enlisting the main directions by number values for the purpose of 
+identification. The constant values are given as @ref{orientations}. 
+
+Sometimes you need values for calculation of position offsets. In this case we
+speak of a @samp{direction} and use @ref{Position} values as offset vectors. 
+The most common values are given as constants as listed in subchapter
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{direction offsets}. Note that our @samp{direction} values have no need of
+being normalized to the length of 1.
+
+A given @samp{orientation} can be transformed into a @samp{direction} value by
+the convertion table @ref{ORI2DIR}.
+
 @c ----------------- Position --------------------
 
 @node Position
@@ -6359,6 +6426,7 @@
 For task driven samples @pxref{Named Positions Tasks}. 
 
 @menu
+* PositionList Comparison::          Equality @samp{==} and Inequality @samp{~=}
 * PositionList Length::              Operator @samp{#}
 * PositionList Member Access::       Index Operators @samp{[]}
 * PositionList Concatenation::       Operator @samp{..}
@@ -6366,6 +6434,26 @@
 * PositionList Stretching::          Operators @samp{*} and @samp{/}
 @end menu
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- PositionList Comparison --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> PositionList Comparison
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> PositionList Comparison
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
+result = @i{polist1} &lt;==|~=&gt; @i{polist2}
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+A comparison of two position lists. Two position lists are equal if both contain
+the same positions in the identical sequence. Otherwise they are unequal.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at var</A>{bool} = (@i{po}(@var{2}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{3}).. @i{po}(@var{5}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{7})) == (@i{po}(@var{2}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{3}) .. @i{po}(@var{5}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{7}))  -- = true
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at var</A>{bool} = (@i{po}(@var{2}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{3}).. @i{po}(@var{5}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{7})) == (@i{po}(@var{4}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{0}) .. @i{po}(@var{5}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{7}))  -- = false, different positions
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at var</A>{bool} = (@i{po}(@var{2}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{3}).. @i{po}(@var{5}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{7})) == (@i{po}(@var{5}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{7}) .. @i{po}(@var{2}<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">, at var</A>{3}))  -- = false, different sequence
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
+
 @c ----------------- PositionList Length --------------------
 @node PositionList Length
 @subsection PositionList Length
@@ -6617,7 +6705,7 @@
 second example uses the shortcut of specifying the name attribute value as
 second table entry, that will be stored at table position @samp{2}. It has to
 be a string value. The third variation, that is useful for actor declarations,
-stores the grid offsets in x and y direction in the table postions @samp{2} and
+stores the grid offsets in x and y directions in the table postions @samp{2} and
 @samp{3}. Of course you can not use the name attribute shortcut in the same
 declaration.
 
@@ -6907,9 +6995,9 @@
 
 @table @asis
 @item @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at b</A>{wo:drawBorder}(@i{upperleft_edge}, @i{lowerright_edge}, @i{tile})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{wo:drawBorder}(@i{upperleft_edge}, @i{lowerright_edge}, &lt;@i{tile} | @i{key}, @i{resolver}&gt;)
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at b</A>{wo:drawBorder}(@i{upperleft_edge}, @i{width}, @i{height}, @i{tile})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{wo:drawBorder}(@i{upperleft_edge}, @i{width}, @i{height}, &lt;@i{tile} | @i{key}, @i{resolver}&gt;)
 
 @table @asis
 @item @i{upperleft_edge}
@@ -6920,12 +7008,20 @@
 Width of the rectangle.
 @item @i{height}
 Height of the rectangle.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{tile}
+A tile or an object declaration.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{key}
+A key string to be resolved via the given resolver.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{key}
+A resolver to be used for resolving the key to a valid tile.
 @end table
 
 @item @b{Syntax Samples:}
 @example
 wo:drawBorder(po(0, 0), wo[&quot;Width&quot;], wo[&quot;Height&quot;], ti[&quot;#&quot;])
 wo:drawBorder(no[&quot;myRectUL&quot;], no[&quot;myRectLR&quot;], @{&quot;st_grate1&quot;@})
+wo:drawBorder(no[&quot;myRectUL&quot;], no[&quot;myRectLR&quot;], @{&quot;fl_water&quot;@} .. ti[&quot;X&quot;])
+wo:drawBorder(no[&quot;myRectUL&quot;], no[&quot;myRectLR&quot;], &quot;x&quot;, myresolver)
 @end example
 
 @item @b{Details:}
@@ -7055,9 +7151,9 @@
 
 @table @asis
 @item @b{Syntax:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at b</A>{wo:drawRect}(@i{upperleft_edge}, @i{lowerright_edge}, @i{tile})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{wo:drawRect}(@i{upperleft_edge}, @i{lowerright_edge}, &lt;@i{tile} | @i{key}, @i{resolver}&gt;)
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at b</A>{wo:drawRect}(@i{upperleft_edge}, @i{width}, @i{height}, @i{tile})
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at b</A>{wo:drawRect}(@i{upperleft_edge}, @i{width}, @i{height}, &lt;@i{tile} | @i{key}, @i{resolver}&gt;)
 
 @table @asis
 @item @i{upperleft_edge}
@@ -7068,12 +7164,20 @@
 Width of the rectangle.
 @item @i{height}
 Height of the rectangle.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{tile}
+A tile or an object declaration.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{key}
+A key string to be resolved via the given resolver.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @i{key}
+A resolver to be used for resolving the key to a valid tile.
 @end table
 
 @item @b{Syntax Samples:}
 @example
 wo:drawRect(po(0, 0), wo[&quot;Width&quot;], wo[&quot;Height&quot;], ti[&quot; &quot;])
 wo:drawRect(no[&quot;myRectUL&quot;], no[&quot;myRectLR&quot;], @{&quot;fl_water&quot;@})
+wo:drawRect(no[&quot;myRectUL&quot;], no[&quot;myRectLR&quot;], @{&quot;fl_water&quot;@} .. ti[&quot;#&quot;])
+wo:drawRect(no[&quot;myRectUL&quot;], no[&quot;myRectLR&quot;], &quot;x&quot;, myresolver)
 @end example
 
 @item @b{Details:}
@@ -7321,6 +7425,7 @@
 * fl::              Floor retrieval
 * grp::             Create a group out of the argument objects
 * it::              Item retrieval
+* ORI2DIR::         Orientation to direction convertion
 * random::          Random number generator
 * st::              Stone retrieval
 * usertype::        Type info for Enigma userdata types 
@@ -7578,10 +7683,10 @@
 @item @i{&quot;table&quot;}
 If @code{var} is a table, it's metatable will be queried. If there is an entry
 @samp{_type}, this entry will be used as @code{etype}. Most important examples
-of this kind are @ref{libmap}-maps and @ref{res.maze} with its mazes and cells.
-So @samp{etype} will return @code{&quot;map&quot;}, @code{&quot;maze&quot;} and @code{&quot;cell&quot;}, too.
-You may access the @code{etype}-system through @samp{_type} whenever you use
-metatables on your own.
+of this kind are @ref{libmap}-maps, @ref{Resolvers} and @ref{res.maze} with its
+mazes and cells. So @samp{etype} will return @code{&quot;map&quot;}, @code{&quot;resolver&quot;}, 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at code</A>{&quot;maze&quot;} and @code{&quot;cell&quot;}, too. You may access the @code{etype}-system
+through @samp{_type} whenever you use metatables on your own.
 @end table
 
 @end table
@@ -7689,6 +7794,28 @@
 
 @end table
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at c</A> ----------------- ORI2DIR --------------------
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at node</A> ORI2DIR
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at subsection</A> ORI2DIR
+
+The table @samp{ORI2DIR[]} converts orientation values to direction values.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at table</A> @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax:}
+result = @b{ORI2DIR}[@var{orientation}]
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Details:}
+The table has stored the proper directions values at the index positions of
+the related orientations.
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{Syntax Samples:}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at example</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at var</A>{direction} = @i{ORI2DIR}[NORTH]      -- N  = po(0, -1)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at var</A>{direction} = @i{ORI2DIR}[SOUTHEAST]  -- SE = po(1,  1)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at var</A>{direction} = @i{ORI2DIR}[NODIR]      --      po(0,  0)
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> example 
+
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at end</A> table
 @c ----------------- random --------------------
 @node random
 @subsection random
@@ -7971,7 +8098,7 @@
 @item @b{Access:} @ @ read/write
 @item @b{Support:} @ @ by most objects
 All objects with boolean action values will support this attribute. Additionally
-some objects with other invertible action value types like directions will
+some objects with other invertible action value types like orientations will
 support the inversion of their attributes as stated in the individual object
 descriptions.
 @end table
@@ -8154,7 +8281,7 @@
 to @samp{OFF} or from @samp{OFF} to @samp{ON}. Door like objects will toggle
 their state from @samp{OPEN} to @samp{CLOSED} or from @samp{CLOSED} to
 @samp{OPEN}. Other objects like @ref{st_fourswitch} will turn into the next
-direction. Generally the object will toggle to its next state.
+orientation. Generally the object will toggle to its next state.
 
 @table @asis
 @item @b{Value:} @ @ -
@@ -8181,7 +8308,7 @@
 A signal message tries to set the object to the state 0 (@samp{OFF},
 @samp{CLOSED}) or state 1 (@samp{ON}, @samp{OPEN}) according to its value. This
 message allows you to keep the states of an action source and a receiving object
-in sync. Note that values like @samp{true}, @samp{false} and direction values
+in sync. Note that values like @samp{true}, @samp{false} and orientation values
 like @samp{WEST} to @samp{NORTH} are converted to 0 and 1. This allows you to
 use @samp{signal} as action message on most objects.
 
@@ -8325,6 +8452,8 @@
 @node Common Constants
 @section Common Constants
 
+Constants for @ref{Pseudo Datatypes}.
+
 @menu
 * state values::
 * color values::
@@ -10668,8 +10797,8 @@
 or tubes that channelize actors.
 
 Slope floors are basically described by their @samp{slope} and their @samp{shape}.
-The slope is the direction of the force applied to actors on top. The eight
-main directions and @samp{NODIR}, that causes no force to be applied at all, are
+The slope is the orientation of the force applied to actors on top. The eight
+main orientations and @samp{NODIR}, that causes no force to be applied at all, are
 currently supported.
 
 The shape describes the intended usage, which causes a proper visual
@@ -10685,7 +10814,7 @@
 @code{&quot;tnr&quot;}).
 
 Note that several shapes do currently use an identical visual representation.
-But they differ in their usage and different slope force directions are
+But they differ in their usage and different slope force orientations are
 assigned by default when you use the variant suffices. It is strongly
 recommended to use always the shape of the intended usage as the images might
 be improved in the future and should fit to your level.
@@ -10702,7 +10831,7 @@
 
 @table @asis
 @item @b{slope}, @ @ @i{values}: @code{NODIR}, @code{WEST}, @code{SOUTH}, @code{EAST}, @code{NORTH}, @code{NORTHWEST}, @code{SOUTHWEST}, @code{SOUTHEAST}, @code{NORTHEAST}; @ @ @i{default}: @code{NODIR}
-The direction of the force. Note that setting this attribute does not
+The orientation of the force. Note that setting this attribute does not
 automatically assign a fitting @samp{shape}. This attribute is neglected if
 @samp{force_x} or @samp{force_y} attributes are set.
 
@@ -11395,6 +11524,9 @@
 @item @ref{it_squashed} - remove from floor
 @end itemize
 
+The brush is sensitive to laser light an dissolves with an @ref{it_explosion}_nil
+leaving no remnants when being hit by light.
+
 @table @asis
 
 @item @b{Attributes:}
@@ -11519,6 +11651,9 @@
 This item looks like a piece of paper and contains a text message that can be
 displayed by activating the item. It is destroyed by explosions from 
 @ref{it_bomb}, @ref{st_dispenser}, @ref{it_dynamite} and by burning fire.
+The document is sensitive to laser light an dissolves with an 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{it_explosion}_nil leaving no remnants when being hit by light.
+
 Another message carrying item is the @ref{it_bottle}.
 
 @table @asis
@@ -11905,11 +12040,11 @@
 
 @itemize @bullet
 @item @ref{st_blur}, magic - transforms to @ref{st_passage},
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @ref{st_boulder} - changes direction of a boulder,
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_boulder} - changes orientation of a boulder,
 @item @ref{st_chess} - changes the color of a chess stone,
 @item @ref{st_ghost}, greenbrown - transforms to @ref{st_greenbrown},
 @item @ref{st_magic}, brick - transforms to a @ref{st_rawglass},
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @ref{st_oneway} - changes direction of a oneway,
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @ref{st_oneway} - changes orientation of a oneway,
 @item @ref{st_puzzle} - scrambles blue puzzle stones instead of pushing, causes complete
 clusters to explode,
 @item @ref{st_rubberband} - makes rubberband stones movable,
@@ -12490,7 +12625,7 @@
 
 A wrench wielded as first item in the players inventory causes some objects
 to react on actor hits. An @ref{st_rotator} changes its turning direction.
-An green @ref{st_turnstile} rotates backwards when hit. An @ref{st_window}
+A green @ref{st_turnstile} rotates backwards when hit. An @ref{st_window}
 face pushed with an wrench will swap to the opposite side of the stone if
 possible.
 
@@ -14374,7 +14509,7 @@
 * st_flash::           Partner Marble pushing Stone
 * st_flat::            Featured Gypsum Stone
 * st_floppy::          Floppy Driven Switch
-* st_fourswitch::      Four Direction Switch
+* st_fourswitch::      Four Orientation Switch
 * st_ghost::           Invisible Transforming Stone
 * st_grate::           Hovering metal Grate
 * st_greenbrown::      Mainly brown seedable stone
@@ -14450,7 +14585,7 @@
 even glasses generated by laser lighting an @ref{it_extralife} can be configured
 to show invisible actorimpulse stones.
 
-An @ref{st_boulder} hitting an actorimpulse stone will revert its direction
+An @ref{st_boulder} hitting an actorimpulse stone will revert its orientation
 and return in the incoming direction.
 
 @table @asis
@@ -14652,9 +14787,9 @@
 Boulder stones fall into @ref{fl_abyss}, but cross @ref{fl_water}
 unchanged.
 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at ref</A>{it_magicwand} and lasers reverse its direction. An @ref{st_actorimpulse}
-reverts the direction if the boulder hits it frontally. An @ref{st_rotator}
-changes its direction according to the rotator's direction. An
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{it_magicwand} and lasers reverse its orientation. An @ref{st_actorimpulse}
+reverts the orientation if the boulder hits it frontally. An @ref{st_rotator}
+changes its orientation according to the rotator's direction. An
 @ref{st_stoneimpulse} pushes a boulder away.
 
 @table @asis
@@ -14675,7 +14810,7 @@
 @table @asis
 @msindex orientate
 @item @b{orientate}, @ @ @i{value type}: direction
-Change the orientation to the given direction value. The @ref{st_fourswitch}
+Change the orientation to the given orientation value. The @ref{st_fourswitch}
 provides a compatible action which allows you to set a boulder as
 target and this message as action.
 @item @b{turn}
@@ -15571,15 +15706,15 @@
 @subsection st_fourswitch
 @obindex st_fourswitch
 
-A switch that points to one of the four directions turning on every switching
-event. The most common event is an actor hitting this stone. But @ref{st_boulder}
-will trigger this switch, too. Of course other objects can send messages on
-actions to make this switch turning.
+A switch that points into one of the four orientations and turning on every
+switching event. The most common event is an actor hitting this stone. But 
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at ref</A>{st_boulder} will trigger this switch, too. Of course other objects can send
+messages on actions to make this switch turning.
 
 When turning its pointer on a switching event it performs the action given by
 the @samp{action/target}-pair. This can be either a common pair or a
-state/direction dependent pair allowing you to issue different messages
-dependent on the pointing direction.
+state/orientation dependent pair allowing you to issue different messages
+dependent on the pointing orientation.
 
 @table @asis
 @item @b{Attributes:}
@@ -15592,8 +15727,8 @@
 direction.
 @item @b{inverse} @ @ @xref{inverse}
 Note that the action value is inverted in its boolean interpretation. This means
-that an inverted action value is @emph{not} the reverse direction and should not
-be used as a direction value at all.
+that an inverted action value is @emph{not} the reverse orientation and should
+not be used as an orientation value at all.
 @end table
 
 @item @b{Messages:}
@@ -15608,10 +15743,10 @@
 
 @item @b{Action:} @ @ @xref{target}, @ @ @xref{action}
 Performs an action on each turn. If just a pair of global @samp{target/action}
-attributes are given, the action message is sent to the target with a
-direction value of the new orientation. This value suits any message of the
-target that expects a direction value, and the @ref{signal} message, that
-translates the direction to a 1 for @samp{NORTH}, @samp{SOUTH} and a 0 for
+attributes are given, the action message is sent to the target with a value of
+the new orientation. This value suits any message of the target that expects
+an orientation value, and the @ref{signal} message, that translates the 
+orientation value to a 1 for @samp{NORTH}, @samp{SOUTH} and a 0 for
 @samp{EAST}, @samp{WEST}.
 
 If state dependent target/action pairs are given instead, namely
@@ -15961,7 +16096,7 @@
 The laser stone is the only object that is capable of emitting light beams.
 Per default laser stones are switched off. The @samp{state} attribute represents
 the activity of the laser and can be set initially to @samp{ON}. A laser is
-orientated to one direction in which the light will be emitted.
+orientated to one direction into which the light will be emitted.
 
 Lasers have a latency that protect them from infinite fast switching cycles. This
 allows you to toggle a laser with an @ref{st_laserswitch} that is illuminated
@@ -16361,8 +16496,8 @@
 
 @table @asis
 @msindex orientate
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @b{orientate}, @ @ @i{value type}: direction
-Change the orientation to the given direction value. The @ref{st_fourswitch}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{orientate}, @ @ @i{value type}: orientation
+Change the orientation to the given orientation value. The @ref{st_fourswitch}
 provides a compatible action which allows you to set a mirror as
 target and this message as action.
 @item @b{turn}
@@ -16471,8 +16606,8 @@
 @item @b{Messages:}
 
 @table @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @b{orientate}, @ @ @i{value type}: direction
-Change the orientation to the given direction value. The @ref{st_fourswitch}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{orientate}, @ @ @i{value type}: orientation
+Change the orientation to the given orientation value. The @ref{st_fourswitch}
 provides a compatible action which allows you to set a oneway as
 target and this message as action.
 @item @b{flip},
@@ -16993,10 +17128,10 @@
 @item @b{get_adjacents}
 Returns the huddle of all adjacent puzzle stones of same color independent of
 being connected or not. The huddle is returned as a group.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @b{pull_rotate}, @ @ @i{value type}: direction
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{pull_rotate}, @ @ @i{value type}: orientation
 Perform a reverse @samp{push_rotate} from this puzzle stones with the line
 of puzzle stone into the given direction.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @b{push_rotate}, @ @ @i{value type}: direction
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{push_rotate}, @ @ @i{value type}: orientation
 Perform a line rotation as described above from this puzzle stones with the line
 of puzzle stone into the given direction.
 
@@ -17116,7 +17251,7 @@
 @obindex st_rotator
 
 Rotators send impulses to neighboring stones, thus pushing them in the direction
-given by the rotation. @ref{st_boulder} additionally change their direction to
+given by the rotation. @ref{st_boulder} additionally change their orientation to
 the one they are pushed to.
 
 Rotators can either rotate in clockwise or counterclockwise direction. They can
@@ -17787,7 +17922,7 @@
 @item @b{orientation}, @ @ @i{values}: @code{NORTH}, @code{EAST}, @code{SOUTH}, @code{WEST}; @ @ @i{default}: @code{NORTH}
 The orientation of the turnstile that is only visible by its arms. Setting
 this attribute just defines a new base, but does not turn the turnstile as the
-direction would not be defined. But every rotation does update this attribute
+orientation would not be defined. But every rotation does update this attribute
 relative to its previous value.
 @end table
 
@@ -17822,7 +17957,7 @@
 An arm that usually connects to an @ref{st_turnstile} pivot building a turnstile
 cluster. The arm's subkind suffix, its state and orientation are named according
 to the arm's position within the turnstile cluster. Thus a @samp{NORTH} arm has
-a single standard connection of @code{&quot;s&quot;}, the reverse direction.
+a single standard connection of @code{&quot;s&quot;}, the reverse orientation.
 
 As long as a turnstile arm is not connected to a pivot it is a free movable
 stone. Intentionally it is visually indistinguishable from a @ref{st_puzzle}
@@ -17861,8 +17996,8 @@
 
 @table @asis
 @msindex orientate
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @b{orientate}, @ @ @i{value type}: direction
-Change the orientation to the given direction value. The @ref{st_fourswitch}
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{orientate}, @ @ @i{value type}: orientation
+Change the orientation to the given orientation value. The @ref{st_fourswitch}
 provides a compatible action which allows you to set an arm as
 target and this message as action.
 @end table
@@ -18006,8 +18141,8 @@
 @item @b{Messages:}
 
 @table @asis
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">- at item</A> @b{inner_pull}, @ @ @i{value type}: direction
-Tries to tear the opposite window face into the given direction.
<A HREF="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">+ at item</A> @b{inner_pull}, @ @ @i{value type}: orientation
+Tries to tear the opposite window face into the given orientation.
 @end table
 
 @item @b{Variants:}
@@ -19248,7 +19383,7 @@
 
 @item @b{Syntax Samples:}
 @example
-directions = lib.lua.shuffle(@{NORTH, SOUTH, EAST, WEST@})
+orientations = lib.lua.shuffle(@{NORTH, SOUTH, EAST, WEST@})
 a = @{1, 2, 3, &quot;r&quot;, @{&quot;x&quot;, &quot;y&quot;, &quot;z&quot;@}, 4@}
 b = lib.lua.shuffle(a)
 @end example
@@ -21067,18 +21202,11 @@
 @end example
 
 @item @b{Details:}
-Cell
+To be written.
 
 
 @item @b{Full Example:}
 @example
-ti[&quot; &quot;] = @{&quot;fl_sahara&quot;@}
-
-w, h = wo(resolver, &quot; &quot;, @{
-&quot;                                        &quot;,
-&quot;                                        &quot;,
-&quot;                                        &quot;
-@})
 @end example
 @end table
 
@@ -21999,9 +22127,12 @@
 
 It is the task of the configurator function to check the user supplied
 parameters thoroughly and to provide appropriate error messages on bad
-parameters. Do this with a lua error message call at level 2:
+parameters. Do this with a lua error message call at level 2 or the useful
+helper functions @ref{assert_bool} and @ref{assert_type}:
 @example
 error(&quot;Resolver autotile rule &quot; .. i..&quot; is not a table&quot;, 2)
+assert_bool(is_resolver(subresolver), &quot;res.composer first argument (subresolver)&quot;, 2)
+assert_type(args[1], &quot;res.composer second argument (sequence)&quot;, 2, &quot;non-empty string&quot;)
 @end example
 
 The configuration function has to return a table that contains the context
@@ -22022,10 +22153,21 @@
 first parameter of the configurator call needs to be the third context
 table entry.
 
+The context needs to add a metatable with two entries. First @code{&quot;_type&quot;} 
+needs to identify the context as an enigma data type for the @ref{etype}
+function. Most resolvers to simply store the string @code{&quot;resolver&quot;}, but
+special ones might return special identification strings like @code{&quot;maze&quot;}.
+The second required entry is @code{&quot;_resolver&quot;} that needs a boolean @samp{true}
+value assigned for purpose of secure identification of resolver tables. A 
+default resolver metatable is stored at @samp{res.metatable} and can directly
+be set by @samp{setmetatable}.
+
 @item @b{Full Example:}
 @example
 function res.composer(subresolver)
+    assert_bool(is_resolver(subresolver), &quot;res.composer first argument (subresolver)&quot;, 2)
     local context = @{res.composer_implementation, nil, subresolver@}
+    setmetatable(context, res.metatable)
     return context
 end
 @end example
@@ -22093,7 +22235,7 @@
 coordinates for postprocessing operations in the finalizer.
 
 @item @b{Full Example:}
-The implementation of the composer (without the special 3 character key treatment)
+The implementation of the composer (without the special sequence treatment)
 @example
 function res.composer_implementation(context, evaluator, key, x, y)
     local tile = evaluator(context[3], key, x, y)
@@ -22134,7 +22276,7 @@
 @end table
 
 @item @b{Details:}
-The finalization functions of chained resolvers are called from top to bottom.
+The finalization functions of chained resolvers are called from bottom to top.
 
 Many resolvers have no need of a finalization. But some like a maze constructor
 need to know all participating tiles until they can do their final work.
@@ -22176,7 +22318,7 @@
 
 @node Title Recommendation
 @section Title Recommendation
-English - no translation - use subtitle, too
+English titles preferred - use subtitle, too
 
 @node Tile Key Recommendation
 @section Tile Key Recommendation


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001133.html">[Enigma-game-svn] r1704 - trunk/src/items
</A></li>
	<LI>Next message: <A HREF="001135.html">[Enigma-game-svn] r1706 - trunk/doc/reference
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1134">[ date ]</a>
              <a href="thread.html#1134">[ thread ]</a>
              <a href="subject.html#1134">[ subject ]</a>
              <a href="author.html#1134">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/enigma-game-svn">More information about the Enigma-game-svn
mailing list</a><br>
</body></html>
