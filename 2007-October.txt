From ral at mail.berlios.de  Mon Oct  1 00:24:32 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Mon, 1 Oct 2007 00:24:32 +0200
Subject: [Enigma-game-svn] r890 - in trunk: data src
Message-ID: <200709302224.l8UMOWDs020765@sheep.berlios.de>

Author: ral
Date: 2007-10-01 00:24:31 +0200 (Mon, 01 Oct 2007)
New Revision: 890

Modified:
   trunk/data/init.lua
   trunk/src/enigma.cc
   trunk/src/stones_complex.cc
Log:
Trunk 1.1: Lua API Reengineering
- fix Value conversion of integers to string (has been %f style)
- switch st-oxyd color attribute from string to int
- introduce init.lua compatibility layer for 1.0 API levels


Modified: trunk/data/init.lua
===================================================================
--- trunk/data/init.lua	2007-09-29 21:35:15 UTC (rev 889)
+++ trunk/data/init.lua	2007-09-30 22:24:31 UTC (rev 890)
@@ -17,6 +17,39 @@
 --
 ------------------------------------------------------------------------
 
+-------------------------------
+-- Compatibility for old API --
+-------------------------------
+
+enigma._SetAttrib = enigma.SetAttrib
+enigma._GetAttrib = enigma.GetAttrib
+
+function enigma.SetAttrib(obj, key, val)
+     local _val = val
+     local _key = key
+     if enigma.GetKind(obj) == "st-oxyd" then
+         if key == "color" then
+	     _val = 0 + val   -- convert to int
+	 end
+     end
+     enigma._SetAttrib(obj, _key, _val)
+end
+
+function enigma.GetAttrib(obj, key)
+     local _key = key
+     local val = enigma._GetAttrib(obj, key)
+     if enigma.GetKind(obj) == "st-oxyd" then
+         if key == "color" then
+	     val = "" .. val   -- convert to string
+	 end
+     end
+     return val
+end
+
+----------------------
+-- old API 1.0      --
+----------------------
+
 TRUE = 1
 FALSE = 0
 

Modified: trunk/src/enigma.cc
===================================================================
--- trunk/src/enigma.cc	2007-09-29 21:35:15 UTC (rev 889)
+++ trunk/src/enigma.cc	2007-09-30 22:24:31 UTC (rev 890)
@@ -249,7 +249,7 @@
     static std::string s;
     switch (type) {
         case Value::DOUBLE:
-            s = ecl::strf("%f", val.dval);
+            s = ecl::strf("%g", val.dval);  // need drop of trailing zeros and point for int
             return s.c_str();
         case Value::STRING: 
             return val.str;

Modified: trunk/src/stones_complex.cc
===================================================================
--- trunk/src/stones_complex.cc	2007-09-29 21:35:15 UTC (rev 889)
+++ trunk/src/stones_complex.cc	2007-09-30 22:24:31 UTC (rev 890)
@@ -2321,7 +2321,7 @@
     instances.push_back(o);
     if (server::EnigmaCompatibility >= 1.10) {
         int color = ((instances.size() -1) / 2) % 8;
-        o->set_attrib("color", ecl::strf("%d", color));
+        o->set_attrib("color", color);
     }
     return o;
 }
@@ -2331,7 +2331,7 @@
   state(CLOSED)
 {
     set_attrib("flavor", "b");
-    set_attrib("color", "0");
+    set_attrib("color", 0);
 }
 
 Value OxydStone::message(const string &m, const Value &val) 
@@ -2344,10 +2344,10 @@
         shuffle_colors();
     }
     else if (m=="trigger" || m=="spitter") {
-	maybe_open_stone();
+        maybe_open_stone();
     }
     else if (m=="signal" && to_int(val) != 0) {
-	maybe_open_stone();
+        maybe_open_stone();
     }
     else if (m=="init") {
         // odd number of oxyd stones in the level? no problem, turn a
@@ -2391,7 +2391,7 @@
 void OxydStone::change_state(State newstate) 
 {
     string flavor(getAttr("flavor","a"));
-    string color(getAttr("color", "1"));
+    string color(getAttr("color", 0));
 
     string modelname = string("st-oxyd") + flavor + color;
 
@@ -2425,12 +2425,12 @@
 
     case OPENING:
         sound_event("oxydopen");
-	if (oldstate == CLOSED)
+        if (oldstate == CLOSED)
             set_anim(modelname + "-opening");
-	else if (oldstate == CLOSING)
+        else if (oldstate == CLOSING)
             get_model()->reverse();
 
-	break;
+        break;
 
     case CLOSING:
         if (oldstate == CLOSED || oldstate==CLOSING) {



From ral at mail.berlios.de  Mon Oct  1 22:31:09 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Mon, 1 Oct 2007 22:31:09 +0200
Subject: [Enigma-game-svn] r891 - homepage/input
Message-ID: <200710012031.l91KV9jn015735@sheep.berlios.de>

Author: ral
Date: 2007-10-01 22:31:07 +0200 (Mon, 01 Oct 2007)
New Revision: 891

Modified:
   homepage/input/stat-other.html
   homepage/input/table-hcp.html
   homepage/input/table-rat.html
   homepage/input/table-solved.html
   homepage/input/table-wr.html
   homepage/input/userlist.html
Log:
Hompage:
- statistics of September 07

Modified: homepage/input/stat-other.html
===================================================================
--- homepage/input/stat-other.html	2007-09-30 22:24:31 UTC (rev 890)
+++ homepage/input/stat-other.html	2007-10-01 20:31:07 UTC (rev 891)
@@ -1,22 +1,22 @@
   <div class="stat-help">
     <h3>$$Other_Statistics$$</h3>
     <h4>$$Scores$$</h4>
-      52073 $$single_level_scores$$
+      55610 $$single_level_scores$$.
     <h4>$$Ratings$$</h4>
-      9153 $$single_level_ratings$$ 4.95 $$and_distribution$$ 
+      10275 $$single_level_ratings$$ 4.91 $$and_distribution$$: 
       <table>
         <colgroup><col width="80"><col width="80"></colgroup>
         <tr><th>$$rating$$</th><th>$$count$$</th></tr>
         <tr><td class="num">0</td><td class="num">38</td></tr>
-        <tr><td class="num">1</td><td class="num">179</td></tr>
-        <tr><td class="num">2</td><td class="num">416</td></tr>
-        <tr><td class="num">3</td><td class="num">1297</td></tr>
-        <tr><td class="num">4</td><td class="num">1690</td></tr>
-        <tr><td class="num">5</td><td class="num">2339</td></tr>
-        <tr><td class="num">6</td><td class="num">1449</td></tr>
-        <tr><td class="num">7</td><td class="num">1087</td></tr>
-        <tr><td class="num">8</td><td class="num">401</td></tr>
-        <tr><td class="num">9</td><td class="num">172</td></tr>
-        <tr><td class="num">10</td><td class="num">85</td></tr>
+        <tr><td class="num">1</td><td class="num">190</td></tr>
+        <tr><td class="num">2</td><td class="num">505</td></tr>
+        <tr><td class="num">3</td><td class="num">1494</td></tr>
+        <tr><td class="num">4</td><td class="num">2003</td></tr>
+        <tr><td class="num">5</td><td class="num">2507</td></tr>
+        <tr><td class="num">6</td><td class="num">1639</td></tr>
+        <tr><td class="num">7</td><td class="num">1185</td></tr>
+        <tr><td class="num">8</td><td class="num">436</td></tr>
+        <tr><td class="num">9</td><td class="num">189</td></tr>
+        <tr><td class="num">10</td><td class="num">89</td></tr>
       </table>
   </div>

Modified: homepage/input/table-hcp.html
===================================================================
--- homepage/input/table-hcp.html	2007-09-30 22:24:31 UTC (rev 890)
+++ homepage/input/table-hcp.html	2007-10-01 20:31:07 UTC (rev 891)
@@ -1,105 +1,112 @@
   <table>
-    <caption>$$Handicap_Statistics$$ $$August$$ 2007</caption>
+    <caption>$$Handicap_Statistics$$ $$September$$ 2007</caption>
     <colgroup><col width="130"><col width="220"></colgroup>
     <tr><th>$$solved_hcp$$</th><th class="left">$$user$$</th></tr>
-     <tr><td class="num">-130.7</td><td class="left">'Moneymaker'</td></tr>
-     <tr><td class="num"> -86.3</td><td class="left">'Stupid'</td></tr>
-     <tr><td class="num"> -85.3</td><td class="left">'Johannes'</td></tr>
-     <tr><td class="num"> -75.1</td><td class="left">'Great Scott'</td></tr>
-     <tr><td class="num"> -63.8</td><td class="left">'Duffy'</td></tr>
-     <tr><td class="num"> -49.4</td><td class="left">'Django'</td></tr>
-     <tr><td class="num"> -48.3</td><td class="left">'daydreamer'</td></tr>
-     <tr><td class="num"> -36.2</td><td class="left">'Taztunes'</td></tr>
-     <tr><td class="num"> -30.4</td><td class="left">'bojster'</td></tr>
-     <tr><td class="num"> -27.4</td><td class="left">'Alexandros'</td></tr>
-     <tr><td class="num"> -21.8</td><td class="left">'Safalra'</td></tr>
-     <tr><td class="num"> -21.3</td><td class="left">'Raoul'</td></tr>
-     <tr><td class="num"> -18.8</td><td class="left">'Ghatotkacha'</td></tr>
-     <tr><td class="num"> -17.0</td><td class="left">'ged'</td></tr>
-     <tr><td class="num"> -15.1</td><td class="left">'Ronald'</td></tr>
-     <tr><td class="num"> -14.7</td><td class="left">'Lukas'</td></tr>
-     <tr><td class="num"> -13.9</td><td class="left">'HuB34'</td></tr>
-     <tr><td class="num"> -11.1</td><td class="left">'dpl'</td></tr>
-     <tr><td class="num"> -10.0</td><td class="left">'Iceshark7'</td></tr>
-     <tr><td class="num">  -5.8</td><td class="left">'fabian'</td></tr>
-     <tr><td class="num">  -4.0</td><td class="left">'JuSt'</td></tr>
-     <tr><td class="num">  -3.7</td><td class="left">'Wuzzy'</td></tr>
-     <tr><td class="num">  -1.2</td><td class="left">'Tobias'</td></tr>
-     <tr><td class="num">  -1.0</td><td class="left">'para_doks'</td></tr>
-     <tr><td class="num">   0.3</td><td class="left">'Guglielmo'</td></tr>
-     <tr><td class="num">   1.1</td><td class="left">'Ludmian'</td></tr>
-     <tr><td class="num">   2.8</td><td class="left">'Zekobah'</td></tr>
-     <tr><td class="num">   8.4</td><td class="left">'mrduke'</td></tr>
-     <tr><td class="num">  10.3</td><td class="left">'ShadowPhrogg32642342'</td></tr>
-     <tr><td class="num">  10.6</td><td class="left">'Andreas'</td></tr>
-     <tr><td class="num">  11.0</td><td class="left">'joseba'</td></tr>
-     <tr><td class="num">  11.4</td><td class="left">'Chocolate Zero'</td></tr>
-     <tr><td class="num">  11.6</td><td class="left">'Daniel'</td></tr>
-     <tr><td class="num">  11.8</td><td class="left">'ryujun'</td></tr>
-     <tr><td class="num">  12.2</td><td class="left">'Sim_Ed'</td></tr>
-     <tr><td class="num">  12.7</td><td class="left">'Agnieszka'</td></tr>
-     <tr><td class="num">  13.6</td><td class="left">'Mark P.'</td></tr>
-     <tr><td class="num">  17.3</td><td class="left">'Alex'</td></tr>
-     <tr><td class="num">  17.6</td><td class="left">'shoki'</td></tr>
-     <tr><td class="num">  18.0</td><td class="left">'ABS'</td></tr>
-     <tr><td class="num">  20.1</td><td class="left">'Klaus'</td></tr>
-     <tr><td class="num">  20.5</td><td class="left">'Marc-Hendrik'</td></tr>
-     <tr><td class="num">  20.7</td><td class="left">'Chris'</td></tr>
-     <tr><td class="num">  21.4</td><td class="left">'Bent'</td></tr>
-     <tr><td class="num">  21.5</td><td class="left">'U-Punkt'</td></tr>
-     <tr><td class="num">  21.5</td><td class="left">'Thomas'</td></tr>
-     <tr><td class="num">  22.5</td><td class="left">'hdwow'</td></tr>
-     <tr><td class="num">  23.0</td><td class="left">'Gottseinsohn'</td></tr>
-     <tr><td class="num">  24.9</td><td class="left">'Ale'</td></tr>
-     <tr><td class="num">  25.3</td><td class="left">'J3FF'</td></tr>
-     <tr><td class="num">  27.5</td><td class="left">'Tiza'</td></tr>
-     <tr><td class="num">  27.7</td><td class="left">'redsantz'</td></tr>
-     <tr><td class="num">  28.1</td><td class="left">'biotopa'</td></tr>
-     <tr><td class="num">  29.3</td><td class="left">'IChrisI'</td></tr>
-     <tr><td class="num">  29.7</td><td class="left">'NorthForty'</td></tr>
-     <tr><td class="num">  29.9</td><td class="left">'erich'</td></tr>
-     <tr><td class="num">  29.9</td><td class="left">'Melanie'</td></tr>
-     <tr><td class="num">  30.2</td><td class="left">'Davacardo'</td></tr>
-     <tr><td class="num">  32.7</td><td class="left">'Edgar_Flesk'</td></tr>
-     <tr><td class="num">  33.1</td><td class="left">'niebie'</td></tr>
-     <tr><td class="num">  35.3</td><td class="left">'Rugby4ever'</td></tr>
-     <tr><td class="num">  36.9</td><td class="left">'WP319'</td></tr>
-     <tr><td class="num">  37.0</td><td class="left">'Drotten'</td></tr>
-     <tr><td class="num">  37.5</td><td class="left">'Archcorenth'</td></tr>
-     <tr><td class="num">  39.1</td><td class="left">'Tiger'</td></tr>
-     <tr><td class="num">  40.3</td><td class="left">'Nfol'</td></tr>
-     <tr><td class="num">  40.6</td><td class="left">'Vlad'</td></tr>
-     <tr><td class="num">  40.9</td><td class="left">'Momcat'</td></tr>
-     <tr><td class="num">  42.0</td><td class="left">'Vinksu'</td></tr>
-     <tr><td class="num">  43.4</td><td class="left">'Liam Sheehan'</td></tr>
-     <tr><td class="num">  43.6</td><td class="left">'Tarim'</td></tr>
-     <tr><td class="num">  44.5</td><td class="left">'Breezy'</td></tr>
-     <tr><td class="num">  46.0</td><td class="left">'mhatta'</td></tr>
-     <tr><td class="num">  47.1</td><td class="left">'Zak'</td></tr>
-     <tr><td class="num">  47.9</td><td class="left">'Valkyrie2'</td></tr>
-     <tr><td class="num">  48.2</td><td class="left">'Sandra'</td></tr>
-     <tr><td class="num">  49.6</td><td class="left">'Jeffrey S'</td></tr>
-     <tr><td class="num">  50.7</td><td class="left">'Vaily'</td></tr>
-     <tr><td class="num">  51.7</td><td class="left">'Turbogurk'</td></tr>
-     <tr><td class="num">  52.1</td><td class="left">'Neophilus'</td></tr>
-     <tr><td class="num">  52.2</td><td class="left">'Cyphase'</td></tr>
-     <tr><td class="num">  54.5</td><td class="left">'krazy62'</td></tr>
-     <tr><td class="num">  55.3</td><td class="left">'Adonica'</td></tr>
-     <tr><td class="num">  55.6</td><td class="left">'Uli'</td></tr>
-     <tr><td class="num">  59.9</td><td class="left">'Harry Lim'</td></tr>
-     <tr><td class="num">  60.9</td><td class="left">'Asbel'</td></tr>
-     <tr><td class="num">  62.5</td><td class="left">'Meeve'</td></tr>
+     <tr><td class="num">-132.9</td><td class="left">'Moneymaker'</td></tr>
+     <tr><td class="num"> -84.7</td><td class="left">'Stupid'</td></tr>
+     <tr><td class="num"> -83.5</td><td class="left">'Johannes'</td></tr>
+     <tr><td class="num"> -73.7</td><td class="left">'Great Scott'</td></tr>
+     <tr><td class="num"> -62.7</td><td class="left">'Duffy'</td></tr>
+     <tr><td class="num"> -47.8</td><td class="left">'Django'</td></tr>
+     <tr><td class="num"> -47.7</td><td class="left">'daydreamer'</td></tr>
+     <tr><td class="num"> -35.4</td><td class="left">'Taztunes'</td></tr>
+     <tr><td class="num"> -34.1</td><td class="left">'Safalra'</td></tr>
+     <tr><td class="num"> -28.8</td><td class="left">'bojster'</td></tr>
+     <tr><td class="num"> -28.4</td><td class="left">'ryujun'</td></tr>
+     <tr><td class="num"> -27.3</td><td class="left">'Alexandros'</td></tr>
+     <tr><td class="num"> -20.6</td><td class="left">'Raoul'</td></tr>
+     <tr><td class="num"> -18.4</td><td class="left">'ged'</td></tr>
+     <tr><td class="num"> -17.9</td><td class="left">'Ghatotkacha'</td></tr>
+     <tr><td class="num"> -14.7</td><td class="left">'dpl'</td></tr>
+     <tr><td class="num"> -13.8</td><td class="left">'Ronald'</td></tr>
+     <tr><td class="num"> -13.7</td><td class="left">'Lukas'</td></tr>
+     <tr><td class="num"> -13.1</td><td class="left">'HuB34'</td></tr>
+     <tr><td class="num"> -12.5</td><td class="left">'Ludmian'</td></tr>
+     <tr><td class="num">  -9.2</td><td class="left">'Iceshark7'</td></tr>
+     <tr><td class="num">  -4.8</td><td class="left">'fabian'</td></tr>
+     <tr><td class="num">  -3.1</td><td class="left">'Craven'</td></tr>
+     <tr><td class="num">  -2.8</td><td class="left">'Wuzzy'</td></tr>
+     <tr><td class="num">  -2.7</td><td class="left">'JuSt'</td></tr>
+     <tr><td class="num">   0.2</td><td class="left">'para_doks'</td></tr>
+     <tr><td class="num">   0.2</td><td class="left">'Tobias'</td></tr>
+     <tr><td class="num">   0.9</td><td class="left">'Daniel'</td></tr>
+     <tr><td class="num">   1.1</td><td class="left">'Guglielmo'</td></tr>
+     <tr><td class="num">   3.8</td><td class="left">'Zekobah'</td></tr>
+     <tr><td class="num">   4.4</td><td class="left">'Emmanuel'</td></tr>
+     <tr><td class="num">   8.2</td><td class="left">'mrduke'</td></tr>
+     <tr><td class="num">   9.4</td><td class="left">'ShadowPhrogg32642342'</td></tr>
+     <tr><td class="num">  11.4</td><td class="left">'joseba'</td></tr>
+     <tr><td class="num">  11.4</td><td class="left">'Andreas'</td></tr>
+     <tr><td class="num">  11.9</td><td class="left">'Chocolate Zero'</td></tr>
+     <tr><td class="num">  13.0</td><td class="left">'Sim_Ed'</td></tr>
+     <tr><td class="num">  13.4</td><td class="left">'Agnieszka'</td></tr>
+     <tr><td class="num">  14.1</td><td class="left">'Mark P.'</td></tr>
+     <tr><td class="num">  14.1</td><td class="left">'ABS'</td></tr>
+     <tr><td class="num">  16.5</td><td class="left">'Tiza'</td></tr>
+     <tr><td class="num">  18.2</td><td class="left">'Alex'</td></tr>
+     <tr><td class="num">  18.5</td><td class="left">'shoki'</td></tr>
+     <tr><td class="num">  19.5</td><td class="left">'U-Punkt'</td></tr>
+     <tr><td class="num">  20.9</td><td class="left">'Klaus'</td></tr>
+     <tr><td class="num">  21.1</td><td class="left">'Marc-Hendrik'</td></tr>
+     <tr><td class="num">  21.3</td><td class="left">'Chris'</td></tr>
+     <tr><td class="num">  21.8</td><td class="left">'Bent'</td></tr>
+     <tr><td class="num">  22.1</td><td class="left">'Thomas'</td></tr>
+     <tr><td class="num">  22.9</td><td class="left">'hdwow'</td></tr>
+     <tr><td class="num">  23.9</td><td class="left">'Gottseinsohn'</td></tr>
+     <tr><td class="num">  25.3</td><td class="left">'Ale'</td></tr>
+     <tr><td class="num">  25.9</td><td class="left">'J3FF'</td></tr>
+     <tr><td class="num">  26.0</td><td class="left">'Little_Mole'</td></tr>
+     <tr><td class="num">  26.8</td><td class="left">'hendrik'</td></tr>
+     <tr><td class="num">  27.3</td><td class="left">'biotopa'</td></tr>
+     <tr><td class="num">  28.6</td><td class="left">'redsantz'</td></tr>
+     <tr><td class="num">  29.9</td><td class="left">'IChrisI'</td></tr>
+     <tr><td class="num">  30.0</td><td class="left">'Melanie'</td></tr>
+     <tr><td class="num">  30.5</td><td class="left">'erich'</td></tr>
+     <tr><td class="num">  30.5</td><td class="left">'NorthForty'</td></tr>
+     <tr><td class="num">  30.8</td><td class="left">'Davacardo'</td></tr>
+     <tr><td class="num">  33.2</td><td class="left">'Edgar_Flesk'</td></tr>
+     <tr><td class="num">  33.7</td><td class="left">'niebie'</td></tr>
+     <tr><td class="num">  35.7</td><td class="left">'WP319'</td></tr>
+     <tr><td class="num">  35.9</td><td class="left">'Rugby4ever'</td></tr>
+     <tr><td class="num">  37.5</td><td class="left">'Drotten'</td></tr>
+     <tr><td class="num">  37.9</td><td class="left">'Archcorenth'</td></tr>
+     <tr><td class="num">  39.6</td><td class="left">'Tiger'</td></tr>
+     <tr><td class="num">  40.6</td><td class="left">'Nfol'</td></tr>
+     <tr><td class="num">  40.9</td><td class="left">'Vlad'</td></tr>
+     <tr><td class="num">  41.5</td><td class="left">'Momcat'</td></tr>
+     <tr><td class="num">  42.2</td><td class="left">'Uli'</td></tr>
+     <tr><td class="num">  42.4</td><td class="left">'Vinksu'</td></tr>
+     <tr><td class="num">  43.8</td><td class="left">'Liam Sheehan'</td></tr>
+     <tr><td class="num">  44.2</td><td class="left">'Tarim'</td></tr>
+     <tr><td class="num">  44.9</td><td class="left">'Breezy'</td></tr>
+     <tr><td class="num">  46.3</td><td class="left">'mhatta'</td></tr>
+     <tr><td class="num">  47.7</td><td class="left">'Zak'</td></tr>
+     <tr><td class="num">  48.3</td><td class="left">'Valkyrie2'</td></tr>
+     <tr><td class="num">  48.6</td><td class="left">'Sandra'</td></tr>
+     <tr><td class="num">  50.1</td><td class="left">'Jeffrey S'</td></tr>
+     <tr><td class="num">  51.0</td><td class="left">'Vaily'</td></tr>
+     <tr><td class="num">  52.1</td><td class="left">'Turbogurk'</td></tr>
+     <tr><td class="num">  52.5</td><td class="left">'Neophilus'</td></tr>
+     <tr><td class="num">  52.6</td><td class="left">'Cyphase'</td></tr>
+     <tr><td class="num">  53.7</td><td class="left">'Harry Lim'</td></tr>
+     <tr><td class="num">  54.8</td><td class="left">'krazy62'</td></tr>
+     <tr><td class="num">  55.6</td><td class="left">'Adonica'</td></tr>
+     <tr><td class="num">  61.2</td><td class="left">'Asbel'</td></tr>
+     <tr><td class="num">  62.8</td><td class="left">'Meeve'</td></tr>
+     <tr><td class="num">  65.7</td><td class="left">'ael'</td></tr>
      <tr><td class="num">  66.0</td><td class="left">'Samuel'</td></tr>
-     <tr><td class="num">  66.7</td><td class="left">'Alf'</td></tr>
-     <tr><td class="num">  68.1</td><td class="left">'Magnus and Susi'</td></tr>
-     <tr><td class="num">  68.2</td><td class="left">'Mecki'</td></tr>
-     <tr><td class="num">  69.5</td><td class="left">'xmouse'</td></tr>
-     <tr><td class="num">  71.0</td><td class="left">'Joona'</td></tr>
-     <tr><td class="num">  71.4</td><td class="left">'AQZ'</td></tr>
-     <tr><td class="num">  73.4</td><td class="left">'Dvorhagen'</td></tr>
-     <tr><td class="num">  74.4</td><td class="left">'jojo'</td></tr>
-     <tr><td class="num">  74.5</td><td class="left">'AsuCaga'</td></tr>
-     <tr><td class="num">  84.6</td><td class="left">'Miel56'</td></tr>
-     <tr><td class="num">  89.7</td><td class="left">'The red O'</td></tr>
-     <tr><td class="num">  92.1</td><td class="left">'Michael'</td></tr>
+     <tr><td class="num">  66.9</td><td class="left">'Alf'</td></tr>
+     <tr><td class="num">  68.5</td><td class="left">'Magnus and Susi'</td></tr>
+     <tr><td class="num">  68.8</td><td class="left">'Mecki'</td></tr>
+     <tr><td class="num">  69.6</td><td class="left">'xmouse'</td></tr>
+     <tr><td class="num">  71.2</td><td class="left">'Joona'</td></tr>
+     <tr><td class="num">  71.7</td><td class="left">'AQZ'</td></tr>
+     <tr><td class="num">  73.6</td><td class="left">'Dvorhagen'</td></tr>
+     <tr><td class="num">  74.5</td><td class="left">'jojo'</td></tr>
+     <tr><td class="num">  74.8</td><td class="left">'AsuCaga'</td></tr>
+     <tr><td class="num">  79.2</td><td class="left">'AkRa'</td></tr>
+     <tr><td class="num">  80.0</td><td class="left">'Agares'</td></tr>
+     <tr><td class="num">  84.7</td><td class="left">'Miel56'</td></tr>
+     <tr><td class="num">  89.9</td><td class="left">'The red O'</td></tr>
+     <tr><td class="num">  92.2</td><td class="left">'Michael'</td></tr>
   </table>

Modified: homepage/input/table-rat.html
===================================================================
--- homepage/input/table-rat.html	2007-09-30 22:24:31 UTC (rev 890)
+++ homepage/input/table-rat.html	2007-10-01 20:31:07 UTC (rev 891)
@@ -1,55 +1,61 @@
   <table>
-    <caption>$$Rating_Statistics$$ $$August$$ 2007</caption>
+    <caption>$$Rating_Statistics$$ $$September$$ 2007</caption>
     <colgroup><col width="80"><col width="80"><col width="220"></colgroup>
-    <tr><th>$$count$$</th><th>$$average$$</th><th class="left">$$user$$</th></tr>    <tr><td class="num">1020</td><td class="num"> 4.99</td><td class="left">'ryujun'</td></tr>
+    <tr><th>$$count$$</th><th>$$average$$</th><th class="left">$$user$$</th></tr>    <tr><td class="num">1038</td><td class="num"> 5.02</td><td class="left">'ryujun'</td></tr>
+    <tr><td class="num">1009</td><td class="num"> 4.84</td><td class="left">'Taztunes'</td></tr>
     <tr><td class="num">871</td><td class="num"> 5.09</td><td class="left">'Stupid'</td></tr>
-    <tr><td class="num">834</td><td class="num"> 4.76</td><td class="left">'daydreamer'</td></tr>
+    <tr><td class="num">838</td><td class="num"> 4.77</td><td class="left">'daydreamer'</td></tr>
     <tr><td class="num">653</td><td class="num"> 5.01</td><td class="left">'Duffy'</td></tr>
-    <tr><td class="num">621</td><td class="num"> 4.96</td><td class="left">'Moneymaker'</td></tr>
+    <tr><td class="num">625</td><td class="num"> 4.98</td><td class="left">'Moneymaker'</td></tr>
     <tr><td class="num">599</td><td class="num"> 4.21</td><td class="left">'shoki'</td></tr>
+    <tr><td class="num">505</td><td class="num"> 5.07</td><td class="left">'dpl'</td></tr>
     <tr><td class="num">496</td><td class="num"> 5.27</td><td class="left">'Lukas'</td></tr>
-    <tr><td class="num">482</td><td class="num"> 5.03</td><td class="left">'dpl'</td></tr>
-    <tr><td class="num">435</td><td class="num"> 5.09</td><td class="left">'Johannes'</td></tr>
-    <tr><td class="num">426</td><td class="num"> 4.23</td><td class="left">'Alexandros'</td></tr>
-    <tr><td class="num">413</td><td class="num"> 5.01</td><td class="left">'Ronald'</td></tr>
-    <tr><td class="num">390</td><td class="num"> 4.33</td><td class="left">'ged'</td></tr>
+    <tr><td class="num">437</td><td class="num"> 5.10</td><td class="left">'Johannes'</td></tr>
+    <tr><td class="num">428</td><td class="num"> 4.22</td><td class="left">'Alexandros'</td></tr>
+    <tr><td class="num">416</td><td class="num"> 5.01</td><td class="left">'Ronald'</td></tr>
+    <tr><td class="num">402</td><td class="num"> 4.34</td><td class="left">'ged'</td></tr>
     <tr><td class="num">307</td><td class="num"> 4.01</td><td class="left">'Sim_Ed'</td></tr>
-    <tr><td class="num">275</td><td class="num"> 6.30</td><td class="left">'Taztunes'</td></tr>
-    <tr><td class="num">255</td><td class="num"> 5.06</td><td class="left">'U-Punkt'</td></tr>
+    <tr><td class="num">265</td><td class="num"> 5.09</td><td class="left">'U-Punkt'</td></tr>
     <tr><td class="num">254</td><td class="num"> 4.91</td><td class="left">'JuSt'</td></tr>
     <tr><td class="num">208</td><td class="num"> 6.15</td><td class="left">'Momcat'</td></tr>
-    <tr><td class="num">127</td><td class="num"> 5.64</td><td class="left">'Raoul'</td></tr>
+    <tr><td class="num">129</td><td class="num"> 5.64</td><td class="left">'Raoul'</td></tr>
+    <tr><td class="num">115</td><td class="num"> 5.07</td><td class="left">'WP319'</td></tr>
+    <tr><td class="num"> 99</td><td class="num"> 5.01</td><td class="left">'Tiza'</td></tr>
+    <tr><td class="num"> 96</td><td class="num"> 4.20</td><td class="left">'Safalra'</td></tr>
     <tr><td class="num"> 85</td><td class="num"> 4.76</td><td class="left">'para_doks'</td></tr>
     <tr><td class="num"> 72</td><td class="num"> 5.63</td><td class="left">'Wuzzy'</td></tr>
-    <tr><td class="num"> 55</td><td class="num"> 5.45</td><td class="left">'WP319'</td></tr>
+    <tr><td class="num"> 51</td><td class="num"> 6.39</td><td class="left">'Little_Mole'</td></tr>
     <tr><td class="num"> 43</td><td class="num"> 3.74</td><td class="left">'Iceshark7'</td></tr>
     <tr><td class="num"> 30</td><td class="num"> 4.40</td><td class="left">'Archcorenth'</td></tr>
     <tr><td class="num"> 25</td><td class="num"> 4.88</td><td class="left">'Drotten'</td></tr>
-    <tr><td class="num"> 20</td><td class="num"> 4.90</td><td class="left">'Tiza'</td></tr>
-    <tr><td class="num"> 18</td><td class="num"> 6.28</td><td class="left">'Daniel'</td></tr>
+    <tr><td class="num"> 23</td><td class="num"> 6.00</td><td class="left">'Daniel'</td></tr>
+    <tr><td class="num"> 17</td><td class="num"> 5.76</td><td class="left">'mrduke'</td></tr>
     <tr><td class="num"> 17</td><td class="num"> 5.53</td><td class="left">'Jeffrey S'</td></tr>
     <tr><td class="num"> 16</td><td class="num"> 7.63</td><td class="left">'Ghatotkacha'</td></tr>
     <tr><td class="num"> 13</td><td class="num"> 5.23</td><td class="left">'Samuel'</td></tr>
+    <tr><td class="num"> 11</td><td class="num"> 6.36</td><td class="left">'ShadowPhrogg32642342'</td></tr>
     <tr><td class="num"> 10</td><td class="num"> 7.80</td><td class="left">'hdwow'</td></tr>
-    <tr><td class="num">  9</td><td class="num"> 5.78</td><td class="left">'mrduke'</td></tr>
-    <tr><td class="num">  8</td><td class="num"> 5.63</td><td class="left">'Safalra'</td></tr>
     <tr><td class="num">  8</td><td class="num"> 3.25</td><td class="left">'Vlad'</td></tr>
+    <tr><td class="num">  7</td><td class="num"> 8.71</td><td class="left">'Ale'</td></tr>
     <tr><td class="num">  7</td><td class="num"> 6.29</td><td class="left">'ABS'</td></tr>
-    <tr><td class="num">  6</td><td class="num"> 8.83</td><td class="left">'Ale'</td></tr>
     <tr><td class="num">  5</td><td class="num"> 9.20</td><td class="left">'HuB34'</td></tr>
+    <tr><td class="num">  4</td><td class="num"> 6.75</td><td class="left">'Agares'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 5.75</td><td class="left">'joseba'</td></tr>
     <tr><td class="num">  4</td><td class="num">10.00</td><td class="left">'Mark P.'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 6.25</td><td class="left">'Breezy'</td></tr>
     <tr><td class="num">  4</td><td class="num"> 7.00</td><td class="left">'redsantz'</td></tr>
     <tr><td class="num">  3</td><td class="num"> 0.67</td><td class="left">'Turbogurk'</td></tr>
     <tr><td class="num">  3</td><td class="num"> 7.67</td><td class="left">'Joona'</td></tr>
-    <tr><td class="num">  3</td><td class="num"> 5.33</td><td class="left">'ShadowPhrogg32642342'</td></tr>
     <tr><td class="num">  3</td><td class="num"> 3.00</td><td class="left">'Rugby4ever'</td></tr>
     <tr><td class="num">  3</td><td class="num"> 4.33</td><td class="left">'krazy62'</td></tr>
     <tr><td class="num">  2</td><td class="num"> 6.00</td><td class="left">'Mecki'</td></tr>
     <tr><td class="num">  2</td><td class="num"> 8.00</td><td class="left">'Zekobah'</td></tr>
     <tr><td class="num">  2</td><td class="num"> 0.00</td><td class="left">'mhatta'</td></tr>
+    <tr><td class="num">  1</td><td class="num"> 5.00</td><td class="left">'ael'</td></tr>
+    <tr><td class="num">  1</td><td class="num"> 5.00</td><td class="left">'Uli'</td></tr>
     <tr><td class="num">  1</td><td class="num">10.00</td><td class="left">'Cyphase'</td></tr>
     <tr><td class="num">  1</td><td class="num"> 5.00</td><td class="left">'Harry Lim'</td></tr>
+    <tr><td class="num">  1</td><td class="num"> 3.00</td><td class="left">'AkRa'</td></tr>
+    <tr><td class="num">  1</td><td class="num"> 6.00</td><td class="left">'Emmanuel'</td></tr>
     <tr><td class="num">  1</td><td class="num"> 4.00</td><td class="left">'jojo'</td></tr>
   </table>

Modified: homepage/input/table-solved.html
===================================================================
--- homepage/input/table-solved.html	2007-09-30 22:24:31 UTC (rev 890)
+++ homepage/input/table-solved.html	2007-10-01 20:31:07 UTC (rev 891)
@@ -1,56 +1,60 @@
   <table>
-    <caption>$$Solved_Level_Statistics$$ $$August$$ 2007</caption>
+    <caption>$$Solved_Level_Statistics$$ $$September$$ 2007</caption>
     <colgroup><col width="130"><col width="130"><col width="130"><col width="240"></colgroup>
     <tr><th>$$difficult$$</th><th>$$easy$$</th><th>$$total$$</th><th class="left">$$user$$</th></tr>
-    <tr><td class="num">1040/1045</td><td class="num">189/189</td><td class="num"> 99.59%</td><td class="left">'Taztunes'</td></tr>
-    <tr><td class="num">1024/1045</td><td class="num">176/189</td><td class="num"> 97.24%</td><td class="left">'Moneymaker'</td></tr>
+    <tr><td class="num">1041/1045</td><td class="num">189/189</td><td class="num"> 99.68%</td><td class="left">'Taztunes'</td></tr>
+    <tr><td class="num">1029/1045</td><td class="num">183/189</td><td class="num"> 98.22%</td><td class="left">'Craven'</td></tr>
+    <tr><td class="num">1028/1045</td><td class="num">178/189</td><td class="num"> 97.73%</td><td class="left">'Moneymaker'</td></tr>
+    <tr><td class="num">1019/1045</td><td class="num">184/189</td><td class="num"> 97.49%</td><td class="left">'ryujun'</td></tr>
     <tr><td class="num">1014/1045</td><td class="num">175/189</td><td class="num"> 96.35%</td><td class="left">'Stupid'</td></tr>
-    <tr><td class="num">1001/1045</td><td class="num">177/189</td><td class="num"> 95.46%</td><td class="left">'ryujun'</td></tr>
-    <tr><td class="num"> 989/1045</td><td class="num">173/189</td><td class="num"> 94.17%</td><td class="left">'Ronald'</td></tr>
+    <tr><td class="num"> 999/1045</td><td class="num">177/189</td><td class="num"> 95.30%</td><td class="left">'biotopa'</td></tr>
+    <tr><td class="num"> 992/1045</td><td class="num">173/189</td><td class="num"> 94.41%</td><td class="left">'Ronald'</td></tr>
     <tr><td class="num"> 949/1045</td><td class="num">170/189</td><td class="num"> 90.68%</td><td class="left">'para_doks'</td></tr>
-    <tr><td class="num"> 944/1045</td><td class="num">165/189</td><td class="num"> 89.87%</td><td class="left">'daydreamer'</td></tr>
-    <tr><td class="num"> 934/1045</td><td class="num">144/189</td><td class="num"> 87.36%</td><td class="left">'biotopa'</td></tr>
+    <tr><td class="num"> 951/1045</td><td class="num">165/189</td><td class="num"> 90.44%</td><td class="left">'daydreamer'</td></tr>
     <tr><td class="num"> 933/1045</td><td class="num">125/189</td><td class="num"> 85.74%</td><td class="left">'Alex'</td></tr>
     <tr><td class="num"> 914/1045</td><td class="num">135/189</td><td class="num"> 85.01%</td><td class="left">'JuSt'</td></tr>
     <tr><td class="num"> 863/1045</td><td class="num">161/189</td><td class="num"> 82.98%</td><td class="left">'Tobias'</td></tr>
     <tr><td class="num"> 915/1045</td><td class="num">105/189</td><td class="num"> 82.66%</td><td class="left">'Django'</td></tr>
-    <tr><td class="num"> 883/1045</td><td class="num">133/189</td><td class="num"> 82.33%</td><td class="left">'Johannes'</td></tr>
+    <tr><td class="num"> 886/1045</td><td class="num">134/189</td><td class="num"> 82.66%</td><td class="left">'Johannes'</td></tr>
+    <tr><td class="num"> 874/1045</td><td class="num">103/189</td><td class="num"> 79.17%</td><td class="left">'Melanie'</td></tr>
     <tr><td class="num"> 841/1045</td><td class="num">114/189</td><td class="num"> 77.39%</td><td class="left">'Lukas'</td></tr>
     <tr><td class="num"> 950/1045</td><td class="num">  0/189</td><td class="num"> 76.99%</td><td class="left">'Tarim'</td></tr>
+    <tr><td class="num"> 819/1045</td><td class="num">126/189</td><td class="num"> 76.58%</td><td class="left">'mrduke'</td></tr>
     <tr><td class="num"> 830/1045</td><td class="num">109/189</td><td class="num"> 76.09%</td><td class="left">'shoki'</td></tr>
-    <tr><td class="num"> 859/1045</td><td class="num"> 80/189</td><td class="num"> 76.09%</td><td class="left">'Melanie'</td></tr>
-    <tr><td class="num"> 908/1045</td><td class="num">  1/189</td><td class="num"> 73.66%</td><td class="left">'Ale'</td></tr>
-    <tr><td class="num"> 775/1045</td><td class="num">113/189</td><td class="num"> 71.96%</td><td class="left">'mrduke'</td></tr>
-    <tr><td class="num"> 729/1045</td><td class="num">128/189</td><td class="num"> 69.45%</td><td class="left">'Safalra'</td></tr>
+    <tr><td class="num"> 923/1045</td><td class="num">  1/189</td><td class="num"> 74.88%</td><td class="left">'Ale'</td></tr>
+    <tr><td class="num"> 782/1045</td><td class="num">138/189</td><td class="num"> 74.55%</td><td class="left">'Safalra'</td></tr>
+    <tr><td class="num"> 768/1045</td><td class="num">131/189</td><td class="num"> 72.85%</td><td class="left">'WP319'</td></tr>
     <tr><td class="num"> 762/1045</td><td class="num"> 73/189</td><td class="num"> 67.67%</td><td class="left">'redsantz'</td></tr>
-    <tr><td class="num"> 708/1045</td><td class="num">122/189</td><td class="num"> 67.26%</td><td class="left">'WP319'</td></tr>
     <tr><td class="num"> 734/1045</td><td class="num"> 82/189</td><td class="num"> 66.13%</td><td class="left">'bojster'</td></tr>
     <tr><td class="num"> 782/1045</td><td class="num"> 33/189</td><td class="num"> 66.05%</td><td class="left">'Sim_Ed'</td></tr>
     <tr><td class="num"> 681/1045</td><td class="num"> 78/189</td><td class="num"> 61.51%</td><td class="left">'HuB34'</td></tr>
     <tr><td class="num"> 659/1045</td><td class="num"> 95/189</td><td class="num"> 61.10%</td><td class="left">'Marc-Hendrik'</td></tr>
-    <tr><td class="num"> 629/1045</td><td class="num">109/189</td><td class="num"> 59.81%</td><td class="left">'Raoul'</td></tr>
+    <tr><td class="num"> 671/1045</td><td class="num"> 76/189</td><td class="num"> 60.53%</td><td class="left">'U-Punkt'</td></tr>
+    <tr><td class="num"> 633/1045</td><td class="num">110/189</td><td class="num"> 60.21%</td><td class="left">'Raoul'</td></tr>
     <tr><td class="num"> 643/1045</td><td class="num"> 83/189</td><td class="num"> 58.83%</td><td class="left">'Great Scott'</td></tr>
     <tr><td class="num"> 714/1045</td><td class="num">  0/189</td><td class="num"> 57.86%</td><td class="left">'Gottseinsohn'</td></tr>
-    <tr><td class="num"> 658/1045</td><td class="num"> 50/189</td><td class="num"> 57.37%</td><td class="left">'U-Punkt'</td></tr>
+    <tr><td class="num"> 625/1045</td><td class="num"> 82/189</td><td class="num"> 57.29%</td><td class="left">'dpl'</td></tr>
+    <tr><td class="num"> 627/1045</td><td class="num"> 71/189</td><td class="num"> 56.56%</td><td class="left">'ABS'</td></tr>
     <tr><td class="num"> 636/1045</td><td class="num"> 55/189</td><td class="num"> 56.00%</td><td class="left">'fabian'</td></tr>
-    <tr><td class="num"> 610/1045</td><td class="num"> 81/189</td><td class="num"> 56.00%</td><td class="left">'dpl'</td></tr>
     <tr><td class="num"> 588/1045</td><td class="num"> 93/189</td><td class="num"> 55.19%</td><td class="left">'Ghatotkacha'</td></tr>
     <tr><td class="num"> 634/1045</td><td class="num"> 43/189</td><td class="num"> 54.86%</td><td class="left">'Klaus'</td></tr>
+    <tr><td class="num"> 559/1045</td><td class="num">111/189</td><td class="num"> 54.29%</td><td class="left">'Mark P.'</td></tr>
     <tr><td class="num"> 576/1045</td><td class="num"> 93/189</td><td class="num"> 54.21%</td><td class="left">'Guglielmo'</td></tr>
-    <tr><td class="num"> 556/1045</td><td class="num">111/189</td><td class="num"> 54.05%</td><td class="left">'Mark P.'</td></tr>
-    <tr><td class="num"> 616/1045</td><td class="num"> 46/189</td><td class="num"> 53.65%</td><td class="left">'ABS'</td></tr>
     <tr><td class="num"> 579/1045</td><td class="num"> 56/189</td><td class="num"> 51.46%</td><td class="left">'Breezy'</td></tr>
+    <tr><td class="num"> 550/1045</td><td class="num"> 76/189</td><td class="num"> 50.73%</td><td class="left">'Ludmian'</td></tr>
+    <tr><td class="num"> 525/1045</td><td class="num"> 95/189</td><td class="num"> 50.24%</td><td class="left">'ShadowPhrogg32642342'</td></tr>
     <tr><td class="num"> 589/1045</td><td class="num"> 26/189</td><td class="num"> 49.84%</td><td class="left">'hdwow'</td></tr>
     <tr><td class="num"> 533/1045</td><td class="num"> 82/189</td><td class="num"> 49.84%</td><td class="left">'Wuzzy'</td></tr>
     <tr><td class="num"> 506/1045</td><td class="num">108/189</td><td class="num"> 49.76%</td><td class="left">'Agnieszka'</td></tr>
-    <tr><td class="num"> 501/1045</td><td class="num">106/189</td><td class="num"> 49.19%</td><td class="left">'Alexandros'</td></tr>
-    <tr><td class="num"> 510/1045</td><td class="num"> 93/189</td><td class="num"> 48.87%</td><td class="left">'ShadowPhrogg32642342'</td></tr>
-    <tr><td class="num"> 500/1045</td><td class="num"> 67/189</td><td class="num"> 45.95%</td><td class="left">'Ludmian'</td></tr>
+    <tr><td class="num"> 506/1045</td><td class="num">107/189</td><td class="num"> 49.68%</td><td class="left">'Alexandros'</td></tr>
+    <tr><td class="num"> 613/1045</td><td class="num">  0/189</td><td class="num"> 49.68%</td><td class="left">'Little_Mole'</td></tr>
     <tr><td class="num"> 519/1045</td><td class="num"> 37/189</td><td class="num"> 45.06%</td><td class="left">'Valkyrie2'</td></tr>
     <tr><td class="num"> 516/1045</td><td class="num"> 24/189</td><td class="num"> 43.76%</td><td class="left">'niebie'</td></tr>
-    <tr><td class="num"> 503/1045</td><td class="num"> 12/189</td><td class="num"> 41.73%</td><td class="left">'Duffy'</td></tr>
+    <tr><td class="num"> 504/1045</td><td class="num"> 12/189</td><td class="num"> 41.82%</td><td class="left">'Duffy'</td></tr>
     <tr><td class="num"> 495/1045</td><td class="num">  0/189</td><td class="num"> 40.11%</td><td class="left">'Edgar_Flesk'</td></tr>
-    <tr><td class="num"> 402/1045</td><td class="num"> 37/189</td><td class="num"> 35.58%</td><td class="left">'ged'</td></tr>
+    <tr><td class="num"> 457/1045</td><td class="num"> 19/189</td><td class="num"> 38.57%</td><td class="left">'Daniel'</td></tr>
+    <tr><td class="num"> 415/1045</td><td class="num"> 38/189</td><td class="num"> 36.71%</td><td class="left">'ged'</td></tr>
+    <tr><td class="num"> 391/1045</td><td class="num"> 54/189</td><td class="num"> 36.06%</td><td class="left">'Tiza'</td></tr>
     <tr><td class="num"> 391/1045</td><td class="num"> 36/189</td><td class="num"> 34.60%</td><td class="left">'Iceshark7'</td></tr>
     <tr><td class="num"> 397/1045</td><td class="num"> 24/189</td><td class="num"> 34.12%</td><td class="left">'Chocolate Zero'</td></tr>
     <tr><td class="num"> 376/1045</td><td class="num"> 35/189</td><td class="num"> 33.31%</td><td class="left">'Jeffrey S'</td></tr>
@@ -61,33 +65,34 @@
     <tr><td class="num"> 332/1045</td><td class="num"> 48/189</td><td class="num"> 30.79%</td><td class="left">'Zekobah'</td></tr>
     <tr><td class="num"> 306/1045</td><td class="num"> 71/189</td><td class="num"> 30.55%</td><td class="left">'Davacardo'</td></tr>
     <tr><td class="num"> 370/1045</td><td class="num">  7/189</td><td class="num"> 30.55%</td><td class="left">'IChrisI'</td></tr>
-    <tr><td class="num"> 328/1045</td><td class="num"> 39/189</td><td class="num"> 29.74%</td><td class="left">'Tiza'</td></tr>
-    <tr><td class="num"> 341/1045</td><td class="num"> 18/189</td><td class="num"> 29.09%</td><td class="left">'Daniel'</td></tr>
     <tr><td class="num"> 331/1045</td><td class="num"> 14/189</td><td class="num"> 27.96%</td><td class="left">'Archcorenth'</td></tr>
     <tr><td class="num"> 281/1045</td><td class="num"> 63/189</td><td class="num"> 27.88%</td><td class="left">'erich'</td></tr>
     <tr><td class="num"> 295/1045</td><td class="num"> 29/189</td><td class="num"> 26.26%</td><td class="left">'Tiger'</td></tr>
     <tr><td class="num"> 288/1045</td><td class="num"> 36/189</td><td class="num"> 26.26%</td><td class="left">'Drotten'</td></tr>
+    <tr><td class="num"> 252/1045</td><td class="num"> 63/189</td><td class="num"> 25.53%</td><td class="left">'Emmanuel'</td></tr>
     <tr><td class="num"> 261/1045</td><td class="num"> 53/189</td><td class="num"> 25.45%</td><td class="left">'Andreas'</td></tr>
     <tr><td class="num"> 304/1045</td><td class="num">  4/189</td><td class="num"> 24.96%</td><td class="left">'Vinksu'</td></tr>
     <tr><td class="num"> 276/1045</td><td class="num"> 15/189</td><td class="num"> 23.58%</td><td class="left">'Thomas'</td></tr>
     <tr><td class="num"> 273/1045</td><td class="num"> 15/189</td><td class="num"> 23.34%</td><td class="left">'Nfol'</td></tr>
     <tr><td class="num"> 201/1045</td><td class="num"> 54/189</td><td class="num"> 20.66%</td><td class="left">'mhatta'</td></tr>
     <tr><td class="num"> 210/1045</td><td class="num"> 38/189</td><td class="num"> 20.10%</td><td class="left">'Sandra'</td></tr>
+    <tr><td class="num"> 208/1045</td><td class="num"> 33/189</td><td class="num"> 19.53%</td><td class="left">'Uli'</td></tr>
     <tr><td class="num"> 214/1045</td><td class="num"> 19/189</td><td class="num"> 18.88%</td><td class="left">'Adonica'</td></tr>
     <tr><td class="num"> 206/1045</td><td class="num">  4/189</td><td class="num"> 17.02%</td><td class="left">'krazy62'</td></tr>
     <tr><td class="num"> 181/1045</td><td class="num"> 20/189</td><td class="num"> 16.29%</td><td class="left">'Vaily'</td></tr>
     <tr><td class="num"> 125/1045</td><td class="num"> 55/189</td><td class="num"> 14.59%</td><td class="left">'Vlad'</td></tr>
     <tr><td class="num"> 149/1045</td><td class="num"> 30/189</td><td class="num"> 14.51%</td><td class="left">'Chris'</td></tr>
     <tr><td class="num"> 158/1045</td><td class="num"> 20/189</td><td class="num"> 14.42%</td><td class="left">'Turbogurk'</td></tr>
+    <tr><td class="num"> 155/1045</td><td class="num"> 22/189</td><td class="num"> 14.34%</td><td class="left">'hendrik'</td></tr>
+    <tr><td class="num"> 133/1045</td><td class="num"> 43/189</td><td class="num"> 14.26%</td><td class="left">'Harry Lim'</td></tr>
     <tr><td class="num"> 156/1045</td><td class="num"> 17/189</td><td class="num"> 14.02%</td><td class="left">'Zak'</td></tr>
     <tr><td class="num"> 164/1045</td><td class="num">  0/189</td><td class="num"> 13.29%</td><td class="left">'Bent'</td></tr>
+    <tr><td class="num"> 127/1045</td><td class="num"> 29/189</td><td class="num"> 12.64%</td><td class="left">'ael'</td></tr>
     <tr><td class="num"> 148/1045</td><td class="num">  5/189</td><td class="num"> 12.40%</td><td class="left">'Rugby4ever'</td></tr>
-    <tr><td class="num"> 133/1045</td><td class="num"> 11/189</td><td class="num"> 11.67%</td><td class="left">'Uli'</td></tr>
     <tr><td class="num"> 110/1045</td><td class="num"> 31/189</td><td class="num"> 11.43%</td><td class="left">'Cyphase'</td></tr>
     <tr><td class="num"> 124/1045</td><td class="num"> 15/189</td><td class="num"> 11.26%</td><td class="left">'Magnus and Susi'</td></tr>
     <tr><td class="num"> 113/1045</td><td class="num"> 22/189</td><td class="num"> 10.94%</td><td class="left">'Mecki'</td></tr>
     <tr><td class="num"> 131/1045</td><td class="num">  1/189</td><td class="num"> 10.70%</td><td class="left">'Asbel'</td></tr>
-    <tr><td class="num"> 102/1045</td><td class="num"> 27/189</td><td class="num"> 10.45%</td><td class="left">'Harry Lim'</td></tr>
     <tr><td class="num"> 105/1045</td><td class="num"> 22/189</td><td class="num"> 10.29%</td><td class="left">'Neophilus'</td></tr>
     <tr><td class="num">  88/1045</td><td class="num"> 21/189</td><td class="num">  8.83%</td><td class="left">'joseba'</td></tr>
     <tr><td class="num"> 101/1045</td><td class="num">  0/189</td><td class="num">  8.18%</td><td class="left">'Alf'</td></tr>
@@ -98,7 +103,9 @@
     <tr><td class="num">  58/1045</td><td class="num"> 19/189</td><td class="num">  6.24%</td><td class="left">'xmouse'</td></tr>
     <tr><td class="num">  67/1045</td><td class="num">  7/189</td><td class="num">  6.00%</td><td class="left">'Joona'</td></tr>
     <tr><td class="num">  54/1045</td><td class="num"> 12/189</td><td class="num">  5.35%</td><td class="left">'Samuel'</td></tr>
+    <tr><td class="num">  44/1045</td><td class="num"> 16/189</td><td class="num">  4.86%</td><td class="left">'Agares'</td></tr>
     <tr><td class="num">  39/1045</td><td class="num"> 14/189</td><td class="num">  4.29%</td><td class="left">'jojo'</td></tr>
+    <tr><td class="num">  50/1045</td><td class="num">  1/189</td><td class="num">  4.13%</td><td class="left">'AkRa'</td></tr>
     <tr><td class="num">  27/1045</td><td class="num">  5/189</td><td class="num">  2.59%</td><td class="left">'Miel56'</td></tr>
     <tr><td class="num">  23/1045</td><td class="num">  5/189</td><td class="num">  2.27%</td><td class="left">'The red O'</td></tr>
     <tr><td class="num">   7/1045</td><td class="num"> 12/189</td><td class="num">  1.54%</td><td class="left">'Michael'</td></tr>

Modified: homepage/input/table-wr.html
===================================================================
--- homepage/input/table-wr.html	2007-09-30 22:24:31 UTC (rev 890)
+++ homepage/input/table-wr.html	2007-10-01 20:31:07 UTC (rev 891)
@@ -1,47 +1,48 @@
   <table>
-    <caption>$$Worldrecord_Statistics$$ $$August$$ 2007</caption>
+    <caption>$$Worldrecord_Statistics$$ $$September$$ 2007</caption>
     <colgroup><col width="80"><col width="80"><col width="470"></colgroup>
     <tr><th>$$total$$</th><th>$$shared$$</th><th class="left">$$user$$</th></tr>
-    <tr><td class="num">786</td><td class="num">238</td><td class="left">'Moneymaker'</td></tr>
-    <tr><td class="num">253</td><td class="num">119</td><td class="left">'Stupid'</td></tr>
-    <tr><td class="num">175</td><td class="num">134</td><td class="left">'Johannes'</td></tr>
-    <tr><td class="num">100</td><td class="num"> 52</td><td class="left">'Duffy'</td></tr>
-    <tr><td class="num"> 84</td><td class="num"> 64</td><td class="left">'Great Scott'</td></tr>
-    <tr><td class="num"> 58</td><td class="num"> 46</td><td class="left">'daydreamer'</td></tr>
-    <tr><td class="num"> 57</td><td class="num"> 46</td><td class="left">'Django'</td></tr>
-    <tr><td class="num"> 40</td><td class="num"> 32</td><td class="left">'Iceshark7'</td></tr>
-    <tr><td class="num"> 38</td><td class="num"> 10</td><td class="left">'Ronald'</td></tr>
-    <tr><td class="num"> 31</td><td class="num"> 25</td><td class="left">'Ghatotkacha'</td></tr>
+    <tr><td class="num">838</td><td class="num">248</td><td class="left">'Moneymaker'</td></tr>
+    <tr><td class="num">246</td><td class="num">120</td><td class="left">'Stupid'</td></tr>
+    <tr><td class="num">167</td><td class="num">134</td><td class="left">'Johannes'</td></tr>
+    <tr><td class="num"> 94</td><td class="num"> 51</td><td class="left">'Duffy'</td></tr>
+    <tr><td class="num"> 78</td><td class="num"> 62</td><td class="left">'Great Scott'</td></tr>
+    <tr><td class="num"> 54</td><td class="num"> 45</td><td class="left">'daydreamer'</td></tr>
+    <tr><td class="num"> 45</td><td class="num"> 39</td><td class="left">'Django'</td></tr>
+    <tr><td class="num"> 40</td><td class="num"> 33</td><td class="left">'Iceshark7'</td></tr>
+    <tr><td class="num"> 30</td><td class="num"> 25</td><td class="left">'Ghatotkacha'</td></tr>
+    <tr><td class="num"> 27</td><td class="num">  9</td><td class="left">'Ronald'</td></tr>
     <tr><td class="num"> 23</td><td class="num"> 14</td><td class="left">'Zekobah'</td></tr>
-    <tr><td class="num"> 20</td><td class="num"> 16</td><td class="left">'ged'</td></tr>
+    <tr><td class="num"> 21</td><td class="num"> 18</td><td class="left">'Safalra'</td></tr>
     <tr><td class="num"> 20</td><td class="num"> 18</td><td class="left">'bojster'</td></tr>
-    <tr><td class="num"> 19</td><td class="num"> 11</td><td class="left">'Alexandros'</td></tr>
-    <tr><td class="num"> 19</td><td class="num"> 13</td><td class="left">'HuB34'</td></tr>
+    <tr><td class="num"> 19</td><td class="num">  3</td><td class="left">'ryujun'</td></tr>
+    <tr><td class="num"> 19</td><td class="num"> 17</td><td class="left">'ged'</td></tr>
+    <tr><td class="num"> 18</td><td class="num"> 12</td><td class="left">'HuB34'</td></tr>
+    <tr><td class="num"> 17</td><td class="num"> 12</td><td class="left">'Alexandros'</td></tr>
     <tr><td class="num"> 17</td><td class="num"> 16</td><td class="left">'joseba'</td></tr>
-    <tr><td class="num"> 16</td><td class="num"> 14</td><td class="left">'Safalra'</td></tr>
     <tr><td class="num"> 15</td><td class="num">  9</td><td class="left">'Chocolate Zero'</td></tr>
-    <tr><td class="num"> 13</td><td class="num">  3</td><td class="left">'Taztunes'</td></tr>
-    <tr><td class="num"> 11</td><td class="num">  6</td><td class="left">'Lukas'</td></tr>
+    <tr><td class="num"> 11</td><td class="num">  9</td><td class="left">'Ludmian'</td></tr>
     <tr><td class="num"> 10</td><td class="num">  5</td><td class="left">'ShadowPhrogg32642342'</td></tr>
-    <tr><td class="num"> 10</td><td class="num">  9</td><td class="left">'fabian'</td></tr>
-    <tr><td class="num">  9</td><td class="num">  3</td><td class="left">'Breezy'</td></tr>
-    <tr><td class="num">  9</td><td class="num">  5</td><td class="left">'Ludmian'</td></tr>
-    <tr><td class="num">  9</td><td class="num">  7</td><td class="left">'Wuzzy'</td></tr>
-    <tr><td class="num">  8</td><td class="num">  4</td><td class="left">'Raoul'</td></tr>
-    <tr><td class="num">  8</td><td class="num">  6</td><td class="left">'Tobias'</td></tr>
-    <tr><td class="num">  7</td><td class="num">  6</td><td class="left">'dpl'</td></tr>
+    <tr><td class="num"> 10</td><td class="num">  7</td><td class="left">'dpl'</td></tr>
+    <tr><td class="num"> 10</td><td class="num"> 10</td><td class="left">'fabian'</td></tr>
+    <tr><td class="num">  8</td><td class="num">  3</td><td class="left">'Taztunes'</td></tr>
+    <tr><td class="num">  8</td><td class="num">  5</td><td class="left">'Lukas'</td></tr>
+    <tr><td class="num">  8</td><td class="num">  7</td><td class="left">'Wuzzy'</td></tr>
+    <tr><td class="num">  7</td><td class="num">  3</td><td class="left">'Breezy' + 'Craven'</td></tr>
     <tr><td class="num">  6</td><td class="num">  2</td><td class="left">'Bent'</td></tr>
     <tr><td class="num">  6</td><td class="num">  3</td><td class="left">'para_doks'</td></tr>
+    <tr><td class="num">  6</td><td class="num">  4</td><td class="left">'Raoul'</td></tr>
     <tr><td class="num">  6</td><td class="num">  5</td><td class="left">'Guglielmo'</td></tr>
+    <tr><td class="num">  6</td><td class="num">  6</td><td class="left">'Tobias'</td></tr>
     <tr><td class="num">  5</td><td class="num">  5</td><td class="left">'Cyphase' + 'Thomas' + 'Chris' + 'Ralf'</td></tr>
-    <tr><td class="num">  4</td><td class="num">  0</td><td class="left">'Daniel'</td></tr>
     <tr><td class="num">  4</td><td class="num">  4</td><td class="left">'J3FF'</td></tr>
+    <tr><td class="num">  3</td><td class="num">  0</td><td class="left">'Daniel'</td></tr>
     <tr><td class="num">  3</td><td class="num">  2</td><td class="left">'Stephanie'</td></tr>
     <tr><td class="num">  3</td><td class="num">  3</td><td class="left">'Neophilus' + 'ABS'</td></tr>
     <tr><td class="num">  2</td><td class="num">  0</td><td class="left">'Ale'</td></tr>
-    <tr><td class="num">  2</td><td class="num">  1</td><td class="left">'mrduke' + 'Drotten' + 'Edgar_Flesk' + 'Vlad' + 'JuSt'</td></tr>
-    <tr><td class="num">  2</td><td class="num">  2</td><td class="left">'Sim_Ed' + 'Ingo'</td></tr>
-    <tr><td class="num">  1</td><td class="num">  0</td><td class="left">'biotopa' + 'Turbogurk' + 'U-Punkt' + 'Alex' + 'NorthForty' + 'shoki' + 'krazy62' + 'Ant' + 'Melanie' + 'IChrisI' + 'Markus' + 'Nat' + 'Tarim'</td></tr>
-    <tr><td class="num">  1</td><td class="num">  1</td><td class="left">'Zak' + 'niebie' + 'Andreas' + 'Samuel' + 'Mark P.' + 'hdwow' + 'Asbel' + 'Vaily' + 'Meeve'</td></tr>
-    <tr><td class="num">  0</td><td class="num">  0</td><td class="left">'AQZ' + 'Miel56' + 'Alf' + 'Gottseinsohn' + 'Mecki' + 'Tiger' + 'Davacardo' + 'Tiza' + 'Adonica' + 'Joona' + 'Sandra' + 'Magnus and Susi' + 'WP319' + 'xmouse' + 'erich' + 'Vinksu' + 'Uli' + 'Harry Lim' + 'Momcat' + 'The red O' + 'Jeffrey S' + 'Nfol' + 'Marc-Hendrik' + 'jojo' + 'ryujun' + 'Klaus' + 'Valkyrie2' + 'AsuCaga' + 'Rugby4ever' + 'Archcorenth' + 'mhatta' + 'Dvorhagen' + 'Holger' + 'Ingo_K' + 'redsantz' + 'Liam Sheehan' + 'Michael' + 'Agnieszka'</td></tr>
+    <tr><td class="num">  2</td><td class="num">  1</td><td class="left">'mrduke' + 'Edgar_Flesk' + 'Vlad' + 'JuSt'</td></tr>
+    <tr><td class="num">  2</td><td class="num">  2</td><td class="left">'Drotten' + 'Sim_Ed' + 'Ingo'</td></tr>
+    <tr><td class="num">  1</td><td class="num">  0</td><td class="left">'biotopa' + 'U-Punkt' + 'Alex' + 'shoki' + 'krazy62' + 'Ant' + 'Melanie' + 'IChrisI' + 'Markus' + 'Nat'</td></tr>
+    <tr><td class="num">  1</td><td class="num">  1</td><td class="left">'Agares' + 'Zak' + 'Tiza' + 'niebie' + 'Andreas' + 'Samuel' + 'Mark P.' + 'hdwow' + 'Asbel' + 'hendrik' + 'Vaily' + 'Meeve'</td></tr>
+    <tr><td class="num">  0</td><td class="num">  0</td><td class="left">'AQZ' + 'Miel56' + 'Alf' + 'Turbogurk' + 'Gottseinsohn' + 'Mecki' + 'ael' + 'Tiger' + 'Davacardo' + 'Adonica' + 'Joona' + 'Sandra' + 'Magnus and Susi' + 'WP319' + 'xmouse' + 'erich' + 'Vinksu' + 'Uli' + 'Little_Mole' + 'Harry Lim' + 'AkRa' + 'Momcat' + 'NorthForty' + 'Emmanuel' + 'The red O' + 'Jeffrey S' + 'Nfol' + 'Marc-Hendrik' + 'jojo' + 'Klaus' + 'Valkyrie2' + 'AsuCaga' + 'Rugby4ever' + 'Archcorenth' + 'mhatta' + 'Dvorhagen' + 'Holger' + 'Ingo_K' + 'redsantz' + 'Liam Sheehan' + 'Michael' + 'Tarim' + 'Agnieszka'</td></tr>
   </table>

Modified: homepage/input/userlist.html
===================================================================
--- homepage/input/userlist.html	2007-09-30 22:24:31 UTC (rev 890)
+++ homepage/input/userlist.html	2007-10-01 20:31:07 UTC (rev 891)
@@ -3,7 +3,10 @@
   <ul>
     <li>ABS</li>
     <li>Adonica</li>
+    <li>ael</li>
+    <li>Agares</li>
     <li>Agnieszka</li>
+    <li>AkRa</li>
     <li>Ale</li>
     <li>Alex</li>
     <li>Alexandros</li>
@@ -20,6 +23,7 @@
     <li>Breezy</li>
     <li>Chocolate Zero</li>
     <li>Chris</li>
+    <li>Craven</li>
     <li>Cyphase</li>
     <li>Daniel</li>
     <li>Davacardo</li>
@@ -30,6 +34,7 @@
     <li>Duffy</li>
     <li>Dvorhagen</li>
     <li>Edgar_Flesk</li>
+    <li>Emmanuel</li>
     <li>erich</li>
     <li>fabian</li>
     <li>ged</li>
@@ -39,6 +44,7 @@
     <li>Guglielmo</li>
     <li>Harry Lim</li>
     <li>hdwow</li>
+    <li>hendrik</li>
     <li>Holger</li>
     <li>HuB34</li>
     <li>Iceshark7</li>
@@ -55,6 +61,7 @@
     <li>Klaus</li>
     <li>krazy62</li>
     <li>Liam Sheehan</li>
+    <li>Little_Mole</li>
     <li>Ludmian</li>
     <li>Lukas</li>
     <li>Magnus and Susi</li>



From andreasl at mail.berlios.de  Tue Oct  2 00:59:30 2007
From: andreasl at mail.berlios.de (andreasl at BerliOS)
Date: Tue, 2 Oct 2007 00:59:30 +0200
Subject: [Enigma-game-svn] r892 - in homepage: images/lotm input input/lotm
Message-ID: <200710012259.l91MxUoT011845@sheep.berlios.de>

Author: andreasl
Date: 2007-10-02 00:58:49 +0200 (Tue, 02 Oct 2007)
New Revision: 892

Added:
   homepage/images/lotm/lotm_200710.png
   homepage/images/lotm/lotm_200710_a.png
   homepage/images/lotm/lotm_200710_b.png
   homepage/images/lotm/lotm_200710_c.png
   homepage/images/lotm/lotm_200710_d.png
   homepage/images/lotm/lotm_200710_e.png
   homepage/images/lotm/lotm_200710_f.png
   homepage/images/lotm/lotm_200710_g.png
   homepage/images/lotm/lotm_200710_i.png
   homepage/images/lotm/lotm_200710_j.png
   homepage/input/lotm/lotm_200710_de.html
Modified:
   homepage/input/lotm/lotm_200710.html
   homepage/input/lotm/lotm_archive_data.lua
   homepage/input/navbar.html
   homepage/input/navbar_de.html
   homepage/input/navbar_ru.html
Log:
Homepage:
 - LotM 10/07 (English and German)
 - Temporary removal of the Spanish translation button
 - Corrections in LotM archive page
Todo:
 - Russian and Spanish translations of LotM 10/07
 - English and German proofread


Added: homepage/images/lotm/lotm_200710.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: homepage/images/lotm/lotm_200710_a.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710_a.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: homepage/images/lotm/lotm_200710_b.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710_b.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: homepage/images/lotm/lotm_200710_c.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710_c.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: homepage/images/lotm/lotm_200710_d.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710_d.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: homepage/images/lotm/lotm_200710_e.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710_e.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: homepage/images/lotm/lotm_200710_f.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710_f.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: homepage/images/lotm/lotm_200710_g.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710_g.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: homepage/images/lotm/lotm_200710_i.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710_i.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: homepage/images/lotm/lotm_200710_j.png
===================================================================
(Binary files differ)


Property changes on: homepage/images/lotm/lotm_200710_j.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: homepage/input/lotm/lotm_200710.html
===================================================================
--- homepage/input/lotm/lotm_200710.html	2007-10-01 20:31:07 UTC (rev 891)
+++ homepage/input/lotm/lotm_200710.html	2007-10-01 22:58:49 UTC (rev 892)
@@ -1,58 +1,636 @@
 <div class="lotm">
 $$lotm_header$$
 
-  <h3 class="lotm">
-    <span class="date">October 2007: </span>
-    &quot;Quadropolis&quot;, Community Efforts Level I
-  </h3>
+<h3 class="lotm">
+<span class="date">October 2007: </span>
+&quot;Quadropolis&quot;, Combined Effort Level I
+</h3>
 
-  <h4>
-    by Johannes Laire, Jacob Scott, Raoul Bourquin and Andreas Lochmann
-  </h4>
-  
-  <p>I</p>
+<h4>
+by Johannes Laire, Jacob Scott, Raoul Bourquin and Andreas Lochmann
+</h4>
 
-  <div class="lotmpic">
-    <img src="$$imagedir$$/lotm/lotm_200710_a.png" alt="Level of the month" border="0">
-    <div class="imagetitle">Enigma VI # 79</div>
-  </div>
+<p>In October our monthly LotM-Excursion to excellent sights of Enigma takes us
+to Quadropolis. Even the sound of the name removes us many centuries back in
+time to mystic ages, back to the birthplace of modern civilization, to ancient
+Greece. Inevitably old epics enter our minds like 'The Iliad' or 'The Odyssey',
+and old heroes like Heracles, Achilles, Odysseus and Perseus, to name just FOUR.
+And of cource the Ancient Gods and their Enigmatic place of residence, the one
+exceedingly excellent and devine level of the ancient world, the Olymp.</p>
 
-  <table cellpadding="0" cellspacing="1" class="statistics">
-    <caption class="normalcaption">Some records of August 2007</caption>
-    <colgroup>
-       <col width="80">
-       <col width="160">
-    </colgroup>
-    <tr><td class="num">12:05</td>
-        <td class="left">Duffy</td></tr>
-    <tr><td class="num">15:45</td>
-        <td class="left">Lukas</td></tr>
-    <tr><td class="num">16:56</td>
-        <td class="left">Ronald</td></tr>
-    <tr><td class="num">28:13</td>
-        <td class="left">Taztunes</td></tr>
-    <tr><td class="num">39:04</td>
-        <td class="left">shoki</td></tr>  
-  </table>
-  
-  <p>A</p>
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_a.png" alt="Level of the month" border="0">
+<div class="imagetitle">Enigma VI # 79 - Quadropolis<br>The Entrance - Locked!</div>
+</div>
 
-  <h4>&quot;I&quot;</h4>
+<h4>But first: Some basic facts and statistics</h4>
 
-  <p>U</p>
+<p>Quadropolis overcame the neccessary 5 votes minimum in August and entered with
+a rating of 9.40 at position 1. This is the highest rating ever for a level to
+become LotM.</p>
 
-  <div class="lotmpic">
-    <img src="$$imagedir$$/lotm/lotm_200710_b.png" alt="Level of the month" border="0">
-    <div class="imagetitle">L</div>
-  </div>
-  
-  <p>O</p>
+<p>The two former race leaders and Level-of-the-Year favorites &quot;Island Labyrinth&quot;
+and &quot;The Aztec Temple&quot; changed positions. At least for this month they gave off
+their LotY-chances and slid into the field of chasers. &quot;Island Labyrinth&quot;
+establishes itself with 9.24 points and 8 votes just before &quot;The Aztec Temple&quot;,
+former month's race leader, which accounts 9.13 points and 7 votes. On
+positions 4 and 5, &quot;Labyrinth of Puzzles&quot; (8.92/13) and &quot;Houdini&quot; (8.86/6)
+exchanged their positions. The positions 6 to 8 slightly lost ground. As
+always, you can find more details on the <a href="$$lotm$$">LotM archive
+page</a>.</p>
 
-  <div class="quote">
-  I</div>
-  <div class="author">M</div>
+<table cellpadding="0" cellspacing="1" class="statistics">
+<caption class="normalcaption">Some records of August 2007</caption>
+<colgroup>
+   <col width="80">
+   <col width="160">
+</colgroup>
+<tr><td class="num">12:05</td>
+    <td class="left">Duffy</td></tr>
+<tr><td class="num">15:45</td>
+    <td class="left">Lukas</td></tr>
+<tr><td class="num">16:56</td>
+    <td class="left">Ronald</td></tr>
+<tr><td class="num">28:13</td>
+    <td class="left">Taztunes</td></tr>
+<tr><td class="num">39:04</td>
+    <td class="left">shoki</td></tr>
+</table>
 
-  <p>Greets,<br/>
-  <i>Harry</i></p>
+<p>It seems to become an exciting race for the title of the &quot;Level of the Year&quot;,
+particularly as two more hot candidates wait in secrecy for their chances. I
+don't want to reveal their names, but whoever clicks through each of the levels
+and checks their ratings, will surely find them.</p>
 
+<p>But maybe it turns out completely different! Because you are, who decides about
+the Level of the Month, by your votes, and hence about the Level of the Year!
+So, don't forget to rate the levels you played through.</p>
+
+<h4>The journey to Quadropolis leads us to another world</h4>
+
+<p>A breath of Olympic spirit blows through the halls of the sports arena.
+Considering all the sporting ambitions of the promotors of this event, yet as a
+key-note &quot;fair play&quot; is sensible all over this place. Aside from the
+hippodrome all of the rooms are within the bounds of possibility. In the second
+and in the FOURth room the black marble never is in danger to get in a critical
+condition.</p>
+
+<p>Not so long ago Greek mythology had been theme to several authors and
+resulting from it a whole string of levels or strictly speaking a decade is
+included with level pack vi. Names like Troy, Odyssey, Procrustes, Ariadne come
+up in my mind. And of course Zeus, a work by Raoul Bourquin, in which not much
+surprisingly st-flash is all-important. The sky-blue stone with the yellow
+symbol of a lightning flash will be associated with Raoul's Zeus until the end
+of the Age of Enigma.</p> 
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_f.png" alt="Level of the month" border="0">
+<div class="imagetitle">Got it now: Just moving blocks<br>along the laser path!</div>
 </div>
+
+<p>Most part of these levels have been written by Andreas, well-known to the
+loyal readers as the editor of the LotM-column. As both of them belong to the
+authors of the CEL-project, it is all the more surprising to see Andreas pick up
+the theme of Raoul's Zeus. In an impressing way he demonstrates surprising
+abilities of the flash stone in his room. Andreas will give a detailed
+description of this matter later on. On the other hand Raoul takes up an idea
+from an early work by Andreas, and designs a very special kind of a laser path,
+making use of mirrors, glass-stones and two kinds of push-stones.</p>
+
+<h4>March had been a very fruitful month in favour of Enigma:</h4>
+
+<p>For the first time the homepage was published besides to English in German
+language as well. It appeared in a completely new designed outfit, and had been
+extended with several new menu items, one of these innovations being the 'Level
+of the Month' column, introducing 'Island Labyrinth' by Jacob Scott as the first
+LotM ever. Being one of the FOUR authors of Quadropolis Jacob already signs in
+for the FOURth time to the list of LotM authors, a really impressing record.</p>
+
+<p>Also in March, in the evening of the FOURteenth day, it happened that
+Illmind, admin of the Enigma-Fan-Forum as everybody knows, announced his idea
+for a 'combined effort level' beginning with the following words: &quot;how about we
+make a level with several people..&quot;. Just the quarter of an hour later the first
+author had agreed to participate in the project, and another FOUR hours later
+the first CEL team consisting of FOUR authors was complete.</p>
+
+<p>And surprisingly fast (guess when!) - (right!) - just FOUR days later, all of
+the FOUR authors had finished off their rooms. So they thought. Another period
+followed lasting FOURtytwo days, in which the rooms were thoroughly tested,
+corrected and improved, until finally the 'combined effort level' had been given a
+name: 'Quadropolis'.</p>
+
+<p>FOUR weeks of the FOURth month having passed, this name was suggested by
+Illmind on the secret level project channel at mag.heut.net. None of the FOUR
+authors did raise objections, and after the enigmatic forum oracle had agreed to
+this suggestion, the CEL project was assigned a worthy name. Another FOUR weeks
+later Quadropolis was published with Release 1.01 of Enigma within level pack
+(squareroot of FOUR plus FOUR) as number ((FOUR times FOUR) FOUR times plus
+(FOUR times FOUR) minus one).</p>
+
+<p>This mystical number FOUR will have a formative influence on the article in
+the sequel as well. As luck would have it, besides the FOUR authors also FOUR
+players will talk about their experiences with Quadropolis. Given FOUR times as
+much commentators this time compared to last month, i can leisurely lean back
+from now on and simply listen to their words.</p>
+
+<h4>&quot;My favourite things in Enigma are st-chess and st-puzzle&quot;</h4>
+
+<div class="quote">
+-- the former because I've played chess for many years, and the latter because I
+like all kinds of permutation puzzles. I've had many ideas for levels involving
+these, but for some reason find it hard to just get started; I've made only a
+few levels.
+</div>
+
+<div class="quote">
+When I read illmind's idea about this project, I really liked it because one
+room is big enough to be interesting but not too big so it shouldn't take long
+to design. So I quickly replied that I want to be one of the authors. It then
+turned out that all others were really good and experienced level authors, and
+it motivated me.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_b.png" alt="Level of the month" border="0">
+<div class="imagetitle">Robert Marble is 'The Horse Whisperer'</div>
+</div>
+
+<div class="quote">
+The very first puzzle in my room might seem ordinary, but there's one little
+trick to it: if you make a mistake in the beginning, you can't solve it! Those
+familiar with Rubik's Cube might now that if you take out two pieces, swap them,
+and put them back, the resulting position is not solvable. This fascinates me
+and I was really happy when I realized that the same idea can be used with
+puzzle stones.
+</div>
+
+<div class="quote">
+After that I filled the rest of the room with some
+carefully designed chessoban-like puzzles. One thing I don't like about my room
+is that a bit of dexterity is needed at some places when pushing the chess
+stones, because I wanted it to be a puzzle level. But overall, I'm very happy
+with it.
+</div>
+
+<div class="quote">
+I still haven't solved the whole level, but I've played the
+rooms individually and I enjoyed all of them. Quadropolis is certainly one of my
+favourite levels.
+</div>
+<div class="author">Johannes Laire</div>
+
+<h4>&quot;The CEL was definitely a good experience&quot;</h4> 
+
+<div class="quote">
+&quot;Quadropolis&quot;, the result of the first-ever CEL, was really a
+collaboration between various  organizers and level authors, myself included. 
+Each of us wrote one room containing a starting location, a vortex, and whatever
+fiendish puzzle we had in mind.
+</div>
+
+<div class="quote">
+On the mag-heut.net forum we thoroughly tested each mini-level and eventually
+joined them together in sequence to create a multi-author level with many
+different ideas and diverse challenges.
+</div>
+
+<div class="quote">
+My room became, surprisingly enough given my track record, one of the easier
+rooms in the level: a decently simple pattern room with no way to die or force a
+restart.
+</div>
+
+<div class="quote">
+The CEL was definitely a good experience -- I'd highly recommend it to anyone
+looking to make difficult levels and get feedback on their work. In fact, a new
+CEL has been announced on the mag-heut forum, but is still waiting for more
+level designers....
+</div>
+<div class="author">Jacob Scott</div>
+
+<h4>&quot;It became clear that I had to simplify my room&quot;</h4> 
+
+<div class="quote">
+It all began with a post by Illmind, who came up with the idea to have a level
+built by several authors, each of them building one room on his own, and finally
+these single rooms should be joined together to form one level. This idea was
+well received, and so it happened that 4 authors started building the first
+&quot;Combined Effort Level&quot;.
+</div>
+
+<div class="quote">
+So we did start our work, each of us began to tinker at his own room. I had a
+concept in mind, which i had used before in 'Puzzle Puzzles', but still a bit
+variant. The player shall move a push-stone across the whole level (or just the
+whole room). To succeed doing so he will have to clear the path step by step
+until reaching the final puzzle which has to be solved with aid of this stone.
+So I designed the room making the way to go as long as possible and making use
+of various nasty tricks to force the player to look and plan ahead.
+</div>
+
+<div class="quote">
+When every one of us had finished his room, we started arranging the rooms to a
+linear order. The level resulting from this arrangement of the rooms soon turned
+out to be too difficult. Moreover as a result of this linear arrangement one had
+to replay preceeding rooms as well when experimenting in a room at the end of
+the line.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_e.png" alt="Level of the month" border="0">
+<div class="imagetitle">Find the hammer, build a sword, beat the knight!<br>This one will be no problem!</div>
+</div>
+
+<div class="quote">
+So it became clear that I had to simplify my room. Because this was not possible
+without destroying many of the puzzles, I decided to publish the room as a
+one-screen-level individually. It became 'Industrial Puzzles'. 
+</div>
+
+<div class="quote">
+So a new room had to be done, but for a long time no useful idea occured to me,
+how to build a room, which would go well with the level concept. It had to be an
+alley way and it should not be to difficult. Some day later in the evening I got
+an idea: How about building a laser path! The path should be crossed by the
+laser beam several times and thus being impassable, on the other side the path
+itself should be full of holes and broken.
+</div>
+
+<div class="quote">
+The player should clear the path step by step by pushing wooden boxes into the
+breaks and holes. To go on further across these fixed parts of the path the
+player needs to switch off the laser. But this alone would have been a bit
+boring. So what if the player would be in need of an operating laser to leave
+the room? Could there be something more obvious than a door connected to a laser
+switch? 
+</div>
+
+<div class="quote">
+So finally, the laser beam has to be rearranged, mirror by mirror, to its
+initial state, to let the marble gain entrance to the next exciting room.
+</div>
+<div class="author">Raoul Bourquin</div>
+
+<h4>&quot;I like to present new objects of Enigma in my own levels&quot;</h4>
+
+<div class="quote">
+The main idea for my room emerged way before illmind's call to CEL I. As all so
+often, things develop from quite unexpected ways: In this case, I think it was
+my work on Enigma's reference manual in June '06. As I collected information
+about Enigma's unique gaming objects, I also took a look at st-flash's code. It
+was quite easy. Each time an actor hits it, it would take its velocity, multiply
+with 20 and use this as a force on another marble. This &quot;20&quot; caught my
+attention - why &quot;20&quot;? This factor was hardcoded. In contrast to many
+other factors in the game, which could be changed by attribute or global
+variable, this factor was fixed. Probably to a value which fits to the old Oxyd
+games. But an unchangable factor? Wouldn't it be better for st-flash, when this
+number was an attribute instead?
+</div>
+
+<div class="quote">
+I wrote a bug report on Berlios to not forget about this point, and thought
+about it a little more. st-flash was very seldom used. Was there a possibility
+to make it more interesting to the level authors? Maybe by adding some element
+of surprise to it: Changing the direction of the impulse, for example. Like on
+fl-inverse, or even more contorted? I came up with the idea to apply a matrix
+on the velocity vector of the marble instead of just multiplying it with some
+factor. This matrix would give enough freedom to implement reversions,
+rotations and more convoluted connections. And other stones could benefit from
+such a behaviour as well. So I searched for other stones which use the
+marble's velocity. I finally found st-spitter and the st-actorimpulse-family,
+both seldom used and somewhat uninteresting objects as well. A simple addition
+from which three different objects could benefit - it would be worth the
+trouble. In July '06, Raoul commited the neccessary changes I programmed in the
+month before.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_g.png" alt="Level of the month" border="0">
+<div class="imagetitle">'ELLAS? This machine was made in Greece?!<br>By Jove, where's that English manual!?</div>
+</div>
+
+<div class="quote">
+I like to present new objects of Enigma in my own levels. But for st-flash,
+I didn't get a good enough idea. Just showing off on this feature would not
+suffice to support a whole level on its own. Hence Enigma 1.00 came without an
+example.
+</div>
+
+<div class="quote">
+In March '07, illmind came up with the idea of a Combined Effort Level. When I
+asked in the forum about the items we could use, I already speculated to get a
+chance to demonstrate the new st-flash, and not to worry about the items, but
+about other white marbles my fellow authors could have used. So I didn't tell
+about my idea, to not disrupt their plans. As Jacob and Johannes joint the
+crew, I further assumed that at least their rooms would become hard puzzles,
+some dexterity room would be a compensation, and my speculations became plans.
+</div>
+
+<div class="quote">
+One problem I had to solve was the design. I announced quite early that I
+wanted to try Raoul's new st-bigbluesand-stones. Only after that I realized
+that there is rarely a floor that fits to these stones. I didn't want to use
+white tiles, because Raoul already did so in &quot;Zeus&quot;. I finally remembered a
+tip I gave to Ronald, and simply used wood.
+</div>
+
+<div class="quote">
+I'm very glad to hear that my boring room didn't lower the rating of
+&quot;Quadropolis&quot; too much, and want to congratulate my three fellow authors and
+illmind on this wonderful and unique project! I hope there will be more such
+collaborations in future.
+</div>
+<div class="author">Andreas Lochmann</div>
+
+<p>Now that the FOUR authors have spoken at some length abouth their rooms and
+the Quadropolis project at this point I'd like to throw in some lines.</p>
+
+<h4>First of all a few words to Andreas:</h4> 
+
+<p>Of course I'm aware that you just want to provoke some protest. Well, here
+you are. Let me quote some lines from a Neil Young song: &quot;There's more to
+the picture than meets the eye! Hey hey my my!&quot; At a quick glance one might
+get the impression that your scenery looks boring. But that changes with
+lightning speed by the first touch of the flash stone. Room FOUR proves to be a
+really nerve-racking experience, like Lukas has said before (er!, sorry, will
+say soon), it's quite a test for the player's patience, or in other words it
+really IS a &quot;puzzle&quot;!</p> 
+
+<p>By Jove! How the white marble is speeding if you don't act very cautiously.
+To finally reach the vortex in your room took me more time than to cross the
+previous three rooms altogether. A lengthy challenge, but not a bit boring.
+Sorry, Andreas, I just had to say this.</p>
+
+<h4>A few remarks to Jacob's room:</h4>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_c.png" alt="Level of the month" border="0">
+<div class="imagetitle">Patterns Reloaded? I'd better go and<br>get my 'Advanced Maths' book first!</div>
+</div>
+
+<p>On entering the white tile at the beginning, the vortex at the end of the
+room opens up again. I didn't expect such amicability from the author of such
+nasties as the two &quot;Nightmares&quot; and &quot;Monsters in the Dark&quot;
+(just to name two out of an uncountable number). The first two times when the
+vortex closed, I frustratedly pressed the Escape-key, and chose
+&quot;Restart&quot;. However, Jacob designed his contribution to the joint
+project in a really fair way. Actually, the design of this room reminds me of a
+landscape in water colors, with smooth light tones and airy strokes of the
+brush.</p> 
+
+<h4>This simply is pure Enigma only</h4>
+
+<p>The nice thing about this room as well as the other three is: There is nothing
+hidden, no hollow stones, no chameleons, no invisible triggers, no races
+against the time, and this simply is pure Enigma only. Equally considerable and
+even exceptional I think is the fact, that one needs not a single item
+throughout Quadropolis, and this is, as I think, Enigma in its purest form!</p>
+
+<p>Maybe one should have spread some thief floors in the foyer, to remove the
+burden of the two extra lifes from the marble. This would have avoided a small
+derogation of the game's aesthetics in the third room.</p>
+
+<p>Sorry for the interruption! Now the FOUR players shall do the talking!</p>
+
+<h4>&quot;The first room includes probably the best st-chess-puzzle ever
+made&quot;</h4>
+
+<div class="quote">
+Quadropolis as of the levels I've solved so far is my absolute favourite. The
+very concept to have a level built by several authors is great! The independency
+of all rooms from each other resulting from this concept as well. Each of the
+rooms has its individual design and its own basic idea, the sole common ground
+being the vortices connecting the rooms one to another.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_j.png" alt="Level of the month" border="0">
+<div class="imagetitle">Thieves, even in Quadropolis!<br>Pegasus, my loyal
+quadruped, treat them right!</div>
+</div>
+
+<div class="quote">
+Which means each room on its own would have made a good level. The first room
+includes probably the best st-chess-puzzle ever made. It took me a very long
+time to figure out how to open up all the doors blocking the way to the final
+destination. My favourite part!
+</div>
+
+<div class="quote">
+What follows next is some sort of a relaxing room, none the less quite
+interestingly concepted. The third room seems to be quite complicated at the
+beginning, but after taking some time to think it over turns out to be good
+solvable. It's a pity that you can use items instead of wooden boxes. The nearly
+complete symmetry of the room and the original concept on the other hand make
+pluses.
+</div>
+
+<div class="quote">
+The following room exactly is the opposite of the previous one. At first sight
+it looks a bit boring, but it proves to be a rather nerve-racking challenge -
+especially when the white marble has lost all its extra-lifes! And it's quite a
+demonstration of fascinating possibilities of st-flash!
+</div>
+
+<div class="quote">
+The only point giving rise to criticism: In my opinion the design of the
+oxyd-room is somewhat boring. If there should be another project of this kind
+(which would really please me very much) this part should be elaborated more
+thoroughly.
+</div>
+<div class="author">Lukas Sch&uuml;ller</div>
+
+<h4>&quot;You have to look twice before moving&quot;</h4>
+
+<div class="quote">
+Seeing the first yellow puzzle I had been gobsmacked. Solving puzzles can end
+up in situation where you finally have to exchange just two pieces. A task that
+sometimes proves to be harder than you think it should be. But this tiny puzzle
+introduced a new idea to puzzles. It is up to you adding the last piece to the
+puzzle. Of course you can mess up everything by choosing the false point of time.
+But finally I saw the solution - easier than I initially thought, as the puzzles
+has been permuted less than a dozen times. What an entrance to a level!
+</div>
+
+<div class="quote">
+Each of the following chess puzzles prooved to be another challenge of its own.
+Finally I reached curiously the vortex that would certainly warp me to the next
+challenge.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_d.png" alt="Level of the month" border="0">
+<div class="imagetitle">Hey, Hole in the Ground, open up!<br>It's me, Sundance Marble!</div>
+</div>
+
+<div class="quote">
+What a contrast! A new world with new laws! As easy as it was to figure out the
+idea of this world I started racing the marble through this very special maze.
+Just to notice that you have to look twice before moving.
+</div>
+
+<div class="quote">
+And another world on the next screen. Now a challenging push stone riddle. I 
+just had decided how to move, when I bounced to hard for the metal floor and 
+crashed my marble. Now I had to replay all the puzzles before! I guess a little 
+bit increased friction values on the first and third room would have been a fair 
+move.
+</div>
+
+<div class="quote">
+Finally reaching the fourth room I faced again a totally new task. Controlling
+a marble on a catwalk while dealing with distorted forces. I never experimented
+as carefully as on this screen to understand the directions the marble would
+take. Don't let me crash the marble again! What a relief reaching finally the
+oxyds.
+</div>
+
+<div class="quote">
+Congratulations to all four authors. Definitly everyone did gave his best ideas
+for this project. Even though the level misses a storyboard that glues the rooms
+together in more than a linear fassion the sum of new ideas and puzzles is
+overwhelming. Let us hope that more combined effort level will follow.
+</div>
+<div class="author">Roland</div>
+
+<h4>&quot;THIS's a cool level, it get's a 10!&quot;</h4>
+
+<div class="quote">
+There was no lunch on the first Sunday after the release of Enigma 1.01. I had
+to explore the new levels and right away came across the chess stones. Although
+I can play chess, hence i knew how this pieces should move, if they actually
+would move, I didn't know yet, how to convince them to move. So instead of
+having the chess stones skip through these levels, it was me skipping most of
+them.
+</div>
+
+<div class="quote">
+Some levels went by, until I could handle these skippies. Now I started to work
+on all those skippy-levels and this way came to Quadropolis.
+</div>
+
+<div class="quote">
+First I spent a tremendous amount of time trying to solve the puzzle. I really
+had hard times. Of course I solved it once in a while, but never remembered how.
+Kindly, the puzzle pieces are always in the same place at the beginning, such
+that I eventually learned how to crack it, after many (many many) attempts.
+</div>
+
+<div class="quote">
+It wasn't too difficult for me to get the chess stones in position. But now and
+then I fell through the cracked tiles in the top right area of the room while
+doing some skippy-pushing over there, and had to start all over again. I think
+this point is especially evil.
+</div>
+
+<div class="quote">
+For what reasons ever, I was firmly convinced to reach the oxyds, when I had
+opened all the doors to the tunnel; after all, there had been enough to be done
+in this room.
+</div>
+
+<div class="quote">
+All the more I was astonished to enter a second room, which on first sight held
+no barriers at all .........
+<br>
+.............. except for the fact, that the tunnel closed after two or three
+steps. Pondering, I cruised around the top stone on the colored tiles, and got
+the solution. I think this room is the easiest of all.
+</div>
+
+<div class="quote">
+Of course, there were no oxyds in the next. However, as I like mirror-levels
+anyway, it didn't cause unsolvable problems to me. With some &quot;tools&quot;
+one can get well around the lasers.
+</div>
+
+<div class="quote">
+Room 4. No oxyds. I already knew these energy transmitters, so I navigated the
+white marble to the first strategical point. The door opened. The next energy
+stones still more seemed strange, the white marble crashed, and I prepared to
+play the whole level from the beginning. However, the white marble kindly has
+some lifes, too. At the third kind of energy transmitters, I failed. I
+considered Quadropolis closed.
+</div>
+
+<div class="quote">
+Some weeks later I ventured on Quadropolis again, and promptly had forgotten,
+how to solve the puzzle. My note with the instructions has disappeared, too. I
+learned anew (it didn't take long this time) and reached the fourth room without
+bigger problems. With the help of a sketch of the movements of the energy
+transmitters I was able to open the last door and made it.
+</div>
+
+<div class="quote">
+When the last oxyd stone lighted up, I yelled a loud &quot;yeah&quot;, which
+made my friend ask me: &quot;What's up?&quot; I said: &quot;THIS's a cool level,
+it get's a 10!&quot; If I remember correctly, I gave a 10 only to &quot;Pleasure
+Garden&quot; and &quot;The Passage&quot; as well. And all three are deserving
+it.
+</div>
+<div class="author">Shoki</div>
+
+<h4>&quot;Four very talented composers have put together a concert for all of
+us&quot;</h4>
+
+<div class="quote">
+While they all agreed to write for the same ensemble of musicians, each of them
+has written a piece in a different, contrasting style. The result is a musical
+journey through vastly different sonic landscapes.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_i.png" alt="Level of the month" border="0">
+<div class="imagetitle">Show jumping: The ditch</div>
+</div>
+
+<div class="quote">
+Johannes' room is like a Fugue with its puzzles and chess stones that have to be
+moved every which way. I am grateful that this wonderful collaboration is
+front-loaded in terms of dexterity (unlike some particularly galling levels
+where you've been playing for 20 minutes before you encounter an almost
+impossible task). Like many Enigma levels, there's a crucial 'make or break'
+moment where if you succeed at negotiating the challenge, you stand a pretty
+good chance of completing the level. For me, that 'make or break' moment comes
+when my marble crosses the cracked grass at the top of the  room.  If I can
+manage to move the chess stone without breaking the other cracked floor square,
+I feel I can do anything.
+</div>
+
+<div class="quote">
+Jacob's second room is an Adagio for strings. It's so simple in its elegance.
+Very consonant with open harmony. A really clever idea that always brings a
+smile to my face.
+</div>
+
+<div class="quote">
+Raoul has gone for Modernism.  Lasers and metal over an abyss - I hear a pulsing
+drum propelling the music along. I initially solved it using sunglasses, but
+that is totally not necessary. If you think carefully, you can manage it without
+any extra help.
+</div>
+
+<div class="quote">
+And finally, Andreas has written us a Jazz composition. In his penultimate room,
+he plays with our expectations. Each action has consequences - but the
+consequences change the way a hot Be-bop combo expands the concept of harmony
+over chord changes.
+</div>
+
+<div class="quote">
+I hope these fine composers bring us many more collaborative concerts to come. I
+will be sure to be 'listening'!
+</div>
+<div class="author">Taztunes</div>
+
+<p>
+As the final words of Taztunes still sound, I want to reunite the harmonies of
+the Quadropolis' FOUR authors and FOUR friends and join them in a final and
+concluding choir of joy: &quot;CEL-I was a great event! And the journey to
+Quadropolis really paid off!&quot; There's nothing else for it but to wish, that
+the success of Quadropolis gives new impulses to the second CEL project. </p>
+
+<p>Greets,<br/>
+<i>Harry</i></p>
+
+</div>

Added: homepage/input/lotm/lotm_200710_de.html
===================================================================
--- homepage/input/lotm/lotm_200710_de.html	2007-10-01 20:31:07 UTC (rev 891)
+++ homepage/input/lotm/lotm_200710_de.html	2007-10-01 22:58:49 UTC (rev 892)
@@ -0,0 +1,648 @@
+<div class="lotm">
+$$lotm_header$$
+
+<h3 class="lotm">
+<span class="date">October 2007: </span>
+&quot;Quadropolis&quot;, Combined Effort Level I
+</h3>
+
+<h4>
+by Johannes Laire, Jacob Scott, Raoul Bourquin and Andreas Lochmann
+</h4>
+
+<p>Im Oktober f&uuml;hrt unsere monatliche LdM-Exkursion zu den herausragenden
+Sehensw&uuml;rdigkeiten von Enigma nach Quadropolis. Schon der Klang dieses
+Namens versetzt einen um Jahrtausende zur&uuml;ck in mystische Zeitalter,
+zur&uuml;ck an die Geburtsst&auml;tte der modernen Zivilisation, ins antike
+Griechenland. Man f&uuml;hlt sich unweigerlich an klassische Heldensagen
+erinnert, an Herakles, Achill, Odysseus, Perseus, um nur einige zu nennen. Und
+an die antiken G&ouml;tter und ihre enigmatische Wohnst&auml;tte, den alles
+&uuml;berragenden g&ouml;ttlichen Level, den Olymp.</p>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_a.png" alt="Level of the month" border="0">
+<div class="imagetitle">Enigma VI # 79 - Quadropolis<br>Der Eingang -
+Abgeschlossen!</div>
+</div>
+
+<h4>Doch zun&auml;chst zu den harten Tatsachen: Es folgen die Statistiken</h4>
+
+<p>Quadropolis hat die H&uuml;rde der erforderlichen Mindestanzahl von 5
+abgegebenen Stimmen im August &uuml;bersprungen und ist mit einer Wertung von
+9,40 auf Position 1 eingestiegen. Das ist der h&ouml;chste Einstiegswert eines
+Levels in die LdM Wertung, den wir bisher verzeichnen konnten.</p>
+
+<p>Bei den beiden ehemaligen Spitzenreitern und Top-Favoriten auf den
+Level-des-Jahres-Titel, &quot;Island Labyrinth&quot; und &quot;The Aztec
+Temple&quot;, die zumindest f&uuml;r diesen Monat erst einmal ins Verfolgerfeld
+abgerutscht sind, hat es einen Wechsel gegeben. IL liegt jetzt mit 9,24 Punkten
+bei 8 Stimmen wieder knapp vor TAT, dem Tabellenf&uuml;hrer des letzten Monats,
+der 9,13 Punkte bei 7 abgegebenen Stimmen f&uuml;r sich verzeichnen kann. Auf
+Platz 4 und 5 haben Labyrinth of Puzzles (8,92/13) und Houdini (8,86/6) die
+Pl&auml;tze getauscht. Die Pl&auml;tze 6 bis 8 haben leicht an Boden verloren.
+Details k&ouml;nnen Sie wie immer der <a href="$$lotm$$">LdM-Highscoreliste</a>
+entnehmen.</p>
+
+<table cellpadding="0" cellspacing="1" class="statistics">
+<caption class="normalcaption">Einige Rekorde vom August 2007</caption>
+<colgroup>
+   <col width="80">
+   <col width="160">
+</colgroup>
+<tr><td class="num">12:05</td>
+    <td class="left">Duffy</td></tr>
+<tr><td class="num">15:45</td>
+    <td class="left">Lukas</td></tr>
+<tr><td class="num">16:56</td>
+    <td class="left">Ronald</td></tr>
+<tr><td class="num">28:13</td>
+    <td class="left">Taztunes</td></tr>
+<tr><td class="num">39:04</td>
+    <td class="left">shoki</td></tr>
+</table>
+
+<p>Das sieht nach einem spannenden Rennen um den LdJ Titel aus, zumal noch 2
+hei&szlig;e Kandidaten im Verborgenen auf ihre Chance lauern. Wer das ist, will
+ich hier nicht verraten, aber wer mal die Level Ratings einzeln durchcheckt, der
+kann mit einiger Sicherheit erkennen, um wen es sich handelt.</p>
+
+<p>Aber vielleicht kommt es ja auch ganz anders! Denn Sie sind es, die mit Ihren
+Stimmen &uuml;ber den Level des Monats, sowie auch &uuml;ber den Level des
+Jahres entscheiden! Also vergessen Sie nicht, die Level die Sie durchgespielt
+haben, auch zu bewerten.</p>
+
+<h4>Die Reise nach Quadropolis f&uuml;hrt uns in eine andere Welt</h4>
+
+<p>Etwas von Olympischem Geist weht durch die Hallen dieser Sportst&auml;tte.
+Bei allem sportlichen Ehrgeiz der Veranstalter ist doch der Fair Play Gedanke
+gegen&uuml;ber den Spielern als Leitmotiv erkennbar. Bis auf den
+Springer-Parcours sind die R&auml;ume vom Schwierigkeitsgrad her im gr&uuml;nen
+Bereich. Im zweiten und im VIERten Raum besteht zudem keine Lebensgefahr
+f&uuml;r die schwarze Kugel.</p>
+
+<p>Vor nicht allzu langer Zeit war die griechische Mythologie Thema f&uuml;r
+einige Levelautoren, und eine Reihe von daraus resultierenden Werken,
+genaugenommen eine Dekade, sind Bestandteil von Levelpaket VI. Namen wie Troja,
+Odyssee, Prokrustes, Ariadne tauchen in meiner Erinnerung auf. Und
+nat&uuml;rlich Zeus, ein Werk von Raoul Bourquin, in dem nicht ganz
+&uuml;berraschend st-flash die Hauptrolle spielt. Die Assoziation dieses
+himmelblauen Steines mit dem gelben Blitz darauf wird bis ans Ende des
+Enigmatischen Zeitalters mit Raouls Zeus verbunden bleiben.</p>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_f.png" alt="Level of the month" border="0">
+<div class="imagetitle">Jetzt hab' ich's kapiert: <br>Just moving blocks <br>along the laser path!</div>
+</div>
+
+<p>Einen guten Teil dieser Level hat Andreas verfasst, der den treuen Lesern
+unserer LdM-Kolumne sicherlich kein Unbekannter ist.  Umso &uuml;berraschender
+ist es, da sie beide auch zum Autoren-Team des Quadropolis-Projekts
+geh&ouml;ren, dass Andreas nun das Thema von Raoul aufgreift, und im vierten
+Raum von Quadropolis ebenso &uuml;berraschende F&auml;higkeiten des Blitzsteines
+auf beeindruckende Weise demonstriert. Andreas wird sich dazu noch im weiteren
+Verlauf in aller Ausf&uuml;hrlichkeit &auml;u&szlig;ern. Umgekehrt nimmt Raoul
+ein etwas &auml;lteres Motiv von Andreas auf, und gestaltet mit Spiegeln und
+Schiebesteinen einen &quot;Laserpath&quot; der ganz besonderen Art.</p>
+
+<h4>Der M&auml;rz war ein sehr ergiebiger Monat f&uuml;r Enigma</h4>
+
+<p>Die Homepage erschien zum ersten Mal auch in deutscher Sprache, in neuem
+Design und um einige neue Menuepunkte erweitert. Eine von diesen Neuerungen war
+die Sparte &quot;Level des Monats&quot; mit &quot;Island Labyrinth&quot; von
+Jacob Scott als erstem Titelt&auml;ger. Als einer der Autoren von Quadropolis
+hat sich Jacob nun bereits zum VIERten Mal in die Liste der Titelgewinner
+eingetragen, eine wirklich beachtliche Bilanz.</p>
+
+<p>Es war auch im M&auml;rz, genau genommen am Abend des VIERzehnten, als
+Illmind, bekanntlich Admin des Enigma-Fan-Forums Mag.Heut.Net, seine Idee
+f&uuml;r einen gemeinsam gestalteten Level bekannt gab, beginnend mit den
+Worten: &quot;how about we make a level with several people..&quot;. Bereits
+eine VIERtelstunde sp&auml;ter meldete sich mit Johannes der erste Teilnehmer
+f&uuml;r das Projekt, und weitere VIER Stunden sp&auml;ter war das erste
+CEL-Team mit VIER Autoren vollst&auml;ndig.</p>
+
+<p>Und &uuml;berraschend schnell (Na, raten Sie mal!), n&auml;mlich am Abend des
+VIERten Tages nach Bekanntgabe, hatten alle VIER Autoren ihre Beitr&auml;ge
+fertig. - So dachten Sie zumindest, denn es folgten noch weitere zweiundVIERzig
+Tage des Testens, Beratschlagens und Verbesserns, bis der Level gemeinsamer
+Bem&uuml;hungen zum Abschlu&szlig; noch seinen Namen bekam:
+&quot;Quadropolis&quot;.</p>
+
+<p>Dieser Name resultiert &uuml;brigens aus einem Geistesblitz von Illmind, den
+er VIER Wochen nach Beginn des VIERten Monats nach Ablauf der VIERten
+Doppelstunde nach Mitternacht im Level Project Channel auf Mag.Heut.Net bekannt
+gab. Keiner der VIER Autoren hatte Einw&auml;nde, und nachdem auch das
+r&auml;teslhafte Forums-Orakel seine Zustimmung gegeben hatte, trug das Projekt
+CEL also endlich auch einen w&uuml;rdigen Namen. Weitere VIER Wochen sp&auml;ter
+erschien Quadropolis dann mit Enigma 1.01 in Levelpack (Wurzel VIER plus VIER)
+mit der Nummer (VIER mal VIER mal f&uuml;nf minus eins).</p>
+
+<p>Die VIERzahl pr&auml;gt auch im weiternen Verlauf diesen Artikel, denn Tyche
+hat es so gef&uuml;gt, dass sich au&szlig;er den VIER Autoren auch VIER Spieler
+zu Worte melden werden. Diesmal haben wir VIER mal so viele Kommentatoren wie
+letzten Monat, sodass ich mich also ab jetzt entspannt zur&uuml;cklehnen darf,
+und einfach nur ihren Worten zu lauschen brauche.</p>
+
+<h4>&quot;Meine Lieblingsobjekte in Enigma sind st-chess und
+st-puzzle&quot;</h4>
+
+<div class="quote">
+- das erstere weil ich seit vielen Jahren Schach spiele, und das letztere weil
+ich alle Arten von Permutations-R&auml;tseln liebe. Ich hatte schon jede Menge
+Ideen f&uuml;r Level diese Objekte betreffend, aber irgendwie f&auml;llt es mir
+schwer einen Anfang zu finden, und so habe ich bisher erst ein paar Level
+verfasst.</div>
+
+<div class="quote">
+Als ich Illminds Vorschlag f&uuml;r das Projekt gelesen habe, fand ich sofort
+Gefallen daran. Ein Raum ist gro&szlig; genug, um etwas Interessantes zu
+gestalten, aber nicht zu gro&szlig;, um allzu viel Zeit f&uuml;r die
+Ausarbeitung in Anspruch zu nehmen. Also habe ich rasch geantwortet, dass ich
+einer von den Autoren sein m&ouml;chte. Es ergab sich, dass die anderen alles
+gute und erfahrene Levelautoren waren, und das hat mich noch mal zus&auml;tzlich
+motiviert.</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_b.png" alt="Level of the month" border="0">
+<div class="imagetitle">Robert Murmel ist "Der Pferdefl&uuml;sterer"</div>
+</div>
+
+<div class="quote">Das allererste Puzzle in meinem Raum sieht gew&ouml;hnlich
+aus, aber es gibt einen kleinen Trick an der Sache: Wenn man am Anfang einen
+Fehler begeht, kann man es nicht mehr l&ouml;sen! Diejenigen, die mit Rubik's
+Zauberw&uuml;rfel vertraut sind, wissen vielleicht, dass wenn man zwei
+St&uuml;cke aus dem W&uuml;rfel herausnimmt, und sie miteinander vertauscht
+wieder einsetzt, die daraus resultierende Position nicht l&ouml;sbar ist. Das
+hat mich fasziniert, und ich war wirklich sehr erfreut, als ich festgestellt
+habe, dass man die gleiche Idee auch mit den Puzzlesteinen verwirklichen
+kann.</div>
+
+<div class="quote">Danach habe ich den Raum nach und nach mit einigen
+sorgf&auml;ltig designten Chessoban-artigen Puzzles aufgef&uuml;llt. Das Einzige
+was mir an meinem Raum nicht gef&auml;llt ist die Tatsache, dass man an einigen
+Stellen doch etwas Geschicklichkeit ben&ouml;tigt um die Schachfiguren zu
+bewegen, weil ich eigentlich vorhatte einen puren Puzzle-Level zu entwerfen.
+Aber Alles in Allem bin ich doch sehr zufrieden damit.</div>
+
+<div class="quote">Den Level als Ganzes habe ich bisher immer noch nicht
+gel&ouml;st, aber ich habe alle R&auml;ume einzeln durchgespielt und jeder
+einzelne hat mir Spa&szlig; gemacht. Quadropolis ist mit Sicherheit einer meiner
+Lieblingslevel.</div>
+<div class="author">Johannes Laire</div>
+
+<h4>&quot;CEL war definitiv eine gute Erfahrung&quot;</h4>
+
+<div class="quote">
+&quot;Quadropolis&quot;, das Resultat des allerersten CEL war tats&auml;chlich
+die Zusammenarbeit zwischen verschiedenen Organisatoren und Level Autoren, mich
+selbst eingeschlossen. Jeder von uns schrieb einen Raum, der einen Startpunkt
+und einen Vortex beinhalten musste, sowie irgendeine teuflische Gemeinheit von
+R&auml;tsel, gerade so wie sie uns in den Sinn kam.</div>
+
+<div class="quote">
+Im mag.heut.net Forum wurde jeder dieser Mini-Level von uns ausgiebig getestet
+und schlie&szlig;lich einer nach dem anderen miteinander verbunden, um so einen
+Multi-Autoren-Level zu bilden mit vielen unterschiedlichen Ideen und
+andersartigen Herausforderungen.</div>
+
+<div class="quote">
+Mein Raum stellte sich, ziemlich &uuml;berraschend, als einer der einfacheren in
+diesem Level heraus, gemessen an meinem Streckenrekord: ein nach einem nicht
+allzu komplizierten Muster aufgebauter Raum, in dem es keine M&ouml;glichkeit
+gibt zu sterben oder einen Neustart zu erzwingen.</div>
+
+<div class="quote">
+CEL war definitiv eine gute Erfahrung -- Ich kann es nur nachdr&uuml;cklich
+jedem Autor empfehlen, der plant schwierige Level zu verfassen, und der dabei
+Feedback zu seiner Arbeit bekommen m&ouml;chte. In der Tat ist bereits ein neues
+CEL im mag.heut.net Forum ausgeschrieben worden, und wartet immer noch auf
+weitere Level Designer...</div>
+<div class="author">Jacob Scott</div>
+
+<h4>&quot;Somit war bald klar, dass ich meinen Raum stark vereinfachen
+musste&quot;</h4>
+
+<div class="quote">
+Alles begann mit einem Post von illmind, der mit der Idee aufkam, man
+k&ouml;nnte ein Level bauen, bei dem verschiedene Autoren beteiligt w&auml;ren,
+jeder w&uuml;rde einen Raum bauen, und nachher sollte man diese R&auml;ume zu
+einem Level zusammenf&uuml;gen. Die Idee fand sofort gro&szlig;en Anklang, und
+so kam es, dass 4 Autoren das erste &quot;Combined Effort Level&quot; bauten.
+</div>
+
+<div class="quote">
+So gingen wir dann an die Arbeit, jeder begann an seinem Raum zu basteln. Ich
+hatte ein Konzept, das ich in &quot;Puzzle Puzzles&quot; schon einmal in einer
+anderen Variante verwendet hatte: der Spieler soll einen Stein durch's ganze
+Level (oder eben den ganzen Raum) schieben und dabei den Weg st&uuml;ckchenweise
+frei machen m&uuml;ssen, um mit dem Stein ein finales Puzzle l&ouml;sen zu
+k&ouml;nnen. Also baute ich den Raum, machte den Weg m&ouml;glichst lang und
+verwendete diverse fiese Tricks, um den Spieler zu m&ouml;glichst viel Planung
+und Vorausdenken zu zwingen.</div>
+
+<div class="quote">
+Als dann jeder seinen Raum fertig hatte, und wir begannen, die R&auml;ume in
+eine lineare Anordnung zu bringen, stellte sich schnell heraus, dass das
+resultierende Level viel zu schwer w&uuml;rde. Zumal, bedingt durch seinen
+geradlinigen Aufbau, man immer alle vorderen R&auml;ume durchspielen musste, um
+in den hinteren zu experimentieren.</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_e.png" alt="Level of the month" border="0">
+<div class="imagetitle">Den Hammer finden, ein Schwert machen, <br>den Ritter besiegen. <br>Das sollte kein Problem sein. </div>
+</div>
+
+<div class="quote">
+Somit war bald klar, dass ich meinen Raum stark vereinfachen musste. Da das aber
+kaum m&ouml;glich war, ohne etliche der Puzzels zu zerst&ouml;ren, beschloss
+ich, diesen Raum als ein-raum-level einzeln zu ver&ouml;ffentlichen. Daraus
+wurde das Level &quot;Industrial Puzzles&quot;.</div>
+
+<div class="quote">
+Nun musste aber ein neuer Raum her, doch hatte ich lange Zeit keine
+schl&uuml;ssige Idee, wie ich einen Raum machen k&ouml;nnte, der
+einigerma&szlig;en in das Level passte - es musste ein Durchgangsraum sein - und
+der nicht zu schwer war. Irgendwann, sp&auml;t Abends, kam ich dann auf die
+Idee, einen Pfad zu verlegen, der einerseits von einem Laserstrahl mehrfach
+gekreuzt und somit blockiert wird, andererseits unterbrochen und l&ouml;chrig
+ist.</div>
+
+<div class="quote">
+Der Spieler soll den Weg abschnittweise mit Kisten f&uuml;llen, und um die
+geflickten Wegst&uuml;cke &uuml;berqueren zu k&ouml;nnen, den Laser abschalten.
+Das alleine w&auml;re aber etwas zu langweilig, also schaute ich, dass der
+Spieler den Laser ben&ouml;tigt, um aus dem Raum heraus zu kommen - und was
+liegt n&auml;her als eine T&uuml;r, gekoppelt an einen Laserswitch?</div> 
+
+<div class="quote">
+Schlussendlich muss der Laserstrahl also wieder, Spiegel um Spiegel, auf seinen
+urspr&uuml;nglichen Weg geschickt werden, um die Kugel in den n&auml;chsten,
+spannenden Raum zu entlassen.</div>
+<div class="author">Raoul Bourquin</div>
+
+<h4>&quot;Ich pr&auml;sentiere gerne neue Objekte von Enigma in meinen eigenen
+Levels&quot;</h4>
+
+<div class="quote">
+Der Grundgedanke f&uuml;r meinen Raum entwickelte sich lange for illminds Aufruf
+zum CEL I. Wie so oft, entwickeln sich Dinge auf recht unerwarteten Wegen: In
+diesem Fall denke ich, war es meine Arbeit an Enigmas Referenzhandbuch im Juni
+'06. Als ich Informationen &uuml;ber Enigmas einzigartige Spielobjekte gesammelt
+habe, habe ich auch einen Blick auf st-flash's Programmcode geworfen. Er war
+recht einfach. Jedesmal, wenn ein Actor ihn ber&uuml;hrt, w&uuml;rde er dessen
+Geschwindigkeit messen, mit 20 multiplizieren und das Ergebnis als Kraft auf
+eine andere Murmel anwenden. Diese &quot;20&quot; erregte meine Aufmerksamkeit -
+warum &quot;20&quot;? Dieser Faktor war fest verdrahtet. Im Gegensatz zu vielen
+anderen Faktoren im Spiel, die mittels Attributen oder globalen Variablen
+ver&auml;ndert werden konnten, war dieser Faktor fixiert. Wahrscheinlich auf
+einen Wert, der zu den alten Oxyd-Spielen passte. Aber ein unver&auml;nderbarer
+Faktor? W&auml;re es nicht besser f&uuml;r st-flash, wenn diese Zahl stattdessen
+ein Attribut w&auml;re?</div>
+
+<div class="quote">
+Ich schrieb einen Bugreport auf Berlios um diesen Punkt nicht zu vergessen, und
+dachte noch etwas &uuml;ber die Sache nach. st-flash wurde sehr selten
+verwendet. Gab es eine M&ouml;glichkeit, ihn interessanter f&uuml;r die
+Levelautoren zu machen? Vielleicht durch ein &Uuml;berraschungselement: Man
+k&ouml;nnte die Richtung des Impulses beispielsweise ver&auml;ndern. Wie auf
+fl-inverse, oder sogar noch verdrehter? Ich schlug vor, eine Matrix auf den
+Geschwindigkeitsvektor der Murmel anzuwenden, statt nur mit einem Faktor zu
+multiplizieren. Diese Matrix w&uuml;rde gen&uuml;gend Freiraum geben, um
+Umkehrungen zu implementieren, Rotationen und noch kompliziertere
+Zusammenh&auml;nge. Und andere Steine k&ouml;nnten von diesem Verhalten
+ebenfalls profitieren. Also suchte ich nach weiteren Steinen, die die
+Geschwindigkeit der Murmel verwenden. Ich fand schlie&szlig;lich st-spitter und
+die st-actorimpulse-Familie, beide ebenso recht selten verwendet und ebenso
+irgendwie uninteressante Objekte. Eine einfache Erg&auml;nzung von der drei
+verschiedene Objekte profitieren w&uuml;rden - das war die M&uuml;he wert. Im
+Juli '06  spielte Raoul die notwendigen &Auml;nderungen ein, die ich im Monat
+zuvor programmiert hatte.</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_g.png" alt="Level of the month" border="0">
+<div class="imagetitle">'ELLAS? Diese Maschine ist <br>in Griechenland
+hergestellt?! <br>Beim Zeus, wo ist das <br>deutsche Handbuch!?</div>
+</div>
+
+<div class="quote">
+Ich pr&auml;sentiere gerne neue Objekte von Enigma in meinen eigenen Levels.
+Aber was st-flash anging, hatte ich einfach keine gen&uuml;gend gute Idee.
+Einfach nur dieses Feature anzupreisen h&auml;tte nicht ausgereicht, um einen
+ganzen Level selbst zu tragen. Folglich gab es in Enigma 1.00 auch kein
+Beispiel.</div>
+
+<div class="quote">
+Im M&auml;rz '07 brachte illmind die Idee des Combined Effort Level ins Gespr&auml;ch.
+Als ich im Forum nach den verwendbaren Items gefragt hatte, spekulierte ich
+bereits auf eine Chance, den neuen st-flash zu demonstrieren, und musste
+eigentlich nicht um irgendwelche Items f&uuml;rchten, sondern vielmehr andere wei&szlig;e
+Murmeln, die meine Mitstreiter verwenden k&ouml;nnten. Entsprechend hatte ich auch
+nichts von meiner Idee erz&auml;hlt, um ihre Pl&auml;ne nicht zu st&ouml;ren. Als Jacob und
+Johannes zur Crew stie&szlig;en, konnte ich au&szlig;erdem davon ausgehen, dass zumindest
+deren R&auml;ume harte R&auml;tsel w&uuml;rden, ein Geschicklichkeitsraum w&auml;re ein Ausgleich,
+und aus meinen Spekulationen wurden Pl&auml;ne.</div>
+
+<div class="quote">
+Ein Problem, das ich l&ouml;sen musste, war das Design. Ich k&uuml;ndigte bereits recht
+fr&uuml;h an, dass ich Raouls neue st-bigbluesand-Steine verwenden wollte. Erst
+danach fiel mir auf, dass es kaum B&ouml;den gibt, die zu diesen Steinen passen. Ich
+wollte keinen wei&szlig;en Boden verwenden, weil Raoul das schon in &quot;Zeus&quot; gemacht
+hat. Schlie&szlig;lich erinnerte ich mich an einen Tipp, den ich Ronald gegeben
+hatte, und verwendete Holz.</div>
+
+<div class="quote">
+Es freut mich zu h&ouml;ren, dass mein langweiliger Raum nicht die Bewertung von
+&quot;Quadropolis&quot; zu sehr heruntergezogen hat, und m&ouml;chte meinen drei
+Mitautoren und illmind zu diesem wunderbaren und einzigartigen Projekt
+gratulieren! Ich hoffe, es wird in Zukunft weitere solche Zusammenarbeiten
+geben.</div>
+<div class="author">Andreas Lochmann</div>
+
+<p>Nachdem nun die vier Autoren sich in aller Ausf&uuml;hrlichkeit zu
+Quadropolis und zu ihren R&auml;umen ge&auml;u&szlig;ert haben,  m&ouml;chte Ich
+auch noch einmal kurz das Wort ergreifen.</p>
+
+<h4>Zuerst ein paar Worte an Andreas:</h4>
+
+<p>Nat&uuml;rlich ist mir klar, dass du mit dieser Behauptung nur Widerspruch
+provozieren willst, und den sollst du auch haben! Ich m&ouml;chte mit einem
+Zitat aus einem Song von Neil Young antworten &quot;There's more to the picture
+than meets the eye! Hey hey my my!&quot; Also auf den ersten Blick betrachtet
+sieht es zugebenerma&szlig;en etwas langweilig aus, aber das &auml;ndert sich
+&quot;blitzartig&quot;, wenn man einmal den ersten Flash ber&uuml;hrt hat! Raum
+&quot;Quadro&quot; ist ja wohl wirklich &quot;nervenaufreibend&quot; wie Lukas
+schon bemerkt hat, (&auml;hm, sorry, bald bemerken wird) und eine wahre
+Geduldsprobe!</p> 
+
+<p>Beim Zeus noch mal, wie die wei&szlig;e Murmel abgeht, wenn man aus Versehen
+mal ein bi&szlig;chen zu sehr auf die Pauke haut! Um bis zum (letzten) Vortex zu
+gelangen, habe ich mehr Zeit ben&ouml;tigt, als f&uuml;r die drei anderen
+R&auml;ume zusammen. Wirklich ein Geduldspiel - eine sehr langwierige
+Angelegenheit, aber auf keinen Fall eine langweilige! Sorry f&uuml;r die
+Unterbrechung, Andreas, aber das musste sein.</p>
+
+<h4>Ein paar Anmerkungen zu Jacob's Raum:</h4> 
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_c.png" alt="Level of the month" border="0">
+<div class="imagetitle">Patterns Reloaded?</div>
+</div>
+
+<p>Beim Betreten des wei&szlig;en Startfeldes &ouml;ffnet sich der Vortex am
+Ende des Raumes wieder. Eine solche Freundlichkeit hatte ich vom Autor solcher
+Gemeinheiten wie den beiden &quot;Nightmares&quot; oder &quot;Monsters in the
+Dark&quot; (um nur zwei von unz&auml;hligen zu nennen) nicht erwartet. Die
+ersten beiden Male, als der Vortex sich geschlossen hatte, dr&uuml;ckte ich
+frustriert die Escape-Taste, und w&auml;hlte &quot;Neustart&quot;. Aber seinen
+Raum f&uuml;r das Gemeinschaftsprojekt hat Jacob wirklich fair gestaltet.
+&Uuml;berhaupt erinnert mich das Design dieses Raumes an eine Aquarell
+Landschaft mit sanften hellen Farben und mit leichtem Pinselstrich gemalt.</p>
+
+<h4>Einfach nur Enigma pur</h4>
+
+<p>Das Sch&ouml;ne an diesem Raum, wie auch an den anderen dreien ist: es gibt
+nichts Verstecktes, keine Hohlsteine, keine Cham&auml;leons, keine unsichtbaren
+Trigger, kein Wettrennen gegen die Zeit, das ist einfach nur reines Enigma.
+Ebenso beachtlich wie auch ungew&ouml;nlich finde ich die Tatsache, dass in ganz
+Quadropolis nicht ein einziges Item ben&ouml;tigt wird, auch das ist, so finde
+ich, Enigma pur!</p>
+
+<p>Vielleicht h&auml;tte man im Eingangsbereich noch ein paar Bodenfliesen mit
+Dieb-Motiv verlegen sollen, um so die Murmel um die Last der beiden Extra-Leben
+zu erleichtern, das h&auml;tte eine geringf&uuml;gige Beeintr&auml;chtigung der
+Spiel-&Auml;sthetik vor allem im dritten Raum vermieden.</p>
+
+<p>Sorry f&uuml;r die Unterbrechung! Jetzt haben die VIER Spieler das Wort:</p>
+
+<h4>&quot;Der erste Raum enth&auml;lt wahrscheinlich das beste Springer-Puzzle,
+das bisher gemacht wurde&quot;</h4>
+
+<div class="quote">
+Quadropolis ist (von meinen bisher gel&ouml;sten Levels) mein absolutes
+Lieblingslevel. Schon das allgemeine Konzept, dass ein Level von vielen
+verschiedenen Autoren geschrieben wurde, finde ich klasse! Und die daraus
+resultierende Unabh&auml;ngigkeit aller R&auml;ume. Jeder hat ein individuelles
+Design und eine individuelle Grundidee, die einzige Gemeinsamkeit sind die
+vortexes, die die R&auml;ume miteinander verbinden.</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_j.png" alt="Level of the month" border="0">
+<div class="imagetitle">Diebe, sogar hier in Quadropolis! <br>Pegasus, mein treuer Vierbeiner, <br>zeig' ihnen wo's lang geht!</div>
+</div>
+
+<div class="quote">
+Das bedeutet, dass jeder Raum f&uuml;r sich schon ein gutes Level w&auml;re. Der
+erste Raum enth&auml;lt wahrscheinlich das beste Springer-Puzzle, das bisher
+gemacht wurde. Es dauerte sehr lange, bis ich herausgefunden hatte, wie man den
+Weg zum Ziel &ouml;ffnen kann. Mein Lieblingsteil!</div> 
+
+<div class="quote">
+Darauf folgt ein eher entspannender Raum, der aber trotzdem ein interessantes
+Konzept hat. Der dritte Raum sieht am Anfang &auml;u&szlig;erst kompliziert aus,
+ist jedoch nach einigem Nachdenken auch l&ouml;sbar. Schade ist, dass man Items
+anstatt Holzkisten benutzen kann, die (fast) komplette Symmetrie und das
+orginelle Konzept geben jedoch wieder Pluspunkte.</div> 
+
+<div class="quote">
+Der dafauffolgende Raum ist das komplette Gegenteil; auf den ersten Blick sieht
+er eher langweilig aus, ist jedoch noch eine nervenaufreibende Herausforderung
+(vor allem wenn die wei&szlig;e Kugel kein Extraleben mehr hat) und zeigt tolle
+M&ouml;glichkeiten des st-flashs.</div>
+
+<div class="quote">
+Der einzige Kritikpunkt: Das Design des Oxyd-Raums ist meiner Meinung nach zu
+langweilig; wenn es noch mal ein Projekt dieser Art gibt (was mich sehr freuen
+w&uuml;rde) sollte man sich daf&uuml;r noch etwas einfallen lassen.</div>
+<div class="author">Lukas Sch&uuml;ller</div>
+
+<h4>&quot;Man sollte zweimal hinsehen, bevor man sich bewegt&quot;</h4>
+
+<div class="quote">
+Nach dem Anblick des ersten gelben Puzzles war ich platt. Puzzles zu l&ouml;sen
+kann in Situationen enden, in denen man abschlie&szlig;ende nur noch zwei Teile
+austauschen muss. Diese Aufgabe stellt sich manchmal als h&auml;rter heraus als
+erwartet. Aber dieses kleine Puzzle hat eine neue Idee f&uuml;r Puzzles
+vorgef&uuml;hrt. Es liegt an Ihnen, wann Sie das letzte St&uuml;ck ans Puzzle
+anschlie&szlig;en. Nat&uuml;rlich kann man sich alles verhunzen, wenn man den
+falschen Zeitpunkt daf&uuml;r w&auml;hlt. Aber schlie&szlig;lich sah ich die
+L&ouml;sung - einfacher als ich urspr&uuml;nglich dachte, da die Puzzleteile
+weniger als ein Dutzend Mal permutiert werden mussten. Was f&uuml;r ein Einstieg
+in einen Level!</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_d.png" alt="Level of the month" border="0">
+<div class="imagetitle">Hey, &quot;Hole in the Ground&quot;, &ouml;ffne
+dich!<br> Ich bin's, Sundance Murmel!</div>
+</div>
+
+<div class="quote">
+Jedes der folgenden Schachstein-Puzzles erwies sich als eigene Herausforderung.
+Schlussendlich erreichte ich neugierig den Vortex, der mich sicherlich zur
+n&auml;chsten Aufgabe bringen w&uuml;rde.</div>
+
+<div class="quote">
+Was f&uuml;r ein Unterschied! Eine neue Welt, mit neuen Gesetzen! So einfach wie
+es war, die Idee dieser Welt herauszufinden, begann ich mit der Murmel durch
+dieses sehr spezielle Labyrinth zu hetzen. Nur um festzustellen, dass man
+zweimal hinsehen sollte, bevor man sich bewegt.</div>
+
+<div class="quote">
+Und eine weitere Welt auf dem n&auml;chsten Bildschirm. Nun ein herausforderndes
+Steinschiebe-R&auml;tsel. Ich hatte mich gerade entschieden, wie ich mich
+bewegen musste, da prallte ich zu stark f&uuml;r den Metalboden ab und meine
+Murmel zerschellte. Nun musste ich alle vorigen R&auml;tsel aufs neue
+durchspielen! Ich denke, etwas erh&ouml;hte Reibungswerte im ersten und dritten
+Raum w&auml;ren fair gewesen.</div> 
+
+<div class="quote">
+Schlie&szlig;lich erreichte ich den vierten Raum und sah mich einer v&ouml;llig
+neuen Aufgabe gegen&uuml;ber. Eine Murmel auf einem Laufsteg kontrollieren mit
+verzerrten Kr&auml;ften. Nie habe ich vorsichtiger experimentiert als in diesem
+Raum, um die Richtungen zu verstehen, in die die Murmel rollen w&uuml;rde. Lass
+meine Murmel nicht schon wieder bruchlanden! Was f&uuml;r eine Erleichterung am
+Ende die Oxyds zu erreichen.</div>
+
+<div class="quote">
+Gratulation an alle vier Autoren. Mit Sicherheit hat jeder seine besten Ideen
+f&uuml;r dieses Projekt gegeben. Obwohl dem Level ein Storyboard fehlt, das die
+R&auml;ume mehr als nur auf lineare Weise zusammenh&auml;lt, ist die Summe der
+neuen Ideen und Puzzles &uuml;berw&auml;ltigend. Lasst uns hoffen, das mehr
+gemeinsame Levelprojekte folgen werden.</div>
+<div class="author">Ronald</div>
+
+<h4>&quot;Is' DAS ein geiles Level, das kriegt 'ne 10&quot;</h4>
+
+<div class="quote">
+Als Enigma 1.01 erschien, gab es am ersten Sonntag danach kein Mittagessen. Ich
+mu&szlig;te die neuen Level erkunden und stolperte sofort &uuml;ber die
+Springer. Zwar kann ich Schach spielen, wu&szlig;te also, wie diese Teile ziehen
+w&uuml;rden, wenn sie denn z&ouml;gen, wu&szlig;te aber noch nicht, wie ich sie
+zum ziehen &uuml;berreden konnte. Also &uuml;bersprang ich (statt der Pferdchen)
+die meisten solcher Level.</div>
+
+<div class="quote">
+Es vergingen einige Level, bis ich die Pferdchen beherrschte. Nun machte ich
+mich an alle Pferdchen-Level heran und kam so auch nach Quadropolis.</div>
+
+<div class="quote">
+Zun&auml;chst verbrachte ich schier unendlich viel Zeit damit, das Puzzle zu
+l&ouml;sen. Hiermit tat ich mich sehr schwer. Nat&uuml;rlich l&ouml;ste ich es
+ab und zu, hatte mir aber nicht gemerkt, wie. Freundlicherweise liegen zu Beginn
+des Spiels die Puzzle-Steine immer am selben Platz, so dass ich nach vielen
+(sehr vielen) Versuchen endlich gelernt hatte, es zu knacken.</div>
+
+<div class="quote">
+Die Springer auf die richtige Position zu bringen, fiel mir nicht so schwer, nur
+im oberen rechten Bereich des ersten Raumes bin ich des &ouml;fteren beim
+Pferdchen-Schieben durch die angebrochenen Platten gefallen und durfte von vorn
+beginnen. Diese Stelle halte ich f&uuml;r besonders gemein.</div>
+
+<div class="quote">
+Aus welchen Gr&uuml;nden auch immer, ich war der festen &Uuml;berzeugung, die
+Oxyds erreicht zu haben, wenn ich die T&uuml;ren zum Tunnel ge&ouml;ffnet hatte;
+schlie&szlig;lich war in den einen Raum schon genug zu tun.</div>
+
+<div class="quote">
+Umso erstaunter war ich, in einem zweiten Raum zu landen, der auf den ersten
+Blick gar keine Hindernisse enthielt.........
+<br>
+..............bis auf die Tatsache, dass sich der Tunnel nach zwei oder drei
+Schritten schlo&szlig;. Ich kurvte ein wenig gr&uuml;belnderweise um den oberen
+Stein auf den bunten Platten entlang, und fand so die L&ouml;sung. Diesen Raum
+halte ich f&uuml;r den einfachsten.</div>
+
+<div class="quote">
+Im n&auml;chsten waren nat&uuml;rlich immer noch keine Oxyds. Aber da ich
+Spiegel-Level ohnehin mag, bereitete auch der mir keine unl&ouml;sbaren
+Probleme. Mit ein wenig 'Werkzeug' kommt man gut an den Lasern vorbei.</div>
+
+<div class="quote">
+Raum 4. Keine Oxyds. Diese Energie-&Uuml;bertr&auml;ger kannte ich schon,
+bugsierte also  die wei&szlig;e Kugel an den ersten strategischen Punkt.
+T&uuml;r auf. Die n&auml;chsten  Energiesteine reagierten schon
+merkw&uuml;rdiger, die wei&szlig;e Kugel schmierte ab, und  ich sah mich schon
+von Anfang an neu spielen. Aber netterweise hat auch die  wei&szlig;e Kugel ein
+paar Leben. Bei der dritten Sorte Energie-&Uuml;bertr&auml;gern scheiterte ich.
+Ich legte Quadropolis ad acta.</div>
+
+<div class="quote">
+Nach einigen Wochen wagte ich mich wieder daran, und hatte prompt vergessen, wie
+das Puzzle zu l&ouml;sen war. Auch der Zettel mit der Kurzanleitung war weg. Ich
+lernte also von neuem (es dauerte diesmal nicht so lange) und gelangte ohne
+gr&ouml;&szlig;ere Probleme in den vierten Raum. Mit Hilfe einer Skizze
+&uuml;ber die Bewegungen mit den Energie-&Uuml;bertr&auml;gern konnte ich die
+letzte T&uuml;r &ouml;ffnen und hatte es geschafft.</div>
+
+<div class="quote">
+Als der letzte Oxyd-Stein leuchtete, br&uuml;llte ich ein lautes
+&quot;Yeah&quot;, was meinen Freund zu der Frage animierte: &quot;Is' was?&quot;
+Ich sagte: &quot;Is' DAS ein geiles Level, das kriegt 'ne 10.&quot; Soweit ich
+mich erinnere, habe ich nur noch an Pleasure Garden und die Passage eine 10
+vergeben. Und alle drei haben sie verdient.</div>
+
+<div class="author">Gr&uuml;&szlig;e von shoki</div>
+
+<h4>&quot;Vier sehr talentierte Komponisten haben f&uuml;r uns alle ein Konzert
+zusammengesetzt&quot;</h4>
+
+<div class="quote">
+W&auml;hrend sie sich alle darauf einigten, f&uuml;r dasselbe Musiker-Ensemble
+zu schreiben, hat jeder von ihnen ein St&uuml;ck in einem anderen,
+kontrastierenden Stil geschrieben. Das Ergebnis ist eine musikalische Reise
+durch sich erheblich voneinander unterscheidende Schalllandschaften.</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_i.png" alt="Level of the month" border="0">
+<div class="imagetitle">Springreiten: Der gro&szlig;e Graben!</div>
+</div>
+
+<div class="quote">
+Der Raum von Johannes ist wie eine Fuge mit ihren R&auml;tseln und
+Schachsteinen, die auf allen m&ouml;glichen Pfaden bewegt werden m&uuml;ssen.
+Ich bin dankbar daf&uuml;r, dass diese wunderbare Zusammenarbeit in Bezug auf
+Geschicklichkeit vorderlastig ist (entgegen bestimmten &auml;rgerlichen Levels,
+in denen man erst nach 20 Minuten spielen auf eine fast unm&ouml;gliche Aufgabe
+trifft). Wie viele Enigma-Levels, gibt es auch hier einen kritischen Moment des
+&quot;Alles-oder-Nichts&quot;, dessen &Uuml;berwindung bereits die halbe Miete
+f&uuml;r den ganzen Level ist. F&uuml;r mich kommt dieser
+&quot;Alles-oder-Nichts&quot;-Moment, wenn die Murmel den angeknacksten Boden im
+oberen Teil des Raumes &uuml;berqueren muss. Wenn ich es schaffe, den
+Schachstein zu bewegen, ohne die anderen Bodenrisse auszul&ouml;sen, f&uuml;hle
+ich mich, als k&ouml;nnte ich alles schaffen.</div>
+
+<div class="quote">
+Jacobs zweiter Raum ist ein Adagio f&uuml;r Streicher. Er ist so einfach in
+seiner Eleganz. Sehr wohlkingend mit offenen Harmonien. Eine wirklich clevere
+Idee, die mir jedesmal ein L&auml;cheln aufs Gesicht zaubert.</div>
+
+<div class="quote">
+Raoul entschied sich f&uuml;r Modernismus. Laser und Metall &uuml;ber einem
+Abgrund - ich h&ouml;re den Puls einer Trommel, der die Musik vorantreibt.
+Urspr&uuml;nglich l&ouml;ste ich diesen Raum mit Sonnenbrillen, aber das ist
+absolut unn&ouml;tig. Wenn man genau nachdenkt, kann man es auch ohne Extrahilfe
+schaffen.</div>
+
+<div class="quote">
+Und schlie&szlig;lich hat Andreas eine Jazzkomposition f&uuml;r uns geschrieben.
+In seinem vorletzten Raum spielt er mit unseren Erwartungen. Jede Aktion hat
+Konsequenzen - aber die Konsequenzen &auml;ndern sich in derselben Weise, in der
+eine hei&szlig;e Bebop-Kombo das Harmoniekonzept durch Akkordwechsel
+erweitert.</div>
+
+<div class="quote">
+Ich hoffe, dass diese ausgezeichneten Komponisten uns noch viele weitere
+gemeinsame Konzerte erschaffen werden. Ich werde bestimmt 'zuh&ouml;ren'!</div>
+<div class="author">Taztunes</div>
+
+<p>W&auml;hrend die letzten Worte von Taztunes noch erklingen, m&ouml;chte ich
+die Harmonien der VIER Quadropolis-Autoren und der VIER Quadropolis-Freunde noch
+einmal in einem abschlie&szlig;enden Freudenchor zusammenf&uuml;hren und
+miteinstimmen: &quot;CEL-I war ein gro&szlig;artiges Ereignis! Und die Reise
+nach Quadropolis hat sich wahrhaft gelohnt!&quot; Es bleibt zu w&uuml;nschen,
+das der Erfolg von Quadropolis auch dem zweiten CEL-Projekt neue Impulse gibt.
+</p>
+
+<p>Sch&ouml;ne Gr&uuml;&szlig;e,<br/>
+<i>Harry</i></p>
+
+</div>

Modified: homepage/input/lotm/lotm_archive_data.lua
===================================================================
--- homepage/input/lotm/lotm_archive_data.lua	2007-10-01 20:31:07 UTC (rev 891)
+++ homepage/input/lotm/lotm_archive_data.lua	2007-10-01 22:58:49 UTC (rev 892)
@@ -80,11 +80,11 @@
 -- format: Level Title, current_rating, current_votes, additional text
 
 lotm_rating(    "Island Labyrinth",  9.25,   8,  "(1 up)")
-lotm_rating(  "Pneumatic Delivery",  7.58,  24,  "")
+lotm_rating(  "Pneumatic Delivery",  7.58,  12,  "")
 lotm_rating(    "The Aztec Temple",  9.14,   7,  "(1 down)")
 lotm_rating("Labyrinth of Puzzles",  8.92,  13,  "(1 up)")
 lotm_rating(           "Elaborate",  8.50,   8,  "")
-lotm_rating(             "Houdini",  8.86,  11,  "(1 down)")
+lotm_rating(             "Houdini",  8.86,  10,  "(1 down)")
 lotm_rating(           "Tool Time",  8.43,  14,  "")
 lotm_rating(         "Quadropolis",  9.40,   5,  "<b>(newcomer)</b>")
 

Modified: homepage/input/navbar.html
===================================================================
--- homepage/input/navbar.html	2007-10-01 20:31:07 UTC (rev 891)
+++ homepage/input/navbar.html	2007-10-01 22:58:49 UTC (rev 892)
@@ -26,10 +26,10 @@
                 <img src="$$imagedir$$/flags25x15/ru.png" border="0" width="25"
                   height="15" alt="Russian" title="This page in Russian">
           </a></td>
-          <td><a href="$$same_es$$">
+          <!--<td><a href="$$same_es$$">
                 <img src="$$imagedir$$/flags25x15/es.png" border="0" width="25"
                   height="15" alt="Spanish" title="This page in Spanish">
-          </a></td>
+          </a></td>-->
           <!-- <td><a href="$$same_fr$$"><img src="$$imagedir$$/flags25x15/fr.png" border="0" width="25" height="15" alt="French" title="Cette page en fran&ccedil;ais"></a></td> -->
         </tr>
       </table>

Modified: homepage/input/navbar_de.html
===================================================================
--- homepage/input/navbar_de.html	2007-10-01 20:31:07 UTC (rev 891)
+++ homepage/input/navbar_de.html	2007-10-01 22:58:49 UTC (rev 892)
@@ -26,10 +26,10 @@
                 <img src="$$imagedir$$/flags25x15/ru.png" border="0" width="25"
                   height="15" alt="Russian" title="This page in Russian">
           </a></td>
-          <td><a href="$$same_es$$">
+          <!--<td><a href="$$same_es$$">
                 <img src="$$imagedir$$/flags25x15/es.png" border="0" width="25"
                   height="15" alt="Spanish" title="This page in Spanish">
-          </a></td>
+          </a></td>-->
           <!-- <td><a href="$$same_fr$$"><img src="$$imagedir$$/flags25x15/fr.png" border="0" width="25" height="15" alt="French" title="Cette page en fran&ccedil;ais"></a></td> -->
         </tr>
       </table>

Modified: homepage/input/navbar_ru.html
===================================================================
--- homepage/input/navbar_ru.html	2007-10-01 20:31:07 UTC (rev 891)
+++ homepage/input/navbar_ru.html	2007-10-01 22:58:49 UTC (rev 892)
@@ -26,10 +26,10 @@
                 <img src="$$imagedir$$/flags25x15/ru.png" border="0" width="25"
                   height="15" alt="Russian" title="??? ???????? ?? ???????">
           </a></td>
-          <td><a href="$$same_es$$">
+          <!--<td><a href="$$same_es$$">
                 <img src="$$imagedir$$/flags25x15/es.png" border="0" width="25"
                   height="15" alt="Spanish" title="This page in Spanish">
-          </a></td>
+          </a></td>-->
           <!-- <td><a href="$$same_fr$$"><img src="$$imagedir$$/flags25x15/fr.png" border="0" width="25" height="15" alt="French" title="Cette page en fran&ccedil;ais"></a></td> -->
         </tr>
       </table>



From andreasl at mail.berlios.de  Wed Oct  3 00:08:20 2007
From: andreasl at mail.berlios.de (andreasl at BerliOS)
Date: Wed, 3 Oct 2007 00:08:20 +0200
Subject: [Enigma-game-svn] r893 - in homepage/input: . lotm
Message-ID: <200710022208.l92M8KmK023700@sheep.berlios.de>

Author: andreasl
Date: 2007-10-03 00:08:19 +0200 (Wed, 03 Oct 2007)
New Revision: 893

Modified:
   homepage/input/infobox.html
   homepage/input/infobox_de.html
   homepage/input/lotm/lotm_200710.html
   homepage/input/lotm/lotm_200710_de.html
   homepage/input/output-files.lua
Log:
Homepage:
 - German proofread of LotM 10/07
 - Small changes and typos in English LotM 10/07
 - Infobox: 10,000 level ratings
 - Removed double points and double double points in "Other Statistics"
Todo:
 - Proofread, translations, validation of LotM 10/07
 - Russian and Spanish translation of Infobox


Modified: homepage/input/infobox.html
===================================================================
--- homepage/input/infobox.html	2007-10-01 22:58:49 UTC (rev 892)
+++ homepage/input/infobox.html	2007-10-02 22:08:19 UTC (rev 893)
@@ -1,8 +1,8 @@
     <div class="infobody">
        <div class="info">
-         <h3>100 Score Submitters</h3>
-         We welcome user &quot;dpl&quot; who is the 100th active score submitter
-	 since Enigma 1.00.
+         <h3>More than 10,000 level ratings</h3>
+         This month we reached the 10,000-ratings mark. Thanks to all the
+         sedulous players, who sent us their opinions!
          <h3>Level of the Month</h3>
          <a href="$$lotm_current$$"><img src="$$lotm_current_image$$"
          alt="$$lotm_expansion$$" border="0"></a>

Modified: homepage/input/infobox_de.html
===================================================================
--- homepage/input/infobox_de.html	2007-10-01 22:58:49 UTC (rev 892)
+++ homepage/input/infobox_de.html	2007-10-02 22:08:19 UTC (rev 893)
@@ -1,8 +1,9 @@
     <div class="infobody">
        <div class="info">
-         <h3>100 Einsender von Ergebnissen</h3>
-         Wir hei&szlig;en den Spieler &quot;dpl&quot; willkommen, den wir als
-         100sten aktiven Einsender von Spielergebnissen registriert haben.
+         <h3>&Uuml;ber 10.000 Levelbewertungen</h3>
+         Diesen Monat haben wir die 10.000er Marke bei den Ratings
+         &uuml;berboten. Vielen Dank an die unerm&uuml;dlichen Spieler,
+         die uns ihre Meinung mitgeteilt haben!
          <h3>Level des Monats</h3>
          <a href="$$lotm_current$$"><img src="$$lotm_current_image$$"
          alt="$$lotm_expansion$$" border="0"></a>

Modified: homepage/input/lotm/lotm_200710.html
===================================================================
--- homepage/input/lotm/lotm_200710.html	2007-10-01 22:58:49 UTC (rev 892)
+++ homepage/input/lotm/lotm_200710.html	2007-10-02 22:08:19 UTC (rev 893)
@@ -84,8 +84,9 @@
 of the Age of Enigma.</p> 
 
 <div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200710_f.png" alt="Level of the month" border="0">
-<div class="imagetitle">Got it now: Just moving blocks<br>along the laser path!</div>
+<img src="$$imagedir$$/lotm/lotm_200710_e.png" alt="Level of the month" border="0">
+<div class="imagetitle">Find the hammer, build a sword, beat<br>
+the knight! This one will be no problem!</div>
 </div>
 
 <p>Most part of these levels have been written by Andreas, well-known to the
@@ -107,11 +108,11 @@
 for the FOURth time to the list of LotM authors, a really impressing record.</p>
 
 <p>Also in March, in the evening of the FOURteenth day, it happened that
-Illmind, admin of the Enigma-Fan-Forum as everybody knows, announced his idea
+illmind, admin of the Enigma-Fan-Forum as everybody knows, announced his idea
 for a 'combined effort level' beginning with the following words: &quot;how about we
-make a level with several people..&quot;. Just the quarter of an hour later the first
-author had agreed to participate in the project, and another FOUR hours later
-the first CEL team consisting of FOUR authors was complete.</p>
+make a level with several people&hellip;&quot;. Just the quarter of an hour
+later the first author had agreed to participate in the project, and another
+FOUR hours later the first CEL team consisting of FOUR authors was complete.</p>
 
 <p>And surprisingly fast (guess when!) - (right!) - just FOUR days later, all of
 the FOUR authors had finished off their rooms. So they thought. Another period
@@ -120,7 +121,7 @@
 name: 'Quadropolis'.</p>
 
 <p>FOUR weeks of the FOURth month having passed, this name was suggested by
-Illmind on the secret level project channel at mag.heut.net. None of the FOUR
+illmind on the secret level project channel at mag-heut.net. None of the FOUR
 authors did raise objections, and after the enigmatic forum oracle had agreed to
 this suggestion, the CEL project was assigned a worthy name. Another FOUR weeks
 later Quadropolis was published with Release 1.01 of Enigma within level pack
@@ -203,7 +204,7 @@
 <div class="quote">
 The CEL was definitely a good experience -- I'd highly recommend it to anyone
 looking to make difficult levels and get feedback on their work. In fact, a new
-CEL has been announced on the mag-heut forum, but is still waiting for more
+CEL has been announced on the mag-heut.net forum, but is still waiting for more
 level designers....
 </div>
 <div class="author">Jacob Scott</div>
@@ -211,7 +212,7 @@
 <h4>&quot;It became clear that I had to simplify my room&quot;</h4> 
 
 <div class="quote">
-It all began with a post by Illmind, who came up with the idea to have a level
+It all began with a post by illmind, who came up with the idea to have a level
 built by several authors, each of them building one room on his own, and finally
 these single rooms should be joined together to form one level. This idea was
 well received, and so it happened that 4 authors started building the first
@@ -237,8 +238,8 @@
 </div>
 
 <div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200710_e.png" alt="Level of the month" border="0">
-<div class="imagetitle">Find the hammer, build a sword, beat the knight!<br>This one will be no problem!</div>
+<img src="$$imagedir$$/lotm/lotm_200710_f.png" alt="Level of the month" border="0">
+<div class="imagetitle">Got it now: Just moving blocks<br>along the laser path!</div>
 </div>
 
 <div class="quote">
@@ -406,7 +407,7 @@
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200710_j.png" alt="Level of the month" border="0">
 <div class="imagetitle">Thieves, even in Quadropolis!<br>Pegasus, my loyal
-quadruped, treat them right!</div>
+quadruped,<br>treat them right!</div>
 </div>
 
 <div class="quote">
@@ -444,7 +445,7 @@
 
 <div class="quote">
 Seeing the first yellow puzzle I had been gobsmacked. Solving puzzles can end
-up in situation where you finally have to exchange just two pieces. A task that
+up in a situation where you finally have to exchange just two pieces. A task that
 sometimes proves to be harder than you think it should be. But this tiny puzzle
 introduced a new idea to puzzles. It is up to you adding the last piece to the
 puzzle. Of course you can mess up everything by choosing the false point of time.
@@ -453,7 +454,7 @@
 </div>
 
 <div class="quote">
-Each of the following chess puzzles prooved to be another challenge of its own.
+Each of the following chess puzzles proved to be another challenge of its own.
 Finally I reached curiously the vortex that would certainly warp me to the next
 challenge.
 </div>
@@ -491,7 +492,7 @@
 together in more than a linear fassion the sum of new ideas and puzzles is
 overwhelming. Let us hope that more combined effort level will follow.
 </div>
-<div class="author">Roland</div>
+<div class="author">Ronald</div>
 
 <h4>&quot;THIS's a cool level, it get's a 10!&quot;</h4>
 

Modified: homepage/input/lotm/lotm_200710_de.html
===================================================================
--- homepage/input/lotm/lotm_200710_de.html	2007-10-01 22:58:49 UTC (rev 892)
+++ homepage/input/lotm/lotm_200710_de.html	2007-10-02 22:08:19 UTC (rev 893)
@@ -6,9 +6,7 @@
 &quot;Quadropolis&quot;, Combined Effort Level I
 </h3>
 
-<h4>
-by Johannes Laire, Jacob Scott, Raoul Bourquin and Andreas Lochmann
-</h4>
+<h4>von Johannes Laire, Jacob Scott, Raoul Bourquin and Andreas Lochmann</h4>
 
 <p>Im Oktober f&uuml;hrt unsere monatliche LdM-Exkursion zu den herausragenden
 Sehensw&uuml;rdigkeiten von Enigma nach Quadropolis. Schon der Klang dieses
@@ -63,8 +61,9 @@
 
 <p>Das sieht nach einem spannenden Rennen um den LdJ Titel aus, zumal noch 2
 hei&szlig;e Kandidaten im Verborgenen auf ihre Chance lauern. Wer das ist, will
-ich hier nicht verraten, aber wer mal die Level Ratings einzeln durchcheckt, der
-kann mit einiger Sicherheit erkennen, um wen es sich handelt.</p>
+ich hier nicht verraten, aber wer mal die Bewertungen der Levels einzeln
+durchcheckt, der kann mit einiger Sicherheit erkennen, um wen es sich
+handelt.</p>
 
 <p>Aber vielleicht kommt es ja auch ganz anders! Denn Sie sind es, die mit Ihren
 Stimmen &uuml;ber den Level des Monats, sowie auch &uuml;ber den Level des
@@ -74,7 +73,7 @@
 <h4>Die Reise nach Quadropolis f&uuml;hrt uns in eine andere Welt</h4>
 
 <p>Etwas von Olympischem Geist weht durch die Hallen dieser Sportst&auml;tte.
-Bei allem sportlichen Ehrgeiz der Veranstalter ist doch der Fair Play Gedanke
+Bei allem sportlichen Ehrgeiz der Veranstalter ist doch der Fairplay-Gedanke
 gegen&uuml;ber den Spielern als Leitmotiv erkennbar. Bis auf den
 Springer-Parcours sind die R&auml;ume vom Schwierigkeitsgrad her im gr&uuml;nen
 Bereich. Im zweiten und im VIERten Raum besteht zudem keine Lebensgefahr
@@ -90,8 +89,9 @@
 Enigmatischen Zeitalters mit Raouls Zeus verbunden bleiben.</p>
 
 <div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200710_f.png" alt="Level of the month" border="0">
-<div class="imagetitle">Jetzt hab' ich's kapiert: <br>Just moving blocks <br>along the laser path!</div>
+<img src="$$imagedir$$/lotm/lotm_200710_e.png" alt="Level of the month" border="0">
+<div class="imagetitle">Den Hammer finden, ein Schwert<br>machen, den Ritter
+besiegen. <br>Das sollte kein Problem sein. </div>
 </div>
 
 <p>Einen guten Teil dieser Level hat Andreas verfasst, der den treuen Lesern
@@ -107,19 +107,19 @@
 <h4>Der M&auml;rz war ein sehr ergiebiger Monat f&uuml;r Enigma</h4>
 
 <p>Die Homepage erschien zum ersten Mal auch in deutscher Sprache, in neuem
-Design und um einige neue Menuepunkte erweitert. Eine von diesen Neuerungen war
-die Sparte &quot;Level des Monats&quot; mit &quot;Island Labyrinth&quot; von
+Design und um einige neue Men&uuml;punkte erweitert. Eine von diesen Neuerungen
+war die Sparte &quot;Level des Monats&quot; mit &quot;Island Labyrinth&quot; von
 Jacob Scott als erstem Titelt&auml;ger. Als einer der Autoren von Quadropolis
 hat sich Jacob nun bereits zum VIERten Mal in die Liste der Titelgewinner
 eingetragen, eine wirklich beachtliche Bilanz.</p>
 
 <p>Es war auch im M&auml;rz, genau genommen am Abend des VIERzehnten, als
-Illmind, bekanntlich Admin des Enigma-Fan-Forums Mag.Heut.Net, seine Idee
+illmind, bekanntlich Admin des Enigma-Fan-Forums mag-heut.net, seine Idee
 f&uuml;r einen gemeinsam gestalteten Level bekannt gab, beginnend mit den
-Worten: &quot;how about we make a level with several people..&quot;. Bereits
-eine VIERtelstunde sp&auml;ter meldete sich mit Johannes der erste Teilnehmer
-f&uuml;r das Projekt, und weitere VIER Stunden sp&auml;ter war das erste
-CEL-Team mit VIER Autoren vollst&auml;ndig.</p>
+Worten: &quot;how about we make a level with several people&hellip;&quot;.
+Bereits eine VIERtelstunde sp&auml;ter meldete sich mit Johannes der erste
+Teilnehmer f&uuml;r das Projekt, und weitere VIER Stunden sp&auml;ter war das
+erste CEL-Team mit VIER Autoren vollst&auml;ndig.</p>
 
 <p>Und &uuml;berraschend schnell (Na, raten Sie mal!), n&auml;mlich am Abend des
 VIERten Tages nach Bekanntgabe, hatten alle VIER Autoren ihre Beitr&auml;ge
@@ -128,16 +128,16 @@
 Bem&uuml;hungen zum Abschlu&szlig; noch seinen Namen bekam:
 &quot;Quadropolis&quot;.</p>
 
-<p>Dieser Name resultiert &uuml;brigens aus einem Geistesblitz von Illmind, den
+<p>Dieser Name resultiert &uuml;brigens aus einem Geistesblitz von illmind, den
 er VIER Wochen nach Beginn des VIERten Monats nach Ablauf der VIERten
-Doppelstunde nach Mitternacht im Level Project Channel auf Mag.Heut.Net bekannt
+Doppelstunde nach Mitternacht im Level Project Channel auf mag-heut.net bekannt
 gab. Keiner der VIER Autoren hatte Einw&auml;nde, und nachdem auch das
 r&auml;teslhafte Forums-Orakel seine Zustimmung gegeben hatte, trug das Projekt
 CEL also endlich auch einen w&uuml;rdigen Namen. Weitere VIER Wochen sp&auml;ter
 erschien Quadropolis dann mit Enigma 1.01 in Levelpack (Wurzel VIER plus VIER)
 mit der Nummer (VIER mal VIER mal f&uuml;nf minus eins).</p>
 
-<p>Die VIERzahl pr&auml;gt auch im weiternen Verlauf diesen Artikel, denn Tyche
+<p>Die VIERzahl pr&auml;gt auch im weiteren Verlauf diesen Artikel, denn Tyche
 hat es so gef&uuml;gt, dass sich au&szlig;er den VIER Autoren auch VIER Spieler
 zu Worte melden werden. Diesmal haben wir VIER mal so viele Kommentatoren wie
 letzten Monat, sodass ich mich also ab jetzt entspannt zur&uuml;cklehnen darf,
@@ -147,14 +147,14 @@
 st-puzzle&quot;</h4>
 
 <div class="quote">
-- das erstere weil ich seit vielen Jahren Schach spiele, und das letztere weil
+- das erstere, weil ich seit vielen Jahren Schach spiele, und das letztere, weil
 ich alle Arten von Permutations-R&auml;tseln liebe. Ich hatte schon jede Menge
-Ideen f&uuml;r Level diese Objekte betreffend, aber irgendwie f&auml;llt es mir
-schwer einen Anfang zu finden, und so habe ich bisher erst ein paar Level
+Ideen f&uuml;r Level diese Objekte betreffend, aber irgendwie f&auml;llt es
+mir schwer, einen Anfang zu finden, und so habe ich bisher erst ein paar Level
 verfasst.</div>
 
 <div class="quote">
-Als ich Illminds Vorschlag f&uuml;r das Projekt gelesen habe, fand ich sofort
+Als ich illminds Vorschlag f&uuml;r das Projekt gelesen habe, fand ich sofort
 Gefallen daran. Ein Raum ist gro&szlig; genug, um etwas Interessantes zu
 gestalten, aber nicht zu gro&szlig;, um allzu viel Zeit f&uuml;r die
 Ausarbeitung in Anspruch zu nehmen. Also habe ich rasch geantwortet, dass ich
@@ -164,13 +164,13 @@
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200710_b.png" alt="Level of the month" border="0">
-<div class="imagetitle">Robert Murmel ist "Der Pferdefl&uuml;sterer"</div>
+<div class="imagetitle">Robert Murmel ist &quot;Der Pferdefl&uuml;sterer&quot;</div>
 </div>
 
 <div class="quote">Das allererste Puzzle in meinem Raum sieht gew&ouml;hnlich
 aus, aber es gibt einen kleinen Trick an der Sache: Wenn man am Anfang einen
 Fehler begeht, kann man es nicht mehr l&ouml;sen! Diejenigen, die mit Rubik's
-Zauberw&uuml;rfel vertraut sind, wissen vielleicht, dass wenn man zwei
+Zauberw&uuml;rfel vertraut sind, wissen vielleicht, dass, wenn man zwei
 St&uuml;cke aus dem W&uuml;rfel herausnimmt, und sie miteinander vertauscht
 wieder einsetzt, die daraus resultierende Position nicht l&ouml;sbar ist. Das
 hat mich fasziniert, und ich war wirklich sehr erfreut, als ich festgestellt
@@ -178,11 +178,11 @@
 kann.</div>
 
 <div class="quote">Danach habe ich den Raum nach und nach mit einigen
-sorgf&auml;ltig designten Chessoban-artigen Puzzles aufgef&uuml;llt. Das Einzige
-was mir an meinem Raum nicht gef&auml;llt ist die Tatsache, dass man an einigen
-Stellen doch etwas Geschicklichkeit ben&ouml;tigt um die Schachfiguren zu
-bewegen, weil ich eigentlich vorhatte einen puren Puzzle-Level zu entwerfen.
-Aber Alles in Allem bin ich doch sehr zufrieden damit.</div>
+sorgf&auml;ltig designten Chessoban-artigen Puzzles aufgef&uuml;llt. Das
+einzige, was mir an meinem Raum nicht gef&auml;llt, ist die Tatsache, dass man
+an einigen Stellen doch etwas Geschicklichkeit ben&ouml;tigt, um die
+Schachfiguren zu bewegen, weil ich eigentlich vor hatte, einen puren Puzzle-Level
+zu entwerfen. Aber alles in allem bin ich doch sehr zufrieden damit.</div>
 
 <div class="quote">Den Level als Ganzes habe ich bisher immer noch nicht
 gel&ouml;st, aber ich habe alle R&auml;ume einzeln durchgespielt und jeder
@@ -193,30 +193,30 @@
 <h4>&quot;CEL war definitiv eine gute Erfahrung&quot;</h4>
 
 <div class="quote">
-&quot;Quadropolis&quot;, das Resultat des allerersten CEL war tats&auml;chlich
-die Zusammenarbeit zwischen verschiedenen Organisatoren und Level Autoren, mich
+&quot;Quadropolis&quot;, das Resultat des allerersten CEL, war tats&auml;chlich
+die Zusammenarbeit zwischen verschiedenen Organisatoren und Levelautoren, mich
 selbst eingeschlossen. Jeder von uns schrieb einen Raum, der einen Startpunkt
 und einen Vortex beinhalten musste, sowie irgendeine teuflische Gemeinheit von
-R&auml;tsel, gerade so wie sie uns in den Sinn kam.</div>
+R&auml;tsel, gerade so, wie sie uns in den Sinn kam.</div>
 
 <div class="quote">
-Im mag.heut.net Forum wurde jeder dieser Mini-Level von uns ausgiebig getestet
+Im mag-heut.net Forum wurde jeder dieser Mini-Level von uns ausgiebig getestet
 und schlie&szlig;lich einer nach dem anderen miteinander verbunden, um so einen
-Multi-Autoren-Level zu bilden mit vielen unterschiedlichen Ideen und
+Multi-Autoren-Level zu bilden, mit vielen unterschiedlichen Ideen und
 andersartigen Herausforderungen.</div>
 
 <div class="quote">
 Mein Raum stellte sich, ziemlich &uuml;berraschend, als einer der einfacheren in
 diesem Level heraus, gemessen an meinem Streckenrekord: ein nach einem nicht
 allzu komplizierten Muster aufgebauter Raum, in dem es keine M&ouml;glichkeit
-gibt zu sterben oder einen Neustart zu erzwingen.</div>
+gibt, zu sterben oder einen Neustart zu erzwingen.</div>
 
 <div class="quote">
 CEL war definitiv eine gute Erfahrung -- Ich kann es nur nachdr&uuml;cklich
-jedem Autor empfehlen, der plant schwierige Level zu verfassen, und der dabei
+jedem Autor empfehlen, der plant, schwierige Level zu verfassen, und der dabei
 Feedback zu seiner Arbeit bekommen m&ouml;chte. In der Tat ist bereits ein neues
-CEL im mag.heut.net Forum ausgeschrieben worden, und wartet immer noch auf
-weitere Level Designer...</div>
+CEL im mag-heut.net Forum ausgeschrieben worden, und wartet immer noch auf
+weitere Leveldesigner...</div>
 <div class="author">Jacob Scott</div>
 
 <h4>&quot;Somit war bald klar, dass ich meinen Raum stark vereinfachen
@@ -231,7 +231,7 @@
 </div>
 
 <div class="quote">
-So gingen wir dann an die Arbeit, jeder begann an seinem Raum zu basteln. Ich
+So gingen wir dann an die Arbeit, jeder begann, an seinem Raum zu basteln. Ich
 hatte ein Konzept, das ich in &quot;Puzzle Puzzles&quot; schon einmal in einer
 anderen Variante verwendet hatte: der Spieler soll einen Stein durch's ganze
 Level (oder eben den ganzen Raum) schieben und dabei den Weg st&uuml;ckchenweise
@@ -242,27 +242,27 @@
 
 <div class="quote">
 Als dann jeder seinen Raum fertig hatte, und wir begannen, die R&auml;ume in
-eine lineare Anordnung zu bringen, stellte sich schnell heraus, dass das
+eine lineare Anordnung zu bringen, stellte sich schnell heraus, dass der
 resultierende Level viel zu schwer w&uuml;rde. Zumal, bedingt durch seinen
 geradlinigen Aufbau, man immer alle vorderen R&auml;ume durchspielen musste, um
 in den hinteren zu experimentieren.</div>
 
 <div class="lotmpic">
-<img src="$$imagedir$$/lotm/lotm_200710_e.png" alt="Level of the month" border="0">
-<div class="imagetitle">Den Hammer finden, ein Schwert machen, <br>den Ritter besiegen. <br>Das sollte kein Problem sein. </div>
+<img src="$$imagedir$$/lotm/lotm_200710_f.png" alt="Level of the month" border="0">
+<div class="imagetitle">Jetzt hab' ich's kapiert: <br>Just moving blocks <br>along the laser path!</div>
 </div>
 
 <div class="quote">
 Somit war bald klar, dass ich meinen Raum stark vereinfachen musste. Da das aber
-kaum m&ouml;glich war, ohne etliche der Puzzels zu zerst&ouml;ren, beschloss
-ich, diesen Raum als ein-raum-level einzeln zu ver&ouml;ffentlichen. Daraus
-wurde das Level &quot;Industrial Puzzles&quot;.</div>
+kaum m&ouml;glich war, ohne etliche der Puzzles zu zerst&ouml;ren, beschloss
+ich, diesen Raum als Ein-Raum-Level einzeln zu ver&ouml;ffentlichen. Daraus
+wurde der Level &quot;Industrial Puzzles&quot;.</div>
 
 <div class="quote">
 Nun musste aber ein neuer Raum her, doch hatte ich lange Zeit keine
 schl&uuml;ssige Idee, wie ich einen Raum machen k&ouml;nnte, der
-einigerma&szlig;en in das Level passte - es musste ein Durchgangsraum sein - und
-der nicht zu schwer war. Irgendwann, sp&auml;t Abends, kam ich dann auf die
+einigerma&szlig;en in den Level passte - es musste ein Durchgangsraum sein - und
+der nicht zu schwer war. Irgendwann, sp&auml;t abends, kam ich dann auf die
 Idee, einen Pfad zu verlegen, der einerseits von einem Laserstrahl mehrfach
 gekreuzt und somit blockiert wird, andererseits unterbrochen und l&ouml;chrig
 ist.</div>
@@ -313,7 +313,7 @@
 ebenfalls profitieren. Also suchte ich nach weiteren Steinen, die die
 Geschwindigkeit der Murmel verwenden. Ich fand schlie&szlig;lich st-spitter und
 die st-actorimpulse-Familie, beide ebenso recht selten verwendet und ebenso
-irgendwie uninteressante Objekte. Eine einfache Erg&auml;nzung von der drei
+irgendwie uninteressante Objekte. Eine einfache Erg&auml;nzung, von der drei
 verschiedene Objekte profitieren w&uuml;rden - das war die M&uuml;he wert. Im
 Juli '06  spielte Raoul die notwendigen &Auml;nderungen ein, die ich im Monat
 zuvor programmiert hatte.</div>
@@ -374,12 +374,12 @@
 schon bemerkt hat, (&auml;hm, sorry, bald bemerken wird) und eine wahre
 Geduldsprobe!</p> 
 
-<p>Beim Zeus noch mal, wie die wei&szlig;e Murmel abgeht, wenn man aus Versehen
-mal ein bi&szlig;chen zu sehr auf die Pauke haut! Um bis zum (letzten) Vortex zu
-gelangen, habe ich mehr Zeit ben&ouml;tigt, als f&uuml;r die drei anderen
-R&auml;ume zusammen. Wirklich ein Geduldspiel - eine sehr langwierige
-Angelegenheit, aber auf keinen Fall eine langweilige! Sorry f&uuml;r die
-Unterbrechung, Andreas, aber das musste sein.</p>
+<p>Beim Zeus noch mal, wird die wei&szlig;e Murmel schnell, wenn man die
+Blitzsteine nicht sehr behutsam behandelt! Um bis zum (letzten) Vortex
+zu gelangen, habe ich mehr Zeit ben&ouml;tigt, als f&uuml;r die drei
+anderen R&auml;ume zusammen. Wirklich ein Geduldsspiel - eine sehr
+langwierige Angelegenheit, aber auf keinen Fall eine langweilige! Sorry,
+Andreas, aber das musste sein.</p>
 
 <h4>Ein paar Anmerkungen zu Jacob's Raum:</h4> 
 
@@ -395,17 +395,18 @@
 ersten beiden Male, als der Vortex sich geschlossen hatte, dr&uuml;ckte ich
 frustriert die Escape-Taste, und w&auml;hlte &quot;Neustart&quot;. Aber seinen
 Raum f&uuml;r das Gemeinschaftsprojekt hat Jacob wirklich fair gestaltet.
-&Uuml;berhaupt erinnert mich das Design dieses Raumes an eine Aquarell
-Landschaft mit sanften hellen Farben und mit leichtem Pinselstrich gemalt.</p>
+&Uuml;berhaupt erinnert mich das Design dieses Raumes an eine
+Aquarell-Landschaft mit sanften hellen Farben und mit leichtem Pinselstrich
+gemalt.</p>
 
 <h4>Einfach nur Enigma pur</h4>
 
 <p>Das Sch&ouml;ne an diesem Raum, wie auch an den anderen dreien ist: es gibt
 nichts Verstecktes, keine Hohlsteine, keine Cham&auml;leons, keine unsichtbaren
 Trigger, kein Wettrennen gegen die Zeit, das ist einfach nur reines Enigma.
-Ebenso beachtlich wie auch ungew&ouml;nlich finde ich die Tatsache, dass in ganz
-Quadropolis nicht ein einziges Item ben&ouml;tigt wird, auch das ist, so finde
-ich, Enigma pur!</p>
+Ebenso beachtlich wie auch ungew&ouml;hnlich finde ich die Tatsache, dass in
+ganz Quadropolis nicht ein einziges Item ben&ouml;tigt wird, auch das ist, so
+finde ich, Enigma pur!</p>
 
 <p>Vielleicht h&auml;tte man im Eingangsbereich noch ein paar Bodenfliesen mit
 Dieb-Motiv verlegen sollen, um so die Murmel um die Last der beiden Extra-Leben
@@ -418,12 +419,12 @@
 das bisher gemacht wurde&quot;</h4>
 
 <div class="quote">
-Quadropolis ist (von meinen bisher gel&ouml;sten Levels) mein absolutes
+Quadropolis ist (von meinen bisher gel&ouml;sten Levels) mein absoluter
 Lieblingslevel. Schon das allgemeine Konzept, dass ein Level von vielen
 verschiedenen Autoren geschrieben wurde, finde ich klasse! Und die daraus
 resultierende Unabh&auml;ngigkeit aller R&auml;ume. Jeder hat ein individuelles
 Design und eine individuelle Grundidee, die einzige Gemeinsamkeit sind die
-vortexes, die die R&auml;ume miteinander verbinden.</div>
+Vortices, die die R&auml;ume miteinander verbinden.</div>
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200710_j.png" alt="Level of the month" border="0">
@@ -444,10 +445,10 @@
 orginelle Konzept geben jedoch wieder Pluspunkte.</div> 
 
 <div class="quote">
-Der dafauffolgende Raum ist das komplette Gegenteil; auf den ersten Blick sieht
+Der darauffolgende Raum ist das komplette Gegenteil; auf den ersten Blick sieht
 er eher langweilig aus, ist jedoch noch eine nervenaufreibende Herausforderung
-(vor allem wenn die wei&szlig;e Kugel kein Extraleben mehr hat) und zeigt tolle
-M&ouml;glichkeiten des st-flashs.</div>
+(vor allem, wenn die wei&szlig;e Kugel keine Extraleben mehr hat) und zeigt
+tolle M&ouml;glichkeiten des st-flashs.</div>
 
 <div class="quote">
 Der einzige Kritikpunkt: Das Design des Oxyd-Raums ist meiner Meinung nach zu
@@ -459,7 +460,7 @@
 
 <div class="quote">
 Nach dem Anblick des ersten gelben Puzzles war ich platt. Puzzles zu l&ouml;sen
-kann in Situationen enden, in denen man abschlie&szlig;ende nur noch zwei Teile
+kann in Situationen enden, in denen man abschlie&szlig;end nur noch zwei Teile
 austauschen muss. Diese Aufgabe stellt sich manchmal als h&auml;rter heraus als
 erwartet. Aber dieses kleine Puzzle hat eine neue Idee f&uuml;r Puzzles
 vorgef&uuml;hrt. Es liegt an Ihnen, wann Sie das letzte St&uuml;ck ans Puzzle
@@ -482,14 +483,14 @@
 
 <div class="quote">
 Was f&uuml;r ein Unterschied! Eine neue Welt, mit neuen Gesetzen! So einfach wie
-es war, die Idee dieser Welt herauszufinden, begann ich mit der Murmel durch
+es war, die Idee dieser Welt herauszufinden, begann ich, mit der Murmel durch
 dieses sehr spezielle Labyrinth zu hetzen. Nur um festzustellen, dass man
 zweimal hinsehen sollte, bevor man sich bewegt.</div>
 
 <div class="quote">
 Und eine weitere Welt auf dem n&auml;chsten Bildschirm. Nun ein herausforderndes
 Steinschiebe-R&auml;tsel. Ich hatte mich gerade entschieden, wie ich mich
-bewegen musste, da prallte ich zu stark f&uuml;r den Metalboden ab und meine
+bewegen musste, da prallte ich zu stark f&uuml;r den Metallboden ab und meine
 Murmel zerschellte. Nun musste ich alle vorigen R&auml;tsel aufs neue
 durchspielen! Ich denke, etwas erh&ouml;hte Reibungswerte im ersten und dritten
 Raum w&auml;ren fair gewesen.</div> 
@@ -506,7 +507,7 @@
 Gratulation an alle vier Autoren. Mit Sicherheit hat jeder seine besten Ideen
 f&uuml;r dieses Projekt gegeben. Obwohl dem Level ein Storyboard fehlt, das die
 R&auml;ume mehr als nur auf lineare Weise zusammenh&auml;lt, ist die Summe der
-neuen Ideen und Puzzles &uuml;berw&auml;ltigend. Lasst uns hoffen, das mehr
+neuen Ideen und Puzzles &uuml;berw&auml;ltigend. Lasst uns hoffen, dass mehr
 gemeinsame Levelprojekte folgen werden.</div>
 <div class="author">Ronald</div>
 
@@ -514,10 +515,10 @@
 
 <div class="quote">
 Als Enigma 1.01 erschien, gab es am ersten Sonntag danach kein Mittagessen. Ich
-mu&szlig;te die neuen Level erkunden und stolperte sofort &uuml;ber die
-Springer. Zwar kann ich Schach spielen, wu&szlig;te also, wie diese Teile ziehen
-w&uuml;rden, wenn sie denn z&ouml;gen, wu&szlig;te aber noch nicht, wie ich sie
-zum ziehen &uuml;berreden konnte. Also &uuml;bersprang ich (statt der Pferdchen)
+musste die neuen Level erkunden und stolperte sofort &uuml;ber die
+Springer. Zwar kann ich Schach spielen, wusste also, wie diese Teile ziehen
+w&uuml;rden, wenn sie denn z&ouml;gen, wusste aber noch nicht, wie ich sie
+zum Ziehen &uuml;berreden konnte. Also &uuml;bersprang ich (statt der Pferdchen)
 die meisten solcher Level.</div>
 
 <div class="quote">
@@ -532,22 +533,22 @@
 (sehr vielen) Versuchen endlich gelernt hatte, es zu knacken.</div>
 
 <div class="quote">
-Die Springer auf die richtige Position zu bringen, fiel mir nicht so schwer, nur
-im oberen rechten Bereich des ersten Raumes bin ich des &ouml;fteren beim
+Die Springer auf die richtigen Positionen zu bringen, fiel mir nicht so schwer,
+nur im oberen rechten Bereich des ersten Raumes bin ich des &ouml;fteren beim
 Pferdchen-Schieben durch die angebrochenen Platten gefallen und durfte von vorn
 beginnen. Diese Stelle halte ich f&uuml;r besonders gemein.</div>
 
 <div class="quote">
 Aus welchen Gr&uuml;nden auch immer, ich war der festen &Uuml;berzeugung, die
 Oxyds erreicht zu haben, wenn ich die T&uuml;ren zum Tunnel ge&ouml;ffnet hatte;
-schlie&szlig;lich war in den einen Raum schon genug zu tun.</div>
+schlie&szlig;lich war in dem einen Raum schon genug zu tun.</div>
 
 <div class="quote">
 Umso erstaunter war ich, in einem zweiten Raum zu landen, der auf den ersten
 Blick gar keine Hindernisse enthielt.........
 <br>
 ..............bis auf die Tatsache, dass sich der Tunnel nach zwei oder drei
-Schritten schlo&szlig;. Ich kurvte ein wenig gr&uuml;belnderweise um den oberen
+Schritten schlo&szlig;. Ich kurvte gr&uuml;belnderweise ein wenig um den oberen
 Stein auf den bunten Platten entlang, und fand so die L&ouml;sung. Diesen Raum
 halte ich f&uuml;r den einfachsten.</div>
 
@@ -562,7 +563,7 @@
 T&uuml;r auf. Die n&auml;chsten  Energiesteine reagierten schon
 merkw&uuml;rdiger, die wei&szlig;e Kugel schmierte ab, und  ich sah mich schon
 von Anfang an neu spielen. Aber netterweise hat auch die  wei&szlig;e Kugel ein
-paar Leben. Bei der dritten Sorte Energie-&Uuml;bertr&auml;gern scheiterte ich.
+paar Leben. Bei der dritten Sorte Energie-&Uuml;bertr&auml;ger scheiterte ich.
 Ich legte Quadropolis ad acta.</div>
 
 <div class="quote">
@@ -577,8 +578,8 @@
 Als der letzte Oxyd-Stein leuchtete, br&uuml;llte ich ein lautes
 &quot;Yeah&quot;, was meinen Freund zu der Frage animierte: &quot;Is' was?&quot;
 Ich sagte: &quot;Is' DAS ein geiles Level, das kriegt 'ne 10.&quot; Soweit ich
-mich erinnere, habe ich nur noch an Pleasure Garden und die Passage eine 10
-vergeben. Und alle drei haben sie verdient.</div>
+mich erinnere, habe ich nur noch an &quot;Pleasure Garden&quot; und die
+&quot;Passage&quot; eine 10 vergeben. Und alle drei haben sie verdient.</div>
 
 <div class="author">Gr&uuml;&szlig;e von shoki</div>
 

Modified: homepage/input/output-files.lua
===================================================================
--- homepage/input/output-files.lua	2007-10-01 22:58:49 UTC (rev 892)
+++ homepage/input/output-files.lua	2007-10-02 22:08:19 UTC (rev 893)
@@ -336,18 +336,18 @@
     Ratings_de = "Bewertungen",
     Ratings_ru = "??????",
     Ratings_es = "Clasificaci&oacute;nes",
-    single_level_scores = "single level scores have been registered.",
-    single_level_scores_de = "einzelne Levelscores wurden registriert.",
-    single_level_scores_ru = "??????????? ??????????? ??????? ????????????????.",
+    single_level_scores = "single level scores have been registered",
+    single_level_scores_de = "einzelne Levelscores wurden registriert",
+    single_level_scores_ru = "??????????? ??????????? ??????? ????????????????",
     single_level_scores_es = "Han sido registrados resultados de niveles sueltos",
     single_level_ratings = "single level ratings have been registered with an average of",
     single_level_ratings_de = "einzelne Levelbewertungen wurden registriert, mit einem Durchschnitt von",
     single_level_ratings_ru = "?????? ??????? ???????????????? ?? ??????? ???????",
     single_level_ratings_es = "Han sido registradas clasificaci&oacute;nes de niveles sueltos con promedio de",
-    and_distribution = "and the following distribution:",
-    and_distribution_de = "und der folgenden Verteilung:",
-    and_distribution_ru = "? ????????? ?????????:",
-    and_distribution_es = "y la siguiente distribuci&oacute;n:",
+    and_distribution = "and the following distribution",
+    and_distribution_de = "und der folgenden Verteilung",
+    and_distribution_ru = "? ????????? ?????????",
+    and_distribution_es = "y la siguiente distribuci&oacute;n",
     names_in_use = "Names in use:",
     names_in_use_de = "Vergebene Namen:",
     names_in_use_ru = "??? ???????????? ?????:",



From andreasl at mail.berlios.de  Wed Oct  3 14:12:34 2007
From: andreasl at mail.berlios.de (andreasl at BerliOS)
Date: Wed, 3 Oct 2007 14:12:34 +0200
Subject: [Enigma-game-svn] r894 - homepage/input/lotm
Message-ID: <200710031212.l93CCYaM015049@sheep.berlios.de>

Author: andreasl
Date: 2007-10-03 14:12:33 +0200 (Wed, 03 Oct 2007)
New Revision: 894

Modified:
   homepage/input/lotm/lotm_200710.html
Log:
Homepage:
 - Clifford's proofread of LotM 10/07


Modified: homepage/input/lotm/lotm_200710.html
===================================================================
--- homepage/input/lotm/lotm_200710.html	2007-10-02 22:08:19 UTC (rev 893)
+++ homepage/input/lotm/lotm_200710.html	2007-10-03 12:12:33 UTC (rev 894)
@@ -10,13 +10,13 @@
 by Johannes Laire, Jacob Scott, Raoul Bourquin and Andreas Lochmann
 </h4>
 
-<p>In October our monthly LotM-Excursion to excellent sights of Enigma takes us
-to Quadropolis. Even the sound of the name removes us many centuries back in
-time to mystic ages, back to the birthplace of modern civilization, to ancient
-Greece. Inevitably old epics enter our minds like 'The Iliad' or 'The Odyssey',
+<p>In October our monthly LotM-Excursion to wondrous vistas of Enigma takes us
+to Quadropolis. Even the sound of the name takes us many centuries back in time
+to mythic ages, back to the birthplace of modern civilization, to ancient
+Greece. Inevitably old epics like 'The Iliad' or 'The Odyssey' enter our minds,
 and old heroes like Heracles, Achilles, Odysseus and Perseus, to name just FOUR.
-And of cource the Ancient Gods and their Enigmatic place of residence, the one
-exceedingly excellent and devine level of the ancient world, the Olymp.</p>
+And of course the Ancient Gods and their Enigmatic place of residence, the one
+exceedingly excellent and divine level of the ancient world, Mount Olympus.</p>
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200710_a.png" alt="Level of the month" border="0">
@@ -29,15 +29,15 @@
 a rating of 9.40 at position 1. This is the highest rating ever for a level to
 become LotM.</p>
 
-<p>The two former race leaders and Level-of-the-Year favorites &quot;Island Labyrinth&quot;
-and &quot;The Aztec Temple&quot; changed positions. At least for this month they gave off
-their LotY-chances and slid into the field of chasers. &quot;Island Labyrinth&quot;
-establishes itself with 9.24 points and 8 votes just before &quot;The Aztec Temple&quot;,
-former month's race leader, which accounts 9.13 points and 7 votes. On
-positions 4 and 5, &quot;Labyrinth of Puzzles&quot; (8.92/13) and &quot;Houdini&quot; (8.86/6)
-exchanged their positions. The positions 6 to 8 slightly lost ground. As
-always, you can find more details on the <a href="$$lotm$$">LotM archive
-page</a>.</p>
+<p>The two former race leaders and Level-of-the-Year favorites &quot;Island
+Labyrinth&quot; and &quot;The Aztec Temple&quot; changed positions. At least for
+this month they surrendered their LotY-chances and slid into the pack.
+&quot;Island Labyrinth&quot; established itself with 9.24 points and 8 votes
+just ahead of &quot;The Aztec Temple&quot;, last month's race leader, which
+accounted 9.13 points and 7 votes. In positions 4 and 5, &quot;Labyrinth of
+Puzzles&quot; (8.92/13) and &quot;Houdini&quot; (8.86/6) exchanged their spots.
+positions 6 to 8 slightly lost ground. As always, you can find more details on
+the <a href="$$lotm$$">LotM archive page</a>.</p>
 
 <table cellpadding="0" cellspacing="1" class="statistics">
 <caption class="normalcaption">Some records of August 2007</caption>
@@ -57,31 +57,30 @@
     <td class="left">shoki</td></tr>
 </table>
 
-<p>It seems to become an exciting race for the title of the &quot;Level of the Year&quot;,
-particularly as two more hot candidates wait in secrecy for their chances. I
-don't want to reveal their names, but whoever clicks through each of the levels
-and checks their ratings, will surely find them.</p>
+<p>It is becoming an exciting race for the title of the &quot;Level of the
+Year&quot;, particularly as two more hot candidates wait in secrecy for their
+chances. I don't want to reveal their names, but whoever clicks through each of
+the levels and checks their ratings will surely find them.</p>
 
-<p>But maybe it turns out completely different! Because you are, who decides about
-the Level of the Month, by your votes, and hence about the Level of the Year!
-So, don't forget to rate the levels you played through.</p>
+<p>But the outcome could be a complete surprise! Because it is you, who decides
+the Level of the Month with your votes, and consequently the Level of the Year!
+So don't forget to rate the levels you've played through.</p>
 
 <h4>The journey to Quadropolis leads us to another world</h4>
 
 <p>A breath of Olympic spirit blows through the halls of the sports arena.
-Considering all the sporting ambitions of the promotors of this event, yet as a
-key-note &quot;fair play&quot; is sensible all over this place. Aside from the
-hippodrome all of the rooms are within the bounds of possibility. In the second
-and in the FOURth room the black marble never is in danger to get in a critical
-condition.</p>
+Considering all the sporting ambitions of the promoters of this event, yet the
+sensibility of &quot;fair play&quot; permeates the place. Aside from the
+hippodrome, all of the rooms are within the bounds of possibility. In the second
+and in the FOURth room the black marble is never in serious danger.</p>
 
-<p>Not so long ago Greek mythology had been theme to several authors and
-resulting from it a whole string of levels or strictly speaking a decade is
-included with level pack vi. Names like Troy, Odyssey, Procrustes, Ariadne come
-up in my mind. And of course Zeus, a work by Raoul Bourquin, in which not much
-surprisingly st-flash is all-important. The sky-blue stone with the yellow
-symbol of a lightning flash will be associated with Raoul's Zeus until the end
-of the Age of Enigma.</p> 
+<p>Not so long ago, Greek mythology had been theme for several authors and a
+whole string of levels or strictly speaking a decade (included with level pack
+vi. Names like Troy, Odyssey, Procrustes, Ariadne come up in my mind) resulted
+from it. And of course Zeus, a work by Raoul Bourquin, in which not surprisingly
+st-flash is all-important. The sky-blue stone with the yellow symbol of a
+lightning flash will be associated with Raoul's Zeus until the end of the Age of
+Enigma.</p> 
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200710_e.png" alt="Level of the month" border="0">
@@ -89,23 +88,24 @@
 the knight! This one will be no problem!</div>
 </div>
 
-<p>Most part of these levels have been written by Andreas, well-known to the
-loyal readers as the editor of the LotM-column. As both of them belong to the
-authors of the CEL-project, it is all the more surprising to see Andreas pick up
-the theme of Raoul's Zeus. In an impressing way he demonstrates surprising
-abilities of the flash stone in his room. Andreas will give a detailed
-description of this matter later on. On the other hand Raoul takes up an idea
-from an early work by Andreas, and designs a very special kind of a laser path,
-making use of mirrors, glass-stones and two kinds of push-stones.</p>
+<p>Most part of these levels had been written by Andreas, well-known to the
+loyal readers as the editor of the LotM-column. As both Andreas and Raoul belong
+to the authors of the CEL-project, it is all the more surprising to see Andreas
+pick up the theme of Raoul's Zeus. In an impressive way he demonstrates some
+surprising abilities of the flash stone in his room. Andreas will give a
+detailed description of this matter later on. On the other hand Raoul took up
+an idea from an early work by Andreas, and designed a very special kind of a
+laser path, making use of mirrors, glass-stones and two kinds of
+push-stones.</p>
 
-<h4>March had been a very fruitful month in favour of Enigma:</h4>
+<h4>March had been a very fruitful month for Enigma:</h4>
 
-<p>For the first time the homepage was published besides to English in German
-language as well. It appeared in a completely new designed outfit, and had been
-extended with several new menu items, one of these innovations being the 'Level
-of the Month' column, introducing 'Island Labyrinth' by Jacob Scott as the first
-LotM ever. Being one of the FOUR authors of Quadropolis Jacob already signs in
-for the FOURth time to the list of LotM authors, a really impressing record.</p>
+<p>For the first time the homepage was published in both English and German. It
+appeared in a completely newly designed format, and had been extended with several
+new menu items, one of these innovations being the 'Level of the Month' column,
+introducing 'Island Labyrinth' by Jacob Scott as the first LotM ever. Being one
+of the FOUR authors of Quadropolis Jacob already signs on for the FOURth time to
+the list of LotM authors, a really impressive record.</p>
 
 <p>Also in March, in the evening of the FOURteenth day, it happened that
 illmind, admin of the Enigma-Fan-Forum as everybody knows, announced his idea
@@ -115,24 +115,24 @@
 FOUR hours later the first CEL team consisting of FOUR authors was complete.</p>
 
 <p>And surprisingly fast (guess when!) - (right!) - just FOUR days later, all of
-the FOUR authors had finished off their rooms. So they thought. Another period
+the FOUR authors had finished off their rooms - so they thought. Another period
 followed lasting FOURtytwo days, in which the rooms were thoroughly tested,
 corrected and improved, until finally the 'combined effort level' had been given a
 name: 'Quadropolis'.</p>
 
 <p>FOUR weeks of the FOURth month having passed, this name was suggested by
 illmind on the secret level project channel at mag-heut.net. None of the FOUR
-authors did raise objections, and after the enigmatic forum oracle had agreed to
+authors raised objections, and after the enigmatic forum oracle had agreed to
 this suggestion, the CEL project was assigned a worthy name. Another FOUR weeks
 later Quadropolis was published with Release 1.01 of Enigma within level pack
 (squareroot of FOUR plus FOUR) as number ((FOUR times FOUR) FOUR times plus
 (FOUR times FOUR) minus one).</p>
 
-<p>This mystical number FOUR will have a formative influence on the article in
-the sequel as well. As luck would have it, besides the FOUR authors also FOUR
-players will talk about their experiences with Quadropolis. Given FOUR times as
-much commentators this time compared to last month, i can leisurely lean back
-from now on and simply listen to their words.</p>
+<p>This mystical number FOUR will have a formative influence on the subsequent
+article as well. As luck would have it, besides the FOUR authors
+also FOUR players will talk about their experiences with Quadropolis. Given FOUR
+times as many commentators this time compared to last month, I can leisurely
+step back from now on and simply listen to their words.</p>
 
 <h4>&quot;My favourite things in Enigma are st-chess and st-puzzle&quot;</h4>
 
@@ -146,7 +146,7 @@
 <div class="quote">
 When I read illmind's idea about this project, I really liked it because one
 room is big enough to be interesting but not too big so it shouldn't take long
-to design. So I quickly replied that I want to be one of the authors. It then
+to design. So I quickly replied that I wanted to be one of the authors. It then
 turned out that all others were really good and experienced level authors, and
 it motivated me.
 </div>
@@ -221,7 +221,7 @@
 
 <div class="quote">
 So we did start our work, each of us began to tinker at his own room. I had a
-concept in mind, which i had used before in 'Puzzle Puzzles', but still a bit
+concept in mind, which I had used before in 'Puzzle Puzzles', but still a bit
 variant. The player shall move a push-stone across the whole level (or just the
 whole room). To succeed doing so he will have to clear the path step by step
 until reaching the final puzzle which has to be solved with aid of this stone.
@@ -250,9 +250,9 @@
 
 <div class="quote">
 So a new room had to be done, but for a long time no useful idea occured to me,
-how to build a room, which would go well with the level concept. It had to be an
-alley way and it should not be to difficult. Some day later in the evening I got
-an idea: How about building a laser path! The path should be crossed by the
+how to build a room which would go well with the level concept. It had to be an
+alleyway and it should not be too difficult. Some day later in the evening I got
+an idea: How about building a laser path?! The path should be crossed by the
 laser beam several times and thus being impassable, on the other side the path
 itself should be full of holes and broken.
 </div>
@@ -276,7 +276,7 @@
 
 <div class="quote">
 The main idea for my room emerged way before illmind's call to CEL I. As all so
-often, things develop from quite unexpected ways: In this case, I think it was
+often, things develop in quite unexpected ways: In this case, I think it was
 my work on Enigma's reference manual in June '06. As I collected information
 about Enigma's unique gaming objects, I also took a look at st-flash's code. It
 was quite easy. Each time an actor hits it, it would take its velocity, multiply
@@ -284,8 +284,8 @@
 attention - why &quot;20&quot;? This factor was hardcoded. In contrast to many
 other factors in the game, which could be changed by attribute or global
 variable, this factor was fixed. Probably to a value which fits to the old Oxyd
-games. But an unchangable factor? Wouldn't it be better for st-flash, when this
-number was an attribute instead?
+games. But an unchangable factor? Wouldn't it be better for st-flash if this
+number were an attribute instead?
 </div>
 
 <div class="quote">
@@ -328,11 +328,11 @@
 </div>
 
 <div class="quote">
-One problem I had to solve was the design. I announced quite early that I
-wanted to try Raoul's new st-bigbluesand-stones. Only after that I realized
-that there is rarely a floor that fits to these stones. I didn't want to use
-white tiles, because Raoul already did so in &quot;Zeus&quot;. I finally remembered a
-tip I gave to Ronald, and simply used wood.
+One problem I had to solve was the design. I announced quite early that I wanted
+to try Raoul's new st-bigbluesand-stones. Only after that I realized that there
+is rarely a floor that fits to these stones. I didn't want to use white tiles,
+because Raoul already did so in &quot;Zeus&quot;. I finally remembered a tip I
+gave to Ronald, and simply used wood.
 </div>
 
 <div class="quote">
@@ -398,11 +398,11 @@
 
 <div class="quote">
 Quadropolis as of the levels I've solved so far is my absolute favourite. The
-very concept to have a level built by several authors is great! The independency
-of all rooms from each other resulting from this concept as well. Each of the
-rooms has its individual design and its own basic idea, the sole common ground
-being the vortices connecting the rooms one to another.
-</div>
+very concept to have a level built by several authors is great! The independence
+of each room from the others authors is great! The independency of all rooms
+from each other resulting from this concept as well. Each of the rooms has its
+individual design and its own basic idea, the sole common ground being the
+vortices connecting the rooms one to another. </div>
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200710_j.png" alt="Level of the month" border="0">
@@ -419,16 +419,16 @@
 
 <div class="quote">
 What follows next is some sort of a relaxing room, none the less quite
-interestingly concepted. The third room seems to be quite complicated at the
-beginning, but after taking some time to think it over turns out to be good
+interestingly conceived. The third room seems to be quite complicated at the
+beginning, but after taking some time to think it over turns out to be quite
 solvable. It's a pity that you can use items instead of wooden boxes. The nearly
-complete symmetry of the room and the original concept on the other hand make
-pluses.
+complete symmetry of the room and the original concept on the other hand are
+big plusses.
 </div>
 
 <div class="quote">
-The following room exactly is the opposite of the previous one. At first sight
-it looks a bit boring, but it proves to be a rather nerve-racking challenge -
+The following room is exactly the opposite of the previous one. At first sight
+it looks a bit boring, but it proves to be a rather nerve wracking challenge -
 especially when the white marble has lost all its extra-lifes! And it's quite a
 demonstration of fascinating possibilities of st-flash!
 </div>
@@ -447,15 +447,14 @@
 Seeing the first yellow puzzle I had been gobsmacked. Solving puzzles can end
 up in a situation where you finally have to exchange just two pieces. A task that
 sometimes proves to be harder than you think it should be. But this tiny puzzle
-introduced a new idea to puzzles. It is up to you adding the last piece to the
-puzzle. Of course you can mess up everything by choosing the false point of time.
+introduced a new idea to puzzles. Adding the last piece to the puzzle is up to
+you. Of course you can mess up everything by choosing the incorrect spot.
 But finally I saw the solution - easier than I initially thought, as the puzzles
-has been permuted less than a dozen times. What an entrance to a level!
-</div>
+has been permuted less than a dozen times. What an entrance to a level! </div>
 
 <div class="quote">
 Each of the following chess puzzles proved to be another challenge of its own.
-Finally I reached curiously the vortex that would certainly warp me to the next
+Finally I curiously reached the vortex that would certainly warp me to the next
 challenge.
 </div>
 
@@ -472,25 +471,24 @@
 
 <div class="quote">
 And another world on the next screen. Now a challenging push stone riddle. I 
-just had decided how to move, when I bounced to hard for the metal floor and 
-crashed my marble. Now I had to replay all the puzzles before! I guess a little 
-bit increased friction values on the first and third room would have been a fair 
-move.
-</div>
+had just decided how to move, when I bounced too hard for the metal floor and 
+crashed my marble. Now I had to replay all the previous puzzles! I guess a
+little bit of increased friction values on the first and third room would have
+been a welcome addition.</div>
 
 <div class="quote">
-Finally reaching the fourth room I faced again a totally new task. Controlling
+Finally reaching the fourth room I faced again a totally new task; controlling
 a marble on a catwalk while dealing with distorted forces. I never experimented
 as carefully as on this screen to understand the directions the marble would
-take. Don't let me crash the marble again! What a relief reaching finally the
+take. Don't let me crash the marble again! What a relief finally reaching the
 oxyds.
 </div>
 
 <div class="quote">
-Congratulations to all four authors. Definitly everyone did gave his best ideas
-for this project. Even though the level misses a storyboard that glues the rooms
-together in more than a linear fassion the sum of new ideas and puzzles is
-overwhelming. Let us hope that more combined effort level will follow.
+Congratulations to all four authors. Everyone definitely gave his best ideas for
+this project. Even though the level misses a storyboard that glues the rooms
+together in more than a linear fashion the sum of new ideas and puzzles is
+overwhelming. Let us hope that more combined effort levels will follow.
 </div>
 <div class="author">Ronald</div>
 
@@ -525,13 +523,13 @@
 </div>
 
 <div class="quote">
-For what reasons ever, I was firmly convinced to reach the oxyds, when I had
+For some reason, I was firmly convinced I would reach the oxyds, when I had
 opened all the doors to the tunnel; after all, there had been enough to be done
 in this room.
 </div>
 
 <div class="quote">
-All the more I was astonished to enter a second room, which on first sight held
+I was all the more astonished to enter a second room, which on first sight held
 no barriers at all .........
 <br>
 .............. except for the fact, that the tunnel closed after two or three
@@ -607,7 +605,7 @@
 <div class="quote">
 Raoul has gone for Modernism.  Lasers and metal over an abyss - I hear a pulsing
 drum propelling the music along. I initially solved it using sunglasses, but
-that is totally not necessary. If you think carefully, you can manage it without
+that is totally unnecessary. If you think carefully, you can manage it without
 any extra help.
 </div>
 
@@ -627,8 +625,8 @@
 <p>
 As the final words of Taztunes still sound, I want to reunite the harmonies of
 the Quadropolis' FOUR authors and FOUR friends and join them in a final and
-concluding choir of joy: &quot;CEL-I was a great event! And the journey to
-Quadropolis really paid off!&quot; There's nothing else for it but to wish, that
+concluding chorale of joy: &quot;CEL-I was a great event! And the journey to
+Quadropolis really paid off!&quot; There's nothing else for it but to wish that
 the success of Quadropolis gives new impulses to the second CEL project. </p>
 
 <p>Greets,<br/>



From ged at mail.berlios.de  Fri Oct  5 21:41:38 2007
From: ged at mail.berlios.de (ged at mail.berlios.de)
Date: Fri, 5 Oct 2007 21:41:38 +0200
Subject: [Enigma-game-svn] r895 - in homepage/input: . lotm
Message-ID: <200710051941.l95JfcuW030257@sheep.berlios.de>

Author: ged
Date: 2007-10-05 21:41:29 +0200 (Fri, 05 Oct 2007)
New Revision: 895

Added:
   homepage/input/lotm/lotm_200710_ru.html
   homepage/input/support_ru.html
   homepage/input/testimonials_ru.html
Modified:
   homepage/input/bottombar_ru.html
   homepage/input/credits_ru.html
   homepage/input/development_ru.html
   homepage/input/infobox_ru.html
   homepage/input/lotm/lotm_200703_ru.html
   homepage/input/lotm/lotm_200709_ru.html
Log:
Homepage: proofreading of previous Russian LotM, added support_ru and lotm_200710_ru

Modified: homepage/input/bottombar_ru.html
===================================================================
--- homepage/input/bottombar_ru.html	2007-10-03 12:12:33 UTC (rev 894)
+++ homepage/input/bottombar_ru.html	2007-10-05 19:41:29 UTC (rev 895)
@@ -1,4 +1,4 @@
-    <p>Copyright &copy; 2003 -2007 by  <a href="$$credits$$">Daniel Heck and contributors</a>.
+    <p>Copyright &copy; 2003 - 2007 by <a href="$$credits$$">Daniel Heck and contributors</a>.
     ??? ????????? ?????????? ???????? ?? ????????
     <a href="http://creativecommons.org/licenses/sa/1.0/">Creative Commons License</a>.<br>
-    ?????? ????????: $Revision$, ????????? ??????????: $Date$ .</p>
+    ?????? ????????: $Revision$ , ????????? ??????????: $Date$ .</p>

Modified: homepage/input/credits_ru.html
===================================================================
--- homepage/input/credits_ru.html	2007-10-03 12:12:33 UTC (rev 894)
+++ homepage/input/credits_ru.html	2007-10-05 19:41:29 UTC (rev 895)
@@ -1,6 +1,6 @@
 <div class="credits">
     <h2>?????????????</h2>
-    <p>???? ??????? ?????? Enigma ?????.</p>
+    <p>????, ??????? ?????? Enigma ?????.</p>
 
     <h3>??????? ????????????:</h3>
     <table>

Modified: homepage/input/development_ru.html
===================================================================
--- homepage/input/development_ru.html	2007-10-03 12:12:33 UTC (rev 894)
+++ homepage/input/development_ru.html	2007-10-05 19:41:29 UTC (rev 895)
@@ -7,8 +7,8 @@
 <ul>
   <li><a href="$$development$$#maillist">?????? ???????? ?????????????</a> - ??????? ???????.</li>
   <li><a href="$$development$$#tasks">??????? ?????? ? ?????????</a> - ???????????? ???? ?????????.</li>
-  <li><a href="$$development$$#level">?????????? ???????</a> - ???????? ? ??????.</li>
-  <li><a href="$$development$$#app">?????????? ?????????</a> - ???????? ? ??????.</li>
+  <li><a href="$$development$$#level">?????????? ???????</a> - ???????? ? ??????.</li>
+  <li><a href="$$development$$#app">?????????? ?????????</a> - ???????? ? ??????.</li>
 </ul>
 
 <h3><a class="arrowup" href="$$development$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
@@ -22,7 +22,7 @@
 
   <p>?????????? ????????, ??? ??? ??? ?????? ????????????? ????????????????, ?? ??? ????????? ? ????????
   ?????? ???? ???????? ?? ?????????? ?????. ???? ??? ????? ?????????? ????? ? ??????
-  ?????????, ??? ?????? ?? ????????? ????????? ??????????? ???????? ??? ???????? ? 300 ??.
+  ?????????, ??? ?? ?????? ?? ????????? ????????? ??????????? ???????? ??? ???????? ? 300 ??.
   ?????????, ?????? ??????? ?????? ?? ????? ???????!</p>
 
 <h3><a class="arrowup" href="$$development$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
@@ -32,10 +32,10 @@
   ???? ??? ??? ?????? ???? ???????. ????? ? ??? ??? ??????? ??? ???????, ????? ??????? ?? ???.
   ??? ?????? ??????? ?????, ??????? ?? ????? ????? ?????? ? ????? ???????.
   ???? ? ??? ???? ??????????? ?????? ? ??????? ?????????? ???????, ?????????? ?????????
-  ??? ??? ??? ?? ?????? ??? ??????.</p>
+  ??? ???, ??? ?? ?????? ??? ??????.</p>
 
   <div class="tasks">
-  <h4>?? ??????????????? ??????</h4>
+  <h4>????????????????? ??????</h4>
   <ul>
   <li><b>???????</b>. ? Enigma ???? ????????? ????????? ??????, ???????? ?? ???????????.
       ???? ?? ?????? ???????????? Enigma ??? ?????? ??????? ?????, ?????????
@@ -43,7 +43,7 @@
       ???? ????????????? ???????, ?????????? ????????? ? ????.
       <div class="diff">??????</div></li>
 
-  <li><b>????????? ???????</b>. ??? ?? ?????? ????????, ? ????????? ????? ?? ?????????? ?????????? ? ??????? ??????????.
+  <li><b>????????? ???????</b>. ??? ?? ?????? ????????, ? ????????? ????? ?? ?????????? ????????? ? ??????? ??????????.
       ???? ? ??? ?????? ?????? ??????, ?? ????? ??????????? ???? ???????? ???? ???????, ???????? ? ??????
       ??????????? ?? ????? ???????????????.
       <div class="diff">??????</div></li>
@@ -105,8 +105,8 @@
       ??? ??????? ????? ? ? ????? ?? ??? ?????.
       <div class="diff">??????-??????</div></li>
 
-  <li><b>??????? ????</b>. ??? ???????? ? ????????? ????, ??? ??? Enigma
-      ? ?????? ?????? ?? ??????????????? ??? ???????? ?????? ????.
+  <li><b>??????? ????</b>. ??? ???????? ? ????????? ???????, ??? ??? Enigma
+      ?????????? ?? ??????????????? ??? ???????? ?????? ????.
       ??????? ???????? ?????? - ?????????? ??????????????. ???? ?? ?????? ?????????? ? ??? ????????
       ???????? ? ???????? ????? C++ ???? Enigma, ?? ? ???????? ?????? ??? ? ???? ???????.
       <div class="diff">??????</div></li>
@@ -120,22 +120,22 @@
 <h3><a class="arrowup" href="$$development$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
   <a name="level">?????????? ???????</a></h3>
 
-  <p>???? Enigma ? ?? ???????? ? ???? ???????? ??????? ? ?? ?????? ???????? ?
+  <p>???? Enigma ? ?? ???????? ? ???? ???????? ??????? ? ??? ???????? ???????? ?
   ??????? ????? ???????? Lua, ?????????? ??????? ?????, ??? ??? ???????.
   </p>
 
   <p><a href="$$refman$$">?????????? ???????????</a> Enigma ???????? ????????? ?????? ???????
-  ? ???? ????????, ??????? ?? ?????? ????????????. ??? ????? ???? ?? ??????????? ??????????? ??????? ??
+  ? ???? ????????, ??????? ?? ?????? ????????????. ??? ????? ???? ?? ??????????? ??????? ??
   ?????? 1 - 3 ? ???????, ??? ?? ?????? ?????? ????????? ???????? ??????? ???????.<p>
 
   <p>??? ????? ????????????? ? ? ???????? ????????????? ??????? ? ??????????? ???????, ?? 
-  ?????? ????????? ?? <a href="$$wiki$$">wiki ? ?????????? ???????</a>. ?? ??????????????? ???????? ?? 
+  ?????? ????????? ?? <a href="$$wiki$$">wiki ? ?????????? ???????</a>. ?? ????????????? ???????? ?? 
   ????? ????? ???????????? ???????? ? ????????????? ??? ???????????? ????? ????
   ??? ?????? ????? ?????.</p>
 
-  <p>?? ?????? ???????? ?????? ? <a href="$$development$$#maillist">?????? ???????? ?????????????
-  </a> ??? ?? ??? ? ?? <a href="http://www.mag-heut.net">??????</a>.
-  ??? ?????? ?? ??????, ??? ??? ??????? ?????, ????????? ??????? XML ??????
+  <p>?????? ?? ?????? ???????? ??? ? <a href="$$development$$#maillist">?????? ???????? ?????????????</a>,
+  ??? ? ?? <a href="http://www.mag-heut.net">??????</a>.
+  ??? ?????? ?? ??????, ??? ??? ??????? ?????, ????????? XML-??????? ??????
   'status' ?? 'stable' ? ??????????? ??????? ?
   ?????? ???????? ?/??? ?? ??????. ???????????? ???????? ? ??????????????? ??? ???????.
   ???? ? ????? ?????? ?? ????? ??????? ?????? ? ?? ????????? ???????, ??
@@ -146,7 +146,7 @@
 <h3><a class="arrowup" href="$$development$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
   <a name="app">?????????? ??????????</a></h3>
 
-  <p>???? ?? ?????? ??????? ????? ????????? ?????? Enigma ???  ????? ?????????
+  <p>???? ?? ?????? ??????? ????? ????????? ?????? Enigma, ??? ????? ?????????
   ?? ?? ????? <a href="https://developer.berlios.de/svn/?group_id=3972">
   ??????????? ???????? ????? ?? Berlios</a>. ????? ???????? ????????? ??????, ??????
   ????? ???????</p>
@@ -178,5 +178,4 @@
   <pre>doc/README.mingw32</pre>
 
   <p>???? ??? ????? ?????? ?? ?????? ? ???????????, ?????????? ????????? ? ???? ????? 
-  <a href="$$development$$#maillist">?????? ????????</a>
-  .</p>
+  <a href="$$development$$#maillist">?????? ????????</a>.</p>

Modified: homepage/input/infobox_ru.html
===================================================================
--- homepage/input/infobox_ru.html	2007-10-03 12:12:33 UTC (rev 894)
+++ homepage/input/infobox_ru.html	2007-10-05 19:41:29 UTC (rev 895)
@@ -1,7 +1,8 @@
     <div class="infobody">
        <div class="info">
-         <h3>100 000 ????????</h3>
-         Enigma ?????? 1.01 ? ????????? ?????? ??? ???? ??????? 100 000 ???.
+         <h3>????? 10 000 ?????? ???????</h3>
+         ? ???? ?????? ?? ???????? ??????? ? 10 000 ?????? ???????. ??????? ???? ???????? ???????,
+         ??????? ????????? ???? ??????!
          <h3>??????? ??????</h3>
          <a href="$$lotm_current$$"><img src="$$lotm_current_image$$"
          alt="$$lotm_expansion$$" border="0"></a>

Modified: homepage/input/lotm/lotm_200703_ru.html
===================================================================
--- homepage/input/lotm/lotm_200703_ru.html	2007-10-03 12:12:33 UTC (rev 894)
+++ homepage/input/lotm/lotm_200703_ru.html	2007-10-05 19:41:29 UTC (rev 895)
@@ -8,19 +8,19 @@
 
   <h3 class="lotm">
     <span class="date">???? 2007: </span>
-    &quot;Island Labyrinth&quot; by Jacob Scott
+    &quot;Island Labyrinth&quot; ?? Jacob Scott
   </h3>
 
   <p><img class="leftimage" src="$$imagedir$$/lotm/lotm_200703_a.png" alt="Level of the month" align="left">
   ????? ? ??? ?????????? ? ???? ?????????????? ???????????</p>
 
   <p>??????????? ???????, ? ??????? ???? ?????&nbsp;V ??? ????????? ???????: ??? ?? 
-  &quot;Island Labyrinth&quot;! ? ??? ???????? ?????? ??????? ????????? 
-  ???????????? ? ??? ????? ????????? ?? ????, ??????? ?? ?????? ???????? ???? -- ????,
+  &quot;Island Labyrinth&quot;! ? ???????? ?????? ???? ??????? ????????? 
+  ???????????? ? ??? ?? ????? ????????? ?? ????, ??????? ?? ?????? ???????? ???? -- ????,
   ??? ?????? ???? ??????? ????? ???????????</p>
 
-  <p>???????? ?????? ??????????? ?? ???????, ???????????? ??????? Jacob Scott
-  ??????? ??????????? ????????????? ?????? ?? ???? ????????? 10 ? ????? ??????????? 7,
+  <p>???????? ?????? ???????????? ???????????, ???????????? ??????? Jacob Scott
+  ??????? ??????????? ??????? ?????? ?? ???? ????????? 10 ? ????? ??????????? 7,
   ??????????? ?? <b>9.25</b>. ?? ???? ?????? ??????? ? ????? ??? ????? ??????? ?? ???????? 
   ??????? ????????. ??????? &quot;Island Labyrinth&quot;
   ? ???? ?????? ????????? ????.</p>
@@ -33,7 +33,7 @@
   ??????????? ????? ??????, ???????????? ? ????? ?? ????????.
   ????? ?? ??? ?????, ??? ?????????? ??????, ??????? ????? ? ??? ? ????? ??????. 
   ??? ???????, ??????? ????????? ??????????. ?? ?????????? ? ???? ????, ? ??????? ?? ??????????.
-  ??? ?? ????? ???? ???????? ????? ?????? ? ????????? ??????? ? 
+  ??? ???????? ????? ?????? ? ????????? ??????? ? 
   Enigma ? Oxyd ???? ??? ????? ????????, Island
   Labyrinth ???? ?? ???.
   </p><p class="author">Alejandro Lacava</p>
@@ -56,12 +56,12 @@
   ?? ???? ?????? ?? ??????? ??????????? ?????? ??????? ??????. ?? ????? ???? ????, ??? ?????? ?????? ??????????? 
   ?? ????? ????????????? ??????. &quot;Island Labyrinth&quot; ??? ??????? ? ????????????? 
   ????????? ????????????? ?????????????? ? ???????? ?????????. ???? ???? ??? ?? ???????? ???? 
-  ? ?????? ???????, ??? ?????????? ??? ?????, ?????? ??? ???????? ????????????? ???? ?????????????
+  ? ?????? ???????, ??? ?????????? ??? ?????, ?????? ??? ???????? ?? ??????????
   ? ?????????. ??? ????? ???????????? ? ??? ?? ?????? ??? ?????????? ??????????? ???????.
-  ?? ???? ?????????? ??? ???????????? ??????? ?? ????????? ???????????? ???????? ??? ?????????? ?????????, ??????? ??? ????? ????????. 
-  ? ????? ??? ? ?????????? ? ?????????? ?? ??????? ???? ? ???? ?????? ????? ?????? ??? ??????? ??????? ??? ??????. 
+  ?? ???? ?????????? ??? ???????????? ??????? ?? ????????? ???????????? ???????? ??? ?????? ?????????? ?? ??? ?????????. 
+  ? ?????, ??? ??? ??????? ??????? ??? ?????? ? ?? ??????? ???? ?????? ?????????? ? ?????????? ? ???? ??????. 
   ?? ?????? ????? ????? ???? ?????? ????? ??????????? ??? ????????? ????????????? ? ?????????,
-  ? ???????? ?? ?????? ???? ?? ???????. ??? ???????, ??? ? ???? ?????? ???? ????????? ??? Enigma. 
+  ? ???????? ?? ?????? ???? ?? ???????. ??? ???????, ??? ? ???? ?????? ????????? ??? Enigma. 
   ??? ????????????? ? ???????????? Jacob.</p>
   <p class="author">Ronald Lamprecht</p>
 
@@ -76,15 +76,15 @@
   ? ???? ????? ??????? ?????&quot;</h4>
 
   <p class="quote">
-  ??? ???? ?? ???? ?????????? ??????? ??????? Enigma.  ? ????? ??????????? ???? ??????? ????????????????.
-  ???? ?? ????, ??????? ???????????
+  ??? ???? ?? ???? ?????????? ??????? ??????? Enigma. ? ????? ??????????? ???? ??????? ????????????????.
+  ????-??????, ??????? ???????????
   ???????? ???????????, ????? ????? ????????? ??? ?????????????? ?????????.
   ??, ??? ?? ??????? ?????? ??????? ???? ? ???? ????? (??? ? ? ????????? ?????).
   ??? ?? ?? ?????????, ? ??????? ?? ????????? ????-?? ???????.
   ????? ???? ?????????, ?? ? ??? ?????????? ???????, ????? ????????????? ? ??????? ? ????.
   ? ???-?? ???? ? ???? ??????? ???????????? ????????? ??????? ?????
   ? ???? ????? ??????? ?????. ???????? ?????? - ?????????
-  ??? ????????????? ????????. ? ?????? ?????? ? ??? ???????? ? ???????-?????? ????.
+  ??? ????????????? ????????. ? ???????-?????? ???? ? ????? ?? ?????? ? ??????????????.
   ?????????? ??????, ??????? ????? ???????, ? ??????? ?? ???? ?????? ?? ??? ???.
   ???? ?? ?? ?? ?????. ????? ?? ??????? ??? ???????? ???????????? ? &quot;Island  Labyrinth&quot;.
   ??? ???????? ?? ??????? ?????? ????? ??????? ???????, ??? ????.
@@ -92,13 +92,13 @@
 
   <p>? ????????? ???????? ? Taztunes: ???? ?? ????? ?????????????? ????????????? ????? ??????
   ?????????????? ????????????? ???????? Jacob'?. ???? ???-?? 
-  ??????????? ?????? ????????? ??????-????? ?????????? ????????, ?????? ????? ????? ???????? ?????? ?? 
+  ??????????? ?????? ????????? ??????-????? ?????????? ????????, ?????? ?? ????? ???????? ?????? ?? 
   ?????? ?????? ???? ??????, ????. Jacob ??????????? ???
   ????????? ??????, ? &quot;Blocks and Water&quot;, ?? ? 
-  &quot;Island Labyrinth&quot; ?? ?????? ????????????. ??? ?????? ?? ???????.
+  &quot;Island Labyrinth&quot; ?? ?????? ????????????. ??? ??? ?????? ????.
   ?????????? ????? ?????????????? ????????, ???????? ???????? ??????, ??????? ?????? ??????? ??????????? ?
   ???? ???????, ?????????? ???????/??????? ? ???? ?? ???,
-  ??????? ?????????? ?? ????? ???? ? ??????? ???????.
+  ??????? ? ??????? ??????? ?????????? ?? ????? ????.
   </p>
 
   <p>&quot;Island Labyrinth&quot; ??? ????????? ??????? Jacob'?, ????????? ??? 
@@ -111,16 +111,16 @@
 
   <p>??? ??? ?????? ?????????? &quot;Island Labyrinth&quot; ? ????? ??????? ???????? Jacob'?,
   ?? ?????? ??????? ?????????? ????????????? ??????????????? ? &quot;Labyrinth of
-  Puzzles&quot;. ?? ??????????? ??????? ???? ????? ????????? ??????? ??????????? ? 
+  Puzzles&quot;. ?? ?????????? ??????? ???? ??????????? ????????? ??????? ??????????? ? 
   ???? ??????? ????????, ? ??? ????????? ??????? Jacob'? ??? Enigma 0.81. ??? ??????????? ??????
   Jacob'? ?? &quot;Island Labyrinth&quot;:</p>
 
   <p class="quote">
   ??? ???????? &quot;Island Labyrinth&quot;, ? ???????? ??? ? ????? ??????? 100-?? ??????
   ?? Oxyd -- ??????? ?????????, ??????? ???????? ? ???? ????????? ????????? ?????????
-  ? ???????, ?? ?? ???????????, ???????????. ?????? ? ??????? ??????? ??? ? 
+  ? ???????, ?? ??????? ???????, ???????????. ?????? ? ??????? ??????? ??? ? 
   &quot;Labyrinth of Puzzles&quot;, ?? ???????? ????? ?????? ? ????
-  (?? ?????? ???? ??? ??? ???????) ? ???? ?? ?????????? ?????????
+  (?? ?????? ???? ??? ??? ???????) ? ?? ??????? ?????????
   ????? ???????????. ? &quot;Island Labyrinth&quot; ? ??????? ??????????? ???????????,
   ??????? ?????? ??????????? ? ???????? ?????? (????? ? ????,
   ??????, ???????????? ?????) ? ??????? ? ????? ???????????????? ????????.
@@ -133,7 +133,7 @@
   -- ? ????????? ??? ????? ????? ?????? ??? ????? ??????. ?? ??? ??? ?? ??? ??????, ??? 
   ????????? ?????? 100-? ?????? ? ?????? ? ?????? ?????,
   ?? ?? ?????? ?????? ??? ???????? ??? ????? ??????? ?????? ??????????? ???????. ?,
-  ?? ??????? ???? ???? ?????? ?? ????????, ???????, ??? ????? ??????, ?? ?????????? ????????????? ? ?????????? Enigma.
+  ?? ??????? ???? ???? ?????? ?? ????????, ???????, ????? ?????? ??, ??? ?? ?????????? ????????????? ? ?????????? Enigma.
   ????? ??? ??????? ? ????? ?????? ???????? ?????!</p>
   <p class="author">Jacob Scott</p>
 

Modified: homepage/input/lotm/lotm_200709_ru.html
===================================================================
--- homepage/input/lotm/lotm_200709_ru.html	2007-10-03 12:12:33 UTC (rev 894)
+++ homepage/input/lotm/lotm_200709_ru.html	2007-10-05 19:41:29 UTC (rev 895)
@@ -6,10 +6,10 @@
     &quot;Tool Time&quot; ?? Barry ? Lori Mead
   </h3>
 
-  <p>?? ?????? ?? ????? ?? ? ????? ????????????? ??????, ??? ???????? ??????????? ??????? ?????? ?????? ?? ???,
-  ??????? ???? ????? ?? ?????? ????? ? ???? ??? ??????????? ??????,
-  ????????? ???????????? ?????? oxyd ????? ???? ? ????????
-  ??????; ? ?????? ???? ?????? ?????? ??? ??? ??????? ????: &quot;???? ? ???????
+  <p>??? ??? ???????? ?? ? ????? ????????????? ??????, ??? ???????? ???????? ?????? ?????? ?? ???,
+  ??????? ???? ????? ?? ?????? ????? ? ????,
+  ????????? ???????? ????????? ?????? oxyd ????? ???? ? ????????
+  ???????; ? ??? ????????? ?????? ???? ??????: &quot;???? ? ???????
   ????????&quot; ??, ??? &quot;Tool Time&quot;!</p>
 
   <div class="lotmpic">
@@ -95,18 +95,18 @@
         <td class="left">biotopa</td></tr>
   </table>
   
-  <p>?? ????? ?????? ? ???? 13 ????????????? ????????????? ?? &quot;Tool Time&quot,
+  <p>?? ????? ?????? ? ???? 13 ????????????? ????????????? ?? &quot;Tool Time&quot,
   ? ??????? <b>8.46</b>, ??? ?????????? &quot;Tool Time&quot; 6 ?????
-  ? ????? <a href="$$lotm$$">???????? ????</a>, ?? ????? ? 
-  &quot;Elaborate&quot;, ??????? ??????? ???? ???????????? ????????? ??? &quot;Labyrinth of
-  Puzzles&quot; ?? ????????? ??? ??????. ? ?????? ????????????? ???????? ????????:
+  ? ????? <a href="$$lotm$$">???????? ????</a>, ??????? ? 
+  &quot;Elaborate&quot;, ??????? ?? ????????? ??? ?????? ??????? ???? ???????????? ????????? ??? &quot;Labyrinth of
+  Puzzles&quot;. ? ?????? ????????????? ???????? ????????:
   ????? ????????????? ?????????? ?? ?????? ????? ????? &quot;Island Labyrinth&quot;,
-  &quot;The Aztec Temple&quot; ?????? ????? ??????????? ??????, ? ?????? ????? ???????????: 
-  9.17 ?????? 9.13!</p>
+  &quot;The Aztec Temple&quot; ????? ??????????? ??????, ? ?????? ????? ?????????????: 
+  9.17 ? 9.13!</p>
   
   <h4>&quot;???? ??????? ??????????, ??? ???????? ??????????? ????????????&quot;</h4>
   
-  <p>? ?????????, ? ???? ?????? ?????? ???? ?? ???? ???????, ??????? ?? ????????? 
+  <p>? ?????????, ? ???? ?????? ?????? ???? ?? ???? ???????, ??????? ?? ????????? 
   ???????? ???????????, ?????????? ?? ???? ???????????; ????????? ????? ???????, 
   ??? ? ???? ??? ???????. ??-?? ????, ??? ??? ?? ?????????? ??????? ????????? 
   ????????? ???????? ???? ?????? (? ?? ?? ????, ??????), ?????? ????? ??????
@@ -114,7 +114,7 @@
   ???, ??????? ?? ??? ???????????, ?? ??? ??, Harry?</p>
   
   <p><i>?????, Andreas, ?????? ? ????????? ?? ? &quot;Houdini&quot;
-  ?????????? ???? ???????? ??????? ???, ?? ????? ?? ??????? ????? ? ????? ?????? ? ?????????????
+  ?????????? ???? ???????? ??????? ???, ?? ????? ?? ??????? ????? ? ????? ?????? ? ?????????????
   ??????? Enigma ?????? ?????? ? ??????? ????? ??????? ??? ??? ???
   ?? ??????? ?????? ?????? ??????? &quot;Tool Time&quot; ???
   ??? ????? ??????? ????????? ?????????? ???????. ??? ?? ?? ????????, Andreas? ?????? ??
@@ -124,7 +124,7 @@
   &quot;Tool Time&quot;, ????????? ????????????? ??????? ?????? ?????????. ?? ?? ????? ????,
   ????? ??????? ?????? ??? ????, ??????????? ??? ????????????? ?????? ????? ????????? ?????.
   ?, ?????? ???????? ?? ??? ????????????? ?????, Andreas(??. ???????? ? ?????????? ???????? ??????, 
-  ? ????????? ????????? ????? ? ???????? ?? ???????)! ???? ?? ???????, ??? ? ??????????
+  ? ????????? ????????? ????? ? ???????? ?? ???????)! ???? ?? ???????, ??? ? ??????????
   ??????? ???????</i></p>
 
   <div class="lotmpic">
@@ -146,40 +146,40 @@
   &quot;Tool Time&quot;?. ??????? ?? ???? ????? ??? ????? ????????? ?????????? st-rock1 ? fl-black,
   ??????? ??????? ?????? ??????? ???????? ?? ?????????? ????? ???????
   ?????????????, ?????? ??????? ???????? ????????? ??? ?????????? ?????? ? ????
-  ? ?? ????? ?????? ?????? ?????! ???? ??? ???????????? ?? ????? ???????, ???????? ????????? ? ???? ?????? Grep,
+  ? ?? ????? ?????? ?????? ?????! ???? ??? ???????????? ?? ????? ???????, ????????? ????????? ? ???? ?????? Grep,
   ???? ????????? ????? Barry & Lori Mead
-  ??????? ??????????????? ???? ?????????? ??????/???????????? ? ?????? ???? ?? ???????
-  ??? ??????????? Mead-??????????. ???? ???, Andreas? </i></p>
+  ??????? ??????????????? ???? ?????????? ??????/???????????? ? ?????? ???? ?? ??????? ???????
+  ??? ?????????? Mead-??????????. ???? ???, Andreas? </i></p>
   
   <p>? ????? ??, Harry. ? &quot;Tool Time&quot; ?????? ? ??? ????? ?????????:
-  ??? ??? ?????? ??????? ??????, ??????? ??????????????? ?????????? ?????
-  ?????????? ????????. ??? ?? ???????? ?????? - ?????? ???????????????? ????????????,
-  ?? ???????? ???????? ??? ???????????. ??? ???????? ?????????????, ???????? ?? 
+  ??? ??? ?????? ??????? ??????, ? ??????? ????? ????????? ??????
+  ?????????? ???????. ??? ?? ?????? ??????? - ?????? ???????????????? ????????????,
+  ?? ???????? ???????? ??? ???????????. ??? ???????? ?????????????, ????????? ?? 
   ???????????????? - ?????? ?????????????? ?????? ????? ??????, ? ??????? ????? 
   ???????????? ??? ??????????. ?????? ???????? ?? ???:</p>
 
   <div class="quote">
-  ? ?????? ??????? ?????? ????????????? ? ????????? ????????????? ?????????. ?????? ????????? ???????
+  ? ?????? ??????? ?????? ????????????? ? ????????? ????????????? ?????????. ?????? ??????? ??-???????
   ???????????? ? ??????, ? ???? ??????? ??????????, ??? ???????? ??????????? ????????????
-  ?? ????????? ?????????, ??? ????? ??? ?????? ????????? ? ????????????.</div>
+  ?? ?????? ?????????, ??? ????? ??? ?????? ????????? ? ????????????.</div>
 
   <div class="quote">
   ? ????? ?????????????, ????? ?????????? ??? ??????. ? ???? 
   ???? ????????? ???????, ?????? ????????????? ?????????????? ???????, ????? ??????? ????? 
   ?????? ? ?????? ??????? ???? ? ??????? oxyd, ????? ????? ????
-  ??????, ????????? ? ?????? ?????? ????? ????? ????????? ??????? -
+  ??????, ????????? ? ?????? ?????? ????? ????? ????????? ???????? ??????? -
   ?????? ??? ????, ????? ??????? ????????, ??? ???? ????? ??????? ????, ??? ??? ??? ? ??? ?????.</div>
   <div class="author">Mark Pulley</div>
 
-  <p><i> ???? ?????? ? ????? ?????? ?????? ????????, ?? ????? ???????? ?? ????? ? ???
+  <p><i> ???? ? ????? ?????? ??????? ????????, ?? ????? ???????? ?? ????? ? ???
   ??? ???????? ?? ????? ??????? ??????? ????? Binford 6100. ??????????? ?????
   ? ?????? ?????? ??????? ????? ? ????? ????????????! ????? ?? ??????? ?????????? ??????????,
-  ??? ??????? ??????? Julie ?? Yorkshire, ?? ? ???? ????????, Andreas?</i>
+  ??? ??????? ??????? Julie ?? ????????, ?? ? ???? ????????, Andreas?</i>
 
   <p>? ??? ?? ?????, Harry. ????? ???????? ????? 1-?? ????. ???? ?? ??? ???? 3-?? ????, ??? ?? 
-  ?????????. ?? Mark ??????? ?????? ?????? ????.</p>
+  ?????????. ?? Mark ?????? ?????? ????.</p>
 
-  <h4>&quot;?? ??????? ????????? ???????, ??????? ???? ?? ??????????? ?????????
+  <h4>&quot;?? ????????? ????????? ???????, ??????? ???? ?? ??????? ?????
   ??????&quot;</h4>
 
   <p>Barry ? Lori - ???? ?? ????? ????????? ??????? ? ? ????? ???, ???
@@ -190,17 +190,17 @@
   ? ???????? ???? ? ??? ???? ????????? ?? ??? ??? ???? ? ???. ????? Lori
   ???????? ????, ?? ????? ?????? ? ???????????? ???? ? ?? ????? ?????? ????,
   ? ??????? ???? ??????? ???????????. ? ???????????? ? Enigma, ????? ???? ?
-  google &quot;Puzzle Games&quot; ? ?? ?????? ?????? ?? ???????.</div>
+  google &quot;Puzzle Games&quot; ? ?? ?????? ??????.</div>
 
   <div class="quote">
   ????? ????, ??? ?? ?????? ????? 95% ???????, ?? ?????? ???????? ????? 
   ?????? ??? ???????? ? ? ????? ???? ???????? ????????? ? 
   &quot;????-?-???&quot;. ?? ????????, ??? &quot;???&quot; ????????
-  ??????????, ??????? ?????????? ??? ??????????? ? ??????. ??? ?? ???????? ??????????, ??????? ?????????? ???
+  ???????????, ??????? ?????????? ??? ??????????? ? ??????. ??? ?? ???????? ???????????, ??????? ?????????? ???
   ????? ??? ????? ??????????.</div>
 
   <div class="quote">
-  ? 25 ??? ??????? ??????? ????????? ?? ???????????/???????????? ???????????, ??????? 
+  ? 25 ??? ??????? ??????? ????????? ?? ???????????/???????????? ???????????, ??????? 
   ???? ????????? ??????? Enigma ?? ??? ??? ???? ???????, ? ??? ????
   Lori ?????????? ??????????? ??????????? ???????? ?????? ????????, ? ????????? ?????? ???????????.</div>
 
@@ -213,7 +213,7 @@
   ???????????? ????, ??????? ?? ??????? ?????? ?? ?????? ?? ? ????? ??????, ???????? ? ???
   ??? ? ??? ???? &quot;????&quot; ????????????, ????? ????????? ?? ???????, ? ???????
   ?? ??????. ?? ?????????????? ????????? ???????, ?????????
-  &quot;? ???, ? ???????&quot;, ????? ????????, ? ??? ??? ??????????? ???????
+  &quot;? ???, ? ???????&quot;, ????? ????????, ? ??? ???? ?????? ?????
   ??????.</div>
 
   <div class="quote">
@@ -223,7 +223,7 @@
   ????? ??????&quot;.</div>
 
   <div class="quote"> ????? ?? ??????? ?? ??????, ????? ???-?? ?????? ???????? ??? ????????? 
-  ????????? ???????, ??? ?? ?????? ???????????? ?????????? ????????, ????? ????? ???????.</div>
+  ????????? ???????, ??? ?? ?????? ????????? ?????????? ????????, ????? ????? ???????.</div>
 
   <div class="quote"> ? ????? ?? ???????? ????? ?????? ??? ????????? ???? ???? ?? ???? ???????
   ?????? 0.82, ??????????? ? ??????? ? ????????????.</div>

Added: homepage/input/lotm/lotm_200710_ru.html
===================================================================
--- homepage/input/lotm/lotm_200710_ru.html	2007-10-03 12:12:33 UTC (rev 894)
+++ homepage/input/lotm/lotm_200710_ru.html	2007-10-05 19:41:29 UTC (rev 895)
@@ -0,0 +1,604 @@
+<div class="lotm">
+$$lotm_header$$
+
+<h3 class="lotm">
+<span class="date">??????? 2007: </span>
+&quot;Quadropolis&quot;, ????????? ????????? ??????? I
+</h3>
+
+<h4>
+?? Johannes Laire, Jacob Scott, Raoul Bourquin ? Andreas Lochmann
+</h4>
+
+<p>? ??????? ???? ??????????? ????????? ?? ??, ?? ????????????? ?????? Enigma, ???????? ??? ?
+Quadropolis. ???? ???? ????? ????? ???????? ????????? ??? ?? ????? ????? ????? ? ??????????? ???????,
+? ?????? ??????????? ???????????, ? ??????? ??????.
+?? ?? ????? ?? ???????? ??????? ????????? ????? '??????' ??? '???????',
+? ????? ??????? ?????, ??? ??????, ???????, ??????? ? ??????, ????????? ?????? ?????????.
+? ??????? ??????? ???? ? ?? ?????????? ???????????, ????????????
+?????????? ?????????? ? ???????????? ??????? ???????? ????, ?????.</p>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_a.png" alt="Level of the month" border="0">
+<div class="imagetitle">Enigma VI # 79 - Quadropolis<br>???? - ????????!</div>
+</div>
+
+<h4>?? ???????: ??????? ???????? ?????? ? ??????????</h4>
+
+<p>Quadropolis ? ??????? ????????? ??????????? ??????? ?? 5 ??????? ? ????? ?? ?????? ?????
+? ??????? 9.40. ??? ????? ??????? ?????? ??????, ???????? ??.</p>
+
+<p>??? ?????? ?????? ????? ? ????????? ?? ??????? ???? &quot;Island Labyrinth&quot;
+? &quot;The Aztec Temple&quot; ????? ???????. ?? ??????? ???? ? ???? ?????? ??? ???????? ???? ????? ??
+?? ? ????????? ? ??????? ??????????. &quot;Island Labyrinth&quot;
+???????????? ?? ????? ????? ????????? 9.24 ????? ? 8 ??????? ????? ????? &quot;The Aztec Temple&quot;,
+?????? ??????? ????? ??????, ??????? ??????? 9.13 ????? ? 7 ???????. ??
+4 ? 5 ?????? &quot;Labyrinth of Puzzles&quot; (8.92/13) ? &quot;Houdini&quot; (8.86/6)
+???????????? ???????. ????? ? 6 ?? 8 ?????? ????? ???????.
+??, ??? ??????, ?????? ?????? ??????????? ?? <a href="$$lotm$$">???????? ?????? ??</a>.</p>
+
+<table cellpadding="0" cellspacing="1" class="statistics">
+<caption class="normalcaption">????????? ??????? ??????? 2007</caption>
+<colgroup>
+   <col width="80">
+   <col width="160">
+</colgroup>
+<tr><td class="num">12:05</td>
+    <td class="left">Duffy</td></tr>
+<tr><td class="num">15:45</td>
+    <td class="left">Lukas</td></tr>
+<tr><td class="num">16:56</td>
+    <td class="left">Ronald</td></tr>
+<tr><td class="num">28:13</td>
+    <td class="left">Taztunes</td></tr>
+<tr><td class="num">39:04</td>
+    <td class="left">shoki</td></tr>
+</table>
+
+<p>??????, ??? ????? ?? ????? &quot;??????? ????&quot; ?????????? ?????????,
+???????? ???? ??????, ??? ??? ??? ????????? ???? ?????? ?????. ?
+?? ???? ?? ????????, ?? ????? ??? ???????? ?????? ??????? ??????,
+??????????? ?? ??????.</p>
+
+<p>???? ??? ??? ????? ?????????? ??????????! ?????? ??? ?????? ?? ???????,
+????????? ??????? ??????, ? ?????? ? ??????? ????!
+???????, ?? ????????? ????????? ??????, ? ??????? ?? ??????.</p>
+
+<h4>??????????? ? Quadropolis ???????? ??? ? ?????? ???</h4>
+
+<p>? ????? ? ?????????? ?????? ????????? ??????????? ???????????? ????.
+???????? ??? ?????????? ??????? ???????????????? ????? ???????, ???????? ???????
+&quot;??????? ????&quot; ??????????? ????? ???????. ?????
+????? ??? ??????? ??????????? ? ????? ????????????. ?? ??????
+? ????????? ??????? ?????? ????? ??????? ?? ???????????? ????????? ?????????.</p>
+
+<p>?? ??? ????? ????????? ????????? ???? ????? ?????????? ??????? ?
+? ?????????? ? ????? ??????? vi ???? ???????? ????? ??????? ???????, ?
+?????? ???????. ?? ?? ???????? ????? ?????, ??? ????, ???????, ????????, ???????.
+? ??????? ????, ?????? Raoul Bourquin, ? ??????? ?????????????? ???????? ??????????? ???????????
+st-flash. ??????? ??????? ????? ? ?????? ???????? ??????? ??????
+????? ??????????????? ? ?????? Raoul'? ?? ????? ??? Enigma.</p> 
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_f.png" alt="Level of the month" border="0">
+<div class="imagetitle">?????? ???????? ??? ???: ??????<br>??????????? ????? ????? ???? ??????!</div>
+</div>
+
+<p>??????? ????? ????? ?????? ???????? Andreas'??, ?????? ????????? ??????? ?????????, ???
+???????? ??????? ??. ??? ??? ? Andreas, ? Raoul ???????? ???????? ??????? ???(????????? ????????? ???????),
+??? ????? ?????????? ???? ??????? ?????????????? Andreas'??
+???? ????? ?? Raoul'?. ?? ???????????? ??????? ????????????????? ? ????? ??????? ???????????
+??????????? ?????-???????. ????? Andreas ?????? ??? ????? ????????.
+? ?????? ??????? Raoul ??????? ???? ?? ????? ?????? ?????? Andreas'? ?, ????????? ???????,
+?????????? ????? ? ??? ???? ??????????? ??????, ??????? ?????? ??? ???? ??????.</p>
+
+<h4>???? ??? ????? ????????? ??????? ??? Enigma:</h4>
+
+<p>??????? ???????? ???????? ???? ???????????? ?? ?????? ?? ??????????, ?? ? ?? ????????.
+??? ????????? ? ????????? ????? ?????????????? ???? ? ???? ????????? ?????????? ??????
+???????? ????, ????? ?? ???? ???????????? ????? ??????? '???????
+??????', ?????????????? ????? ?????? ??????? ?????? 'Island Labyrinth' ?? Jacob Scott.
+? ???????? ?????? ?? ??????? ??????? Quadropolis Jacob ??? ? ????????? ??? ???????? ? ??????
+??????? ??, ????????????? ???????????? ??????.</p>
+
+<p>????? ? ?????, ??????? ?????????????? ???,
+Illmind, ??? ???? ???????? ????????????? ?????? ??????????? Enigma, ??????? ?????? ????? ????
+'????????? ?????????? ??????' ?????????? ???????: &quot;????? ?? ???????
+??????? ???????? ?????????? ???????..&quot;. ?????? ???????? ???? ??????
+????? ?????????? ?????????????? ? ???????, ? ?????? ??? ?????? ???? ???? ???????
+?????? ??????? ???, ????????? ?? ??????? ???????.</p>
+
+<p>? ??????????? ?????? (???????? ?????!) - (?????????!) - ?????? ?????? ???, ???
+?????? ?????? ????????? ?????? ??? ?????? ?????????. ??? ??? ??????. ????????? ??????
+?????? ?????? ????? ??? ???, ? ??????? ??????? ??????? ???? ????????? ?????????,
+?????????? ? ????????, ???? ??????? '????????? ????????? ???????' ?? ??????? ???:
+'Quadropolis'.</p>
+
+<p>?????? ?????? ?????? ?????????? ?????? ? ??? ???????? ???? ??????????
+Illmind'?? ?? ?????? ??????? ?????????? ?????? ?? mag.heut.net. ????? ?? ???????
+??????? ?? ???????? ?, ????? ???? ??? ?????? ??????????? ?????? ??????????
+? ???? ????????????, ?????? ??? ??????? ????????? ????????. ?????? ??? ?????? ??????
+Quadropolis ??? ??????????? ? ??????? Enigma 1.01 ? ?????? ???????
+(?????????? ?????? ?? ??????? ???? ??????) ??? ??????? ((?????? ?????????? ?? ??????) ?????????? ?? ?????? ????
+(?????? ?????????? ?? ??????) ????? ????).</p>
+
+<p>??? ??????????? ????? ?????? ? ??????????? ????? ????????? ???????????
+??????? ?? ??????. ?? ??????????? ???????? ?????????????, ????? ??????? ??????? ??? ? ??????
+?????? ????????? ?? ?? ????? ? Quadropolis. ????? ???????????
+????????????? ?? ????????? ? ?????????? ???????, ? ???? ??????????? ?????????? ?? ?????? ????? ?
+?????? ?????????, ??? ??? ??????.</p>
+
+<h4>&quot;? Enigma ??? ?????? ????? ??????????? st-chess ? st-puzzle&quot;</h4>
+
+<div class="quote">
+-- ??????? ?????? ??? ? ????? ??? ????? ? ???????, ? ????? ?????? ??? ???
+???????? ??? ???? ??????????? ? ??????????????. ? ???? ???? ????? ??????, ??? ??????? ? ???? ???????,
+?? ?? ?????-?? ??????? ? ????????, ??? ?????????? ? ????? ????? ??????; ? ?????? ????? ????????? ???????.
+</div>
+
+<div class="quote">
+????? ? ?????? ???? illmind'? ?? ?????? ????? ???????, ??? ??? ????????????? ???????????, ?????? ???
+???? ??????? ?????????? ??????, ????? ???? ??????????, ?? ? ?? ??????? ???????, ????? ?? ????????
+??????????. ??????? ? ?????? ???????, ??? ? ???? ???? ????? ?? ???????. ??? ?????,
+??? ??? ????????? ???? ???????? ? ???????? ???????? ???????, ?
+??? ????????? ???? ???????? ???????.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_b.png" alt="Level of the month" border="0">
+<div class="imagetitle">?????? ????? ??? '????????? ????????'</div>
+</div>
+
+<div class="quote">
+????? ?????? ??????????? ? ???? ??????? ??????? ???????, ?? ???? ???? ????????? "??":
+???? ?? ??????? ?????? ? ??????, ?? ?? ??????? ?????? ???????! ?? ??? ??????
+? ??????? ?????? ?????, ??? ???? ?? ???????? ??? ???????, ????????? ?? ???????
+? ???????? ???????, ?? ?????????? ??????????? ?????? ????? ??????. ??? ?????????? ????,
+? ? ??? ?????? ????????, ????? ?????, ??? ???????? ???? ????? ??????????? ? ???????
+??????-???????????.
+</div>
+
+<div class="quote">
+????? ????? ? ???????? ?????????? ???????????? ???????????
+????????? ??????????????? ?????????????, ???????? ?? chessoban. ? ???? ??????? ??? ?? ????????, ???
+????????? ????????? ???? ???????? ? ??? ??????, ??? ????? ??????? ????????? ??????,
+?????? ??? ? ?????, ????? ??????? ??? ????????????. ?? ? ?????, ? ????? ?? ???????.
+</div>
+
+<div class="quote">
+? ??? ?? ????? ??????? ?????????, ?? ? ????? ? ????????? ???????? ? ??????? ??????? ??????.
+?????????? Quadropolis ???? ?? ???? ??????? ???????.
+</div>
+<div class="author">Johannes Laire</div>
+
+<h4>&quot;??? ??????????? ??? ??????? ?????&quot;</h4> 
+
+<div class="quote">
+&quot;Quadropolis&quot;, ????????? ?????? ??????? ???, ??? ?????????
+??????????????? ????????? ????????????? ? ??????? ???????, ? ???? ? ??? ?????. 
+?????? ?? ??? ?????? ???? ??????? ? ????????? ??????, ???????? ?
+?????-?? ??????????? ??????????? ????????????.
+</div>
+
+<div class="quote">
+?? ?????? mag-heut.net ?? ????????? ?????????????? ?????? ????-??????? ? ???????
+????????? ?? ??????, ????? ??????? ??????? ? ??????????? ???????? ? ??????????
+????????? ???? ? ?????? ?????.
+</div>
+
+<div class="quote">
+??? ??????? ?????, ?????????? ?????????? ??? ????, ????? ?? ????? ???????
+?????? ??????: ?????????? ??????? ??????? ??????? ??? ?????? ?? ?????? ???
+??????????? ? ????, ????? ?????? ? ??????.
+</div>
+
+<div class="quote">
+??? ??????????? ??? ??????? ????? - ? ????? ?????????? ???????
+??????????? ?????? ??????? ?????? ? ???????? ?????? ? ????? ??????. ??????????, ?????
+??? ??? ??????????? ?? ?????? mag-heut, ?? ??? ??? ? ???????? ?????????? ???????....
+</div>
+<div class="author">Jacob Scott</div>
+
+<h4>&quot;????? ????, ??? ??? ????? ????????? ??? ???????&quot;</h4> 
+
+<div class="quote">
+??? ??? ???????? ? ????? Illmind'?, ??????? ???????? ? ????? ??????? ??????? ? ????????
+?????????? ???????, ?????? ?? ??????? ?????????????? ????????? ???????, ? ? ?????
+??? ????????? ??????? ????? ?????????? ?????? ? ???? ??????. ??? ???? ???? ????????? ?????
+? ??????? ??????? ?? 4 ??????, ??????? ?????? ?????? ??? ??????
+&quot;????????? ????????? ???????&quot;.
+</div>
+
+<div class="quote">
+????, ?? ?????????? ? ????? ??????, ?????? ?? ??? ????? ????????? ???? ??????????? ???????. ? ???? ???? ?????,
+??????? ? ??????????? ?????? ? 'Puzzle Puzzles', ?? ??????? ? ?????? ??????????.
+?????? ????? ????? ??????????? ????????? ????? ????? ???? ??????? (??? ????? ??? ???????).
+????? ??? ???????, ?? ????????? ???????????, ??????? ???????? ? ??????? ???? ??????, ??? ????? ?????????? ????????? ????.
+??????? ? ??????????? ?????? ??? ???????? ???, ????? ??????? ?????? ??? ????? ??????? ? ????????? ??
+?????????? ??????????? ??????????, ????????????? ?????? ??????????? ? ??????????? ???? ????????.
+</div>
+
+<div class="quote">
+????? ?????? ?? ??? ???????? ???? ???????, ?? ?????? ??????????? ??????? ??
+???????. ???????, ???????????? ? ?????????? ???? ??????????? ?????? ?????? ????
+??????? ???????. ????? ????, ? ????????? ????? ??????????? ?????? ????? ????
+???????????? ?????????? ??????? ????? ????????????? ? ????? ?????.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_e.png" alt="Level of the month" border="0">
+<div class="imagetitle">????? ???????, ???????? ???, ????????<br>??????! ??? ???????!</div>
+</div>
+
+<div class="quote">
+????? ????, ??? ??? ????? ????????? ??? ???????. ??-?? ????, ??? ??? ???? ??????????
+??? ?????????? ????????? ?????? ???????????, ? ????? ???????????? ??????? ???????? ???
+???????????? ???????. ??? ???????? 'Industrial Puzzles'. 
+</div>
+
+<div class="quote">
+???? ????? ???? ??????? ????? ???????, ?? ? ???? ?? ???? ?????????? ????,
+??? ??????? ???????, ??????? ?? ?????? ????????? ? ????????? ??????. ??? ?????? ????
+????? ???????? ? ?? ????? ???????. ????????? ???? ??????, ???????, ? ???? ????????? ????:
+??? ?????? ???????? ???? ??????! ???? ?????? ???????????? ???????? ?????
+????????? ??? ? ????? ??????? ???? ????????????, ? ?????? ??????? ???? ?????? ???? ?????
+???????? ? ??????.
+</div>
+
+<div class="quote">
+????? ?????? ?????????? ???????? ????, ????????? ? ??????? ? ??????? ?????????? ?????.
+????? ?????? ?????? ????? ??? ????????????????? ????? ???? ?????? ?????
+????????? ?????. ?? ??? ???? ?? ???????? ??????. ??????? ??? ?????? ????, ????? ??????
+????? ???? ????????? ???????, ????? ???????? ????????
+????? ?? ???? ???-?? ????? ?????????, ??? ?????, ????????? ? ???????????? ??????? 
+</div>
+
+<div class="quote">
+? ???????, ???????? ??? ?????? ??? ????????????, ??????? ?? ????????, ? ??????
+??????, ????? ???? ?????? ??????????? ??????? ? ????????? ????????? ???????.
+</div>
+<div class="author">Raoul Bourquin</div>
+
+<h4>&quot;??? ???????? ???????????? ????? ??????? Enigma ? ????? ??????????? ???????&quot;</h4>
+
+<div class="quote">
+???????? ???? ???? ??????? ????????? ??? ?? ??????? illmind'? ? ???????? ??? I.
+??? ??? ????? ??????, ???????? ????????? ???????? ???????????? ?????????:
+?? ???? ???, ? ????? ??? ????????? ??-?? ???? ?????? ??? ?????????? ????????????
+Enigma ? ???? 2006-??. ??????? ?????????? ?? ?????????? ??????? ????????
+Enigma, ? ????? ??????? ???????? ?? ??? st-flash. ?? ??? ?????????? ?????.
+????? ????? ????????????? ?? ????, ?? ?????????? ??? ????????, ???????? ??
+20 ? ?????????? ??? ???? ?? ?????? ??????. ??? &quot;20&quot; ????????? ???
+???????? - ?????? &quot;20&quot;? ??? ???????? ????? ?????????. ? ??????? ?? ?????? ??????
+???????? ? ????, ??????? ????? ???????? ? ??????? ????????? ??? ??????????
+??????????, ??? ???????? - ??????????. ???????? ? ???? ???????? ? ?????? ????? Oxyd.
+?? ????? ?? ???????????? ????????? ????? ?????, ????? ? st-flash ?????? ????? ???? ?????????
+</div>
+
+<div class="quote">
+? ??????? ????????? ?? ?????? ?? Berlios, ????? ?? ?????? ?? ???? ????, ? ??? ???????
+??????? ?? ????. st-flash ????? ????? ?????????????. ???? ?? ???????????
+??????? ??? ????? ??????????????? ??? ??????? ???????? ????? ???? ??????? ?????????
+???????? ?????????????: ????????, ????????? ??????????? ?????. ??? ?
+fl-inverse ??? ???? ????? ??????????? ? ???? ???????? ???? ????????? ??????? ?
+??????? ???????? ??????, ?????? ???????? ????????? ?? ?????-?? ????????.
+??? ??????? ???? ?????????? ??????? ??? ?????????? ?????????,
+????????? ? ????? ??????? ??????. ??? ????? ???????????? ? ??? ?????? ??????.
+??????? ? ????? ?????? ?????, ??????? ?????????? ???????? ??????.
+??????? ? ????? st-spitter ? st-actorimpulse-family,
+??? ????? ?????????????? ? ? ????????? ??????? ???? ??????????????? ?????????. ??????? ???????????
+???? ????????? ???????? ????? ?????? - ? ???? ? ???? ????????.
+? ???? 2006-?? Raoul ???? ??????????? ?????????, ??????? ? ????????????????
+?? ????? ?? ?????.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_g.png" alt="Level of the month" border="0">
+<div class="imagetitle">??????? ??? ?????? ???? ??????? ?<br>???????! ???? ???, ??? ??????????<br>????????????</div>
+</div>
+
+<div class="quote">
+??? ???????? ???????????? ????? ??????? Enigma ? ????? ??????????? ???????. ?? ??? st-flash,
+? ???? ?? ???? ?????????? ??????? ????. ???????? ????????????? ???? ???????????
+?? ??????? ??? ?????? ??????. ? ? ????? Enigma 1.00 ????? ??? ???????.
+</div>
+
+<div class="quote">
+? ????? 2007-?? illmind ???????? ? ????? ????????? ?????????? ??????. ????? ?
+??????? ?? ?????? ? ?????, ??????? ?? ????? ????????????, ? ??? ???????? ???????? ????
+?? ???????????? ?????? st-flash ? ??????????? ?? ? ?????????, ? ? ??????
+????? ???????, ??????? ????? ???????????? ??? ????????. ??????? ? ?? ??????? ?
+???? ????, ????? ?? ????????? ?? ?????. ????? Jacob ? Johannes ??????????????
+? ???????, ? ????? ???????????, ??? ?? ??????? ???? ?? ??????? ?????? ????? ????? ???????? ?????????????,
+???? ??????, ??????????? ???????? ?????? ???? ??? ?????????????? ? ??? ??????????? ???????????? ? ?????.
+</div>
+
+<div class="quote">
+???? ?? ???????, ??????? ??? ????? ???? ?????? - ??????. ???????? ???? ? ???????, ???
+???? ??????????? ????? st-bigbluesand-stones Raoul'?. ?????? ????? ????? ? ???????, ???
+??? ?????????? ???????????, ?????????? ? ???? ??????. ? ?? ????? ????????????
+????? ??????, ?????? ??? Raoul ??? ??????????? ?? ? &quot;Zeus&quot;. ??????? ? ???????? ?????, ??????? ??? 
+Ronald'? ? ?????? ??????????? ??????.
+</div>
+
+<div class="quote">
+??? ????? ??????? ???????, ??? ??? ?????? ???????? ?? ??????? ???????? ?? ????????
+&quot;Quadropolis&quot; ? ???? ?????????? ???? ???? ????????? ? illmind'? ? ????
+???????????? ? ?????????? ????????! ? ??????? ? ??????? ????? ??? ?????? ??????
+??????????????.
+</div>
+<div class="author">Andreas Lochmann</div>
+
+<p>??????, ????? ??? ?????? ?????? ? ?????-?? ???? ??????????? ????? ? ?? ???????? ?
+??????? Quadropolis, ? ???? ???????? ????????? ?????.</p>
+
+<h4>??????? ????????? ???? Andreas'?:</h4> 
+
+<p>??????? ? ????, ??? ?? ?????? ?????? ??????? ?????-?? ??????????. ??????,
+???????. ??????? ??? ????????????? ????????? ??????? ?? ????? Neil Young: &quot;There's more to
+the picture than meets the eye! Hey hey my my!&quot; ?? ?????? ?????? ???-?? ?????
+????????, ??? ???? ???????? ???????? ??????. ?? ?? ??????? ???? ??????
+????? ???????????? ???????? ?? ??????? ????????????? ? ?????-???????. ??????? ?????? ????????????? ??????
+??????????? ?? ?????, ??? ??? ?????? Lukas (??! ????????, ????? ??????),
+??? ???????? ????????? ???????? ?????? ??? ??????? ??????? ???
+????????????? &quot;???????????&quot;!</p> 
+
+<p>???? ???! ??? ????????? ????? ?????, ???? ?? ?? ?????? ?????????.
+????? ??????? ????????? ?? ??????? ? ????? ??????? ??? ???????????? ?????? ???????, ??? ??? ????, ????? ????????
+??? ?????????? ??????? ?????? ??????. ?????????? ???????????, ?? ?? ???? ?? ??????.
+??????, Andreas, ? ?????? ?????? ??? ??? ???????.</p>
+
+<h4>??????? ????????? ? ??????? Jacob'?:</h4>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_c.png" alt="Level of the month" border="0">
+<div class="imagetitle">??????? ?????????? ? ????? ??????? ????? <br>?? ????? ??????? ?? '?????? ??????????'!</div>
+</div>
+
+<p>???? ? ?????? ????? ?? ????? ??????, ??????? ? ????? ??????? ????? ?????????.
+? ?? ?????? ?????? ?????????? ?? ?????? ?????
+??????? ??????? ??? &quot;Nightmares&quot; ? &quot;Monsters in the Dark&quot;
+(?? ????????????? ?????????? ??????? ????????? ?????? ???). ?????? ??? ????, ?????
+??????? ???????????, ? ????????????? ??????? ??????? Esc ? ???????
+&quot;?????? ???????&quot;. ??????, Jacob ???? ???? ????? ? ?????????? ??????
+????????????? ???????? ????????. ??????????, ?????? ???? ??????? ?????????? ???
+????????? ? ??????????? ??????, ? ??????? ???????? ?????? ? ?????????? ??????? ?????.</p> 
+
+<h4>??? ?????? Enigma</h4>
+
+<p>???????? ????? ???? ???????, ??? ? ???? ?????????: ????? ?????? ?? ????????,
+?? ?????? ?????, ?? ?????????, ?? ????????? ?????????????, ?? ?????
+?? ???????? ? ??? ?????? Enigma. ???????????? ? ????????????, ?
+?????????????, ? ?????, ??? ?? ???? Quadropolis ?? ????? ????????? ????????
+?, ? ??????, ??? Enigma ? ????????? ????!</p>
+
+<p>????? ???? ???-?? ?????? ?????????? ????????? ???????? ??? ????? ? ????, ????? ????? ? ??????
+????? ???? ?????????????? ??????. ???? ?? ????? ???????? ??????????
+?????????? ??????? ???????? ? ??????? ???????.</p>
+
+<p>???????? ?? ?????????????! ?????? ?????? ??????????? ?????? ??????!</p>
+
+<h4>&quot;? ?????? ??????? st-chess-puzzle ????
+??????? ???????? ????? ?????&quot;</h4>
+
+<div class="quote">
+??-?? ????, ??? ? ??? ????? ????? Quadropolis, ??? ??? ??????????? ???????. ??????
+???? ??????? ??????? ???????? ?????????? ??????? ???? ????????????! ??? ?
+?????? ???? ?? ???? ???? ?????????? ????????????? ?????? ??????? ?? ?????????. ? ?????? ???????
+???? ?????????????? ?????????? ? ???? ??????????? ???????? ????, ??????? ??????? ????? ??????????
+?????? ???? ? ?????? ? ??????? ???????.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_j.png" alt="Level of the month" border="0">
+<div class="imagetitle">????, ???? ? Quadropolis!<br>?????, ??? ??????
+???????????? ????,<br>????? ??????? ??!</div>
+</div>
+
+<div class="quote">
+??? ??????, ??? ?????? ??????? ???? ?? ???? ??????? ???????. ? ?????? ???????
+st-chess-puzzle ???? ??????? ???????? ????? ?????. ? ???? ???? ????? ????? ???????,
+?? ??, ????? ??????????? ??? ??????? ??? ?????, ????????????? ?????? ? ????????? ????.
+??? ??? ??????? ?????!
+</div>
+
+<div class="quote">
+????????? ?? ??? ??????? -  ????? ?????? ?????????? ???????, ?? ?????? ??????????? ????????????
+?? ????. ?????? ??????? ? ?????? ??????? ??????? ???????, ?? ????? ?????????? ???????, ????????????
+? ???????????? ???????????, ??? ??? ????? ????? ????????. ????, ??? ?? ?????? ???????????? ??????
+?????????? ?????? ????????. ????? ?????? ????????? ??????? ? ???????????? ???? ? ?????? ??????? -
+?????? ????.
+</div>
+
+<div class="quote">
+????????? ??????? ?????? ????????????????? ??????????. ?? ?????? ?????? ??? ????????
+??????? ??????, ?? ???????????, ??? ??? ????? ??????????????? ??????????? -
+????????, ????? ????? ????? ?????? ??? ???? ?????????????? ?????! ??? ????????? ????????????
+?????????????? ???????????? st-flash!
+</div>
+
+<div class="quote">
+???????????? ??????, ??????? ???????? ?????????: ??-????? ??????????
+??????? ? oxyd'??? ??????? ??????. ???? ??? ????? ?????? ?????? ?????? ????
+(???????? ? ????? ???), ??? ????? ?????? ???? ??????? ????? ???????????.
+</div>
+<div class="author">Lukas Sch&uuml;ller</div>
+
+<h4>&quot;?????? ?????????, ?????? ??? ???-???? ???????&quot;</h4>
+
+<div class="quote">
+?????? ?????? ?????? ?????-??????????? ? ??? ????????. ??????? ??????????? ????? ??????????
+? ????????, ??? ??? ??????? ?????????? ???????? ??????? ????? ??? ???????. ???????? ??? ??????,
+??????? ?????? ??????????, ??? ??? ???????, ??? ?? ???????. ?? ??? ????????? ???????????
+????????? ????? ???? ? ?????? ???????????. ?????????? ?????????? ??????? ??????????? ????? ?????
+????????????. ??????? ?? ??? ?????? ?????????, ?????? ???????? ?????? ???????.
+?? ???????, ? ?????? ??????? - ????? ??? ? ??????? ?????, ????? ??????????? ?????? ???
+????????? ???? ?? ??????. ????? ?????? ??????!
+</div>
+
+<div class="quote">
+?????? ????????? ????????? ??????????? ??????????? ? ??????????.
+??????? ? ???????????? ??????? ???????? ?? ???????, ??????? ????????? ???? ? ????????? ??????.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_d.png" alt="Level of the month" border="0">
+<div class="imagetitle">??, ???? ? ?????, ????????!<br>??? ?, ??? ??????????? ?????!</div>
+</div>
+
+<div class="quote">
+????? ????????! ????? ??? ? ?????? ????????! ????? ?????????? ???? ????? ????? ????
+? ????? ?????? ????? ?? ????? ?????????? ?????????. ?????? ??????, ??? ??? ????? ???????? ??????, ??????
+??? ???-???? ???????.
+</div>
+
+<div class="quote">
+? ?????? ??? ?? ????????? ??????. ?????? ??????? ????? ??????? ? ?????????? ???????. ?
+?????? ????? ??? ?????????, ????? ? ? ???????? ?????? ?? ????????????? ??????????? ?
+???????? ??? ?????. ?????? ? ?????? ?????? ?????? ??? ?????????? ???????????! ? ?????
+??????? ??????????? ???????? ?????? ? ?????? ? ??????? ??????? ???? ?? ???????? ?????.
+</div>
+
+<div class="quote">
+???????, ?????????? ?? ????????? ???????, ? ????? ?????????? ? ????????? ????? ???????. ?????????????? ???????
+??? ????????? ??? ???? ?????? ? ??????????? ??????????? ??????. ? ??????? ?? ????????????????? ??? ???????, ???
+?? ???? ??????, ????? ?????? ???????????, ???? ??????? ?????. ?????? ?? ????? ?? ??????? ?????! ????? ??????????
+??????? ????????? ?? oxyd'??.
+</div>
+
+<div class="quote">
+?????????? ???? ??????? ???????. ???????????, ?????? ????? ???? ?????? ???? ??? ????? ???????.
+???? ??????? ? ????? ???????? ?????, ?? ?????? ??????????????? ??????????? ??????? ??????,
+????? ????? ????? ???? ? ??????????? ???????.
+??????? ?? ?????? ??? ???? ????????? ????????? ???????.
+</div>
+<div class="author">Ronald</div>
+
+<h4>&quot;??? ???????? ???????, ?? ???????? 10!&quot;</h4>
+
+<div class="quote">
+? ?????? ??????????? ????? ??????? Enigma 1.01 ????? ? ???? ?? ????. ? ?????? ???
+??????????? ????? ?????? ? ????? ?? ??????????? ?? ????????? ??????. ???? ?
+???? ?????? ? ???????, ? ?????? ???? ??? ?????? ?????? ??????, ???? ??? ? ?????? ??????
+??????, ? ??? ?? ????, ??? ????????? ?? ??????. ????, ??????
+????, ????? ??????????? ?? ????????? ??????? ?? ???? ???????, ? ????????? ??????????? ?? ???.
+</div>
+
+<div class="quote">
+? ?????? ????? ???????, ?????? ??? ???? ?????? ??? ?????? ???????????. ?????? ? ????? ?????? ???
+????? ????? ???????????? ???????? ? ??? ??????? ? Quadropolis.
+</div>
+
+<div class="quote">
+??????? ? ???????? ???? ???????, ????? ?????? ???????????. ?? ????? ???? ??? ???? ??????? ???????.
+??????? ? ????? ?? ?????, ?? ??????? ?? ??????? ???.
+????????? ?????, ??????? ??????????? ? ?????? ?????? ?? ??? ?? ?????, ???
+? ??????? ?????, ??? ?? ?????????, ????? ?????? (????? ??????) ???????.
+</div>
+
+<div class="quote">
+??? ?? ??????? ?????? ????????? ????????? ?????? ?? ?????? ?????. ??, ? ?????? ? ?????
+? ?????????? ?? ???????? ????????? ?????? ? ??????? ?????? ????? ???????, ????????????
+??????????? ?????, ? ????? ??????? ??? ???????. ? ????? ???? ?????? ???????? ???????.
+</div>
+
+<div class="quote">
+?????? ??????, ? ??? ???????? ????????? ?? ???????, ????? ??? ????? ????
+??????? ??? ????? ? ???????; ? ????? ??????, ? ???? ???????? ???? ?????????.
+</div>
+
+<div class="quote">
+??? ?????? ? ??? ???????, ????? ????? ?? ?????? ???????, ? ??????? ?? ?????? ?????? ?????? ?? ???? ??????? .........
+????? ????, ??? ??????? ?????????? ????? ???? ??? ???? ?????.
+???????, ? ??????? ?????? ???????? ????? ?? ??????? ?????? ? ????? ???????. ? ????? ??? ??????? ????? ??????? ?? ????.
+</div>
+
+<div class="quote">
+???????, ????? ???? ?? ???? ???????. ??????, ??? ??? ??? ? ????? ?????? ???????? ?????? ? ?????????,
+? ???? ?? ???? ???????????? ???????. ? ??????? ????? &quot;????????????&quot;
+????? ????? ???????? ?????? ???? ???????.
+</div>
+
+<div class="quote">
+??????? 4. ??????? ???. ? ??? ?????? ? ????? ????????????? ???????, ??????? ? ??????
+????? ????? ? ?????? ?????????????? ?????. ????????? ?????. ????????? ?????????????? ?????
+????????? ???????? ???????, ????? ????? ???????? ? ? ???????????? ????????? ??????? ??????.
+??????, ? ?????? ?????? ???? ???? ????????? ??????. ?? ??????? ???? ?????????????? ???????????? ? ????????. ? ????????
+Quadropolis ????????????.
+</div>
+
+<div class="quote">
+????????? ?????? ?????? ? ????? ??????? ???????? ? Quadropolis, ? ????????? ????? ??? ??????
+???????????. ??? ??????? ? ???????????? ???? ???????. ? ??????
+????? ?? ????? (? ???? ??? ??? ?? ?????? ????? ???????) ? ??? ?????? ??????? ???????? ?? ????????? ???????.
+? ??????? ????? ???????????? ?????????????? ????????????
+? ???? ??????? ????????? ????? ? ????????? ???????.
+</div>
+
+<div class="quote">
+????? ????????? ????????? ?????, ? ?????? ??????? &quot;????&quot;, ????? ???? ???? ??????? ????:
+&quot;??? ??????????&quot; ? ???????: &quot;??? ???????? ???????, ?? ???????? 10!&quot;
+????????? ? ?????, ? ?????? 10 ?????? &quot;Pleasure
+Garden&quot; ? &quot;The Passage&quot;. ? ??? ??? ????? ???????????.
+</div>
+<div class="author">Shoki</div>
+
+<h4>&quot;???????? ????? ??????????? ???????????? ?????? ???????? ??? ???? ??? ???????&quot;</h4>
+
+<div class="quote">
+???? ??? ??? ?????????????? ???????? ??????? ???????? ??????????, ?????? ?? ???
+??????? ???? ??????? ? ??????, ??????????????? ??????. ???? - ??????????? ??????????? ?? ????????? ??????
+???????? ???????.
+</div>
+
+<div class="lotmpic">
+<img src="$$imagedir$$/lotm/lotm_200710_i.png" alt="Level of the month" border="0">
+<div class="imagetitle">????? ??????: ????????</div>
+</div>
+
+<div class="quote">
+??????? Johannes'? ? ?? ????????????? ? ?????????? ????????, ??????? ????? ??????? ????? ????????, ????? ?? ????.
+? ?????????? ?? ??, ??? ????? ???????????? ?????????????? ????????? ???????????, ???? ???????? ? ????????
+(? ??????? ?? ????? ???????????? ???????, ? ??????? ?? ??????? 20 ?????, ????? ??? ??? ????????? ??????, ???????
+????? ?????????? ??????). ??? ? ?? ?????? ??????? Enigma, ????? ???? ???????? ?????? ('?????? ??? ????????'),
+? ???????, ???? ?? ??????? ???????????, ? ??? ?????????? ?????? ??????? ????
+????????? ???????. ??? ????, ???????? ?????? ?????????, ????? ??? ????? ??????? ????? ????? ? ???????? ??????
+???????. ???? ? ???? ??????????? ????????? ??????, ?? ?????? ?????? ????????? ???????? ???????????,
+? ????????, ??? ???? ???-?????? ???????.
+</div>
+
+<div class="quote">
+?????? ??????? Jacob'? ??? ?????? ??? ????????. ??? ????? ?????? ? ????? ????????????.
+?????? ??????????? ? ???????? ?????????. ????????????? ????? ?????, ??????? ?????? ???????? ? ???? ??????.
+</div>
+
+<div class="quote">
+Raoul ??????? ? ?????????. ?????? ? ????? ??? ??????? - ? ????? ?????????? ?????, ??????????
+?????? ?? ????????????. ??????? ? ????? ??(???????) ? ??????? ????????? ?????, ?? ??? ????? ??
+???????????. ???? ?? ??????? ?????????, ?? ?????? ?????????? ? ???? ??? ?????????????? ??????.
+</div>
+
+<div class="quote">
+? ???????, Andreas ??????? ??? ??? ?????????? ? ????? ????. ? ??? ????????????? ???????,
+?? ????? ? ?????? ??????????. ? ??????? ???????? ???? ??????????? - ?? ???????????
+???????? ?? ??????? ?????????? ??????(????? ???????? ??????), ??????????? ????? ????????
+?? ???????? ????????.
+</div>
+
+<div class="quote">
+? ??????? ??? ????????? ??????????? ??? ???????? ??? ??? ? ??????????? ??????????. ?
+??????, ??? '??????' ??!
+</div>
+<div class="author">Taztunes</div>
+
+<p>
+???? ?????? ????????? ????? Taztunes, ??? ???????? ?? ???????????? ????????
+??????? ??????? Quadropolis'? ? ??????? ?????? ? ?????????????? ? ??? ? ????????? ? ??????????????
+??????? ? ???????: &quot;???-I ??? ??????? ????????! ? ??????????? ?
+Quadropolis ????????????? ???? ?????????!&quot; ???????? ?????? ????????, ????? ?????
+Quadropolis'? ??? ????? ?????? ??? ??????? ??????? ???. </p>
+
+<p>? ?????????,<br/>
+<i>Harry</i></p>
+
+</div>


Property changes on: homepage/input/lotm/lotm_200710_ru.html
___________________________________________________________________
Name: svn:eol-style
   + native

Added: homepage/input/support_ru.html
===================================================================
--- homepage/input/support_ru.html	2007-10-03 12:12:33 UTC (rev 894)
+++ homepage/input/support_ru.html	2007-10-05 19:41:29 UTC (rev 895)
@@ -0,0 +1,158 @@
+<h2>????????? ????????????</h2>
+
+<p>??????? Enigma ? ?????? ????? ?????????????? ??????????? ?? ??????????? ??????? ?? ???????? ?
+???????????? ? ????????? FAQ (????? ?????????? ????????). ???????????? ?????? ??????? ???? ?? ???????????
+????????????, ??????? ????? ??? ????????????. ???? ?? ???????? ? ?????-?? ?????? ??? ?????? ??????
+? ???-?? ???????? Enigma, ??? ????? ????????? ?? ?????. ??????? ???? ???? ? ?????? ???????, ??, ??? ????????????, ??????
+??????? ???????????? ? ????? Enigma.
+???? ?????????? ?????? ? ?????????????? ??????, ? ?????? ??????? ???????? ?? ????? ?????? ??????.</p>
+
+<ul>
+  <li><a href="$$support$$#documentation">????????????</a> - ????? ????? ?????????? ?????? - ??????? ??????.</li>
+  <li><a href="$$faq$$">FAQ</a> - ????? ?????????? ??????? (? ?????? ?? ???).</li>
+  <li><a href="$$support$$#forum">?????</a> - ???????? Enigma ? ??????? ??????????????.</li>
+  <li><a href="$$support$$#score">??????????? ?????</a> - ???????? ???? ???? ? ??????.</li>
+  <li><a href="$$statistics$$">?????????? ?????</a> - ?????????? ??? ??????? ? Enigma ?? ? ??? ?????????.</li>
+  <li><a href="$$support$$#bug">????????? ?? ??????</a> - ??? ???????? ?? ???????.</li>
+  <li><a href="$$support$$#donation">??????</a> - ??? ?????????? ?????????? Enigma.</li>
+</ul>
+
+  <p>?????? ?????? ???????? ?????!</p>
+
+<h3><a class="arrowup" href="$$support$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
+  <a name="documentation">???????????? ??? Enigma 1.00</a></h3>
+  <p>?????? ??????????? ???????????? ?? ?????????? ?????? ?????????? ? ?????? ??????
+  Enigma. ????? ????, ?? ?????? ???????? ??? ? ????? ????? ??? ??????? PDF-??????
+  ?????????.</p>
+
+  <ul> <!-- keep space in first li entry - IE needs it -->
+    <li> <img src="$$imagedir$$/flags25x15/gb.png" border="0" width="25" height="15" alt="English" title="English">&nbsp;&nbsp;
+      <a href="manual/enigma.html">English User manual (html)</a></li>
+    <li><img src="$$imagedir$$/flags25x15/gb.png" border="0" width="25" height="15" alt="English" title="English">&nbsp;&nbsp;
+      <a href="manual/enigma.pdf">English User manual (pdf)</a></li>
+    <li><img src="$$imagedir$$/flags25x15/de.png" border="0" width="25" height="15" alt="German" title="German">&nbsp;&nbsp;
+      <a href="manual/enigma_de.html">Deutsches Benutzerhandbuch (html)</a></li>
+    <li><img src="$$imagedir$$/flags25x15/de.png" border="0" width="25" height="15" alt="German" title="German">&nbsp;&nbsp;
+      <a href="manual/enigma_de.pdf">Deutsches Benutzerhandbuch (pdf)</a></li>
+    <li><img src="$$imagedir$$/flags25x15/fr.png" border="0" width="25" height="15" alt="French" title="French">&nbsp;&nbsp;
+      <a href="manual/enigma_fr.html">Manuel Fran&ccedil;ais (html)</a>&nbsp;&nbsp;
+      ????????? ????? ??????? ?????? 1.00!</li>
+    <li><img src="$$imagedir$$/flags25x15/ru.png" border="0" width="25" height="15" alt="Russian" title="Russian">&nbsp;&nbsp;
+      <a href="manual/enigma_ru.html">????????????? ??????????? ???????????? (html)</a>&nbsp;&nbsp;
+      ????????? ????? ??????? ?????? 1.00!</li>
+    <li><img src="$$imagedir$$/flags25x15/ru.png" border="0" width="25" height="15" alt="Russian" title="Russian">&nbsp;&nbsp;
+      <a href="manual/enigma_ru.pdf">????????????? ??????????? ???????????? (pdf)</a>&nbsp;&nbsp;
+      ????????? ????? ??????? ?????? 1.00!</li>
+  </ul>
+
+  <p>? ?????????? ?? ?????????? ?????????? ???????????, ??????? ????? ???????? ? ????? Enigma.
+  ????????? ????????????? ? ??? ???????????? ????? ??????? ?? ?????? ??? ??????? ?????????????
+  ? ?????????????.</p>
+  <ul> <!-- keep space in first li entry - IE needs it -->
+    <li> <img src="$$imagedir$$/flags25x15/gb.png" border="0" width="25" height="15" alt="English" title="English">&nbsp;&nbsp;
+      <a href="manual/enigma-ref.html">English Reference manual (html)</a></li>
+  </ul>
+  <p>?? ?????? ?????? ?????? ????????? ?????????? Enigma ???.
+  ??????????, ???? ?? ?????? ?????????????? ????????, ???????? ?????? ?
+  <a href="mailto:enigma-devel at nongnu.org">enigma-devel at nongnu.org</a>.</p>
+
+<h3><a class="arrowup" href="$$support$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
+  <a name="forum">????? ?????????????</a></h3>
+
+  <p>????? ? ????? ????, ??? Enigma ????????? ???????? ???????. ?? ?????? ? ???-?? ????????
+  ???? ??????? ?????? ??? ???????? ????????? ?????????
+  ?????? ?????????????. ?? ?????? <a href="http://www.mag-heut.net">mag-heut.net</a>
+  ?? ?????? ?????????? ????? ?????? ? ??????? ?????? ?????????????.</p>
+
+  <p>??????? ????? ??? ???? ????????????? ??????: ?????????? ????? ????? ??????????,
+  ??????? ???? ??????? ??? ?????????? ???????? ????, ???????? ??????. ???????? ????
+  ??????????? ? ???? '??????', ?????? ????, ????? ???????? ????? ?????.</p>
+
+  <p>? ????? ??? ??????? ???????: ?? ??????? ???????????? ?? ??????, ????????
+  ??????????? ?? ???????????. ???? ?????? ???????????? ?????? ???????????? ???????? ?????????.
+  ????? ???? ??????????? ?????? ????????? ?????? ????
+  (???? &quot;spoiler&quot;). ???????????? ?????? ??????? ??, ???? ?? ????? ???????? ?? ????? ??.
+  ??????? ?????, ?? ?????? ???????? ?????? ??? ?????????.
+  ????? ???? ????????????? ??????????? ????? ????? ???????.</p>
+
+<h3><a class="arrowup" href="$$support$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
+  <a name="score">??????????? ????? ? ??????</a></h3>
+
+  <p>??????? ? Enigma 1.00 ?? ?????? ???????????????? ???? ???? ? ??????. ??? ????????? ? ???,
+  ??? ?? ???????? ???? ??????????? ??????????? ?? ??? ????? ??????? ?????????? ??????????? ?????????????,
+  ?? ???????????? ??????????, ??????? ?? ???????????, ????? ?????????? ?????????? ?? ??????. ???? ????????, ???
+  ?????????? ???????, ?? ???????? ?????-???? ??????? ??? ?? ????? ??? ???????? ???? ? Enigma, ???
+  ?????? ?????? ???????????.</p>
+
+  <p>??????????, ??????? ??????? ??????? ?????? ???????. ????? ??????? ????????? ???????, ???????? ?????? ??????? ????
+  ?? ?????? ?????? (??? ???????? ?? ??? ? ??????? ???????? Ctrl) ? ???? ???????. ? ?????? ??????
+  ?? ?????? ??????? ??????? ?? 0 (??????) ?? 10 (??????). ???????????? ???????
+  ?? ?????? ??????? ??????, ?? ? ??????. ??????? ?????? ?????????? 5.
+  ???? ?????? ??????????, ????? ?????? ???????? ????????????? ? ??????? ? ?????? ??????
+  '?????? ??????'.</p>
+
+  <p>??? ??????? ??????? ?????????? ??? ????????????? ? ???? ????????. ?????????? ????????? ?
+  <a href="$$statistics$$#userlist">?????? ?????????????</a> ?? ???????????? ?? ???? ??????? ???
+  ???-?? ??????.</p>
+
+  <p>??? ??????????? ????? ?????, ?????? ???????? ??? ??? ???? 'enigma.score'.
+  ?? ????????? ? ????? '???? ????????????', ??????? Enigma ?????????? ??? ???????
+  ? ??????? ???? ??????? F2. ?????????? ???????? ?????? ???? ???? ??
+  <a href="mailto:score at enigma-game.org">score at enigma-game.org</a>
+  ? ????? 'score - ???_????????????' (???????? '???_????????????', ????????? ????
+  ??????!).</p>
+
+  <p>???? ??????????????? ??? ? ?????. ?????????? ?? ?????????? ???? ????? ???????????
+  ????? ??????? ???????????? ???????? ??????????. ?????? ???? ? ????? ?????? ????? ??????????.</p>
+
+  <p>??????????? ?????????? ????? ????????? ? ??? ?????????, ???? ?? ??????????
+  ????? ?????????? ??????????? ? '????'. Enigma ????? ???????? ?? ?????? ????? ????????? ??? ? ?????,
+  ? ??????????? ?? ????, ??? ????? ?? ?????????? ??????????. ??? ??? ??????????? ?????? ?????????????? ??????????
+  ?????? ????? ???, ? ?? ???????? ??? ?????????? ? ??????? ?????????? ????.</p>
+
+  <p>???? ?? ? ???????? ??????? ? ??????? ? ?????????? ????? ?????????? ? '???????',
+  ?? ?????? ??????? ????????? ???? ?????????? ???????????
+  <a href="http://www.nongnu.org/enigma/ratings/ratings.xml.zip">ratings.xml</a>.
+  ????????? ???? ?? zip-?????? ? ?????????? ??? ? ??? '???? ????????????' ????? ?
+  ????? ?????? 'enigma.score'.</p>
+
+<h3><a class="arrowup" href="$$support$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
+  <a name="bug">????????? ?? ??????</a></h3>
+
+  <p>?? ????? ????? ????????? ? ????????? ? Enigma. ??????? ??????????? ??????????? ?
+  ????? ??? 200&nbsp;000 ????? ???? ? ??????? ??????? ??????? ??? Enigma ???????
+  ?? ????? ????????? ?? ??????. ?? Enigma ???????? ???????? ??????????? ??????? 1.00, ????????? ??????? ?????????????.
+  ?????????? ??????? ?????????? ??? ?? ??????? ??????? ? ????????????, FAQ ??? ?????? ?????????????.</p>
+
+  <p>? ?????????? ?? ???????????? ? ??????? ??????? ?????????? ????????? ? ?????? ???????? ??? ?????????????
+  <a href="mailto:enigma-devel at nongnu.org" >enigma-devel at nongnu.org</a>
+  (??? ?? ????? ????????????? ?? ?????? ????????).
+  ?????????? ???????? ? ???? ????????? ????????? ???????? ??????????:</p>
+    <ul>
+    <li>????? ???????????? ??????? ?? ????????????</li>
+    <li>????? ?????? Enigma ?? ????????????</li>
+    <li>??? ?? ??????? ????? ???, ??? ?????????? ???????</li>
+    <li>??? ????? ?? ?????? ????? ??????</li>
+    <li>??? ????????? ???????? ??? ?? ????? ??????????????</li>
+    </ul>
+  <p>???? ?? ????????? ?????????, ?????????? ??????????? ?? ????? ? ???????? ?? ?????????? ???????
+  ?? ????? ????????????? ? ??????????? ????????????. ?? ?????????, ??? ????? ??????? ????? ?? - ????
+  ?????? ??????? ??????? ?? ???? ????????? ????? ?????? ????????? ?????.</p>
+
+  <p>? ????????? ? ?????????? ???????? ????????? ?? ?????? ?????????????
+  <a href="http://www.mag-heut.net">mag-heut.net</a>. ?????????? ?????? ? ????, ???
+  ??? ?????? ? Enigma 1.00 ????????? ?? ??????????? ???????. ?? ????????????????? ???????? ???? ???????
+  ??? ???????? ????????????? ? ??????? ???????? ???????? ????? ? ?????? ????? ????????? ? ????,
+  ?????? ?????????????? ??????????????? ? Enigma.</p>
+
+  <p>???????????? ????? ???????? ?????????? ????????? ?? ??????? ??????????????? ? ????? ???? ?????? ??????
+  <a href="http://developer.berlios.de/projects/enigma-game/">Berlios.</a>
+
+<h3><a class="arrowup" href="$$support$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
+  <a name="donation">??????</a></h3>
+
+  <p>??? ?????? ????????, ????? ???????????? ????? ??????????? ?????????? ?????????? ????????
+  Enigma. ????????????? ????? ?????, ???????????? ?? ??????? 'Enigma' ? ????????, ???????
+  ??? ???????? Enigma. ???? ?? ????????, ??? ??? ???????? ????, ????????
+  ??? ????????? ?? <a href="mailto:donation at enigma-game.org" >donation at enigma-game.org</a>
+  ? ?? ????? ??? ???? ?????????????, ??????????????? ??? Enigma.</p>


Property changes on: homepage/input/support_ru.html
___________________________________________________________________
Name: svn:eol-style
   + native

Added: homepage/input/testimonials_ru.html
===================================================================
--- homepage/input/testimonials_ru.html	2007-10-03 12:12:33 UTC (rev 894)
+++ homepage/input/testimonials_ru.html	2007-10-05 19:41:29 UTC (rev 895)
@@ -0,0 +1,93 @@
+<div class="testimonial">
+<h3><a class="arrowup" href="$$about$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
+??????????? ?????????????</h3>
+
+<p>?? Enigma ? ???????? ????? ??? ? ????? ????????????, ?????????? ?
+????????? ????-???????????. ?? ?????? ???? ??? ??? ?????? ????????? ????????????:</p>
+
+
+<p class="quote">
+&ldquo;??? ?????? ????????? ????
+??????? ???????????????, ????? ???????? ??? ??????? ????? ? ????????? ?????.
+??? ???????? ???????????!&rdquo;</p>
+
+<p class="quote">
+&ldquo;? ????? ? Enigma ????? ????????? ???? ? ???? ????????????? ??? ??????? ??
+???????? ????? ????????????? ????, ??? ??????, ? ??????? ????????, ????? ???????? ????????
+ ;) ? ??????????? ??????????????.&rdquo;</p>
+<p class="author">(??????? ????????????? ???????????)</p>
+
+<p class="quote">
+&ldquo;??? ???? ????????? ??????, ??? ? ?? ???? ?????? ?????? ??? ?? ?????????.
+??? ?? ??? ?? ????, ???? ??????, ??? ??? ????. ? ???? ??? ???????? ?? ??????????
+?? ???????? ????????. ???????? ??????? ????? ??????????? ???? ???? ??????????? ??????.&rdquo;</p>
+
+<p class="quote">
+&ldquo;Enigma - ????? ????????????? ????, ? ??????? ? ?????-???? ?????.&rdquo;</p>
+
+<p class="quote">
+&ldquo;??????? ?? ???????? ????? ????????????? ? ????????? ????. ? ?????? ?????? ????-???????????,
+? ??? ???? - ?????? ?? ???, ??? ? ?????.&rdquo;</p>
+
+<p class="quote">
+&ldquo;? ??????? ??????? ? Oxyd ????? ?????? ??? ?????, ?? ??? ???? ??
+???????. ????? ? Enigma, ??????? ??????????.&rdquo;</p>
+
+<p class="quote">
+&ldquo;??? ?????? ????-???????????, ??????? ??? ????????????? ??????????? - ??????? ????! ????????
+2D ???????, ??????? ????????????, ??????? ? ?????? ??????????? ?????? &hellip; ??? ????????, ???
+?????? ??? ????? ????????????? - ????? ?????? ????????? ??????, ? ???? ????????? ?? ???? ?????? ????!&rdquo;</p>
+
+<p class="quote">
+&ldquo;??? ?????????????, ???????????? ????, ??????? ??????? ????? ?????? ??????
+? ???????? ????????? ???????. ????? ???? ??? ??????????, ??????????????? ? ?????????????.&rdquo;</p>
+<p class="author">TuxGamer ?? <a href="http://happypenguin.org/show?Enigma">Happy Penguin</a>.</p>
+
+<p class="quote">
+&ldquo;? ??? ??????? ???????? ???? ????. ???????? ??????????? ???????????
+? ?????????????? ?? ?????????. ?? ????? ????? ???? ??????????, ? ??? ????????????? ???????
+? ??????????? ??????????, ??????? ???????????????? ?????????. ??? ?? ?????????? ??????
+??????????? ???????? ???????????????? ????? ?????? ??????????? Linux ?????? ???????? Enigma!!!!&rdquo;</p>
+<p class="author">Anonymous ?? <a href="http://happypenguin.org/show?Enigma">Happy Penguin</a>.</p>
+
+<p class="quote">
+&ldquo;??? ? ???? ???????? ? ????????? ??????? ? ?????? ????? ? ???????????
+? ? ?? ??? ??? ?? ??? ?? ?????, ?? ?????? ?? ??, ??? ????????? ?????? ??????? ???? ?? ????, ??? ? ?????
+????????? ??? ???? ? ????.&rdquo;</p>
+
+<p class="quote">
+&ldquo;Enigma - ?????? ???? ?? ????! [&hellip;] ??? ???? ??? ???????????? ?? ????? ?????? ????.
+? ?? ???? ?????????, ????? ??? ?????????? ??? ????? ??????!!!&rdquo;</p>
+<p class="author">Scott ????????? ??? &quot;Great Scott&quot;</p>
+
+<p class="quote">
+&ldquo;??? ???? ????????? ?? ?????????, ??? ?????????? ? ????? ? ??????? ? ??????.
+[&hellip;] ?? ?????? ?????????, ?????????????? ??????? ??? ???? ????: ?????? ?????
+????? ???? ?????????(Super Hyper Mega Universe HIGH)! ?? ???? ?????? ???? ? ???, ??? ?? ????????? ????? ????
+??? ???????? ???? ??????? ????? ? Enigma!&rdquo;</p>
+<p class="author">JoTo ?? <a href="http://www.donationcoder.com/Forums/bb/index.php?topic=6859.new">DonationCoder.com</a></p>
+
+<p class="quote">
+&ldquo;? ??, ????? Oxyd! ?????? ? ??? ????? ?? ????? ?? Enigma, ????? ???????? ??? ??????
+??????????? ???????? Atari-Oxyd? ??????? ????, ??? ?????? ??? ????????????? ???? ? ?????!&rdquo;</p>
+<p class="author">Tatjana Heuser</p>
+
+<p class="quote">
+&ldquo;???????, ???????, ??????? ?? ???????? ?????????????? ????? ?????????????? ????
+(Oxyd -&gt; Enigma)! ? ??? ??????? ? ???????????? ???? (???? ????????? ???, ????? ??????????? NeXTStep!), ?? ?? ??? ????????? ???? ?????? ? ???? ? ??????? ????????,
+?????? ??? ? ????????????? ???? ????? ????????. ?????? ?????? ????
+???? ??? ? ? ??????? ????????? ????? ????????? ???????, ??????? ??? ?? ??????? ???? ????, ??? ? ?.&rdquo;</p>
+<p class="author">Rorke Haining</p>
+
+<p class="quote">
+&ldquo;????? ? ??????????? (? ???????? ????? ???????) ?????? ??? ?????????, ??
+???? ????????? ?????????????? ? ??????? ?????????? ???????, ????????? ??????? ????, ??????? ???????? ??
+???????? ????????? ????? ????, ??????? ???????? ??? - ??? ?????? ?? ??????? ????? ?????????? ?? ????? ?????????????.
+???????? Enigma ? ?? ????? ????,
+?? ??? ??????? ???????? ???????????????? ???? ? ???????? ?????? ???????? ???????????? ? ??????????? ???????,
+????? ???? ?? ???? ????????.&rdquo;</p>
+<p class="author">Frank ?? <a
+href="http://macgameblog.com/archives/Enigma-88.html">The Mac Game Blog</a>
+</p>
+
+</div>


Property changes on: homepage/input/testimonials_ru.html
___________________________________________________________________
Name: svn:eol-style
   + native



From andreasl at mail.berlios.de  Sun Oct  7 14:18:58 2007
From: andreasl at mail.berlios.de (andreasl at BerliOS)
Date: Sun, 7 Oct 2007 14:18:58 +0200
Subject: [Enigma-game-svn] r896 - in trunk: doc/reference src
Message-ID: <200710071218.l97CIwTl019377@sheep.berlios.de>

Author: andreasl
Date: 2007-10-07 14:18:57 +0200 (Sun, 07 Oct 2007)
New Revision: 896

Modified:
   trunk/doc/reference/enigma-ref.texi
   trunk/src/items.cc
   trunk/src/stones_complex.cc
   trunk/src/stones_simple.cc
Log:
Fixing some minor bugs:
 - Shogun-item now deactives itself when it finds that the
   activating shogun-stone vanished without sending a proper
   message.
 - Shogun-stone now sends a proper message on removal.
 - Fixed several segfaults that result from removing a
   shogun-stone via a self-triggered action.
 - typos
Refman:
 - Added a small explanation to the glass stone table.
Remark: 
 - In ShogunStone::on_impulse, the identification of the
   new stone happens via getId.


Modified: trunk/doc/reference/enigma-ref.texi
===================================================================
--- trunk/doc/reference/enigma-ref.texi	2007-10-05 19:41:29 UTC (rev 895)
+++ trunk/doc/reference/enigma-ref.texi	2007-10-07 12:18:57 UTC (rev 896)
@@ -4681,6 +4681,16 @@
 @item st-beads @tab - @tab pass @tab no
 @end multitable
 
+These entries can be visualized as follows: A glassstone is transparent for
+laser light, if it is not dark, or if it is hollow. Exception is
+ at code{st-beads}, whose irregular sides would scatter the beam. A glassstone
+can always be passed by invisible actors, with three exceptions:
+ at code{st-glass3}, whose inside is filled with red stripes, and the two movables
+ at code{st-glass1_move} and @code{st-glass2_move} which have a non-glass frame
+which the actor can use to move the stone. @code{st-glass_move} does not have 
+such a frame and cannot be moved by an invisible actor.
+
+
 @node Breakable Stones, Oxyd Compatibility Stones, Glassstones, Stones
 @subsection Breakable Stones
 

Modified: trunk/src/items.cc
===================================================================
--- trunk/src/items.cc	2007-10-05 19:41:29 UTC (rev 895)
+++ trunk/src/items.cc	2007-10-07 12:18:57 UTC (rev 896)
@@ -1529,6 +1529,8 @@
     if (activated) {
         if (st == 0) {
             warning("stone_change: Stone disappeared w/o sending me a proper message!");
+            activated = false;
+            world::PerformAction(this, false);
         }
     }
 }

Modified: trunk/src/stones_complex.cc
===================================================================
--- trunk/src/stones_complex.cc	2007-10-05 19:41:29 UTC (rev 895)
+++ trunk/src/stones_complex.cc	2007-10-07 12:18:57 UTC (rev 896)
@@ -1868,8 +1868,8 @@
 
         void add_hole(Holes h) {
             set_attrib("holes", get_holes() | h);
+            init_model();
             notify_item();
-            init_model();
         }
 
         void on_creation (GridPos p) {
@@ -1877,6 +1877,12 @@
             notify_item();
         }
 
+        void on_removal(GridPos p) {
+            Stone::on_removal(p);
+            if (Item *it = GetItem(p))
+                SendMessage(it, "noshogun");
+        }
+
         void on_impulse(const Impulse& impulse);
 
         void init_model() {
@@ -1949,8 +1955,8 @@
     // Remove/modify source stone:
     if (Holes newholes = Holes(holes & ~smallest)) {
         set_holes(newholes);
+        init_model();
         notify_item();
-        init_model();
     }
     else {
         if (Value v = getAttr("name")) old_name = v.get_string(); // store name of disappearing stone
@@ -1966,8 +1972,13 @@
     }
     else {                       // create new
         target = new ShogunStone(smallest);
+        int targetId = target->getId();
         SetStone(destpos, target);
-        target->on_move();
+        // Shogunstone might have disappeared via some triggered action.
+        // Most important example: Last box in a sokoban.
+        if (Stone *st = GetStone(destpos))
+            if (st->getId() == targetId)
+                st->on_move();
     }
 
     if (!old_name.empty())

Modified: trunk/src/stones_simple.cc
===================================================================
--- trunk/src/stones_simple.cc	2007-10-05 19:41:29 UTC (rev 895)
+++ trunk/src/stones_simple.cc	2007-10-07 12:18:57 UTC (rev 896)
@@ -966,7 +966,7 @@
 \endverbatim
 
 Note: There are two flavors of st-wood which may be specified
-by using st-wood1 or st-wood2, and a two related kinds: st-flrock,
+by using st-wood1 or st-wood2, and two related kinds: st-flrock,
 which creates the unburnable fl-rock and denies fire under it, and 
 the burnable st-hay, which leaves the burnable but stable fl-hay
 behind.



From ral at mail.berlios.de  Sun Oct  7 22:23:26 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 7 Oct 2007 22:23:26 +0200
Subject: [Enigma-game-svn] r897 - trunk/src
Message-ID: <200710072023.l97KNQ5X010340@sheep.berlios.de>

Author: ral
Date: 2007-10-07 22:23:25 +0200 (Sun, 07 Oct 2007)
New Revision: 897

Modified:
   trunk/src/WorldProxy.cc
   trunk/src/enigma.cc
   trunk/src/enigma.hh
   trunk/src/lua.cc
   trunk/src/objects_decl.hh
Log:
Trunk 1.1: Lua API Reengineering part II
- Value add types BOOL and OBJECT
- switch engine to use new BOOL values instead of 1/nil
- 1.10 levels convert BOOL Value to Lua 5 booleans
- <1.10 levels  convert BOOL Value to Lua 4 1/nil style
- wo["FollowMode"] added
- checkboard tile support added
Note:
- action callback values are affected, too


Modified: trunk/src/WorldProxy.cc
===================================================================
--- trunk/src/WorldProxy.cc	2007-10-07 12:18:57 UTC (rev 896)
+++ trunk/src/WorldProxy.cc	2007-10-07 20:23:25 UTC (rev 897)
@@ -19,6 +19,7 @@
 
 #include "WorldProxy.hh"
 #include "server.hh"
+#include "display.hh"
 
 using namespace enigma;
 
@@ -43,6 +44,8 @@
     Value WorldProxy::getAttr(const string& key) const {
         if (key == "AllowTogglePlayer") {
             return server::AllowTogglePlayer;
+        } else if (key == "ConserveLevel") {
+            return server::ConserveLevel;
         } else if (key == "CreatingPreview") {
             return server::CreatingPreview;  // read only
         } else if (key == "IsDifficult") {
@@ -90,6 +93,8 @@
             server::AllowTogglePlayer = val;
         } else if (key == "ConserveLevel") {
             server::ConserveLevel = val.to_bool();
+        } else if (key == "FollowMode") {
+            display::SetFollowMode((display::FollowMode)((int)val));
         } else if (key == "ShowMoves") {
             server::ShowMoves = val.to_bool();
             STATUSBAR->show_move_counter (server::ShowMoves);

Modified: trunk/src/enigma.cc
===================================================================
--- trunk/src/enigma.cc	2007-10-07 12:18:57 UTC (rev 896)
+++ trunk/src/enigma.cc	2007-10-07 20:23:25 UTC (rev 897)
@@ -1,5 +1,6 @@
 /*
  * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2007 Ronald Lamprecht
  *
  * This program is free software; you can redistribute it and/or
  * modify it under the terms of the GNU General Public License
@@ -21,6 +22,7 @@
 #include "enigma.hh"
 #include "ecl.hh"
 #include "main.hh"
+#include "objects_decl.hh"
 
 #include <iostream>
 #include <ctime>
@@ -30,7 +32,6 @@
 using namespace ecl;
 using namespace enigma;
 
-
 /* -------------------- Game Type -------------------- */
 
 static const char *versionName[GAMET_COUNT+1] = {
@@ -107,7 +108,6 @@
     return sfx[d+1];
 }
 
-
 /* -------------------- DirectionBits -------------------- */
 
 DirectionBits
@@ -140,14 +140,17 @@
      val.dval = i;
 }
 
-Value::Value(bool b) {
-     if (b) {
-        type = DOUBLE;
-        val.dval = 1;
-     } else
-        type = NIL;
+Value::Value(bool b) : type (BOOL) {
+     val.dval = b;
 }
 
+Value::Value(Object *obj) : type (OBJECT) {
+     if (obj != NULL)
+         val.dval = obj->getId();
+     else
+         val.dval = 0;
+}
+
 Value::Value(Type t) : type (t) {
     switch (t) {
         case DOUBLE :
@@ -157,8 +160,11 @@
             val.str = new char[1];
             val.str[0] = 0;
             break;
+        case BOOL :
+            val.dval = false;
+            break;
         case OBJECT :
-            // tbd
+            val.dval = (double) NULL;
             break;
     }
 }
@@ -196,11 +202,11 @@
     else
         switch (type) {
             case DOUBLE :
+            case BOOL :
+            case OBJECT :
                 return val.dval == other.val.dval;
             case STRING :
                 return strcmp(val.str, other.val.str) == 0;
-            case OBJECT :
-                return false; // tbd
         }
     return true;
 }
@@ -227,6 +233,7 @@
 Value::operator double() const {
     switch (type) {
         case DOUBLE: 
+        case BOOL: 
             return val.dval;
         case STRING:
             return atof(val.str);  // TODO use strtod and eval remaining part of string
@@ -238,13 +245,22 @@
 Value::operator int() const {
     switch (type) {
         case DOUBLE:
+        case BOOL: 
             return round_nearest<int>(val.dval);
         case STRING: 
             return atoi(val.str);  //TODO use strtol and eval remaining part of string
-    default: return 0;
+        default: return 0;
     }
 }
 
+Value::operator Object *() const {
+    switch (type) {
+        case OBJECT:
+            return Object::getObject(round_nearest<int>(val.dval));
+        default: return NULL;
+    }
+}
+
 Value::operator const char*() const {
     static std::string s;
     switch (type) {
@@ -302,6 +318,8 @@
 
 bool Value::to_bool() const {
     switch (type) {
+        case BOOL :
+            return val.dval;
         case NIL :
         case DEFAULT :
             return false;

Modified: trunk/src/enigma.hh
===================================================================
--- trunk/src/enigma.hh	2007-10-07 12:18:57 UTC (rev 896)
+++ trunk/src/enigma.hh	2007-10-07 20:23:25 UTC (rev 897)
@@ -1,5 +1,6 @@
 /*
  * Copyright (C) 2002,2004 Daniel Heck
+ * Copyright (C) 2007 Ronald Lamprecht
  *
  * This program is free software; you can redistribute it and/or
  * modify it under the terms of the GNU General Public License
@@ -36,7 +37,9 @@
 
 namespace enigma
 {
-
+    using namespace world;
+    class world::Object;
+    
 /* -------------------- Various types -------------------- */
 
     enum Difficulty {
@@ -177,25 +180,28 @@
             DEFAULT,  ///< Pseudotype for a not existing attribute that should
                       ///< cause the default behaviour of the object
             NIL,      ///< Value that is equivalent to Lua "nil". It represents
-                      ///< the bool "false"
+                      ///< an invalid value
+            BOOL,     ///< Value that represents bool values "true" and "false".
             DOUBLE,   ///< Value is numerical and can take a "double". It is used
                       ///< for other numericals values like "int", too.
             STRING,   ///< Value is a string. Such a string may encode another
                       ///< type that has no native representation in Value
-            OBJECT    ///< Value is an object id. The id is a persistent object
+            OBJECT,    ///< Value is an object id. The id is a persistent object
                       ///< identifier.
+            GROUP     ///< Value is a group of objects.
         };
 
         Value();                       ///< Constructor for NIL value that 
-                                       ///< represents boolean "false", too 
+                                       ///< represents an invalid value
         Value(double d);               ///< Constructor for DOUBLE value
         Value(const char* str);        ///< Constructor for STRING value. The
                                        ///< given string is duplicated
         Value(const std::string& str); ///< Constructor for STRING value. The
                                        ///< given string is duplicated
         Value(int i);                  ///< Constructor for DOUBLE value
-        Value(bool b);                 ///< Constructor for a value that properly
-                                       ///< represents the given bool
+        Value(bool b);                 ///< Constructor for BOOL value
+        Value(Object *obj);            ///< Constructor for OBJECT value that properly
+                                       ///< represents a persistent reference to an object
         Value(Type t);                 ///< Constructor for a given type. The
                                        ///< value defaults to 0.0 or ""
         ~Value();
@@ -251,6 +257,12 @@
         operator int() const;
         
         /**
+         * Conversion of a value to an object reference. All values besides valid
+         * object values default to a NULL reference.
+         */
+        operator Object *() const;
+        
+        /**
          * Conversion of a value to a <code>char *</code> just for initialization
          * of a std::string. Numerical values are converted to a string like it
          * id done by LUA. All other values default to an empty string.

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2007-10-07 12:18:57 UTC (rev 896)
+++ trunk/src/lua.cc	2007-10-07 20:23:25 UTC (rev 897)
@@ -140,32 +140,6 @@
     lua_pop (L, 1);
 }
 
-static void push_value(lua_State *L, const Value &val) {
-    switch (val.getType()) {
-        case Value::NIL:
-        case Value::DEFAULT :
-            lua_pushnil(L);
-            break;
-        case Value::DOUBLE:
-            lua_pushnumber(L, val.get_double());
-            break;
-        case Value::STRING:
-            lua_pushstring(L, val.get_string());
-            break;
-    }
-}
-
-static Value to_value(lua_State *L, int idx) {
-    switch (lua_type(L, idx)) {
-        case LUA_TNIL: return Value();
-        case LUA_TNUMBER: return Value(lua_tonumber(L,idx));
-        case LUA_TSTRING: return Value(lua_tostring(L,idx));
-        case LUA_TBOOLEAN: return (lua_toboolean(L,idx)) ? Value(1) : Value();
-        default: throwLuaError(L,"Cannot convert type to Value.");
-    }
-    return Value();
-}
-
 static bool checkMetadata (lua_State *L, int idx, const char *name) {
     bool result = false;
     if (lua_getmetatable(L, idx)) {  // does it have a metatable?
@@ -228,7 +202,7 @@
     return obj;  // NULL if object does no longer exist
 }
 
-static void pushobject (lua_State *L, Object *obj) {
+static void pushobject(lua_State *L, Object *obj) {
     int *udata;
     /* Lua does not allow NULL pointers in userdata variables, so
        convert them manually to `nil' values. */
@@ -245,7 +219,54 @@
     }
 }
 
+static void push_value(lua_State *L, const Value &val) {
+    switch (val.getType()) {
+        case Value::NIL:
+        case Value::DEFAULT :
+            lua_pushnil(L);
+            break;
+        case Value::DOUBLE:
+            lua_pushnumber(L, val.get_double());
+            break;
+        case Value::STRING:
+            lua_pushstring(L, val.get_string());
+            break;
+        case Value::BOOL:
+            if (server::EnigmaCompatibility < 1.10) {
+                if (val.to_bool())
+                    lua_pushnumber(L, 1);
+                else
+                    lua_pushnil(L);
+            } else {
+                lua_pushboolean(L, val.to_bool());
+            }
+            break;
+        case Value::OBJECT:
+            pushobject(L, (Object *)val);
+            break;
+    }
+}
 
+static Value to_value(lua_State *L, int idx) {
+    switch (lua_type(L, idx)) {
+        case LUA_TNIL: 
+            return Value();
+        case LUA_TNUMBER: 
+            return Value(lua_tonumber(L,idx));
+        case LUA_TSTRING: 
+            return Value(lua_tostring(L,idx));
+        case LUA_TBOOLEAN: 
+            return Value((bool)lua_toboolean(L,idx));
+        case LUA_TUSERDATA:
+            if (is_object(L, idx))
+                return Value(to_object(L, idx));
+        default: 
+            throwLuaError(L,"Cannot convert type to Value.");
+    }
+    return Value();
+}
+
+
 /* -------------------- Interface routines -------------------- */
 
 
@@ -1559,6 +1580,10 @@
     setObjectAttributes(obj, L);
     switch (obj->getObjectType()) {
         case Object::FLOOR :
+            if (Value odd = obj->getAttr("checkerboard")) {
+                if ((xi+yi)%2 != (int)odd)
+                    break;
+            }
             world::SetFloor(GridPos(xi,yi), dynamic_cast<Floor *>(obj));
             break;
         case Object::STONE :

Modified: trunk/src/objects_decl.hh
===================================================================
--- trunk/src/objects_decl.hh	2007-10-07 12:18:57 UTC (rev 896)
+++ trunk/src/objects_decl.hh	2007-10-07 20:23:25 UTC (rev 897)
@@ -56,7 +56,7 @@
             FLOOR,
             ITEM,
             ACTOR
-            };
+        };
             
         Object();
         Object(const char *kind);



From andreasl at mail.berlios.de  Tue Oct  9 22:04:58 2007
From: andreasl at mail.berlios.de (andreasl at BerliOS)
Date: Tue, 9 Oct 2007 22:04:58 +0200
Subject: [Enigma-game-svn] r898 - homepage/input
Message-ID: <200710092004.l99K4wgh018069@sheep.berlios.de>

Author: andreasl
Date: 2007-10-09 22:04:58 +0200 (Tue, 09 Oct 2007)
New Revision: 898

Modified:
   homepage/input/press.html
   homepage/input/press_de.html
   homepage/input/testimonials.html
   homepage/input/testimonials_de.html
Log:
Homepage:
 - Adding a testimonial and press links (English and German)
Todo:
 - Russian translations
 - maybe some links to Russian articles about Enigma
   (add to all languages)


Modified: homepage/input/press.html
===================================================================
--- homepage/input/press.html	2007-10-07 20:23:25 UTC (rev 897)
+++ homepage/input/press.html	2007-10-09 20:04:58 UTC (rev 898)
@@ -4,7 +4,26 @@
 We think it is time to collect articles about Enigma.
 
 <ul>
-  <li><a href="http://en.wikipedia.org/wiki/Enigma_%28game%29">Wikipedia</a></li>
+  <li><a href="http://en.wikipedia.org/wiki/Enigma_%28game%29"
+        >Wikipedia</a></li>
+  <li><a href="http://www.associatedcontent.com/article/335780/enigma_classic_memory_game_meets_fastpaced.html"
+        >AssociatedContent</a></li>
+  <li><a href="http://mac.softpedia.com/get/Games/Enigma.shtml"
+        >Softpedia</a></li>
+  <li><a href="http://www.versiontracker.com/dyn/moreinfo/macosx/21160&mode=info"
+        >VersionTracker</a></li>
+  <li><a href="http://www.computerbild.de/programme/Enigma-1.01_7766.html"
+        >Computer Bild (German)</a></li>
+  <li><a href="http://www.chip.de/downloads/c1_downloads_19309102.html"
+        >Chip Online (German)</a></li>
+  <li><a href="http://software-portal.faz.net/ie/64780/"
+        >FAZ.net (German)</a></li>
+  <li><a href="http://www.opensource-dvd.de/spiele1.htm#enigma"
+        >Opensource-DVD (German)</a></li>
+  <li><a href="http://www.bonnsite.de/softtip.html?action=show&number=154"
+        >Bonnsite (German)</a></li>
+  <li><a href="http://www.heise.de/software/download/enigma/20301a24917"
+        >Heise (German, 0.81)</a></li>
 </ul>
 
 If you notice or publish yourself an article please let us know

Modified: homepage/input/press_de.html
===================================================================
--- homepage/input/press_de.html	2007-10-07 20:23:25 UTC (rev 897)
+++ homepage/input/press_de.html	2007-10-09 20:04:58 UTC (rev 898)
@@ -4,7 +4,26 @@
 Wir denken, es ist an der Zeit, Artikel &uuml;ber Enigma zu sammeln.
 
 <ul>
-  <li><a href="http://en.wikipedia.org/wiki/Enigma_%28game%29">Wikipedia (englisch)</a></li>
+  <li><a href="http://en.wikipedia.org/wiki/Enigma_%28game%29"
+        >Wikipedia (englisch)</a></li>
+  <li><a href="http://www.associatedcontent.com/article/335780/enigma_classic_memory_game_meets_fastpaced.html"
+        >AssociatedContent (englisch)</a></li>
+  <li><a href="http://mac.softpedia.com/get/Games/Enigma.shtml"
+        >Softpedia (englisch)</a></li>
+  <li><a href="http://www.versiontracker.com/dyn/moreinfo/macosx/21160&mode=info"
+        >VersionTracker (englisch)</a></li>
+  <li><a href="http://www.computerbild.de/programme/Enigma-1.01_7766.html"
+        >Computer Bild (deutsch)</a></li>
+  <li><a href="http://www.chip.de/downloads/c1_downloads_19309102.html"
+        >Chip Online (deutsch)</a></li>
+  <li><a href="http://software-portal.faz.net/ie/64780/"
+        >FAZ.net (deutsch)</a></li>
+  <li><a href="http://www.opensource-dvd.de/spiele1.htm#enigma"
+        >Opensource-DVD (deutsch)</a></li>
+  <li><a href="http://www.bonnsite.de/softtip.html?action=show&number=154"
+        >Bonnsite (deutsch)</a></li>
+  <li><a href="http://www.heise.de/software/download/enigma/20301a24917"
+        >Heise (deutsch, 0.81)</a></li>
 </ul>
 
 Wenn Ihnen ein Artikel auff&auml;llt, oder Sie einen ver&ouml;ffentlichen,

Modified: homepage/input/testimonials.html
===================================================================
--- homepage/input/testimonials.html	2007-10-07 20:23:25 UTC (rev 897)
+++ homepage/input/testimonials.html	2007-10-09 20:04:58 UTC (rev 898)
@@ -96,4 +96,16 @@
 href="http://macgameblog.com/archives/Enigma-88.html">The Mac Game Blog</a>
 </p>
 
+<p class="quote">
+&ldquo;With a nearly endless number of levels and the entire world to compete
+against, Enigma's challenges will never run out. This game has something for
+everyone, whether you are in the mood for a tough puzzle or a quick test of
+dexterity. I strongly recommend anyone who likes puzzles to download and give
+Enigma a try.&rdquo;</p>
+<p class="author">Ayhoe on <a
+href="http://www.associatedcontent.com/article/335780/enigma_classic_memory_game_meets_fastpaced.html"
+>AssociatedContent</a>
+</p>
+
+
 </div>

Modified: homepage/input/testimonials_de.html
===================================================================
--- homepage/input/testimonials_de.html	2007-10-07 20:23:25 UTC (rev 897)
+++ homepage/input/testimonials_de.html	2007-10-09 20:04:58 UTC (rev 898)
@@ -117,4 +117,15 @@
 href="http://macgameblog.com/archives/Enigma-88.html">The Mac Game Blog</a>
 (&uuml;bersetzt)</p>
 
+<p class="quote">
+&ldquo;Mit einer schier endlosen Zahl an Levels und der gesamten Welt als
+Gegenspieler, werden sich Enigmas Aufgaben niemals ersch&ouml;pfen. Dieses
+Spiel hat f&uuml;r jeden etwas, ob man nun Lust auf ein hartes R&auml;tsel oder
+einen schnellen Geschicklichkeitstest hat. Ich empfehle jedem, der R&auml;tsel
+mag, Enigma herunterzuladen und auszuprobieren.&rdquo;</p>
+<p class="author">Ayhoe auf <a
+href="http://www.associatedcontent.com/article/335780/enigma_classic_memory_game_meets_fastpaced.html"
+>AssociatedContent</a>
+(&uuml;bersetzt)</p>
+
 </div>



From ral at mail.berlios.de  Wed Oct 10 23:22:59 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Wed, 10 Oct 2007 23:22:59 +0200
Subject: [Enigma-game-svn] r899 - trunk/src
Message-ID: <200710102122.l9ALMxri022705@sheep.berlios.de>

Author: ral
Date: 2007-10-10 23:22:58 +0200 (Wed, 10 Oct 2007)
New Revision: 899

Modified:
   trunk/src/stones_complex.cc
Log:
Trunk 1.1:
- fix st-bolder: avoid bolder stops in case of double rotators,
    enable single trigger messages


Modified: trunk/src/stones_complex.cc
===================================================================
--- trunk/src/stones_complex.cc	2007-10-09 20:04:58 UTC (rev 898)
+++ trunk/src/stones_complex.cc	2007-10-10 21:22:58 UTC (rev 899)
@@ -544,23 +544,20 @@
             case IDLE:
                 if (!have_obstacle(dir)) {
                     state = ACTIVE;
-                    trigger_obstacle(dir);
                 }
 //                 if (Model *m = get_model())
                 m->restart();
 //                init_model();
                 break;
 
-            case ACTIVE: {
+            case ACTIVE:
                 trigger_obstacle(dir);
                 if (!move_stone(dir)) {
-//                    if (state == MOVING) // state may be FALLING
-                        state = IDLE;
+                    state = IDLE;
                 }
                 init_model();
                 break;
             }
-            }
         }
 
         void actor_hit(const StoneContact &sc) {
@@ -586,10 +583,17 @@
                 return;
 
             if (impulse.sender && impulse.sender->is_kind("st-rotator")) {
-                set_dir(impulse.dir);
+                set_dir(impulse.dir);  // activate
             }
             init_model();
-            move_stone(impulse.dir);
+            // try to move, activate - trigger with guarantee
+            if (!move_stone(impulse.dir))
+                // the trigger of an activation occurs on animcb - in case of
+                // two rotators the trigger in one direction would be skipped
+                // without this explicit trigger statement!
+                // Furtheron enable stoneimpulse - bolder combi to emit single
+                // trigger messages
+                trigger_obstacle(impulse.dir);
         }
 
         virtual Value message(const string& msg, const Value &val) {
@@ -603,7 +607,7 @@
     DEF_TRAITSM(BolderStone, "st-bolder", st_bolder, MOVABLE_IRREGULAR);
 }
 
-
+
 /* -------------------- BlockerStone -------------------- */
 
 /** \page st-blocker Blocker Stone



From andreasl at mail.berlios.de  Fri Oct 12 00:59:06 2007
From: andreasl at mail.berlios.de (andreasl at BerliOS)
Date: Fri, 12 Oct 2007 00:59:06 +0200
Subject: [Enigma-game-svn] r900 - trunk/src
Message-ID: <200710112259.l9BMx6XY029811@sheep.berlios.de>

Author: andreasl
Date: 2007-10-12 00:59:06 +0200 (Fri, 12 Oct 2007)
New Revision: 900

Modified:
   trunk/src/laser.cc
Log:
Fix to stone traits (revision 884)
 - Fixed bug that mirrors don't respond to movable-attribute
Note:
 - Setting the attribute during game still doesn't provoke a
   redraw of the stone.


Modified: trunk/src/laser.cc
===================================================================
--- trunk/src/laser.cc	2007-10-10 21:22:58 UTC (rev 899)
+++ trunk/src/laser.cc	2007-10-11 22:59:06 UTC (rev 900)
@@ -467,6 +467,8 @@
         }
 
         void init_model();
+        void set_attrib(const string& key, const Value &val);
+
     private:
 
         StoneTraits traits;
@@ -510,7 +512,7 @@
     traits.flags = stf_none;
     traits.material = material_stone;
     traits.restitution = 1.0;
-    traits.movable = movable ? MOVABLE_STANDARD : MOVABLE_PERSISTENT;
+    //traits.movable is already set via set_attrib("movable", ...);
 }
 
 void MirrorStone::init_model() {
@@ -580,6 +582,12 @@
     sound_event ("mirrorturn");
 }
 
+void MirrorStone::set_attrib(const string& key, const Value &val) {
+    Stone::set_attrib(key, val);
+    if (key == "movable")
+        traits.movable = to_bool(val) ? MOVABLE_STANDARD : MOVABLE_PERSISTENT;
+}
+    
 
 /* -------------------- Plane Mirror -------------------- */
 namespace



From andreasl at mail.berlios.de  Fri Oct 12 01:48:37 2007
From: andreasl at mail.berlios.de (andreasl at BerliOS)
Date: Fri, 12 Oct 2007 01:48:37 +0200
Subject: [Enigma-game-svn] r901 - in trunk: data/levels/enigma_experimental
	data/levels/lib src
Message-ID: <200710112348.l9BNmbn7006527@sheep.berlios.de>

Author: andreasl
Date: 2007-10-12 01:48:36 +0200 (Fri, 12 Oct 2007)
New Revision: 901

Added:
   trunk/data/levels/lib/libsoko-designlist.xml
   trunk/data/levels/lib/libsoko-endphase.xml
Modified:
   trunk/data/levels/enigma_experimental/test_libsoko.xml
   trunk/data/levels/lib/libsoko.xml
   trunk/src/stones.cc
   trunk/src/world.cc
Log:
Trunk:
 - When a stone moves, neighbors are freezechecked as well.
Sokoban:
 - Split libsoko.xml into
    libsoko.xml            : base file
    libsoko-endphase.xml   : endphase functions and goal triggering
    libsoko-designlist.xml : design list and ralfcode conversion table
 - Packed all global variables into a single array of struct named
   "sokoarea" (which is global). This allows to set and control
   multiple sokoban-kind areas in a single level with libsoko.
 - Redundant walls are removed from level strings and the level
   is trimmed from empty lines and columns.
 - Added a table to convert Ralf's design codes into libsoko's
   design numbers.
 - First works on endphase:
    - easy hooking of endphase and goal triggering to use
      the lib to construct sokoareas in more complicated levels
    - transform level for endphase
    - algorithm "outside" complete
    - algorithm "circle" now uses correct oxyd stones
    - added endphase information to the first 75 designs,
        but these are not final.
 - Made test_libsoko easier to solve. ;-)
Todo:
 - Remaining endphase algorithms
   (forget the current code in endphase_set_block_oxyds, it's rubbish)
Note:
 - libsoko uses "find"-functions from the string-library.
   If they're not available with your version of lua, please
   give me a note.


Modified: trunk/data/levels/enigma_experimental/test_libsoko.xml
===================================================================
--- trunk/data/levels/enigma_experimental/test_libsoko.xml	2007-10-11 22:59:06 UTC (rev 900)
+++ trunk/data/levels/enigma_experimental/test_libsoko.xml	2007-10-11 23:48:36 UTC (rev 901)
@@ -3,7 +3,7 @@
   <el:protected>
     <el:info el:type="level">
       <el:identity el:title="Libsoko - Test" el:subtitle="" el:id="test_libsoko"/>
-      <el:version el:score="1" el:release="1" el:revision="0" el:status="experimental"/>
+      <el:version el:score="1" el:release="1" el:revision="2" el:status="experimental"/>
       <el:author el:name="Andreas Lochmann" el:email="" el:homepage=""/>
       <el:copyright>Copyright ? 2007 Andreas Lochmann</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
@@ -267,13 +267,13 @@
 .."> 13\n"
 .."  #####\n"
 .."  #   #\n"
-.."  # $ #\n"
-.." ## #$#\n"
+.."  #   #\n"
+.." ## # #\n"
 .."##   @##\n"
-.."#  .#$ #\n"
-.."#.#*.. #\n"
-.."#  . # #\n"
-.."# $# $ #\n"
+.."#  $#  #\n"
+.."# #.   #\n"
+.."#    # #\n"
+.."#  #   #\n"
 .."##   ###\n"
 .." #####\n"
 
@@ -311,16 +311,28 @@
 
 
 
-design_min = 76
+design_min = 1 --76
 design_max = table.getn(design_list)
 
 design_number = design_max
 
+--create_sokoball(multilevel2, 1, 1)
 create_sokoball(multilevel2, 13, design_number)
 --create_sokoball(chessoban, 2)
+--draw_sokoball(0, 0, chessoban, 2, nil, true) --leftending)
 set_stone("st-switch", 9, 1, {action="callback", target="design_minus_one"})
 set_stone("st-switch", 10, 1, {action="callback", target="design_plus_one"})
+design_statistics()
 
+function leftending(nr)
+  if nr == 2 then
+    recreate_sokoball(150, 2)
+  else
+    error("Should never happen!")
+  end
+end
+
+
 function design_minus_one()
   design_number = design_number - 1
   if design_number < design_min then
@@ -340,6 +352,7 @@
   set_stone("st-switch", 10, 1, {action="callback", target="design_plus_one"})
 end
 
+
     ]]></el:luamain>
     <el:i18n>
       <el:string el:key="title">

Added: trunk/data/levels/lib/libsoko-designlist.xml
===================================================================
--- trunk/data/levels/lib/libsoko-designlist.xml	2007-10-11 22:59:06 UTC (rev 900)
+++ trunk/data/levels/lib/libsoko-designlist.xml	2007-10-11 23:48:36 UTC (rev 901)
@@ -0,0 +1,538 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="library">
+      <el:identity el:title="" el:id="lib/libsoko-designlist"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="experimental"/>
+      <el:author  el:name="Enigma Team" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2007 Enigma Team</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="false" el:network="false"/>
+      <el:comments>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+
+-- This "library" is merely a collection of designs, outsourced from
+-- libsoko.xml. Don't include this library with your levels (it won't
+-- have any effect), but libsoko.xml.
+
+------------------------------------------------------------------------
+-- Designs
+------------------------------------------------------------------------
+
+-- This section holds a table with all default designs. Each design
+-- is again a table consisting of the following entries:
+--    wall, inf, outf, box, goal, oxyd, endp
+-- Each of these entries is either a string representing the objects to
+-- be used, or a table if several objects shall be used. Such a
+-- combination of objects will be called "element".
+--
+-- If object types (like floors) repeat in the table, they are used in
+-- a checkerboard pattern. You can change this pattern by adding an
+-- element of the form "al:ALGORITHM", where ALGORITHM is one of the
+-- algorithms listed below. Same for "fr:1.23" and "mf:4.5" for friction
+-- and mouseforce. From all these attributes, only the last one will
+-- be used, all others ignored. This contrasts with the situation of
+-- the gaming objects ("fl-", "st-", "it-"), whose order doesn't matter.
+--
+-- "oxyd" only holds the oxyd's flavor, "endp" the way of resolving the
+-- level from Sokoban to opening oxyds. Use "st-none" and "it-none" to
+-- place spaces between stones/items.
+--
+-- The table might hold additional flags. Currently, only "white"
+-- is implemented, which turns the marble and chess-knights white.
+-- If an entry is missing, the corresponding entry from default_design
+-- will be used.
+--
+-- Example:
+--
+--   [5] = { outf = "fl-leaves", inf = "fl-leavesb", box = "st-wood"
+--           wall = {"st-glass", "fl-wood", "fl-leaves", "al:random"},
+--           oxyd = "a", white = true }
+--
+--   will define design 5. The walls will alternate between
+--   st-glass/fl-wood and st-glass/fl-leaves. The goal will be
+--   it-trigger by default. The actor will be ac-whiteball.
+--
+-- Possible flags:
+--
+--   white  : Use white marble and st-chess_white.
+--
+-- Algorithms:
+--
+--   checkerboard : default, up to 3 different floors in checkerboard pattern
+--   lines : arbitrary number of floors in diagonal lines
+--   waves : works best with 4 different floors
+--   random : arbitrary number of floors, randomly chosen
+--
+
+default_design = {
+  wall = { "st-rock3", "fl-leaves" },
+   inf = { "fl-wood" },
+  outf = { "fl-water", "st-invisible" },
+   box = { "st-brownie" },
+  goal = { "it-trigger" },
+  oxyd = "a",
+  endp = { alg = "circle" }
+}
+
+design_list = {
+
+-- endp-algs: circle, ralf, hide, outside, allcrack, block, fourswitch
+--            vortex, gradients, magnets, jumpyoxyds
+
+-- Ralf's designs
+[1]={box="st-brownie", wall="st-bluegray", inf="fl-bluegray",
+     outf="fl-space", door="st-door_a", oxyd="a",
+     endp={goal="st-none", alg="circle"}},
+[2]={box="st-glass_move", wall="st-bluegray", inf="fl-bluegray",
+     outf="fl-water", door="st-door_b", oxyd="a",
+     endp={goal="st-glass1_hole", alg="ralf"}},
+[3]={box="st-wood-growing", wall="st-bluegray", inf="fl-bluegray",
+     outf="fl-abyss", door="st-door_c", oxyd="a",
+     endp={goal={"fl-abyss", "it-none"}, wall="st-thief", give="it-hammer",
+           alg="block:st-plain_cracked"}},
+[4]={box="st-brownie", wall="st-bluegray", inf="fl-white",
+     outf="fl-sahara", door="st-door_a", oxyd="c",
+     endp={goal="st-none", wall={"st-none", "fl-bluegray"}, alg="outside"}},
+[5]={box="st-wood", wall="st-bluegray", inf="fl-white",
+     outf="fl-space", door="st-door_c", oxyd="c",
+     endp={goal={"fl-abyss", "it-none"}, wall={"st-bluegray_hole"}, alg="outside"}},
+[6]={box="st-greenbrown_move", wall="st-bluegray", inf="fl-white",
+     outf="fl-space", door="st-door_b", oxyd="c",
+     endp={goal="st-greenbrown_hole", wall="st-thief", give="it-sword",
+           alg="block:st-knight"}},
+[7]={box="st-wood", wall="st-bluegray", inf="fl-white",
+     outf="fl-space", door="st-door_c", oxyd="c",
+     endp={goal={"fl-abyss", "it-none"}, alg="fourswitch"}},
+
+[8]={box="st-rock3_move", wall="st-blue-sand", inf="fl-light",
+     outf="fl-rough-blue", door="st-door_b", oxyd="d",
+     endp={goal="st-rock3_break", give="it-hammer", alg="ralf"}},
+[9]={box="st-block", wall="st-blue-sand", inf="fl-light",
+     outf="fl-rough-blue", door="st-blocker", oxyd="d",
+     endp={goal="st-none", alg="circle"}},
+[10]={box="st-shogun", wall="st-blue-sand", inf="fl-rough",
+      outf="fl-space", door="st-door_a", oxyd="b", goal="it-shogun-s",
+      endp={goal="st-none", alg="magnets"}},
+[11]={box="st-marble_move", wall="st-blue-sand", inf="fl-rough",
+      outf="fl-abyss", door="st-door_b", oxyd="b",
+      endp={goal="st-marble", alg="vortex"}},
+[12]={box="st-shogun", wall="st-blue-sand", inf="fl-rough",
+      outf="fl-space", door="st-door_a", oxyd="b", goal="it-shogun-s",
+      endp={goal="st-none", give="it-hammer", alg="block:st-stone_break"}},
+[13]={box="st-block", wall="st-blue-sand", inf="fl-rough",
+      outf="fl-leaves", door="st-blocker", oxyd="b",
+      endp={goal={"fl-swamp", "it-none"}, alg="ralf"}},
+
+[14]={box="st-brownie", wall={"st-glass", "fl-himalaya", "fl-water"},
+      inf="fl-himalaya", outf="fl-water", door="st-door_a", oxyd="a",
+      endp={goal="st-pull", alg="magnets"}},
+[15]={box="st-brownie", wall={"st-glass", "fl-himalaya", "fl-water"},
+      inf="fl-himalaya", outf="fl-water", door="st-door_a", oxyd="a",
+      endp={goal="st-none", alg="fourswitch"}},
+[16]={box="st-shogun", wall={"st-glass", "fl-rough-red", "fl-abyss"},
+      inf="fl-rough-red", outf="fl-abyss", door="st-door_b", oxyd="c",
+      goal="it-shogun-s",
+      endp={alg="circle"}},
+[17]={box="st-brownie", wall={"st-glass", "fl-rough-red", "fl-sahara"},
+      inf="fl-rough-red", outf="fl-sahara", door="st-door_a", oxyd="c",
+      endp={goal="st-grate2", wall="st-grate2", alg="outside"}},
+[18]={box="st-greenbrown_move", wall={"st-glass", "fl-wood", "fl-water"},
+      inf="fl-wood", outf="fl-water", door="st-door_b", oxyd="c",
+      endp={goal="st-greenbrown_hole", alg="ralf"}},
+[19]={box="st-block", wall={"st-glass", "fl-wood", "fl-abyss"},
+      inf="fl-wood", outf="fl-abyss", door="st-blocker", oxyd="d",
+      endp={goal={"fl-abyss", "it-none"}, alg="vortex"}},
+[20]={box="st-wood-growing", wall={"st-glass", "fl-wood", "fl-abyss"},
+      inf="fl-wood", outf="fl-abyss", door="st-door_c", oxyd="a",
+      endp={goal={"fl-swamp", "it-none"}, alg="magnets"}},
+[21]={box="st-wood", wall={"st-glass", "fl-wood", "fl-sahara"},
+      inf="fl-wood", outf="fl-sahara", door="st-door_c", oxyd="c",
+      endp={goal={"fl-swamp", "it-none"}, give="ac-bug", alg="block:st-bug"}},
+[22]={box="st-shogun", wall={"st-glass", "fl-wood", "fl-leaves"}, inf="fl-wood",
+      outf="fl-leaves", door="st-door_a", oxyd="b", goal="it-shogun-s",
+      endp={goal="st-none", give="it-sword", alg="block:st-knight"}},
+[23]={box="st-block", wall={"st-glass", "fl-wood", "fl-abyss"},
+      inf="fl-wood", outf="fl-abyss", door="st-blocker", oxyd="d",
+      endp={goal={"st-none", "it-none"}, alg="allcrack"}},
+[24]={box="st-brownie", wall={"st-glass", "fl-wood", "fl-sahara"},
+      inf="fl-wood", outf="fl-sahara", door="st-door_a", oxyd="c",
+      endp={goal="st-none", give="ac-bug", alg="block:st-bug"}},
+[25]={box="st-brownie", wall={"st-glass", "fl-wood", "fl-leaves", "it-cherry"},
+      inf="fl-wood", outf="fl-leaves", door="st-door_a", oxyd="a",
+      endp={goal={"st-glass", "fl-wood", "fl-leaves", "it-cherry"},
+            give="it-cherry", alg="outside"}},
+
+[26]={box="st-brownie", wall="st-likeoxydc-open", inf="fl-acblack",
+      outf="fl-water", door="st-door_a", oxyd="c",
+      endp={goal="st-grate1", alg="ralf"}},
+[27]={box="st-greenbrown_move", wall="st-likeoxydc-open", inf="fl-acblack",
+      outf="fl-water", door="st-door_b", oxyd="c",
+      endp={goal="st-greenbrown_hole", alg="hide"}},
+[28]={box="st-wood-growing", wall="st-likeoxydc-open", inf="fl-tigris",
+      outf="fl-sahara", door="st-door_c", oxyd="a",
+      endp={goal={"fl-swamp", "it-none"}, alg="fourswitch"}},
+[29]={box="st-brownie", wall="st-likeoxydc-open", inf="fl-tigris",
+      outf="fl-leaves", door="st-door_a", oxyd="a",
+      endp={goal="st-pull", give="it-sword", alg="block:st-knight"}},
+[30]={box="st-wood-growing", wall="st-likeoxydc-open", inf="fl-tigris",
+      outf="fl-sahara", door="st-door_c", oxyd="a",
+      endp={goal={"fl-abyss", "it-none"}, give="it-hammer", alg="block:st-stone_break"}},
+[31]={box="st-glass_move", wall="st-likeoxydc-open", inf="fl-tigris",
+      outf="fl-space", door="st-door_b", oxyd="a",
+      endp={wall="st-grate1", give="it-cherry", alg="outside"}},
+
+[32]={box="st-block", wall="st-metal", inf="fl-bluegray",
+      outf="fl-space", door="st-blocker", oxyd="d",
+      endp={goal={"fl-abyss", "it-none"}, alg="vortex"}},
+[33]={box="st-shogun", wall="st-metal", inf="fl-bluegray",
+      outf="fl-rough-blue", door="st-door_a", oxyd="d", goal="it-shogun-s",
+      endp={goal="st-metal_hole", alg="magnets"}},
+[34]={box="st-shogun", wall="st-metal", inf="fl-white",
+      outf="fl-abyss", door="st-door_a", oxyd="b", goal="it-shogun-s",
+      endp={goal="st-none", alg="gradients"}},
+[35]={box="st-block", wall="st-metal", inf="fl-white",
+      outf="fl-abyss", door="st-blocker", oxyd="b",
+      endp={box="fl-swamp", alg="ralf"}},
+[36]={box="st-shogun", wall="st-metal", inf="fl-white",
+      outf="fl-abyss", door="st-door_a", oxyd="b", goal="it-shogun-s",
+      endp={alg="circle"}},
+
+[37]={box="st-wood-growing", wall="st-rock1", inf="fl-light",
+      outf="fl-leaves", door="st-door_c", oxyd="a",
+      endp={goal={"fl-swamp", "it-none"}, wall="st-grate2", alg="outside"}},
+[38]={box="st-glass_move", wall="st-rock1", inf="fl-light",
+      outf="fl-abyss", door="st-door_b", oxyd="a",
+      endp={give="it-cherry", alg="ralf"}},
+[39]={box="st-brownie", wall="st-rock1", inf="fl-light",
+      outf="fl-abyss", door="st-door_a", oxyd="a",
+      endp={goal="st-grate2", alg="fourswitch"}},
+[40]={box="st-glass_move", wall="st-rock1", inf="fl-light",
+      outf="fl-abyss", door="st-door_b", oxyd="a",
+      endp={goal="st-glass1_hole", give="it-sword", alg="block:st-knight"}},
+[41]={box="st-brownie", wall="st-rock1", inf="fl-rough",
+      outf="fl-space", door="st-door_a", oxyd="c",
+      endp={goal={"st-none", "it-none", "fl-hay"}, wall="st-rock1_hole",
+            alg="outside"}},
+[42]={box="st-greenbrown_move", wall="st-rock1", inf="fl-rough",
+      outf="fl-sahara", door="st-door_b", oxyd="c",
+      endp={goal="st-greenbrown", alg="vortex"}},
+
+[43]={box="st-brownie", wall="st-rock3", inf="fl-leaves",
+      outf="fl-space", door="st-door_a", oxyd="a",
+      endp={goal="st-rock3_hole", wall="st-rock3_hole", alg="outside"}},
+[44]={box="st-marble_move", wall="st-rock3", inf="fl-leaves",
+      outf="fl-rough-blue", door="st-door_b", oxyd="b",
+      endp={"st-marble_hole", alg="ralf"}},
+[45]={box="st-wood-growing", wall="st-rock3", inf="fl-leaves",
+      outf="fl-leaves", door="st-door_c", oxyd="a",
+      endp={goal={"fl-swamp", "it-none"}, give="ac-bug", alg="block:st-bug"}},
+[46]={box="st-shogun", wall="st-rock3", inf="fl-leaves",
+      outf="fl-abyss", door="st-door_a", oxyd="d", goal="it-shogun-s",
+      endp={goal="st-none", give="it-hammer", alg="block:st-plain_cracked"}},
+[47]={box="st-greenbrown_move", wall="st-rock3", inf="fl-leaves",
+      outf="fl-sahara", door="st-door_b", oxyd="c",
+      endp={goal="st-greenbrown_hole", give="ac-bug", alg="block:st-bug"}},
+[48]={box="st-glass_move", wall="st-rock3", inf="fl-leaves",
+      outf="fl-leaves", door="st-door_b", oxyd="a",
+      endp={give="it-cherry", alg="ralf"}},
+[49]={box="st-marble_move", wall="st-rock3", inf="fl-leaves",
+      outf="fl-rough-blue", door="st-door_b", oxyd="b",
+      endp={goal="st-marble_hole", give="it-hammer", alg="block:st-plain_cracked"}},
+[50]={box="st-shogun", wall="st-rock3", inf="fl-leaves",
+      outf="fl-leaves", door="st-door_c", oxyd="a", goal="it-shogun-s",
+      endp={alg="circle"}},
+[51]={box="st-wood-growing", wall="st-rock3", inf="fl-leaves",
+      outf="fl-leaves", door="st-door_c", oxyd="a",
+      endp={goal={"fl-swamp", "it-none"},
+            wall={"st-plain_breaking", "fl-sahara"}, alg="outside"}},
+[52]={box="st-wood", wall="st-rock3", inf="fl-leaves",
+      outf="fl-water", door="st-door_c", oxyd="c",
+      endp={goal={"st-grate1", "it-none"}, alg="ralf"}},
+[53]={box="st-shogun", wall="st-rock3", inf="fl-leaves",
+      outf="fl-space", door="st-door_b", oxyd="d", goal="it-shogun-s",
+      endp={goal={"st-none", "fl-swamp"}, alg="fourswitch"}},
+
+[54]={box="st-shogun", wall="st-rock4", inf="fl-himalaya",
+      outf="fl-water", door="st-door_a", oxyd="b", goal="it-shogun-s",
+      endp={alg="vortex"}},
+[55]={box="st-marble_move", wall="st-rock4", inf="fl-himalaya",
+      outf="fl-abyss", door="st-door_b", oxyd="b",
+      endp={goal="st-marble_hole", alg="ralf"}},
+[56]={box="st-shogun", wall="st-rock4", inf="fl-himalaya",
+      outf="fl-abyss", door="st-door_b", oxyd="b", goal="it-shogun-s",
+      endp={alg="circle"}},
+[57]={box="st-block", wall="st-rock4", inf="fl-rough-red",
+      outf="fl-rough-blue", door="st-blocker", oxyd="d",
+      endp={goal="st-explosion", wall="st-explosion", alg="outside"}},
+[58]={box="st-rock3_move", wall="st-rock4", inf="fl-rough-red",
+      outf="fl-space", door="st-door_b", oxyd="d",
+      endp={goal="st-plain_cracked", give="it-hammer", alg="block:st-plain_cracked"}},
+[59]={box="st-shogun", wall="st-rock4", inf="fl-rough-red",
+      outf="fl-space", door="st-door_a", oxyd="d", goal="it-shogun-s",
+      endp={goal="st-none", alg="ralf"}},
+[60]={box="st-rock3_move", wall="st-rock4", inf="fl-rough-red",
+      outf="fl-space", door="st-door_b", oxyd="d",
+      endp={goal="st-bug", give="ac-bug", alg="block:st-bug"}},
+
+[61]={box="st-greenbrown_move", wall="st-rock5", inf="fl-samba",
+      outf="fl-leaves", door="st-door_b", oxyd="c",
+      endp={goal="st-greenbrown_hole", alg="fourswitch"}},
+[62]={box="st-block", wall="st-rock5", inf="fl-samba",
+      outf="fl-water", door="st-blocker", oxyd="b",
+      endp={goal={"fl-water", "it-none"}, alg="vortex"}},
+[63]={box="st-rock3_move", wall="st-rock5", inf="fl-samba",
+      outf="fl-leaves", door="st-door_b", oxyd="d",
+      endp={goal="st-plain_cracked", give="it-hammer",
+            alg="block:st-plain_cracked"}},
+[64]={box="st-marble_move", wall="st-rock5", inf="fl-samba",
+      outf="fl-water", door="st-door_b", oxyd="b",
+      endp={goal="st-marble_hole", alg="gradients"}},
+[65]={box="st-wood-growing", wall="st-rock5", inf="fl-samba",
+      outf="fl-space", door="st-door_c", oxyd="a",
+      endp={goal={"fl-water", "it-none"}, alg="ralf"}},
+[66]={box="st-greenbrown_move", wall="st-rock5", inf="fl-samba",
+      outf="fl-leaves", door="st-door_b", oxyd="c",
+      endp={goal="st-greenbrown", alg="vortex"}},
+[67]={box="st-block", wall="st-rock5", inf="fl-samba",
+      outf="fl-water", door="st-blocker", oxyd="b",
+      endp={alg="circle"}},
+[68]={box="st-brownie", wall="st-rock5", inf="fl-samba",
+      outf="fl-space", door="st-door_a", oxyd="a",
+      endp={goal="st-none", alg="allcrack"}},
+[69]={box="st-block", wall="st-rock5", inf="fl-samba",
+      outf="fl-space", door="st-blocker", oxyd="d",
+      endp={goal={"fl-swamp", "it-none"}, alg="ralf"}},
+
+[70]={box="st-rock3_move", wall="st-rock6", inf="fl-acblack",
+      outf="fl-space", door="st-door_b", oxyd="d",
+      endp={goal="st-plain_breaking", alg="ralf"}},
+[71]={box="st-shogun", wall="st-rock6", inf="fl-acblack",
+      outf="fl-leaves", door="st-door_a", oxyd="d", goal="it-shogun-s",
+      endp={goal="st-explosion", wall="st-explosion", alg="outside"}},
+[72]={box="st-block", wall="st-rock6", inf="fl-acblack",
+      outf="fl-leaves", door="st-blocker", oxyd="d",
+      endp={goal={"fl-swamp", "it-none"}, alg="magnets"}},
+[73]={box="st-shogun", wall="st-rock6", inf="fl-acblack",
+      outf="fl-leaves", door="st-door_a", oxyd="d", goal="it-shogun-s",
+      endp={goal="st-knight", give="it-sword", alg="block:st-knight"}},
+[74]={box="st-shogun", wall="st-rock6", inf="fl-tigris",
+      outf="fl-rough-blue", door="st-blocker", oxyd="b", goal="it-shogun-s",
+      endp={goal="st-none", alg="fourswitch"}},
+[75]={box="st-shogun", wall="st-rock6", inf="fl-tigris",
+      outf="fl-water", door="st-door_a", oxyd="b", goal="it-shogun-s",
+      endp={goal="st-explosion", alg="gradients"}},
+
+-- New designs
+[76]={box="st-glass1_move", wall="st-glass2", inf="fl-lightgray",
+      outf="fl-abyss", door="st-door_a", oxyd="b",
+      endp={goal="st-pull", alg="hide"}},
+[77]={box="st-rock3_move", wall="st-brick", inf="fl-darkgray", outf="fl-leavesb", door="st-door_a", oxyd="a"},
+[78]={box="st-rock3_move", wall="st-bumps", inf="fl-dunes", outf="fl-sand", door="st-door_a", oxyd="d"},
+[79]={box="st-flrock", wall="st-camouflage", inf="fl-gravel", outf={"fl-gravel", "st-disco-medium"}, door="st-door_a", oxyd="d"},
+[80]={box="st-flhay", wall="st-camouflage", inf="fl-leaves", outf="fl-water", door="st-door_a", oxyd="d"},
+[81]={box="st-glass2_move", wall={"st-glass1", "fl-lightgray"}, inf="fl-black", outf="fl-white", door="st-door_a", oxyd="c"},
+[82]={box="st-wood", wall={"st-glass1", "fl-water"}, inf="fl-sand", outf="fl-water", door="st-door_a", oxyd="c"},
+[83]={box="st-camouflage_move", wall="st-glass2", inf="fl-lightgray", outf={"fl-leavesb", "st-disco-medium"}, door="st-door_a", oxyd="b"},
+[84]={box="st-flrock", wall="st-glass2", inf="fl-sand", outf={"fl-water", "st-disco-medium"}, door="st-door_a", oxyd="b"},
+[85]={box="st-flrock", wall="st-brick", inf="fl-sand", outf={"fl-water", "st-disco-medium"}, door="st-door_a", oxyd="a"},
+[86]={box="st-glass1_move", wall={"st-glass3", "fl-abyss_fake"}, inf="fl-red", outf="fl-space", door="st-door_a", oxyd="a"},
+[87]={box="st-rock3_move", wall={"st-glass3", "fl-rough-blue"}, inf="fl-plank", outf="fl-water", door="st-door_a", oxyd="a"},
+[88]={box="st-glass1_move", wall="st-likeoxyda", inf="fl-black", outf="fl-abyss", door="st-door_a", oxyd="a"},
+[89]={box="st-greenbrown_move", wall="st-likeoxyda-open", inf="fl-brick", outf={"fl-mortar", "st-disco-medium"}, door="st-door_a", oxyd="a"},
+[90]={box="st-rock3_move", wall="st-likeoxydb", inf="fl-rough-red", outf="fl-space", door="st-door_a", oxyd="b"},
+[91]={box="st-flhay", wall="st-likeoxydb-open", inf="fl-rough-blue", outf={"fl-swamp", "st-disco-light"}, door="st-door_a", oxyd="b"},
+[92]={box="st-glass2_move", wall="st-likeoxydc", inf="fl-sahara", outf={"fl-water", "st-disco-light"}, door="st-door_a", oxyd="c"},
+[93]={box="st-glass_move", wall="st-likeoxydc-open", inf="fl-red", outf={"st-blackballs", "fl-abyss"}, door="st-door_a", oxyd="c"},
+[94]={box="st-glass2_move", wall="st-likeoxydd", inf="fl-concrete", outf="fl-sand", door="st-door_a", oxyd="d"},
+[95]={box="st-flrock", wall="st-likeoxydd-open", inf="fl-marble", outf="fl-water", door="st-door_a", oxyd="d"},
+[96]={box="st-flrock", wall="st-marble", inf="fl-marble", outf={"fl-leavesc3", "fl-leavesd3"}, door="st-door_a", oxyd="a"},
+[97]={box="st-camouflage_move", wall="st-marble", inf="fl-leaves", outf={"fl-leaves", "st-marble"}, door="st-door_a", oxyd="a"},
+[98]={box="st-rock1_move", wall="st-redrock", inf="fl-acblack", outf={"fl-acblack", "st-redrock"}, door="st-door_a", oxyd="b"},
+[99]={box="st-glass1_move", wall="st-redrock", inf="fl-mortar", outf="fl-brick", door="st-door_a", oxyd="b"},
+[100]={box="st-block", wall="st-redrock", inf="fl-mortar", outf="fl-water", door="st-door_a", oxyd="b"},
+[101]={box="st-glass2_move", wall="st-redrock", inf="fl-leavesb", outf={"fl-leavesc3", "fl-leavesd4"}, door="st-door_a", oxyd="a"},
+[102]={box="st-camouflage_move", wall="st-rock2", inf="fl-rock", outf={"fl-rock", "st-disco-medium"}, door="st-door_a", oxyd="b"},
+[103]={box="st-glass2_move", wall="st-rock2", inf="fl-stone", outf={"fl-water", "st-disco-medium"}, door="st-door_a", oxyd="b"},
+[104]={box="st-wood", wall="st-rock2", inf="fl-lightgray", outf="fl-space", door="st-door_a", oxyd="b"},
+[105]={box="st-camouflage_move", wall="st-rock7", inf="fl-woven", outf="fl-gravel", door="st-door_a", oxyd="a"},
+[106]={box="st-brownie", wall="st-rock7", inf="fl-black", outf="fl-abyss", door="st-door_a", oxyd="b"},
+[107]={box="st-glass_move", wall="st-rock8", inf="fl-plank", outf={"fl-plank", "st-rock8"}, door="st-door_a", oxyd="d"},
+[108]={box="st-glass2_move", wall={"st-rock8", "fl-water"}, inf="fl-leaves", outf="fl-water", door="st-door_a", oxyd="c"},
+[109]={box="st-marble_move", wall={"st-rock8", "fl-abyss_fake"}, inf="fl-stone", outf="fl-space", door="st-door_a", oxyd="c"},
+[110]={box="st-greenbrown_move", wall="st-rock9", inf="fl-rock", outf={"fl-rock", "st-rock9"}, door="st-door_a", oxyd="a"},
+[111]={box="st-glass_move", wall="st-rock9", inf="fl-sand", outf="fl-water", door="st-door_a", oxyd="c"},
+[112]={box="st-camouflage_move", wall="st-rock9", inf="fl-stone", outf="fl-swamp", door="st-door_a", oxyd="d"},
+[113]={box="st-block", wall="st-rock10", inf="fl-bluegreen", outf="fl-abyss", door="st-door_a", oxyd="a"},
+[114]={box="st-wood", wall="st-rock10", inf="fl-sand", outf={"fl-sand", "st-rock10"}, door="st-door_a", oxyd="b"},
+[115]={box="st-glass2_move", wall="st-stone1", inf={"fl-lightgray", "fl-white"}, outf={"fl-space", "fl-abyss"}, door="st-door_a", oxyd="d"},
+[116]={box="st-rock1_move", wall="st-stone1", inf="fl-stwood", outf="fl-water", door="st-door_a", oxyd="d"},
+[117]={box="st-glass_move", wall="st-stone1", inf="fl-black", outf="st-stone1", door="st-door_a", oxyd="d"},
+[118]={box="st-glass_move", wall="st-stone2", inf="fl-black", outf="fl-gravel", door="st-door_a", oxyd="b"},
+[119]={box="st-block", wall="st-stone2", inf="fl-rough-red", outf={"fl-rough-blue", "st-disco-light"}, door="st-door_a", oxyd="d"},
+[120]={box="st-rock3_move", wall={"st-marble", "st-stone2"}, inf="fl-black", outf={"st-marble", "st-stone2"}, door="st-door_a", oxyd="b"},
+[121]={box="st-wood", wall="st-panel", inf="fl-wood", outf={"fl-leavesd3", "fl-leavesd2"}, door="st-door_a", oxyd="a"},
+[122]={box="st-block", wall="st-panel", inf="fl-leaves", outf="fl-leavesb", door="st-door_a", oxyd="a"},
+[123]={box="st-glass1_move", wall="st-woven", inf="fl-dunes", outf="fl-bluegreen", door="st-door_a", oxyd="a"},
+[124]={box="st-marble_move", wall="st-woven", inf="fl-hay", outf="fl-water", door="st-door_a", oxyd="a"},
+[125]={box="st-rock3_move", wall="st-yellow", inf="fl-leavesb", outf="fl-leaves", door="st-door_a", oxyd="a"},
+[126]={box="st-glass_move", wall="st-yellow", inf="fl-rough-blue", outf="fl-abyss", door="st-door_a", oxyd="d"},
+[127]={box="st-block", wall="st-yellow", inf="fl-lightgray", outf="fl-space", door="st-door_a", oxyd="d"},
+[128]={box="st-glass1_move", wall="st-rock7", inf="fl-himalaya", outf={"fl-himalaya", "st-rock8", "st-rock7"}, door="st-door_a", oxyd="d"},
+[129]={box="st-camouflage_move", wall={"st-rock9", "fl-leavesb"}, inf="fl-dunes",
+       outf={"fl-leavese1", "fl-leavese2", "fl-leavese3", "fl-leavese4", "al:waves"}, door="st-door_a", oxyd="d"},
+[130]={box="st-glass1_move", wall="st-redrock", inf="fl-darkgray",
+       outf={"fl-black", "st-redrock", "st-invisible", "st-invisible", "st-invisible", "al:waves"},
+       door="st-door_a", oxyd="a"},
+[131]={box="st-glass1_move", wall={"st-yellow", "st-yellow", "st-redrock", "st-redrock", "al:waves"}, inf="fl-wood",
+       outf={"fl-wood", "st-yellow", "st-yellow", "st-redrock", "st-redrock", "al:waves"}, door="st-door_a", oxyd="d"},
+[132]={box="st-wood", wall="st-camouflage", inf="fl-leavesb",
+       outf={"fl-water", "fl-swamp", "fl-water", "fl-water", "al:random"}, door="st-door_a", oxyd="b"},
+[133]={box="st-glass2_move", wall="st-metal", inf="fl-metal",
+       outf={"fl-space", "fl-abyss", "fl-abyss", "fl-abyss", "al:random"}, door="st-door_a", oxyd="d"},
+[134]={box="st-marble_move", wall="st-metal", inf="fl-white",
+       outf={"fl-abyss", "st-grate1", "st-invisible", "st-invisible", "st-invisible", "al:waves"}, door="st-door_a", oxyd="d"},
+[135]={box="st-glass_move", wall="st-likeoxydc", inf="fl-white",
+       outf={"fl-white", "st-rock1", "st-invisible", "st-invisible", "st-invisible", "al:random"}, door="st-door_a", oxyd="c"},
+[136]={box="st-block", wall={"st-oneway_white-n", "st-oneway_white-s", "st-oneway_white-e", "st-oneway_white-w", "al:random"}, inf="fl-rough",
+       outf={"st-oneway_white-n", "st-oneway_white-s", "st-oneway_white-e", "st-oneway_white-w", "al:random"}, door="st-door_a", oxyd="d"},
+[137]={box={"st-mirror-p-m", "st-mirror-p/m", "st-mirror-p\\m", "st-mirror-p|m", "al:random"},
+       wall={"st-glass3", "fl-abyss"}, inf="fl-metal",
+       outf={"st-mirror-p-", "st-mirror-p/", "st-mirror-p|", "st-mirror-p\\", "al:random"}, door="st-door_a", oxyd="b"},
+[138]={box="st-shogun-s", wall="st-panel", inf="fl-stwood", outf="fl-water", door="st-door_a", oxyd="d"},
+[139]={box="st-shogun-s", wall={"st-white4", "fl-springboard", "fl-abyss_fake"}, inf={"fl-springboard", "fl-abyss_fake"},
+       outf={"st-white1", "st-black1", "fl-springboard", "fl-abyss_fake"}, door="st-door_a", oxyd="b"},
+[140]={box="st-brownie", wall={"st-stone1", "fl-leavesb"}, inf={"fl-floor_001", "fr:3.0"},
+       outf={"fl-leavese4", "fl-leavese2", "fl-leavese1", "fl-leavese3", "al:waves"}, door="st-door_a", oxyd="d"},
+[141]={box="st-brownie", wall={"st-rock4", "fl-leavesb"}, inf={"fl-bluegreenx", "mf:1.0", "fr:3.0"},
+       outf={"fl-water", "st-rock10", "st-invisible", "st-invisible", "st-invisible", "al:waves"}, door="st-door_a", oxyd="d"},
+[142]={box="st-glass2_move", wall={"st-glass1", "fl-leavesb"}, inf="fl-leavesb",
+       outf={"fl-leavesc4", "fl-leavesd2", "fl-leavesc2", "fl-leavese3", "al:waves"}, door="st-door_a", oxyd="d"},
+[143]={box="st-block", wall={"st-rock5", "fl-stwood"}, inf="fl-wood",
+       outf={"st-disco-light", "fl-wood1", "fl-wood1", "fl-wood1", "fl-wood2", "al:waves"}, door="st-door_a", oxyd="a"},
+[144]={box="st-wood", wall="st-rock6", inf="fl-bluegreen",
+       outf={"fl-space", "it-squashed", "it-sensor", "it-sensor", "it-sensor", "al:random"}, door="st-door_a", oxyd="d"},
+[145]={box="st-glass1_move", wall={"st-greenbrown", "fl-sand"}, inf="fl-dunes",
+       outf={"fl-sand", "it-landmine", "it-booze-broken", "it-none", "it-none", "it-none", "it-none", "it-none", "it-none", "al:random"},
+       door="st-door_a", oxyd="a"},
+[146]={box="st-wood", wall="st-rock1", inf="fl-black",
+       outf={"fl-abyss", "st-grate1", "st-none", "st-none", "st-none", "st-none", "st-none", "st-none",
+       "st-none", "st-none", "st-none", "st-none", "al:random"}, door="st-door_a", oxyd="c", white = true},
+[147]={box="st-wood", wall="st-whiteballs", inf="fl-gray", white = true,
+       outf={"fl-gradient5", "fl-gradient6", "fl-gradient7", "fl-gradient8", "al:waves"}, door="st-door_a", oxyd="a"},
+[148]={box="st-shogun-s", wall="st-metal", inf="fl-rough-blue", white = true,
+       outf={"fl-rough-red", "fl-rough-blue", "st-disco-light"}, door="st-door_a", oxyd="a"},
+[149]={box="st-shogun-s", wall="st-yellow", inf="fl-wood", outf="fl-swamp", door="st-door_a",
+       oxyd="c", goal="it-shogun-s", white = true},
+[150]={box="st-flrock", wall="st-redrock", inf="fl-brick",
+       outf="fl-space", door="st-door_a", oxyd="c", white=true},
+}
+
+-- The 75 first designs use the following boxes:
+--  st-block  ->  st-black, st-blocker, st-brake, st-laser, fl-swamp
+--  st-brownie  ->  st-coinslot, st-pull
+--  st-glass_move  ->  cherry
+--  st-greenbrown_move  ->  hole
+--  st-marble_move  ->  hole
+--  st-rock3_move  ->  *
+--  st-shogun  ->  st-shogun-m (not completely!)
+--  st-wood[-growing]  ->  fl-swamp
+
+-- Next follows a table to convert the codes Ralf used in his levels
+-- and ralf_sokoban to libsoko-designs. Note that there is a shift
+-- by -1 of the ralfcode in his library, except for design 0.
+-- Hence, when you start an old sokoban level with
+--   play_sokoban(level,715)
+-- then ralf_sokoban.init is called with argument 714, which corresponds
+-- to libsoko-design 4. Use
+--   create_sokoban(..., ..., ralfcode_conversion_table[715])
+-- to activate it.
+--
+ralfcode_conversion_table = {
+     [0]   = 1,
+   [714+1] = 4,
+   [715+1] = 70,
+   [716+1] = 37,
+   [718+1] = 18,
+   [719+1] = 57,
+   [720+1] = 43,
+   [764+1] = 28,
+   [765+1] = 10,
+   [766+1] = 61,
+   [767+1] = 19,
+   [768+1] = 14,
+   [769+1] = 44,
+   [770+1] = 5,
+   [771+1] = 71,
+   [772+1] = 38,
+   [773+1] = 62,
+   [775+1] = 58,
+   [776+1] = 45,
+   [777+1] = 34,
+   [867+1] = 46,
+   [868+1] = 2,
+   [869+1] = 74,
+   [870+1] = 41,
+   [871+1] = 63,
+   [872+1] = 20,
+   [873+1] = 54,
+   [874+1] = 47,
+   [875+1] = 32,
+   [876+1] = 29,
+   [877+1] = 11,
+   [910+1] = 6,
+   [911+1] = 72,
+   [912+1] = 39,
+   [913+1] = 64,
+   [914+1] = 21,
+   [915+1] = 59,
+   [916+1] = 48,
+   [917+1] = 35,
+   [918+1] = 26,
+   [919+1] = 8,
+   [920+1] = 65,
+   [921+1] = 22,
+   [922+1] = 16,
+  [1184+1] = 30,
+  [1185+1] = 12,
+  [1186+1] = 66,
+  [1187+1] = 23,
+  [1188+1] = 15,
+  [1189+1] = 49,
+  [1190+1] = 7,
+  [1191+1] = 73,
+  [1192+1] = 40,
+  [1193+1] = 67,
+  [1194+1] = 24,
+  [1195+1] = 60,
+  [1196+1] = 50,
+  [1196+1] = 51,
+  [1197+1] = 36,
+  [1198+1] = 27,
+  [1199+1] = 9,
+  [1200+1] = 68,
+  [1232+1] = 3,
+  [1233+1] = 75,
+  [1234+1] = 42,
+  [1235+1] = 69,
+  [1236+1] = 25,
+  [1237+1] = 55,
+  [1237+1] = 56,
+  [1238+1] = 52,
+  [1239+1] = 33,
+  [1240+1] = 31,
+  [1241+1] = 13,
+  [1314+1] = 17,
+  [1315+1] = 53
+}
+
+    ]]></el:luamain>
+    <el:i18n>
+    </el:i18n>
+  </el:protected>
+</el:level>

Added: trunk/data/levels/lib/libsoko-endphase.xml
===================================================================
--- trunk/data/levels/lib/libsoko-endphase.xml	2007-10-11 22:59:06 UTC (rev 900)
+++ trunk/data/levels/lib/libsoko-endphase.xml	2007-10-11 23:48:36 UTC (rev 901)
@@ -0,0 +1,372 @@
+<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
+<el:level xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://enigma-game.org/schema/level/1 level.xsd" xmlns:el="http://enigma-game.org/schema/level/1">
+  <el:protected>
+    <el:info el:type="library">
+      <el:identity el:title="" el:id="lib/libsoko-endphase"/>
+      <el:version el:score="1" el:release="1" el:revision="1" el:status="experimental"/>
+      <el:author  el:name="Enigma Team" el:email="" el:homepage=""/>
+      <el:copyright>Copyright ? 2007 Enigma Team</el:copyright>
+      <el:license el:type="GPL v2.0 or above" el:open="true"/>
+      <el:compatibility el:enigma="1.00">
+      </el:compatibility>
+      <el:modes el:easy="false" el:single="false" el:network="false"/>
+      <el:comments>
+      </el:comments>
+      <el:score el:easy="-" el:difficult="-"/>
+    </el:info>
+    <el:luamain><![CDATA[
+
+-- This "library" holds those functions and algorithms needed by libsoko.xml
+-- that are used for triggering goals and preparing and executing the sokoball-
+-- endphases. Don't include this library with your levels (it won't
+-- have any effect), but libsoko.xml.
+
+------------------------------------------------------------------------
+-- Goal Trigger and Endphase Main Functions
+------------------------------------------------------------------------
+
+function goal_trigger(onoff, sender)
+  local x, y = enigma.GetPos(sender)
+  local nr = enigma.GetAttrib(sender, "sokoarea")
+  local more_boxes = false  -- memorizes whether a box was added or removed
+  if sokoarea[nr].endphase_started then
+    return
+  end
+  if(enigma.GetAttrib(sender, "box") == 0) then
+    if enigma.GetStone(x,y) then
+      enigma.SetAttrib(sender, "box", 1)
+      sokoarea[nr].goals_filled = sokoarea[nr].goals_filled + 1
+    end
+  else
+    enigma.SetAttrib(sender, "box", 0)
+    sokoarea[nr].goals_filled = sokoarea[nr].goals_filled - 1
+  end
+  if type(goal_hook) == "function" then
+    goal_hook(nr, sender, more_boxes, sokoarea[nr].goals_filled,
+              sokoarea[nr].number_goals)
+  end
+  if sokoarea[nr].goals_filled == sokoarea[nr].number_goals then
+    sokoarea[nr].endphase_started = true
+    if type(sokoarea[nr].endphase_hook) == "function" then
+      sokoarea[nr].endphase_hook(nr)
+    else
+      mydebug("libsoko: No endphase hook found!")
+    end
+  end
+end
+
+function prepare_endphase(sokoarea_number)
+  -- ensure a correctly set endphase-attribute
+  local endp = sokoarea[sokoarea_number].design.endp
+  if not endp then
+    endp = {alg = "circle"}
+    sokoarea[sokoarea_number].design.endp = endp
+  end
+  if type(endp) ~= "table" then
+    myerror("This design's endphase is given as "..type(endp)
+            ..", should be table.")
+  end
+  local alg = endp.alg
+  if type(alg) ~= "string" then
+    myerror("This design's endphase algorithm is given as "..type(alg)
+            ..", should be string.")
+  end
+
+  -- decompose alg into algorithm name and additional parameter
+  local param = ""
+  local sep = string.find(alg, ":")
+  if sep then
+    alg = string.sub(endp.alg, 1, sep - 1)
+    param = string.sub(endp.alg, sep + 1)
+  end
+  
+  -- prepare oxyds
+  if     (alg == "circle")
+      or (alg == "hide")
+      or (alg == "fourswitch")
+      or (alg == "vortex")
+      or (alg == "gradients")
+      or (alg == "magnets") then
+    -- nothing to prepare
+  elseif (alg == "ralf")
+      or (alg == "allcrack") then
+    endphase_set_block_oxyds(sokoarea_number, endp.door)
+  elseif alg == "block" then
+    endphase_set_block_oxyds(sokoarea_number, param)
+  elseif (alg == "outside") then
+    endphase_set_outside_oxyds(sokoarea_number)
+  elseif alg == "jumpyoxyds" then
+    endphase_set_block_oxyds(sokoarea_number, "jumpy")
+  else
+    mywarning("Endphase algorithm "..alg.." unknown! Will use 'circle' instead.")
+  end
+end
+
+function endphase(sokoarea_number)
+  -- Correct structure of endp-attribute has been checked
+  -- by prepare_endphase, we trust it blindly.
+  local endp = sokoarea[sokoarea_number].design.endp
+  local alg = endp.alg
+  local param = ""
+  local px, py = enigma.GetPos(enigma.GetNamedObject("marble_"..sokoarea_number.."_1"))
+  
+  -- decompose alg into algorithm name and additional parameter
+  local sep = string.find(alg, ":")
+  if sep then
+    alg = string.sub(endp.alg, 1, sep - 1)
+    param = string.sub(endp.alg, sep + 1)
+  end
+  if param == "" then
+    mydebug("Endphase starts of type "..alg..", no parameter.")
+  else
+    mydebug("Endphase starts of type "..alg..", parameter "..param..".")
+  end
+
+  -- redraw level and give items
+  endphase_redraw_level_array(sokoarea_number)
+  local give = endp.give
+  if type(give) == "string" then
+    give = {give}
+  end
+  if type(give) == "table" then
+    for k, v in pairs(give) do
+      if is_item(v) then
+        set_item(v, px, py)
+      elseif is_actor(v) then
+        set_actor(v, px + 0.5, py + 0.5)
+      else
+        myerror("Can't give "..v..".")
+      end
+    end
+  elseif type(give) ~= "nil" then
+    myerror("Can't give something of type "..type(v)..".")
+  end
+
+  if alg == "circle" then
+    endphase_circle(sokoarea_number)
+  elseif alg == "ralf" then
+  
+  elseif alg == "hide" then
+  
+  elseif alg == "outside" then
+  
+  elseif alg == "allcrack" then
+  
+  elseif alg == "block" then
+    -- done in prepare_endphase
+  elseif alg == "fourswitch" then
+  
+  elseif alg == "vortex" then
+  
+  elseif alg == "gradients" then
+  
+  elseif alg == "magnets" then
+  
+  elseif alg == "jumpyoxyds" then
+
+  else
+    -- use default: "circle"
+    endphase_circle(sokoarea_number)
+  end
+end
+
+function endphase_redraw_level_array(sokoarea_number)
+  local nr = sokoarea_number or 1
+  local endp = sokoarea[nr].design.endp
+  local dx = sokoarea[nr].offset.x
+  local dy = sokoarea[nr].offset.y
+  local mx = sokoarea[nr].array_width
+  local my = sokoarea[nr].array_height
+
+  -- If level_width and level_height are set, the level has been drawn
+  -- by create_sokoball. Hence we have to redraw everything outside
+  -- the level_array-area as well:
+  if endp.outf and sokoarea[nr].level_width and sokoarea[nr].level_height then
+    for x = 0, sokoarea[nr].level_width - 1 do
+      for y = 0, sokoarea[nr].level_height - 1 do
+        if (x < dx) or (x > mx+dx-1) or (y < dy) or (y > my+dy-1) then
+          set_element(x, y, nr, k, endp.outf)
+        end
+      end
+    end
+  end  
+
+  -- Now redraw the area inside level_array:
+  for y = 0, my - 1 do
+    for x = 0, mx - 1 do
+      local ch = sokoarea[nr].level_array[y+1][x+1]
+      for k, v in pairs(endp) do
+        if    ((k == "outf") and char_is_outf(ch))
+           or ((k == "inf")  and char_is_inf(ch))
+           or ((k == "wall") and char_is_wall(ch))
+           or ((k == "goal") and char_is_goal(ch)) then
+          set_element(x+dx, y+dy, nr, k, v)
+        end
+      end
+    end
+  end
+end
+
+------------------------------------------------------------------------
+-- Endphase Games and Algorithms
+------------------------------------------------------------------------
+
+function endphase_circle(sokoarea_number)
+  local acname = "marble_"..sokoarea_number.."_1"
+  local flavor = sokoarea[sokoarea_number].design.oxyd or "b"
+  local actor = enigma.GetNamedObject(acname)
+  if not actor then
+    acname = "marble"
+    actor = enigma.GetNamedObject(acname)
+    if not actor then
+      myerror("No marble found. Please name it 'marble'.")  
+    end
+  end
+  local x, y = enigma.GetPos(actor)
+  if x > 10 then
+    x = x - 2
+  end
+  if y > 6 then
+    y = y - 2
+  end
+  for j = 0, 2 do
+    oxyd(x+j, y-1, flavor)
+    oxyd(x-1, y+j, flavor)
+    oxyd(x+j, y+3, flavor)
+    oxyd(x+3, y+j, flavor)
+    for k = 0, 2 do
+      kill_stone(x+j, y+k)
+      kill_item(x+j, y+k)
+      set_element(x+j, y+k, sokoarea_number, "inf")
+    end
+  end
+  set_stone("st-fart", x+1, y+1)
+  oxyd_shuffle()
+end
+
+function endphase_set_outside_oxyds(sokoarea_number)
+  local places = {}
+  local nr = sokoarea_number or 1
+  local dx = sokoarea[nr].offset.x
+  local dy = sokoarea[nr].offset.y
+  local mx = sokoarea[nr].array_width
+  local my = sokoarea[nr].array_height
+  local flavor = sokoarea[nr].design.oxyd or "b"
+
+  -- If level_width and level_height are set, there are more
+  -- oxyds possible than level_array alone would allow:
+  if sokoarea[nr].level_width and sokoarea[nr].level_height then
+    for x = 0, sokoarea[nr].level_width - 1 do
+      for y = 0, sokoarea[nr].level_height - 1 do
+        if (x < dx) or (x > mx+dx-1) or (y < dy) or (y > my+dy-1) then
+          table.insert(places, {x=x, y=y})
+        end
+      end
+    end
+  end  
+
+  -- Now outf-tiles inside level_array and far-away wall-tiles:
+  for y = 0, my - 1 do
+    for x = 0, mx - 1 do
+      local ch = sokoarea[nr].level_array[y+1][x+1]
+      if     char_is_outf(ch) 
+         or (char_is_wall(ch) and no_way_near(x+1, y+1, nr)) then
+        table.insert(places, {x=x+dx, y=y+dy})
+      end
+    end
+  end
+
+  -- Choose some appropriate subset
+  local max = table.getn(places)
+  local number_pairs = 0
+  if max < 2 then
+    myerror("Not enough free places outside. This can't happen?!")
+  elseif max <   4 then  number_pairs = 1
+  else                   number_pairs = 2  end
+  --elseif max <   8 then  number_pairs = 2
+  --elseif max <  30 then  number_pairs = 3
+  --elseif max <  50 then  number_pairs = 4
+  --elseif max <  80 then  number_pairs = 5
+  --elseif max < 120 then  number_pairs = 6
+  --elseif max < 180 then  number_pairs = 7
+  --else                   number_pairs = 8  end
+  for j = 1, max do
+    places[j].sort_field = math.random()
+  end
+  table.sort(places, function (a, b) return a.sort_field < b.sort_field end)
+  for j = 1, number_pairs do
+    oxyd(places[2*j-1].x, places[2*j-1].y, flavor, j)
+    oxyd(places[2*j].x, places[2*j].y, flavor, j)
+  end
+  oxyd_shuffle()
+end
+
+function endphase_set_block_oxyds(sokoarea_number, blocker)
+
+  if 1 + 1 == 2 then return end
+  
+  local places = {}
+  local nr = sokoarea_number or 1
+  local dx = sokoarea[nr].offset.x
+  local dy = sokoarea[nr].offset.y
+  local mx = sokoarea[nr].array_width
+  local my = sokoarea[nr].array_height
+  local flavor = sokoarea[nr].design.oxyd or "b"
+
+  -- If level_width and level_height are set, there are more
+  -- oxyds possible than level_array alone would allow:
+  if sokoarea[nr].level_width and sokoarea[nr].level_height then
+    for x = 0, sokoarea[nr].level_width - 1 do
+      for y = 0, sokoarea[nr].level_height - 1 do
+        local pos = one_tile_far_from_way(x+dx, y+dy, nr)
+        if pos then
+          table.insert(places, {x=x, y=y, door_x=pos.x, door_y=pos.y})
+          --set_stone("st-pull", x, y)
+          --set_floor("fl-red", pos.x, pos.y)
+        end
+      end
+    end
+  else
+    for y = 0, my - 1 do
+      for x = 0, mx - 1 do
+        local pos = one_tile_far_from_way(x+dx, y+dy, nr)
+        if pos then
+          table.insert(places, {x=x, y=y, door_x=pos.x, door_y=pos.y})
+          --set_stone("st-pull", x, y)
+          --set_floor("fl-red", pos.x, pos.y)
+        end
+      end
+    end  
+  end
+
+
+  -- Choose some appropriate subset
+  local max = table.getn(places)
+  local number_pairs = 0
+  if max < 2 then
+    myerror("Not enough free places outside. This can't happen?!")
+  elseif max <   4 then  number_pairs = 1
+  else                   number_pairs = 2  end
+  --elseif max <   8 then  number_pairs = 2
+  --elseif max <  30 then  number_pairs = 3
+  --elseif max <  50 then  number_pairs = 4
+  --elseif max <  80 then  number_pairs = 5
+  --elseif max < 120 then  number_pairs = 6
+  --elseif max < 180 then  number_pairs = 7
+  --else                   number_pairs = 8  end
+  for j = 1, max do
+    places[j].sort_field = math.random()
+  end
+  table.sort(places, function (a, b) return a.sort_field < b.sort_field end)
+  for j = 1, number_pairs do
+    oxyd(places[2*j-1].x, places[2*j-1].y, flavor, j)
+    oxyd(places[2*j].x, places[2*j].y, flavor, j)
+  end
+  oxyd_shuffle()
+end
+
+    ]]></el:luamain>
+    <el:i18n>
+    </el:i18n>
+  </el:protected>
+</el:level>

Modified: trunk/data/levels/lib/libsoko.xml
===================================================================
--- trunk/data/levels/lib/libsoko.xml	2007-10-11 22:59:06 UTC (rev 900)
+++ trunk/data/levels/lib/libsoko.xml	2007-10-11 23:48:36 UTC (rev 901)
@@ -8,6 +8,8 @@
       <el:copyright>Copyright ? 2007 Enigma Team</el:copyright>
       <el:license el:type="GPL v2.0 or above" el:open="true"/>
       <el:compatibility el:enigma="1.00">
+        <el:dependency el:path="lib/libsoko-designlist" el:id="lib/libsoko-designlist" el:release="1" el:preload="true"/>
+        <el:dependency el:path="lib/libsoko-endphase" el:id="lib/libsoko-endphase" el:release="1" el:preload="true"/>
       </el:compatibility>
       <el:modes el:easy="false" el:single="false" el:network="false"/>
       <el:comments>
@@ -20,288 +22,57 @@
     </el:info>
     <el:luamain><![CDATA[
 
+-- libsoko.xml uses data from libsoko-designlist.xml and functions from
+-- libsoko-endphase.xml. Please read the comments in libsoko-designlist.xml
+-- to understand design tables, and libsoko-endphase.xml for goal-triggering
+-- and endphases.
+
 ------------------------------------------------------------------------
--- Designs
+-- Global variables
 ------------------------------------------------------------------------
 
--- This section holds a table with all default designs. Each design
--- is again a table consisting of the following entries:
---    wall, inf, outf, box, goal, oxyd, oxop
--- Each of these entries is either a string representing the objects to
--- be used, or a table if several objects shall be used. Such a
--- combination of objects will be called "element".
+-- The global table "sokoarea" holds all sokoban parts a level
+-- creates. I.e., sokoarea[1] holds information about the first
+-- part, sokoarea[2] about the second etc. In most cases, only
+-- sokoarea[1] will be used.
+-- Each sokoarea[j] is again a table with the following entries:
 --
--- If object types (like floors) repeat in the table, they are used in
--- a checkerboard pattern. You can change this pattern by adding an
--- element of the form "al:ALGORITHM", where ALGORITHM is one of the
--- algorithms listed below. Same for "fr:1.23" and "mf:4.5" for friction
--- and mouseforce. From all these attributes, only the last one will
--- be used, all others ignored. This contrasts with the situation of
--- the gaming objects ("fl-", "st-", "it-"), whose order doesn't matter.
+--        level_array - a 2D-array of characters defining the sokoban part
+--        array_width - width of level_array
+--       array_height - height of level_array
+--             design - the used design table
+--       number_goals - number of goals this part controls
+--       goals_filled - number of filled goals
+--        actor_count - number of actors in this sokoban part
+--   endphase_started - a flag to mark completed sokobans
+--             offset - position of the level_array within the whole level
+--         uses_chess - flag to note that st-chess was used (no shogun-triggers)
+--        level_width - width of whole level (create_sokoban only)
+--       level_height - height of whole level (create_sokoban only)
+--          goal_hook - function to call when a goal activates/deactivates
+--      endphase_hook - function to call when all triggers are filled
 --
--- "oxyd" only holds the oxyd's flavor, "oxop" the way of resolving the
--- level from Sokoban to opening oxyds. Use "st-none" and "it-none" to
--- place spaces between stones/items.
+-- endphase_hook is a function with one argument, the sokoarea-number.
+-- goal_hook takes five arguments: Sokoarea-number, goal-object that was
+-- triggered, a bool whether the box was added (instead of removed), number
+-- of now-filled goals in this area, number of all goals in this area.
+-- Hooking goal_hook does not interfere the default operations of libsoko,
+-- but hooking endphase_hook results in skipping the usual endphase.
+-- However, you can call endphase(sokoarea_number) yourself if neccessary.
 --
--- The table might hold additional flags. Currently, only "white"
--- is implemented, which turns the marble and chess-knights white.
--- If an entry is missing, the corresponding entry from default_design
--- will be used.
+--       list_outside - list of positions of outf-tiles
+--           list_way - list of all inside positions that the marble
+--                      can reach on level-end
+--      list_wall_one - list of outer walls near ways
+--      list_wall_two - list of outer walls one tile away from ways,
+--                      together with a list of neighboring wall_ones.
 --
--- Example:
---
---   [5] = { outf = "fl-leaves", inf = "fl-leavesb", box = "st-wood"
---           wall = {"st-glass", "fl-wood", "fl-leaves", "al:random"},
---           oxyd = "a", white = true }
---
---   will define design 5. The walls will alternate between
---   st-glass/fl-wood and st-glass/fl-leaves. The goal will be
---   it-trigger by default. The actor will be ac-whiteball.
---
--- Possible flags:
---
---   white  : Use white marble and st-chess_white.
---
--- Algorithms:
---
---   checkerboard : default, up to 3 different floors in checkerboard pattern
---   lines : arbitrary number of floors in diagonal lines
---   waves : works best with 4 different floors
---   random : arbitrary number of floors, randomly chosen
---
+-- Each list entry is a table: Entries x and y are absolute positions,
+-- lx and ly are positions in the level_array, if existent (nil else).
 
-default_design = {
-  wall = { "st-rock3", "fl-leaves" },
-   inf = { "fl-wood" },
-  outf = { "fl-water", "st-invisible" },
-   box = { "st-brownie" },
-  goal = { "it-trigger" },
-  oxyd = "a",
-  oxop = 1 }
+sokoarea = {}
 
-design_list = {
-
--- Ralf's designs
-[1]={box="st-brownie", wall="st-bluegray", inf="fl-bluegray", outf="fl-space", door="st-door_a", oxyd="a"},
-[2]={box="st-glass_move", wall="st-bluegray", inf="fl-bluegray", outf="fl-water", door="st-door_b", oxyd="a"},
-[3]={box="st-wood-growing", wall="st-bluegray", inf="fl-bluegray", outf="fl-abyss", door="st-door_c", oxyd="a"},
-[4]={box="st-brownie", wall="st-bluegray", inf="fl-white", outf="fl-sahara", door="st-door_a", oxyd="c"},
-[5]={box="st-wood", wall="st-bluegray", inf="fl-white", outf="fl-space", door="st-door_c", oxyd="c"},
-[6]={box="st-greenbrown_move", wall="st-bluegray", inf="fl-white", outf="fl-space", door="st-door_b", oxyd="c"},
-[7]={box="st-wood", wall="st-bluegray", inf="fl-white", outf="fl-space", door="st-door_c", oxyd="c"},
-[8]={box="st-rock3_move", wall="st-blue-sand", inf="fl-light", outf="fl-rough-blue", door="st-door_b", oxyd="d"},
-[9]={box="st-block", wall="st-blue-sand", inf="fl-light", outf="fl-rough-blue", door="st-blocker", oxyd="d"},
-[10]={box="st-shogun", wall="st-blue-sand", inf="fl-rough", outf="fl-space", door="st-door_a", oxyd="b"},
-[11]={box="st-marble_move", wall="st-blue-sand", inf="fl-rough", outf="fl-abyss", door="st-door_b", oxyd="b"},
-[12]={box="st-shogun", wall="st-blue-sand", inf="fl-rough", outf="fl-space", door="st-door_a", oxyd="b"},
-[13]={box="st-block", wall="st-blue-sand", inf="fl-rough", outf="fl-leaves", door="st-blocker", oxyd="b"},
-[14]={box="st-brownie", wall="st-glass", inf="fl-himalaya", outf="fl-water", door="st-door_a", oxyd="a"},
-[15]={box="st-brownie", wall="st-glass", inf="fl-himalaya", outf="fl-water", door="st-door_a", oxyd="a"},
-[16]={box="st-shogun", wall="st-glass", inf="fl-rough-red", outf="fl-abyss", door="st-door_b", oxyd="c"},
-[17]={box="st-brownie", wall="st-glass", inf="fl-rough-red", outf="fl-sahara", door="st-door_a", oxyd="c"},
-[18]={box="st-greenbrown_move", wall="st-glass", inf="fl-wood", outf="fl-water", door="st-door_b", oxyd="c"},
-[19]={box="st-block", wall="st-glass", inf="fl-wood", outf="fl-abyss", door="st-blocker", oxyd="d"},
-[20]={box="st-wood-growing", wall="st-glass", inf="fl-wood", outf="fl-abyss", door="st-door_c", oxyd="a"},
-[21]={box="st-wood", wall="st-glass", inf="fl-wood", outf="fl-sahara", door="st-door_c", oxyd="c"},
-[22]={box="st-shogun", wall="st-glass", inf="fl-wood", outf="fl-leaves", door="st-door_a", oxyd="b"},
-[23]={box="st-block", wall="st-glass", inf="fl-wood", outf="fl-abyss", door="st-blocker", oxyd="d"},
-[24]={box="st-brownie", wall="st-glass", inf="fl-wood", outf="fl-sahara", door="st-door_a", oxyd="c"},
-[25]={box="st-brownie", wall="st-glass", inf="fl-wood", outf="fl-leaves", door="st-door_a", oxyd="a"},
-[26]={box="st-brownie", wall="st-likeoxydc-open", inf="fl-acblack", outf="fl-water", door="st-door_a", oxyd="c"},
-[27]={box="st-greenbrown_move", wall="st-likeoxydc-open", inf="fl-acblack", outf="fl-water", door="st-door_b", oxyd="c"},
-[28]={box="st-wood-growing", wall="st-likeoxydc-open", inf="fl-tigris", outf="fl-sahara", door="st-door_c", oxyd="a"},
-[29]={box="st-brownie", wall="st-likeoxydc-open", inf="fl-tigris", outf="fl-leaves", door="st-door_a", oxyd="a"},
-[30]={box="st-wood-growing", wall="st-likeoxydc-open", inf="fl-tigris", outf="fl-sahara", door="st-door_c", oxyd="a"},
-[31]={box="st-glass_move", wall="st-likeoxydc-open", inf="fl-tigris", outf="fl-space", door="st-door_b", oxyd="a"},
-[32]={box="st-block", wall="st-metal", inf="fl-bluegray", outf="fl-space", door="st-blocker", oxyd="d"},
-[33]={box="st-shogun", wall="st-metal", inf="fl-bluegray", outf="fl-rough-blue", door="st-door_a", oxyd="d"},
-[34]={box="st-shogun", wall="st-metal", inf="fl-white", outf="fl-abyss", door="st-door_a", oxyd="b"},
-[35]={box="st-block", wall="st-metal", inf="fl-white", outf="fl-abyss", door="st-blocker", oxyd="b"},
-[36]={box="st-shogun", wall="st-metal", inf="fl-white", outf="fl-abyss", door="st-door_a", oxyd="b"},
-[37]={box="st-wood-growing", wall="st-rock1", inf="fl-light", outf="fl-leaves", door="st-door_c", oxyd="a"},
-[38]={box="st-glass_move", wall="st-rock1", inf="fl-light", outf="fl-abyss", door="st-door_b", oxyd="a"},
-[39]={box="st-brownie", wall="st-rock1", inf="fl-light", outf="fl-abyss", door="st-door_a", oxyd="a"},
-[40]={box="st-glass_move", wall="st-rock1", inf="fl-light", outf="fl-abyss", door="st-door_b", oxyd="a"},
-[41]={box="st-brownie", wall="st-rock1", inf="fl-rough", outf="fl-space", door="st-door_a", oxyd="c"},
-[42]={box="st-greenbrown_move", wall="st-rock1", inf="fl-rough", outf="fl-sahara", door="st-door_b", oxyd="c"},
-[43]={box="st-brownie", wall="st-rock3", inf="fl-leaves", outf="fl-space", door="st-door_a", oxyd="a"},
-[44]={box="st-marble_move", wall="st-rock3", inf="fl-leaves", outf="fl-rough-blue", door="st-door_b", oxyd="b"},
-[45]={box="st-wood-growing", wall="st-rock3", inf="fl-leaves", outf="fl-leaves", door="st-door_c", oxyd="a"},
-[46]={box="st-shogun", wall="st-rock3", inf="fl-leaves", outf="fl-abyss", door="st-door_a", oxyd="d"},
-[47]={box="st-greenbrown_move", wall="st-rock3", inf="fl-leaves", outf="fl-sahara", door="st-door_b", oxyd="c"},
-[48]={box="st-glass_move", wall="st-rock3", inf="fl-leaves", outf="fl-leaves", door="st-door_b", oxyd="a"},
-[49]={box="st-marble_move", wall="st-rock3", inf="fl-leaves", outf="fl-rough-blue", door="st-door_b", oxyd="b"},
-[50]={box="st-shogun", wall="st-rock3", inf="fl-leaves", outf="fl-leaves", door="st-door_c", oxyd="a"},
-[51]={box="st-wood-growing", wall="st-rock3", inf="fl-leaves", outf="fl-leaves", door="st-door_c", oxyd="a"},
-[52]={box="st-wood", wall="st-rock3", inf="fl-leaves", outf="fl-water", door="st-door_c", oxyd="c"},
-[53]={box="st-shogun", wall="st-rock3", inf="fl-leaves", outf="fl-space", door="st-door_b", oxyd="d"},
-[54]={box="st-shogun", wall="st-rock4", inf="fl-himalaya", outf="fl-water", door="st-door_a", oxyd="b"},
-[55]={box="st-marble_move", wall="st-rock4", inf="fl-himalaya", outf="fl-abyss", door="st-door_b", oxyd="b"},
-[56]={box="st-shogun", wall="st-rock4", inf="fl-himalaya", outf="fl-abyss", door="st-door_b", oxyd="b"},
-[57]={box="st-block", wall="st-rock4", inf="fl-rough-red", outf="fl-rough-blue", door="st-blocker", oxyd="d"},
-[58]={box="st-rock3_move", wall="st-rock4", inf="fl-rough-red", outf="fl-space", door="st-door_b", oxyd="d"},
-[59]={box="st-shogun", wall="st-rock4", inf="fl-rough-red", outf="fl-space", door="st-door_a", oxyd="d"},
-[60]={box="st-rock3_move", wall="st-rock4", inf="fl-rough-red", outf="fl-space", door="st-door_b", oxyd="d"},
-[61]={box="st-greenbrown_move", wall="st-rock5", inf="fl-samba", outf="fl-leaves", door="st-door_b", oxyd="c"},
-[62]={box="st-block", wall="st-rock5", inf="fl-samba", outf="fl-water", door="st-blocker", oxyd="b"},
-[63]={box="st-rock3_move", wall="st-rock5", inf="fl-samba", outf="fl-leaves", door="st-door_b", oxyd="d"},
-[64]={box="st-marble_move", wall="st-rock5", inf="fl-samba", outf="fl-water", door="st-door_b", oxyd="b"},
-[65]={box="st-wood-growing", wall="st-rock5", inf="fl-samba", outf="fl-space", door="st-door_c", oxyd="a"},
-[66]={box="st-greenbrown_move", wall="st-rock5", inf="fl-samba", outf="fl-leaves", door="st-door_b", oxyd="c"},
-[67]={box="st-block", wall="st-rock5", inf="fl-samba", outf="fl-water", door="st-blocker", oxyd="b"},
-[68]={box="st-brownie", wall="st-rock5", inf="fl-samba", outf="fl-space", door="st-door_a", oxyd="a"},
-[69]={box="st-block", wall="st-rock5", inf="fl-samba", outf="fl-space", door="st-blocker", oxyd="d"},
-[70]={box="st-rock3_move", wall="st-rock6", inf="fl-acblack", outf="fl-space", door="st-door_b", oxyd="d"},
-[71]={box="st-shogun", wall="st-rock6", inf="fl-acblack", outf="fl-leaves", door="st-door_a", oxyd="d"},
-[72]={box="st-block", wall="st-rock6", inf="fl-acblack", outf="fl-leaves", door="st-blocker", oxyd="d"},
-[73]={box="st-shogun", wall="st-rock6", inf="fl-acblack", outf="fl-leaves", door="st-door_a", oxyd="d"},
-[74]={box="st-shogun", wall="st-rock6", inf="fl-tigris", outf="fl-rough-blue", door="st-blocker", oxyd="b"},
-[75]={box="st-shogun", wall="st-rock6", inf="fl-tigris", outf="fl-water", door="st-door_a", oxyd="b"},
-
--- New designs
-[76]={box="st-glass1_move", wall="st-glass2", inf="fl-lightgray", outf="fl-abyss", door="st-door_a", oxyd="b"},
-[77]={box="st-rock3_move", wall="st-brick", inf="fl-darkgray", outf="fl-leavesb", door="st-door_a", oxyd="a"},
-[78]={box="st-rock3_move", wall="st-bumps", inf="fl-dunes", outf="fl-sand", door="st-door_a", oxyd="d"},
-[79]={box="st-flrock", wall="st-camouflage", inf="fl-gravel", outf={"fl-gravel", "st-disco-medium"}, door="st-door_a", oxyd="d"},
-[80]={box="st-flhay", wall="st-camouflage", inf="fl-leaves", outf="fl-water", door="st-door_a", oxyd="d"},
-[81]={box="st-glass2_move", wall={"st-glass1", "fl-lightgray"}, inf="fl-black", outf="fl-white", door="st-door_a", oxyd="c"},
-[82]={box="st-wood", wall={"st-glass1", "fl-water"}, inf="fl-sand", outf="fl-water", door="st-door_a", oxyd="c"},
-[83]={box="st-camouflage_move", wall="st-glass2", inf="fl-lightgray", outf={"fl-leavesb", "st-disco-medium"}, door="st-door_a", oxyd="b"},
-[84]={box="st-flrock", wall="st-glass2", inf="fl-sand", outf={"fl-water", "st-disco-medium"}, door="st-door_a", oxyd="b"},
-[85]={box="st-flrock", wall="st-brick", inf="fl-sand", outf={"fl-water", "st-disco-medium"}, door="st-door_a", oxyd="a"},
-[86]={box="st-glass1_move", wall={"st-glass3", "fl-abyss_fake"}, inf="fl-red", outf="fl-space", door="st-door_a", oxyd="a"},
-[87]={box="st-rock3_move", wall={"st-glass3", "fl-rough-blue"}, inf="fl-plank", outf="fl-water", door="st-door_a", oxyd="a"},
-[88]={box="st-glass1_move", wall="st-likeoxyda", inf="fl-black", outf="fl-abyss", door="st-door_a", oxyd="a"},
-[89]={box="st-greenbrown_move", wall="st-likeoxyda-open", inf="fl-brick", outf={"fl-mortar", "st-disco-medium"}, door="st-door_a", oxyd="a"},
-[90]={box="st-rock3_move", wall="st-likeoxydb", inf="fl-rough-red", outf="fl-space", door="st-door_a", oxyd="b"},
-[91]={box="st-flhay", wall="st-likeoxydb-open", inf="fl-rough-blue", outf={"fl-swamp", "st-disco-light"}, door="st-door_a", oxyd="b"},
-[92]={box="st-glass2_move", wall="st-likeoxydc", inf="fl-sahara", outf={"fl-water", "st-disco-light"}, door="st-door_a", oxyd="c"},
-[93]={box="st-glass_move", wall="st-likeoxydc-open", inf="fl-red", outf={"st-blackballs", "fl-abyss"}, door="st-door_a", oxyd="c"},
-[94]={box="st-glass2_move", wall="st-likeoxydd", inf="fl-concrete", outf="fl-sand", door="st-door_a", oxyd="d"},
-[95]={box="st-flrock", wall="st-likeoxydd-open", inf="fl-marble", outf="fl-water", door="st-door_a", oxyd="d"},
-[96]={box="st-flrock", wall="st-marble", inf="fl-marble", outf={"fl-leavesc3", "fl-leavesd3"}, door="st-door_a", oxyd="a"},
-[97]={box="st-camouflage_move", wall="st-marble", inf="fl-leaves", outf={"fl-leaves", "st-marble"}, door="st-door_a", oxyd="a"},
-[98]={box="st-rock1_move", wall="st-redrock", inf="fl-acblack", outf={"fl-acblack", "st-redrock"}, door="st-door_a", oxyd="b"},
-[99]={box="st-glass1_move", wall="st-redrock", inf="fl-mortar", outf="fl-brick", door="st-door_a", oxyd="b"},
-[100]={box="st-block", wall="st-redrock", inf="fl-mortar", outf="fl-water", door="st-door_a", oxyd="b"},
-[101]={box="st-glass2_move", wall="st-redrock", inf="fl-leavesb", outf={"fl-leavesc3", "fl-leavesd4"}, door="st-door_a", oxyd="a"},
-[102]={box="st-camouflage_move", wall="st-rock2", inf="fl-rock", outf={"fl-rock", "st-disco-medium"}, door="st-door_a", oxyd="b"},
-[103]={box="st-glass2_move", wall="st-rock2", inf="fl-stone", outf={"fl-water", "st-disco-medium"}, door="st-door_a", oxyd="b"},
-[104]={box="st-wood", wall="st-rock2", inf="fl-lightgray", outf="fl-space", door="st-door_a", oxyd="b"},
-[105]={box="st-camouflage_move", wall="st-rock7", inf="fl-woven", outf="fl-gravel", door="st-door_a", oxyd="a"},
-[106]={box="st-brownie", wall="st-rock7", inf="fl-black", outf="fl-abyss", door="st-door_a", oxyd="b"},
-[107]={box="st-glass_move", wall="st-rock8", inf="fl-plank", outf={"fl-plank", "st-rock8"}, door="st-door_a", oxyd="d"},
-[108]={box="st-glass2_move", wall={"st-rock8", "fl-water"}, inf="fl-leaves", outf="fl-water", door="st-door_a", oxyd="c"},
-[109]={box="st-marble_move", wall={"st-rock8", "fl-abyss_fake"}, inf="fl-stone", outf="fl-space", door="st-door_a", oxyd="c"},
-[110]={box="st-greenbrown_move", wall="st-rock9", inf="fl-rock", outf={"fl-rock", "st-rock9"}, door="st-door_a", oxyd="a"},
-[111]={box="st-glass_move", wall="st-rock9", inf="fl-sand", outf="fl-water", door="st-door_a", oxyd="c"},
-[112]={box="st-camouflage_move", wall="st-rock9", inf="fl-stone", outf="fl-swamp", door="st-door_a", oxyd="d"},
-[113]={box="st-block", wall="st-rock10", inf="fl-bluegreen", outf="fl-abyss", door="st-door_a", oxyd="a"},
-[114]={box="st-wood", wall="st-rock10", inf="fl-sand", outf={"fl-sand", "st-rock10"}, door="st-door_a", oxyd="b"},
-[115]={box="st-glass2_move", wall="st-stone1", inf={"fl-lightgray", "fl-white"}, outf={"fl-space", "fl-abyss"}, door="st-door_a", oxyd="d"},
-[116]={box="st-rock1_move", wall="st-stone1", inf="fl-stwood", outf="fl-water", door="st-door_a", oxyd="d"},
-[117]={box="st-glass_move", wall="st-stone1", inf="fl-black", outf="st-stone1", door="st-door_a", oxyd="d"},
-[118]={box="st-glass_move", wall="st-stone2", inf="fl-black", outf="fl-gravel", door="st-door_a", oxyd="b"},
-[119]={box="st-block", wall="st-stone2", inf="fl-rough-red", outf={"fl-rough-blue", "st-disco-light"}, door="st-door_a", oxyd="d"},
-[120]={box="st-rock3_move", wall={"st-marble", "st-stone2"}, inf="fl-black", outf={"st-marble", "st-stone2"}, door="st-door_a", oxyd="b"},
-[121]={box="st-wood", wall="st-panel", inf="fl-wood", outf={"fl-leavesd3", "fl-leavesd2"}, door="st-door_a", oxyd="a"},
-[122]={box="st-block", wall="st-panel", inf="fl-leaves", outf="fl-leavesb", door="st-door_a", oxyd="a"},
-[123]={box="st-glass1_move", wall="st-woven", inf="fl-dunes", outf="fl-bluegreen", door="st-door_a", oxyd="a"},
-[124]={box="st-marble_move", wall="st-woven", inf="fl-hay", outf="fl-water", door="st-door_a", oxyd="a"},
-[125]={box="st-rock3_move", wall="st-yellow", inf="fl-leavesb", outf="fl-leaves", door="st-door_a", oxyd="a"},
-[126]={box="st-glass_move", wall="st-yellow", inf="fl-rough-blue", outf="fl-abyss", door="st-door_a", oxyd="d"},
-[127]={box="st-block", wall="st-yellow", inf="fl-lightgray", outf="fl-space", door="st-door_a", oxyd="d"},
-[128]={box="st-glass1_move", wall="st-rock7", inf="fl-himalaya", outf={"fl-himalaya", "st-rock8", "st-rock7"}, door="st-door_a", oxyd="d"},
-[129]={box="st-camouflage_move", wall={"st-rock9", "fl-leavesb"}, inf="fl-dunes",
-       outf={"fl-leavese1", "fl-leavese2", "fl-leavese3", "fl-leavese4", "al:waves"}, door="st-door_a", oxyd="d"},
-[130]={box="st-glass1_move", wall="st-redrock", inf="fl-darkgray",
-       outf={"fl-black", "st-redrock", "st-invisible", "st-invisible", "st-invisible", "al:waves"},
-       door="st-door_a", oxyd="a"},
-[131]={box="st-glass1_move", wall={"st-yellow", "st-yellow", "st-redrock", "st-redrock", "al:waves"}, inf="fl-wood",
-       outf={"st-yellow", "st-yellow", "st-redrock", "st-redrock", "al:waves"}, door="st-door_a", oxyd="d"},
-[132]={box="st-wood", wall="st-camouflage", inf="fl-leavesb",
-       outf={"fl-water", "fl-swamp", "fl-water", "fl-water", "al:random"}, door="st-door_a", oxyd="b"},
-[133]={box="st-glass2_move", wall="st-metal", inf="fl-metal",
-       outf={"fl-space", "fl-abyss", "fl-abyss", "fl-abyss", "al:random"}, door="st-door_a", oxyd="d"},
-[134]={box="st-marble_move", wall="st-metal", inf="fl-white",
-       outf={"fl-abyss", "st-grate1", "st-invisible", "st-invisible", "st-invisible", "al:waves"}, door="st-door_a", oxyd="d"},
-[135]={box="st-glass_move", wall="st-likeoxydc", inf="fl-white",
-       outf={"fl-white", "st-rock1", "st-invisible", "st-invisible", "st-invisible", "al:random"}, door="st-door_a", oxyd="c"},
-[136]={box="st-block", wall={"st-oneway_white-n", "st-oneway_white-s", "st-oneway_white-e", "st-oneway_white-w", "al:random"}, inf="fl-rough",
-       outf={"st-oneway_white-n", "st-oneway_white-s", "st-oneway_white-e", "st-oneway_white-w", "al:random"}, door="st-door_a", oxyd="d"},
-[137]={box={"st-mirror-p-m", "st-mirror-p/m", "st-mirror-p\\m", "st-mirror-p|m", "al:random"},
-       --wall={"st-laser-n", "st-laser-s", "st-laser-e", "laser-w", "al:random"},
-       wall={"st-glass3", "fl-abyss"}, inf="fl-metal",
-       --wall={"st-mirror-p-", "st-mirror-p/", "st-mirror-p\\", "st-mirror-p|", "al:random"},
-       outf={"st-mirror-p-", "st-mirror-p/", "st-mirror-p|", "st-mirror-p\\", "al:random"}, door="st-door_a", oxyd="b"},
-[138]={box="st-shogun-s", wall="st-panel", inf="fl-stwood", outf="fl-water", door="st-door_a", oxyd="d"},
-[139]={box="st-shogun-s", wall={"st-white4", "fl-springboard", "fl-abyss_fake"}, inf={"fl-springboard", "fl-abyss_fake"},
-       outf={"st-white1", "st-black1", "fl-springboard", "fl-abyss_fake"}, door="st-door_a", oxyd="b"},
-[140]={box="st-brownie", wall={"st-stone1", "fl-leavesb"}, inf={"fl-floor_001", "fr:3.0"},
-       outf={"fl-leavese4", "fl-leavese2", "fl-leavese1", "fl-leavese3", "al:waves"}, door="st-door_a", oxyd="d"},
-[141]={box="st-brownie", wall={"st-rock4", "fl-leavesb"}, inf={"fl-bluegreenx", "mf:1.0", "fr:3.0"},
-       outf={"fl-water", "st-rock10", "st-invisible", "st-invisible", "st-invisible", "al:waves"}, door="st-door_a", oxyd="d"},
-[142]={box="st-glass2_move", wall={"st-glass1", "fl-leavesb"}, inf="fl-leavesb",
-       outf={"fl-leavesc4", "fl-leavesd2", "fl-leavesc2", "fl-leavese3", "al:waves"}, door="st-door_a", oxyd="d"},
-[143]={box="st-block", wall={"st-rock5", "fl-stwood"}, inf="fl-wood",
-       outf={"st-disco-light", "fl-wood1", "fl-wood1", "fl-wood1", "fl-wood2", "al:waves"}, door="st-door_a", oxyd="a"},
-[144]={box="st-wood", wall="st-rock6", inf="fl-bluegreen",
-       outf={"fl-space", "it-squashed", "it-sensor", "it-sensor", "it-sensor", "al:random"}, door="st-door_a", oxyd="d"},
-[145]={box="st-glass1_move", wall={"st-greenbrown", "fl-sand"}, inf="fl-dunes",
-       outf={"fl-sand", "it-landmine", "it-booze-broken", "it-none", "it-none", "it-none", "it-none", "it-none", "it-none", "al:random"},
-       door="st-door_a", oxyd="a"},
-[146]={box="st-wood", wall="st-rock1", inf="fl-black",
-       outf={"fl-abyss", "st-grate1", "st-none", "st-none", "st-none", "st-none", "st-none", "st-none",
-       "st-none", "st-none", "st-none", "st-none", "al:random"}, door="st-door_a", oxyd="c", white = true},
-[147]={box="st-wood", wall="st-whiteballs", inf="fl-gray", white = true,
-       outf={"fl-gradient5", "fl-gradient6", "fl-gradient7", "fl-gradient8", "al:waves"}, door="st-door_a", oxyd="a"},
-[148]={box="st-shogun-s", wall="st-metal", inf="fl-rough-blue", white = true,
-       outf={"fl-rough-red", "fl-rough-blue", "st-disco-light"}, door="st-door_a", oxyd="a"},
-[149]={box="st-shogun-s", wall="st-yellow", inf="fl-wood", outf="fl-swamp", door="st-door_a",
-       oxyd="c", goal="it-shogun-s", white = true},
-[150]={box="st-flrock", wall="st-redrock", inf="fl-brick", outf="fl-space", door="st-door_a", oxyd="c", white = true},
-}
-
---
--- Remaining walls:
---  st-beads, st-brick, st-bumps, st-camouflage, st-fakeoxyd,
---  st-glass1/2/3, st-likeoxyda/b/c/d[-open], [st-marble],
---  st-redrock, st-rock2/7/8/9/10, st-stone1/2, st-panel,
---  st-woven, st-yellow
---
--- Remaining boxes:
---  st-camouflage_move, st-glass1/2_move, st-rock1_move, st-flhay,
---  st-flrock
---
--- Remaining floors (inside):
---  fl-abyss_fake, fl-black, fl-bluegreen[x], fl-brick, fl-bumps,
---  fl-concrete, fl-darkgray, fl-dunes, [fl-floor_001], fl-gravel,
---  fl-gray, fl-hay, fl-leavesb/c/d/e*, fl-lightgray, fl-marble,
---  fl-metal, fl-mortar, [fl-normal[_x]], fl-plank, fl-red,
---  fl-rock, fl-rough-blue, fl-sahara, fl-sand, fl-springboard,
---  fl-stone, fl-stwood, [fl-trigger], fl-woven
---
--- have: fl-acblack, fl-bluegray, fl-himalaya, fl-leaves,
---       fl-light, fl-rough, fl-rough-red, fl-samba, fl-tigris,
---       fl-white, fl-wood
---
--- outside (have): fl-abyss, fl-leaves, fl-rough-blue, fl-sahara,
---                 fl-space, fl-water
---
-
 ------------------------------------------------------------------------
--- Global variables
-------------------------------------------------------------------------
-
-number_goals = 0
-goals_filled = 0
-endphase_started = false
-levelw = 0
-levelh = 0
-level_array = {}
-chosen_design = default_design
-
-------------------------------------------------------------------------
 -- Tools
 ------------------------------------------------------------------------
 
@@ -315,12 +86,20 @@
   error(st)
 end
 
-function is_floor(s)       return string.sub(s, 1, 3) == "fl-"  end
-function is_stone(s)       return string.sub(s, 1, 3) == "st-"  end
-function is_item(s)        return string.sub(s, 1, 3) == "it-"  end
-function is_algorithm(s)   return string.sub(s, 1, 3) == "al:"  end
-function is_friction(s)    return string.sub(s, 1, 3) == "fr:"  end
-function is_mousefactor(s) return string.sub(s, 1, 3) == "mf:"  end
+function is_floor(s)        return string.sub(s, 1, 3) == "fl-"  end
+function is_stone(s)        return string.sub(s, 1, 3) == "st-"  end
+function is_item(s)         return string.sub(s, 1, 3) == "it-"  end
+function is_actor(s)        return string.sub(s, 1, 3) == "ac-"  end
+function is_algorithm(s)    return string.sub(s, 1, 3) == "al:"  end
+function is_friction(s)     return string.sub(s, 1, 3) == "fr:"  end
+function is_mousefactor(s)  return string.sub(s, 1, 3) == "mf:"  end
+function char_is_wall(ch)   return string.find(ch, "[#]")       == 1  end
+function char_is_goal(ch)   return string.find(ch, "[\.\*\+N]") == 1  end
+function char_is_box(ch)    return string.find(ch, "[$\*]")     == 1  end
+function char_is_chess(ch)  return string.find(ch, "[nN]")      == 1  end
+function char_is_player(ch) return string.find(ch, "[@\+]")     == 1  end
+function char_is_outf(ch)   return string.find(ch, "[ ]")       == 1  end
+function char_is_inf(ch)    return not char_is_outf(ch)               end
 
 -- combine_tables returns a table consisting of all entries of the
 -- entries of OVER_TABLE: OVER_TABLE is a table of tables, say
@@ -357,10 +136,85 @@
   end
 end
 
--- set_element sets element name EL_STR of design DESIGN at x, y.
-function set_element(x, y, design, el_str)
-  local el = design[el_str]
+-- no_way_near returns a boolean whether (x,y) is not
+-- reachable by the marble.
+function no_way_near(x, y, sokoarea_number)
+  local la = sokoarea[sokoarea_number].level_array
+  local char_n = (la[y-1] or {})[x] or "-"
+  local char_s = (la[y+1] or {})[x] or "-"
+  local char_w = (la[y] or {})[x-1] or "-"
+  local char_e = (la[y] or {})[x+1] or "-"
+  return     (char_is_outf(char_n) or char_is_wall(char_n))
+         and (char_is_outf(char_s) or char_is_wall(char_s))
+         and (char_is_outf(char_w) or char_is_wall(char_w))
+         and (char_is_outf(char_e) or char_is_wall(char_e))
+end
 
+-- one_tile_far_from_way checks whether (x,y) is reachable
+-- by the marble through exactly one stone. If not, it returns
+-- nil, else the position of this stone.
+function one_tile_far_from_way(x, y, sokoarea_number)
+  -- first of all, make sure there is no direct way 
+  --if not no_way_near(x, y, sokoarea_number) then
+  --  return nil
+  --end
+  -- now analyse the following positions relative to our
+  -- center C = (x,y), marked by stars:
+  --   *
+  --  *.*
+  -- *.C.*
+  --  *.*
+  --   *
+  local la = sokoarea[sokoarea_number].level_array
+  local neighborhood = {          {x= 0, y=-2},
+                    {x=-1, y=-1},               {x= 1, y=-1},
+      {x=-2, y= 0},                                           {x= 2, y= 0},
+                    {x=-1, y= 1},               {x= 1, y= 1},
+                                  {x= 0, y= 2},                            }
+  local char = {}
+  for j, k in pairs(neighborhood) do
+    char[j] = {ch = (la[y+k.y] or {})[x+k.x] or "", nr = j}
+  end
+  -- from this list, remove all empty positions, walls and outf
+  local char_backup = char
+  for j, v in pairs(char_backup) do
+    if char_is_outf(v.ch) or char_is_wall(v.ch) or (v.ch == "") then
+      table.remove(char, j)
+    end
+  end
+  -- return nil or a random element of char
+  if table.getn(char) == 0 then
+    return nil
+  else
+    local n = neighborhood[char[random(1, table.getn(char))].nr]
+    return {x=x+n.x, y=y+n.y}
+  end
+end
+
+-- check_chess returns a boolean whether a chess stone is used
+-- in the sokoarea SOKOAREA_NUMBER.
+function check_chess(sokoarea_number)
+  mydebug(sokoarea[1].level_array[3][3])
+  for y = 1, sokoarea[sokoarea_number].array_height do
+    for x = 1, sokoarea[sokoarea_number].array_width do
+      local ch = sokoarea[sokoarea_number].level_array[y][x]
+      if char_is_chess(ch) then
+        return true
+      end
+    end
+  end
+  return false
+end
+
+-- set_element sets element name EL_STR of area SOKOAREA_NUMBER at x, y.
+-- EL_DESIGN is optional and overrides the design of the given sokoarea.
+function set_element(x, y, sokoarea_number, el_str, el_design)
+  if type(sokoarea[sokoarea_number]) ~= "table" then
+    myerror("Sokoarea table number "..sokoarea_number.." broken or not existing.")
+  end
+  local el = el_design or sokoarea[sokoarea_number].design[el_str]
+  local in_endphase = sokoarea[sokoarea_number].endphase_started
+
   if (type(x) ~= "number") or (type(y) ~= "number") then
     myerror("libsoko.set_element: Coordinates are not numbers!")
     return
@@ -405,31 +259,44 @@
   ----------- stone ---------------
   if table.getn(st) > 0 then
     local stkind = st[choose_among_multiples(x, y, table.getn(st), multiple_alg)]
-    if stkind ~= "st-none" then
-      created_objects.st = set_stone(stkind, x, y)
+    local existing_stone = enigma.GetStone(x, y)
+    if (not existing_stone) or (enigma.GetKind(existing_stone) ~= "st-oxyd") then
+      if stkind == "st-none" then
+        kill_stone(x, y)
+      else
+        created_objects.st = set_stone(stkind, x, y)
+      end
     end
   end
 
   ----------- item ----------------
   if table.getn(it) > 0 then
     local itkind = it[choose_among_multiples(x, y, table.getn(it), multiple_alg)]
-    if itkind ~= "it-none" then
+    if sokoarea[sokoarea_number].uses_chess and not in_endphase then
+      itkind = "it-trigger"
+    end    
+    if itkind == "it-none" then
+      kill_item(x, y)
+    else
       created_objects.it = set_item(itkind, x, y)
     end
-    if created_objects.it then
+    if created_objects.it and not in_endphase then
       enigma.SetAttrib(created_objects.it, "action", "callback")
       enigma.SetAttrib(created_objects.it, "target", "goal_trigger")
       enigma.SetAttrib(created_objects.it, "box", 0)
-      number_goals = number_goals + 1
+      enigma.SetAttrib(created_objects.it, "sokoarea", sokoarea_number)
     end
+    if (el_str == "goal") and not in_endphase then
+      sokoarea[sokoarea_number].number_goals = 
+          sokoarea[sokoarea_number].number_goals + 1
+    end
   end
   
   return created_objects
 end
 
--- draw_level_array draws a sokoball level from global variable LEVEL_ARRAY
--- with design CHOSEN_DESIGN (global var, a ready-for-use design table)
--- at offset DX, DY. If OUTSIDE is true, the outside will be drawn as well.
+-- draw_level_array draws the sokoarea SOKOAREA_NUMBER at offset DX, DY.
+-- If OUTSIDE is true, the outside will be drawn as well.
 -- DRAW_ACTOR determines whether the actor should be placed.
 -- draw_level_array will NOT
 --  - create the world
@@ -438,14 +305,16 @@
 --  - solve the level
 -- This function is not intended to be used in level programming
 -- directly, use "draw_sokoball" instead.
-function draw_level_array(dx, dy, outside, draw_actor)
-  local array_width = table.getn(level_array[1])
-  local array_height = table.getn(level_array)
+function draw_level_array(sokoarea_number, outside, draw_actor)
+  local nr = sokoarea_number or 1
+  local design = sokoarea[nr].design
+  local dx = sokoarea[nr].offset.x
+  local dy = sokoarea[nr].offset.y
 
   -- create level
-  for y = 0, array_height - 1 do
-    for x = 0, array_width - 1 do
-      local ch = level_array[y+1][x+1]
+  for y = 0, sokoarea[nr].array_height - 1 do
+    for x = 0, sokoarea[nr].array_width - 1 do
+      local ch = sokoarea[nr].level_array[y+1][x+1]
       local obj = {}
       
       -- set floor outside or floor inside
@@ -453,35 +322,35 @@
         if outside then
           kill_stone(x+dx, y+dy)
           kill_item(x+dx, y+dy)
-          set_element(x+dx, y+dy, chosen_design, "outf")
+          set_element(x+dx, y+dy, nr, "outf")
         end
       else
         kill_stone(x+dx, y+dy)
         kill_item(x+dx, y+dy)
-        obj = set_element(x+dx, y+dy, chosen_design, "inf")
+        obj = set_element(x+dx, y+dy, nr, "inf")
         enigma.SetAttrib(obj.fl, "freeze_check", true)
       end
       
       -- Walls
-      if (ch == "#") then
-        obj = set_element(x+dx, y+dy, chosen_design, "wall")
+      if char_is_wall(ch) then
+        obj = set_element(x+dx, y+dy, nr, "wall")
       end
       
       -- Goals
-      if (ch == "+") or (ch == "*") or (ch == ".") or (ch == "N") then
-        obj = set_element(x+dx, y+dy, chosen_design, "goal")
+      if char_is_goal(ch) then
+        obj = set_element(x+dx, y+dy, nr, "goal")
         enigma.SetAttrib(enigma.GetFloor(x+dx, y+dy), "freeze_check", false)
       end
       
       -- Boxes
-      if (ch == "$") or (ch == "*") then
-        obj = set_element(x+dx, y+dy, chosen_design, "box")
+      if char_is_box(ch) then
+        obj = set_element(x+dx, y+dy, nr, "box")
         enigma.SetAttrib(obj.st, "freeze_check", true)
       end
       
       -- Chess-Stones
-      if (ch == "n") or (ch == "N") then
-        if chosen_design["white"] then
+      if char_is_chess(ch) then
+        if design["white"] then
           set_stone("st-chess_white", x + dx, y + dy)
         else
           set_stone("st-chess_black", x + dx, y + dy)
@@ -489,11 +358,15 @@
       end
       
       -- Actors
-      if ((ch == "@") or (ch == "+")) and draw_actor then
-        if chosen_design["white"] then
-          set_actor("ac-whiteball", x + 0.5 + dx, y + 0.5 + dy, { name = "marble", controllers = 1, player = 0 })
+      if char_is_player(ch) and draw_actor then
+        sokoarea[nr].actor_count = sokoarea[nr].actor_count + 1
+        local acname = "marble_"..nr.."_"..sokoarea[nr].actor_count
+        if design["white"] then
+          set_actor("ac-whiteball", x + 0.5 + dx, y + 0.5 + dy,
+              { name = acname, controllers = 1, player = 0 })
         else
-          set_actor("ac-blackball", x + 0.5 + dx, y + 0.5 + dy, { name = "marble" })
+          set_actor("ac-blackball", x + 0.5 + dx, y + 0.5 + dy,
+              { name = acname })
         end
       end
     end
@@ -534,8 +407,8 @@
     .."[ \-\#\_\$\.@\*0-9Nn\+]*"  -- again all allowed characters except line ending
   local in_level = false
   for line in string.gfind(multilevel, "([^\n\|]*)[\n\|]") do
-    if string.match(line, level_line_match) == line then
-      mydebug("Level "..current_level.." : |"..line.."|")
+    local start_match, end_match = string.find(line, level_line_match)
+    if (start_match == 1) and (end_match == string.len(line)) then
       if in_level then
         if current_level == (sublevel_number or 1) then
           level = level..line.."\n"
@@ -548,6 +421,7 @@
           level = line.."\n"
         end
       end
+      mydebug("Level "..current_level.." : |"..line.."|")
     else
       in_level = false
     end
@@ -561,7 +435,7 @@
   end
 
   -- parse the string LEVEL
-  level_array = {}
+  local level_array = {}
   local line = 1
   level_array[line] = {}
   local count = 0   -- (a simple counter for runlength encoding)
@@ -592,67 +466,113 @@
     end    
   end
   
-  -- normalize level height
-  local lastline = nil
-  for j = 0, line - 1 do
-    if (not lastline) and (table.getn(level_array[line - j]) == 0) then
-      table.remove(level_array, line - j)
-    else
-      if (not lastline) then 
-        lastline = line - j
-      end
-    end
-  end
-  while table.getn(level_array[1]) == 0 do
-    table.remove(level_array, 1)
-    lastline = lastline - 1
-  end
-  if lastline ~= table.getn(level_array) then
-    myerror("Length of sokoball level is corrupt: Last line is "..lastline
-            ..", but table has length "..table.getn(level_array).."!")
-  end
-  if lastline < 2 then
-    myerror("Length of sokoball level is only "..lastline.."!")
-  end
-  mydebug("Sokoball level height: "..lastline)
-  
   -- normalize level width
   local maxwidth = 0
-  for j = 1, lastline do
+  local maxheight = table.getn(level_array)
+  for j = 1, maxheight do
     maxwidth = math.max(maxwidth, table.getn(level_array[j]))
   end
-  for j = 1, lastline do
+  for j = 1, maxheight do
     while table.getn(level_array[j]) < maxwidth do
       table.insert(level_array[j], "-")
     end
-  end
-  
+  end  
+
   -- mark outside floor fields from the border
   function check_for_outside(x, y)
     if level_array[y][x] == "-" then
       level_array[y][x] = " "
       if y > 1         then  check_for_outside(x, y - 1)  end
-      if y < lastline  then  check_for_outside(x, y + 1)  end
+      if y < maxheight then  check_for_outside(x, y + 1)  end
       if x > 1         then  check_for_outside(x - 1, y)  end
       if x < maxwidth  then  check_for_outside(x + 1, y)  end
     end
   end
-  for y = 1, lastline do
+  for y = 1, maxheight do
     check_for_outside(1, y)
     check_for_outside(maxwidth, y)
   end
   for x = 1, maxwidth do
     check_for_outside(x, 1)
-    check_for_outside(x, lastline)
+    check_for_outside(x, maxheight)
   end
-  
-  return level_array
-end
 
+  -- replace redundant walls by outside
+  for x = 1, maxwidth do
+    for y = 1, maxheight do
+      if char_is_wall(level_array[y][x]) then
+        local redundant = true
+        for dx = -1, 1 do
+          for dy = -1, 1 do
+            local ch = (level_array[y+dy] or {})[x+dx] or " "
+            redundant = redundant
+                          and (char_is_wall(ch) or (ch == " "))
+          end
+        end
+        if redundant then
+          level_array[y][x] = " "
+        end
+      end
+    end
+  end
 
+  -- trim level
+  local border_n = maxheight
+  local border_s = 1
+  local border_w = maxwidth
+  local border_e = 1
+  for x = 1, maxwidth do
+    for y = 1, maxheight do
+      if not char_is_outf(level_array[y][x]) then
+        border_n = math.min(border_n, y)
+        border_s = math.max(border_s, y)
+        border_w = math.min(border_w, x)
+        border_e = math.max(border_e, x)        
+      end
+    end
+  end
+  if (border_n >= border_s) or (border_w >= border_e) then
+    myerror("libsoko: Level is empty or trimming code is corrupt.")
+  end
+  mydebug("N: "..border_n..", S: "..border_s
+      ..", W: "..border_w..", E: "..border_e)
+  local trimmed_array = {}
+  for y = border_n, border_s do
+    trimmed_array[y - border_n + 1] = {}
+    line = ""
+    for x = border_w, border_e do
+      trimmed_array[y - border_n + 1][x - border_w + 1] = level_array[y][x]
+      line = line .. level_array[y][x]
+    end
+    mydebug("|"..line.."|")
+  end
+  mydebug(table.getn(trimmed_array).." : "..table.getn(trimmed_array[1]))
+  return trimmed_array
+end
 
+-- new_sokoarea initialises a new entry in the global
+-- sokoarea table and returns its number.
+function new_sokoarea()
+  sokoarea_number = table.getn(sokoarea) + 1
+  sokoarea[sokoarea_number] = {
+    level_array = {},
+    design = default_design,
+    number_goals = 0,
+    goals_filled = 0,
+    actor_count = 0,
+    endphase_started = false,
+    offset = {0, 0},
+    level_width = nil,
+    level_height = nil,
+    uses_chess = false,
+    goal_hook = nil,
+    endphase_hook = endphase
+  }
+  return sokoarea_number
+end
+
 ------------------------------------------------------------------------
--- Choosing the Designnumber
+-- Choosing the Designnumber, Random numbers
 ------------------------------------------------------------------------
 
 -- design_from_level determines a random design number, based on the
@@ -660,7 +580,10 @@
 -- is inspired by the horseshoe mapping and thereby deterministically
 -- chaotic. To illustrate, why we don't use a simpler calculation
 -- using random seeds pseudo-random number generators, we expose on
--- this nice mathematical problem a bit deeper.
+-- this nice mathematical problem a bit deeper. And although the
+-- algorithm we use to determine design numbers is as well be used
+-- in other situations in this library, we stick to the design number
+-- as concrete example.
 --
 -- Main Problem:
 --
@@ -764,7 +687,7 @@
     b = 0
     for y = 1, lastline do
       for x = 1, maxwidth do
-        if level_array[y][x] == "#" then
+        if char_is_wall(level_array[y][x]) then
           if 2*b + 1 < j then
             b = 2*b + 1
           else
@@ -778,14 +701,14 @@
         end
       end
     end
-    --mywarning(b)
   until (b == 0) or (j == 1)
-  mywarning("Calculation ended. Result: "..j)
+  mydebug("Calculation ended. Result: "..j)
   return j
 end
 
-function design_from_level(level_array)
-  return design_list[number_from_level(level_array, table.getn(design_list))]
+function design_from_level(level_array, list_length)
+  return design_list[number_from_level(level_array,
+            list_length or table.getn(design_list))]
 end
 
 -- design_from_description takes a description of the design as argument
@@ -794,80 +717,23 @@
 --  - a number specifying the number of the design in the design list
 --  - "nil" plus a level_array from which a design from the design
 --    list will be chosen.
-function design_from_description(design, level_array)
+function design_from_description(design_description, level_array)
   -- choose design
-  local chosen_design = {}
-  if type(design) == "number" then
-    chosen_design = design_list[design]
-  elseif type(design) == "table" then
-    chosen_design = design
-  elseif (type(design) == "nil") and (type(level_array) == "table") then
-    chosen_design = design_from_level(level_array)
+  local design = {}
+  if type(design_description) == "number" then
+    design = design_list[design_description]
+  elseif type(design_description) == "table" then
+    design = design_description
+  elseif (type(design_description) == "nil") and (type(level_array) == "table") then
+    design = design_from_level(level_array)
   else
     myerror("Can't make sense of design type "..type(design)..".")
   end
   -- fill chosen design with default values where neccessary, and return
-  return combine_tables({chosen_design, default_design})
+  return combine_tables({design, default_design})
 end
 
-------------------------------------------------------------------------
--- Goal Trigger and Oxyd Opening (Endphase)
-------------------------------------------------------------------------
 
-function goal_trigger(onoff, sender)
-  local x, y = enigma.GetPos(sender)
-  if(enigma.GetAttrib(sender, "box") == 0) then
-    if enigma.GetStone(x,y) then
-      enigma.SetAttrib(sender, "box", 1)
-      goals_filled = goals_filled + 1
-    end
-  else
-    enigma.SetAttrib(sender, "box", 0)
-    goals_filled = goals_filled - 1
-  end
-  if (goals_filled == number_goals) and not endphase_started then
-    endphase_started = true
-    endphase()
-  end
-end
-
-function prepare_oxyds(oxop)
-end
-
-function endphase()
-  local x, y = enigma.GetPos(enigma.GetNamedObject("marble"))
-  if x > 10 then
-    x = x - 2
-  end
-  if y > 6 then
-    y = y - 2
-  end
-  for j = 0, 2 do
-    oxyd(x+j, y-1)
-    oxyd(x-1, y+j)
-    oxyd(x+j, y+3)
-    oxyd(x+3, y+j)
-    for k = 0, 2 do
-      kill_stone(x+j, y+k)
-      kill_item(x+j, y+k)
-      set_element(x+j, y+k, chosen_design, "inf")
-    end
-  end
-  set_stone("st-fart", x+1, y+1)
-  oxyd_shuffle()
-end
-
--- The 75 first designs use the following boxes:
---  st-block  ->  st-black, st-blocker, st-brake, st-laser, fl-swamp
---  st-brownie  ->  st-coinslot, st-pull
---  st-glass_move  ->  cherry
---  st-greenbrown_move  ->  hole
---  st-marble_move  ->  hole
---  st-rock3_move  ->  *
---  st-shogun  ->  st-shogun-m (not completely!)
---  st-wood[-growing]  ->  fl-swamp
-
-
 ------------------------------------------------------------------------
 -- Interface functions
 ------------------------------------------------------------------------
@@ -882,121 +748,173 @@
 -- number is created from LEVEL which uniquely* determines a design
 -- from the design list. *Uniquely means: The design might change
 -- when the design list is enlarged.
+-- Returns width and height of new level.
 --
 function create_sokoball(level, sublevel, design)
+  -- check that this is the first sokoarea, and initialise it.
+  if type(sokoarea) ~= "table" then
+    myerror("No sense in sokoarea of type "..type(sokoarea)..".")
+  end
+  if table.getn(sokoarea) ~= 0 then
+    myerror("Tried to use create_sokoball twice. Use draw_sokoball instead.")
+  end
+  new_sokoarea()
+
   -- unpack level
-  level_array = unpack_level(level, sublevel)
+  sokoarea[1].level_array = unpack_level(level, sublevel)
 
   -- calculate screen position
   -- Important Note: level_array is reversely indexed, i.e.
   --                 level_array[y-coordinate][x-coordinate]
-  local array_width = table.getn(level_array[1])
-  local array_height = table.getn(level_array)
-  levelw = math.max(array_width, 20)
-  levelh = math.max(array_height, 13)
+  sokoarea[1].array_width = table.getn(sokoarea[1].level_array[1])
+  sokoarea[1].array_height = table.getn(sokoarea[1].level_array)
+  mydebug(sokoarea[1].array_height.." : "..sokoarea[1].array_width)
+  sokoarea[1].uses_chess = check_chess(1)
+  local levelw = math.max(sokoarea[1].array_width, 20)
+  local levelh = math.max(sokoarea[1].array_height, 13)
+  sokoarea[1].level_width = levelw
+  sokoarea[1].level_height = levelh
   create_world(levelw, levelh)
   
   -- Calculate padding
   local dx = 0
   local dy = 0
-  if levelw > array_width then
-    dx = math.floor((levelw - array_width) / 2)
+  if levelw > sokoarea[1].array_width then
+    dx = math.floor((levelw - sokoarea[1].array_width) / 2)
   end
-  if levelh > array_height then
-    dy = math.floor((levelh - array_height) / 2)
+  if levelh > sokoarea[1].array_height then
+    dy = math.floor((levelh - sokoarea[1].array_height) / 2)
   end
-  
-  chosen_design = design_from_description(design, level_array)
+  sokoarea[1].offset = {x = dx, y = dy}
 
+  sokoarea[1].design = 
+      design_from_description(design, sokoarea[1].level_array)
+
   for x = 0, levelw - 1 do
     for y = 0, levelh - 1 do
-      set_element(x, y, chosen_design, "outf")
+      set_element(x, y, 1, "outf")
     end
   end
-  
-  draw_level_array(dx, dy, true, true)
 
-  if number_goals < 1 then
+  draw_level_array(1, true, true)
+
+  if sokoarea[1].number_goals < 1 then
     myerror("No goals defined!\n")
   end
 
-  -- determine oxop (way to open oxyds)
-  local oxop = chosen_design.oxop
-  prepare_oxyds(oxop)
+  -- prepare oxyds for end phase
+  prepare_endphase(1)
 
+  -- Enigma's global variables
+  enigma.ConserveLevel = FALSE
   enigma.ShowMoves = TRUE
   display.SetFollowMode(display.FOLLOW_SMOOTH)
-  enigma.ConserveLevel = FALSE
+
+  -- return level width and height
+  return levelw, levelh
 end
 
 -- recreate_sokoball is used for design development only.
--- It redraws the current level from scratch, but not the world
--- and doesn't add another actor.
-function recreate_sokoball(design)
-  -- calculate screen position
-  -- Important Note: level_array is reversely indexed, i.e.
-  --                 level_array[y-coordinate][x-coordinate]
-  local array_width = table.getn(level_array[1])
-  local array_height = table.getn(level_array)
-  levelw = math.max(array_width, 20)
-  levelh = math.max(array_height, 13)
+-- It redraws the sokoarea with number sokoarea_number (or 1)
+-- from scratch, but not the world and doesn't add another
+-- actor.
+--
+function recreate_sokoball(design, sokoarea_number)
+  local nr = sokoarea_number or 1  
+  sokoarea[nr].design =
+      design_from_description(design, sokoarea[nr].level_array)
   
-  -- Calculate padding
-  local dx = 0
-  local dy = 0
-  if levelw > array_width then
-    dx = math.floor((levelw - array_width) / 2)
-  end
-  if levelh > array_height then
-    dy = math.floor((levelh - array_height) / 2)
-  end
-  
-  chosen_design = design_from_description(design, level_array)
-
-  for x = 0, levelw - 1 do
-    for y = 0, levelh - 1 do
-      kill_stone(x, y)
-      kill_item(x, y)
-      set_element(x, y, chosen_design, "outf")
+  if sokoarea[nr].level_width and sokoarea[nr].level_height then
+    for x = 0, sokoarea[nr].level_width - 1 do
+      for y = 0, sokoarea[nr].level_height - 1 do
+        kill_stone(x, y)
+        kill_item(x, y)
+        set_element(x, y, nr, "outf")
+      end
     end
+  else
+    for x = 0, sokoarea[nr].array_width - 1 do
+      for y = 0, sokoarea[nr].array_height - 1 do
+        local rx = x + sokoarea[nr].offset.x
+        local ry = y + sokoarea[nr].offset.y
+        kill_stone(rx, ry)
+        kill_item(rx, ry)
+        set_element(rx, ry, nr, "outf")
+      end
+    end
   end
-  
-  draw_level_array(dx, dy, true, false)
 
-  if number_goals < 1 then
+  sokoarea[nr].number_goals = 0
+  sokoarea[nr].goals_filled = 0
+  sokoarea[nr].endphase_started = false
+
+  draw_level_array(nr, true, false)
+
+  if sokoarea[nr].number_goals < 1 then
     myerror("No goals defined!\n")
   end
 
-  -- determine oxop (way to open oxyds)
-  local oxop = chosen_design.oxop
-  prepare_oxyds(oxop)
-
-  enigma.ShowMoves = TRUE
-  display.SetFollowMode(display.FOLLOW_SMOOTH)
-  enigma.ConserveLevel = FALSE
+  -- prepare oxyds for end phase
+  prepare_endphase(nr)
+  mywarning(sokoarea[nr].design.endp.alg)
 end
 
--- draw_sokoball draws a sokoball level from argument LEVEL with design
--- DESIGN (see create_sokoball) at offset DX, DY. It's arguments are
--- identical to those of create_sokoball. Whereas create_sokoball should
--- be used for sokoball-only levels, draw_sokoball can be used to add a
--- sokoban type area to a larger level. The difference is as follows:
+-- draw_sokoball draws a sokoball level from argument LEVEL, sublevel
+-- number SUBLEVEL with design DESIGN (see create_sokoball) at offset
+-- DX, DY. It's arguments are identical to those of create_sokoball.
+-- Whereas create_sokoball should be used for sokoball-only levels,
+-- draw_sokoball can be used to add a sokoban type area to a larger
+-- level. The difference is as follows:
 -- draw_sokoball will NOT:
 --  - create the world before drawing to it
 --  - draw the outside, such that it doesn't overwrite the rest of your
 --    level
+--  - draw any oxyds
 --  - solve the level when all triggers are activated.
 -- DRAW_ACTOR determines if an actor should be placed.
--- Note: Overwriting one sokoball part by another creates problems
+-- ENDPHASE_HOOK is the function to be called when all goals are filled.
+-- GOAL_HOOK is called when a single goal is triggered (see libsoko-endphase).
+-- (As a function, not as a string!) If it's nil, the standard
+-- function from this library will be called. This might be
+-- broken as no oxyds have been prepared.
+-- Note: Overwriting one sokoarea with another creates problems
 --       with the triggers.
 --
-function draw_sokoball(dx, dy, level, sublevel, design, draw_actor)
+function draw_sokoball(dx, dy, level, sublevel, design, draw_actor,
+                       endphase_hook, goal_hook)
+  local nr = new_sokoarea()
   -- unpack level
-  level_array = unpack_level(level, sublevel)
-  chosen_design = design_from_description(design, level_array)
-  draw_level_array(dx, dy, false, draw_actor)
+  sokoarea[nr].level_array = unpack_level(level, sublevel)
+  sokoarea[nr].array_width = table.getn(sokoarea[nr].level_array[1])
+  sokoarea[nr].array_height = table.getn(sokoarea[nr].level_array)
+  sokoarea[nr].uses_chess = check_chess(nr)
+  sokoarea[nr].offset = {x = dx, y = dy}
+  sokoarea[nr].design = 
+      design_from_description(design, sokoarea[nr].level_array)
+  if hook ~= nil then
+    sokoarea[nr].endphase_hook = endphase_hook
+  end
+  sokoarea[nr].goal_hook = goal_hook
+  draw_level_array(nr, false, draw_actor)
 end
 
+-- design_statistics uses mywarning to output statistics of
+-- the used algorithms
+function design_statistics()
+  alglist = {}
+  for k, v in pairs(design_list) do
+    if v.endp then
+      alg = v.endp.alg
+      if alg then
+        alglist[alg] = (alglist[alg] or 0) + 1
+      end
+    end
+  end
+  for k, v in pairs(alglist) do
+    mywarning(k..": "..v)
+  end
+end
+
     ]]></el:luamain>
     <el:i18n>
     </el:i18n>

Modified: trunk/src/stones.cc
===================================================================
--- trunk/src/stones.cc	2007-10-11 22:59:06 UTC (rev 900)
+++ trunk/src/stones.cc	2007-10-11 23:48:36 UTC (rev 901)
@@ -224,12 +224,12 @@
 }
 
 bool Stone::freeze_check() {
+    GridPos this_pos = this->get_pos();
     // Check if stone and floor ask for freeze_check
     if (!to_bool(this->getAttr("freeze_check")))
         return false;
     if (freeze_check_running)
-        return true;
-    GridPos this_pos = this->get_pos();
+        return false;
     Floor *fl = GetFloor(this_pos);
     if ((fl == NULL) || (!fl->is_freeze_check()))
         return false;
@@ -294,14 +294,14 @@
         // avoid endless loop with bool freeze_check_running
         if (Stone *st = GetStone(this_pos))
             st->freeze_check_running = true;
-        if (Stone *st = GetStone(move(this_pos, NORTH)))
-            st->freeze_check();
-        if (Stone *st = GetStone(move(this_pos, SOUTH)))
-            st->freeze_check();
-        if (Stone *st = GetStone(move(this_pos, EAST)))
-            st->freeze_check();
-        if (Stone *st = GetStone(move(this_pos, WEST)))
-            st->freeze_check();
+        if (Stone *stn = GetStone(move(this_pos, NORTH)))
+            stn->freeze_check();
+        if (Stone *stn = GetStone(move(this_pos, SOUTH)))
+            stn->freeze_check();
+        if (Stone *stn = GetStone(move(this_pos, EAST)))
+            stn->freeze_check();
+        if (Stone *stn = GetStone(move(this_pos, WEST)))
+            stn->freeze_check();
         if (Stone *st = GetStone(this_pos))
             st->freeze_check_running = false;
         return true;

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2007-10-11 22:59:06 UTC (rev 900)
+++ trunk/src/world.cc	2007-10-11 23:48:36 UTC (rev 901)
@@ -1612,13 +1612,26 @@
             st->freeze_check();
             st = f->stone;
         }
-
+        
         if (Item *it = f->item)
             it->stone_change(st);
 
         if (Floor *fl = f->floor)
             fl->stone_change(st);
 
+        // Additional freeze checks of the surrounding stones.
+        // (Example: In a sokoball level, a stone has been pushed
+        //           onto a goal, thus it should not freeze. But
+        //           perhaps its neighbor is stuck!)
+        if (Stone *stn = GetStone(move(p, NORTH)))
+            stn->freeze_check();
+        if (Stone *stn = GetStone(move(p, SOUTH)))
+            stn->freeze_check();
+        if (Stone *stn = GetStone(move(p, EAST)))
+            stn->freeze_check();
+        if (Stone *stn = GetStone(move(p, WEST)))
+            stn->freeze_check();
+
         lasers::MaybeRecalcLight(p);
     }
 }



From ral at mail.berlios.de  Sat Oct 13 23:41:41 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sat, 13 Oct 2007 23:41:41 +0200
Subject: [Enigma-game-svn] r902 - in trunk: lib-src/enigma-core src
Message-ID: <200710132141.l9DLff3q014376@sheep.berlios.de>

Author: ral
Date: 2007-10-13 23:41:40 +0200 (Sat, 13 Oct 2007)
New Revision: 902

Modified:
   trunk/lib-src/enigma-core/ecl_math.hh
   trunk/src/enigma.cc
   trunk/src/enigma.hh
   trunk/src/lua.cc
Log:
Trunk 1.1: API reengineering
- Value full support for types GROUP and POSITION
- Lua API: groups and positions can be used as object attributes
- ecl_math.hh detabbed


Modified: trunk/lib-src/enigma-core/ecl_math.hh
===================================================================
--- trunk/lib-src/enigma-core/ecl_math.hh	2007-10-11 23:48:36 UTC (rev 901)
+++ trunk/lib-src/enigma-core/ecl_math.hh	2007-10-13 21:41:40 UTC (rev 902)
@@ -51,8 +51,8 @@
         T v[N];
         typedef Vector<T, N> vector_type;
     protected:
-    	class noinit {};
-    	Vector(noinit) {}
+        class noinit {};
+        Vector(noinit) {}
     public:
 
         // Constructors.
@@ -235,14 +235,14 @@
 
     class V3 : public Vector<double, 3> {
     public:
-    	V3() {}
-	V3(double x, double y, double z) :
-	    Vector<double, 3>(noinit())
-	{
-	    (*this)[0] = x;
-	    (*this)[1] = y;
-	    (*this)[2] = z;
-	}
+        V3() {}
+        V3(double x, double y, double z) :
+            Vector<double, 3>(noinit())
+        {
+            (*this)[0] = x;
+            (*this)[1] = y;
+            (*this)[2] = z;
+        }
         V3(const Vector<double,3> &v_) : Vector<double,3>(v_) {}
         V3 &operator=(const Vector<double,3> &v_) {
             Vector<double,3>::operator=(v_);
@@ -255,7 +255,7 @@
     crossprod(const V3 & a, const V3 & b)
     {
         V3 r;
-	r[0] = a[1]*b[2] - a[2]*b[1];
+        r[0] = a[1]*b[2] - a[2]*b[1];
         r[1] = a[2]*b[0] - a[0]*b[2];
         r[2] = a[0]*b[1] - a[1]*b[0];
         return r;
@@ -265,15 +265,15 @@
 
     class V2 : public Vector<double, 2> {
     public:
-	typedef double T;
+        typedef double T;
 
-    	V2() {}
-	V2(T x, T y) :
-	    Vector<T,2>(noinit())
-	{
-	    (*this)[0] = x;
-	    (*this)[1] = y;
-	}
+        V2() {}
+        V2(T x, T y) :
+            Vector<T,2>(noinit())
+        {
+            (*this)[0] = x;
+            (*this)[1] = y;
+        }
         V2 (const Vector<T,2> &v_) : Vector<T,2>(v_) {}
         V2 &operator=(const Vector<T,2> &v_) {
             Vector<T,2>::operator=(v_);

Modified: trunk/src/enigma.cc
===================================================================
--- trunk/src/enigma.cc	2007-10-11 23:48:36 UTC (rev 901)
+++ trunk/src/enigma.cc	2007-10-13 21:41:40 UTC (rev 902)
@@ -23,10 +23,12 @@
 #include "ecl.hh"
 #include "main.hh"
 #include "objects_decl.hh"
+#include "world.hh"
 
 #include <iostream>
 #include <ctime>
 #include <set>
+#include <vector>
 
 using namespace std;
 using namespace ecl;
@@ -133,38 +135,73 @@
 }
 
 Value::Value(double d) : type (DOUBLE) {
-     val.dval = d;
+     val.dval[0] = d;
 }
 
 Value::Value(int i) : type (DOUBLE) {
-     val.dval = i;
+     val.dval[0] = i;
 }
 
 Value::Value(bool b) : type (BOOL) {
-     val.dval = b;
+     val.dval[0] = b;
 }
 
 Value::Value(Object *obj) : type (OBJECT) {
      if (obj != NULL)
-         val.dval = obj->getId();
+         val.dval[0] = obj->getId();
      else
-         val.dval = 0;
+         val.dval[0] = 0;
 }
 
+Value::Value(ObjectList aList) : type (GROUP) {
+    std::string descriptor;
+    ObjectList::iterator it;
+    for (it = aList.begin(); it != aList.end(); ++it) {
+        if (*it == NULL)
+            descriptor.append("$0,");
+        else {
+            Value v = (*it)->getAttr("name");
+            if (v && v.type == STRING && strcmp(v.val.str, "") != 0) {
+                descriptor.append(v);
+                descriptor.append(",");
+            } else {
+                descriptor.append(ecl::strf("$%d,", (*it)->getId()));
+            }   
+        }
+    }
+    val.str =  new char[descriptor.size() + 1];
+    strcpy(val.str, descriptor.c_str());
+//    Log << "Value ObjectList '" << descriptor << "'\n";
+}
+
+Value::Value(ecl::V2 pos) : type (POSITION) {
+     val.dval[0] = pos[0];
+     val.dval[1] = pos[1];
+}
+
+Value::Value(GridPos gpos) : type (POSITION) {
+     val.dval[0] = gpos.x;
+     val.dval[1] = gpos.y;
+}
+
 Value::Value(Type t) : type (t) {
     switch (t) {
+        case POSITION :
+            val.dval[1] = 0;
+            // fall thorough
         case DOUBLE :
-            val.dval = 0;
+            val.dval[0] = 0;
             break;
         case STRING :
+        case GROUP :
             val.str = new char[1];
             val.str[0] = 0;
             break;
         case BOOL :
-            val.dval = false;
+            val.dval[0] = false;
             break;
         case OBJECT :
-            val.dval = (double) NULL;
+            val.dval[0] = (double) NULL;
             break;
     }
 }
@@ -185,12 +222,18 @@
 
 Value& Value::operator= (const Value& other) {
     if (this != &other) {
-        if (other.type == STRING) {
-            assign(other.val.str);
-        } else {
-            clear();
-            type = other.type;
-            val = other.val;
+        switch (other.type) {
+            case STRING:
+                assign(other.val.str);
+                break;
+            case GROUP:
+                assign(other.val.str);
+                type = GROUP;
+                break;
+            default:
+                clear();
+                type = other.type;
+                val = other.val;
         }
     }
     return *this;
@@ -204,9 +247,12 @@
             case DOUBLE :
             case BOOL :
             case OBJECT :
-                return val.dval == other.val.dval;
+                return val.dval[0] == other.val.dval[0];
             case STRING :
+            case GROUP :
                 return strcmp(val.str, other.val.str) == 0;
+            case POSITION :
+                return (val.dval[0] == other.val.dval[0]) && (val.dval[1] == other.val.dval[1]);
         }
     return true;
 }
@@ -234,7 +280,7 @@
     switch (type) {
         case DOUBLE: 
         case BOOL: 
-            return val.dval;
+            return val.dval[0];
         case STRING:
             return atof(val.str);  // TODO use strtod and eval remaining part of string
         default:
@@ -246,7 +292,7 @@
     switch (type) {
         case DOUBLE:
         case BOOL: 
-            return round_nearest<int>(val.dval);
+            return round_nearest<int>(val.dval[0]);
         case STRING: 
             return atoi(val.str);  //TODO use strtol and eval remaining part of string
         default: return 0;
@@ -256,16 +302,60 @@
 Value::operator Object *() const {
     switch (type) {
         case OBJECT:
-            return Object::getObject(round_nearest<int>(val.dval));
+            return Object::getObject(round_nearest<int>(val.dval[0]));
+        case STRING:
+            return world::GetNamedObject(val.str);            
         default: return NULL;
     }
 }
 
+Value::operator ObjectList() const {
+    ObjectList result;
+    switch (type) {
+        case OBJECT:
+        case STRING:
+            result.push_back(*this);
+            break;
+        case GROUP:
+            std::vector<std::string> vs;
+            ecl::split_copy(std::string(val.str), ',', back_inserter(vs));
+            for (std::vector<std::string>::iterator it = vs.begin(); it != vs.end(); ++it) {
+                if (it->size() > 0) {
+                    if ((*it)[0] == '$') {
+                        result.push_back(Object::getObject(atoi((it->c_str()) + 1)));
+                    } else {
+                        result.push_back(world::GetNamedObject(*it));
+                    }
+                }
+            }
+            break;
+    }
+    return result;
+}
+
+Value::operator ecl::V2() const {
+    switch (type) {
+        case POSITION:
+            return ecl::V2(val.dval[0], val.dval[1]);
+        default:
+            return ecl::V2(0, 0);
+    }
+}
+
+Value::operator GridPos() const {
+    switch (type) {
+        case POSITION:
+            return GridPos(round_down<int>(val.dval[0]), round_down<int>(val.dval[1]));
+        default:
+            return GridPos(0, 0);
+    }
+}
+
 Value::operator const char*() const {
     static std::string s;
     switch (type) {
         case Value::DOUBLE:
-            s = ecl::strf("%g", val.dval);  // need drop of trailing zeros and point for int
+            s = ecl::strf("%g", val.dval[0]);  // need drop of trailing zeros and point for int
             return s.c_str();
         case Value::STRING: 
             return val.str;
@@ -285,12 +375,16 @@
 }
 
 void Value::assign(double d) { 
-    clear(); type=DOUBLE; val.dval=d; 
+    clear(); type=DOUBLE; val.dval[0]=d; 
 }
 
 void Value::clear() {
-    if (type == STRING)
-	delete[] val.str;
+    switch (type) {
+        case STRING:
+        case GROUP:
+    	   delete[] val.str;
+           break;
+    }
     type = NIL;
 }
 
@@ -300,7 +394,7 @@
 
 double Value::get_double() const throw(){
     ASSERT(type == DOUBLE, XLevelRuntime, "get_double: type not double");
-    return val.dval;
+    return val.dval[0];
 }
 
 const char* Value::get_string() const throw() {
@@ -319,7 +413,7 @@
 bool Value::to_bool() const {
     switch (type) {
         case BOOL :
-            return val.dval;
+            return val.dval[0];
         case NIL :
         case DEFAULT :
             return false;
@@ -398,7 +492,6 @@
 }
 
 
-
 
 /* -------------------- Random numbers -------------------- */
 
@@ -423,7 +516,7 @@
     return min + double(rand())/RAND_MAX * (max-min);
 }
 
-
+
 /* -------------------- Time & Date -------------------- */
 
 #define MAX_DATE_LENGTH 256
@@ -443,7 +536,7 @@
     return result;
 }
 
-
+
 /* -------------------- Resource management -------------------- */
 
 namespace

Modified: trunk/src/enigma.hh
===================================================================
--- trunk/src/enigma.hh	2007-10-11 23:48:36 UTC (rev 901)
+++ trunk/src/enigma.hh	2007-10-13 21:41:40 UTC (rev 902)
@@ -32,6 +32,7 @@
 #include "ecl_math.hh"
 #include "ecl_util.hh"
 #include "ecl_cache.hh"
+#include <list>
 
 #define NUMENTRIES(array) (sizeof(array)/sizeof(*array))
 
@@ -127,8 +128,71 @@
     bool has_dir (DirectionBits db, Direction dir);
 
 
+/* -------------------- GridPos -------------------- */
+
+    struct GridPos {
+        // Variables
+        int x, y;
+
+        // Methods
+        explicit GridPos(int xx=0, int yy=0);
+        explicit GridPos(const ecl::V2& p);
+        void move(Direction dir);
+        ecl::V2 center() const;
+    };
+
+    GridPos move(GridPos p, Direction dir);
+    GridPos move(GridPos p, Direction dir, Direction dir2);
+    bool operator== (GridPos a, GridPos b);
+    bool operator != (GridPos a, GridPos b);
+    bool operator< (GridPos a, GridPos b);
+
+    /* 516
+       203
+       748 */
+    GridPos get_neighbour (GridPos p, int i);
+
+    // source and target have to be adjacent
+    Direction direction_fromto(GridPos source, GridPos target); 
+
+    std::ostream& operator<<(std::ostream& os, const GridPos& val);
+
+
+    // ---------- GridLayer ----------
+
+    enum GridLayer {
+        GRID_FLOOR, 
+        GRID_ITEMS, 
+        GRID_STONES, 
+        GRID_COUNT
+    };
+
+    enum GridLayerBits {
+        GRID_FLOOR_BIT  = 1,
+        GRID_ITEMS_BIT  = 2,
+        GRID_STONES_BIT = 4
+    };
+
+    // ---------- GridLoc ----------
+
+    struct GridLoc {
+        // Variables
+        GridPos pos;
+        GridLayer layer;
+
+        // Constructor
+        GridLoc(GridLayer l = GRID_FLOOR, GridPos p = GridPos());
+    };
+
+    /*! Converts strings like "it(10 10)", "st(5 2)" to GridLoc
+      structures. */
+    bool to_gridloc (const char *str, GridLoc &loc);
+
+
 /* -------------------- Value -------------------- */
 
+    typedef std::list<world::Object *> ObjectList;
+
     /**
      * A flexible container for various types of data. This class is one
      * of the central Enigma concepts. It is used for Object attributes,
@@ -147,15 +211,11 @@
      * Value are converted to required types as far as possible and in a
      * LUA compatible manner.
      * 
-     * Due to the history of Enigma and LUA the bool values are not a native
-     * type. The value "false" is coded as type "NIL". Every Value besides
-     * type "NIL" and "DEFAULT" is interpreted as "true". All attributes 
-     * should be declared with a default value of "false". Bool Values can
-     * not be assigned directly to a bool variable. Use the to_bool() method
-     * for retrieving proper bool values.
+     * Bool Values can not be assigned directly to a bool variable. Use the
+     * to_bool() method for retrieving proper bool values.
      * 
      * A special Value type called "DEFAULT" exists within the C++ engine. It
-     * describes a not existing Value. The receiver of this Value should use
+     * describes a not explicitly set Value. The receiver of this Value should use
      * or request the default behaviour. "DEFAULT" Values are the only Values
      * that are converted to bool "false". All other Values convert to bool 
      * "true". Thus a value can be checked for existance by evaluating it as a
@@ -186,9 +246,10 @@
                       ///< for other numericals values like "int", too.
             STRING,   ///< Value is a string. Such a string may encode another
                       ///< type that has no native representation in Value
-            OBJECT,    ///< Value is an object id. The id is a persistent object
+            OBJECT,   ///< Value is an object id. The id is a persistent object
                       ///< identifier.
-            GROUP     ///< Value is a group of objects.
+            GROUP,    ///< Value is a group of objects.
+            POSITION  ///< Value is a position
         };
 
         Value();                       ///< Constructor for NIL value that 
@@ -202,6 +263,10 @@
         Value(bool b);                 ///< Constructor for BOOL value
         Value(Object *obj);            ///< Constructor for OBJECT value that properly
                                        ///< represents a persistent reference to an object
+        Value(ObjectList aList);       ///< Constructor for OBJECT value that properly
+                                       ///< represents a set of objects
+        Value(ecl::V2 pos);            ///< Constructor for POSITION value
+        Value(GridPos gpos);           ///< Constructor for POSITION value
         Value(Type t);                 ///< Constructor for a given type. The
                                        ///< value defaults to 0.0 or ""
         ~Value();
@@ -263,6 +328,21 @@
         operator Object *() const;
         
         /**
+         * Conversion of a value to an object set.
+         */
+        operator ObjectList() const;
+        
+        /**
+         * Conversion of a value to a position vector.
+         */
+        operator ecl::V2() const;
+        
+        /**
+         * Conversion of a value to a grid position.
+         */
+        operator GridPos() const;
+        
+        /**
          * Conversion of a value to a <code>char *</code> just for initialization
          * of a std::string. Numerical values are converted to a string like it
          * id done by LUA. All other values default to an empty string.
@@ -305,7 +385,7 @@
         // Variables
         Type type;
         union {
-            double dval;
+            double dval[2];
             char* str;
         } val;
     };
@@ -327,67 +407,6 @@
         virtual void alarm() {}
     };
 
-/* -------------------- GridPos -------------------- */
-
-    struct GridPos {
-        // Variables
-        int x, y;
-
-        // Methods
-        explicit GridPos(int xx=0, int yy=0);
-        explicit GridPos(const ecl::V2& p);
-        void move(Direction dir);
-        ecl::V2 center() const;
-    };
-
-    GridPos move(GridPos p, Direction dir);
-    GridPos move(GridPos p, Direction dir, Direction dir2);
-    bool operator== (GridPos a, GridPos b);
-    bool operator != (GridPos a, GridPos b);
-    bool operator< (GridPos a, GridPos b);
-
-    /* 516
-       203
-       748 */
-    GridPos get_neighbour (GridPos p, int i);
-
-    // source and target have to be adjacent
-    Direction direction_fromto(GridPos source, GridPos target); 
-
-    std::ostream& operator<<(std::ostream& os, const GridPos& val);
-
-
-    // ---------- GridLayer ----------
-
-    enum GridLayer {
-        GRID_FLOOR, 
-        GRID_ITEMS, 
-        GRID_STONES, 
-        GRID_COUNT
-    };
-
-    enum GridLayerBits {
-        GRID_FLOOR_BIT  = 1,
-        GRID_ITEMS_BIT  = 2,
-        GRID_STONES_BIT = 4
-    };
-
-    // ---------- GridLoc ----------
-
-    struct GridLoc {
-        // Variables
-        GridPos pos;
-        GridLayer layer;
-
-        // Constructor
-        GridLoc(GridLayer l = GRID_FLOOR, GridPos p = GridPos());
-    };
-
-    /*! Converts strings like "it(10 10)", "st(5 2)" to GridLoc
-      structures. */
-    bool to_gridloc (const char *str, GridLoc &loc);
-
-
 /* -------------------- Random Numbers -------------------- */
 
     void   Randomize ();

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2007-10-11 23:48:36 UTC (rev 901)
+++ trunk/src/lua.cc	2007-10-13 21:41:40 UTC (rev 902)
@@ -219,6 +219,106 @@
     }
 }
 
+static std::list<Object *> toObjectList(lua_State *L, int idx) {
+    std::list<Object *> objects;
+    
+    if (is_group(L, idx)) {
+        lua_getmetatable(L, idx);
+        int numObjects = lua_objlen(L, -1);
+        for (int i = 1; i <= numObjects; ++i) {
+            lua_rawgeti(L, -1, i);  // the object
+            objects.push_back(to_object(L, -1));
+            lua_pop(L, 1);          // the object        
+        }
+        lua_pop(L, 1);          // the metatable        
+    }
+    return objects;
+}
+
+static int pushNewGroup(lua_State *L, std::list<Object *> objects) {
+    // NULL objects and duplicates entries in the list will be eliminated
+    int *udata;
+    udata=(int *)lua_newuserdata(L,sizeof(int));   // group user object
+    *udata = 1;
+    
+    lua_newtable(L);  // individual metatable copy
+    luaL_getmetatable(L, LUA_ID_GROUP);
+    // copy metatable template
+    lua_pushnil(L);  // first key
+    while (lua_next(L, -2) != 0) {
+         // key is at index -2 and value at index -1
+         lua_pushvalue(L, -2);   // copy key
+         lua_insert(L, -2);      // insert key copy below value
+         lua_settable(L, -5);    // individual metatable
+    }    
+    lua_pop(L, 1);  // remove metatable template
+
+    std::set<Object *> unique;
+    std::list<Object *>::iterator it = objects.begin();
+    for (int i = 1; it != objects.end(); ++it, ++i) {
+        if (*it) {  // existing object not NULL
+            if (unique.find(*it) == unique.end()) {
+                unique.insert(*it);
+                pushobject(L, *it);
+                lua_rawseti(L, -2, i);
+            }
+        }
+    }
+
+    lua_setmetatable(L, -2);    
+    return 1;
+}
+
+static ecl::V2 toPosition(lua_State *L, int idx) {
+    double x = 0;
+    double y = 0;
+    if (is_position(L, -1)) {  // position
+        lua_getmetatable(L, -1);
+        lua_rawgeti(L, -1, 1);
+        lua_rawgeti(L, -2, 2);
+        x = lua_tonumber(L, -2);
+        y = lua_tonumber(L, -1);
+        lua_pop(L, 3);
+    }
+    return ecl::V2(x, y);
+}
+
+static int pushNewPosition(lua_State *L) {
+    // x at -2, y at -1
+    int *udata;
+    udata=(int *)lua_newuserdata(L,sizeof(int));   // position user object
+    *udata = 1;
+    
+    lua_newtable(L);  // individual metatable copy
+    luaL_getmetatable(L, LUA_ID_POSITION);
+    // copy metatable template
+    lua_pushnil(L);  // first key
+    while (lua_next(L, -2) != 0) {
+         // key is at index -2 and value at index -1
+         lua_pushvalue(L, -2);   // copy key
+         lua_insert(L, -2);      // insert key copy below value
+         lua_settable(L, -5);    // individual metatable
+    }    
+    lua_pop(L, 1);  // remove metatable template
+
+    lua_pushvalue(L, -4);
+    lua_rawseti(L, -2, 1);
+    lua_pushvalue(L, -3);
+    lua_rawseti(L, -2, 2);
+
+    lua_setmetatable(L, -2);    
+    return 1;
+}
+
+static int pushNewPosition(lua_State *L, ecl::V2 pos) {
+    lua_pushnumber(L, pos[0]);   
+    lua_pushnumber(L, pos[1]);
+    pushNewPosition(L); 
+    lua_remove(L, -3);    // pos[0]
+    lua_remove(L, -2);    // pos[1]
+    return 1;
+}
+
 static void push_value(lua_State *L, const Value &val) {
     switch (val.getType()) {
         case Value::NIL:
@@ -244,6 +344,12 @@
         case Value::OBJECT:
             pushobject(L, (Object *)val);
             break;
+        case Value::GROUP:
+            pushNewGroup(L, val);
+            break;
+        case Value::POSITION:
+            pushNewPosition(L, val);
+            break;
     }
 }
 
@@ -260,6 +366,10 @@
         case LUA_TUSERDATA:
             if (is_object(L, idx))
                 return Value(to_object(L, idx));
+            else  if (is_group(L, idx))
+                return Value(toObjectList(L, idx));
+            else  if (is_position(L, idx))
+                return Value(toPosition(L, idx));
         default: 
             throwLuaError(L,"Cannot convert type to Value.");
     }
@@ -687,33 +797,6 @@
 
 /* -------------------- new functions -------------------- */
 
-static int pushNewPosition(lua_State *L) {
-    // x at -2, y at -1
-    int *udata;
-    udata=(int *)lua_newuserdata(L,sizeof(int));   // position user object
-    *udata = 1;
-    
-    lua_newtable(L);  // individual metatable copy
-    luaL_getmetatable(L, LUA_ID_POSITION);
-    // copy metatable template
-    lua_pushnil(L);  // first key
-    while (lua_next(L, -2) != 0) {
-         // key is at index -2 and value at index -1
-         lua_pushvalue(L, -2);   // copy key
-         lua_insert(L, -2);      // insert key copy below value
-         lua_settable(L, -5);    // individual metatable
-    }    
-    lua_pop(L, 1);  // remove metatable template
-
-    lua_pushvalue(L, -4);
-    lua_rawseti(L, -2, 1);
-    lua_pushvalue(L, -3);
-    lua_rawseti(L, -2, 2);
-
-    lua_setmetatable(L, -2);    
-    return 1;
-}
-
 static int newPosition(lua_State *L) {
     // (pos|obj|table|(num,num))
     if (is_table(L, 1)) {  // table 
@@ -1132,40 +1215,7 @@
     return groupMessage(L);
 }
 
-static int pushNewGroup(lua_State *L, std::list<Object *> objects) {
-    // NULL objects and duplicates entries in the list will be eliminated
-    int *udata;
-    udata=(int *)lua_newuserdata(L,sizeof(int));   // group user object
-    *udata = 1;
-    
-    lua_newtable(L);  // individual metatable copy
-    luaL_getmetatable(L, LUA_ID_GROUP);
-    // copy metatable template
-    lua_pushnil(L);  // first key
-    while (lua_next(L, -2) != 0) {
-         // key is at index -2 and value at index -1
-         lua_pushvalue(L, -2);   // copy key
-         lua_insert(L, -2);      // insert key copy below value
-         lua_settable(L, -5);    // individual metatable
-    }    
-    lua_pop(L, 1);  // remove metatable template
 
-    std::set<Object *> unique;
-    std::list<Object *>::iterator it = objects.begin();
-    for (int i = 1; it != objects.end(); ++it, ++i) {
-        if (*it) {  // existing object not NULL
-            if (unique.find(*it) == unique.end()) {
-                unique.insert(*it);
-                pushobject(L, *it);
-                lua_rawseti(L, -2, i);
-            }
-        }
-    }
-
-    lua_setmetatable(L, -2);    
-    return 1;
-}
-
 static int newGroup(lua_State *L) {
     // (table | (obj[,obj]))
     std::list<Object *> objects;



From ral at mail.berlios.de  Sun Oct 14 11:59:22 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 14 Oct 2007 11:59:22 +0200
Subject: [Enigma-game-svn] r903 - homepage/input
Message-ID: <200710140959.l9E9xMsv017974@sheep.berlios.de>

Author: ral
Date: 2007-10-14 11:59:21 +0200 (Sun, 14 Oct 2007)
New Revision: 903

Modified:
   homepage/input/credits.html
   homepage/input/credits_de.html
   homepage/input/download.html
   homepage/input/download_de.html
   homepage/input/download_ru.html
   homepage/input/output-files.lua
Log:
Homepage:
- Slackware announcement, download, credit


Modified: homepage/input/credits.html
===================================================================
--- homepage/input/credits.html	2007-10-13 21:41:40 UTC (rev 902)
+++ homepage/input/credits.html	2007-10-14 09:59:21 UTC (rev 903)
@@ -152,6 +152,6 @@
         <li>Michael Terry&nbsp;&nbsp;&nbsp;(.desktop file)</li>
         <li>Ray Wick&nbsp;&nbsp;&nbsp;(Level design)</li>
         <li>Joe Wreschnig&nbsp;&nbsp;&nbsp;(Manual page)</li>
-        <li>Yuriy Zhyromskiy&nbsp;&nbsp;&nbsp;(Russian Manual and Homepage Translation)</li>
+        <li>Yuriy Zhyromskiy&nbsp;&nbsp;&nbsp;(Russian Manual and Homepage Translation, Slackware Package)</li>
     </ul>
 </div>

Modified: homepage/input/credits_de.html
===================================================================
--- homepage/input/credits_de.html	2007-10-13 21:41:40 UTC (rev 902)
+++ homepage/input/credits_de.html	2007-10-14 09:59:21 UTC (rev 903)
@@ -153,6 +153,6 @@
         <li>Michael Terry&nbsp;&nbsp;&nbsp;(.desktop file)</li>
         <li>Ray Wick&nbsp;&nbsp;&nbsp;(Landschaftsdesign)</li>
         <li>Joe Wreschnig&nbsp;&nbsp;&nbsp;(Manual page f&uuml;r Unix)
-        <li>Yuriy Zhyromskiy&nbsp;&nbsp;&nbsp;(Russisches Handbuch und Homepage)</li>
+        <li>Yuriy Zhyromskiy&nbsp;&nbsp;&nbsp;(Russisches Handbuch und Homepage, Slackware Paket)</li>
     </ul>
 </div>

Modified: homepage/input/download.html
===================================================================
--- homepage/input/download.html	2007-10-13 21:41:40 UTC (rev 902)
+++ homepage/input/download.html	2007-10-14 09:59:21 UTC (rev 903)
@@ -53,6 +53,13 @@
     <li>sha256 - e2822599dfc8e0a888d729f5ad2ce7cdbf2e1e87bca508c8da76c48fbb0023ab</li>
     </ul></li>
 
+  <li><ul style="list-style-type:none"><li><b>Slackware 10++</b>
+    <a href="http://download.berlios.de/enigma-game/enigma-1.01-i686-slw1.tgz">
+	Package tgz (1.01)</a> appr. 10 MB</li>
+    <li>md5 - fb1591cb075d380304b4f91c27d95c89</li>
+    <li>sha256 - 65d31f3e4a78db7850dd1016ad1eee66794fdec985c3470619e1468bbba25f45</li>
+    </ul></li>
+
   <li><ul style="list-style-type:none"><li><b>Source Code 32/64-bit compatible</b>
     <a href="http://download.berlios.de/enigma-game/enigma-1.01-64bit.tar.gz">
 	tar.gz (1.01)</a> appr. 10 MB</li>

Modified: homepage/input/download_de.html
===================================================================
--- homepage/input/download_de.html	2007-10-13 21:41:40 UTC (rev 902)
+++ homepage/input/download_de.html	2007-10-14 09:59:21 UTC (rev 903)
@@ -59,6 +59,13 @@
     <li>sha256 - e2822599dfc8e0a888d729f5ad2ce7cdbf2e1e87bca508c8da76c48fbb0023ab</li>
     </ul></li>
 
+  <li><ul style="list-style-type:none"><li><b>Slackware 10++</b>
+    <a href="http://download.berlios.de/enigma-game/enigma-1.01-i686-slw1.tgz">
+	Paket tgz (1.01)</a> appr. 10 MB</li>
+    <li>md5 - fb1591cb075d380304b4f91c27d95c89</li>
+    <li>sha256 - 65d31f3e4a78db7850dd1016ad1eee66794fdec985c3470619e1468bbba25f45</li>
+    </ul></li>
+
   <li><ul style="list-style-type:none"><li><b>Quellcode 32/64-Bit kompatibel</b>
     <a href="http://download.berlios.de/enigma-game/enigma-1.01-64bit.tar.gz">
 	tar.gz (1.01)</a> etwa 10 MB</li>

Modified: homepage/input/download_ru.html
===================================================================
--- homepage/input/download_ru.html	2007-10-13 21:41:40 UTC (rev 902)
+++ homepage/input/download_ru.html	2007-10-14 09:59:21 UTC (rev 903)
@@ -52,6 +52,13 @@
     <li>sha256 - e2822599dfc8e0a888d729f5ad2ce7cdbf2e1e87bca508c8da76c48fbb0023ab</li>
     </ul></li>
 
+  <li><ul style="list-style-type:none"><li><b>Slackware 10++</b>
+    <a href="http://download.berlios.de/enigma-game/enigma-1.01-i686-slw1.tgz">
+	Package tgz (1.01)</a> ?????. 10 MB</li>
+    <li>md5 - fb1591cb075d380304b4f91c27d95c89</li>
+    <li>sha256 - 65d31f3e4a78db7850dd1016ad1eee66794fdec985c3470619e1468bbba25f45</li>
+    </ul></li>
+
   <li><ul style="list-style-type:none"><li><b>???????? ???? 32/64-bit compatible</b>
     <a href="http://download.berlios.de/enigma-game/enigma-1.01-64bit.tar.gz">
 	tar.gz (1.01)</a> ?????. 10 MB</li>

Modified: homepage/input/output-files.lua
===================================================================
--- homepage/input/output-files.lua	2007-10-13 21:41:40 UTC (rev 902)
+++ homepage/input/output-files.lua	2007-10-14 09:59:21 UTC (rev 903)
@@ -10,7 +10,7 @@
 
 -- The newsfield declares the news (by number) to be shown on the main page.
 
-newsfield = {19, 20, 21, 22, 23}
+newsfield = {19, 20, 21, 22, 23, 24}
 
 -- General $$mystring$$-macros. Strings are taken as-is, tables are
 -- constellations of html input files, functions are executed, with the



From ral at mail.berlios.de  Sun Oct 14 12:43:29 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Sun, 14 Oct 2007 12:43:29 +0200
Subject: [Enigma-game-svn] r904 - homepage/input/news
Message-ID: <200710141043.l9EAhTwZ017460@sheep.berlios.de>

Author: ral
Date: 2007-10-14 12:43:28 +0200 (Sun, 14 Oct 2007)
New Revision: 904

Added:
   homepage/input/news/news_issue24_de.html
   homepage/input/news/news_issue24_en.html
Log:
Homepage:
- fix add missing news24 Slackware announcement files

Added: homepage/input/news/news_issue24_de.html
===================================================================
--- homepage/input/news/news_issue24_de.html	2007-10-14 09:59:21 UTC (rev 903)
+++ homepage/input/news/news_issue24_de.html	2007-10-14 10:43:28 UTC (rev 904)
@@ -0,0 +1,7 @@
+<h3 class="news">
+    <span class="date">Okt 14 2007: </span> Enigma 1.01 f&uuml;r Slackware
+    Linux
+</h3>
+
+<p>Ein Installationspaket f?r Slackware ist verf&uuml;gbar auf unserer <a
+href="$$download$$#stable">Downloadseite</a>.</p>


Property changes on: homepage/input/news/news_issue24_de.html
___________________________________________________________________
Name: svn:eol-style
   + native

Added: homepage/input/news/news_issue24_en.html
===================================================================
--- homepage/input/news/news_issue24_en.html	2007-10-14 09:59:21 UTC (rev 903)
+++ homepage/input/news/news_issue24_en.html	2007-10-14 10:43:28 UTC (rev 904)
@@ -0,0 +1,6 @@
+<h3 class="news">
+    <span class="date">Oct 14 2007: </span> Enigma 1.01 for Slackware Linux
+</h3>
+
+<p>A Slackware package is available from our <a href="$$download$$#stable">
+download section</a>.</p>


Property changes on: homepage/input/news/news_issue24_en.html
___________________________________________________________________
Name: svn:eol-style
   + native



From ged at mail.berlios.de  Sun Oct 14 12:46:09 2007
From: ged at mail.berlios.de (ged at mail.berlios.de)
Date: Sun, 14 Oct 2007 12:46:09 +0200
Subject: [Enigma-game-svn] r905 - in homepage/input: . lotm news
Message-ID: <200710141046.l9EAk9EG020032@sheep.berlios.de>

Author: ged
Date: 2007-10-14 12:45:51 +0200 (Sun, 14 Oct 2007)
New Revision: 905

Modified:
   homepage/input/credits_ru.html
   homepage/input/development_ru.html
   homepage/input/download_ru.html
   homepage/input/faq_core_ru.html
   homepage/input/faq_questions_ru.html
   homepage/input/infobox_ru.html
   homepage/input/lotm/lotm_200710_ru.html
   homepage/input/menu_ru.html
   homepage/input/news/news_issue15_ru.html
   homepage/input/news/news_issue16_ru.html
   homepage/input/news/news_issue19_ru.html
   homepage/input/news/news_issue1_ru.html
   homepage/input/news/news_issue21_ru.html
   homepage/input/news/news_issue23_ru.html
   homepage/input/news/news_issue6_ru.html
   homepage/input/news/news_issue8_ru.html
   homepage/input/press_ru.html
   homepage/input/stat-help_ru.html
   homepage/input/support_ru.html
   homepage/input/testimonials_ru.html
Log:
Homepage: updeted Russian translation

Modified: homepage/input/credits_ru.html
===================================================================
--- homepage/input/credits_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/credits_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -148,7 +148,7 @@
         <li>Tacvek&nbsp;&nbsp;&nbsp;(?????????? Lua 5.1)</li>
         <li>Michael Terry&nbsp;&nbsp;&nbsp;(???? .desktop)</li>
         <li>Ray Wick&nbsp;&nbsp;&nbsp;(?????? ???????)</li>
-        <li>Joe Wreschnig&nbsp;&nbsp;&nbsp;(Manual page)</li>
-        <li>Yuriy Zhyromskiy&nbsp;&nbsp;&nbsp;(??????? ??????? ???????????)</li>
+        <li>Joe Wreschnig&nbsp;&nbsp;&nbsp;(???????? ???????????)</li>
+        <li>Yuriy Zhyromskiy&nbsp;&nbsp;&nbsp;(??????? ??????? ??????????? ? ???????? ????????, ????? ??? Slackware)</li>
     </ul>
 </div>

Modified: homepage/input/development_ru.html
===================================================================
--- homepage/input/development_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/development_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -5,10 +5,10 @@
 ?? ?????? ??.</p>
 
 <ul>
-  <li><a href="$$development$$#maillist">?????? ???????? ?????????????</a> - ??????? ???????.</li>
-  <li><a href="$$development$$#tasks">??????? ?????? ? ?????????</a> - ???????????? ???? ?????????.</li>
-  <li><a href="$$development$$#level">?????????? ???????</a> - ???????? ? ??????.</li>
-  <li><a href="$$development$$#app">?????????? ?????????</a> - ???????? ? ??????.</li>
+  <li><a href="$$development$$#maillist">?????? ???????? ?????????????</a> - ???????????</li>
+  <li><a href="$$development$$#tasks">??????? ?????? ? ?????????</a> - ???????????? ????? ?????????</li>
+  <li><a href="$$development$$#level">?????????? ???????</a> - ???????? ? ??????</li>
+  <li><a href="$$development$$#app">?????????? ?????????</a> - ???????? ? ??????</li>
 </ul>
 
 <h3><a class="arrowup" href="$$development$$"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
@@ -20,7 +20,7 @@
   ????????? ???????????, ?????????? ???? ?????, ????????? ??????? ? ?????? ??? ??????????
   ???? ??????.</p>
 
-  <p>?????????? ????????, ??? ??? ??? ?????? ????????????? ????????????????, ?? ??? ????????? ? ????????
+  <p>?????????? ?????? ? ????, ??? ??? ??? ?????? ????????????? ????????????????, ?? ??? ????????? ? ????????
   ?????? ???? ???????? ?? ?????????? ?????. ???? ??? ????? ?????????? ????? ? ??????
   ?????????, ??? ?? ?????? ?? ????????? ????????? ??????????? ???????? ??? ???????? ? 300 ??.
   ?????????, ?????? ??????? ?????? ?? ????? ???????!</p>
@@ -44,7 +44,7 @@
       <div class="diff">??????</div></li>
 
   <li><b>????????? ???????</b>. ??? ?? ?????? ????????, ? ????????? ????? ?? ?????????? ????????? ? ??????? ??????????.
-      ???? ? ??? ?????? ?????? ??????, ?? ????? ??????????? ???? ???????? ???? ???????, ???????? ? ??????
+      ???? ?? ????? ??????????, ?? ????? ??????????? ???? ???????? ???? ???????, ???????? ? ??????
       ??????????? ?? ????? ???????????????.
       <div class="diff">??????</div></li>
 
@@ -62,7 +62,7 @@
       <div class="diff">??????-??????</div></li>
 
   <li><b>???????????? ?? ???????? ????????</b>. ?? ???????? ???????? ? Enigma
-      ??? ????? ??????????, ??????? ?????? ????????. ?? ?? ????? ??????????????, ??? Enigma ??????
+      ??? ????? ?????? ??????????. ?? ?? ????? ??????????????, ??? Enigma ??????
       ?????? ???????????????? ??? ???????????. ??????, ???????????? ????????
       ?????? ?????? ??? ?????????? ? ??????????? - ? ?? ? ???? ?????
       ?????? ?????? ??????? ?? ?????, ??????????? ? ?????????? ????????????.
@@ -126,7 +126,7 @@
 
   <p><a href="$$refman$$">?????????? ???????????</a> Enigma ???????? ????????? ?????? ???????
   ? ???? ????????, ??????? ?? ?????? ????????????. ??? ????? ???? ?? ??????????? ??????? ??
-  ?????? 1 - 3 ? ???????, ??? ?? ?????? ?????? ????????? ???????? ??????? ???????.<p>
+  ?????? 1 - 3 ? ???????, ??? ?? ?????? ?????? ????????? ???????? ??????? ???????.<p>
 
   <p>??? ????? ????????????? ? ? ???????? ????????????? ??????? ? ??????????? ???????, ?? 
   ?????? ????????? ?? <a href="$$wiki$$">wiki ? ?????????? ???????</a>. ?? ????????????? ???????? ?? 

Modified: homepage/input/download_ru.html
===================================================================
--- homepage/input/download_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/download_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -54,12 +54,12 @@
 
   <li><ul style="list-style-type:none"><li><b>Slackware 10++</b>
     <a href="http://download.berlios.de/enigma-game/enigma-1.01-i686-slw1.tgz">
-	Package tgz (1.01)</a> ?????. 10 MB</li>
+	????? tgz (1.01)</a> ?????. 10 MB</li>
     <li>md5 - fb1591cb075d380304b4f91c27d95c89</li>
     <li>sha256 - 65d31f3e4a78db7850dd1016ad1eee66794fdec985c3470619e1468bbba25f45</li>
     </ul></li>
 
-  <li><ul style="list-style-type:none"><li><b>???????? ???? 32/64-bit compatible</b>
+  <li><ul style="list-style-type:none"><li><b>???????? ????, ??????????? ? 32/64-bit</b>
     <a href="http://download.berlios.de/enigma-game/enigma-1.01-64bit.tar.gz">
 	tar.gz (1.01)</a> ?????. 10 MB</li>
     <li>md5 - d58af8a7201601dabc45dcedae5e2e91</li>

Modified: homepage/input/faq_core_ru.html
===================================================================
--- homepage/input/faq_core_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/faq_core_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -19,7 +19,7 @@
 
 <h4><a name="s1q1">????? ? ??????? ??????? Enigma, ?????? ????? ??????? ? ??????? ????????,
 ?????? ?? ???????? ??? ????????? ????????.</a></h4>
-<p>??????? ?? ?????? ???????? ??????? ??????? -- ??-?? ???????????, ?????????? ?????? ???
+<p>??????? ?? ?????? ???????? ??????? ??????? - ??-?? ???????????, ?????????? ?????? ???
 ?????? ???????? ??????????????. ?? ????????????? ?? ????? ??? ? ???? ??????, ??? ???
 ??? ??????? ??? ?? ???????????. ?????????? ?????????? ??????? ? ?????? ?? ?????? (????????
 &quot;download&quot; ? ?????? ?????? ?? &quot;download2&quot;) ??? ????????? ??????? ??????.</p>
@@ -84,7 +84,7 @@
 
 
 <h4><a name="s1q7">??? ? ???? ??????? ?? ??????? Sokoban ????? ?????????</a></h4>
-<p>?? ???????? ??? ????. ???? ??? ?? ?????? ???? ??????? ??????? Enigma leveln. 
+<p>?? ???????? ??? ????. ???? ??? ?? ?????? ???? ??????? ??????? Enigma. 
 ??? ????? ?? ?????? ??????????????? ??????????? ralf_sokoban,
 ??????? ? ?????? ??????? ? ????????????? 
 &quot;data/levels/enigma_sokoban&quot; ? ??????????, ???? ?? ?????????? ????.</p>
@@ -105,7 +105,7 @@
 
 <h4><a name="s2q2">Enigma ?? ???????????, ??? ?????? ????????? ?????????
     &quot;mismatch of state.xml and enigma.score&quot;.</a></h4>
-<p>?????????? ???????? ??? ????? ???? ?????? (???????? ???? &quot; ??? ????????? ????? enigma.score ? state.xml?&quot;).
+<p>?????????? ???????? ??? ????? ???? ?????? (???????? ???? &quot;??? ????????? ????? enigma.score ? state.xml?&quot;).
 ???? ?? ?????????? ????? ?????? ?????? 
 Enigma, ?????????? ?????????? ???? 
 &quot;enigmarc.lua2&quot; ?? ??? ?? ??????????. ????? ?? ?????? ?????????? ????????.
@@ -147,7 +147,7 @@
 <p>?????? ?????????? - ??? ?????????, ??????? ?????????????? ???? ? ???? ??? ??????????. ????? ?????????
 ????? ??????????????, ??? ????????? ??????????? ??????????? ??? ????? ?????????? ? ???. ??????, ???
 ?????? ?????? ????, Enigma ????? ?????????????? ???? ? ???? ? ??????????:
-?????????????? ??????? ?????? ???? ??????????, ?? ????? ???? ?????????? ???? ????????, ??????, ? ?? ?????? ??????????.
+?????????????? ??????? ?????? ???? ??????????, ?? ????? ???? ?????????? ???? ????????, ? ?? ?????? ??????????.
 ??? ?????? ?????????? ?????????. ???? ?? ??????? Enigma ? ????? ???????? ????????,
 ?? ?????? ????????? Enigma ? ?????????? ???? Kaspersky. ???? ?? ?????? ????????? ? ??????????? 
 Enigma, ?????????????? ???????????? ??????? ? <a
@@ -202,19 +202,19 @@
 </ul>
 <p>
 ??? ?????? ?????? ???????? ?????. ?????????? ?????? ????????, ??? 
-?????????? ????? &quot;???????&quot; ??? &quot;?????????&quot;. ?????? ???????
-??? ????? ?? ???????, ? ??? ??????? ??????? ????? ????? ?????.
+?????????? ????? &quot;???????&quot; ??? &quot;?????????&quot;. ?????? ???????,
+??? ????? ?? ???????, ? ??? ??????????? ?? ???????? ????? ????? ?????.
 ???? ?? ????? ?????????? &quot;??????? ??????&quot; (????????, ????????? etc.; ? ?? ??????????? ???????),
 ?????????? ????????? Enigma ?? ??????? ? ??????? ???????
 &quot;enigma --log&quot;
 ? ??????????? ????????????? ??????. ? ?????????? ????????? ?????? ????????? ??? ????? 
 stdout.txt ? stderr.txt,
 ??????????? ???????? ??? ??? ???????????. ?????????? ?????????? ??
-? ?????? ?????? ???. (????? ?????????? <a href="$$support$$#bug">?????</a>.)</p>
+? ?????? ?????? ???. (????? ?????????? <a href="$$support$$#bug">?????</a>).</p>
 
 
 <h4><a name="s2q7">? ??????? ? ?????? ????????, ?? ??? ?? ???????? :-(</a></h4>
-<p>????????, ??? ?????????? ???????? ?????. ?? ?????? ??? ??? ?? ????????? ???? ??????;
+<p>????????, ??? ?????????? ???????? ?????. ?? ??????, ??? ??? ?? ????????? ???? ??????;
 ?? ?????? ??????, ? ?????? ?? ???? ?? ??? 
 ?? ????? ???????? ? ????, ???? ??????? ??????. 
 ???????, ?????????? ???????? ??? ?????? ??? ? ???????? ?????.
@@ -241,7 +241,7 @@
     ???????? ??????.</a></h4>
 <p>????? ?? ? ?????? ??? ????????? Enigma, ?? ?????? ?????? ? 
 &quot;?????? ??????? Tutorial&quot;, ??????? ????????????? ????? ???????? ???????? 
-??? ????????. ???? ?? ???????????? ???? ?????????? ??????????????, ?? ??????
+??? ????????. ???? ?? ???????????? ???? ?????????? ??????????????, ?? ??????
 ??????? ? &quot;?????????&quot; ??????? ???????: ??????? ?? ?????? ? ????????
 &quot;????? ???????&quot;, ????? &quot;Enigma&quot; ????? ? 
 ???? ?? ??????? ?? &quot;Enigma I&quot; ?? &quot;Enigma VII&quot;.
@@ -274,7 +274,7 @@
 ?????????? ?? ??????. ??? ???????? ? ???????????, ????????? ???????
 ??? ??????????.
 </p><p>
-???? ??? ????? ????????? ?????????? ?? ???????, ??? ???????? ???? ?? ??????
+???? ??? ????? ????????? ?????????? ?? ???????, ???, ????????, ???? ?? ??????
 ???????? ???????, ?????????? ? <a href="$$refman$$">?????????? ???????????</a>. 
 ??????, ??? ????? ??? ????? ????? ??? ???????.
 </p><p>
@@ -294,7 +294,7 @@
 <h4><a name="s3q6">? ?? ???? ?????? ?? ???? ??????? ? ???????????/???????????/???????/&#8230;.</a></h4>
 <p>??? ?????? ?????? ?? ???????, ??????? ??? ?? ????????.
 ? ?????????, ?????? ?? ?????????? ???? ?? ????????? ??? 
-??????; p???? ??? ??????? ??????? ??? ????-?? ?????????, ???? ?? ?????? ???????? ?? 
+??????; ????? ??? ??????? ??????? ??? ????-?? ?????????, ???? ?? ?????? ???????? ?? 
 ????? ??? ??????.
 </p><p>
 ?? ?????? ?? ???, ????????? ???? ???????????? ????????? ??????.
@@ -351,10 +351,10 @@
 <p>??. ??? ??????????, ??????? ???????????? ? ???????? ?????? 1.00 ?? ????? 
 ??????????? ? ??????????. ?? ?????? ???????? ????????? ??????? ??????????? ?? ?????? ??????
 ? ???? ???????. ???? ?? ????? ?????? ???? ??????? ? ??????
-1.00 ??? ????? ????????? ????? ? ????????? ??? ?????.</p>
+1.00 ??? ????? ????????? ? ????????? ??? ????? ?????.</p>
 
 
-<h4><a name="s3q12">????????? ?? ??????? ???????? ??????? ???????????? -- ??? ?? ??????????????</a></h4>
+<h4><a name="s3q12">????????? ?? ??????? ???????? ??????? ???????????? - ??? ?? ??????????????</a></h4>
 <p>????? ???? ????????? ??????? ?? ???????, ?? ???????????????? ????????.
 ? ????????? ??????? ?????????????? ???????. ?? ? ??? ??? ????????, ??? ???-??
 ????????? ??????????. ????????? ?? ????? ?????????????
@@ -397,7 +397,7 @@
 (??????? ?????? ???????, ???????????, ???????? ???????? ? ???? FAQ!), ????? ??????? ????????.</li>
 
 <li>?? ?????? ??????????? ?? ?????? ???????? ??? ????????????? ? ???????? ?????????????
-? ??????? ???????? ????????, ???????? ? ?????????? Enigma.</li>
+? ??????? ???????? ????????, ???????? ? ?????????? Enigma.</li>
 
 <li>?? ????? ??????: ???? ?? ?????? ???????????????, ?????? ???????
 ??? ???????? ????? ? ?????? ????????? ??????? ??????? 
@@ -420,7 +420,7 @@
 ?????? ???? ?????????. ?? <a href="$$wiki$$" >$$wiki$$</a> ?? ????? ?????? ????? Enigma Wiki.
 </p><p>
 ???? ??? ??? ??????? ?????? ??????? ???? ???????, ??????????????? ?????
-?? mag-heut.net -- ??? ????? ?????????? ???? ???? ? 
+?? mag-heut.net - ??? ????? ?????????? ???? ???? ? 
 ????????? ???????!</p>
 
 
@@ -469,7 +469,7 @@
 
 
 <h4><a name="s4q8">??? ? ???? ????????????? ??? ?????? ?????? ?? ?????? 0.92/0.81/&#8230; ? 1.00?</a></h4>
-<p>??? ?? ????? ??????? ???????????. ???? ?? ??????????? ??????? ????????? ?? lua, ??? ??????????? ?????
+<p>??? ?? ????? ??????? ???????????. ???? ?? ??????????? ??????? ????????? ?? lua, ??? ??????????? ?????,
 ??? ???? ?? ?????????? ???????????? xml ?????? ??????.
 </p><p>
 ?????? ?????, ??? ????? ??????????? lua ? ?????? 1.00-xml.
@@ -496,16 +496,16 @@
 
 <h4><a name="s4q9">? ???? ???? ????? ?? ?????? ????? ???????? Enigma.</a></h4>
 <p>?? ?????? ????? ????? ???? ? ??? ?????. ? Enigma ?????? ???????? ????????? 
-????????. ?????? ????? ?????? ????????????? ????????? ?????????, ????? ???? ???????? ?????? 
+????????. ?????? ????? ?????? ????????????? ????????? ?????????, ????? ???????? ?????? 
 ????????? ??????????.</p>
 <ul>
-<li>?? ?????? ????????? ????? ???????, ??????? ??? ?? ??????? ??????? ?????????.</li>
-<li>?? ?????? ?????? ????????? ? ??????????? ?? ???????? ????????? ????? ???????.</li>
-<li>?? ?????? ???? ????? ????????? ? ????? ????????? ?? ???? ????????? ???????????? ????????.</li>
+<li>?? ?????? ????????? ????? ???????, ??????? ??? ?? ??????? ??????? ?????????</li>
+<li>?? ?????? ?????? ??????????? ? ??????????? ?? ???????? ????????? ????? ???????</li>
+<li>?? ?????? ???? ????? ????????? ? ????? ????????? ?? ???? ????????? ???????????? ????????</li>
 </ul>
 <p>
-??????? ??? ????? ???????????, ??? ?? C++ ? ?????????????? ?????. ??? ?????? ?? ??????? 
-??????????, ?? ???????? ???? ??? ??????? ?? ?????? ? ??????? ???? ???????????.</p>
+??????? ??? ????? ???????????, ??? ?? C++ ?, ????????, ?????? ?????. ??? ?????? ?? ??????? 
+?????????? ?? ???????? ????, ??? ??????? ?? ?????? ? ??????? ???? ???????????.</p>
 
 <h3><a class="arrowup" href="$$faq$$#faq_core"><img src="$$imagedir$$/nav_up.gif" alt="Up" border="0" title="back to top"></a>
 <a name="section5">????????? ????? ? ????????</a>
@@ -520,7 +520,7 @@
     ?????? ?????????
 </a></h4>
 <p>?? ?????? ?????? ??????????? ???????? <a href="$$gpl$$">GPL</a>, ??????? ????????? ???
-???? ????????? Enigma ??? ???????????? ????????. ?? ???????? ???? ???????? ???????? ?? ?? ????? ???? ????-???? ?????? ???????.
+???? ????????? Enigma ??? ???????????? ????????. ?? ????????? ???? ???????? ???????? ?? ?? ????? ???? ????-???? ?????? ???????.
 ?????????? ???????? ????? ???????, ?????????? ?? GPL
 ? ?????? ????????????. ???? ?? ?? ??????? ? GPL
 <a href="http://en.wikipedia.org/wiki/GNU_General_Public_License">Wikipedia</a>
@@ -528,7 +528,7 @@
 
 <p>?? ?????????????? ? ??????????????? Enigma. ?????????? ????? ??? ????? 
 ? ?? ???? ????????? ?????? ?? ???? ????????. ???? ?? ??????????????? Enigma ??? ?????? 
-?????? ?? Enigma ? ???????? ???????? ?? ????? ???? ?????????(????????) ????????
+?????? ?? Enigma ? ???????? ???????? ?? ????? ???? ?????????(????????) ????????
 ????????? ?????.</p>
 
 
@@ -539,7 +539,7 @@
 
 <h4><a name="s6q4">?????? ?????? Enigma ??????????? ? ????? ?????? ???????
     ??? ??????????? ?? Berlios, ??? ?? nongnu, ??? ?? enigma-game.org ? ?.?.?</a></h4>
-<p>????? Enigma ???????? ????????? ?????? 
+<p>????? Enigma ???????? ????????? ?????? 
 <a href="http://savannah.nongnu.org">Savannah (nongnu.org)</a>
 ???????? ??????????. ????? ??? ? ?????????? ????????????? ????? ?????????? ???????????
 ????????? ???? ????????? <a href="http://www.gnu.org/software/gnu-arch/">Arch</a>
@@ -590,5 +590,5 @@
 </p><p>
 ??????, Enigma ? ??? ??? ?????????. ??? ??????? ???? ?? ?????? ?????? ??? 
 ? ????????? ?? ? ??????????? ???????, ????????? &quot;Enigris&quot;.
-? ??? ??? ??? ??????????? ????? ????? ???????? ? ?????? ????; ? ??? ?????????? ???? &#8230;</p>
+? ??? ??? ??? ??????????? ????? ????? ???????? ? ??????? ????; ? ??? ?????????? ???? &#8230;</p>
 </div>

Modified: homepage/input/faq_questions_ru.html
===================================================================
--- homepage/input/faq_questions_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/faq_questions_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -103,7 +103,7 @@
     ????? ?? ???????? ??????????, ??????? ???? ???????? ? ?????? 0.92?</a></li>
 
     <li><a href="$$faq$$#s3q12">
-    ????????? ?? ??????? ???????? ??????? ???????????? -- ??? ?? ??????????????</a></li>
+    ????????? ?? ??????? ???????? ??????? ???????????? - ??? ?? ??????????????</a></li>
 
     <li><a href="$$faq$$#s3q13">
     ? ???????? ??????? ?????? ??? ??????. ????? ???????????? Enigma ?? ?????!</a></li>

Modified: homepage/input/infobox_ru.html
===================================================================
--- homepage/input/infobox_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/infobox_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -12,7 +12,7 @@
          <h3>???????????? PAR ? Hcp</h3>
 	 ?? ????????? ????????? ????? ??????????? ???????????, ?? ??????
 	 ????? ?????????? ???????? PAR ??????????????? ?? ?????????? ?????. ???????
-	 ?????????????, ??????? ?? ?????? ???????, ?????? ??????? ????????? ?? 
+	 ?????????????, ??????? ?? ?????? ???????, ?????? ?????? ??????? ?? 
 	 ?????????. ????? ???????, ???????? PAR ?????? ????? ????? ?????????????. 
 	 ??? ???????? ??????, ???????? HCP ?????????? ?? ????????? ???????? ??? 
 	 ??????????? ?????????????, ? ??? ?? ?????? ????????? ?? ????????

Modified: homepage/input/lotm/lotm_200710_ru.html
===================================================================
--- homepage/input/lotm/lotm_200710_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/lotm/lotm_200710_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -12,11 +12,11 @@
 
 <p>? ??????? ???? ??????????? ????????? ?? ??, ?? ????????????? ?????? Enigma, ???????? ??? ?
 Quadropolis. ???? ???? ????? ????? ???????? ????????? ??? ?? ????? ????? ????? ? ??????????? ???????,
-? ?????? ??????????? ???????????, ? ??????? ??????.
-?? ?? ????? ?? ???????? ??????? ????????? ????? '??????' ??? '???????',
+?? ?????? ??????????? ???????????, ? ??????? ??????.
+?? ?? ????? ?? ???????? ??????? ????????? ????? '??????' ??? '???????',
 ? ????? ??????? ?????, ??? ??????, ???????, ??????? ? ??????, ????????? ?????? ?????????.
-? ??????? ??????? ???? ? ?? ?????????? ???????????, ????????????
-?????????? ?????????? ? ???????????? ??????? ???????? ????, ?????.</p>
+?, ???????, ??????? ???? ? ?? ?????????? ??????????? - ????????????
+?????????? ?????????? ? ???????????? ???????? ???????? ???? - ???? ?????.</p>
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200710_a.png" alt="Level of the month" border="0">
@@ -25,11 +25,11 @@
 
 <h4>?? ???????: ??????? ???????? ?????? ? ??????????</h4>
 
-<p>Quadropolis ? ??????? ????????? ??????????? ??????? ?? 5 ??????? ? ????? ?? ?????? ?????
+<p>Quadropolis ? ??????? ????????? ??????????? ??????? ? 5 ??????? ? ????? ?? ?????? ?????
 ? ??????? 9.40. ??? ????? ??????? ?????? ??????, ???????? ??.</p>
 
 <p>??? ?????? ?????? ????? ? ????????? ?? ??????? ???? &quot;Island Labyrinth&quot;
-? &quot;The Aztec Temple&quot; ????? ???????. ?? ??????? ???? ? ???? ?????? ??? ???????? ???? ????? ??
+? &quot;The Aztec Temple&quot; ????? ???????. ?? ??????? ????, ? ???? ?????? ??? ???????? ???? ????? ??
 ?? ? ????????? ? ??????? ??????????. &quot;Island Labyrinth&quot;
 ???????????? ?? ????? ????? ????????? 9.24 ????? ? 8 ??????? ????? ????? &quot;The Aztec Temple&quot;,
 ?????? ??????? ????? ??????, ??????? ??????? 9.13 ????? ? 7 ???????. ??
@@ -57,66 +57,66 @@
 
 <p>??????, ??? ????? ?? ????? &quot;??????? ????&quot; ?????????? ?????????,
 ???????? ???? ??????, ??? ??? ??? ????????? ???? ?????? ?????. ?
-?? ???? ?? ????????, ?? ????? ??? ???????? ?????? ??????? ??????,
+?? ???? ?????????? ?? ?????, ?? ????? ??? ???????? ?????? ??????? ??????,
 ??????????? ?? ??????.</p>
 
-<p>???? ??? ??? ????? ?????????? ??????????! ?????? ??? ?????? ?? ???????,
+<p>???? ??? ??? ????? ?????????? ??????????! ?????? ??? ?????? ?? ????????? ?
 ????????? ??????? ??????, ? ?????? ? ??????? ????!
-???????, ?? ????????? ????????? ??????, ? ??????? ?? ??????.</p>
+?? ????????? ????????? ??????, ? ??????? ?? ??????.</p>
 
 <h4>??????????? ? Quadropolis ???????? ??? ? ?????? ???</h4>
 
-<p>? ????? ? ?????????? ?????? ????????? ??????????? ???????????? ????.
-???????? ??? ?????????? ??????? ???????????????? ????? ???????, ???????? ???????
+<p>? ????? ? ?? ?????????? ?????? ????????? ??????????? ???????????? ????.
+???????? ??? ?????????? ??????? ????????????? ????? ???????, ???????? ???????
 &quot;??????? ????&quot; ??????????? ????? ???????. ?????
 ????? ??? ??????? ??????????? ? ????? ????????????. ?? ??????
 ? ????????? ??????? ?????? ????? ??????? ?? ???????????? ????????? ?????????.</p>
 
-<p>?? ??? ????? ????????? ????????? ???? ????? ?????????? ??????? ?
-? ?????????? ? ????? ??????? vi ???? ???????? ????? ??????? ???????, ?
-?????? ???????. ?? ?? ???????? ????? ?????, ??? ????, ???????, ????????, ???????.
-? ??????? ????, ?????? Raoul Bourquin, ? ??????? ?????????????? ???????? ??????????? ???????????
-st-flash. ??????? ??????? ????? ? ?????? ???????? ??????? ??????
+<p>?? ??? ????? ????????? ????????? ????? ????? ?????????? ???????, ?
+? ?????????? ? ????? ??????? VI ??? ??????? ????? ??? ???????, ?
+?????? - ??????. ?? ?? ???????? ????? ????? ??? ????, ???????, ????????, ???????.
+?, ???????, ???? (?????? Raoul Bourquin), ? ??????? ???????? ???? ?????? st-flash,
+??? ?? ???????????. ??????? ??????? ????? ? ?????? ???????? ??????
 ????? ??????????????? ? ?????? Raoul'? ?? ????? ??? Enigma.</p> 
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200710_f.png" alt="Level of the month" border="0">
-<div class="imagetitle">?????? ???????? ??? ???: ??????<br>??????????? ????? ????? ???? ??????!</div>
+<div class="imagetitle">??????: ?????? ????????????<br>????? ????? ???? ??????!!</div>
 </div>
 
-<p>??????? ????? ????? ?????? ???????? Andreas'??, ?????? ????????? ??????? ?????????, ???
+<p>??????? ????? ???? ??????? ???? ???????? Andreas'??, ?????? ????????? ??????? ?????????, ???
 ???????? ??????? ??. ??? ??? ? Andreas, ? Raoul ???????? ???????? ??????? ???(????????? ????????? ???????),
 ??? ????? ?????????? ???? ??????? ?????????????? Andreas'??
 ???? ????? ?? Raoul'?. ?? ???????????? ??????? ????????????????? ? ????? ??????? ???????????
 ??????????? ?????-???????. ????? Andreas ?????? ??? ????? ????????.
-? ?????? ??????? Raoul ??????? ???? ?? ????? ?????? ?????? Andreas'? ?, ????????? ???????,
-?????????? ????? ? ??? ???? ??????????? ??????, ??????? ?????? ??? ???? ??????.</p>
+? ?????? ??????? Raoul ??????? ???? ?? ????? ?????? ?????? Andreas'? ? ??????? ?????? ??? ???? ??????, ????????? ???????,
+?????????? ????? ? ??? ???? ??????????? ??????.</p>
 
 <h4>???? ??? ????? ????????? ??????? ??? Enigma:</h4>
 
 <p>??????? ???????? ???????? ???? ???????????? ?? ?????? ?? ??????????, ?? ? ?? ????????.
 ??? ????????? ? ????????? ????? ?????????????? ???? ? ???? ????????? ?????????? ??????
-???????? ????, ????? ?? ???? ???????????? ????? ??????? '???????
+???????? ????. ????? ?? ???? ???????????? ????? ??????? '???????
 ??????', ?????????????? ????? ?????? ??????? ?????? 'Island Labyrinth' ?? Jacob Scott.
 ? ???????? ?????? ?? ??????? ??????? Quadropolis Jacob ??? ? ????????? ??? ???????? ? ??????
-??????? ??, ????????????? ???????????? ??????.</p>
+??????? ?? - ????????????? ???????????? ??????.</p>
 
 <p>????? ? ?????, ??????? ?????????????? ???,
-Illmind, ??? ???? ???????? ????????????? ?????? ??????????? Enigma, ??????? ?????? ????? ????
-'????????? ?????????? ??????' ?????????? ???????: &quot;????? ?? ???????
+Illmind, ??? ???? ???????? ?? ????????????? ?????? ??????????? Enigma, ????????? ???? ????
+'????????? ?????????? ??????', ???????????? ?????????? ???????: &quot;????? ?? ???????
 ??????? ???????? ?????????? ???????..&quot;. ?????? ???????? ???? ??????
 ????? ?????????? ?????????????? ? ???????, ? ?????? ??? ?????? ???? ???? ???????
 ?????? ??????? ???, ????????? ?? ??????? ???????.</p>
 
 <p>? ??????????? ?????? (???????? ?????!) - (?????????!) - ?????? ?????? ???, ???
-?????? ?????? ????????? ?????? ??? ?????? ?????????. ??? ??? ??????. ????????? ??????
+?????? ?????? ????????? ?????? ??? ?????? ????????? - ??? ??? ??????. ????????? ??????
 ?????? ?????? ????? ??? ???, ? ??????? ??????? ??????? ???? ????????? ?????????,
 ?????????? ? ????????, ???? ??????? '????????? ????????? ???????' ?? ??????? ???:
 'Quadropolis'.</p>
 
 <p>?????? ?????? ?????? ?????????? ?????? ? ??? ???????? ???? ??????????
-Illmind'?? ?? ?????? ??????? ?????????? ?????? ?? mag.heut.net. ????? ?? ???????
-??????? ?? ???????? ?, ????? ???? ??? ?????? ??????????? ?????? ??????????
+illmind'?? ?? ????????? ?????? ??????? ?? mag.heut.net. ????? ?? ???????
+??????? ?? ???????? ?, ????? ???? ??? ?????????? ?????? ?????? ??????????
 ? ???? ????????????, ?????? ??? ??????? ????????? ????????. ?????? ??? ?????? ??????
 Quadropolis ??? ??????????? ? ??????? Enigma 1.01 ? ?????? ???????
 (?????????? ?????? ?? ??????? ???? ??????) ??? ??????? ((?????? ?????????? ?? ??????) ?????????? ?? ?????? ????
@@ -125,7 +125,7 @@
 <p>??? ??????????? ????? ?????? ? ??????????? ????? ????????? ???????????
 ??????? ?? ??????. ?? ??????????? ???????? ?????????????, ????? ??????? ??????? ??? ? ??????
 ?????? ????????? ?? ?? ????? ? Quadropolis. ????? ???????????
-????????????? ?? ????????? ? ?????????? ???????, ? ???? ??????????? ?????????? ?? ?????? ????? ?
+????????????? ?? ????????? ? ?????????? ???????, ? ???? ??????????? ?????? ?? ?????? ???? ?
 ?????? ?????????, ??? ??? ??????.</p>
 
 <h4>&quot;? Enigma ??? ?????? ????? ??????????? st-chess ? st-puzzle&quot;</h4>
@@ -150,10 +150,10 @@
 </div>
 
 <div class="quote">
-????? ?????? ??????????? ? ???? ??????? ??????? ???????, ?? ???? ???? ????????? "??":
-???? ?? ??????? ?????? ? ??????, ?? ?? ??????? ?????? ???????! ?? ??? ??????
+????? ?????? ??????????? ? ???? ??????? ????? ?????????? ???????, ?? ???? ???? ????????? "??":
+???? ?? ??????? ?????? ? ??????, ?? ?? ??????? ?????? ???????! ??, ??? ??????
 ? ??????? ?????? ?????, ??? ???? ?? ???????? ??? ???????, ????????? ?? ???????
-? ???????? ???????, ?? ?????????? ??????????? ?????? ????? ??????. ??? ?????????? ????,
+? ???????? ???????, ?? ?????????? ??????????? ?????? ????? ??????. ??? ????????? ????,
 ? ? ??? ?????? ????????, ????? ?????, ??? ???????? ???? ????? ??????????? ? ???????
 ??????-???????????.
 </div>
@@ -162,12 +162,12 @@
 ????? ????? ? ???????? ?????????? ???????????? ???????????
 ????????? ??????????????? ?????????????, ???????? ?? chessoban. ? ???? ??????? ??? ?? ????????, ???
 ????????? ????????? ???? ???????? ? ??? ??????, ??? ????? ??????? ????????? ??????,
-?????? ??? ? ?????, ????? ??????? ??? ????????????. ?? ? ?????, ? ????? ?? ???????.
+?????? ??? ? ?????, ????? ??????? ??? ????????????. ?? ? ?????, ? ????? ??????? ????? ????????.
 </div>
 
 <div class="quote">
 ? ??? ?? ????? ??????? ?????????, ?? ? ????? ? ????????? ???????? ? ??????? ??????? ??????.
-?????????? Quadropolis ???? ?? ???? ??????? ???????.
+??????????, Quadropolis - ???? ?? ???? ??????? ???????.
 </div>
 <div class="author">Johannes Laire</div>
 
@@ -175,26 +175,26 @@
 
 <div class="quote">
 &quot;Quadropolis&quot;, ????????? ?????? ??????? ???, ??? ?????????
-??????????????? ????????? ????????????? ? ??????? ???????, ? ???? ? ??? ?????. 
+??????????????? ????????? ????????????? ? ??????? ???????, ??????? ????. 
 ?????? ?? ??? ?????? ???? ??????? ? ????????? ??????, ???????? ?
-?????-?? ??????????? ??????????? ????????????.
+??????????? ????????????, ??????? ???? ? ??????? ? ??????.
 </div>
 
 <div class="quote">
 ?? ?????? mag-heut.net ?? ????????? ?????????????? ?????? ????-??????? ? ???????
 ????????? ?? ??????, ????? ??????? ??????? ? ??????????? ???????? ? ??????????
-????????? ???? ? ?????? ?????.
+????????? ???? ? ????????????? ?????.
 </div>
 
 <div class="quote">
 ??? ??????? ?????, ?????????? ?????????? ??? ????, ????? ?? ????? ???????
 ?????? ??????: ?????????? ??????? ??????? ??????? ??? ?????? ?? ?????? ???
-??????????? ? ????, ????? ?????? ? ??????.
+??????, ????? ?????? ? ??????.
 </div>
 
 <div class="quote">
 ??? ??????????? ??? ??????? ????? - ? ????? ?????????? ???????
-??????????? ?????? ??????? ?????? ? ???????? ?????? ? ????? ??????. ??????????, ?????
+??????????? ??????? ??????? ?????? ? ???????? ?????? ? ????? ??????. ??????????, ?????
 ??? ??? ??????????? ?? ?????? mag-heut, ?? ??? ??? ? ???????? ?????????? ???????....
 </div>
 <div class="author">Jacob Scott</div>
@@ -202,26 +202,26 @@
 <h4>&quot;????? ????, ??? ??? ????? ????????? ??? ???????&quot;</h4> 
 
 <div class="quote">
-??? ??? ???????? ? ????? Illmind'?, ??????? ???????? ? ????? ??????? ??????? ? ????????
-?????????? ???????, ?????? ?? ??????? ?????????????? ????????? ???????, ? ? ?????
+??? ??? ???????? ? ????? illmind'?, ??????? ???????? ? ????? ??????? ??????? ? ????????
+?????????? ???????, ?????? ?? ??????? ?????????????? ????????? ???????, ? ? ?????
 ??? ????????? ??????? ????? ?????????? ?????? ? ???? ??????. ??? ???? ???? ????????? ?????
 ? ??????? ??????? ?? 4 ??????, ??????? ?????? ?????? ??? ??????
 &quot;????????? ????????? ???????&quot;.
 </div>
 
 <div class="quote">
-????, ?? ?????????? ? ????? ??????, ?????? ?? ??? ????? ????????? ???? ??????????? ???????. ? ???? ???? ?????,
-??????? ? ??????????? ?????? ? 'Puzzle Puzzles', ?? ??????? ? ?????? ??????????.
-?????? ????? ????? ??????????? ????????? ????? ????? ???? ??????? (??? ????? ??? ???????).
-????? ??? ???????, ?? ????????? ???????????, ??????? ???????? ? ??????? ???? ??????, ??? ????? ?????????? ????????? ????.
-??????? ? ??????????? ?????? ??? ???????? ???, ????? ??????? ?????? ??? ????? ??????? ? ????????? ??
-?????????? ??????????? ??????????, ????????????? ?????? ??????????? ? ??????????? ???? ????????.
+????, ?? ?????????? ? ????? ??????, ?????? ?? ??? ????? ????????? ???? ??????????? ???????. ? ???? ???? ????,
+??????? ? ??????????? ?????? ? 'Puzzle Puzzles', ?? ??????? ? ?????? ????.
+?????? ????? ????? ??????????? ????????? ?????? ????? ???? ??????? (??? ????? ??? ???????).
+????? ??? ???????, ??? ????? ?????????? ????????? ???? ?? ????????? ???????????, ??????? ???????? ? ??????? ????? ?????.
+??????? ? ???????? ??????? ?????, ????? ??????? ?????? ??? ????? ??????? ? ????????? ??
+?????????? ??????????? ??????????, ????????????? ?????? ??????????? ? ???????????? ???? ????????.
 </div>
 
 <div class="quote">
 ????? ?????? ?? ??? ???????? ???? ???????, ?? ?????? ??????????? ??????? ??
-???????. ???????, ???????????? ? ?????????? ???? ??????????? ?????? ?????? ????
-??????? ???????. ????? ????, ? ????????? ????? ??????????? ?????? ????? ????
+???????. ???????, ???????????? ? ?????????? ???? ??????????? ??????, ?????? ????
+??????? ???????. ????? ????, ?????????? ????? ??????????? ?????? ????? ????
 ???????????? ?????????? ??????? ????? ????????????? ? ????? ?????.
 </div>
 
@@ -237,25 +237,25 @@
 </div>
 
 <div class="quote">
-???? ????? ???? ??????? ????? ???????, ?? ? ???? ?? ???? ?????????? ????,
+????, ????? ???? ??????? ????? ???????, ?? ?????? ????? ? ???? ?? ???? ?????????? ????,
 ??? ??????? ???????, ??????? ?? ?????? ????????? ? ????????? ??????. ??? ?????? ????
-????? ???????? ? ?? ????? ???????. ????????? ???? ??????, ???????, ? ???? ????????? ????:
-??? ?????? ???????? ???? ??????! ???? ?????? ???????????? ???????? ?????
+????? ???????? ? ?? ?????? ???? ???? ????? ???????. ????????? ???? ??????, ???????, ? ???? ????????? ????:
+??? ?????? ???????? ???? ???????! ???? ?????? ???????????? ???????? ?????
 ????????? ??? ? ????? ??????? ???? ????????????, ? ?????? ??????? ???? ?????? ???? ?????
 ???????? ? ??????.
 </div>
 
 <div class="quote">
-????? ?????? ?????????? ???????? ????, ????????? ? ??????? ? ??????? ?????????? ?????.
+????? ?????? ??? ?? ????? ???????? ????, ????????? ? ??????? ? ??????? ?????????? ?????.
 ????? ?????? ?????? ????? ??? ????????????????? ????? ???? ?????? ?????
 ????????? ?????. ?? ??? ???? ?? ???????? ??????. ??????? ??? ?????? ????, ????? ??????
 ????? ???? ????????? ???????, ????? ???????? ????????
-????? ?? ???? ???-?? ????? ?????????, ??? ?????, ????????? ? ???????????? ??????? 
+????? ?? ???? ???-?? ????? ?????????, ??? ?????, ???????????? ? ????????????? ??????? 
 </div>
 
 <div class="quote">
-? ???????, ???????? ??? ?????? ??? ????????????, ??????? ?? ????????, ? ??????
-??????, ????? ???? ?????? ??????????? ??????? ? ????????? ????????? ???????.
+? ???????, ???????? ??? ?????? ????????????, ??????? ?? ????????, ? ??????
+??????, ????? ???? ?????? ??????????? ??????? ? ????????? ????????? ???????.
 </div>
 <div class="author">Raoul Bourquin</div>
 
@@ -271,23 +271,23 @@
 20 ? ?????????? ??? ???? ?? ?????? ??????. ??? &quot;20&quot; ????????? ???
 ???????? - ?????? &quot;20&quot;? ??? ???????? ????? ?????????. ? ??????? ?? ?????? ??????
 ???????? ? ????, ??????? ????? ???????? ? ??????? ????????? ??? ??????????
-??????????, ??? ???????? - ??????????. ???????? ? ???? ???????? ? ?????? ????? Oxyd.
-?? ????? ?? ???????????? ????????? ????? ?????, ????? ? st-flash ?????? ????? ???? ?????????
+??????????, ??? ???????? - ??????????. ???????? ??? ????????????? ???????? ?? ?????? ??? Oxyd.
+?? ????? ?? ???????????? ????????? ????? ?????, ????? ? st-flash ??? ????? ???? ???????? ??????????
 </div>
 
 <div class="quote">
 ? ??????? ????????? ?? ?????? ?? Berlios, ????? ?? ?????? ?? ???? ????, ? ??? ???????
 ??????? ?? ????. st-flash ????? ????? ?????????????. ???? ?? ???????????
 ??????? ??? ????? ??????????????? ??? ??????? ???????? ????? ???? ??????? ?????????
-???????? ?????????????: ????????, ????????? ??????????? ?????. ??? ?
+???????? ?????????????: ????????, ????????? ??????????? ????????. ??? ?
 fl-inverse ??? ???? ????? ??????????? ? ???? ???????? ???? ????????? ??????? ?
 ??????? ???????? ??????, ?????? ???????? ????????? ?? ?????-?? ????????.
 ??? ??????? ???? ?????????? ??????? ??? ?????????? ?????????,
 ????????? ? ????? ??????? ??????. ??? ????? ???????????? ? ??? ?????? ??????.
 ??????? ? ????? ?????? ?????, ??????? ?????????? ???????? ??????.
 ??????? ? ????? st-spitter ? st-actorimpulse-family,
-??? ????? ?????????????? ? ? ????????? ??????? ???? ??????????????? ?????????. ??????? ???????????
-???? ????????? ???????? ????? ?????? - ? ???? ? ???? ????????.
+??? ????? ?????????????? ? ? ????????? ??????? ???? ??????????????? ?????????. ??????? ??????????
+?? ???????? ??? ????????? ??????? ????? ???????? - ??? ????? ??????? ??????.
 ? ???? 2006-?? Raoul ???? ??????????? ?????????, ??????? ? ????????????????
 ?? ????? ?? ?????.
 </div>
@@ -299,7 +299,7 @@
 
 <div class="quote">
 ??? ???????? ???????????? ????? ??????? Enigma ? ????? ??????????? ???????. ?? ??? st-flash,
-? ???? ?? ???? ?????????? ??????? ????. ???????? ????????????? ???? ???????????
+? ???? ?? ???? ?????????? ??????? ????. ???????? ????????????? ???? ???????????
 ?? ??????? ??? ?????? ??????. ? ? ????? Enigma 1.00 ????? ??? ???????.
 </div>
 
@@ -308,28 +308,27 @@
 ??????? ?? ?????? ? ?????, ??????? ?? ????? ????????????, ? ??? ???????? ???????? ????
 ?? ???????????? ?????? st-flash ? ??????????? ?? ? ?????????, ? ? ??????
 ????? ???????, ??????? ????? ???????????? ??? ????????. ??????? ? ?? ??????? ?
-???? ????, ????? ?? ????????? ?? ?????. ????? Jacob ? Johannes ??????????????
-? ???????, ? ????? ???????????, ??? ?? ??????? ???? ?? ??????? ?????? ????? ????? ???????? ?????????????,
-???? ??????, ??????????? ???????? ?????? ???? ??? ?????????????? ? ??? ??????????? ???????????? ? ?????.
+???? ????, ????? ?? ????????? ?? ?????. ????? Jacob ? Johannes ??????????????
+? ???????, ? ????? ???????????, ??? ?? ??????? ???? ?? ??????? ????? ????? ???????? ?????????????,
+? ???????, ??????????? ????????, ????? ??? ??????????????? - ??? ??????????? ???????????? ? ?????.
 </div>
 
 <div class="quote">
 ???? ?? ???????, ??????? ??? ????? ???? ?????? - ??????. ???????? ???? ? ???????, ???
-???? ??????????? ????? st-bigbluesand-stones Raoul'?. ?????? ????? ????? ? ???????, ???
-??? ?????????? ???????????, ?????????? ? ???? ??????. ? ?? ????? ????????????
+???? ??????????? ????? st-bigbluesand-stones Raoul'?. ??? ?? ??? ????? ????? ????. ? ?? ????? ????????????
 ????? ??????, ?????? ??? Raoul ??? ??????????? ?? ? &quot;Zeus&quot;. ??????? ? ???????? ?????, ??????? ??? 
 Ronald'? ? ?????? ??????????? ??????.
 </div>
 
 <div class="quote">
-??? ????? ??????? ???????, ??? ??? ?????? ???????? ?? ??????? ???????? ?? ????????
+??? ????? ??????? ???????, ??? ??? ??????? ??????? ?? ??????? ???????? ???????
 &quot;Quadropolis&quot; ? ???? ?????????? ???? ???? ????????? ? illmind'? ? ????
 ???????????? ? ?????????? ????????! ? ??????? ? ??????? ????? ??? ?????? ??????
 ??????????????.
 </div>
 <div class="author">Andreas Lochmann</div>
 
-<p>??????, ????? ??? ?????? ?????? ? ?????-?? ???? ??????????? ????? ? ?? ???????? ?
+<p>??????, ????? ??? ?????? ?????? ? ?????-?? ???? ??????????? ????? ? ????? ???????? ?
 ??????? Quadropolis, ? ???? ???????? ????????? ?????.</p>
 
 <h4>??????? ????????? ???? Andreas'?:</h4> 
@@ -337,15 +336,15 @@
 <p>??????? ? ????, ??? ?? ?????? ?????? ??????? ?????-?? ??????????. ??????,
 ???????. ??????? ??? ????????????? ????????? ??????? ?? ????? Neil Young: &quot;There's more to
 the picture than meets the eye! Hey hey my my!&quot; ?? ?????? ?????? ???-?? ?????
-????????, ??? ???? ???????? ???????? ??????. ?? ?? ??????? ???? ??????
-????? ???????????? ???????? ?? ??????? ????????????? ? ?????-???????. ??????? ?????? ????????????? ??????
+????????, ??? ???? ??????? ???????? ???????. ?? ?? ??????? ???? ??????
+? ???????????? ????????? ?? ??????? ????????????? ? ?????-???????. ??????? ?????? ????????????? ??????
 ??????????? ?? ?????, ??? ??? ?????? Lukas (??! ????????, ????? ??????),
 ??? ???????? ????????? ???????? ?????? ??? ??????? ??????? ???
 ????????????? &quot;???????????&quot;!</p> 
 
-<p>???? ???! ??? ????????? ????? ?????, ???? ?? ?? ?????? ?????????.
+<p>???? ???! ??? ?????????? ????? ?????, ???? ?? ?? ?????? ?????????.
 ????? ??????? ????????? ?? ??????? ? ????? ??????? ??? ???????????? ?????? ???????, ??? ??? ????, ????? ????????
-??? ?????????? ??????? ?????? ??????. ?????????? ???????????, ?? ?? ???? ?? ??????.
+??? ?????????? ??????? ?????? ??????. ?????????? ???????????, ?? ?? ???? ?? ???????.
 ??????, Andreas, ? ?????? ?????? ??? ??? ???????.</p>
 
 <h4>??????? ????????? ? ??????? Jacob'?:</h4>
@@ -355,22 +354,22 @@
 <div class="imagetitle">??????? ?????????? ? ????? ??????? ????? <br>?? ????? ??????? ?? '?????? ??????????'!</div>
 </div>
 
-<p>???? ? ?????? ????? ?? ????? ??????, ??????? ? ????? ??????? ????? ?????????.
-? ?? ?????? ?????? ?????????? ?? ?????? ?????
+<p>???? ? ?????? ?????? ?? ????? ??????, ??????? ? ????? ??????? ????? ?????????.
+? ?? ?????? ????? ?????????? ?? ?????? ?????
 ??????? ??????? ??? &quot;Nightmares&quot; ? &quot;Monsters in the Dark&quot;
 (?? ????????????? ?????????? ??????? ????????? ?????? ???). ?????? ??? ????, ?????
 ??????? ???????????, ? ????????????? ??????? ??????? Esc ? ???????
 &quot;?????? ???????&quot;. ??????, Jacob ???? ???? ????? ? ?????????? ??????
 ????????????? ???????? ????????. ??????????, ?????? ???? ??????? ?????????? ???
-????????? ? ??????????? ??????, ? ??????? ???????? ?????? ? ?????????? ??????? ?????.</p> 
+????????? ? ??????????? ???????, ? ??????? ???????? ?????? ? ?????????? ??????? ?????.</p> 
 
 <h4>??? ?????? Enigma</h4>
 
 <p>???????? ????? ???? ???????, ??? ? ???? ?????????: ????? ?????? ?? ????????,
 ?? ?????? ?????, ?? ?????????, ?? ????????? ?????????????, ?? ?????
 ?? ???????? ? ??? ?????? Enigma. ???????????? ? ????????????, ?
-?????????????, ? ?????, ??? ?? ???? Quadropolis ?? ????? ????????? ????????
-?, ? ??????, ??? Enigma ? ????????? ????!</p>
+?????????????, ? ?????, ??? ?? ???? Quadropolis ?? ????? ?? ??????? ????????.
+? ??????, ??? Enigma ? ????????? ????!</p>
 
 <p>????? ???? ???-?? ?????? ?????????? ????????? ???????? ??? ????? ? ????, ????? ????? ? ??????
 ????? ???? ?????????????? ??????. ???? ?? ????? ???????? ??????????
@@ -378,14 +377,13 @@
 
 <p>???????? ?? ?????????????! ?????? ?????? ??????????? ?????? ??????!</p>
 
-<h4>&quot;? ?????? ??????? st-chess-puzzle ????
-??????? ???????? ????? ?????&quot;</h4>
+<h4>&quot;?????? ??????? ????????, ????????, ?????? ??????????? ? st-chess, ??????? ???? ?????-???? ???????&quot;</h4>
 
 <div class="quote">
-??-?? ????, ??? ? ??? ????? ????? Quadropolis, ??? ??? ??????????? ???????. ??????
-???? ??????? ??????? ???????? ?????????? ??????? ???? ????????????! ??? ?
+?? ???? ???????, ??????? ? ???? ?????, Quadropolis ??? ??????????? ???????. ????
+??????? ??????? ???????? ?????????? ??????? ???? ????????????! ??? ?
 ?????? ???? ?? ???? ???? ?????????? ????????????? ?????? ??????? ?? ?????????. ? ?????? ???????
-???? ?????????????? ?????????? ? ???? ??????????? ???????? ????, ??????? ??????? ????? ??????????
+???? ?????????????? ?????????? ? ???? ??????????? ???????? ????. ??????? ????? ??????????
 ?????? ???? ? ?????? ? ??????? ???????.
 </div>
 
@@ -396,44 +394,43 @@
 </div>
 
 <div class="quote">
-??? ??????, ??? ?????? ??????? ???? ?? ???? ??????? ???????. ? ?????? ???????
-st-chess-puzzle ???? ??????? ???????? ????? ?????. ? ???? ???? ????? ????? ???????,
-?? ??, ????? ??????????? ??? ??????? ??? ?????, ????????????? ?????? ? ????????? ????.
+??? ??????, ??? ?????? ??????? ???? ?? ???? ??????? ???????. ?????? ???????
+????????, ????????, ?????? ??????????? ? st-chess, ??????? ???? ?????-???? ???????. ? ???? ???? ????? ????? ???????,
+?? ??, ????? ?????? ??? ??????? ??? ?????, ????????????? ?????? ? ????? ??????????.
 ??? ??? ??????? ?????!
 </div>
 
 <div class="quote">
-????????? ?? ??? ??????? -  ????? ?????? ?????????? ???????, ?? ?????? ??????????? ????????????
-?? ????. ?????? ??????? ? ?????? ??????? ??????? ???????, ?? ????? ?????????? ???????, ????????????
-? ???????????? ???????????, ??? ??? ????? ????? ????????. ????, ??? ?? ?????? ???????????? ??????
-?????????? ?????? ????????. ????? ?????? ????????? ??????? ? ???????????? ???? ? ?????? ??????? -
-?????? ????.
+????????? ?? ??? ??????? - ???-?? ????? ????????????? ???????, ??? ?? ????? ??????????
+????????? ??????????. ?????? ??????? ? ?????? ??????? ??????? ???????, ?? ????? ?????????? ???????, ????????????
+? ????????????, ???????????, ??? ??? ????? ????? ????????. ????, ??? ?? ?????? ???????????? ?????? ???????? ??????
+?????????? ??????. ????? ?????? ?????????????? ??????? ? ???????????? ???? ? ?????? ??????? - ??????? ?????.
 </div>
 
 <div class="quote">
 ????????? ??????? ?????? ????????????????? ??????????. ?? ?????? ?????? ??? ????????
-??????? ??????, ?? ???????????, ??? ??? ????? ??????????????? ??????????? -
-????????, ????? ????? ????? ?????? ??? ???? ?????????????? ?????! ??? ????????? ????????????
+??????? ???????, ?? ???????????, ??? ??? ????? ??????????????? ??????????? -
+????????, ????? ????? ????? ?????? ??? ???? ?????????????? ?????! ???, ? ????? ????, ????????????
 ?????????????? ???????????? st-flash!
 </div>
 
 <div class="quote">
-???????????? ??????, ??????? ???????? ?????????: ??-????? ??????????
+???????????? ??????, ??????? ???????? ?????????: ??-?????, ??????????
 ??????? ? oxyd'??? ??????? ??????. ???? ??? ????? ?????? ?????? ?????? ????
-(???????? ? ????? ???), ??? ????? ?????? ???? ??????? ????? ???????????.
+(???????? ? ????? ???), ??? ????? ?????? ???? ????????? ????? ???????????.
 </div>
 <div class="author">Lukas Sch&uuml;ller</div>
 
 <h4>&quot;?????? ?????????, ?????? ??? ???-???? ???????&quot;</h4>
 
 <div class="quote">
-?????? ?????? ?????? ?????-??????????? ? ??? ????????. ??????? ??????????? ????? ??????????
-? ????????, ??? ??? ??????? ?????????? ???????? ??????? ????? ??? ???????. ???????? ??? ??????,
+?????? ?????? ?????? ?????-??????????? ? ??? ????????. ??????? ??????????? ????? ??????????,
+????? ??? ??????? ????????? ???????? ??????? ????? ??? ???????. ???????? ??? ??????,
 ??????? ?????? ??????????, ??? ??? ???????, ??? ?? ???????. ?? ??? ????????? ???????????
-????????? ????? ???? ? ?????? ???????????. ?????????? ?????????? ??????? ??????????? ????? ?????
-????????????. ??????? ?? ??? ?????? ?????????, ?????? ???????? ?????? ???????.
-?? ???????, ? ?????? ??????? - ????? ??? ? ??????? ?????, ????? ??????????? ?????? ???
-????????? ???? ?? ??????. ????? ?????? ??????!
+????????? ????? ???? ? ???????????. ?????????? ?????????? ??????? ??????????? ????????????? ???.
+???????, ?? ??? ?????? ?????????, ?????? ???????? ?????? ???????.
+?? ???????, ? ?????? ??????? - ?????, ??? ? ??????? ?????, ??? ??? ???? ??????? ????? ??????? ???????????.
+????? ?????? ??????!
 </div>
 
 <div class="quote">
@@ -447,30 +444,30 @@
 </div>
 
 <div class="quote">
-????? ????????! ????? ??? ? ?????? ????????! ????? ?????????? ???? ????? ????? ????
+????? ????????! ????? ??? ? ?????? ????????! ??? ?? ?????? ??? ???? ?????? ???? ????? ????,
 ? ????? ?????? ????? ?? ????? ?????????? ?????????. ?????? ??????, ??? ??? ????? ???????? ??????, ??????
 ??? ???-???? ???????.
 </div>
 
 <div class="quote">
 ? ?????? ??? ?? ????????? ??????. ?????? ??????? ????? ??????? ? ?????????? ???????. ?
-?????? ????? ??? ?????????, ????? ? ? ???????? ?????? ?? ????????????? ??????????? ?
-???????? ??? ?????. ?????? ? ?????? ?????? ?????? ??? ?????????? ???????????! ? ?????
-??????? ??????????? ???????? ?????? ? ?????? ? ??????? ??????? ???? ?? ???????? ?????.
+?????? ?????, ??? ?????????, ????? ??????? ?????? ???????? ??? ?????????????? ???? ?
+?????? ???? ?????. ?????? ? ?????? ?????? ?????? ??? ?????????? ???????????! ? ?????
+??????? ??????????? ???????? ?????? ? ?????? ? ??????? ??????? ???? ?? ???????? ???????????.
 </div>
 
 <div class="quote">
-???????, ?????????? ?? ????????? ???????, ? ????? ?????????? ? ????????? ????? ???????. ?????????????? ???????
-??? ????????? ??? ???? ?????? ? ??????????? ??????????? ??????. ? ??????? ?? ????????????????? ??? ???????, ???
-?? ???? ??????, ????? ?????? ???????????, ???? ??????? ?????. ?????? ?? ????? ?? ??????? ?????! ????? ??????????
-??????? ????????? ?? oxyd'??.
+???????, ?????????? ?? ????????? ???????, ? ????? ?????????? ? ????????? ????? ???????. ??????????????
+?? ????? ??????? ? ?????? ? ??????????? ??????????? ??????. ? ??????? ?? ????????????????? ??? ???????, ???
+?? ???? ??????, ????? ?????? ???????????, ???? ????????? ?????. ?????? ?? ????? ?? ??????? ?????! ????? ??????????,
+???????, ????????? ?? oxyd'??.
 </div>
 
 <div class="quote">
 ?????????? ???? ??????? ???????. ???????????, ?????? ????? ???? ?????? ???? ??? ????? ???????.
 ???? ??????? ? ????? ???????? ?????, ?? ?????? ??????????????? ??????????? ??????? ??????,
 ????? ????? ????? ???? ? ??????????? ???????.
-??????? ?? ?????? ??? ???? ????????? ????????? ???????.
+??????? ?? ?????? ??? ?? ???? ????????? ????????? ???????.
 </div>
 <div class="author">Ronald</div>
 
@@ -491,20 +488,20 @@
 
 <div class="quote">
 ??????? ? ???????? ???? ???????, ????? ?????? ???????????. ?? ????? ???? ??? ???? ??????? ???????.
-??????? ? ????? ?? ?????, ?? ??????? ?? ??????? ???.
-????????? ?????, ??????? ??????????? ? ?????? ?????? ?? ??? ?? ?????, ???
-? ??????? ?????, ??? ?? ?????????, ????? ?????? (????? ??????) ???????.
+???????, ? ??????? ????? ??, ?? ??????? ?? ??????? ???.
+??????, ??? ??????? ??????????? ? ?????? ?????? ?? ??? ?? ?????,??? ??? ?, ???????, ?????, ??? ?? ??????,
+????? ?????? (????? ??????) ???????.
 </div>
 
 <div class="quote">
-??? ?? ??????? ?????? ????????? ????????? ?????? ?? ?????? ?????. ??, ? ?????? ? ?????
-? ?????????? ?? ???????? ????????? ?????? ? ??????? ?????? ????? ???????, ????????????
-??????????? ?????, ? ????? ??????? ??? ???????. ? ????? ???? ?????? ???????? ???????.
+??? ?? ??????? ?????? ????????? ????????? ?????? ?? ?????? ?????. ?? ? ??????, ? ????? ? ????? ?????
+????????? ?????? ? ?????? ??????? ??????? ???????, ???? ??????????? ?????, ? ?????? ??? ???????? ??? ???????.
+? ????? ???? ?????? ???????? ???????.
 </div>
 
 <div class="quote">
-?????? ??????, ? ??? ???????? ????????? ?? ???????, ????? ??? ????? ????
-??????? ??? ????? ? ???????; ? ????? ??????, ? ???? ???????? ???? ?????????.
+?? ?????-?? ??????? ? ??? ?????? ???????, ??? ?????? ?????????? oxyd'??, ????? ?????? ??? ????? ? ???????.
+? ????? ??????, ? ???? ???????? ???? ?????????.
 </div>
 
 <div class="quote">
@@ -514,8 +511,8 @@
 </div>
 
 <div class="quote">
-???????, ????? ???? ?? ???? ???????. ??????, ??? ??? ??? ? ????? ?????? ???????? ?????? ? ?????????,
-? ???? ?? ???? ???????????? ???????. ? ??????? ????? &quot;????????????&quot;
+???????, ? ????????? ??????? ???? ?? ???? ???????. ??????, ??? ??? ??? ? ????? ?????? ???????? ?????? ? ?????????,
+??? ?? ??????? ? ???? ???????????? ???????. ? ??????? ????? &quot;????????????&quot;
 ????? ????? ???????? ?????? ???? ???????.
 </div>
 
@@ -546,30 +543,30 @@
 <h4>&quot;???????? ????? ??????????? ???????????? ?????? ???????? ??? ???? ??? ???????&quot;</h4>
 
 <div class="quote">
-???? ??? ??? ?????????????? ???????? ??????? ???????? ??????????, ?????? ?? ???
+???? ??? ??? ?????????????? ?????? ??? ?????? ???????? ??????????, ?????? ?? ???
 ??????? ???? ??????? ? ??????, ??????????????? ??????. ???? - ??????????? ??????????? ?? ????????? ??????
 ???????? ???????.
 </div>
 
 <div class="lotmpic">
 <img src="$$imagedir$$/lotm/lotm_200710_i.png" alt="Level of the month" border="0">
-<div class="imagetitle">????? ??????: ????????</div>
+<div class="imagetitle">??????: ????????</div>
 </div>
 
 <div class="quote">
-??????? Johannes'? ? ?? ????????????? ? ?????????? ????????, ??????? ????? ??????? ????? ????????, ????? ?? ????.
-? ?????????? ?? ??, ??? ????? ???????????? ?????????????? ????????? ???????????, ???? ???????? ? ????????
+??????? Johannes'? ? ?? ????????????? ? ?????????? ????????, ??????? ????? ??????? ? ?????? ???????????, ????? ?? ????.
+? ?????????? ?? ??, ??? ????? ???????????? ??????? ???????? ? ??????, ???? ???????? ? ????????
 (? ??????? ?? ????? ???????????? ???????, ? ??????? ?? ??????? 20 ?????, ????? ??? ??? ????????? ??????, ???????
 ????? ?????????? ??????). ??? ? ?? ?????? ??????? Enigma, ????? ???? ???????? ?????? ('?????? ??? ????????'),
 ? ???????, ???? ?? ??????? ???????????, ? ??? ?????????? ?????? ??????? ????
-????????? ???????. ??? ????, ???????? ?????? ?????????, ????? ??? ????? ??????? ????? ????? ? ???????? ??????
+????????? ???????. ??? ????, ???????? ?????? ?????????, ????? ??? ????? ??????? ????? ????? ? ????????? ??????
 ???????. ???? ? ???? ??????????? ????????? ??????, ?? ?????? ?????? ????????? ???????? ???????????,
 ? ????????, ??? ???? ???-?????? ???????.
 </div>
 
 <div class="quote">
-?????? ??????? Jacob'? ??? ?????? ??? ????????. ??? ????? ?????? ? ????? ????????????.
-?????? ??????????? ? ???????? ?????????. ????????????? ????? ?????, ??????? ?????? ???????? ? ???? ??????.
+?????? ??????? Jacob'? ??? ?????? ??? ????????. ??? ?????? ? ????? ????????????.
+?????? ??????????? ? ???????? ?????????. ????????????? ????? ?????, ??????? ?????? ???????? ? ???? ??????.
 </div>
 
 <div class="quote">
@@ -581,8 +578,8 @@
 <div class="quote">
 ? ???????, Andreas ??????? ??? ??? ?????????? ? ????? ????. ? ??? ????????????? ???????,
 ?? ????? ? ?????? ??????????. ? ??????? ???????? ???? ??????????? - ?? ???????????
-???????? ?? ??????? ?????????? ??????(????? ???????? ??????), ??????????? ????? ????????
-?? ???????? ????????.
+???????? ???, ??? ??????? ?????????? ?????? (????? ???????? ??????), ????????? ????????
+???????? ??? ?????????? ???????? ????????.
 </div>
 
 <div class="quote">

Modified: homepage/input/menu_ru.html
===================================================================
--- homepage/input/menu_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/menu_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -33,7 +33,7 @@
               <span class="menusubtitle">mag-heut.net</span></a></li>
             <li><a href="support_ru.html#score">??????? ???? ?????????</a></li>
             <li><a href="statistics_ru.html">?????????? ???????????</a></li>
-            <li><a href="lotm_ru.html">????? ???<br/>
+            <li><a href="lotm_ru.html">????? ??<br/>
               <span class="menusubtitle">?????? ??????</span></a></li>
             <li><a href="support_ru.html#bug">????????? ?? ???????</a></li>
             <li><a href="support_ru.html#donation">??????</a></li>
@@ -44,7 +44,7 @@
           <ul>
             <li><a href="http://mail.nongnu.org/mailman/listinfo/enigma-devel">????????<br/>
               <span class="menusubtitle">???????? ??? ????????????? (nongnu)</span></a></li>
-            <li><a href="devel_ru.html#tasks">?????????</a></li>
+            <li><a href="devel_ru.html#tasks">??????? ??????</a></li>
             <li><a href="devel_ru.html#level">??????</a>
               <ul>
                 <li><a href="manual/enigma-ref.html">???? ???????</a></li>

Modified: homepage/input/news/news_issue15_ru.html
===================================================================
--- homepage/input/news/news_issue15_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/news/news_issue15_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -2,11 +2,11 @@
     <span class="date">22 ?????? 2006: </span> ???????? ????-?????? Enigma 1.00
 </h3>
 
-<p>? ??? ????????, ????? ??????? ????????, ? ?????? ????????? ???????? ???????
-    Enigma ????? ??? ?? ???. ?? ???????? ?? 
+<p>????? ???????, ????? ??? ????????, ????????, ? ??? ???????? ? ?????? ????????? ???????? ???????
+    Enigma. ?? ???????? ?? 
     <a href="$$download$$">???????? ????????</a>. 
     ????????? ???? ????????? ??????? - ??????? ? ?????????
-    ??? ????? ???????, ????????? ??? ????????, ?????????? ???????? ??? ???? ???????, ??????? ?? ??????? 
+    ??? ????? ?????? ???????, ?????????? ???????? ??? ???? ???????, ??????? ?? ??????? 
     ? <a href="mailto:enigma-devel at nongnu.org">?????? ???????? Enigma</a>
 </p>
 

Modified: homepage/input/news/news_issue16_ru.html
===================================================================
--- homepage/input/news/news_issue16_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/news/news_issue16_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -3,7 +3,7 @@
     
 </h3>
 
-<p>???????? ????? ?????? Enigma, ?????? 555 ????? ?????????? ??????????? ???????.
+<p>???????? ????? ?????? Enigma, ?????? 555 ???? ? ?????????? ??????????? ???????.
     ?? ???? ???????? ???? ?????????????. 
     ?????? ????? ? ?????????? ???????????? ????????:</p>
 

Modified: homepage/input/news/news_issue19_ru.html
===================================================================
--- homepage/input/news/news_issue19_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/news/news_issue19_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -2,16 +2,16 @@
     <span class="date">9 ????? 2007: </span> ????????? ???????? ????????
 </h3>
 
-<p>???????????, ?????? ??? ???????? ???????? ??-???????? ?? ???????? ?? ? ?????.
-????????? ???????? ? ????:</p>
+<p>???????????, ?????? ??? ???????? ???????? ??-???????? ?? ? ????? ???????? ??.
+????? ?????????:</p>
 
 <ul>
-    <li> ?????????? ??????????? ? ???????? ?????????; ?????????? ?????? </li>
-    <li> ????? ?????? ? ?????? ???????, ????, ??????????????? ?????? ? ?????????? ?????????.</li>
+    <li> ?????????? ??????????? ? ???????? ?????????; ?????????? ??????</li>
+    <li> ????? ?????? ? ?????? ???????, ????, ??????????????? ?????? ? ?????????? ?????????</li>
     <li> ??????????? ????????????? FAQ</li>
     <li> ????? ?????? &quot;??????? ??????&quot;</li>
     <li> ???????????? ? ????????? ??? ????????</li>
-    <li> ?????????????? ? ????????, ?????? ?????????.</li>
+    <li> ?????????????? ? ????????, ??????, ?????????</li>
 </ul>
 
 <p>???????? ??? ?????????? ???? ????? ????!</p>
\ No newline at end of file

Modified: homepage/input/news/news_issue1_ru.html
===================================================================
--- homepage/input/news/news_issue1_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/news/news_issue1_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -7,12 +7,12 @@
     ??? ??????? ?????? ????????? ? ???? ???????:</p>
 
 <ul>
-    <li>????????? ?????????? ??????????????????</li>
+    <li>????????? ?????????? ??????????????????</li>
     <li>??????-????</li>
     <li>????? 70 ????? ???????</li>
     <li>??????????? ???????? ?????????? ?????</li>
     <li>????????? ???????????? ?????? Oxyd (??????????? ??????? ? ????? README,
-        ??????? ???????????? ? Enigma</li>
-    <li>????? ??????? ???????, ????? ??? ?????? ???????, ???? ?????? ? ???????????
+        ??????? ??????????? ? Enigma</li>
+    <li>????? ??????? ???????, ????? ??? ?????? ???????, ???? ? ???????????
         ?????????</li>
 </ul>

Modified: homepage/input/news/news_issue21_ru.html
===================================================================
--- homepage/input/news/news_issue21_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/news/news_issue21_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -17,10 +17,10 @@
     <li> ????????? ?????????????????? ????????</li>
 </ul>
   
-<p>????????? ??????? 1.01, ?? ?????? ??????? ??????????? ?????? ?? ???, ??? ? ?????????? ??????,
+<p>????????? ??????? 1.01, ?? ?????? ??????? ??????????? ?????? ??????? ?? ???, ??? ? ?????????? ??????,
     ? ??????? ????? ???? "???????? ????" ???????. ??????????, ??????????? ????????? ??? ????
-    ??????, ???????? ????? ?????? ????? ???????????, ??? ??? ??????? ? 
-    <a href="$$support$$#score">??????????? ???????????</a></p>
+    ??????, ????????? ????? ?????? ????? ???????????, ??? ??? ??????? ? 
+    <a href="$$support$$#score">??????????? ???????????</a>.</p>
   
 <p>??? ?????? ????? ?????? ???????? ?? <a
 href="$$download$$">???????? ????????</a> (<font color="red">???????? Mac OS X!</font>).</p>

Modified: homepage/input/news/news_issue23_ru.html
===================================================================
--- homepage/input/news/news_issue23_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/news/news_issue23_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -6,6 +6,6 @@
 64 ?????????. ?? Windows, ?? Mac OSX, ?? Debian-?????????? ??????
 ?? ?????????? ???? ????????. ??? ???? ????????? ?????? Unix, ??????? ???????
 ??????????????? ?? ?????????? ???? ???????? ?????, ?? ?????????? ??????????? ????? ???????? ?????, ??????? ????????? ? 
-64-?????????? ???????????? ??? ?? ?????? ??? ? ? 32-??????????. ?????????? ???????? ?????? ? ????????????? 
+64-?????????? ???????????? ??? ?? ??????, ??? ? ? 32-??????????. ?????????? ???????? ?????? ? ????????????? 
 &quot;????????????? ????????? ???? ? 32/64 ?????????&quot; ?? ?????? <a href="$$download$$#stable">
 ??????? ????????</a>.</p>

Modified: homepage/input/news/news_issue6_ru.html
===================================================================
--- homepage/input/news/news_issue6_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/news/news_issue6_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -6,8 +6,8 @@
 <p>???? ?????? ?????????? ????????? ???????, ??????? ??????????? ? ?????? 0.80.  
     ? ?????????, ?? ????????????? ?? ????????????? ??????? ?????? ???, ????? ?? ???????.</p>
   
-<p>? ????? ??????? ???????? ?????? ???????? ??? ? ?????? ????????? ??? Windows
-    ; ?????? ??? ?????? ???????????? ?????? ???????? ? ????????? ????????? ???? ??? ??????.</p>
+<p>? ????? ??????? ???????? ?????? ???????? ??? ? ?????? ????????? ??? Windows;
+?????? ??? ?????? ???????????? ?????? ???????? ? ????????? ????????? ???? ??? ??????.</p>
   
 <ul>
     <li>????????? ?????? ?????????</li>

Modified: homepage/input/news/news_issue8_ru.html
===================================================================
--- homepage/input/news/news_issue8_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/news/news_issue8_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -3,10 +3,10 @@
     ???? ?????? Enigma 0.90
 </h3>
 
-<p>? ??? ????????, ????? ??????????? ????????, ? ?????? ????????? ???????? ?????? 
+<p>????? ??????????? ????????, ? ??? ???????? ? ?????? ????????? ???????? ?????? 
     Enigma ?? ????? ??? ???. ?? ???????? ?? 
     <a href="$$download$$">???????? ????????</a>. 
     ????????? ???? ????????? ?????? ??????? ? ?????? ? ???????????
-    ??? ????? ???????? ?????????? ???????, ?????????? ????????? ? ???? ???????????? ???? ???????
+    ??? ????? ???????? ?????????? ???????, ?????????? ????????? ? ????, ???????????? ???? ???????
     ? <a href="mailto:enigma-devel at nongnu.org">?????? ???????? Enigma</a>. ?????? ?????? ???????? ?????!
 </p>

Modified: homepage/input/press_ru.html
===================================================================
--- homepage/input/press_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/press_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -4,7 +4,26 @@
 ?? ?????? ??????? ????? ?????????? ?????? ?? Enigma.
 
 <ul>
-  <li><a href="http://en.wikipedia.org/wiki/Enigma_%28game%29">Wikipedia</a></li>
+  <li><a href="http://en.wikipedia.org/wiki/Enigma_%28game%29"
+	>Wikipedia</a></li>
+  <li><a href="http://www.associatedcontent.com/article/335780/enigma_classic_memory_game_meets_fastpaced.html"
+        >AssociatedContent</a></li>
+  <li><a href="http://mac.softpedia.com/get/Games/Enigma.shtml"
+        >Softpedia</a></li>
+  <li><a href="http://www.versiontracker.com/dyn/moreinfo/macosx/21160&mode=info"
+        >VersionTracker</a></li>
+  <li><a href="http://www.computerbild.de/programme/Enigma-1.01_7766.html"
+        >Computer Bild (German)</a></li>
+  <li><a href="http://www.chip.de/downloads/c1_downloads_19309102.html"
+        >Chip Online (German)</a></li>
+  <li><a href="http://software-portal.faz.net/ie/64780/"
+        >FAZ.net (German)</a></li>
+  <li><a href="http://www.opensource-dvd.de/spiele1.htm#enigma"
+        >Opensource-DVD (German)</a></li>
+  <li><a href="http://www.bonnsite.de/softtip.html?action=show&number=154"
+        >Bonnsite (German)</a></li>
+  <li><a href="http://www.heise.de/software/download/enigma/20301a24917"
+        >Heise (German, 0.81)</a></li>
 </ul>
 
 ???? ?? ????? ??? ???????????? ??????????? ??????, ?????????? ???????? ???

Modified: homepage/input/stat-help_ru.html
===================================================================
--- homepage/input/stat-help_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/stat-help_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -1,16 +1,16 @@
   <div class="stat-help">
     <h3>?????????</h3>
     <h4>?????</h4>
-      ??? ???????????????? ?????? ??????????????. ???? ??? ?????? ???????? 
-      ?????????? ?????, ??? ?????? ??????????? ? ??????. ??????, ??????? ?????????? 
-      ????????? ??? ? ?????? ??????? ??????? ?????? ????????? ????????.
+      ?????????????? ??? ???????????????? ??????. ???? ??? ?????? ???????? 
+      ?????????? ?????, ????????? ??? ??????. ??????, ??????? ?????????? 
+      ????????? ??? ? ?????? ??????? ??????? ????????? ?? ????.
     <h4>??????????</h4>
       ????????? ?????????? ? ??????????? ? 1 ???????. ???? ??? ??? ?????? ????????????
-      ????????? ??????? ? ????????? ?? ??????? ? ??? ? ????? ????? ??? ?? ?????????
-      ? ??? ???????? ????? ????? ??????? ??????. ??????? ?????? ????????????? ??? ??????? ?????? 
-      ??? ????? ???????????.
+      ????????? ??????? ? ????????? ?? ??????? ? ??? ? ????? ????? ?????????? ?????????
+      ? ??? ???????? ????? ????? ??????? ??????. ?????? ????????????? ??? ??????? 
+      ????? ???????????.
     <h4>???????? (hcp)</h4>
-      ??? ???????, ??????? ?? ??????????? ?? ??????? ????????, ?? ??? ?? ?????????
+      ??? ???????, ??????? ?? ????????? ???? ???????? ?? ??????? ????????, ?? ??? ?? ?????????
       ????? ?????? ? ??????? ??????? ???????, ?? ????? ?????? ????.
       ?? ??????? ?? ???????? ??-?? ???????? ? ?????????? ? ??????. ? ?????
       ??????? ???????? ?????, ??? ???????. ???????? ?????????? ?? 
@@ -22,7 +22,7 @@
     <h4>???????? ????????</h4>
       ???????? ???????? ??? ????????, ??????? ?????????????? ??? ???? ???????, ??????? ????? ?????.
       ????????????? 10% ?????????? ??????? ??????? ? ??????
-      ? ?????? ??????????? ??????? ???????. ???? ?????? ????????? ?????????
+      ? ?????? ??????????? ??????? ???????. ???? ?????? ????????? ?????????
       ????? ?????????????? ??? ????????? ??????? ? ?????? ????????????? ???????????? ???????. ??
       ?????????? ????????? ?????? ??? ???????? ????? ?????? ???????.
   </div>

Modified: homepage/input/support_ru.html
===================================================================
--- homepage/input/support_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/support_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -8,13 +8,13 @@
 ???? ?????????? ?????? ? ?????????????? ??????, ? ?????? ??????? ???????? ?? ????? ?????? ??????.</p>
 
 <ul>
-  <li><a href="$$support$$#documentation">????????????</a> - ????? ????? ?????????? ?????? - ??????? ??????.</li>
-  <li><a href="$$faq$$">FAQ</a> - ????? ?????????? ??????? (? ?????? ?? ???).</li>
-  <li><a href="$$support$$#forum">?????</a> - ???????? Enigma ? ??????? ??????????????.</li>
-  <li><a href="$$support$$#score">??????????? ?????</a> - ???????? ???? ???? ? ??????.</li>
-  <li><a href="$$statistics$$">?????????? ?????</a> - ?????????? ??? ??????? ? Enigma ?? ? ??? ?????????.</li>
-  <li><a href="$$support$$#bug">????????? ?? ??????</a> - ??? ???????? ?? ???????.</li>
-  <li><a href="$$support$$#donation">??????</a> - ??? ?????????? ?????????? Enigma.</li>
+  <li><a href="$$support$$#documentation">????????????</a> - ????? ????? ?????????? ?????? - ??????? ??????</li>
+  <li><a href="$$faq$$">FAQ</a> - ????? ?????????? ??????? (? ?????? ?? ???)</li>
+  <li><a href="$$support$$#forum">?????</a> - ???????? Enigma ? ??????? ??????????????</li>
+  <li><a href="$$support$$#score">??????????? ?????</a> - ???????? ???? ???? ? ??????</li>
+  <li><a href="$$statistics$$">?????????? ?????</a> - ?????????? ??? ??????? ? Enigma ?? ? ??? ?????????</li>
+  <li><a href="$$support$$#bug">????????? ?? ??????</a> - ??? ???????? ?? ???????</li>
+  <li><a href="$$support$$#donation">??????</a> - ??? ?????????? ?????????? Enigma</li>
 </ul>
 
   <p>?????? ?????? ???????? ?????!</p>
@@ -46,7 +46,7 @@
   </ul>
 
   <p>? ?????????? ?? ?????????? ?????????? ???????????, ??????? ????? ???????? ? ????? Enigma.
-  ????????? ????????????? ? ??? ???????????? ????? ??????? ?? ?????? ??? ??????? ?????????????
+  ????????? ????????????? ? ??? ???????????? ????? ??????? ?? ?????? ??? ??????? ?????????????
   ? ?????????????.</p>
   <ul> <!-- keep space in first li entry - IE needs it -->
     <li> <img src="$$imagedir$$/flags25x15/gb.png" border="0" width="25" height="15" alt="English" title="English">&nbsp;&nbsp;
@@ -91,11 +91,11 @@
   ???? ?????? ??????????, ????? ?????? ???????? ????????????? ? ??????? ? ?????? ??????
   '?????? ??????'.</p>
 
-  <p>??? ??????? ??????? ?????????? ??? ????????????? ? ???? ????????. ?????????? ????????? ?
+  <p>??? ??????? ??????? ?????????? ??? ???????????? ? ???? ????????. ?????????? ????????? ?
   <a href="$$statistics$$#userlist">?????? ?????????????</a> ?? ???????????? ?? ???? ??????? ???
   ???-?? ??????.</p>
 
-  <p>??? ??????????? ????? ?????, ?????? ???????? ??? ??? ???? 'enigma.score'.
+  <p>??? ??????????? ????? ?????, ?????? ???????? ??? ??? ???? 'enigma.score'.
   ?? ????????? ? ????? '???? ????????????', ??????? Enigma ?????????? ??? ???????
   ? ??????? ???? ??????? F2. ?????????? ???????? ?????? ???? ???? ??
   <a href="mailto:score at enigma-game.org">score at enigma-game.org</a>
@@ -133,7 +133,7 @@
     <li>????? ?????? Enigma ?? ????????????</li>
     <li>??? ?? ??????? ????? ???, ??? ?????????? ???????</li>
     <li>??? ????? ?? ?????? ????? ??????</li>
-    <li>??? ????????? ???????? ??? ?? ????? ??????????????</li>
+    <li>??? ????????? ???????? ??? ?? ????? ??????????????</li>
     </ul>
   <p>???? ?? ????????? ?????????, ?????????? ??????????? ?? ????? ? ???????? ?? ?????????? ???????
   ?? ????? ????????????? ? ??????????? ????????????. ?? ?????????, ??? ????? ??????? ????? ?? - ????

Modified: homepage/input/testimonials_ru.html
===================================================================
--- homepage/input/testimonials_ru.html	2007-10-14 10:43:28 UTC (rev 904)
+++ homepage/input/testimonials_ru.html	2007-10-14 10:45:51 UTC (rev 905)
@@ -90,4 +90,16 @@
 href="http://macgameblog.com/archives/Enigma-88.html">The Mac Game Blog</a>
 </p>
 
+<p class="quote">
+&ldquo;With a nearly endless number of levels and the entire world to compete
+against, Enigma's challenges will never run out. This game has something for
+everyone, whether you are in the mood for a tough puzzle or a quick test of
+dexterity. I strongly recommend anyone who likes puzzles to download and give
+Enigma a try.&rdquo;</p>
+<p class="author">Ayhoe on <a
+href="http://www.associatedcontent.com/article/335780/enigma_classic_memory_game_meets_fastpaced.html"
+>AssociatedContent</a>
+</p>
+
+
 </div>



From ged at mail.berlios.de  Sun Oct 14 13:54:43 2007
From: ged at mail.berlios.de (ged at mail.berlios.de)
Date: Sun, 14 Oct 2007 13:54:43 +0200
Subject: [Enigma-game-svn] r906 - homepage/input/news
Message-ID: <200710141154.l9EBsheT008670@sheep.berlios.de>

Author: ged
Date: 2007-10-14 13:54:40 +0200 (Sun, 14 Oct 2007)
New Revision: 906

Added:
   homepage/input/news/news_issue24_ru.html
Log:
Homepage: add Russian news_issue24

Added: homepage/input/news/news_issue24_ru.html
===================================================================
--- homepage/input/news/news_issue24_ru.html	2007-10-14 10:45:51 UTC (rev 905)
+++ homepage/input/news/news_issue24_ru.html	2007-10-14 11:54:40 UTC (rev 906)
@@ -0,0 +1,6 @@
+<h3 class="news">
+    <span class="date">14 ??????? 2007: </span> Enigma 1.01 ??? Slackware Linux
+</h3>
+
+<p>? ????? <a href="$$download$$#stable">
+??????? ????????</a> ???????? ????? Slackware.</p>


Property changes on: homepage/input/news/news_issue24_ru.html
___________________________________________________________________
Name: svn:eol-style
   + native



From ral at mail.berlios.de  Thu Oct 18 22:45:35 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Thu, 18 Oct 2007 22:45:35 +0200
Subject: [Enigma-game-svn] r907 - in branches/eval/java/src/org/enigma_game:
	lev util
Message-ID: <200710182045.l9IKjZlY032726@sheep.berlios.de>

Author: ral
Date: 2007-10-18 22:45:33 +0200 (Thu, 18 Oct 2007)
New Revision: 907

Modified:
   branches/eval/java/src/org/enigma_game/lev/ScoreManager.java
   branches/eval/java/src/org/enigma_game/util/ScoreEvaluation.java
Log:
Evaluation:
- Level evaluation with user names from user table

Modified: branches/eval/java/src/org/enigma_game/lev/ScoreManager.java
===================================================================
--- branches/eval/java/src/org/enigma_game/lev/ScoreManager.java	2007-10-14 11:54:40 UTC (rev 906)
+++ branches/eval/java/src/org/enigma_game/lev/ScoreManager.java	2007-10-18 20:45:33 UTC (rev 907)
@@ -186,8 +186,10 @@
     
     public void checkScores(RatingManager ratingMgr, UserManager userMgr, boolean checkSec) {
         ratingMgr.clearUserScores();
+        String userId = getProperty("UserId");
         String user = getProperty("UserName");
-        String userId = getProperty("UserId");
+        if (user.equals(""))
+            user = userMgr.getValue(userId, "name");
         int numRatings = 0;
         int sumRatings = 0;
         for (int i = 0; i < levelElems.getLength(); i++) {
@@ -243,8 +245,10 @@
         isProfessional = ratingMgr.isUserProfessional(userMgr, getProperty("UserId"), checkSec);
     }
     
-    public void evaluateScores(RatingManager ratingMgr) {
+    public void evaluateScores(RatingManager ratingMgr, UserManager userMgr) {
         String user = getProperty("UserName");
+        if (user.equals(""))
+            user = userMgr.getValue(getProperty("UserId"), "name");
         for (int i = 0; i < levelElems.getLength(); i++) {
             Element e = (Element) levelElems.item(i);
             LevelScore ls = ratingMgr.getLevelScore(e.getAttribute("id"),

Modified: branches/eval/java/src/org/enigma_game/util/ScoreEvaluation.java
===================================================================
--- branches/eval/java/src/org/enigma_game/util/ScoreEvaluation.java	2007-10-14 11:54:40 UTC (rev 906)
+++ branches/eval/java/src/org/enigma_game/util/ScoreEvaluation.java	2007-10-18 20:45:33 UTC (rev 907)
@@ -44,7 +44,7 @@
                 ScoreManager scm = new ScoreManager(zin);
                 scm.checkUser(userMgr, false);
                 scm.checkScores(ratingMgr, userMgr, false);
-                scm.evaluateScores(ratingMgr);
+                scm.evaluateScores(ratingMgr, userMgr);
                 numUsers++;
             }
             



From andreasl at mail.berlios.de  Sat Oct 20 21:49:27 2007
From: andreasl at mail.berlios.de (andreasl at BerliOS)
Date: Sat, 20 Oct 2007 21:49:27 +0200
Subject: [Enigma-game-svn] r908 - trunk/data/levels/lib
Message-ID: <200710201949.l9KJnRHf000593@sheep.berlios.de>

Author: andreasl
Date: 2007-10-20 21:49:26 +0200 (Sat, 20 Oct 2007)
New Revision: 908

Modified:
   trunk/data/levels/lib/libsoko-designlist.xml
   trunk/data/levels/lib/libsoko-endphase.xml
   trunk/data/levels/lib/libsoko.xml
Log:
Sokoban:
 - Continued works on endphase:
    - algorithm "block" complete
    - algorithm "hide" complete
    - algorithm "gradients" complete
    - algorithm "magnets" complete
    - algorithm "fourswitch" complete
    - important works for algorithms "ralf" and "allcrack"
 - Internally, libsoko now uses lists of special objects,
   like a list of all ways, or all outer walls which are
   near a way. This eases endphase programming.
 - Added st-invisible as default stone for outf, s.t.
   st-chess can't jump out of the level area. st-invisible
   is removed again before endphase.
 - Small changes to some designs
Todo:
 - Complete endphase algortihms "ralf", "allcrack", "jumpyoxyds"
   and "vortex".
 - Add endphase information to the last 75 designs
 - externaldata-support in C++


Modified: trunk/data/levels/lib/libsoko-designlist.xml
===================================================================
--- trunk/data/levels/lib/libsoko-designlist.xml	2007-10-18 20:45:33 UTC (rev 907)
+++ trunk/data/levels/lib/libsoko-designlist.xml	2007-10-20 19:49:26 UTC (rev 908)
@@ -52,34 +52,62 @@
 --
 --   [5] = { outf = "fl-leaves", inf = "fl-leavesb", box = "st-wood"
 --           wall = {"st-glass", "fl-wood", "fl-leaves", "al:random"},
---           oxyd = "a", white = true }
+--           oxyd = "a", white = true,
+--           endp = {goal = {"fl-abyss", "it-none"}, give = "it-hammer",
+--                   alg = "block:st-break_acwhite"}}
 --
 --   will define design 5. The walls will alternate between
 --   st-glass/fl-wood and st-glass/fl-leaves. The goal will be
 --   it-trigger by default. The actor will be ac-whiteball.
+--   The boxes will be "st-wood". There will be oxyds visible
+--   from the beginning, but they are blocked by st-break_acwhite.
+--   When all goals are filled, the st-wood are removed by setting
+--   fl-abyss (by which they become fl-stwood), the goal-item is
+--   removed. The player is finally given an it-hammer.
 --
 -- Possible flags:
 --
 --   white  : Use white marble and st-chess_white.
 --
--- Algorithms:
+-- Design-Algorithms:
 --
 --   checkerboard : default, up to 3 different floors in checkerboard pattern
 --   lines : arbitrary number of floors in diagonal lines
 --   waves : works best with 4 different floors
 --   random : arbitrary number of floors, randomly chosen
 --
-
+-- Endphase-Algorithms and their parameters:
+--
+--   circle         : arrange eight oxyds in a circle (default)
+--   hide           : position oxyds in the outer walls
+--     gradients:X  : like hide, create gradients, with force X
+--     magnets:X    : like hide, create magnets, with force X
+--   fourswitch     : create a fourswitch-puzzle
+--   ralf           : arrange oxyds with doors
+--     vortex       : like ralf, create vortices between way-clusters
+--     allcrack     : like ralf, create cracks everywhere
+--     jumpyoxyds   : like ralf, oxyds are movable by knocking on the door
+--   block:X        : create oxyds with blocking object X
+--   outside:X      : create X oxyd-pairs in the outside and outer walls
+  
 default_design = {
   wall = { "st-rock3", "fl-leaves" },
    inf = { "fl-wood" },
-  outf = { "fl-water", "st-invisible" },
+  outf = { "fl-water" },
    box = { "st-brownie" },
   goal = { "it-trigger" },
   oxyd = "a",
-  endp = { alg = "circle" }
+  endp = { alg = "circle" },
+  outf_default_stone = "st-invisible"
 }
 
+-- outf_default_stone has the following meaning: When outf is drawn
+-- by set_element, but no stone is set, outf_default_stone is used
+-- instead. You can suppress this behaviour by explicitly setting
+-- outf = { "fl-myfloor", "st-none" }.
+-- This is done to avoid a chess-stone from jumping into the void,
+-- as a present to the gamer.
+
 design_list = {
 
 -- endp-algs: circle, ralf, hide, outside, allcrack, block, fourswitch
@@ -101,7 +129,7 @@
      endp={goal="st-none", wall={"st-none", "fl-bluegray"}, alg="outside"}},
 [5]={box="st-wood", wall="st-bluegray", inf="fl-white",
      outf="fl-space", door="st-door_c", oxyd="c",
-     endp={goal={"fl-abyss", "it-none"}, wall={"st-bluegray_hole"}, alg="outside"}},
+     endp={goal={"fl-abyss", "it-none"}, wall={"st-bluegray_hole"}, alg="outside:3"}},
 [6]={box="st-greenbrown_move", wall="st-bluegray", inf="fl-white",
      outf="fl-space", door="st-door_b", oxyd="c",
      endp={goal="st-greenbrown_hole", wall="st-thief", give="it-sword",
@@ -185,7 +213,7 @@
       endp={goal={"fl-abyss", "it-none"}, give="it-hammer", alg="block:st-stone_break"}},
 [31]={box="st-glass_move", wall="st-likeoxydc-open", inf="fl-tigris",
       outf="fl-space", door="st-door_b", oxyd="a",
-      endp={wall="st-grate1", give="it-cherry", alg="outside"}},
+      endp={wall="st-grate1", give="it-cherry", alg="outside:3"}},
 
 [32]={box="st-block", wall="st-metal", inf="fl-bluegray",
       outf="fl-space", door="st-blocker", oxyd="d",
@@ -218,14 +246,14 @@
 [41]={box="st-brownie", wall="st-rock1", inf="fl-rough",
       outf="fl-space", door="st-door_a", oxyd="c",
       endp={goal={"st-none", "it-none", "fl-hay"}, wall="st-rock1_hole",
-            alg="outside"}},
+            alg="outside:3"}},
 [42]={box="st-greenbrown_move", wall="st-rock1", inf="fl-rough",
       outf="fl-sahara", door="st-door_b", oxyd="c",
       endp={goal="st-greenbrown", alg="vortex"}},
 
 [43]={box="st-brownie", wall="st-rock3", inf="fl-leaves",
       outf="fl-space", door="st-door_a", oxyd="a",
-      endp={goal="st-rock3_hole", wall="st-rock3_hole", alg="outside"}},
+      endp={goal="st-rock3_hole", wall="st-rock3_hole", alg="outside:3"}},
 [44]={box="st-marble_move", wall="st-rock3", inf="fl-leaves",
       outf="fl-rough-blue", door="st-door_b", oxyd="b",
       endp={"st-marble_hole", alg="ralf"}},
@@ -424,7 +452,9 @@
        outf={"fl-abyss", "st-grate1", "st-none", "st-none", "st-none", "st-none", "st-none", "st-none",
        "st-none", "st-none", "st-none", "st-none", "al:random"}, door="st-door_a", oxyd="c", white = true},
 [147]={box="st-wood", wall="st-whiteballs", inf="fl-gray", white = true,
-       outf={"fl-gradient5", "fl-gradient6", "fl-gradient7", "fl-gradient8", "al:waves"}, door="st-door_a", oxyd="a"},
+       outf={"fl-gradient5", "fl-gradient6", "fl-gradient7", "fl-gradient8", "al:waves"},
+       door="st-door_a", oxyd="a",
+       endp={goal={"st-none", "it-none"}, alg="gradients"}},
 [148]={box="st-shogun-s", wall="st-metal", inf="fl-rough-blue", white = true,
        outf={"fl-rough-red", "fl-rough-blue", "st-disco-light"}, door="st-door_a", oxyd="a"},
 [149]={box="st-shogun-s", wall="st-yellow", inf="fl-wood", outf="fl-swamp", door="st-door_a",

Modified: trunk/data/levels/lib/libsoko-endphase.xml
===================================================================
--- trunk/data/levels/lib/libsoko-endphase.xml	2007-10-18 20:45:33 UTC (rev 907)
+++ trunk/data/levels/lib/libsoko-endphase.xml	2007-10-20 19:49:26 UTC (rev 908)
@@ -27,24 +27,34 @@
 
 function goal_trigger(onoff, sender)
   local x, y = enigma.GetPos(sender)
-  local nr = enigma.GetAttrib(sender, "sokoarea")
+  local nr = enigma.GetAttrib(sender, "_sokoarea")
   local more_boxes = false  -- memorizes whether a box was added or removed
   if sokoarea[nr].endphase_started then
     return
   end
-  if(enigma.GetAttrib(sender, "box") == 0) then
+
+  -- A new stone? Or has a stone been removed?
+  if(enigma.GetAttrib(sender, "_box") == 0) then
     if enigma.GetStone(x,y) then
-      enigma.SetAttrib(sender, "box", 1)
+      enigma.SetAttrib(sender, "_box", 1)
       sokoarea[nr].goals_filled = sokoarea[nr].goals_filled + 1
+      more_boxes = true
+    else
+      -- blind alarm, probably a marble
+      return
     end
   else
-    enigma.SetAttrib(sender, "box", 0)
+    enigma.SetAttrib(sender, "_box", 0)
     sokoarea[nr].goals_filled = sokoarea[nr].goals_filled - 1
   end
+  
+  -- Call goal_hook, e.g. for algorithms "ralf" and "allcrack".
   if type(goal_hook) == "function" then
     goal_hook(nr, sender, more_boxes, sokoarea[nr].goals_filled,
               sokoarea[nr].number_goals)
   end
+  
+  -- Start endphase?
   if sokoarea[nr].goals_filled == sokoarea[nr].number_goals then
     sokoarea[nr].endphase_started = true
     if type(sokoarea[nr].endphase_hook) == "function" then
@@ -56,6 +66,10 @@
 end
 
 function prepare_endphase(sokoarea_number)
+  -- ensure existence of goals
+  if sokoarea[1].number_goals < 1 then
+    myerror("No goals defined!\n")
+  end
   -- ensure a correctly set endphase-attribute
   local endp = sokoarea[sokoarea_number].design.endp
   if not endp then
@@ -90,13 +104,15 @@
     -- nothing to prepare
   elseif (alg == "ralf")
       or (alg == "allcrack") then
-    endphase_set_block_oxyds(sokoarea_number, endp.door)
+    endphase_set_block_oxyds(sokoarea_number, sokoarea[sokoarea_number].design.door)
+    goal_hook = endphase_goal_hook_ralf
   elseif alg == "block" then
     endphase_set_block_oxyds(sokoarea_number, param)
   elseif (alg == "outside") then
-    endphase_set_outside_oxyds(sokoarea_number)
+    endphase_set_outside_oxyds(sokoarea_number, param)
   elseif alg == "jumpyoxyds" then
     endphase_set_block_oxyds(sokoarea_number, "jumpy")
+    goal_hook = endphase_goal_hook_ralf
   else
     mywarning("Endphase algorithm "..alg.." unknown! Will use 'circle' instead.")
   end
@@ -144,26 +160,25 @@
 
   if alg == "circle" then
     endphase_circle(sokoarea_number)
-  elseif alg == "ralf" then
-  
   elseif alg == "hide" then
-  
-  elseif alg == "outside" then
-  
+    endphase_set_hide_oxyds(sokoarea_number)  
+  elseif    (alg == "ralf")
+         or (alg == "outside")
+         or (alg == "block")
+         or (alg == "jumpyoxyds") then
+    endphase_ralf_open_doors(sokoarea_number)
   elseif alg == "allcrack" then
-  
-  elseif alg == "block" then
-    -- done in prepare_endphase
+    endphase_allcrack(sokoarea_number)
   elseif alg == "fourswitch" then
-  
+    endphase_fourswitch(sokoarea_number)
   elseif alg == "vortex" then
-  
+    -- ?
   elseif alg == "gradients" then
-  
+    endphase_set_hide_oxyds(sokoarea_number)
+    endphase_gradients(sokoarea_number, param)
   elseif alg == "magnets" then
-  
-  elseif alg == "jumpyoxyds" then
-
+    endphase_set_hide_oxyds(sokoarea_number)
+    endphase_magnets(sokoarea_number, param)
   else
     -- use default: "circle"
     endphase_circle(sokoarea_number)
@@ -175,29 +190,18 @@
   local endp = sokoarea[nr].design.endp
   local dx = sokoarea[nr].offset.x
   local dy = sokoarea[nr].offset.y
-  local mx = sokoarea[nr].array_width
-  local my = sokoarea[nr].array_height
 
-  -- If level_width and level_height are set, the level has been drawn
-  -- by create_sokoball. Hence we have to redraw everything outside
-  -- the level_array-area as well:
-  if endp.outf and sokoarea[nr].level_width and sokoarea[nr].level_height then
-    for x = 0, sokoarea[nr].level_width - 1 do
-      for y = 0, sokoarea[nr].level_height - 1 do
-        if (x < dx) or (x > mx+dx-1) or (y < dy) or (y > my+dy-1) then
-          set_element(x, y, nr, k, endp.outf)
-        end
-      end
-    end
-  end  
+  -- redraw outside
+  for p, v in pairs(sokoarea[nr].list_outside) do
+    set_element(v.lx, v.ly, nr, k, endp.outf)
+  end
 
-  -- Now redraw the area inside level_array:
-  for y = 0, my - 1 do
-    for x = 0, mx - 1 do
+  -- redraw the rest inside level_array:
+  for y = 0, sokoarea[nr].array_height - 1 do
+    for x = 0, sokoarea[nr].array_width - 1 do
       local ch = sokoarea[nr].level_array[y+1][x+1]
       for k, v in pairs(endp) do
-        if    ((k == "outf") and char_is_outf(ch))
-           or ((k == "inf")  and char_is_inf(ch))
+        if    ((k == "inf")  and char_is_inf(ch))
            or ((k == "wall") and char_is_wall(ch))
            or ((k == "goal") and char_is_goal(ch)) then
           set_element(x+dx, y+dy, nr, k, v)
@@ -244,7 +248,11 @@
   oxyd_shuffle()
 end
 
-function endphase_set_outside_oxyds(sokoarea_number)
+-- endphase_set_outside_oxyds distributes oxyds over the outside and
+-- wall_two-area of the level. There will be 2 to 5 pairs of oxyds
+-- depending on the amount of space. PARAM may define a maximal
+-- number of oxyd pairs (good for outf = "fl-space").
+function endphase_set_outside_oxyds(sokoarea_number, param)
   local places = {}
   local nr = sokoarea_number or 1
   local dx = sokoarea[nr].offset.x
@@ -253,118 +261,288 @@
   local my = sokoarea[nr].array_height
   local flavor = sokoarea[nr].design.oxyd or "b"
 
-  -- If level_width and level_height are set, there are more
-  -- oxyds possible than level_array alone would allow:
-  if sokoarea[nr].level_width and sokoarea[nr].level_height then
-    for x = 0, sokoarea[nr].level_width - 1 do
-      for y = 0, sokoarea[nr].level_height - 1 do
-        if (x < dx) or (x > mx+dx-1) or (y < dy) or (y > my+dy-1) then
-          table.insert(places, {x=x, y=y})
-        end
-      end
+  for p, v in pairs(combine_tables({sokoarea[nr].list_outside,
+                                    sokoarea[nr].list_wall_two})) do
+    if (mod(v.lx, 2) == 0) and (mod(v.ly, 2) == 0) then
+      table.insert(places, v)
     end
-  end  
+  end
 
-  -- Now outf-tiles inside level_array and far-away wall-tiles:
-  for y = 0, my - 1 do
-    for x = 0, mx - 1 do
-      local ch = sokoarea[nr].level_array[y+1][x+1]
-      if     char_is_outf(ch) 
-         or (char_is_wall(ch) and no_way_near(x+1, y+1, nr)) then
-        table.insert(places, {x=x+dx, y=y+dy})
+  -- Choose some appropriate subset
+  local max = table.getn(places)
+  local number_pairs = 2
+  if max < 2 then
+    -- Not enough places? Then choose corners of level_array.
+    -- They should always be at least wall_two and far enough
+    -- away from each other.
+    places = { {lx = dx,           ly = dy},
+               {lx = dx + mx - 1,  ly = dy},
+               {lx = dx,           ly = dy + my - 1},
+               {lx = dx + mx - 1,  ly = dy + my - 1} }
+  else
+        if max <  50 then  number_pairs = 3
+    elseif max < 100 then  number_pairs = 4
+    else                   number_pairs = 5  end
+  end
+  if (type(param) ~= "nil") and (param ~= "") then
+    local max_pairs = tonumber(param)
+    if max_pairs >= 2 then
+      number_pairs = math.min(max_pairs, number_pairs)
+    end    
+  end
+
+  shuffle_table(places)
+
+  for j = 1, number_pairs do
+    oxyd(places[2*j-1].lx, places[2*j-1].ly, flavor, j - 1)
+    oxyd(places[2*j].lx, places[2*j].ly, flavor, j - 1)
+  end
+  oxyd_shuffle()
+end
+
+function endphase_set_block_oxyds(sokoarea_number, blocker)
+  local places = {}
+  local nr = sokoarea_number or 1
+  local flavor = sokoarea[nr].design.oxyd or "b"
+
+  -- add all wall_two-elements with their wall_one.count == 1
+  for p, v in pairs(sokoarea[nr].list_wall_two) do
+    local entry = {lx = v.lx, ly = v.ly, ax = v.ax, ay = v.ay, wall_one = {}}
+    for q, w in pairs(v.wall_one) do
+      if w.count == 1 then
+        table.insert(entry.wall_one, w)
       end
     end
+    if table.getn(entry.wall_one) ~= 0 then
+      table.insert(places, entry)
+    end
   end
 
   -- Choose some appropriate subset
   local max = table.getn(places)
-  local number_pairs = 0
+  local number_pairs = 2
   if max < 2 then
-    myerror("Not enough free places outside. This can't happen?!")
-  elseif max <   4 then  number_pairs = 1
-  else                   number_pairs = 2  end
-  --elseif max <   8 then  number_pairs = 2
-  --elseif max <  30 then  number_pairs = 3
-  --elseif max <  50 then  number_pairs = 4
-  --elseif max <  80 then  number_pairs = 5
-  --elseif max < 120 then  number_pairs = 6
-  --elseif max < 180 then  number_pairs = 7
-  --else                   number_pairs = 8  end
-  for j = 1, max do
-    places[j].sort_field = math.random()
+    -- Not enough places? Then choose corners of level_array.
+    -- They should always be at least wall_two and far enough
+    -- away from each other.
+    places = { {lx = dx,           ly = dy},
+               {lx = dx + mx - 1,  ly = dy},
+               {lx = dx,           ly = dy + my - 1},
+               {lx = dx + mx - 1,  ly = dy + my - 1} }
+  else
+        if max <  50 then  number_pairs = 3
+    elseif max < 100 then  number_pairs = 4
+    else                   number_pairs = 5  end
   end
-  table.sort(places, function (a, b) return a.sort_field < b.sort_field end)
-  for j = 1, number_pairs do
-    oxyd(places[2*j-1].x, places[2*j-1].y, flavor, j)
-    oxyd(places[2*j].x, places[2*j].y, flavor, j)
+  if (type(param) ~= "nil") and (param ~= "") then
+    local max_pairs = tonumber(param)
+    if max_pairs >= 2 then
+      number_pairs = math.min(max_pairs, number_pairs)
+    end    
   end
+
+  shuffle_table(places)
+  sokoarea[sokoarea_number].list_oxyds = {}
+
+  function set_block(p)
+    --for q, w in pairs(places[p].wall_one) do
+    local w = places[p].wall_one[1]
+    set_element(w.lx, w.ly, sokoarea_number, "inf")
+    set_stone(blocker, w.lx, w.ly)
+    --end
+  end
+  for j = 1, number_pairs do   -- Testlevel: 14
+    oxyd(places[2*j-1].lx, places[2*j-1].ly, flavor, j - 1)
+    oxyd(places[2*j].lx, places[2*j].ly, flavor, j - 1)
+    set_block(2*j-1)
+    set_block(2*j)
+    table.insert(sokoarea[sokoarea_number].list_oxyds, places[2*j-1])
+    table.insert(sokoarea[sokoarea_number].list_oxyds, places[2*j])
+  end
   oxyd_shuffle()
 end
 
-function endphase_set_block_oxyds(sokoarea_number, blocker)
+-- endphase_set_hide_oxyds distributes oxyds over the wall_one-walls.
+function endphase_set_hide_oxyds(sokoarea_number)
+  local flavor = sokoarea[sokoarea_number].design.oxyd or "b"
+  local places = {}
+  
+  -- add all wall_one-elements
+  for p, v in pairs(sokoarea[sokoarea_number].list_wall_one) do
+    table.insert(places, v)
+  end
 
-  if 1 + 1 == 2 then return end
+  shuffle_table(places)
   
+  -- choose number of oxyds
+  local max = table.getn(places)
+  local number_pairs = 1
+  if max < 2 then
+    -- use circle instead
+    endphase_circle(sokoarea)
+  elseif max <  6  then  number_pairs = 2
+  elseif max < 10  then  number_pairs = 3
+  elseif max < 30  then  number_pairs = 4
+  else                   number_pairs = 5 end
+  
+  -- set oxyds
+  for j = 1, number_pairs do
+    oxyd(places[2*j-1].lx, places[2*j-1].ly, flavor, j - 1)
+    oxyd(places[2*j].lx, places[2*j].ly, flavor, j - 1)
+  end
+  oxyd_shuffle()  
+end
+
+function endphase_gradients(sokoarea_number, param)
+  local force = tonumber(param) or 25.0
+  for p, v in pairs(sokoarea[sokoarea_number].list_way) do
+    local grad_type = random(1,12)
+    set_floor("fl-gradient", v.lx, v.ly, {type = grad_type, force = force})
+  end
+end
+
+function endphase_magnets(sokoarea_number, param)
+  local force = tonumber(param) or 50.0
   local places = {}
   local nr = sokoarea_number or 1
-  local dx = sokoarea[nr].offset.x
-  local dy = sokoarea[nr].offset.y
-  local mx = sokoarea[nr].array_width
-  local my = sokoarea[nr].array_height
   local flavor = sokoarea[nr].design.oxyd or "b"
 
-  -- If level_width and level_height are set, there are more
-  -- oxyds possible than level_array alone would allow:
-  if sokoarea[nr].level_width and sokoarea[nr].level_height then
-    for x = 0, sokoarea[nr].level_width - 1 do
-      for y = 0, sokoarea[nr].level_height - 1 do
-        local pos = one_tile_far_from_way(x+dx, y+dy, nr)
-        if pos then
-          table.insert(places, {x=x, y=y, door_x=pos.x, door_y=pos.y})
-          --set_stone("st-pull", x, y)
-          --set_floor("fl-red", pos.x, pos.y)
+  -- add all way-elements which are not goals
+  for p, v in pairs(sokoarea[nr].list_way) do
+    if not char_is_goal(sokoarea[nr].level_array[v.ay][v.ax]) then
+      table.insert(places, v)
+    end
+  end
+
+  shuffle_table(places)
+
+  -- choose number of magnets
+  local number_magnets = math.floor(table.getn(places)/6)
+
+  -- set magnets
+  for j = 1, number_magnets do
+    set_item("it-magnet-on", places[j].lx, places[j].ly,
+             {range = 5, strength = force})
+  end
+end
+
+function endphase_fourswitch(sokoarea_number)
+  local flavor = sokoarea[sokoarea_number].design.oxyd or "b"
+  local places = {}
+
+  -- add all wall_one-elements
+  for p, v in pairs(sokoarea[sokoarea_number].list_wall_one) do
+    table.insert(places, v)
+  end
+
+  shuffle_table(places)
+
+  -- choose number of fourswitchs/oxyds
+  local max = table.getn(places)
+  local number_pairs = 1
+  if max < 2 then
+    -- use circle instead
+    endphase_circle(sokoarea)
+  elseif max <  6  then  number_pairs = 2
+  elseif max < 10  then  number_pairs = 3
+  else                   number_pairs = 4 end
+
+  function endphase_call_fourswitch(onoff, sender)
+    local j = enigma.GetAttrib(sender, "_number")
+    places[j].current = places[j].current + 1
+    if places[j].current == 5 then
+      places[j].current = 1
+    end
+    if places[j].current == places[j].solve then
+      places[j].correct = true
+      set_stone("st-likeoxyda-open", places[j].lx, places[j].ly,
+          {_number=0})
+    end
+
+    if j ~= 1 then
+      -- Trigger all lower fourswitchs
+      local x = places[j-1].lx
+      local y = places[j-1].ly
+      if places[j-1].correct then
+        -- reset the fourswitch
+        mystone = set_stone("st-fourswitch", x, y, {_number = j - 1})
+        for k = 1, places[j-1].current do
+          SendMessage(mystone, "trigger")
         end
+        enigma.SetAttrib(mystone, "action", "callback")
+        enigma.SetAttrib(mystone, "target", "endphase_call_fourswitch")
+        places[j-1].correct = false
       end
-    end
-  else
-    for y = 0, my - 1 do
-      for x = 0, mx - 1 do
-        local pos = one_tile_far_from_way(x+dx, y+dy, nr)
-        if pos then
-          table.insert(places, {x=x, y=y, door_x=pos.x, door_y=pos.y})
-          --set_stone("st-pull", x, y)
-          --set_floor("fl-red", pos.x, pos.y)
+      SendMessage(enigma.GetStone(x, y), "trigger")
+    else
+      -- Check all fourswitchs
+      local correct = true
+      for k = 1, 2*number_pairs do
+        correct = correct and places[k].correct
+      end
+      if correct then
+        -- replace fourswitchs by oxyds
+        for k = 1, number_pairs do
+          oxyd(places[2*k-1].lx, places[2*k-1].ly, flavor, k - 1)
+          oxyd(places[2*k].lx, places[2*k].ly, flavor, k - 1)
         end
+        oxyd_shuffle()
       end
     end  
   end
+  
+  -- set fourswitchs
+  for j = 1, 2*number_pairs do
+    set_stone("st-fourswitch", places[j].lx, places[j].ly,
+        {action="callback", target="endphase_call_fourswitch", _number=j})
+    places[j].current = 4
+    places[j].solve = random(1,4)
+    places[j].correct = false
+  end
+  oxyd_shuffle()  
+end
 
+function endphase_allcrack(sokoarea_number)
+  for p, v in pairs(sokoarea[sokoarea_number].list_way) do
+    if not enigma.GetItem(v.lx, v.ly) then
+      set_item("it-crack3", v.lx, v.ly)
+    end
+  end  
+end
 
-  -- Choose some appropriate subset
-  local max = table.getn(places)
-  local number_pairs = 0
-  if max < 2 then
-    myerror("Not enough free places outside. This can't happen?!")
-  elseif max <   4 then  number_pairs = 1
-  else                   number_pairs = 2  end
-  --elseif max <   8 then  number_pairs = 2
-  --elseif max <  30 then  number_pairs = 3
-  --elseif max <  50 then  number_pairs = 4
-  --elseif max <  80 then  number_pairs = 5
-  --elseif max < 120 then  number_pairs = 6
-  --elseif max < 180 then  number_pairs = 7
-  --else                   number_pairs = 8  end
-  for j = 1, max do
-    places[j].sort_field = math.random()
+function endphase_goal_hook_ralf(sokoarea_number, sender, more_boxes,
+    goals_filled, number_goals)
+  -- verify correct sokoarea-number and existence of "list_oxyds"
+  if sokoarea_number ~= enigma.GetAttrib(sender, "_sokoarea") then
+    myerror("libsoko: Inconsistent sokoarea numbers in goal hook!")
   end
-  table.sort(places, function (a, b) return a.sort_field < b.sort_field end)
-  for j = 1, number_pairs do
-    oxyd(places[2*j-1].x, places[2*j-1].y, flavor, j)
-    oxyd(places[2*j].x, places[2*j].y, flavor, j)
+  if type(sokoarea[sokoarea_number].list_oxyds) ~= "table" then
+    myerror("libsoko: Oxyd list is missing during goal hook!")
   end
-  oxyd_shuffle()
+  -- identify the corresponding door and open it
+  local goal_number = enigma.GetAttrib(sender, "_goal_number")
+  local number_oxyds = table.getn(sokoarea[sokoarea_number].list_oxyds)
+  if (goal_number ~= 1) and (goal_number <= number_oxyds) then  
+    local oxyd_entry = sokoarea[sokoarea_number].list_oxyds[goal_number]
+    local door_x = oxyd_entry.wall_one[1].lx
+    local door_y = oxyd_entry.wall_one[1].ly
+    local st = enigma.GetStone(door_x, door_y)
+    if more_boxes then
+      SendMessage(st, "open")
+    else
+      SendMessage(st, "close")
+    end
+  end
 end
 
+function endphase_ralf_open_doors(sokoarea_number)
+  for j, v in pairs(sokoarea[sokoarea_number].list_oxyds) do
+    local door_x = v.wall_one[1].lx
+    local door_y = v.wall_one[1].ly
+    SendMessage(enigma.GetStone(door_x, door_y), "open")
+  end
+end
+    
     ]]></el:luamain>
     <el:i18n>
     </el:i18n>

Modified: trunk/data/levels/lib/libsoko.xml
===================================================================
--- trunk/data/levels/lib/libsoko.xml	2007-10-18 20:45:33 UTC (rev 907)
+++ trunk/data/levels/lib/libsoko.xml	2007-10-20 19:49:26 UTC (rev 908)
@@ -61,14 +61,17 @@
 -- However, you can call endphase(sokoarea_number) yourself if neccessary.
 --
 --       list_outside - list of positions of outf-tiles
+--          list_wall - list of all walls
 --           list_way - list of all inside positions that the marble
---                      can reach on level-end
+--                      can reach on level-end (incl. goals)
 --      list_wall_one - list of outer walls near ways
---      list_wall_two - list of outer walls one tile away from ways,
---                      together with a list of neighboring wall_ones.
+--      list_wall_two - list of outer walls or outf one tile away from
+--                      ways, together with a list of neighboring wall_ones.
 --
--- Each list entry is a table: Entries x and y are absolute positions,
--- lx and ly are positions in the level_array, if existent (nil else).
+-- Each list entry is a table: Entries lx and ly are absolute positions
+-- ("level"), ax and ay are positions in the level_array, if existent
+-- (nil else). Some endphases also use list_oxyds as additional data
+-- structure.
 
 sokoarea = {}
 
@@ -122,6 +125,15 @@
   return result
 end
 
+-- shuffle_table resorts the table T randomly. Note that T has to be
+-- indexed with integers from 1 to table.getn(T). Type is not checked.
+function shuffle_table(t)
+  for p, v in pairs(t) do
+    t[p].sort_field = math.random()
+  end
+  table.sort(t, function (a, b) return a.sort_field < b.sort_field end)
+end
+
 -- choose_among_multiples selects a number between 1 and COUNT
 -- based on the coordinates X and Y and the algorithm's name ALG.
 function choose_among_multiples(x, y, count, alg)
@@ -206,6 +218,130 @@
   return false
 end
 
+-- create_lists creates the special lists list_outside, list_wall,
+-- list_way, list_wall_one and list_wall_two for SOKOAREA_NUMBER.
+function create_lists(sokoarea_number)
+  local nr = sokoarea_number or 1
+  local dx = sokoarea[nr].offset.x
+  local dy = sokoarea[nr].offset.y
+  local mx = sokoarea[nr].array_width
+  local my = sokoarea[nr].array_height
+  sokoarea[nr].list_outside = {}
+  sokoarea[nr].list_way = {}
+  sokoarea[nr].list_wall_one = {}
+  sokoarea[nr].list_wall_two = {}
+  -- list_way, list_wall and list_outside (inside level_array)
+  for x = 0, mx - 1 do
+    for y = 0, my - 1 do
+      local ch = sokoarea[nr].level_array[y+1][x+1]
+      local entry = {lx = x+dx, ly = y+dy, ax = x+1, ay = y+1}
+      if char_is_outf(ch) then
+        sokoarea[nr].list_outside[(x+dx).."/"..(y+dy)] = entry
+      elseif char_is_wall(ch) then
+        sokoarea[nr].list_wall[(x+dx).."/"..(y+dy)] = entry
+      else
+        sokoarea[nr].list_way[(x+dx).."/"..(y+dy)] = entry
+      end        
+    end
+  end
+  -- list_outside (outside level_array)
+  if sokoarea[nr].level_width and sokoarea[nr].level_height then
+    for x = 0, sokoarea[nr].level_width - 1 do
+      for y = 0, sokoarea[nr].level_height - 1 do
+        if (x < dx) or (x > mx+dx-1) or (y < dy) or (y > my+dy-1) then
+          sokoarea[nr].list_outside[x.."/"..y] = {lx = x, ly = y}
+        end
+      end
+    end
+  end
+  -- list_wall_one
+  -- There are three conditions for an element of list_wall_one:
+  -- (i) it's a wall, (ii) it's near or diagonal to outside,
+  -- (iii) it's near a way.
+  -- In addition, it counts the number of near ways.
+  for p, v in pairs(sokoarea[nr].list_wall) do
+    local x = v.lx
+    local y = v.ly
+    if    sokoarea[nr].list_outside[(x-1).."/"..(y)]
+       or sokoarea[nr].list_outside[(x+1).."/"..(y)]
+       or sokoarea[nr].list_outside[(x).."/"..(y-1)]
+       or sokoarea[nr].list_outside[(x).."/"..(y+1)]
+       or sokoarea[nr].list_outside[(x+1).."/"..(y+1)]
+       or sokoarea[nr].list_outside[(x+1).."/"..(y-1)]
+       or sokoarea[nr].list_outside[(x-1).."/"..(y+1)]
+       or sokoarea[nr].list_outside[(x-1).."/"..(y-1)] then
+      local count = 0
+      if sokoarea[nr].list_way[(x-1).."/"..(y)] then  count = count + 1  end
+      if sokoarea[nr].list_way[(x+1).."/"..(y)] then  count = count + 1  end
+      if sokoarea[nr].list_way[(x).."/"..(y-1)] then  count = count + 1  end
+      if sokoarea[nr].list_way[(x).."/"..(y+1)] then  count = count + 1  end
+      if count > 0 then
+        sokoarea[nr].list_wall_one[x.."/"..y] =
+            {lx = x, ly = y, ax = v.ax, ay = v.ay, count = count}
+      end
+    end
+  end
+  -- list_wall_two
+  -- There are three conditions for an element of list_wall_two:
+  -- (i) it's near a wall_one, (ii) it's not a wall_one,
+  -- (iii) it's wall or outside. Next function checks (ii) and (iii)
+  -- and adds the checked element to the list. In addition, the
+  -- neighboring wall_one are added into the list.
+  local function check_ii_and_iii(x, y, one_x, one_y)
+    if sokoarea[nr].list_wall_one[x.."/"..y] then
+      return
+    end
+    if sokoarea[nr].list_way[x.."/"..y] then
+      return
+    end
+    if not sokoarea[nr].list_wall_two[x.."/"..y] then
+      -- create new entry
+      sokoarea[nr].list_wall_two[x.."/"..y] =
+          {lx = x, ly = y, ax = nil, ay = nil, wall_one = {}}
+    end
+    -- add the corresponding wall_one
+    local w = table.getn(sokoarea[nr].list_wall_two[x.."/"..y].wall_one) + 1
+    sokoarea[nr].list_wall_two[x.."/"..y].wall_one[w] =
+        sokoarea[nr].list_wall_one[one_x.."/"..one_y]
+  end
+  for p, v in pairs(sokoarea[nr].list_wall_one) do
+    check_ii_and_iii(v.lx+1, v.ly, v.lx, v.ly)
+    check_ii_and_iii(v.lx-1, v.ly, v.lx, v.ly)
+    check_ii_and_iii(v.lx, v.ly+1, v.lx, v.ly)
+    check_ii_and_iii(v.lx, v.ly-1, v.lx, v.ly)
+  end  
+end
+
+-- new_sokoarea initialises a new entry in the global
+-- sokoarea table and returns its number.
+function new_sokoarea()
+  sokoarea_number = table.getn(sokoarea) + 1
+  sokoarea[sokoarea_number] = {
+    level_array = {},
+    design = default_design,
+    number_goals = 0,
+    goals_filled = 0,
+    actor_count = 0,
+    endphase_started = false,
+    offset = {0, 0},
+    level_width = nil,
+    level_height = nil,
+    uses_chess = false,
+    goal_hook = nil,
+    endphase_hook = endphase,
+    list_outside = {},
+    list_wall = {},
+    list_way = {},
+    list_wall_one = {},
+    list_wall_two = {}
+  }
+  return sokoarea_number
+end
+
+------------------------------------------------------------------------
+-- Drawing Functions and Level Interpretation
+------------------------------------------------------------------------
+
 -- set_element sets element name EL_STR of area SOKOAREA_NUMBER at x, y.
 -- EL_DESIGN is optional and overrides the design of the given sokoarea.
 function set_element(x, y, sokoarea_number, el_str, el_design)
@@ -280,15 +416,16 @@
     else
       created_objects.it = set_item(itkind, x, y)
     end
-    if created_objects.it and not in_endphase then
-      enigma.SetAttrib(created_objects.it, "action", "callback")
-      enigma.SetAttrib(created_objects.it, "target", "goal_trigger")
-      enigma.SetAttrib(created_objects.it, "box", 0)
-      enigma.SetAttrib(created_objects.it, "sokoarea", sokoarea_number)
-    end
     if (el_str == "goal") and not in_endphase then
-      sokoarea[sokoarea_number].number_goals = 
-          sokoarea[sokoarea_number].number_goals + 1
+      local gn = sokoarea[sokoarea_number].number_goals + 1
+      sokoarea[sokoarea_number].number_goals = gn
+      if created_objects.it and not in_endphase then
+        enigma.SetAttrib(created_objects.it, "action", "callback")
+        enigma.SetAttrib(created_objects.it, "target", "goal_trigger")
+        enigma.SetAttrib(created_objects.it, "_box", 0)
+        enigma.SetAttrib(created_objects.it, "_sokoarea", sokoarea_number)
+        enigma.SetAttrib(created_objects.it, "_goal_number", gn)
+      end
     end
   end
   
@@ -550,27 +687,6 @@
   return trimmed_array
 end
 
--- new_sokoarea initialises a new entry in the global
--- sokoarea table and returns its number.
-function new_sokoarea()
-  sokoarea_number = table.getn(sokoarea) + 1
-  sokoarea[sokoarea_number] = {
-    level_array = {},
-    design = default_design,
-    number_goals = 0,
-    goals_filled = 0,
-    actor_count = 0,
-    endphase_started = false,
-    offset = {0, 0},
-    level_width = nil,
-    level_height = nil,
-    uses_chess = false,
-    goal_hook = nil,
-    endphase_hook = endphase
-  }
-  return sokoarea_number
-end
-
 ------------------------------------------------------------------------
 -- Choosing the Designnumber, Random numbers
 ------------------------------------------------------------------------
@@ -678,15 +794,13 @@
 --
 function number_from_level(level_array, list_length)
   local j = list_length + 1
-  local lastline = table.getn(level_array)
-  local maxwidth = table.getn(level_array[1])
-  mywarning("Calculating level design ...")
+  mydebug("Calculating number from level_array, modulus "..list_length.." ...")
   local l = 2
   repeat
     j = j - 1
     b = 0
-    for y = 1, lastline do
-      for x = 1, maxwidth do
+    for y = 1, table.getn(level_array) do
+      for x = 1, table.getn(level_array[1]) do
         if char_is_wall(level_array[y][x]) then
           if 2*b + 1 < j then
             b = 2*b + 1
@@ -729,8 +843,29 @@
   else
     myerror("Can't make sense of design type "..type(design)..".")
   end
-  -- fill chosen design with default values where neccessary, and return
-  return combine_tables({design, default_design})
+  -- fill chosen design with default values where neccessary
+  design = combine_tables({design, default_design})
+  -- No stone set for outf, not even "st-none"?
+  -- Use the default outf-stone instead, and remove it on endphase.
+  if type(design.outf) ~= "table" then
+    design.outf = {design.outf}
+  end
+  for j, v in pairs(design.outf) do
+    if is_stone(v) then
+      return design
+    end
+  end
+  table.insert(design.outf, default_design.outf_default_stone)
+  if type(design.endp.outf) ~= "table" then
+    design.endp.outf = {design.endp.outf}
+  end
+  for j, v in pairs(design.endp.outf) do
+    if is_stone(v) then
+      return design
+    end
+  end
+  table.insert(design.endp.outf, "st-none")  
+  return design
 end
 
 
@@ -776,7 +911,7 @@
   sokoarea[1].level_height = levelh
   create_world(levelw, levelh)
   
-  -- Calculate padding
+  -- calculate padding
   local dx = 0
   local dy = 0
   if levelw > sokoarea[1].array_width then
@@ -787,21 +922,20 @@
   end
   sokoarea[1].offset = {x = dx, y = dy}
 
-  sokoarea[1].design = 
-      design_from_description(design, sokoarea[1].level_array)
+  -- calculate design
+  sokoarea[1].design = design_from_description(design, sokoarea[1].level_array)
 
+  -- create special position lists
+  create_lists(nr)
+  
+  -- draw level
   for x = 0, levelw - 1 do
     for y = 0, levelh - 1 do
       set_element(x, y, 1, "outf")
     end
   end
-
   draw_level_array(1, true, true)
-
-  if sokoarea[1].number_goals < 1 then
-    myerror("No goals defined!\n")
-  end
-
+  
   -- prepare oxyds for end phase
   prepare_endphase(1)
 
@@ -823,7 +957,7 @@
   local nr = sokoarea_number or 1  
   sokoarea[nr].design =
       design_from_description(design, sokoarea[nr].level_array)
-  
+
   if sokoarea[nr].level_width and sokoarea[nr].level_height then
     for x = 0, sokoarea[nr].level_width - 1 do
       for y = 0, sokoarea[nr].level_height - 1 do
@@ -850,10 +984,6 @@
 
   draw_level_array(nr, true, false)
 
-  if sokoarea[nr].number_goals < 1 then
-    myerror("No goals defined!\n")
-  end
-
   -- prepare oxyds for end phase
   prepare_endphase(nr)
   mywarning(sokoarea[nr].design.endp.alg)
@@ -895,6 +1025,7 @@
     sokoarea[nr].endphase_hook = endphase_hook
   end
   sokoarea[nr].goal_hook = goal_hook
+  create_lists(nr)
   draw_level_array(nr, false, draw_actor)
 end
 



From ral at mail.berlios.de  Mon Oct 22 18:53:25 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Mon, 22 Oct 2007 18:53:25 +0200
Subject: [Enigma-game-svn] r909 - trunk/src
Message-ID: <200710221653.l9MGrPcc008172@sheep.berlios.de>

Author: ral
Date: 2007-10-22 18:53:16 +0200 (Mon, 22 Oct 2007)
New Revision: 909

Modified:
   trunk/src/lua.cc
Log:
Trunk 1.1: API reengineering
- add group generic for loop:  for obj in my_group do ... end
- add group request index for object:  idx = my_group[obj] with
    nil result if object is not member or my_group


Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2007-10-20 19:49:26 UTC (rev 908)
+++ trunk/src/lua.cc	2007-10-22 16:53:16 UTC (rev 909)
@@ -260,7 +260,10 @@
             if (unique.find(*it) == unique.end()) {
                 unique.insert(*it);
                 pushobject(L, *it);
-                lua_rawseti(L, -2, i);
+                lua_pushvalue(L, -1);    // second copy of object
+                lua_rawseti(L, -3, i);   // group[i] = obj
+                lua_pushinteger(L, i);
+                lua_rawset(L, -3);       // group[obj] = i
             }
         }
     }
@@ -1313,7 +1316,7 @@
     return intersectGroupBase(L, true);    
 }
 
-static int differenzGroup(lua_State *L) {
+static int differenceGroup(lua_State *L) {
     // (grp|obj) - (grp|obj)
     return intersectGroupBase(L, false);    
 }
@@ -1687,7 +1690,7 @@
 }
 
 static int initWorld(lua_State *L) {
-    // (ti|function), string, table
+    // world, (ti|function), string, table
     if (server::WorldInitialized) {
         throwLuaError(L, "World reinitialization not allowed");
         return 0;
@@ -1979,7 +1982,7 @@
 }
 
 static int dispatchGroupReadAccess(lua_State *L) {
-    if (!(lua_isnumber(L, 2) || lua_isstring(L, 2))) {
+    if (!(lua_isnumber(L, 2) || lua_isstring(L, 2) || is_object(L,2))) {
         throwLuaError(L, "Group: illegal read access");
         return 0;
     }
@@ -2004,6 +2007,10 @@
             messageLIFO.push_back(keyStr);
             lua_pushcfunction(L, groupDirectMessage);
         }
+    } else {
+        lua_getmetatable(L, 1);
+        lua_pushvalue(L, 2);   // copy last object as key
+        lua_rawget(L, -2);     // get last index        
     }
     return 1;
 }
@@ -2016,6 +2023,31 @@
     return 1;
 }
 
+static int iteratorGroup(lua_State *L) {
+    // generic for loop iterator function
+    // var_1 = _f(_s, _var) with _var == nil on first access, var_1 == nil on end
+    // on stack: group, _s, _var
+    if (!(is_group(L, 1)))
+        throwLuaError(L, "Group: iterator first arg not a group");
+    lua_getmetatable(L, 1);
+    int size = lua_objlen(L, -1);
+    if (lua_isnil(L, 3)) {   // first iterator loop access
+        if (size == 0) {     // an empty group
+            lua_pushnil(L);
+            return 1;
+        } else {
+            lua_rawgeti(L, -1, 1);  // get the first object
+            return 1;
+        }
+    } else {
+        lua_pushvalue(L, 3);   // copy last object as key
+        lua_rawget(L, -2);     // get last index
+        int i = lua_tointeger(L, -1);
+        lua_rawgeti(L, -2, ++i);  // get next object
+        return 1;
+    }
+}
+
 static CFunction globalfuncs[] = {
     {FindDataFile,          "FindDataFile"},
 //    {lua::PlaySoundGlobal,  "PlaySoundGlobal"},
@@ -2186,7 +2218,8 @@
     {lengthGroup,                   "__len"},      //  #obj
     {joinGroup,                     "__add"},      //  obj + obj
     {intersectGroup,                "__mul"},      //  obj * obj
-    {differenzGroup,                "__sub"},      //  obj - obj
+    {differenceGroup,               "__sub"},      //  obj - obj
+    {iteratorGroup,                 "__call"},
     {0,0}
 };
 



From ral at mail.berlios.de  Mon Oct 22 22:54:53 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Mon, 22 Oct 2007 22:54:53 +0200
Subject: [Enigma-game-svn] r910 - trunk/src
Message-ID: <200710222054.l9MKsrnV004237@sheep.berlios.de>

Author: ral
Date: 2007-10-22 22:54:52 +0200 (Mon, 22 Oct 2007)
New Revision: 910

Modified:
   trunk/src/Inventory.cc
   trunk/src/Inventory.hh
   trunk/src/floors.cc
   trunk/src/items.cc
   trunk/src/lua.cc
   trunk/src/objects.cc
   trunk/src/objects_decl.hh
   trunk/src/player.cc
   trunk/src/stones_simple.cc
   trunk/src/world.cc
   trunk/src/world.hh
   trunk/src/world_internal.hh
Log:
Trunk 1.1:
- GridObject pos reengineering:
  - pos represents position in world boundaries only if object is on a layer
  - items owned by bags store mirrored bag position as pos
  - items owned by player inventories store player id as pos
  - other items mark the pos as invalid -1,-1
- IsInsideLevel, IsLevelBorder speed optimized


Modified: trunk/src/Inventory.cc
===================================================================
--- trunk/src/Inventory.cc	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/Inventory.cc	2007-10-22 20:54:52 UTC (rev 910)
@@ -39,6 +39,9 @@
     ecl::delete_sequence (m_items.begin(), m_items.end());
 }
 
+void Inventory::assignOwner(int playerId) {
+    ownerId = playerId;
+}
 
 size_t Inventory::size() const
 { 
@@ -64,6 +67,7 @@
     if (idx < size()) {
         Item *it = m_items[idx];
         m_items.erase(m_items.begin()+ idx);
+        it->setOwner(-1);
         return it;
     }
     return 0;
@@ -82,6 +86,7 @@
     for (ItemList::iterator i = m_items.begin(); i != e; ++i) {
         if (*i == wanted) {
             m_items.erase(i);
+            wanted->setOwner(-1);
             return wanted;
         }
     }
@@ -112,6 +117,7 @@
     }
     else {
         m_items.insert (m_items.begin(), i);
+        i->setOwner(ownerId);
     }
 }
 
@@ -126,6 +132,7 @@
         while (m_items.size() < max_items && !ih->is_empty()) {
             Item * it = ih->yield_first();
             m_items.insert (m_items.begin(), it);
+            it->setOwner(ownerId);
         }
         return;
     }
@@ -147,12 +154,12 @@
 bool Inventory::willAddItem(Item *it) {
     ItemHolder *holder = dynamic_cast<ItemHolder*>(it);
     if (is_full()) {
-	return false;
+        return false;
     } else if (holder != NULL && holder->is_empty() &&
-	    (m_items.size() >= max_items || dynamic_cast<ItemHolder*>(get_item(0)) != NULL)) {
-	// should add a bag that is empty, but first item in Inventory is itself
-	// a bag or Inventory is full -- avoid recursive bags
-	return false;
+            (m_items.size() >= max_items || dynamic_cast<ItemHolder*>(get_item(0)) != NULL)) {
+        // should add a bag that is empty, but first item in Inventory is itself
+        // a bag or Inventory is full -- avoid recursive bags
+        return false;
     }
     return true;  // we have space and item is not critical
 }

Modified: trunk/src/Inventory.hh
===================================================================
--- trunk/src/Inventory.hh	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/Inventory.hh	2007-10-22 20:54:52 UTC (rev 910)
@@ -42,6 +42,8 @@
 
         // ---------- Methods ----------
 
+        void assignOwner(int playerId);
+        
         //! The number of items currently in the inventory
         size_t size() const;
         void clear();
@@ -50,7 +52,7 @@
         void rotate_right();
         Item *get_item (size_t idx) const;
         Item *yield_item (size_t idx);
-	bool willAddItem(Item *it);
+        bool willAddItem(Item *it);
 
         int find(const std::string& kind, size_t start_idx = 0) const;
 
@@ -61,6 +63,7 @@
         // Private variables.
         static const unsigned max_items;
         std::vector<Item*> m_items;
+        int ownerId;
     };
 }
 

Modified: trunk/src/floors.cc
===================================================================
--- trunk/src/floors.cc	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/floors.cc	2007-10-22 20:54:52 UTC (rev 910)
@@ -850,6 +850,7 @@
         CLONEOBJ(Thief);
     public:
         Thief();
+        ~Thief();
     private:
         string modelname;
         enum State { IDLE, EMERGING, RETREATING, CAPTURED } state;
@@ -865,10 +866,15 @@
     };
 }
 
-Thief::Thief() 
-: Floor("fl-thief", 2.0, 1),
-  state(IDLE), m_affected_actor (0), affected_player (-1), modelname(""), bag(NULL) { }
+Thief::Thief() : Floor("fl-thief", 2.0, 1), state(IDLE), m_affected_actor (0),
+        affected_player (-1), modelname(""), bag(NULL) {
+}
 
+Thief::~Thief() {
+    if (bag != NULL)
+        delete bag;
+}
+
 string Thief::get_modelname() {
     if(modelname == "") {
         // initialize on first call
@@ -923,18 +929,23 @@
             !m_affected_actor->has_shield()) {
         enigma::Inventory *inv = player::GetInventory(m_affected_actor);
         if (inv && inv->size() > 0) {
-            if (bag == NULL)
+            if (bag == NULL) {
                 bag = world::MakeItem(it_bag);
+                bag->setOwnerPos(get_pos());
+            }
             int i = IntegerRand (0, int (inv->size()-1));
             dynamic_cast<ItemHolder *>(bag)->add_item(inv->yield_item(i));
             player::RedrawInventory (inv);
+            didSteal = true;
         }
     }
     // steal from grid
     if(Item *it = GetItem(get_pos())) {
         if (!(it->get_traits().flags & itf_static)) {
-            if (bag == NULL)
+            if (bag == NULL) {
                 bag = world::MakeItem(it_bag);
+                bag->setOwnerPos(get_pos());                
+            }
             dynamic_cast<ItemHolder *>(bag)->add_item(world::YieldItem(get_pos())); 
             didSteal = true;
         }

Modified: trunk/src/items.cc
===================================================================
--- trunk/src/items.cc	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/items.cc	2007-10-22 20:54:52 UTC (rev 910)
@@ -3226,26 +3226,51 @@
 
     public:
         virtual Bag * clone() {
-	    ASSERT(is_empty(), XLevelRuntime, "Bag:: Clone of a full bag!");
-	    return new Bag(*this);
-	}
-	
-	virtual void dispose() {
-	    Item * it = yield_first();
-	    while (it != NULL) {
-            DisposeObject(it);
-            it = yield_first();
-	    }
-	    delete this;
-	}
-	
-	// ItemHolder interface
+            ASSERT(is_empty(), XLevelRuntime, "Bag:: Clone of a full bag!");
+            return new Bag(*this);
+        }
+
+        virtual void dispose() {
+            Item * it = yield_first();
+            while (it != NULL) {
+                DisposeObject(it);
+                it = yield_first();
+            }
+            delete this;
+        }
+
+        virtual void on_creation (GridPos p) {
+            GridObject::on_creation(p);
+            for (vector<Item *>::iterator itr = m_contents.begin(); itr != m_contents.end(); ++itr)
+                (*itr)->setOwnerPos(p);
+        }
+    
+        virtual void on_removal (GridPos p) {
+            GridObject::on_removal(p);
+            for (vector<Item *>::iterator itr = m_contents.begin(); itr != m_contents.end(); ++itr)
+                (*itr)->setOwner(-1);            
+        }
+        
+        virtual void setOwner(int player) {
+            GridObject::setOwner(player);
+            for (vector<Item *>::iterator itr = m_contents.begin(); itr != m_contents.end(); ++itr)
+                (*itr)->setOwner(player);            
+        }
+    
+        virtual void setOwnerPos(GridPos p) {
+            GridObject::setOwnerPos(p);
+            for (vector<Item *>::iterator itr = m_contents.begin(); itr != m_contents.end(); ++itr)
+                (*itr)->setOwnerPos(p);
+        }
+    	
+        // ItemHolder interface
         virtual bool is_full() const {
             return m_contents.size() >= BAGSIZE;
         }
         virtual void add_item (Item *it) {
             // thieves may add items beyond pick up limit BAGSIZE
             m_contents.insert (m_contents.begin(), it);
+            it->setOwnerPos(get_pos());  // item is at same position as bag
         }
 
         virtual bool is_empty() const {
@@ -3256,6 +3281,7 @@
             if (m_contents.size() > 0) {
                 Item *it = m_contents[0];
                 m_contents.erase (m_contents.begin());
+                it->setOwner(-1);  // no owner
                 return it;
             }
             return NULL;

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/lua.cc	2007-10-22 20:54:52 UTC (rev 910)
@@ -1066,7 +1066,7 @@
     return 1;
 }
 
-static int killObjectBase(lua_State *L) {
+static int killObjectBase(lua_State *L) {  // TODO Itemholder owner objects
     Object *obj = to_object(L, -1);
     if (obj) {   // ignore not existing object
         GridObject *gobj;
@@ -1115,7 +1115,7 @@
     Object *obj = to_object(L,1);
     GridPos  p;
     if (GridObject *gobj = dynamic_cast<GridObject*>(obj)) {
-        p = gobj->get_pos();
+        p = gobj->getOwnerPos();
     } else if (Actor *a = dynamic_cast<Actor*>(obj)) {
         p = GridPos(a->get_pos());
     } else {
@@ -1356,7 +1356,7 @@
 //            ((keyType == LUA_TNUMBER) && ((keyNum == 1) || (keyNum == 2))))) {
         GridPos  p;
         if (GridObject *gobj = dynamic_cast<GridObject*>(obj)) {
-            p = gobj->get_pos();
+            p = gobj->getOwnerPos();
         } else if (Actor *a = dynamic_cast<Actor*>(obj)) {
             p = GridPos(a->get_pos());
         } else {
@@ -1797,7 +1797,7 @@
             Object *obj = to_object(L, 2);
             GridPos  p;
             if (GridObject *gobj = dynamic_cast<GridObject*>(obj)) {
-                p = gobj->get_pos();
+                p = gobj->getOwnerPos();
             } else if (Actor *a = dynamic_cast<Actor*>(obj)) {
                 p = GridPos(a->get_pos());
             } else {  // NULL object
@@ -1815,7 +1815,7 @@
                 if (obj) {              // ignore not existing objects
                     GridPos  p;
                     if (GridObject *gobj = dynamic_cast<GridObject*>(obj)) {
-                        p = gobj->get_pos();
+                        p = gobj->getOwnerPos();
                     } else if (Actor *a = dynamic_cast<Actor*>(obj)) {
                         p = GridPos(a->get_pos());
                     }

Modified: trunk/src/objects.cc
===================================================================
--- trunk/src/objects.cc	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/objects.cc	2007-10-22 20:54:52 UTC (rev 910)
@@ -194,6 +194,39 @@
 }
 /* -------------------- GridObject implementation -------------------- */
 
+void GridObject::setOwner(int player) {
+    ASSERT(pos.x < 0, XLevelRuntime,
+        "GridObject: attempt to add object to owner inventory that is still on grid");
+    pos.x = -1;
+    pos.y = player;
+}
+
+Value GridObject::getOwner() {
+    if (pos.x == -1 && pos.y != -1)
+        return Value(pos.y);
+    else
+        return Value();
+}
+
+void GridObject::setOwnerPos(GridPos po) {
+    ASSERT(pos.x < 0, XLevelRuntime,
+        "GridObject: attempt to add object to owner inventory that is still on grid");
+    if (po.x >= 0) {
+        pos.x = -2 - po.x;
+        pos.y = -2 - po.y;
+    } else {
+        pos.x = po.x;
+        pos.y = po.y;
+    }
+}
+
+GridPos GridObject::getOwnerPos() {
+    if (pos.x <= -2)
+        return GridPos(-2 - pos.x, -2 - pos.y);
+    else 
+        return pos;
+}
+
 display::Model *GridObject::set_anim (const std::string &mname) 
 {
     set_model (mname);

Modified: trunk/src/objects_decl.hh
===================================================================
--- trunk/src/objects_decl.hh	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/objects_decl.hh	2007-10-22 20:54:52 UTC (rev 910)
@@ -144,21 +144,47 @@
 
 /* -------------------- GridObject -------------------- */
 
-    /*! GridObject is the base class for everything that can only be
-      placed on "The Grid", i.e., for floor tiles, items, and
-      stones. */
+    /** 
+     * GridObject is the base class for everything that can only be
+     * placed on "The Grid", i.e., for floor tiles, items, and
+     * stones. 
+     */
 
     class GridObject : public Object, public display::ModelCallback {
     public:
-        GridObject() {}
-        GridObject(const char * kind) : Object(kind) {}
+        GridObject() : pos (GridPos(-1, -1)) {}
+        GridObject(const char * kind) : Object(kind), pos (GridPos(-1, -1)) {}
 
         void creation(GridPos p) {
             pos = p;
             on_creation (p);
         }
-        void removal(GridPos p) { on_removal(p); }
+        void removal(GridPos p) { 
+            on_removal(p);
+            pos.x = -1;
+            pos.y = -1;
+        }
         GridPos get_pos() const {return pos;}
+        
+        virtual void setOwner(int player);
+        
+        /**
+         * Get the player number who is owning the object.
+         * @return  integer value of player number or nil if not owned by a player
+         */
+        Value getOwner();
+        
+        /**
+         * Set the location of the GridObject to a given world or mirrored owner
+         * position.
+         */
+        virtual void setOwnerPos(GridPos po);
+         
+        /**
+         * Get the position of object within the world. Only objects owned by
+         * players will return positions outside of the world. 
+         */
+        GridPos getOwnerPos();
 
         // GridObject interface
         virtual void on_laserhit (Direction) {}
@@ -178,21 +204,33 @@
         virtual display::Model *get_model () = 0;
         virtual void kill_model (GridPos p) = 0;
 
-        virtual void init_model() 
-        { set_model(get_kind()); }
+        virtual void init_model() {
+            set_model(get_kind());
+        }
 
-        virtual void on_creation (GridPos) 
-        { init_model(); }
+        virtual void on_creation (GridPos) {
+            init_model();
+        }
 
-        virtual void on_removal (GridPos p) 
-        { kill_model (p); }
+        virtual void on_removal (GridPos p) {
+            kill_model (p);
+        }
 
     private:
         // ModelCallback interface.
         void animcb() {}
 
 
-        // Variables
+        /**
+         * The location of the GridObject. An object that is set on one of the world's
+         * layers will store the x and y coordinates with values greater equal 0. An
+         * object that is not a direct part of the world has a pos.x < 0. Objects that
+         * are owned by other objects that are part of a world layer will store the
+         * position of the owner mirrored at point -1, -1. This results in pos.x <= -2.
+         * All other GridObjects will have pos.x = -1. In this case pos.y >= 0 identifies
+         * the player that owns the object in his inventory. Objects that are neiter set
+         * in the world nor owned by anyone have pos.x = pos.y = -1. 
+         */
         GridPos pos;
     };
 }

Modified: trunk/src/player.cc
===================================================================
--- trunk/src/player.cc	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/player.cc	2007-10-22 20:54:52 UTC (rev 910)
@@ -180,7 +180,7 @@
 
     for (int i=0; i<nplayers; ++i) {
         Inventory *inv = GetInventory(i);
-
+        inv->assignOwner(i);
         for (int j = 0 ; j < extralives[i]; j++)
             inv->add_item (MakeItem (world::it_extralife));
     }

Modified: trunk/src/stones_simple.cc
===================================================================
--- trunk/src/stones_simple.cc	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/stones_simple.cc	2007-10-22 20:54:52 UTC (rev 910)
@@ -1482,8 +1482,10 @@
             !m_affected_actor->has_shield()) {
         enigma::Inventory *inv = player::GetInventory(m_affected_actor);
         if (inv && inv->size() > 0) {
-            if (bag == NULL)
+            if (bag == NULL) {
                 bag = world::MakeItem(it_bag);
+                bag->setOwnerPos(get_pos());
+            }
             int i = IntegerRand (0, int (inv->size()-1));
             dynamic_cast<ItemHolder *>(bag)->add_item(inv->yield_item(i));
             player::RedrawInventory (inv);

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/world.cc	2007-10-22 20:54:52 UTC (rev 910)
@@ -406,7 +406,7 @@
     delete_sequence (m_rubberbands.begin(), m_rubberbands.end());
 }
 
-bool World::is_border (GridPos p) {
+bool World::is_border(const GridPos &p) {
     return(p.x==0 || p.y==0 || p.x==w-1 || p.y==h-1);
 }
 
@@ -1743,17 +1743,14 @@
     return level->get_group(name);
 }
 
-bool world::IsLevelBorder(GridPos p)
-{
+bool world::IsLevelBorder(const GridPos &p) {
     return level->is_border(p);
 }
 
-bool world::IsInsideLevel(GridPos p)
-{
+bool world::IsInsideLevel(const GridPos &p) {
     return level->contains(p);
 }
 
-
 /* -------------------- Force fields -------------------- */
 
 void world::AddForceField(ForceField *ff)
@@ -1770,7 +1767,6 @@
 }
 
 
-
 /* -------------------- Rubber bands -------------------- */
 
 void world::AddRubberBand (Actor *a, Stone *st, const RubberBandData &d)

Modified: trunk/src/world.hh
===================================================================
--- trunk/src/world.hh	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/world.hh	2007-10-22 20:54:52 UTC (rev 910)
@@ -164,9 +164,9 @@
     void Shutdown();
 
 
-    bool IsLevelBorder(GridPos p);
-    bool IsInsideLevel(GridPos p);
-    Object *GetObject (const GridLoc &l);
+    bool IsLevelBorder(const GridPos &p);
+    bool IsInsideLevel(const GridPos &p);
+    Object *GetObject(const GridLoc &l);
 
 /* -------------------- Named Objects -------------------- */
 

Modified: trunk/src/world_internal.hh
===================================================================
--- trunk/src/world_internal.hh	2007-10-22 16:53:16 UTC (rev 909)
+++ trunk/src/world_internal.hh	2007-10-22 20:54:52 UTC (rev 910)
@@ -276,11 +276,11 @@
         World (int ww, int hh);
         ~World();
 
-        bool contains (GridPos p) {
+        bool contains(const GridPos &p) {
             return (p.x>=0 && p.y>=0 && p.x<w && p.y<h);
         }
 
-        bool is_border (GridPos p);
+        bool is_border(const GridPos &p);
 
         Field *get_field (GridPos p) {
             if (this->contains(p))



From dheck at mail.berlios.de  Thu Oct 25 09:12:35 2007
From: dheck at mail.berlios.de (dheck at BerliOS)
Date: Thu, 25 Oct 2007 09:12:35 +0200
Subject: [Enigma-game-svn] r911 - trunk/src
Message-ID: <200710250712.l9P7CZvv026741@sheep.berlios.de>

Author: dheck
Date: 2007-10-25 09:12:35 +0200 (Thu, 25 Oct 2007)
New Revision: 911

Modified:
   trunk/src/sound.cc
Log:
- removed old, unused code


Modified: trunk/src/sound.cc
===================================================================
--- trunk/src/sound.cc	2007-10-22 20:54:52 UTC (rev 910)
+++ trunk/src/sound.cc	2007-10-25 07:12:35 UTC (rev 911)
@@ -541,111 +541,6 @@
         }
         return newdata;
     }
-
-//     typedef float (*FilterFunc)(float);
-
-//     inline double sinc(double x)
-//     {
-//         if (x == 0)
-//             return 1;
-//         x *= M_PI;
-//         return sin(x)/x;
-//     }
-
-//     class Sinc {
-//     public:
-//         static const int support = 4;
-
-//         static double func (double x) {
-//             if (x < -4 || x > 4)
-//                 return 0;
-//             else
-//                 return sinc(x);
-//         }
-//     };
-
-
-//     class Lanczos2 {
-//     public:
-//         static const int support = 2;
-
-//         static double func (double x) {
-//             if (x < -2 || x > 2)
-//                 return 0;
-//             else
-//                 return sinc(x) * sinc(x/2);
-//         }
-//     };
-
-//     class Lanczos3 {
-//     public:
-//         static const int support = 3;
-
-//         static double func (double x) {
-//             if (x < -3 || x > 3)
-//                 return 0;
-//             else
-//                 return sinc(x) * sinc(x/3);
-//         }
-//     };
-
-
-//     template <class Filter, class SampleT>
-//     class Resampler {
-//         double ratio;
-//         vector<double> G;
-//     public:
-//         Resampler (double ratio_)
-//         : ratio (ratio_)
-//         {
-//         }
-
-//         size_t calc_destlen (size_t sourcelen)
-//         {
-//             return static_cast<size_t> ((sourcelen / ratio + 1) 
-//                                         * sizeof (SampleT));
-//         }
-
-//         void resample (const SampleT *source, size_t sourcelen, 
-//                        SampleT *dest, size_t destlen)
-//         {
-//             double        factor  = (double)sourcelen / destlen;
-//             int           support = Filter::support;
-//             double         dx      = ecl::Max(factor, 1.0);
-//             vector<double> F (2*support + 1);
-
-//             SampleT *dp = dest;
-//             for (size_t t=0; t<destlen; ++t) 
-//             {
-//                 double center = (t+0.5)*factor; // kernel center in the source
-//                 int   start  = ecl::Max<int>(0, center-support + 0.5);
-//                 int   stop   = ecl::Min<int>(sourcelen, center+support+0.5);
-//                 int   n      = stop-start;
-
-//                 // Calculate filter coefficients
-//                 double c      = 0;
-//                 double pos = start-center+0.5;
-//                 for (int j=0; j<n; ++j) {
-//                     F[j] = Filter::func(pos/dx);
-//                     c += F[j];
-//                     pos++;
-//                 }
-//                 // Normalize filter
-//                 if (c != 0 && c!=1)
-//                     for (int j=0; j<n; ++j)
-//                         F[j] /= c;
-
-//                 // Calculate next destination value
-//                 const SampleT *sp = source + start;
-//                 double accu = 0;
-//                 for (int j=n-1; j>=0; --j)
-//                     accu += F[j] * sp[j];
-//                 *dp++ = static_cast<SampleT> (accu); 
-// //                 *dp++ = static_cast<SampleT> (ecl::Clamp<double> (accu, -128, 127));
-//             }
-//         }
-
-//     };
 }
 
 Mix_Chunk * ChunkFromRaw (const Uint8 *buf, Uint32 len,
@@ -660,12 +555,6 @@
     Mix_QuerySpec (&dfreq, &dformat, &dchannels);
 
     // Resample
-//     Resampler<Sinc, Sint8> r (double(sfreq)/dfreq);
-//     size_t newlen = r.calc_destlen(len);
-//     Uint8 *newbuf = (Uint8*) malloc (newlen);
-//     r.resample ((Sint8*)buf, len, (Sint8*)newbuf, newlen);
-
-    // Resample
     Uint32 newlen=0;
     Uint8 *newbuf = (Uint8*)resample((const Sint8*)buf, len, sfreq, dfreq, &newlen);
 



From ral at mail.berlios.de  Tue Oct 30 00:30:50 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Tue, 30 Oct 2007 00:30:50 +0100
Subject: [Enigma-game-svn] r912 - in trunk/src: . gui
Message-ID: <200710292330.l9TNUo7i008438@sheep.berlios.de>

Author: ral
Date: 2007-10-30 00:30:45 +0100 (Tue, 30 Oct 2007)
New Revision: 912

Modified:
   trunk/src/Inventory.cc
   trunk/src/Inventory.hh
   trunk/src/ItemHolder.hh
   trunk/src/WorldProxy.cc
   trunk/src/WorldProxy.hh
   trunk/src/actors.cc
   trunk/src/actors.hh
   trunk/src/editor.cc
   trunk/src/enigma-lua.pkg
   trunk/src/enigma.cc
   trunk/src/enigma.hh
   trunk/src/floors.cc
   trunk/src/floors.hh
   trunk/src/gui/MainMenu.cc
   trunk/src/items.cc
   trunk/src/items.hh
   trunk/src/laser.cc
   trunk/src/laser.hh
   trunk/src/lua-display.cc
   trunk/src/lua-display.hh
   trunk/src/lua-ecl.cc
   trunk/src/lua-ecl.hh
   trunk/src/lua-editor.cc
   trunk/src/lua-editor.hh
   trunk/src/lua-enigma.cc
   trunk/src/lua-enigma.hh
   trunk/src/lua-global.cc
   trunk/src/lua-global.hh
   trunk/src/lua.cc
   trunk/src/lua.hh
   trunk/src/main.cc
   trunk/src/objects.cc
   trunk/src/objects.hh
   trunk/src/objects_decl.hh
   trunk/src/ox_extra.cc
   trunk/src/ox_magnum.cc
   trunk/src/ox_peroxyd.cc
   trunk/src/oxyd.cc
   trunk/src/oxyd_internal.hh
   trunk/src/player.cc
   trunk/src/player.hh
   trunk/src/server.cc
   trunk/src/st_switches.cc
   trunk/src/stones.cc
   trunk/src/stones.hh
   trunk/src/stones_complex.cc
   trunk/src/stones_internal.hh
   trunk/src/stones_simple.cc
   trunk/src/world.cc
   trunk/src/world.hh
   trunk/src/world_internal.hh
Log:
Trunk 1.1: Reengineering Namespaces
- abolished namespaces world, stones, lasers
- all names from these namespaces moved to enigma
Note:
- all objects of the world simulation now reside in the common
  namespace enigma
- subsystems as gui, lev, lua are subnamespaces
- server, client namespace still need to be reengineered


Modified: trunk/src/Inventory.cc
===================================================================
--- trunk/src/Inventory.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/Inventory.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -21,7 +21,7 @@
 #include <algorithm>
 
 using enigma::Inventory;
-using world::Item;
+using enigma::Item;
 
 typedef std::vector<Item*> ItemList;
 

Modified: trunk/src/Inventory.hh
===================================================================
--- trunk/src/Inventory.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/Inventory.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -26,8 +26,8 @@
 
 namespace enigma
 {
-    using world::Item;          // TODO: remove this after moving Item into enigma namespace
-
+//    using Item;          // TODO: remove this after moving Item into enigma namespace
+    class Item;
     class Inventory : public ItemHolder {
     public:
         Inventory();

Modified: trunk/src/ItemHolder.hh
===================================================================
--- trunk/src/ItemHolder.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/ItemHolder.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -20,8 +20,8 @@
         virtual bool is_empty() const = 0;
 
         //! Add another item
-        virtual void add_item (world::Item *it) = 0;
-        virtual world::Item *yield_first() = 0;
+        virtual void add_item (Item *it) = 0;
+        virtual Item *yield_first() = 0;
         virtual void takeItemsFrom(ItemHolder *ih) {return;}
     };
 }

Modified: trunk/src/WorldProxy.cc
===================================================================
--- trunk/src/WorldProxy.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/WorldProxy.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -21,9 +21,7 @@
 #include "server.hh"
 #include "display.hh"
 
-using namespace enigma;
-
-namespace world {
+namespace enigma {
  
     WorldProxy *WorldProxy::theSingleton = 0;
     
@@ -129,4 +127,4 @@
         }
     }
 
-} // namespace world
+} // namespace enigma

Modified: trunk/src/WorldProxy.hh
===================================================================
--- trunk/src/WorldProxy.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/WorldProxy.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -21,7 +21,7 @@
 
 #include "objects_decl.hh"
 
-namespace world {
+namespace enigma {
 
     class WorldProxy : public Object {
     public:
@@ -37,6 +37,6 @@
     private:
         static WorldProxy *theSingleton;
     };
-} // namespace world
+} // namespace enigma
 
 #endif

Modified: trunk/src/actors.cc
===================================================================
--- trunk/src/actors.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/actors.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -30,11 +30,13 @@
 
 using namespace std;
 using namespace enigma;
-using namespace world;
+//using namespace world;
 using ecl::V2;
 
 #include "actors_internal.hh"
 
+namespace enigma {
+
 const double Actor::max_radius = 24.0/64;
 
 
@@ -975,8 +977,8 @@
     case RISING_VORTEX: {
         set_model(kind);
         if (Item *it = GetItem(get_gridpos())) {
-            world::ItemID id = get_id(it);
-            if (id == world::it_vortex_open || id == world::it_vortex_closed) 
+            ItemID id = get_id(it);
+            if (id == it_vortex_open || id == it_vortex_closed) 
                 SendMessage(it, "arrival"); // closes some vortex
         }
         change_state(JUMP_VORTEX);
@@ -1001,7 +1003,7 @@
             ActorInfo *ai = get_actorinfo();
             ai->forceacc = V2();
         }
-        world::ReleaseActor(this);
+        ReleaseActor(this);
         break;
 
     case SHATTERING:
@@ -1009,26 +1011,26 @@
             sound_event ("shattersmall");
         else
             sound_event ("shatter");
-        world::GrabActor(this);
+        GrabActor(this);
         set_anim (kind+"-shatter");
         break;
 
     case DROWNING:
         // @@@ FIXME: use same animation as SINKING ?
-        world::GrabActor(this);
+        GrabActor(this);
 //         sound::PlaySound("drown");
         sound_event("drown");
 //         set_anim ("ring-anim");
         set_anim ("ac-drowned");
         break;
     case BUBBLING:
-        world::GrabActor(this);
+        GrabActor(this);
 //         sound::PlaySound("drown");
         set_anim ("ac-drowned");
         break;
     case FALLING:
     case FALLING_VORTEX:
-        world::GrabActor(this);
+        GrabActor(this);
         set_anim(kind+"-fall");
         break;
     case DEAD: 
@@ -1043,17 +1045,17 @@
     case APPEARING:
     case RISING_VORTEX:
         set_anim(kind+"-appear");
-        world::GrabActor(this);
+        GrabActor(this);
         break;
     case JUMP_VORTEX:
         ASSERT(oldstate == RISING_VORTEX, XLevelRuntime,
             "BasicBall: change to state JUMP_VORTEX but not RISING_VORTEX");
         vortex_normal_time = 0;
         set_model(kind);
-        world::ReleaseActor(this);
+        ReleaseActor(this);
         break;
     case DISAPPEARING:
-        world::GrabActor(this);
+        GrabActor(this);
 	disable_shield();
         set_anim(kind+"-disappear");
         break;
@@ -1226,10 +1228,10 @@
     0.7f                        // mass
 };
 
-
+
 /* -------------------- Functions -------------------- */
 
-void world::InitActors () 
+void InitActors () 
 {
     RegisterActor (new Bug);
     RegisterActor (new Horse);
@@ -1241,3 +1243,5 @@
     RegisterActor (new Killerball);
     RegisterActor (new CannonBall);
 }
+
+} // namespace enigma

Modified: trunk/src/actors.hh
===================================================================
--- trunk/src/actors.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/actors.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -21,8 +21,8 @@
 
 #include "objects_decl.hh"
 
-namespace world
-{
+namespace enigma {
+
     enum ActorID {
         ac_INVALID    = -1,
         ac_FIRST      = 0,
@@ -239,6 +239,7 @@
 /* -------------------- Global Functions -------------------- */
 
     void InitActors();
-}
+    
+} // namespace enigma
 
 #endif

Modified: trunk/src/editor.cc
===================================================================
--- trunk/src/editor.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/editor.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -55,13 +55,13 @@
 using display::ScreenArea;
 using display::DisplayEngine;
 using display::Model;
-//using world::ObjectTraits;
+//using world ObjectTraits;
 
-using world::ItemID;
+using enigma::ItemID;
 
 #include "editor_impl.hh"
 
-
+
 /* -------------------- Editor state -------------------- */
 
 EditorState::EditorState()

Modified: trunk/src/enigma-lua.pkg
===================================================================
--- trunk/src/enigma-lua.pkg	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/enigma-lua.pkg	2007-10-29 23:30:45 UTC (rev 912)
@@ -76,7 +76,7 @@
 
 /* -------------------- world.cc, objects.cc -------------------- */
 
-$using namespace world;
+$using namespace enigma;
 
 module world
 {

Modified: trunk/src/enigma.cc
===================================================================
--- trunk/src/enigma.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/enigma.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -32,8 +32,9 @@
 
 using namespace std;
 using namespace ecl;
-using namespace enigma;
 
+namespace enigma {
+    
 /* -------------------- Game Type -------------------- */
 
 static const char *versionName[GAMET_COUNT+1] = {
@@ -45,7 +46,7 @@
     0
 };
 
-GameType enigma::GetGameType(std::string name) {
+GameType GetGameType(std::string name) {
     GameType type = GAMET_UNKNOWN;
     for (int v = 0; v<GAMET_COUNT; ++v) {
         if (0 == strcmp(name.c_str(), versionName[v])) {
@@ -56,7 +57,7 @@
     return type;
 }
 
-std::string enigma::GetGameTypeName(GameType type) {
+std::string GetGameTypeName(GameType type) {
     if (type >= GAMET_FIRST && type <= GAMET_LAST)
         return versionName[type];
     else
@@ -65,18 +66,18 @@
 
 /* -------------------- Direction -------------------- */
 
-Direction enigma::reverse(Direction d) {
+Direction reverse(Direction d) {
     static Direction rdir[] = { NODIR, EAST, NORTH, WEST, SOUTH };
     return rdir[d+1];
 }
 
-Direction enigma::rotate_cw (Direction d)
+Direction rotate_cw (Direction d)
 {
     static Direction rdir[] = { NODIR, NORTH, WEST, SOUTH, EAST };
     return rdir[d+1];
 }
 
-Direction enigma::rotate_ccw (Direction d)
+Direction rotate_ccw (Direction d)
 {
     static Direction rdir[] = { NODIR, SOUTH, EAST, NORTH, WEST };
     return rdir[d+1];
@@ -105,15 +106,14 @@
     return d;
 }
 
-string enigma::to_suffix(Direction d) {
+string to_suffix(Direction d) {
     static const char *sfx[] = { "", "-w", "-s", "-e", "-n" };
     return sfx[d+1];
 }
 
 /* -------------------- DirectionBits -------------------- */
 
-DirectionBits
-enigma::rotate(DirectionBits d, bool clockwise)
+DirectionBits rotate(DirectionBits d, bool clockwise)
 {
     if (clockwise) {
         d = DirectionBits(((d>>1) | (d<<3)) & ALL_DIRECTIONS);
@@ -304,7 +304,7 @@
         case OBJECT:
             return Object::getObject(round_nearest<int>(val.dval[0]));
         case STRING:
-            return world::GetNamedObject(val.str);            
+            return GetNamedObject(val.str);            
         default: return NULL;
     }
 }
@@ -324,7 +324,7 @@
                     if ((*it)[0] == '$') {
                         result.push_back(Object::getObject(atoi((it->c_str()) + 1)));
                     } else {
-                        result.push_back(world::GetNamedObject(*it));
+                        result.push_back(GetNamedObject(*it));
                     }
                 }
             }
@@ -423,23 +423,23 @@
 }
 
 
-int enigma::to_int(const Value &v) {
+int to_int(const Value &v) {
     return v;
 }
 
-bool enigma::to_bool(const Value &v) {
+bool to_bool(const Value &v) {
     return v.to_bool();
 }
 
-double enigma::to_double(const Value &v) {
+double to_double(const Value &v) {
     return v;
 }
 
-std::string enigma::to_string(const Value &v) {
+std::string to_string(const Value &v) {
     return v.to_string();
 }
 
-Direction enigma::to_direction (const Value &v) {
+Direction to_direction (const Value &v) {
     int val = Clamp(to_int(v), 0, 3);
     return static_cast<Direction>(val);
 }
@@ -452,7 +452,7 @@
 {}
 
 
-std::ostream& enigma::operator<<(std::ostream& os, const GridPos& val)
+std::ostream& operator<<(std::ostream& os, const GridPos& val)
 {
     return os << '(' << val.x << ',' << val.y << ')';
 }
@@ -462,7 +462,7 @@
    203
    748
 */
-GridPos enigma::get_neighbour (GridPos p, int i)
+GridPos get_neighbour (GridPos p, int i)
 {
     ASSERT (i >= 0 && i <= 9, XLevelRuntime, "get_neighbour: index out of bounds");
     static int xoff[9] = { 0,0,-1,1,0,-1,1,-1,1 };
@@ -472,7 +472,7 @@
 
 /* -------------------- GridLoc -------------------- */
 
-bool enigma::to_gridloc (const char *str, GridLoc &l) {
+bool to_gridloc (const char *str, GridLoc &l) {
     GridLoc loc;
     const char *numstr = str + 3;
 
@@ -495,23 +495,23 @@
 
 /* -------------------- Random numbers -------------------- */
 
-void  enigma::Randomize ()
+void  Randomize ()
 {
     srand (time(NULL));
 }
 
-void   enigma::Randomize (unsigned seed)
+void  Randomize (unsigned seed)
 {
     srand (seed);
 }
 
-int    enigma::IntegerRand (int min, int max)
+int   IntegerRand (int min, int max)
 {
     int r = round_down<int>((max-min+1) * (rand()/(RAND_MAX+1.0)));
     return r+min;
 }
 
-double enigma::DoubleRand (double min, double max)
+double DoubleRand (double min, double max)
 {
     return min + double(rand())/RAND_MAX * (max-min);
 }
@@ -520,7 +520,7 @@
 /* -------------------- Time & Date -------------------- */
 
 #define MAX_DATE_LENGTH 256
-const char *enigma::date(const char *format) { // format see 'man strftime'
+const char *date(const char *format) { // format see 'man strftime'
     static char *result = 0;
     char         buffer[MAX_DATE_LENGTH];
 
@@ -623,7 +623,7 @@
     return ecl::LoadImage(name.c_str());
 }
 
-void enigma::DefineFont (const char *name, 
+void DefineFont (const char *name, 
                          const char *ttf_name, 
                          int ttf_size,
                          const char *bmf_name,
@@ -632,12 +632,12 @@
     font_cache.define_font (FontDescr (name, ttf_name, ttf_size, bmf_name, r, g, b));
 }
 
-ecl::Font *enigma::GetFont (const char *name) 
+ecl::Font *GetFont (const char *name) 
 {
     return font_cache.get(name);
 }
 
-ecl::Surface *enigma::LoadImage(const char *name) 
+ecl::Surface *LoadImage(const char *name) 
 {
     string filename;
     if (app.resourceFS->findImageFile (string(name) + ".png", filename)) 
@@ -645,7 +645,7 @@
     return 0;
 }
 
-ecl::Surface *enigma::GetImage(const char *name, const char *ext) 
+ecl::Surface *GetImage(const char *name, const char *ext) 
 {
     string filename;
     if (app.resourceFS->findImageFile (string(name) + ext, filename)) 
@@ -653,12 +653,14 @@
     return 0;
 }
 
-ecl::Surface *enigma::RegisterImage (const char *name, ecl::Surface *s) 
+ecl::Surface *RegisterImage (const char *name, ecl::Surface *s) 
 {
     image_cache.store(name, s);
     return s;
 }
 
-void enigma::ClearImageCache() {
+void ClearImageCache() {
     image_cache.clear();
 }
+
+} // namespace enigma

Modified: trunk/src/enigma.hh
===================================================================
--- trunk/src/enigma.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/enigma.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -36,10 +36,9 @@
 
 #define NUMENTRIES(array) (sizeof(array)/sizeof(*array))
 
-namespace enigma
-{
-    using namespace world;
-    class world::Object;
+namespace enigma { 
+
+    class Object;
     
 /* -------------------- Various types -------------------- */
 
@@ -191,7 +190,7 @@
 
 /* -------------------- Value -------------------- */
 
-    typedef std::list<world::Object *> ObjectList;
+    typedef std::list<Object *> ObjectList;
 
     /**
      * A flexible container for various types of data. This class is one
@@ -486,6 +485,6 @@
     : pos(p), layer(l) 
     {}
 
-}
+} // namespace enigma
 
 #endif

Modified: trunk/src/floors.cc
===================================================================
--- trunk/src/floors.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/floors.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -27,9 +27,9 @@
 #include <iostream>
 
 using namespace std;
-using namespace enigma;
-using namespace world;
 
+namespace enigma {
+
 Floor::Floor(const char *kind, double friction_, double mfactor, FloorFlags flags,
              FloorFireType flft, const char *firetransform_, const char *heattransform_)
 : GridObject (kind),
@@ -930,7 +930,7 @@
         enigma::Inventory *inv = player::GetInventory(m_affected_actor);
         if (inv && inv->size() > 0) {
             if (bag == NULL) {
-                bag = world::MakeItem(it_bag);
+                bag = MakeItem(it_bag);
                 bag->setOwnerPos(get_pos());
             }
             int i = IntegerRand (0, int (inv->size()-1));
@@ -943,10 +943,10 @@
     if(Item *it = GetItem(get_pos())) {
         if (!(it->get_traits().flags & itf_static)) {
             if (bag == NULL) {
-                bag = world::MakeItem(it_bag);
+                bag = MakeItem(it_bag);
                 bag->setOwnerPos(get_pos());                
             }
-            dynamic_cast<ItemHolder *>(bag)->add_item(world::YieldItem(get_pos())); 
+            dynamic_cast<ItemHolder *>(bag)->add_item(YieldItem(get_pos())); 
             didSteal = true;
         }
     }
@@ -957,15 +957,15 @@
 Value Thief::message(const string &msg, const Value &v) {
     if(msg == "capture" && state == IDLE) {
         state = CAPTURED;
-        Item * it =  world::GetItem(get_pos());
+        Item * it =  GetItem(get_pos());
         
         // add items on grid pos that can be picked up to our bag
         if (it != NULL && !(it->get_traits().flags & itf_static) && bag != NULL) {
-            dynamic_cast<ItemHolder *>(bag)->add_item(world::YieldItem(get_pos()));
+            dynamic_cast<ItemHolder *>(bag)->add_item(YieldItem(get_pos()));
         }
         // drop bag if pos is not occupied by a static item
-        if (world::GetItem(get_pos()) == NULL)
-            world::SetItem(get_pos(), bag);
+        if (GetItem(get_pos()) == NULL)
+            SetItem(get_pos(), bag);
         bag = NULL;
         set_anim(get_modelname() + string("-captured"));
         return Value(1);
@@ -1006,7 +1006,7 @@
 }
 
 
-void world::InitFloors()
+void InitFloors()
 {
     // Floors (most floors are defined in init.lua)
     Register(new Abyss);
@@ -1043,3 +1043,5 @@
     Register("fl-gradient15", new Gradient(24));
     Register("fl-gradient16", new Gradient(23));
 }
+
+} // namespace enigma

Modified: trunk/src/floors.hh
===================================================================
--- trunk/src/floors.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/floors.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -19,8 +19,11 @@
 #ifndef FLOORS_HH_INCLUDED
 #define FLOORS_HH_INCLUDED
 
-namespace world
-{
+namespace enigma {
+
+    class Actor;
+    class Stone;
+    
     enum FloorFlags {
         flf_default        = 0,
         flf_indestructible = 0x01,
@@ -146,6 +149,6 @@
 
     void InitFloors();
 
-}
+} // namespace enigma
 
 #endif

Modified: trunk/src/gui/MainMenu.cc
===================================================================
--- trunk/src/gui/MainMenu.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/gui/MainMenu.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -48,7 +48,7 @@
       load the appropriate models. */
     void ChangeVideoMode()
     {
-        world::PrepareLevel();      // make sure no references to models remain
+        enigma::WorldPrepareLevel();      // make sure no references to models remain
         video::ChangeVideoMode();
         LevelPreviewCache::instance()->clear();
         enigma::ClearImageCache();

Modified: trunk/src/items.cc
===================================================================
--- trunk/src/items.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/items.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -37,7 +37,6 @@
 
 
 using namespace std;
-using namespace world;
 
 using enigma::GridPos;
 using enigma::Value;
@@ -83,6 +82,8 @@
     ItemTraits classname::traits = { name, id, 0, radius }
 
 
+namespace enigma {
+
 /* -------------------- Item implementation -------------------- */
 
 Item::Item()
@@ -857,7 +858,7 @@
     }
 
     if (ess_cnt == ess_wcnt &&
-        (wcnt+ess_wcnt) == CountActorsOfKind (world::ac_meditation))
+        (wcnt+ess_wcnt) == CountActorsOfKind (ac_meditation))
     {
         server::FinishLevel();
     }
@@ -1377,10 +1378,10 @@
         init_model();
         if (m_pressedp) {
             sound_event ("triggerdown");
-            world::PerformAction(this, true);
+            PerformAction(this, true);
         } else {
             sound_event ("triggerup");
-            world::PerformAction(this, false);
+            PerformAction(this, false);
         }
     }
 }
@@ -1427,9 +1428,9 @@
                     return;
                }
            }
-           Stone *st = world::MakeStone (get_stone_name());
+           Stone *st = MakeStone (get_stone_name());
            TransferObjectName (this, st);
-           world::SetStone (p, st);
+           SetStone (p, st);
            kill();
         }
 
@@ -1530,7 +1531,7 @@
         if (st == 0) {
             warning("stone_change: Stone disappeared w/o sending me a proper message!");
             activated = false;
-            world::PerformAction(this, false);
+            PerformAction(this, false);
         }
     }
 }
@@ -1539,7 +1540,7 @@
     if (str == "noshogun") {
         if (activated) {
             activated = false;
-            world::PerformAction(this, false);
+            PerformAction(this, false);
         }
     }
     else {
@@ -1551,7 +1552,7 @@
 
         if (size_matches != activated) {
             activated = size_matches;
-            world::PerformAction(this, activated);
+            PerformAction(this, activated);
         }
     }
     return Value();
@@ -1562,7 +1563,7 @@
 namespace
 {
     class Magnet : public OnOffItem {
-        class Magnet_FF : public world::ForceField {
+        class Magnet_FF : public ForceField {
         public:
             Magnet_FF()
             : m_active(false), strength(30), range(1000)
@@ -1603,13 +1604,13 @@
 	        ff.set_range (range);
 	        ff.set_strength (strength);
 
-            world::AddForceField(&ff);
+            AddForceField(&ff);
             Item::on_creation (p);
         }
         
         void on_removal (GridPos p) {
             Item::on_removal(p);
-            world::RemoveForceField(&ff);
+            RemoveForceField(&ff);
         }
 
         virtual void notify_onoff(bool on) {
@@ -1648,7 +1649,7 @@
 
 namespace
 {
-    class WormHole_FF : public world::ForceField {
+    class WormHole_FF : public ForceField {
     public:
         WormHole_FF() : strength(0.6 * 50), rangesquared(1000000) {}
 
@@ -1708,9 +1709,9 @@
                 double s = getAttr("strength", server::WormholeForce);
                 ff.set_strength (s);
 
-                world::AddForceField(&ff);
+                AddForceField(&ff);
             } else {
-                world::RemoveForceField(&ff);
+                RemoveForceField(&ff);
             }
         }
 
@@ -1771,7 +1772,7 @@
                 init_model();
             }
             justWarping = true;
-            world::WarpActor(actor, targetpos[0], targetpos[1], false);
+            WarpActor(actor, targetpos[0], targetpos[1], false);
             justWarping = false;
         }
     }
@@ -1791,7 +1792,7 @@
 }
 
 void WormHole::on_removal(GridPos p) {
-    world::RemoveForceField(&ff);
+    RemoveForceField(&ff);
     Item::on_removal(p);
     ASSERT(!justWarping, XLevelRuntime, "Tried to kill a busy wormhole. Please use another way.");
 }
@@ -2008,7 +2009,7 @@
 {
     GridPos targetpos;
     // signals take precedence over targetx, targety attributes
-    if (world::GetSignalTargetPos(this, targetpos, idx)) {
+    if (GetSignalTargetPos(this, targetpos, idx)) {
         target = targetpos.center();
         return true;
     }
@@ -2040,7 +2041,7 @@
 
 void Vortex::emit_actor () {
     V2 v(m_target_vortex->get_pos().center());
-    world::WarpActor (m_actor_being_warped, v[0], v[1], false);
+    WarpActor (m_actor_being_warped, v[0], v[1], false);
     SendMessage (m_actor_being_warped, "rise");
     m_actor_being_warped = 0;
 
@@ -2051,7 +2052,7 @@
 
 void Vortex::warp_to(const V2 &target) {
     client::Msg_Sparkle (target);
-    world::WarpActor (m_actor_being_warped, target[0], target[1], false);
+    WarpActor (m_actor_being_warped, target[0], target[1], false);
     SendMessage (m_actor_being_warped, "appear");
     m_actor_being_warped = 0;
     state = OPEN;
@@ -2082,7 +2083,7 @@
                 // is destination vortex blocked? redirect
                 m_target_index += 1;
                 client::Msg_Sparkle (v_target);
-                world::WarpActor (m_actor_being_warped,
+                WarpActor (m_actor_being_warped,
                                   v_target[0], v_target[1], false);
                 GameTimer.set_alarm(this, 0.4, false);
             }
@@ -2238,7 +2239,7 @@
             Direction dir = get_orientation();
             
             // usage within a st-window
-            Stone *stone = world::GetStone(get_pos());
+            Stone *stone = GetStone(get_pos());
             if (stone && (stone->get_traits().id == st_window) &&
                     to_bool(SendMessage(stone, "inner_pull", dir))) {
             }
@@ -2693,8 +2694,8 @@
 
 void Blocker::grow()
 {
-    Stone *st = world::MakeStone("st-blocker-growing");
-    world::SetStone(get_pos(), st);
+    Stone *st = MakeStone("st-blocker-growing");
+    SetStone(get_pos(), st);
     TransferObjectName(this, st);
     kill();
 }
@@ -2821,7 +2822,7 @@
                 sound_event ("switchmarbles");
             }
             else {
-                world::RespawnActor(a);
+                RespawnActor(a);
             }
             return ITEM_DROP;
         }
@@ -3471,7 +3472,7 @@
         CLONEOBJ(Oxyd5fItem);
         DECL_TRAITS;
 
-        virtual Value on_message (const world::Message &) {
+        virtual Value on_message (const Message &) {
             PerformAction (this, true);
             return Value();
         }
@@ -3497,8 +3498,8 @@
             player::ReplaceActor((int)v, olda, newa);
         }
 
-        world::AddActor (newa);
-        if (!world::YieldActor (olda)) {
+        AddActor (newa);
+        if (!YieldActor (olda)) {
             enigma::Log << "Strange: could not remove old actor\n";
         }
         olda->hide();
@@ -3537,8 +3538,8 @@
 
             if (id == ac_blackball || id == ac_whiteball) {
                 // Kill ALL rubberbands connected with the actor:
-                world::KillRubberBands (a);
-                Actor *rotor = world::MakeActor (ac_rotor);
+                KillRubberBands (a);
+                Actor *rotor = MakeActor (ac_rotor);
                 rotor->set_attrib ("mouseforce", Value (1.0));
                 rotor->set_attrib ("controllers", Value (iplayer+1));
                 rotor->set_attrib ("player", Value (iplayer));
@@ -3554,7 +3555,7 @@
 
                 replace_actor (a, rotor);
 
-                world::GameTimer.set_alarm (new DropCallback (rotor, a),
+                GameTimer.set_alarm (new DropCallback (rotor, a),
                                             ROTOR_LIFETIME,
                                             false);
             }
@@ -3580,7 +3581,7 @@
             double length = getAttr("length", 1.0);
             double minlength = getAttr("minlength", 0.0);
 
-            world::RubberBandData rbd;
+            RubberBandData rbd;
             rbd.strength = strength;
             rbd.length = length;
             rbd.minlength = minlength;
@@ -3604,17 +3605,17 @@
             if((!target_actor)&&(!target_stone)) return ITEM_DROP;
 
             if (isScissor)
-                world::KillRubberBands (a);
+                KillRubberBands (a);
 
             sound_event ("rubberband");
             if (target_actor) {
                 // It's not allowed to connect a rubberband to self.
                 if (target_actor != a)
-                    world::AddRubberBand (a,target_actor,rbd);
+                    AddRubberBand (a,target_actor,rbd);
                 else
                     return ITEM_DROP; }
             else
-                world::AddRubberBand (a,target_stone,rbd);
+                AddRubberBand (a,target_stone,rbd);
 
             return ITEM_KILL;
         }
@@ -3627,7 +3628,7 @@
 
 /* -------------------- Functions -------------------- */
 
-void world::InitItems()
+void InitItems()
 {
     RegisterItem (new Bag);
     RegisterItem (new Banana);
@@ -3722,3 +3723,5 @@
     RegisterItem (new YinYang);
     RegisterItem (new Rubberband);
 }
+
+} // namespace enigma

Modified: trunk/src/items.hh
===================================================================
--- trunk/src/items.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/items.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -21,8 +21,8 @@
 
 #include "objects_decl.hh"
 
-namespace world
-{
+namespace enigma {
+    
     enum ItemID {
         it_INVALID = -1,
         it_FIRST = 0,
@@ -164,6 +164,7 @@
         float       radius;     //!< Radius, 0.0 = default
     };
 
+    class Stone;
     class Item : public GridObject {
     public:
         Item();
@@ -256,6 +257,7 @@
 /* -------------------- Functions -------------------- */
 
     void InitItems();
-}
+    
+} // namespace enigma
 
 #endif

Modified: trunk/src/laser.cc
===================================================================
--- trunk/src/laser.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/laser.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -25,14 +25,10 @@
 #include <map>
 
 using namespace std;
-using namespace world;
-using namespace lasers;
 
-using stones::maybe_push_stone;
 using ecl::V2;
 
-namespace
-{
+namespace enigma {
 
 /* -------------------- LaserBeam -------------------- */
 
@@ -101,7 +97,7 @@
 \ref st-pmirror, \ref st-3mirror
 
 */
-    class LaserStone : public LaserEmitter, public stones::OnOffStone {
+    class LaserStone : public LaserEmitter, public OnOffStone {
     public:
         LaserStone (Direction dir=EAST);
         static void reemit_all();
@@ -140,9 +136,9 @@
         void on_creation (GridPos p);
         void init_model();
     };
-}
 
-
+
+
 /* -------------------- PhotoCell -------------------- */
 
 vector<void*> PhotoCell::instances;
@@ -337,7 +333,7 @@
         GridPos    pos = lb->get_pos();
 
         old_laser_positions[pos] = static_cast<int>(lb->directions);
-        world::KillItem(pos);
+        KillItem(pos);
     }
 }
 
@@ -486,7 +482,7 @@
         void on_recalc_finish() {}
 
         // Stone interface
-        void actor_hit(const world::StoneContact &sc);
+        void actor_hit(const StoneContact &sc);
         void on_creation (GridPos p);
         void on_removal (GridPos p);
         bool is_transparent(Direction) const { return is_transparent(); }
@@ -555,7 +551,7 @@
     return Value();
 }
 
-void MirrorStone::actor_hit(const world::StoneContact &sc)
+void MirrorStone::actor_hit(const StoneContact &sc)
 {
     if (is_movable())
         maybe_push_stone(sc);
@@ -588,7 +584,7 @@
         traits.movable = to_bool(val) ? MOVABLE_STANDARD : MOVABLE_PERSISTENT;
 }
     
-
+
 /* -------------------- Plane Mirror -------------------- */
 namespace
 {
@@ -666,7 +662,7 @@
     }
 }
 
-
+
 /* -------------------- TriangleMirror -------------------- */
 
 namespace
@@ -742,7 +738,7 @@
     bool light_recalc_scheduled = false;
 }
 
-void lasers::Init() {
+void InitLasers() {
     Register (new LaserStone);
     Register ("st-laser-n", new LaserStone(NORTH));
     Register ("st-laser-e", new LaserStone(EAST));
@@ -787,17 +783,17 @@
 }
 
 
-void lasers::MaybeRecalcLight(GridPos p) {
+void MaybeRecalcLight(GridPos p) {
     light_recalc_scheduled |=
         (LightFrom(p, NORTH) || LightFrom(p, SOUTH) ||
          LightFrom(p, WEST) || LightFrom(p, EAST));
 }
 
-void lasers::RecalcLight() {
+void RecalcLight() {
     light_recalc_scheduled = true;
 }
 
-bool lasers::LightFrom (GridPos p, Direction dir) {
+bool LightFrom (GridPos p, Direction dir) {
     p.move(dir);
     if (LaserEmitter *le = dynamic_cast<LaserEmitter*>(GetStone(p)))
         if (has_dir(le->emission_directions(), reverse(dir)))
@@ -807,7 +803,7 @@
     return false;
 }
 
-void lasers::RecalcLightNow() {
+void RecalcLightNow() {
     if (light_recalc_scheduled) {
         PhotoCell::notify_start();
         LaserBeam::kill_all();
@@ -817,3 +813,5 @@
         light_recalc_scheduled = false;
     }
 }
+
+} // namespace enigma

Modified: trunk/src/laser.hh
===================================================================
--- trunk/src/laser.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/laser.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -24,16 +24,15 @@
 
 #include "objects.hh"
 
-namespace world
-{
+namespace enigma {
     /**
      * This interface must be implemented by all items and stones that
      * are capable of emitting light.
      */
     class LaserEmitter {
     public:
-	virtual ~LaserEmitter() {}
-	virtual DirectionBits emission_directions() const = 0;
+        virtual ~LaserEmitter() {}
+        virtual DirectionBits emission_directions() const = 0;
     };
 
 /* -------------------- PhotoCell -------------------- */
@@ -101,12 +100,10 @@
         virtual void notify_laseron() = 0;
         virtual void notify_laseroff() = 0;
     };
-}
 
+
 /* -------------------- Functions -------------------- */
-namespace lasers
-{
-    void Init();
+    void InitLasers();
 
     /*! This function must be called at the end of each tick; it
       recalculates the laser beams if necessary. */
@@ -114,7 +111,7 @@
 
     /*! Force all light beams to be recalculated at the end of the
       current tick.  So far, this is only used by laser stones and in
-      world::InitWorld().  */
+      WorldInitLevel().  */
     void RecalcLight();
 
     /*! If position `p' is inside a laser beam, force all laser beams
@@ -127,5 +124,7 @@
     /*! Return true iff a stone or an item at position `p' it hit by
       light coming from direction `dir'. */
     bool LightFrom (enigma::GridPos p, enigma::Direction dir);
-}
+
+} // namespace enigma
+
 #endif

Modified: trunk/src/lua-display.cc
===================================================================
--- trunk/src/lua-display.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-display.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: display
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 #ifndef __cplusplus

Modified: trunk/src/lua-display.hh
===================================================================
--- trunk/src/lua-display.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-display.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: display
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 /* Exported function */

Modified: trunk/src/lua-ecl.cc
===================================================================
--- trunk/src/lua-ecl.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-ecl.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: px
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 #ifndef __cplusplus

Modified: trunk/src/lua-ecl.hh
===================================================================
--- trunk/src/lua-ecl.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-ecl.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: px
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 /* Exported function */

Modified: trunk/src/lua-editor.cc
===================================================================
--- trunk/src/lua-editor.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-editor.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: editor
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 #ifndef __cplusplus

Modified: trunk/src/lua-editor.hh
===================================================================
--- trunk/src/lua-editor.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-editor.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: editor
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 /* Exported function */

Modified: trunk/src/lua-enigma.cc
===================================================================
--- trunk/src/lua-enigma.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-enigma.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: enigma
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 #ifndef __cplusplus
@@ -21,7 +21,7 @@
 using ecl::Font;
 using namespace server;
 using namespace lev;
-using namespace world;
+using namespace enigma;
 #include "video.hh"
 using namespace video;
 using ecl::Screen;

Modified: trunk/src/lua-enigma.hh
===================================================================
--- trunk/src/lua-enigma.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-enigma.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: enigma
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 /* Exported function */

Modified: trunk/src/lua-global.cc
===================================================================
--- trunk/src/lua-global.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-global.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: global
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 #ifndef __cplusplus

Modified: trunk/src/lua-global.hh
===================================================================
--- trunk/src/lua-global.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua-global.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -1,6 +1,6 @@
 /*
 ** Lua binding: global
-** Generated automatically by tolua++-1.0.92 on Fri Apr 20 13:59:44 2007.
+** Generated automatically by tolua++-1.0.92 on Mon Oct 29 00:41:21 2007.
 */
 
 /* Exported function */

Modified: trunk/src/lua.cc
===================================================================
--- trunk/src/lua.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -66,10 +66,10 @@
 using ecl::strf;
 
 using enigma::GridPos;
-using world::Object;
-using world::GridObject;
-using world::ForceField;
-using world::WorldProxy;
+using enigma::Object;
+using enigma::GridObject;
+using enigma::ForceField;
+using enigma::WorldProxy;
 
 namespace enigma { namespace lua {
      
@@ -197,7 +197,7 @@
     int id = *(static_cast<int *>(lua_touserdata(L,idx)));
     Object *obj = NULL;
     if (id != -1)
-       obj = world::Object::getObject(id);
+       obj = Object::getObject(id);
 
     return obj;  // NULL if object does no longer exist
 }
@@ -383,13 +383,13 @@
 /* -------------------- Interface routines -------------------- */
 
 
-int MakeObject (lua_State *L)
+int en_make_object (lua_State *L)
 {
     const char *name = lua_tostring(L, 1);
     if (!name) {
         throwLuaError(L, "MakeObject: string expected as argument");
     }
-    Object *obj = world::MakeObject(name);
+    Object *obj = MakeObject(name);
     if (obj == NULL)
         throwLuaError(L, ecl::strf("MakeObject: unknown object name '%s'", name).c_str());
     pushobject(L, obj);
@@ -399,7 +399,7 @@
 static int
 en_get_object_template(lua_State *L)
 {
-    Object *obj = world::GetObjectTemplate(lua_tostring(L, 1));
+    Object *obj = GetObjectTemplate(lua_tostring(L, 1));
     pushobject(L, obj);
     return 1;
 }
@@ -474,7 +474,7 @@
              throwLuaError(L, "object argument 3 must be a floor or nil");
          }
     }
-    world::SetFloor(GridPos(x,y), fl);
+    SetFloor(GridPos(x,y), fl);
     return 0;
 }
 
@@ -487,7 +487,7 @@
     if( ! it) {
         throwLuaError(L, "object is no valid item");
     }
-    world::SetItem(GridPos(x,y), it);
+    SetItem(GridPos(x,y), it);
     return 0;
 }
 
@@ -499,7 +499,7 @@
     Stone *st = dynamic_cast<Stone*>(to_object(L, 3));
     if( ! st)
         throwLuaError(L, "object is no valid stone");
-    world::SetStone(GridPos(x,y), st);
+    SetStone(GridPos(x,y), st);
     return 0;
 }
 
@@ -507,7 +507,7 @@
 {
     int x = round_down<int>(lua_tonumber(L, 1));
     int y = round_down<int>(lua_tonumber(L, 2));
-    world::KillStone(GridPos(x,y));
+    KillStone(GridPos(x,y));
     return 0;
 }
 
@@ -515,7 +515,7 @@
 {
     int x = round_down<int>(lua_tonumber(L, 1));
     int y = round_down<int>(lua_tonumber(L, 2));
-    world::KillItem(GridPos(x,y));
+    KillItem(GridPos(x,y));
     return 0;
 }
 
@@ -527,8 +527,8 @@
     Actor *ac = dynamic_cast<Actor*>(to_object(L, 3));
     if( ! ac)
         throwLuaError(L, "object is no valid actor");
-    if (world::IsInsideLevel(GridPos(round_down<int>(x), round_down<int>(y))))
-        world::AddActor(x, y, ac);
+    if (IsInsideLevel(GridPos(round_down<int>(x), round_down<int>(y))))
+        AddActor(x, y, ac);
     else
         throwLuaError(L, "position is outside of world");
     return 0;
@@ -545,7 +545,7 @@
         throwLuaError(L,"Illegal message");
     else if (obj) {
         try {
-            v = world::SendMessage (obj, msg, to_value(L, 3));
+            v = SendMessage (obj, msg, to_value(L, 3));
         }
         catch (const XLevelRuntime &e) {
             throwLuaError (L, e.what());
@@ -613,7 +613,7 @@
     else if (!name) 
         throwLuaError(L, "NameObject: Illegal name");
     else
-        world::NameObject(obj, name);
+        NameObject(obj, name);
 
     return 0;
 }
@@ -621,7 +621,7 @@
 static int
 en_get_named_object(lua_State *L)
 {
-    Object *o = world::GetNamedObject(lua_tostring(L,1));
+    Object *o = GetNamedObject(lua_tostring(L,1));
     pushobject(L, o);
     return 1;
 }
@@ -631,7 +631,7 @@
 {
     int x = round_down<int>(lua_tonumber(L, 1));
     int y = round_down<int>(lua_tonumber(L, 2));
-    Object *o = world::GetFloor(GridPos(x, y));
+    Object *o = GetFloor(GridPos(x, y));
     pushobject(L, o);
     return 1;
 }
@@ -640,7 +640,7 @@
 {
     int x = round_down<int>(lua_tonumber(L, 1));
     int y = round_down<int>(lua_tonumber(L, 2));
-    Object *o = world::GetItem(GridPos(x, y));
+    Object *o = GetItem(GridPos(x, y));
     pushobject(L, o);
     return 1;
 }
@@ -649,7 +649,7 @@
 {
     int x = round_down<int>(lua_tonumber(L, 1));
     int y = round_down<int>(lua_tonumber(L, 2));
-    Object *o = world::GetStone(GridPos(x, y));
+    Object *o = GetStone(GridPos(x, y));
     pushobject(L, o);
     return 1;
 }
@@ -682,7 +682,7 @@
     ecl::V2 v;
     v[0] = lua_tonumber(L, 1);
     v[1] = lua_tonumber(L, 2);
-    world::SetConstantForce (v);
+    SetConstantForce (v);
     return 0;
 }
 
@@ -693,7 +693,7 @@
     Object *o2       = to_object(L, 2);
     Actor  *a2       = dynamic_cast<Actor*>(o2);
     Stone  *st       = dynamic_cast<Stone*>(o2);
-    world::RubberBandData d;
+    RubberBandData d;
     d.strength  = lua_tonumber (L, 3);
     d.length    = lua_tonumber (L, 4);
     d.minlength = lua_tonumber (L, 5);
@@ -702,9 +702,9 @@
         throwLuaError(L, "AddRubberBand: First argument must be an actor\n");
     else {
         if (a2)
-            world::AddRubberBand (a1, a2, d);
+            AddRubberBand (a1, a2, d);
         else if (st)
-            world::AddRubberBand (a1, st, d);
+            AddRubberBand (a1, st, d);
         else
             throwLuaError(L, "AddRubberBand: Second argument must be actor or stone\n");
     }
@@ -751,7 +751,7 @@
     char       *found   = strchr(allowed, dir[0]);
 
     if (found && found[0]) 
-        world::AddScramble(GridPos(x,y), enigma::Direction(found-allowed));
+        AddScramble(GridPos(x,y), enigma::Direction(found-allowed));
     else 
         throwLuaError(L, "AddScramble: Third argument must be one character of \"wsen\"");
 
@@ -761,7 +761,7 @@
 static int
 en_set_scramble_intensity(lua_State *L)
 {
-    world::SetScrambleIntensity(int(lua_tonumber(L, 1)));
+    SetScrambleIntensity(int(lua_tonumber(L, 1)));
     return 0;
 }
 
@@ -781,7 +781,7 @@
     if (msg == 0)
         msg = "signal";
 
-    world::AddSignal (source, target, msg);
+    AddSignal (source, target, msg);
     return 0;
 }
 
@@ -1005,7 +1005,7 @@
             std::string key = lua_tostring(L, -1);
             if (key == "name") {
                 if (lua_isstring(L, -2))
-                    world::NameObject(obj, lua_tostring(L, -2));
+                    NameObject(obj, lua_tostring(L, -2));
             } else {
                 obj->set_attrib(key, to_value(L, -2));
             }
@@ -1031,7 +1031,7 @@
     int x = round_down<int>(lua_tonumber(L, -1));
     lua_rawgeti(L, -2, 2);
     int y = round_down<int>(lua_tonumber(L, -1));
-    Object *o = world::GetFloor(GridPos(x, y));
+    Object *o = GetFloor(GridPos(x, y));
     pushobject(L, o);
     return 1;
 }
@@ -1046,7 +1046,7 @@
     int x = round_down<int>(lua_tonumber(L, -1));
     lua_rawgeti(L, -2, 2);
     int y = round_down<int>(lua_tonumber(L, -1));
-    Object *o = world::GetItem(GridPos(x, y));
+    Object *o = GetItem(GridPos(x, y));
     pushobject(L, o);
     return 1;
 }
@@ -1061,7 +1061,7 @@
     int x = round_down<int>(lua_tonumber(L, -1));
     lua_rawgeti(L, -2, 2);
     int y = round_down<int>(lua_tonumber(L, -1));
-    Object *o = world::GetStone(GridPos(x, y));
+    Object *o = GetStone(GridPos(x, y));
     pushobject(L, o);
     return 1;
 }
@@ -1073,15 +1073,15 @@
         switch (obj->getObjectType()) {
             case Object::FLOOR :
                 gobj = dynamic_cast<GridObject*>(obj);
-                world::KillFloor(gobj->get_pos());
+                KillFloor(gobj->get_pos());
                 break;
             case Object::STONE :
                 gobj = dynamic_cast<GridObject*>(obj);
-                world::KillStone(gobj->get_pos());
+                KillStone(gobj->get_pos());
                 break;
             case Object::ITEM  :
                 gobj = dynamic_cast<GridObject*>(obj);
-                world::KillItem(gobj->get_pos());
+                KillItem(gobj->get_pos());
                 break;
             case Object::ACTOR :
             default :
@@ -1156,7 +1156,7 @@
     
     if (obj) {   // ignore not existing objects
         try {
-            answer = world::SendMessage (obj, msg, val);
+            answer = SendMessage (obj, msg, val);
         }
         catch (const XLevelRuntime &e) {
             throwLuaError (L, e.what());
@@ -1531,11 +1531,11 @@
     
     if (name.find_first_of("*?") != std::string::npos) {
         // search all objects that match the template
-        std::list<Object *> group = world::GetNamedGroup(name);
+        std::list<Object *> group = GetNamedGroup(name);
         return pushNewGroup(L, group);
     } else {    
         // search for a unique object
-        Object *obj = world::GetNamedObject(name);
+        Object *obj = GetNamedObject(name);
         pushobject(L, obj);
     }
     return 1;
@@ -1555,7 +1555,7 @@
         throwLuaError(L, "NameObject: names with leading '$' are reserved");
         return 0;
     }
-    world::NameObject(obj, name);
+    NameObject(obj, name);
     return 0;
 }
 
@@ -1614,17 +1614,17 @@
     }
     
     if (name == "fl-nil") {
-        world::KillFloor(GridPos(xi, yi));
+        KillFloor(GridPos(xi, yi));
         return 0;
     } else if (name == "st-nil") {
-        world::KillStone(GridPos(xi, yi));
+        KillStone(GridPos(xi, yi));
         return 0;
     } else if (name == "it-nil") {
-        world::KillItem(GridPos(xi, yi));
+        KillItem(GridPos(xi, yi));
         return 0;
     }
     
-    obj = world::MakeObject(name.c_str());
+    obj = MakeObject(name.c_str());
     if (obj == NULL) {
         throwLuaError(L, ecl::strf("World: unknown object name '%s'", name.c_str()).c_str());
         return 0;
@@ -1637,13 +1637,13 @@
                 if ((xi+yi)%2 != (int)odd)
                     break;
             }
-            world::SetFloor(GridPos(xi,yi), dynamic_cast<Floor *>(obj));
+            SetFloor(GridPos(xi,yi), dynamic_cast<Floor *>(obj));
             break;
         case Object::STONE :
-            world::SetStone(GridPos(xi,yi), dynamic_cast<Stone *>(obj));
+            SetStone(GridPos(xi,yi), dynamic_cast<Stone *>(obj));
             break;
         case Object::ITEM  :
-            world::SetItem(GridPos(xi,yi), dynamic_cast<Item *>(obj));
+            SetItem(GridPos(xi,yi), dynamic_cast<Item *>(obj));
             break;
         case Object::ACTOR :
             lua_rawgeti(L, -1, 2);
@@ -1653,8 +1653,8 @@
             if (lua_isnumber(L, -1))
                 y += lua_tonumber(L, -1);
             lua_pop(L, 2);               
-            if (world::IsInsideLevel(GridPos(round_down<int>(x), round_down<int>(y)))) 
-                world::AddActor(x, y, dynamic_cast<Actor *>(obj));
+            if (IsInsideLevel(GridPos(round_down<int>(x), round_down<int>(y)))) 
+                AddActor(x, y, dynamic_cast<Actor *>(obj));
             else
                 throwLuaError(L, "World: actor addition to position outside of world");
             break;
@@ -1727,7 +1727,7 @@
     width = width/keyLength;
     Log << "initWorld  - w " << width << "  - h " << height << "\n";
 
-    world::Resize(width, height);
+    Resize(width, height);
     
     luaL_getmetatable(L, LUA_ID_TILES);
     lua_rawgeti(L, -1, 1);               // tiles content table
@@ -2063,7 +2063,7 @@
     {FindDataFile,          "FindDataFile"},
     {loadLib,               "LoadLib"},
     {en_get_object_template,"GetObjectTemplate"},
-    {lua::MakeObject,       "MakeObject"},
+    {en_make_object,        "MakeObject"},
     {en_set_actor,          "SetActor"},
 
     // finding objects
@@ -2299,7 +2299,7 @@
     }
 }
 
-Error CallFunc(lua_State *L, const char *funcname, const Value& arg, world::Object *obj) {
+Error CallFunc(lua_State *L, const char *funcname, const Value& arg, Object *obj) {
     int retval;
     lua_getglobal(L, funcname);
     push_value(L, arg);
@@ -2482,7 +2482,7 @@
     RegisterFuncs(L, levelfuncs);
     RegisterFuncs2(L, levelFuncs);
 
-    // Create a new metatable for world::Object objects
+    // Create a new metatable for world objects
     RegisterLuaType(L, LUA_ID_OBJECT, objectOperations, objectMethods, objectMethodeMap);
     RegisterLuaType(L, LUA_ID_POSITION, positionOperations, positionMethods, positionMethodeMap);
     RegisterLuaType(L, LUA_ID_NAMEOBJ, namedObjOperations, namedObjMethods, namedObjMethodeMap);

Modified: trunk/src/lua.hh
===================================================================
--- trunk/src/lua.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/lua.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -89,7 +89,7 @@
 
     /*! Call a Lua function with one argument.  This is mainly used
       for callbacks during the game. */
-    Error CallFunc(lua_State *L, const char *funcname, const enigma::Value& arg, world::Object *obj);
+    Error CallFunc(lua_State *L, const char *funcname, const enigma::Value& arg, Object *obj);
 
     /*! Call a Lua function with a (large) byte vector as the sole
       argument.  Currently only used for loading XML levels. */

Modified: trunk/src/main.cc
===================================================================
--- trunk/src/main.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/main.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -79,7 +79,7 @@
     class Nulbuf : public std::streambuf {};
     Nulbuf* nullbuffer = new Nulbuf;
 }
-
+
 /* -------------------- Variables -------------------- */
 
 namespace enigma
@@ -299,9 +299,9 @@
     init_i18n();
     
     // ----- Initialize object repositories
-    world::Init();
+    InitWorld();
     if (ap.dumpinfo) {
-        world::DumpObjectInfo();
+        DumpObjectInfo();
         exit(0);
     }
 
@@ -788,7 +788,7 @@
 void Application::shutdown() 
 {
     oxyd::Shutdown();
-    world::Shutdown();
+    enigma::ShutdownWorld();
     display::Shutdown();
     if (!isMakePreviews) { // avoid saves on preview generation
         lev::RatingManager::instance()->save();

Modified: trunk/src/objects.cc
===================================================================
--- trunk/src/objects.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/objects.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -35,9 +35,9 @@
 
 
 using namespace std;
-using namespace enigma;
-using namespace world;
 
+namespace enigma {
+
 // remove comment from define below to switch on verbose messaging
 // note: VERBOSE_MESSAGES is defined in multiple source files!
 // #define VERBOSE_MESSAGES
@@ -87,7 +87,7 @@
     return id;
 }
 
-Value Object::on_message (const world::Message &m)
+Value Object::on_message (const Message &m)
 {
     return message (m.message, m.value);
 }
@@ -253,3 +253,5 @@
 
     va_end(arg_ptr);
 }
+
+} // namespace enigma

Modified: trunk/src/objects.hh
===================================================================
--- trunk/src/objects.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/objects.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -25,13 +25,5 @@
 #include "stones.hh"
 #include "actors.hh"
 
-namespace enigma
-{
-    using world::Item;
-    using world::Stone;
-    using world::Actor;
-    using world::Floor;
-    using world::Object;
-}
 
 #endif

Modified: trunk/src/objects_decl.hh
===================================================================
--- trunk/src/objects_decl.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/objects_decl.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -24,10 +24,11 @@
 #include "ecl_alist.hh"
 #include <map>
 
-namespace world
-{
+namespace enigma { 
+
     using std::string;
-    using namespace enigma;
+    
+    struct Message;
 
 /* -------------------- Objects -------------------- */
 
@@ -143,6 +144,7 @@
     };
 
 /* -------------------- GridObject -------------------- */
+    class Actor;
 
     /** 
      * GridObject is the base class for everything that can only be
@@ -233,9 +235,10 @@
          */
         GridPos pos;
     };
-}
 
+} // namespace enigma
 
+
 #define CLONEOBJ(TYPE)                                  \
         TYPE* clone() { return new TYPE(*this); }       \
         void dispose() { delete this; }

Modified: trunk/src/ox_extra.cc
===================================================================
--- trunk/src/ox_extra.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/ox_extra.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -31,10 +31,10 @@
 // Standard enigma section :
 
 #define ITEMSPEC(i) i
-#define ITEMMAPTYPE world::ItemID
+#define ITEMMAPTYPE enigma::ItemID
 
 #include "oxyd_internal.hh"
-using namespace world;
+using namespace enigma;
 
 #endif // PLAIN_SPEC_ONLY
 // only tables following!

Modified: trunk/src/ox_magnum.cc
===================================================================
--- trunk/src/ox_magnum.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/ox_magnum.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -31,10 +31,10 @@
 // Standard enigma section :
 
 #define ITEMSPEC(i) i
-#define ITEMMAPTYPE world::ItemID
+#define ITEMMAPTYPE enigma::ItemID
 
 #include "oxyd_internal.hh"
-using namespace world;
+using namespace enigma;
 
 #endif // PLAIN_SPEC_ONLY
 // only tables following!

Modified: trunk/src/ox_peroxyd.cc
===================================================================
--- trunk/src/ox_peroxyd.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/ox_peroxyd.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -31,13 +31,13 @@
 // Standard enigma section :
 
 #define ITEMSPEC(i) i
-#define ITEMMAPTYPE world::ItemID
+#define ITEMMAPTYPE enigma::ItemID
 
 #include "objects.hh"
 #include "server.hh"
 #include "oxyd_internal.hh"
 
-using namespace world;
+using namespace enigma;
 using namespace oxyd;
 
 Stone *PerOxydLoader::make_stone (int type, int x, int y)

Modified: trunk/src/oxyd.cc
===================================================================
--- trunk/src/oxyd.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/oxyd.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -41,15 +41,15 @@
 
 using namespace std;
 using namespace enigma;
-using world::Stone;
-using world::MakeStone;
-using world::Item;
-using world::MakeItem;
+using enigma::Stone;
+using enigma::MakeStone;
+//using enigma::Item;
+using enigma::MakeItem;
 
 using namespace oxyd;
 using OxydLib::Level;
 
-
+
 /* -------------------- Helper functions -------------------- */
 
 namespace 
@@ -92,21 +92,21 @@
         const Grid &sgrid = level.getGrid (GridType_Pieces);
         for (unsigned y=0; y<sgrid.getHeight(); ++y)
             for (unsigned x=0; x<sgrid.getWidth(); ++x)
-                if (Stone *st = world::GetStone(GridPos(x, y)))
+                if (Stone *st = GetStone(GridPos(x, y)))
                     if (int code = st->getAttr("code"))
                         stones.insert(code);
 
         const Grid &igrid = level.getGrid (GridType_Objects);
         for (unsigned y=0; y<igrid.getHeight(); ++y)
             for (unsigned x=0; x<igrid.getWidth(); ++x)
-                if (Item *it = world::GetItem(GridPos(x, y)))
+                if (Item *it = GetItem(GridPos(x, y)))
                     if (int code = it->getAttr("code"))
                         items.insert(code);
 
         const Grid &fgrid = level.getGrid (GridType_Objects);
         for (unsigned y=0; y<fgrid.getHeight(); ++y)
             for (unsigned x=0; x<fgrid.getWidth(); ++x)
-                if (world::Floor *fl = world::GetFloor(GridPos(x, y)))
+                if (Floor *fl = GetFloor(GridPos(x, y)))
                     if (int code = fl->getAttr("code"))
                         floors.insert(code);
 
@@ -238,7 +238,7 @@
 void OxydLoader::load ()
 {
     // Prepare Enigma game engine
-    world::Resize (level.getWidth(), level.getHeight());
+    Resize (level.getWidth(), level.getHeight());
     if (config.twoplayers) 
         server::TwoPlayerGame = true;
     display::ResizeGameArea (20, 11);
@@ -287,7 +287,7 @@
 Stone *OxydLoader::make_timer (int x, int y)
 {
     const OscillatorMap &oscillators = level.getOscillators(config.gamemode);
-    Stone *st = world::MakeStone ("st-timer");
+    Stone *st = MakeStone ("st-timer");
     st->set_attrib("interval", Value(0.2));
 
     Block block(x, y);
@@ -303,7 +303,7 @@
 
 Stone *OxydLoader::make_stone (int type, int x, int y)
 {
-    world::Stone *st = 0;
+    Stone *st = 0;
 
     if (type == 0) {
         // ignore
@@ -313,7 +313,7 @@
         char color[2] = "0";
         color[0] += (type-1) / 2; 
 
-        st = world::MakeStone("st-oxyd");
+        st = MakeStone("st-oxyd");
         st->set_attrib("color", color);
         st->set_attrib("flavor", config.oxyd_flavor);
     }
@@ -328,11 +328,11 @@
         const char *name = config.stonetable[type];
         if (name == 0) {
             Log << ecl::strf("Unknown stone %X\n", type);
-            st = world::MakeStone ("st-dummy");
+            st = MakeStone ("st-dummy");
             st->set_attrib("code", type);
         }
         else if (name[0] != '\0') { // ignore if name==""
-            st = world::MakeStone (name);
+            st = MakeStone (name);
         }
     }
     return st;
@@ -370,7 +370,6 @@
 
 Item  *OxydLoader::make_item (int type)
 {
-    using namespace world;
 
     Item *it = 0;
 
@@ -385,14 +384,14 @@
     case 0x00: break;           // ignore
     case 0x02:                  // note 1
 	{
-	    it = MakeItem (world::it_document);
+	    it = MakeItem (it_document);
 	    string text = convert_encoding(level.getNoteText(0, lang));
 	    it->set_attrib ("text", text.c_str());
 	}
         break;
     case 0x03:                  // note 2
 	{
-	    it = MakeItem (world::it_document);
+	    it = MakeItem (it_document);
 	    string text = convert_encoding(level.getNoteText(1, lang));
 	    it->set_attrib ("text", text.c_str());
 	}
@@ -402,7 +401,7 @@
             ItemID id = config.itemtable[type];
             if (id == it_INVALID) {
                 Log << ecl::strf ("Unknown item %X\n",type);
-                it = MakeItem (world::it_dummy);
+                it = MakeItem (it_dummy);
                 it->set_attrib("code", type);
             }
             else
@@ -415,7 +414,6 @@
 
 void OxydLoader::load_floor () 
 {
-    using namespace world;
 
     const Grid &grid = level.getGrid (GridType_Surfaces);
     for (unsigned y=0; y<grid.getHeight(); ++y) {
@@ -444,12 +442,11 @@
     for (unsigned y=0; y<grid.getHeight(); ++y)
         for (unsigned x=0; x<grid.getWidth(); ++x)
             if (Item *it = make_item (grid.get(x,y)))
-                world::SetItem (GridPos(x, y), it);
+                SetItem (GridPos(x, y), it);
 }
 
 void OxydLoader::load_stones()
 {
-    using namespace world;
 
     const Grid &grid = level.getGrid (GridType_Pieces);
     for (unsigned y=0; y<grid.getHeight(); ++y) {
@@ -468,7 +465,7 @@
 
     for (int i = 0; i<count; ++i) {
         const ScrambleItem& si = level.getScrambleItem(i);
-        world::AddScramble (GridPos(si.getX(), si.getY()),
+        AddScramble (GridPos(si.getX(), si.getY()),
                             direction_oxyd2enigma(si.getDir()));
     }
 }
@@ -476,7 +473,7 @@
 
 void OxydLoader::load_actors () 
 {
-    using world::MakeActor;
+    using enigma::MakeActor;
 
     int     nmeditationmarbles = 0;
     size_t  nmarbles           = level.getNumMarbles();
@@ -497,23 +494,23 @@
 
         switch (marble.getMarbleType()) {
         case MarbleType_Black:
-            ac = MakeActor (world::ac_blackball);
+            ac = MakeActor (ac_blackball);
             ac->set_attrib ("player", Value(0.0));
             break;
         case MarbleType_White:
-            ac = MakeActor (world::ac_whiteball);
+            ac = MakeActor (ac_whiteball);
             ac->set_attrib ("player", Value(1.0));
             break;
         case MarbleType_Meditation:
             if (have_black_marble && !level.getHarmlessMeditationMarbles()) {
                 // # example: Oxyd Extra #28
-                ac = MakeActor (world::ac_killerball);
+                ac = MakeActor (ac_killerball);
 //                ac->set_attrib ("player", Value(0.0));
                 ac->set_attrib ("mouseforce", Value (1.0));
                 ac->set_attrib ("controllers", Value (3.0));
             }
             else {
-                ac = MakeActor (world::ac_meditation);
+                ac = MakeActor (ac_meditation);
                 nmeditationmarbles += 1;
 
                 if (config.twoplayers && (nmeditationmarbles % 2) == 0)
@@ -530,7 +527,7 @@
             }
             break;
         case MarbleType_Jack:
-            ac = MakeActor (world::ac_top);
+            ac = MakeActor (ac_top);
             if (!minfo.is_default(MI_FORCE)) {
                 double force = minfo.get_value(MI_FORCE) / 4; // just a guess
                 ac->set_attrib("force", Value(force) );
@@ -544,7 +541,7 @@
             break;
 
         case MarbleType_Rotor: {
-            ac = MakeActor (world::ac_rotor);
+            ac = MakeActor (ac_rotor);
 
             double force = minfo.get_value (MI_FORCE, 30) * 0.3;
             double range = minfo.get_value (MI_RANGE, 100) / 32.0;
@@ -561,7 +558,7 @@
         }
 
         case MarbleType_Horse: {
-            ac = MakeActor (world::ac_horse);
+            ac = MakeActor (ac_horse);
             int levelw = level.getWidth();
             if (!minfo.is_default(MI_HORSETARGET1)) {
                 int targetpos = minfo.get_value(MI_HORSETARGET1);
@@ -590,7 +587,7 @@
             break;
         }
         case MarbleType_Bug:
-            ac = MakeActor (world::ac_bug);
+            ac = MakeActor (ac_bug);
             break;
         default:
             enigma::Log << "Unhandled actor type " << int(marble.getMarbleType()) << endl;
@@ -601,7 +598,7 @@
         }
 
         if (ac) 
-            world::AddActor (x, y, ac);
+            AddActor (x, y, ac);
 
         m_actors.push_back (ac);
     }
@@ -614,18 +611,18 @@
     for (int i=0; i<num_rubberbands; ++i) {
         const RubberBand &rb = level.getRubberBand(game_mode, i);
 
-        world::Actor *actor = get_actor (rb.getFirstEndMarble());
-        world::RubberBandData rbd;
+        Actor *actor = get_actor (rb.getFirstEndMarble());
+        RubberBandData rbd;
         rbd.length = rb.getNaturalLength() / 32.0;
         rbd.strength = rb.getForce() / 60.0;
         if (rb.isSecondEndMarble()) {
-            world::Actor *actor2 = get_actor (rb.getSecondEndMarble());
-            world::AddRubberBand (actor, actor2, rbd);
+            Actor *actor2 = get_actor (rb.getSecondEndMarble());
+            AddRubberBand (actor, actor2, rbd);
         }
         else {
             GridPos p(rb.getSecondEndPieceX(), rb.getSecondEndPieceY());
-            if (world::GetStone(p) != NULL) // Fix for MagnumGold Level #108
-                world::AddRubberBand (actor, world::GetStone(p), rbd); 
+            if (GetStone(p) != NULL) // Fix for MagnumGold Level #108
+                AddRubberBand (actor, GetStone(p), rbd); 
         }
     }
 }
@@ -646,14 +643,14 @@
             SignalLocation recipient = level.getRecipient(sender, irec);
             GridLoc src = to_gridloc(sender);
             GridLoc dst = to_gridloc(recipient);
-            world::AddSignal (src, dst, "signal");
+            AddSignal (src, dst, "signal");
         }
     }
 }
 
 void OxydLoader::parse_specials ()
 {
-    using world::SendMessage;
+    using enigma::SendMessage;
 
     server::FlatForce = 5.0 * level.getFlatForce (config.gamemode);
 
@@ -689,22 +686,22 @@
 
         case 'i':           // turn item on
             if (parse_gridpos (cmd, levelw, levelh, p))
-                SendMessage(world::GetItem(p), "signal", Value(1.0));
+                SendMessage(GetItem(p), "signal", Value(1.0));
             break;
 
         case 'o':           // turn item off
             if (parse_gridpos (cmd, levelw, levelh, p))
-                SendMessage(world::GetItem(p), "signal", Value(0.0));
+                SendMessage(GetItem(p), "signal", Value(0.0));
             break;
 
         case 'I':           // turn stone on
             if (parse_gridpos (cmd, levelw, levelh, p))
-                SendMessage(world::GetStone(p), "signal", Value(1.0));
+                SendMessage(GetStone(p), "signal", Value(1.0));
             break;
 
         case 'O':           // turn stone off
             if (parse_gridpos (cmd, levelw, levelh, p))
-                SendMessage(world::GetStone(p), "signal", Value(0.0));
+                SendMessage(GetStone(p), "signal", Value(0.0));
             break;
 
         case 'Q':           // default charge
@@ -722,7 +719,7 @@
     }
 }
 
-world::Actor *OxydLoader::get_actor (int idx) 
+Actor *OxydLoader::get_actor (int idx) 
 {
     assert (0 <= idx && unsigned(idx) <= m_actors.size());
     return m_actors[idx];
@@ -730,7 +727,7 @@
 
 
 
-
+
 /* -------------------- LevelPack_Oxyd -------------------- */
 
 LevelPack_Oxyd::LevelPack_Oxyd (OxydVersion ver, DatFile *dat, 
@@ -881,7 +878,7 @@
     PerOxydLoader (level, c).load();
 
     // Add a yinyang item if a white marble is present
-    if (world::CountActorsOfKind (world::ac_whiteball) > 0)
+    if (CountActorsOfKind (ac_whiteball) > 0)
         player::AddYinYang();
 }
 

Modified: trunk/src/oxyd_internal.hh
===================================================================
--- trunk/src/oxyd_internal.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/oxyd_internal.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -54,7 +54,7 @@
         bool           twoplayers;
         GameMode       gamemode;
         const char   **floortable;
-        world::ItemID *itemtable;
+        ItemID        *itemtable;
         const char   **stonetable;
 
         int id_timer;
@@ -64,7 +64,7 @@
         LoaderConfig (bool twoplayers_,
                       GameMode gamemode_,
                       const char **floortable_,
-                      world::ItemID *itemtable_,
+                      ItemID *itemtable_,
                       const char **stonetable_,
                       const char *oxyd_flavor_ = "a"
                       )
@@ -114,11 +114,11 @@
 
         void connect_rubberbands ();
         void connect_signals ();
-        world::Actor *get_actor (int idx);
+        Actor *get_actor (int idx);
 
 
         /* ---------- Private variables ---------- */
-        std::vector<world::Actor *> m_actors;
+        std::vector<Actor *> m_actors;
         bool harmless_medi;
     };
 
@@ -303,19 +303,19 @@
 
 /* -------------------- Global Variables -------------------- */
 
-    extern world::ItemID oxyd1_item_map[];
+    extern ItemID oxyd1_item_map[];
     extern const char *oxyd1_floor_map[];
     extern const char *oxyd1_stone_map[];
 
-    extern world::ItemID peroxyd_item_map[];
+    extern ItemID peroxyd_item_map[];
     extern const char *peroxyd_floor_map[];
     extern const char *peroxyd_stone_map[];
 
-    extern world::ItemID oxydmag_item_map[];
+    extern ItemID oxydmag_item_map[];
     extern const char *oxydmag_floor_map[];
     extern const char *oxydmag_stone_map[];
 
-    extern world::ItemID oxydextra_item_map[];
+    extern ItemID oxydextra_item_map[];
     extern const char *oxydextra_floor_map[];
     extern const char *oxydextra_stone_map[];
 

Modified: trunk/src/player.cc
===================================================================
--- trunk/src/player.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/player.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -34,8 +34,7 @@
 
 using namespace std;
 using namespace enigma;
-using namespace world;
-using world::Actor;
+using enigma::Actor;
 using enigma::Inventory;
 
 namespace
@@ -115,7 +114,7 @@
     const double RESPAWN_TIME = 1.5;
 
 //    a->find_respawnpos();
-    world::SendMessage(a, "resurrect");
+    SendMessage(a, "resurrect");
     remove_extralife(a);
     respawn_list.push_back(RespawnInfo(a, RESPAWN_TIME));
 }
@@ -182,7 +181,7 @@
         Inventory *inv = GetInventory(i);
         inv->assignOwner(i);
         for (int j = 0 ; j < extralives[i]; j++)
-            inv->add_item (MakeItem (world::it_extralife));
+            inv->add_item (MakeItem (it_extralife));
     }
     
     unassignedActors.clear();
@@ -194,7 +193,7 @@
     for (unsigned i=0; i<players.size(); ++i) {
         Inventory *inv = GetInventory (i);
         if (inv->find ("it-yinyang") == -1) 
-            inv->add_item (world::MakeItem (world::it_yinyang));
+            inv->add_item (MakeItem (it_yinyang));
     }
 }
 
@@ -213,11 +212,11 @@
         Inventory *inv = GetInventory(iplayer);
         int nextralifes=0;
         for (size_t i=0; i<inv->size(); ++i)
-            if (get_id (inv->get_item(i)) == world::it_extralife)
+            if (get_id (inv->get_item(i)) == it_extralife)
                 nextralifes += 1;
         inv->clear();
         for (int i=0; i<nextralifes; ++i)
-            inv->add_item (world::MakeItem (world::it_extralife));
+            inv->add_item (MakeItem (it_extralife));
 
         players[iplayer].actors.clear();
     }
@@ -231,8 +230,8 @@
     for (unsigned i=0; i<players.size(); ++i) {
         for (unsigned j=0; j<players[i].actors.size(); ++j) {
             Actor *a = players[i].actors[j];
-            world::SendMessage(a, "disappear");
-            world::KillRubberBands (a);
+            SendMessage(a, "disappear");
+            KillRubberBands (a);
         }
     }
 }
@@ -318,7 +317,7 @@
     for (unsigned i=0; i<players.size(); ++i) {
         vector<Actor *> &al = players[i].actors;
         for (unsigned j=0; j<al.size(); ++j) {
-            world::SendMessage(al[j], "suicide");
+            SendMessage(al[j], "suicide");
         }
     }
 }
@@ -344,7 +343,7 @@
     if (iplayer >= players.size())
         server::RaiseError ("Invalid actor number");
 
-    world::ReleaseActor(a);
+    ReleaseActor(a);
     players[iplayer].actors.push_back(a);
 
     if (players[iplayer].actors.size() == 1) {
@@ -562,7 +561,7 @@
 void player::PickupItem (Actor *a, GridPos p) 
 {
     if (Inventory *inv = MayPickup(a, GetField(p)->item)) {
-        if (Item *item = world::YieldItem(p)) {
+        if (Item *item = YieldItem(p)) {
             item->on_pickup(a);
             inv->add_item(item);
             RedrawInventory (inv);
@@ -575,15 +574,15 @@
 {
     if (Inventory *inv = MayPickup(a, GetField(p)->item)) 
     {
-        if (world::Stone *stone = world::YieldStone(p)) 
+        if (Stone *stone = YieldStone(p)) 
         {
             string kind = stone->get_kind();
             if (kind[0] == 's') 
                 kind[0] = 'i';
 
-            if (Item *item = world::MakeItem(kind.c_str())) {
+            if (Item *item = MakeItem(kind.c_str())) {
                 KillRubberBands(stone);
-                world::DisposeObject (stone);
+                DisposeObject (stone);
                 inv->add_item(item);
                 player::RedrawInventory(inv);
                 sound::EmitSoundEvent ("pickup", p.center());
@@ -599,7 +598,7 @@
 
     if (inv.size() > 0) {
         Item *it = inv.get_item (0);
-        world::Actor *ac = 0;
+        Actor *ac = 0;
         GridPos p;
         bool can_drop_item = false;
         if (!players[icurrent_player].actors.empty()) {
@@ -609,7 +608,7 @@
         }
 
         switch (it->activate(ac, p)) {
-        case world::ITEM_DROP:
+        case ITEM_DROP:
             // only drop if no item underneath and actor allows it
             if (it->can_drop_at(p) && can_drop_item) {
                 it = inv.yield_first ();
@@ -617,11 +616,11 @@
                 it->drop(ac, p);
             }
             break;
-        case world::ITEM_KILL:
+        case ITEM_KILL:
             DisposeObject (inv.yield_first ());
             RedrawInventory (&inv);
             break;
-        case world::ITEM_KEEP:
+        case ITEM_KEEP:
             break;
         }
     }
@@ -654,7 +653,7 @@
     Inventory *inv = GetInventory (CurrentPlayer());
     std::vector<std::string> modelnames;
     for (size_t i=0; i<inv->size(); ++i) {
-        world::Item *it = inv->get_item(i);
+        Item *it = inv->get_item(i);
         modelnames.push_back(it->get_inventory_model());
     }
     STATUSBAR->set_inventory (modelnames);

Modified: trunk/src/player.hh
===================================================================
--- trunk/src/player.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/player.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -92,7 +92,7 @@
         void RotateInventory (int dir=1);
 
         void ActivateFirstItem();
-        world::ItemAction ActivateItem (Item *it);
+        ItemAction ActivateItem (Item *it);
 
         void Tick (double dtime);
         void PlayerShutdown();

Modified: trunk/src/server.cc
===================================================================
--- trunk/src/server.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/server.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -131,7 +131,7 @@
 
         game::ResetGameTimer();
 
-        world::InitWorld();
+        WorldInitLevel();
         if (!CreatingPreview) {
                 player::LevelLoaded(isRestart);
                 client::Msg_LevelLoaded(isRestart);
@@ -186,13 +186,13 @@
     }
     player::Tick (time_accu);
     for (;time_accu >= timestep; time_accu -= timestep) {
-        world::Tick (timestep);
+        WorldTick (timestep);
         if (lua::CallFunc (lua::LevelState(), "Tick", timestep, NULL) != 0) {
             throw XLevelRuntime (string("Calling 'Tick' failed:\n")
                                                 + lua::LastError(lua::LevelState()));
         }
     }
-    world::TickFinished ();
+    TickFinished ();
 }
 
 
@@ -251,7 +251,7 @@
 
     move_counter = 0;
 
-    world::PrepareLevel ();
+    enigma::WorldPrepareLevel();
     server::WorldInitialized = false;
 
     player::PrepareLevel();
@@ -567,7 +567,7 @@
 }
 
 void server::Msg_MouseForce (const ecl::V2 &f) {
-    world::SetMouseForce (f);
+    SetMouseForce (f);
 }
 
 

Modified: trunk/src/st_switches.cc
===================================================================
--- trunk/src/st_switches.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/st_switches.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -26,10 +26,9 @@
 #include "stones_internal.hh"
 
 using namespace std;
-using namespace world;
-using namespace stones;
 
-
+namespace enigma {
+
 /* -------------------- Switch -------------------- */
 
 namespace
@@ -89,7 +88,7 @@
         }
 
         void actor_hit(const StoneContact &sc) {
-            if (get_id (sc.actor) == world::ac_blackball)
+            if (get_id (sc.actor) == ac_blackball)
                 set_on (!is_on());
         }
 
@@ -133,7 +132,7 @@
         }
 
         void actor_hit(const StoneContact &sc) {
-            if (get_id (sc.actor) == world::ac_whiteball)
+            if (get_id (sc.actor) == ac_whiteball)
                 set_on (!is_on());
         }
 
@@ -392,7 +391,7 @@
             };
 
             if (!m_inactive_so_far) {
-                world::EmitSignalByIndex(this, direction2idx[m_direction], 0);
+                EmitSignalByIndex(this, direction2idx[m_direction], 0);
             } else
                 m_inactive_so_far = false;
 
@@ -401,8 +400,8 @@
             set_on(!is_on());
             sound_event ("fourswitch");
 
-            if (world::HaveSignals (this)) {
-                world::EmitSignalByIndex(this, direction2idx[m_direction], 1);
+            if (HaveSignals (this)) {
+                EmitSignalByIndex(this, direction2idx[m_direction], 1);
             } else {
                 // no signal handler defined
                 PerformAction(this, is_on());
@@ -678,7 +677,7 @@
     }
 }
 
-
+
 /* -------------------- Functions -------------------- */
 
 void InitSwitches()
@@ -697,3 +696,5 @@
     Register (new Switch_white);
     Register (new TimeSwitch);
 }
+
+} // namespace enigma

Modified: trunk/src/stones.cc
===================================================================
--- trunk/src/stones.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/stones.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -25,15 +25,14 @@
 #include "Inventory.hh"
 
 using namespace std;
-using namespace world;
-using namespace stones;
 
-
+namespace enigma {
+
 /* -------------------- Helper routines -------------------- */
 
 /*! Determine whether the actor hitting the stone can move stone
   and return either the direction the stone should move or NODIR. */
-Direction stones::get_push_direction (const StoneContact &sc) 
+Direction get_push_direction (const StoneContact &sc) 
 {
     ActorInfo *ai  = sc.actor->get_actorinfo();
     Direction  dir = contact_face(sc);
@@ -47,7 +46,7 @@
 
 /* Move a stone (by sending an impulse) Called when an actor hits a
    stone. */
-bool stones::maybe_push_stone (const StoneContact &sc) 
+bool maybe_push_stone (const StoneContact &sc) 
 {
     Direction dir = get_push_direction(sc);
     if (dir != enigma::NODIR) {
@@ -57,7 +56,7 @@
     return false;
 }
 
-
+
 //======================================================================
 // STONES
 //======================================================================
@@ -143,7 +142,7 @@
 void Stone::actor_hit(const StoneContact &sc) 
 {
     if (is_movable())
-        stones::maybe_push_stone (sc);
+        maybe_push_stone (sc);
 }
 
 void Stone::actor_touch(const StoneContact &sc) {
@@ -310,13 +309,13 @@
 }
 
 
-
 
+
 // *******************************************************************************
 //  Stones under development :
 
 
-
+
 /* -------------------- Explosion stone -------------------- */
 namespace
 {
@@ -346,7 +345,7 @@
     DEF_TRAITSM(ExplosionStone, "st-explosion", st_explosion, MOVABLE_BREAKABLE);
 }
 
-
+
 /* -------------------- Charge stone -------------------- */
 
 // Attributes:
@@ -376,7 +375,7 @@
     };
 }
 
-
+
 /* -------------------- SpitterStone -------------------- */
 
 namespace
@@ -411,7 +410,7 @@
 
         state = SPITTING;
         ai->vel = ball_velocity;
-        world::AddActor (center[0], center[1], ball);
+        AddActor (center[0], center[1], ball);
         set_anim ("st-spitter-spitting");
         break;
     }
@@ -439,7 +438,7 @@
     }
 }
 
-
+
 /* -------------------- YieldedGridStone -------------------- */
 
 YieldedGridStone::YieldedGridStone(Stone *st)
@@ -475,7 +474,7 @@
     model = 0;
 }
 
-
+
 /* -------------------- Oxyd compatibility stones -------------------- */
 
 namespace
@@ -526,7 +525,7 @@
     DEF_TRAITSM(Oxyd_0x18, "st-oxyd-0x18", st_oxyd_0x18, MOVABLE_BREAKABLE);
 }
 
-
+
 /* -------------------- Flash stone -------------------- */
 namespace
 {
@@ -545,7 +544,7 @@
     };
 }
 
-
+
 /* -------------------- Surprise stone -------------------- */
 namespace 
 {
@@ -578,7 +577,7 @@
     DEF_TRAITS(SurpriseStone, "st-surprise", st_surprise);
 }
 
-
+
 /* -------------------- Coffee stone -------------------- */
 namespace
 {
@@ -599,7 +598,7 @@
     DEF_TRAITS(CoffeeStone, "st-coffee", st_coffee);
 }
 
-
+
 /* -------------------- Breaking stone -------------------- */
 namespace
 {
@@ -622,7 +621,7 @@
     DEF_TRAITSM(BreakingStone, "st-breaking", st_breaking, MOVABLE_BREAKABLE);
 }
 
-
+
 /* -------------------- Bug stone -------------------- */
 namespace
 {
@@ -642,7 +641,7 @@
     DEF_TRAITSM(BugStone, "st-bug", st_bug, MOVABLE_BREAKABLE);
 }
 
-
+
 /* -------------------- Plain stones -------------------- */
 
 /* These stones mimic the behaviour of the plain-looking stones in
@@ -857,7 +856,7 @@
                 MOVABLE_STANDARD);
 }
 
-
+
 /* -------------------- Black- and Whiteballs Stones -------------------- */
 
 namespace
@@ -868,7 +867,7 @@
         virtual Value on_message (const Message &m)
         {
             GridPos p = get_pos();
-            Actor *a = world::CurrentCollisionActor;
+            Actor *a = CurrentCollisionActor;
             if (a && get_id(a) == ac_blackball) {
                 if (p.y == m.gridpos.y) {
                     SendMessage (GetStone (move (p, EAST)),  "signal", 1.0);
@@ -896,7 +895,7 @@
         virtual Value on_message (const Message &m)
         {
             GridPos p = get_pos();
-            Actor *a = world::CurrentCollisionActor;
+            Actor *a = CurrentCollisionActor;
             if (a && get_id(a) == ac_whiteball) {
                 if (p.y == m.gridpos.y) {
                     SendMessage (GetStone (move (p, EAST)),  "signal", 1.0);
@@ -947,8 +946,7 @@
 
 extern void InitSwitches();
 
-void stones::Init()
-{
+void InitStones() {
 
     // Register(new ...);
 
@@ -981,3 +979,4 @@
     Init_complex();
     InitSwitches();
 }
+} // namespace enigma

Modified: trunk/src/stones.hh
===================================================================
--- trunk/src/stones.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/stones.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -21,9 +21,11 @@
 
 #include "objects_decl.hh"
 
-namespace world
-{
-    using namespace enigma;
+namespace enigma {
+    
+//    using namespace enigma;
+    struct Impulse;
+    struct StoneContact;
 
     enum StoneID {
         st_INVALID = -1,
@@ -240,11 +242,10 @@
     inline StoneID get_id(Stone *st) {
         return st->get_traits().id;
     }
-}
+    
+    void InitStones();
+    
+} // namespace enigma
 
-namespace stones
-{
-    void Init();
-}
 
 #endif

Modified: trunk/src/stones_complex.cc
===================================================================
--- trunk/src/stones_complex.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/stones_complex.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -33,10 +33,10 @@
 #include <iostream>
 
 using namespace std;
-using namespace world;
-using namespace stones;
 
-
+namespace enigma { 
+
+
 /* -------------------- RotatorStone -------------------- */
 namespace
 {
@@ -134,7 +134,7 @@
     const double RotatorStone::IMPULSE_DELAY = 0.1;
 }
 
-
+
 /* -------------------- PullStone -------------------- */
 
 // When pushed this stone acts like pulled.
@@ -338,7 +338,7 @@
     sound_event("moveslow");
 }
 
-
+
 /* -------------------- Oneway stones -------------------- */
 
 // These stone can only be passed in one direction.
@@ -455,7 +455,7 @@
         return STONE_REBOUND;
 }
 
-
+
 /* -------------------- BolderStone -------------------- */
 
 /** \page st-bolder Bolder Stone
@@ -670,10 +670,10 @@
         void animcb() {
             switch (state) {
             case SHRINKING: {
-                Item *it = world::MakeItem("it-blocker-new");
-                world::SetItem(get_pos(), it);
+                Item *it = MakeItem("it-blocker-new");
+                SetItem(get_pos(), it);
                 TransferObjectName(this, it);
-                world::KillStone(get_pos());
+                KillStone(get_pos());
                 break;
             }
             case GROWING:
@@ -732,7 +732,7 @@
     DEF_TRAITSM(BlockerStone, "INVALID", st_INVALID, MOVABLE_BREAKABLE);
 }
 
-
+
 /* -------------------- Volcano -------------------- */
 namespace
 {
@@ -803,7 +803,7 @@
     DEF_TRAITSM(VolcanoStone, "st-volcano", st_volcano, MOVABLE_BREAKABLE);    
 }
 
-
+
 /* -------------------- BigBrick -------------------- */
 
 // BigBricks allow to build stones of any size based on st-brick.
@@ -954,9 +954,9 @@
     bool Window::tryInnerPull(Direction dir) {
         DirectionBits faces = get_connections();
         if (!has_dir(faces, dir) && has_dir(faces, reverse(dir))){
-            Stone *stone = world::GetStone(move(get_pos(), dir));
+            Stone *stone = GetStone(move(get_pos(), dir));
             if (!stone || ((stone->get_traits().id == st_window) &&  
-                    !has_dir(dynamic_cast<stones::ConnectiveStone *>(stone)->get_connections(), reverse(dir)))) {
+                    !has_dir(dynamic_cast<ConnectiveStone *>(stone)->get_connections(), reverse(dir)))) {
                 ReplaceStone(get_pos(), new Window((faces&(~to_bits(reverse(dir)))|to_bits(dir))+1));
                 return true;
             }
@@ -1036,7 +1036,7 @@
 */
 namespace
 {
-    class PuzzleStone : public ConnectiveStone, public TimeHandler, public world::PhotoCell {
+    class PuzzleStone : public ConnectiveStone, public TimeHandler, public PhotoCell {
         INSTANCELISTOBJ(PuzzleStone);
         DECL_TRAITS;
     public:
@@ -1635,7 +1635,7 @@
 }
 
 
-
+
 /* -------------------- DoorBase -------------------- */
 
 // Base class for everything that behaves like a door, i.e., it has
@@ -1729,12 +1729,12 @@
     switch (newstate) {
     case OPEN:
         set_model(basename+"-open");
-        lasers::MaybeRecalcLight(get_pos());
+        MaybeRecalcLight(get_pos());
         break;
     case CLOSED:
         set_model(basename+"-closed");
-        world::ShatterActorsInsideField (get_pos());
-        lasers::MaybeRecalcLight(get_pos()); // maybe superfluous
+        ShatterActorsInsideField (get_pos());
+        MaybeRecalcLight(get_pos()); // maybe superfluous
         break;
     case OPENING:
         sound_event (opening_sound().c_str());
@@ -1749,14 +1749,14 @@
             get_model()->reverse();
         else
             set_anim(basename+"-closing");
-        world::ShatterActorsInsideField (get_pos());
-        lasers::MaybeRecalcLight(get_pos());
+        ShatterActorsInsideField (get_pos());
+        MaybeRecalcLight(get_pos());
         break;
     }
     set_state(newstate);
 }
 
-
+
 /* -------------------- Door -------------------- */
 
 // Attributes:
@@ -1839,7 +1839,7 @@
     }
 }
 
-
+
 /* -------------------- ShogunStone -------------------- */
 
 // Attributes:
@@ -1993,7 +1993,6 @@
 }
 
 
-
 /* -------------------- Stone impulse stones -------------------- */
 
 // Messages:
@@ -2140,10 +2139,10 @@
             switch (st) {
             case IDLE:
                 init_model();
-                lasers::MaybeRecalcLight(get_pos());
+                MaybeRecalcLight(get_pos());
                 break;
             case PULSING:
-                lasers::MaybeRecalcLight(get_pos());
+                MaybeRecalcLight(get_pos());
                 set_anim("st-stoneimpulse-hollow-anim1");
                 break;
             case CLOSING:
@@ -2243,7 +2242,7 @@
                 st_stoneimpulse_movable, MOVABLE_STANDARD);
 }
 
-
+
 /* -------------------- Oxyd stone -------------------- */
 
 /** \page st-oxyd Oxyd Stone
@@ -2530,7 +2529,7 @@
     kill_model (p);
 }
 
-
+
 /* -------------------- Turnstiles -------------------- */
 namespace
 {
@@ -2649,7 +2648,7 @@
     DEF_TRAITSM(Turnstile_W, "st-turnstile-w", st_turnstile_w, MOVABLE_IRREGULAR);
 }
 
-
+
 /* -------------------- Turnstile_Arm -------------------- */
 
 void Turnstile_Arm::on_impulse(const Impulse& impulse) {
@@ -2943,7 +2942,7 @@
             continue;
         }
 
-        world::WarpActor(ac, ac_target_pos.x+.5, ac_target_pos.y+.5, false);
+        WarpActor(ac, ac_target_pos.x+.5, ac_target_pos.y+.5, false);
 
         if (Stone *st = GetStone(ac_target_pos)) {
 
@@ -2984,7 +2983,7 @@
 
 }
 
-
+
 /* -------------------- Mail stone -------------------- */
 
 namespace
@@ -3021,7 +3020,7 @@
     if (enigma::Inventory *inv = player::GetInventory(sc.actor)) {
         if (Item *it = inv->get_item(0)) {
             GridPos p = find_pipe_endpoint();
-            if (world::IsInsideLevel(p) && it->can_drop_at (p)) {
+            if (IsInsideLevel(p) && it->can_drop_at (p)) {
                 it = inv->yield_first();
                 player::RedrawInventory (inv);
                 it->drop(sc.actor, p);
@@ -3048,7 +3047,7 @@
 
     while (move_dir != NODIR) {
         p.move (move_dir);
-        if (Item *it = world::GetItem(p)) {
+        if (Item *it = GetItem(p)) {
             switch (get_id(it)) {
             case it_pipe_h:
                 if (!(move_dir == EAST || move_dir == WEST))
@@ -3090,7 +3089,7 @@
     return p;
 }
 
-
+
 /* -------------------- Chess stone -------------------- */
 
 namespace
@@ -3373,7 +3372,7 @@
     }
 }
 
-
+
 /* -------------------- Light Passenger Stone -------------------- */
 namespace
 {
@@ -3414,10 +3413,10 @@
                 set_anim("st-lightpassenger-blink"); break;
             case BREAK:
                 GridPos p = get_pos();
-                bool NorthSouth = lasers::LightFrom(p,NORTH) &&
-		    lasers::LightFrom(p,SOUTH);
-                bool EastWest = lasers::LightFrom(p,EAST) &&
-		    lasers::LightFrom(p,WEST);
+                bool NorthSouth = LightFrom(p,NORTH) &&
+		    LightFrom(p,SOUTH);
+                bool EastWest = LightFrom(p,EAST) &&
+		    LightFrom(p,WEST);
                 sound_event ("stonedestroy");
                 if(NorthSouth && !EastWest)
                     set_anim("st-lightpassenger-break-v");
@@ -3495,10 +3494,10 @@
         void alarm() {
             if(isLighted && (state == ACTIVE || state == BLINK)) {
                 GridPos p = get_pos();
-                int toSouth =    (lasers::LightFrom(p,NORTH)?1:0)
-                               + (lasers::LightFrom(p,SOUTH)?-1:0);
-                int toWest =   (lasers::LightFrom(p,EAST)?1:0)
-                             + (lasers::LightFrom(p,WEST)?-1:0);
+                int toSouth =    (LightFrom(p,NORTH)?1:0)
+                               + (LightFrom(p,SOUTH)?-1:0);
+                int toWest =   (LightFrom(p,EAST)?1:0)
+                             + (LightFrom(p,WEST)?-1:0);
                 if(toSouth * toWest != 0) {
                     // Light is coming from two directions. Choose the one you are
                     // *not* coming from (thus changing beams), in doubt: random.
@@ -3516,8 +3515,8 @@
                 if(skateDir == NODIR && state != BLINK) {
                     // No direction but lighted? Seems to be lasers from
                     // two opposite directions. Be sure and then start blinking.
-                    if(lasers::LightFrom(p,EAST) || lasers::LightFrom(p,WEST) ||
-                       lasers::LightFrom(p,NORTH) || lasers::LightFrom(p,SOUTH)) {
+                    if(LightFrom(p,EAST) || LightFrom(p,WEST) ||
+                       LightFrom(p,NORTH) || LightFrom(p,SOUTH)) {
                         state = BLINK;
                         init_model();
                     }
@@ -3555,9 +3554,10 @@
                 MOVABLE_IRREGULAR);
 }
 
+
 // --------------------------------------------------------------------------------
 
-void stones::Init_complex()
+void Init_complex()
 {
     Register(new BolderStone);
     Register("st-bolder-n", new BolderStone(NORTH));
@@ -3741,3 +3741,7 @@
     Register("st-lightpassenger", new LightPassengerStone(true));
     Register("st-lightpassenger_off", new LightPassengerStone(false));
 }
+
+} // namespace enigma
+
+

Modified: trunk/src/stones_internal.hh
===================================================================
--- trunk/src/stones_internal.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/stones_internal.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -37,9 +37,7 @@
 
 
 
-namespace stones
-{
-    using namespace world;
+namespace enigma {
 
     void Init_simple();
     void Init_complex();
@@ -63,7 +61,7 @@
     // @@@ FIXME: alarms have to be disabled as well
 
     class YieldedGridStone {
-        world::Stone   *stone;
+        Stone   *stone;
         display::Model *model;
 
         YieldedGridStone(const YieldedGridStone&);
@@ -104,7 +102,7 @@
 
         virtual void notify_onoff(bool /*on*/) {}
 
-        virtual Value on_message(const world::Message &msg)
+        virtual Value on_message(const Message &msg)
         {
             const std::string &m = msg.message;
             if (m=="onoff")
@@ -150,5 +148,6 @@
         }
     };
 
-}
+} // namespace enigma
+
 #endif

Modified: trunk/src/stones_simple.cc
===================================================================
--- trunk/src/stones_simple.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/stones_simple.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -27,10 +27,10 @@
 #include "stones_internal.hh"
 
 using namespace std;
-using namespace world;
-using namespace stones;
 
-
+namespace enigma {
+
+
 /* -------------------- SimpleStoneTraits -------------------- */
 
 namespace
@@ -70,7 +70,7 @@
     vector<SimpleStoneTraits*> SimpleStoneTraits::simple_stone_traits;
 }
 
-
+
 /* -------------------- SimpleStone -------------------- */
 
 namespace
@@ -944,7 +944,7 @@
                     sound_event ("stonepaint");
                     state = STONE;
                     set_model("st-greenbrown");
-                    lasers::MaybeRecalcLight(get_pos());
+                    MaybeRecalcLight(get_pos());
                 }
             }
         }
@@ -952,7 +952,6 @@
     };
 }
 
-
 /* -------------------- Wooden stone -------------------- */
 
 /** \page st-wood Wooden Stone
@@ -988,7 +987,7 @@
 
         void maybe_fall_or_stopfire() {
             GridPos p = get_pos();
-            if (world::IsLevelBorder(p))
+            if (IsLevelBorder(p))
                 return;
             if (Floor *fl = GetFloor(p)) {
                 const string &k = fl->get_kind();
@@ -1057,8 +1056,8 @@
     private:
         void init_model() { set_anim("st-wood-growing"); }
         void animcb() {
-            Stone *st = world::MakeStone ("st-wood");
-            world::ReplaceStone (get_pos(), st);
+            Stone *st = MakeStone ("st-wood");
+            ReplaceStone (get_pos(), st);
             SendMessage (st, "fall"); // instantly builds a bridge on fl-swamp etc
         }
         void actor_contact(Actor *a) {SendMessage(a, "shatter");}
@@ -1078,8 +1077,8 @@
     private:
         void init_model() { set_anim("st-greenbrown-growing"); }
         void animcb() {
-            Stone *st = world::MakeStone("st-greenbrown");
-            world::ReplaceStone(get_pos(), st);
+            Stone *st = MakeStone("st-greenbrown");
+            ReplaceStone(get_pos(), st);
         }
         void actor_contact(Actor *a) {SendMessage(a, "shatter");}
         void actor_inside(Actor *a) {SendMessage(a, "shatter");}
@@ -1096,8 +1095,8 @@
     private:
         void init_model() { set_anim("st-volcano-growing"); }
         void animcb() {
-            Stone *st = world::MakeStone("st-volcano_active");
-            world::ReplaceStone(get_pos(), st);
+            Stone *st = MakeStone("st-volcano_active");
+            ReplaceStone(get_pos(), st);
         }
         void actor_contact(Actor *a) {SendMessage(a, "shatter");}
         void actor_inside(Actor *a) {SendMessage(a, "shatter");}
@@ -1108,7 +1107,7 @@
     DEF_TRAITS(VolcanoStone_Growing, "st-volcano-growing", st_volcano_growing);
 }
 
-
+
 /* -------------------- Scissors stone -------------------- */
 
 /** \page st-scissors Scissors stone
@@ -1126,8 +1125,8 @@
         void actor_hit(const StoneContact &sc) {
             sound_event("scissors");
             set_anim("st-scissors-snip");
-            if (world::KillRubberBands (sc.actor))
-                world::PerformAction(this, false);
+            if (KillRubberBands (sc.actor))
+                PerformAction(this, false);
         }
         void animcb() {
             set_model("st-scissors");
@@ -1139,7 +1138,7 @@
     DEF_TRAITS(ScissorsStone, "st-scissors", st_scissors);
 }
 
-
+
 /* -------------------- Rubberband stone -------------------- */
 
 /** \page st-rubberband Rubberband stone
@@ -1169,7 +1168,7 @@
             double length = getAttr("length", 1.0);
             double minlength = getAttr("minlength");
 
-            world::RubberBandData rbd;
+            RubberBandData rbd;
             rbd.strength = strength;
             rbd.length = length;
             rbd.minlength = minlength;
@@ -1178,12 +1177,12 @@
             // other rubberbands to the actor will be cut of or not, true means they will. true is default.
             bool isScissor = to_bool(getAttr("scissor","true"));
 
-            if (!world::HasRubberBand (sc.actor, this)) {
+            if (!HasRubberBand (sc.actor, this)) {
                 sound_event ("rubberband");
                 if (isScissor) {
-                    world::KillRubberBand (sc.actor, (Stone*)0);
+                    KillRubberBand (sc.actor, (Stone*)0);
                 }
-                world::AddRubberBand (sc.actor, this, rbd);
+                AddRubberBand (sc.actor, this, rbd);
             }
             // if (player::wielded_item_is (sc.actor, "it-magicwand"))
             maybe_push_stone (sc);
@@ -1363,7 +1362,7 @@
     case FARTING:
     case BREAKING:
         if (state == IDLE) {
-            Object *ox = world::GetObjectTemplate("st-oxyd");
+            Object *ox = GetObjectTemplate("st-oxyd");
             SendMessage(ox, "closeall");
             sound_event("fart");
             if (newstate == BREAKING) {
@@ -1407,7 +1406,7 @@
 
 
 
-
+
 /* -------------------- Thief -------------------- */
 namespace
 {
@@ -1483,7 +1482,7 @@
         enigma::Inventory *inv = player::GetInventory(m_affected_actor);
         if (inv && inv->size() > 0) {
             if (bag == NULL) {
-                bag = world::MakeItem(it_bag);
+                bag = MakeItem(it_bag);
                 bag->setOwnerPos(get_pos());
             }
             int i = IntegerRand (0, int (inv->size()-1));
@@ -1497,15 +1496,15 @@
 Value ThiefStone::message(const string &msg, const Value &v) {
     if(msg == "capture" && state == IDLE) {
         state = CAPTURED;
-        Item * it =  world::GetItem(get_pos());
+        Item * it =  GetItem(get_pos());
         
         // add items on grid pos that can be picked up to our bag
         if (it != NULL && !(it->get_traits().flags & itf_static) && bag != NULL) {
-            dynamic_cast<ItemHolder *>(bag)->add_item(world::YieldItem(get_pos()));
+            dynamic_cast<ItemHolder *>(bag)->add_item(YieldItem(get_pos()));
         }
         // drop bag if pos is not occupied by a static item
-        if (world::GetItem(get_pos()) == NULL)
-            world::SetItem(get_pos(), bag);
+        if (GetItem(get_pos()) == NULL)
+            SetItem(get_pos(), bag);
         bag = NULL;
         set_anim(string(get_kind()) + "-captured");
         return Value(1);
@@ -1567,14 +1566,14 @@
 
         virtual Value message (const string &msg, const Value &) {
             if (msg == "signal") {
-                world::EmitSignalByIndex (this, m_signalidx, 0);
+                EmitSignalByIndex (this, m_signalidx, 0);
                 m_signalidx += 1;
-                if (!world::EmitSignalByIndex (this, m_signalidx, 1)) {
+                if (!EmitSignalByIndex (this, m_signalidx, 1)) {
                     m_signalidx = 0;
-                    world::EmitSignalByIndex (this, m_signalidx, 1);
+                    EmitSignalByIndex (this, m_signalidx, 1);
                 }
             } else if (msg == "init") {
-                world::EmitSignalByIndex (this, m_signalidx, 1);
+                EmitSignalByIndex (this, m_signalidx, 1);
             }
             return Value();
         }
@@ -1643,7 +1642,7 @@
     };
 }
 
-
+
 /* -------------------- Black Stones -------------------- */
 namespace
 {
@@ -1698,7 +1697,7 @@
 
 }
 
-
+
 /* -------------------- YinYang stones -------------------- */
 namespace
 {
@@ -1764,7 +1763,7 @@
     };
 }
 
-
+
 /* -------------------- BombStone -------------------- */
 
 namespace
@@ -1851,7 +1850,7 @@
     DEF_TRAITSM(MagicStone, "st-magic", st_magic, MOVABLE_BREAKABLE);
 }
 
-
+
 /* -------------------- DeathStone -------------------- */
 
 /** \page st-death Death's Head Stone
@@ -1888,7 +1887,7 @@
     DEF_TRAITS(DeathStone, "st-death", st_death);
 }
 
-
+
 /* -------------------- Invisible DeathStone -------------------- */
 
 /** \page st-death_invisible Death's Head Stone invivible
@@ -1938,7 +1937,7 @@
     DEF_TRAITS(DeathStoneInvisible, "st-death_invisible", st_death_invisible);
 }
 
-
+
 /* -------------------- Brake stone -------------------- */
 
 /** \page st-brake Brake
@@ -2004,7 +2003,7 @@
     DEF_TRAITSM(BrakeStone, "st-brake", st_brake, MOVABLE_BREAKABLE);
 }
 
-
+
 /* -------------------- Disco stones -------------------- */
 namespace
 {
@@ -2098,7 +2097,7 @@
     };
 }
 
-
+
 /* -------------------- Knight stone -------------------- */
 namespace
 {
@@ -2136,7 +2135,7 @@
     DEF_TRAITSM(Knight, "st-knight", st_knight, MOVABLE_BREAKABLE);
 }
 
-
+
 /* -------------------- Polarization Switch stone -------------------- */
 namespace
 {
@@ -2149,7 +2148,7 @@
         void actor_hit(const StoneContact &sc) { set_on(!is_on()); }
         void init_model() { set_model(is_on() ? "st-glass1" : "st-glass2"); }
         bool is_transparent(Direction) const { return this->is_on(); }
-        void notify_onoff(bool) { lasers::MaybeRecalcLight(this->get_pos()); }
+        void notify_onoff(bool) { MaybeRecalcLight(this->get_pos()); }
 
         StoneResponse collision_response(const StoneContact &sc) {
             if (sc.actor->is_invisible())
@@ -2162,7 +2161,7 @@
     DEF_TRAITS(PolarSwitchStone, "st-polarswitch", st_polarswitch);
 }
 
-
+
 /* -------------------- Fire breakable stones -------------------- */
 
 /* These stones mimic the behaviour of the plain-looking stones in
@@ -2249,24 +2248,24 @@
                 MOVABLE_IRREGULAR);
 }
 
-
+
 /* -------------------- Functions -------------------- */
 
-void world::DefineSimpleStone(const std::string &kind, 
+void DefineSimpleStone(const std::string &kind, 
                               const std::string &sound,
                               int hollow, int glass)
 {
     Register(new SimpleStone(kind, sound, hollow != 0, glass != 0));
 }
 
-void world::DefineSimpleStoneMovable(const std::string &kind, 
+void DefineSimpleStoneMovable(const std::string &kind, 
                                      const std::string &sound, 
                                      int glass)
 {
     Register(new SimpleStoneMovable(kind, sound, glass != 0));
 }
 
-void stones::Init_simple()
+void Init_simple()
 {
     Register(new ActorImpulseStone);
     Register(new ActorImpulseStoneInvisible);
@@ -2334,3 +2333,5 @@
     Register(new Stone_firebreak);
     Register(new Stone_movefirebreak);
 }
+
+} // namespace enigma

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/world.cc	2007-10-29 23:30:45 UTC (rev 912)
@@ -42,15 +42,16 @@
 // #define VERBOSE_MESSAGES
 
 using namespace std;
-using namespace world;
 using namespace ecl;
 
 #include "world_internal.hh"
 
+namespace enigma {
+
 // Size of one time step -- do not change!
 const double ActorTimeStep = 0.0025;
 
-
+
 /* -------------------- Auxiliary functions -------------------- */
 
 namespace {
@@ -70,7 +71,7 @@
     }
 }
 
-
+
 /* -------------------- ActorInfo -------------------- */
 
 ActorInfo::ActorInfo() : pos(), gridpos(), field(NULL), vel(), forceacc(),
@@ -88,7 +89,7 @@
 }
  
 Message::Message (const std::string &message_,
-                  const enigma::Value &value_,
+                  const Value &value_,
                   GridPos from_)
 : message (message_),
   value (value_),
@@ -96,7 +97,7 @@
 {
 }
 
-
+
 /* -------------------- Signals -------------------- */
 
 namespace
@@ -178,7 +179,7 @@
     }
 }
 
-
+
 /* -------------------- RubberBandData -------------------- */
 
 RubberBandData::RubberBandData () {
@@ -257,7 +258,7 @@
     model.update_second (get_p2());
 }
 
-
+
 /* -------------------- Field -------------------- */
 
 Field::Field()
@@ -274,7 +275,7 @@
     DisposeObject(stone);
 }
 
-
+
 /* -------------------- StoneContact -------------------- */
 
 //StoneContact::StoneContact(Actor *a, GridPos p,
@@ -293,10 +294,9 @@
   is_contact (false), outerCorner (false) {
 }
 
-DirectionBits
-world::contact_faces(const StoneContact &sc)
+DirectionBits contact_faces(const StoneContact &sc)
 {
-    using namespace enigma;
+//    using namespace enigma;
 
     int dirs = NODIRBIT;
 
@@ -312,8 +312,7 @@
     return DirectionBits(dirs);
 }
 
-Direction
-world::contact_face(const StoneContact &sc)
+Direction contact_face(const StoneContact &sc)
 {
     using namespace enigma;
     if (sc.normal == V2(-1,0))
@@ -328,7 +327,7 @@
         return NODIR;
 }
 
-
+
 /* -------------------- Global variables -------------------- */
 
 namespace
@@ -336,12 +335,12 @@
     auto_ptr<World> level;
 }
 
-enigma::Timer  world::GameTimer;
-bool           world::TrackMessages;
-Actor         *world::CurrentCollisionActor = 0;
+enigma::Timer  GameTimer;
+bool           TrackMessages;
+Actor         *CurrentCollisionActor = 0;
 
 
-
+
 /* -------------------- Layer implementation -------------------- */
 
 template <class T>
@@ -383,7 +382,7 @@
 
 
 
-
+
 /* -------------------- World -------------------- */
 
 const double World::contact_e = 0.02;  // epsilon distant limit for contacts
@@ -546,7 +545,7 @@
 
     GameTimer.tick(dtime);
 
-    lasers::RecalcLightNow();   // recalculate laser beams if necessary
+    RecalcLightNow();   // recalculate laser beams if necessary
 }
 
 /* ---------- Puzzle scrambling -------------------- */
@@ -710,14 +709,14 @@
     c.outerCorner = false;
     bool isInnerContact = false;
 
-    Stone *stone = (st != NULL) ? st : world::GetStone(p);
+    Stone *stone = (st != NULL) ? st : GetStone(p);
     if (!stone)
         return;
 
     bool isWindow = stone->get_traits().id == st_window;
     DirectionBits wsides;
     if (isWindow) {
-        wsides = dynamic_cast<stones::ConnectiveStone *>(stone)->get_connections();
+        wsides = dynamic_cast<ConnectiveStone *>(stone)->get_connections();
     }
     
     const ActorInfo &ai = *a->get_actorinfo();
@@ -765,8 +764,8 @@
             else if ( ycorner && xoff_neighbour) face = SOUTHBIT;
             
             // the faces that the neighbour window owns
-            stones::ConnectiveStone * neighbour = dynamic_cast<stones::ConnectiveStone *>
-                    (world::GetStone(GridPos(x+xoff_neighbour, y+yoff_neighbour)));
+            ConnectiveStone * neighbour = dynamic_cast<ConnectiveStone *>
+                    (GetStone(GridPos(x+xoff_neighbour, y+yoff_neighbour)));
             DirectionBits face_neighbour = (neighbour) ? neighbour->get_connections() : NODIRBIT;
             
             
@@ -952,9 +951,9 @@
  */
 void World::find_contact_with_edge(Actor *a, GridPos p0, GridPos p1, GridPos p2, 
         StoneContact &c0, StoneContact &c1, StoneContact &c2, DirectionBits winFacesActorStone) {
-    Stone *s0 = world::GetStone(p0);
-    Stone *s1 = world::GetStone(p1);
-    Stone *s2 = world::GetStone(p2);
+    Stone *s0 = GetStone(p0);
+    Stone *s1 = GetStone(p1);
+    Stone *s2 = GetStone(p2);
     if (s0 != NULL) c0.response = s0->collision_response(c0);
     if (s1 != NULL) c1.response = s1->collision_response(c1);
     if (s2 != NULL) c2.response = s2->collision_response(c2);
@@ -1031,7 +1030,7 @@
     
     // info about a Window stone on the Gridpos of the actor that may cause
     // contacts within the grid
-    stones::ConnectiveStone * actorWinStone = dynamic_cast<stones::ConnectiveStone *>(world::GetStone(g));
+    ConnectiveStone * actorWinStone = dynamic_cast<ConnectiveStone *>(GetStone(g));
     DirectionBits winFacesActorStone = (actorWinStone) ? actorWinStone->get_connections() : NODIRBIT;
     
     // distinguish 9 squares within gridpos that may cause contacts
@@ -1176,7 +1175,7 @@
             bool slow_collision = length (ai.vel) < 0.3;
             if (!has_nearby_contact(ai.last_contacts, ai.last_contacts_count, 
                     contact)) {
-                if (Stone *stone = world::GetStone(sc.stonepos)) {
+                if (Stone *stone = GetStone(sc.stonepos)) {
                     CurrentCollisionActor = a;
                     if (slow_collision) stone->actor_touch(sc);
                     else stone->actor_hit(sc);
@@ -1204,7 +1203,7 @@
         }
     }
     else if (sc.is_contact) {
-        if (Stone *stone = world::GetStone(sc.stonepos))
+        if (Stone *stone = GetStone(sc.stonepos))
             stone->actor_contact(sc.actor);
     }
 }
@@ -1632,35 +1631,35 @@
         if (Stone *stn = GetStone(move(p, WEST)))
             stn->freeze_check();
 
-        lasers::MaybeRecalcLight(p);
+        MaybeRecalcLight(p);
     }
 }
 
 
 
-
+
 /* -------------------- Functions -------------------- */
 
-void world::Resize (int w, int h)
+void Resize (int w, int h)
 {
     level.reset (new World(w,h));
     display::NewWorld(w, h);
     server::WorldInitialized = true;
 }
 
-void world::PrepareLevel ()
+void WorldPrepareLevel ()
 {
     GameTimer.clear();
     CurrentCollisionActor = 0;
     Resize (20, 13);
 }
 
-bool world::InitWorld()
+bool WorldInitLevel()
 {
     level->scramble_puzzles();
 
-    lasers::RecalcLight();
-    lasers::RecalcLightNow();    // recalculate laser beams if necessary
+    RecalcLight();
+    RecalcLightNow();    // recalculate laser beams if necessary
 
     bool seen_player0 = false;
 
@@ -1685,7 +1684,7 @@
     if (!seen_player0) 
         throw XLevelLoading("Error: No player 0 defined!");
 
-    world::BroadcastMessage("init", Value(),
+    BroadcastMessage("init", Value(),
         GridLayerBits(GRID_ITEMS_BIT | GRID_STONES_BIT | GRID_FLOOR_BIT));
 
     server::InitMoveCounter();
@@ -1698,12 +1697,12 @@
     return true;
 }
 
-void world::SetMouseForce(V2 f)
+void SetMouseForce(V2 f)
 {
     level->m_mouseforce.add_force(f);
 }
 
-void world::NameObject(Object *obj, const std::string &name)
+void NameObject(Object *obj, const std::string &name)
 {
     string old_name;
     if (Value v = obj->getAttr("name")) {
@@ -1715,12 +1714,12 @@
     level->name_object (obj, name);
 }
 
-void world::UnnameObject(Object *obj)
+void UnnameObject(Object *obj)
 {
     level->unname(obj);
 }
 
-void world::TransferObjectName (Object *source, Object *target)
+void TransferObjectName (Object *source, Object *target)
 {
     if (Value v = source->getAttr("name")) {
         string name(v);
@@ -1734,54 +1733,54 @@
     }
 }
 
-Object * world::GetNamedObject (const std::string &name)
+Object * GetNamedObject (const std::string &name)
 {
     return level->get_named (name);
 }
 
-std::list<Object *> world::GetNamedGroup(const std::string &name) {
+std::list<Object *> GetNamedGroup(const std::string &name) {
     return level->get_group(name);
 }
 
-bool world::IsLevelBorder(const GridPos &p) {
+bool IsLevelBorder(const GridPos &p) {
     return level->is_border(p);
 }
 
-bool world::IsInsideLevel(const GridPos &p) {
+bool IsInsideLevel(const GridPos &p) {
     return level->contains(p);
 }
 
 /* -------------------- Force fields -------------------- */
 
-void world::AddForceField(ForceField *ff)
+void AddForceField(ForceField *ff)
 {
     level->forces.push_back(ff);
 }
 
-void world::RemoveForceField(ForceField *ff) {
+void RemoveForceField(ForceField *ff) {
     level->remove (ff);
 }
 
-void world::SetConstantForce (V2 force) {
+void SetConstantForce (V2 force) {
     level->m_flatforce.set_force(force);
 }
 
 
 /* -------------------- Rubber bands -------------------- */
 
-void world::AddRubberBand (Actor *a, Stone *st, const RubberBandData &d)
+void AddRubberBand (Actor *a, Stone *st, const RubberBandData &d)
 {
     level->m_rubberbands.push_back(new RubberBand (a, st, d));
 }
 
-void world::AddRubberBand (Actor *a, Actor *a2, const RubberBandData &d)
+void AddRubberBand (Actor *a, Actor *a2, const RubberBandData &d)
 {
     RubberBandData rbd (d);
     rbd.length = ecl::Max (d.length, get_radius(a) + get_radius(a2));
     level->m_rubberbands.push_back(new RubberBand (a, a2, rbd));
 }
 
-bool world::KillRubberBands (Actor *a)
+bool KillRubberBands (Actor *a)
 {
     bool didKill = false;
     for (unsigned i=0; i<level->m_rubberbands.size(); ) {
@@ -1798,7 +1797,7 @@
 }
 
 
-void world::KillRubberBand (Actor *a, Stone *st)
+void KillRubberBand (Actor *a, Stone *st)
 {
     ASSERT(a, XLevelRuntime, "KillRubberBand: no actor attached");
     for (unsigned i=0; i<level->m_rubberbands.size(); ) {
@@ -1813,7 +1812,7 @@
     }
 }
 
-void world::KillRubberBand (Actor *a, Actor *a2)
+void KillRubberBand (Actor *a, Actor *a2)
 {
     ASSERT(a, XLevelRuntime, "KillRubberBand: no actor attached");
     for (unsigned i=0; i<level->m_rubberbands.size(); ) {
@@ -1828,7 +1827,7 @@
     }
 }
 
-void world::KillRubberBands (Stone *st)
+void KillRubberBands (Stone *st)
 {
    for (unsigned i=0; i<level->m_rubberbands.size(); ) {
         RubberBand &r = *level->m_rubberbands[i];
@@ -1841,7 +1840,7 @@
     }
 }
 
-void world::GiveRubberBands (Stone *st, vector<Rubber_Band_Info> &rubs) {
+void GiveRubberBands (Stone *st, vector<Rubber_Band_Info> &rubs) {
    for (unsigned i=0; i<level->m_rubberbands.size(); ) {
         RubberBand &r = *level->m_rubberbands[i];
         if (r.get_stone() == st) {
@@ -1854,7 +1853,7 @@
     }
 }
 
-bool world::HasRubberBand (Actor *a, Stone *st)
+bool HasRubberBand (Actor *a, Stone *st)
 {
     for (unsigned i=0; i<level->m_rubberbands.size(); ++i) {
         RubberBand &r = *level->m_rubberbands[i];
@@ -1864,10 +1863,10 @@
     return false;
 }
 
- 
+
 /* -------------------- Signals -------------------- */
 
-void world::AddSignal (const GridLoc &srcloc, 
+void AddSignal (const GridLoc &srcloc, 
                        const GridLoc &dstloc, 
                        const string &msg)
 {
@@ -1885,7 +1884,7 @@
     }
 }
 
-bool world::HaveSignals (Object *src) 
+bool HaveSignals (Object *src) 
 {
     SignalList::const_iterator i=level->m_signals.begin(),
         end = level->m_signals.end();
@@ -1896,12 +1895,12 @@
 }
 
 
-bool world::EmitSignalByIndex (Object *src, int signalidx, int value) 
+bool EmitSignalByIndex (Object *src, int signalidx, int value) 
 {
     return emit_by_index (level->m_signals, src, signalidx, value);
 }
 
-bool world::GetSignalTargetPos (Object *src, GridPos &pos, int signalidx) 
+bool GetSignalTargetPos (Object *src, GridPos &pos, int signalidx) 
 {
     SignalList::const_iterator i = level->m_signals.begin(),
         end = level->m_signals.end();
@@ -1919,17 +1918,17 @@
 }
 
 
-Value world::SendMessage(Object *o, const std::string &msg) 
+Value SendMessage(Object *o, const std::string &msg) 
 {
     return SendMessage (o, Message (msg, Value()));
 }
 
-Value world::SendMessage(Object *o, const std::string &msg, const Value& value)
+Value SendMessage(Object *o, const std::string &msg, const Value& value)
 {
     return SendMessage (o, Message (msg, value));
 }
 
-Value world::SendMessage (Object *o, const Message &m)
+Value SendMessage (Object *o, const Message &m)
 {
     if (o) {
         if (TrackMessages)
@@ -1944,7 +1943,7 @@
 }
 
 
-void world::BroadcastMessage (const std::string& msg, 
+void BroadcastMessage (const std::string& msg, 
                               const Value& value, 
                               GridLayerBits grids)
 {
@@ -1966,7 +1965,7 @@
 }
 
 
-void world::PerformAction (Object *o, bool onoff) 
+void PerformAction (Object *o, bool onoff) 
 {
     string action = "idle";
     string target(o->getAttr("target"));
@@ -2017,7 +2016,7 @@
     }
 }
 
-void world::SendExplosionEffect(GridPos center, ExplosionType type) 
+void SendExplosionEffect(GridPos center, ExplosionType type) 
 {
     const int AFFECTED_FIELDS       = 8;
 
@@ -2067,7 +2066,7 @@
     }
 }
 
-Object *world::GetObject (const GridLoc &l)
+Object *GetObject (const GridLoc &l)
 {
     switch (l.layer) {
     case GRID_FLOOR:  return GetFloor(l.pos);
@@ -2077,25 +2076,25 @@
     }
 }
 
-const Field *world::GetField (GridPos p)
+const Field *GetField (GridPos p)
 {
     return level->get_field(p);
 }
 
-
+
 /* -------------------- Floor manipulation -------------------- */
 
-void world::KillFloor(GridPos p) 
+void KillFloor(GridPos p) 
 {
     level->fl_layer.kill(p);
 }
 
-Floor *world::GetFloor(GridPos p) 
+Floor *GetFloor(GridPos p) 
 {
     return level->fl_layer.get(p);
 }
 
-void world::SetFloor(GridPos p, Floor* fl) 
+void SetFloor(GridPos p, Floor* fl) 
 {
     level->fl_layer.set(p,fl);
     if (!level->preparing_level)
@@ -2103,33 +2102,33 @@
             st->on_floor_change();
 }
 
-
+
 /* -------------------- Stone manipulation -------------------- */
 
-Stone * world::GetStone(GridPos p) {
+Stone * GetStone(GridPos p) {
     if (Field *f = level->get_field (p))
         return f->stone;
     else
         return level->st_layer.get(p);
 }
 
-void world::KillStone(GridPos p) {
+void KillStone(GridPos p) {
     level->st_layer.kill(p);
     level->changed_stones.push_back(p);
 }
 
-Stone * world::YieldStone(GridPos p) {
+Stone * YieldStone(GridPos p) {
     Stone *st = level->st_layer.yield(p);
     level->changed_stones.push_back(p);
     return st;
 }
 
-void world::SetStone(GridPos p, Stone* st) {
+void SetStone(GridPos p, Stone* st) {
     level->st_layer.set(p,st);
     level->changed_stones.push_back(p);
 }
 
-void world::ReplaceStone (GridPos p, Stone* st) {
+void ReplaceStone (GridPos p, Stone* st) {
     Stone *old = level->st_layer.get(p);
     if (old) {
         TransferObjectName(old, st);
@@ -2138,74 +2137,74 @@
     SetStone(p, st);
 }
 
-void world::MoveStone (GridPos oldPos, GridPos newPos) {
+void MoveStone (GridPos oldPos, GridPos newPos) {
     SetStone(newPos, YieldStone(oldPos));
 }
 
-void world::SetScrambleIntensity (int intensity) {
+void SetScrambleIntensity (int intensity) {
     level->scrambleIntensity = intensity;
 }
 
-void world::AddScramble(GridPos p, Direction d) {
+void AddScramble(GridPos p, Direction d) {
     level->add_scramble(p, d);
 }
 
-
+
 /* -------------------- Item manipulation -------------------- */
 
-void world::KillItem(GridPos p) 
+void KillItem(GridPos p) 
 {
-    lasers::MaybeRecalcLight(p);
+    MaybeRecalcLight(p);
     level->it_layer.kill(p);
 }
 
-Item *world::GetItem(GridPos p) {
+Item *GetItem(GridPos p) {
     return level->it_layer.get(p);
 }
 
-Item *world::YieldItem(GridPos p) {
-    lasers::MaybeRecalcLight(p);
+Item *YieldItem(GridPos p) {
+    MaybeRecalcLight(p);
     return level->it_layer.yield(p);
 }
 
-void world::SetItem (GridPos p, Item* it) 
+void SetItem (GridPos p, Item* it) 
 {
-    lasers::MaybeRecalcLight(p);
+    MaybeRecalcLight(p);
     level->it_layer.set(p,it);
 }
 
-void world::SetItem (GridPos p, ItemID id) 
+void SetItem (GridPos p, ItemID id) 
 {
     SetItem (p, MakeItem (id));
 }
 
-
+
 /* -------------------- Actor manipulation -------------------- */
 
-void world::AddActor(double x, double y, Actor* a) 
+void AddActor(double x, double y, Actor* a) 
 {
     level->add_actor (a, V2(x, y));
 }
 
-void world::AddActor (Actor *a)
+void AddActor (Actor *a)
 {
     level->add_actor (a);
 }
 
-void  world::DidMoveActor(Actor *a) {
+void  DidMoveActor(Actor *a) {
     level->did_move_actor(a);
 }
 
-Actor * world::YieldActor(Actor *a) 
+Actor * YieldActor(Actor *a) 
 {
     return level->yield_actor(a);
 }
 
-void world::KillActor (Actor *a) {
+void KillActor (Actor *a) {
     delete YieldActor (a);
 }
 
-void world::WarpActor(Actor *a, double newx, double newy, bool keep_velocity)
+void WarpActor(Actor *a, double newx, double newy, bool keep_velocity)
 {
     V2 newpos = V2(newx, newy);
     ASSERT(IsInsideLevel(GridPos(newpos)), XLevelRuntime,
@@ -2215,14 +2214,14 @@
     a->warp(newpos);
 }
 
-void world::FastRespawnActor(Actor *a, bool keep_velocity) {
+void FastRespawnActor(Actor *a, bool keep_velocity) {
     a->find_respawnpos();
     const V2& p = a->get_respawnpos();
     WarpActor(a, p[0], p[1], keep_velocity);
 }
 
 
-void world::RespawnActor(Actor *a) {
+void RespawnActor(Actor *a) {
     a->find_respawnpos();
     a->respawn();
 }
@@ -2239,7 +2238,7 @@
     return 0;
 }
 
-unsigned world::CountActorsOfKind (ActorID id) 
+unsigned CountActorsOfKind (ActorID id) 
 {
     unsigned count = 0;
     ActorList::iterator i = level->actorlist.begin(),
@@ -2252,7 +2251,7 @@
     return count;
 }
 
-Actor *world::FindOtherMarble(Actor *thisMarble) 
+Actor *FindOtherMarble(Actor *thisMarble) 
 {
     if (!thisMarble) 
         return 0;
@@ -2265,7 +2264,7 @@
     }
 }
 
-bool world::ExchangeMarbles(Actor *marble1) {
+bool ExchangeMarbles(Actor *marble1) {
     Actor *marble2 = FindOtherMarble(marble1);
     if (marble2) {
         level->exchange_actors(marble1, marble2);
@@ -2275,17 +2274,17 @@
 }
 
 
-void world::GrabActor(Actor *a)
+void GrabActor(Actor *a)
 {
     a->get_actorinfo()->grabbed = true;
 }
 
-void world::ReleaseActor(Actor *a)
+void ReleaseActor(Actor *a)
 {
     a->get_actorinfo()->grabbed = false;
 }
 
-bool world::GetActorsInRange (ecl::V2 center, double range,
+bool GetActorsInRange (ecl::V2 center, double range,
                               vector<Actor*>& actors)
 {
     ActorList &al = level->actorlist;
@@ -2297,7 +2296,7 @@
     return !actors.empty();
 }
 
-bool world::GetActorsInsideField (const GridPos& pos, vector<Actor*>& actors)
+bool GetActorsInsideField (const GridPos& pos, vector<Actor*>& actors)
 {
     ActorList &al = level->actorlist;
     for (ActorList::iterator i=al.begin(); i!=al.end(); ++i) {
@@ -2308,7 +2307,7 @@
     return !actors.empty();
 }
 
-void world::ShatterActorsInsideField (const GridPos &p)
+void ShatterActorsInsideField (const GridPos &p)
 {
     vector<Actor *> actors;
     GetActorsInsideField (p, actors);
@@ -2318,10 +2317,10 @@
         SendMessage(*i, "shatter");
 }
 
-
+
 /* -------------------- Functions -------------------- */
 
-void world::addDelayedImpulse (const Impulse& impulse, double delay, 
+void addDelayedImpulse (const Impulse& impulse, double delay, 
                                const Stone *estimated_receiver) 
 {
     // @@@ FIXME: is a special handling necessary if several impulses hit same destination ?
@@ -2329,7 +2328,7 @@
     level->delayed_impulses.push_back(DelayedImpulse(impulse, delay, estimated_receiver));
 }
 
-void world::revokeDelayedImpulses(const Stone *target) {
+void revokeDelayedImpulses(const Stone *target) {
     // Any stone may call this function on deletion.
     // When the repository shuts down no world is existing thus check
     // world first.
@@ -2337,7 +2336,7 @@
         level->revoke_delayed_impulses(target);
 }
 
-float world::getVolume(const char *name, Object *obj, float def_volume)
+float getVolume(const char *name, Object *obj, float def_volume)
 {
     // See sound.hh and sound.cc for details.
     SoundDampingList::iterator i = level->sound_dampings.begin(),
@@ -2352,11 +2351,11 @@
     return def_volume;
 }
 
-void world::Tick(double dtime) {
+void WorldTick(double dtime) {
     level->tick (dtime);
 }
 
-void world::TickFinished () {
+void TickFinished () {
     for (unsigned i=0; i<level->actorlist.size(); ++i) {
         level->actorlist[i]->move_screen();
     }
@@ -2366,16 +2365,16 @@
         level->m_rubberbands[i]->tick (0.0);
 }
 
-void world::Init()
+void InitWorld()
 {
     InitActors();
-    lasers::Init();
+    InitLasers();
     InitItems();
-    stones::Init();
+    InitStones();
     InitFloors();
 }
 
-void world::Shutdown()
+void ShutdownWorld()
 {
     level.reset();
     player::PlayerShutdown();
@@ -2475,7 +2474,7 @@
     vector<Item *> item_repos(it_COUNT);
 }
 
-void world::Register (const string &kind, Object *obj) {
+void Register (const string &kind, Object *obj) {
     if (!repos)
         repos = new ObjectRepos;
     if (kind.empty())
@@ -2485,22 +2484,22 @@
 }
 
 
-void world::Register (Object *obj) {
+void Register (Object *obj) {
     Register (obj->get_kind(), obj);
 }
 
-void world::Register (const string &kind, Floor *obj)
+void Register (const string &kind, Floor *obj)
 {
     Object *o = obj;
     Register(kind, o);
 }
 
-void world::Register (const string &kind, Stone *obj) {
+void Register (const string &kind, Stone *obj) {
     Object *o = obj;
     Register(kind, o);
 }
 
-void world::RegisterStone (Stone *stone) 
+void RegisterStone (Stone *stone) 
 {
     Register(static_cast<Object*>(stone));
     StoneID id = get_id(stone);
@@ -2509,7 +2508,7 @@
     stone_repos[id] = stone;
 }
 
-void world::RegisterActor (Actor *actor) 
+void RegisterActor (Actor *actor) 
 {
     Register(static_cast<Object*>(actor));
     ActorID id = get_id(actor);
@@ -2518,11 +2517,11 @@
     actor_repos[id] = actor;
 }
 
-void world::Repos_Shutdown() {
+void Repos_Shutdown() {
     delete repos;
 }
 
-Object * world::MakeObject(const char *kind) {
+Object * MakeObject(const char *kind) {
     static Object *last_templ = 0;
     static string last_kind;
 
@@ -2539,7 +2538,7 @@
     return o;
 }
 
-Object * world::GetObjectTemplate(const std::string &kind) {
+Object * GetObjectTemplate(const std::string &kind) {
     if (!repos->has_templ(kind)) {
         cerr << "GetObjectTemplate: unkown object name `" <<kind<< "'.\n";
         return 0;
@@ -2547,19 +2546,19 @@
         return repos->get_template(kind);
 }
 
-Floor* world::MakeFloor(const char *kind) {
+Floor* MakeFloor(const char *kind) {
     return dynamic_cast<Floor*>(MakeObject(kind));
 }
 
-Stone * world::MakeStone (const char *kind) {
+Stone * MakeStone (const char *kind) {
     return dynamic_cast<Stone*>(MakeObject(kind));
 }
 
-Actor * world::MakeActor (const char *kind) {
+Actor * MakeActor (const char *kind) {
     return dynamic_cast<Actor*>(MakeObject(kind));
 }
 
-Actor *world::MakeActor (ActorID id) 
+Actor *MakeActor (ActorID id) 
 {
     if (Actor *ac = actor_repos[id])
         return ac->clone();
@@ -2568,7 +2567,7 @@
     return 0;
 }
 
-Stone *world::MakeStone (StoneID id) 
+Stone *MakeStone (StoneID id) 
 {
     if (Stone *st = stone_repos[id])
         return st->clone();
@@ -2578,14 +2577,14 @@
 }
 
 
-void world::DisposeObject(Object *o) {
+void DisposeObject(Object *o) {
     if (o != 0) {
         UnnameObject(o);
         o->dispose();
     }
 }
 
-void world::DefineSimpleFloor(const std::string &kind, double friction,
+void DefineSimpleFloor(const std::string &kind, double friction,
                               double mousefactor, bool burnable,
                               const std::string &firetransform)
 {
@@ -2594,19 +2593,19 @@
              firetransform.c_str(), ""));
 }
 
-void world::DumpObjectInfo() {
+void DumpObjectInfo() {
     repos->dump_info();
 }
 
 /* ------------------- Item repository ------------------- */
 
-void world::Register (const string &kind, Item *obj) 
+void Register (const string &kind, Item *obj) 
 {
     Object *o = obj;
-    world::Register(kind, o);
+    Register(kind, o);
 }
 
-void world::RegisterItem (Item *item) 
+void RegisterItem (Item *item) 
 {
     Register(static_cast<Object*>(item));
     ItemID id = get_id(item);
@@ -2615,7 +2614,7 @@
     item_repos[id] = item;
 }
 
-Item *world::MakeItem (ItemID id) 
+Item *MakeItem (ItemID id) 
 {
     if (Item *it = item_repos[id])
         return it->clone();
@@ -2624,6 +2623,7 @@
     return 0;
 }
 
-Item * world::MakeItem(const char *kind) {
+Item * MakeItem(const char *kind) {
     return dynamic_cast<Item*>(MakeObject(kind));
 }
+} // namespace enigma

Modified: trunk/src/world.hh
===================================================================
--- trunk/src/world.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/world.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -19,13 +19,13 @@
 #ifndef WORLD_HH_INCLUDED
 #define WORLD_HH_INCLUDED
 
+#include "enigma.hh"
 #include "objects.hh"
 #include "util.hh"
 
-namespace world
-{
-    using namespace enigma;
+namespace enigma {
 
+
 /* -------------------- Types -------------------- */
 
     using ecl::V2;
@@ -52,13 +52,13 @@
     struct Message {
         // Variables
         std::string    message;
-        enigma::Value  value;
+        Value  value;
         GridPos        gridpos;
 
         // Constructors
         Message ();
         Message (const std::string &message,
-                 const enigma::Value &value,
+                 const Value &value,
                  GridPos gridpos = GridPos());
 
     };
@@ -146,22 +146,22 @@
 
 /* -------------------- World Management -------------------- */
 
-    void Init();
+    void InitWorld();
 
-    void PrepareLevel ();
+    void WorldPrepareLevel();
 
     /* Create a new, empty world with width `w' and height `h`. */
     void Resize (int w, int h);
 
     /* Initialize the world after loading it.  Call this after loading
        the world to force laser beams to be recalculated etc. */
-    bool InitWorld();
+    bool WorldInitLevel();
 
-    void Tick(double dtime);
+    void WorldTick(double dtime);
     void TickFinished ();
 
     // Destroy all objects and the complete object repository
-    void Shutdown();
+    void ShutdownWorld();
 
 
     bool IsLevelBorder(const GridPos &p);
@@ -184,7 +184,7 @@
 
     void SetConstantForce (V2 force);
 
-
+
 /* -------------------- Rubbers Bands -------------------- */
 
     struct RubberBandData {
@@ -237,7 +237,7 @@
     void AddScramble(GridPos p, Direction d);
 
 
-
+
 /* -------------------- Signals & Messages -------------------- */
 
     void    AddSignal (const GridLoc &src, 
@@ -252,11 +252,11 @@
     /* Signal indices start at 0 */
     bool GetSignalTargetPos (Object *src, GridPos &pos, int signalidx = 0);
 
-    void BroadcastMessage (const std::string& msg, const enigma::Value& value, 
+    void BroadcastMessage (const std::string& msg, const Value& value, 
                            GridLayerBits grids);
 
     Value SendMessage (Object *o, const string &msg);
-    Value SendMessage (Object *o, const string &msg, const enigma::Value& value);
+    Value SendMessage (Object *o, const string &msg, const Value& value);
     Value SendMessage (Object *o, const Message &m);
 
     /*! This function is used by all triggers, switches etc. that
@@ -265,7 +265,7 @@
       "action" and "target" attributes of `o'. */
     void PerformAction (Object *o, bool onoff);
 
-
+
 /* -------------------- Actors -------------------- */
 
     void   AddActor (Actor *a);
@@ -415,6 +415,7 @@
 
     /* Print information about all registered objects to stdout. */
     void DumpObjectInfo();
-}
+    
+} // namespace enigma
 
 #endif

Modified: trunk/src/world_internal.hh
===================================================================
--- trunk/src/world_internal.hh	2007-10-25 07:12:35 UTC (rev 911)
+++ trunk/src/world_internal.hh	2007-10-29 23:30:45 UTC (rev 912)
@@ -19,8 +19,8 @@
 
 #include <memory>
 
-namespace world
-{
+namespace enigma {
+
     struct Field;
     struct Signal;
 
@@ -372,5 +372,6 @@
 
         list<Scramble> scrambles;
     };
-}
+    
+} // namespace enigma
 



From ral at mail.berlios.de  Wed Oct 31 00:56:32 2007
From: ral at mail.berlios.de (ral at BerliOS)
Date: Wed, 31 Oct 2007 00:56:32 +0100
Subject: [Enigma-game-svn] r913 - in trunk/src: . stones
Message-ID: <200710302356.l9UNuWBe019781@sheep.berlios.de>

Author: ral
Date: 2007-10-31 00:56:30 +0100 (Wed, 31 Oct 2007)
New Revision: 913

Added:
   trunk/src/stones/
   trunk/src/stones/ConnectiveStone.cc
   trunk/src/stones/ConnectiveStone.hh
   trunk/src/stones/OxydStone.cc
   trunk/src/stones/OxydStone.hh
   trunk/src/stones/WindowStone.cc
   trunk/src/stones/WindowStone.hh
Modified:
   trunk/src/Makefile.am
   trunk/src/objects.cc
   trunk/src/objects_decl.hh
   trunk/src/stones_complex.cc
   trunk/src/stones_internal.hh
   trunk/src/world.cc
   trunk/src/world.hh
Log:
Trunk 1.1: Reengineering object template registration
- extracted classes OxydStone, ConnectiveStone, WindowStone into
  own files in src/stones
- eliminated anonymous namespaces braces of these classes
- added new objec template registration at file boot time
  (see comments on class Object)


Modified: trunk/src/Makefile.am
===================================================================
--- trunk/src/Makefile.am	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/Makefile.am	2007-10-30 23:56:30 UTC (rev 913)
@@ -182,7 +182,13 @@
 	lev/ScoreManager.cc	\
 	lev/ScoreManager.hh	\
 	lev/VolatileIndex.cc	\
-	lev/VolatileIndex.hh
+	lev/VolatileIndex.hh	\
+	stones/ConnectiveStone.cc	\
+	stones/ConnectiveStone.hh	\
+	stones/OxydStone.cc	\
+	stones/OxydStone.hh	\
+	stones/WindowStone.cc	\
+	stones/WindowStone.hh
 
 datadir = @datadir@
 

Modified: trunk/src/objects.cc
===================================================================
--- trunk/src/objects.cc	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/objects.cc	2007-10-30 23:56:30 UTC (rev 913)
@@ -47,11 +47,31 @@
 int Object::next_id = 1;
 std::map<int, Object *> Object::objects;
 
-int Object::getNextId(Object *obj) {
-    objects[next_id] = obj;
-    return next_id++;
+int Object::getNextId(Object *obj, bool bootFinished) {
+    static bool isBooting = true;
+    static int nextIdBoot = 1;
+    static std::map<int, Object *> objectsBoot;
+    
+    if (isBooting) {
+        if (bootFinished) {
+            isBooting = false;
+            next_id = nextIdBoot;
+            objects = objectsBoot;
+            return 0;
+        } else {
+            objectsBoot[nextIdBoot] = obj;
+            return nextIdBoot++;
+        }
+    } else {
+        objects[next_id] = obj;
+        return next_id++;
+    }
 }
 
+void Object::bootFinished() {
+    getNextId(NULL, true);
+}
+
 void Object::freeId(int id) {
     objects.erase(id);
 }
@@ -65,16 +85,16 @@
 }
 
 Object::Object() {
-    id = getNextId(this);
+    id = getNextId(this, false);
 }
 
 Object::Object(const char *kind) {
     set_attrib("kind", Value(kind));
-    id = getNextId(this);
+    id = getNextId(this, false);
 }
 
 Object::Object(const Object &src_obj) {
-    id = getNextId(this);
+    id = getNextId(this, false);
     attribs = src_obj.attribs;
 }
 

Modified: trunk/src/objects_decl.hh
===================================================================
--- trunk/src/objects_decl.hh	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/objects_decl.hh	2007-10-30 23:56:30 UTC (rev 913)
@@ -20,6 +20,16 @@
 #ifndef OBJECTS_DECL_HH
 #define OBJECTS_DECL_HH
 
+#define BOOT_REGISTER_START        \
+        namespace {                \
+            bool do_boot_register() {
+
+#define BOOT_REGISTER_END          \
+                return true;       \
+            }                      \
+            static bool boot_registered = do_boot_register(); \
+        } 
+
 #include "display.hh"
 #include "ecl_alist.hh"
 #include <map>
@@ -32,24 +42,39 @@
 
 /* -------------------- Objects -------------------- */
 
-    /*! Object is the base class for all ``objects'' in the world.
-      The most important facilities this class provides are:
-     
-      (1) A way to clone() and dispose() objects.  This is mainly used
-          in function MakeObject() to create new objects of a given
-          type.
-     
-      (2) A way to pass messages between unrelated objects via message().
-          This allows us to send messages to objects from Lua and to
-          decouple objects types as much as possible.
-     
-      (3) A way to get and set attributes.  These attributes are quite
-          similar to instance variables, but they can be easily modified
-          from Lua.  This makes it possible to modify certain object
-          parameters (such as the text on a piece of paper or the color
-          of an oxyd stone) in level descriptions.
+    /**
+     *  Object is the base class for all ``objects'' in the world.
+     * The most important facilities this class provides are:
+     *
+     * (1) A way to clone() and dispose() objects.  This is mainly used
+     *     in function MakeObject() to create new objects of a given
+     *     type.
+     * 
+     * (2) A way to pass messages between unrelated objects via message().
+     *     This allows us to send messages to objects from Lua and to
+     *     decouple objects types as much as possible.
+     * 
+     * (3) A way to get and set attributes.  These attributes are quite
+     *     similar to instance variables, but they can be easily modified
+     *     from Lua.  This makes it possible to modify certain object
+     *     parameters (such as the text on a piece of paper or the color
+     *     of an oxyd stone) in level descriptions.
+     * 
+     * The various Object subclasses instances need to register a template
+     * instance for each object name. To avoid the inclusion of every
+     * subclass declaration file into the registry for registry driven forward
+     * initialization we make use of the static file based initialization
+     * that occurs prior to the main application startup. To be independent of
+     * the undefined sequence in which the files are initialized we store the
+     * template instances, object names and id's in function local static caches.
+     * These caches are copied to the final runtime data structures on the main
+     * application startup. We call this feature "boot"-initialization. The macros
+     * BOOT_REGISTER_START and BOOT_REGISTER_END will be used once at the end of
+     * every subclass file. They embrace the BootRegister() function calls that
+     * register the templates.
      */
     class Object {
+
     public:
         enum ObjectType { 
             OTHER,
@@ -134,11 +159,14 @@
     protected:
         virtual Value getDefaultValue(const string &key) const;
     private:
+        friend void InitWorld();   // for bootFinished() access
+        
         static int next_id;
         static std::map<int, Object *> objects;
         int id;
         AttribMap attribs;
-        static int getNextId(Object *obj);
+        static int getNextId(Object *obj, bool bootFinished);
+        static void bootFinished();
         static void freeId(int id);
         const Value* get_attrib(const string& key) const;
     };
@@ -151,7 +179,6 @@
      * placed on "The Grid", i.e., for floor tiles, items, and
      * stones. 
      */
-
     class GridObject : public Object, public display::ModelCallback {
     public:
         GridObject() : pos (GridPos(-1, -1)) {}

Added: trunk/src/stones/ConnectiveStone.cc
===================================================================
--- trunk/src/stones/ConnectiveStone.cc	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/stones/ConnectiveStone.cc	2007-10-30 23:56:30 UTC (rev 913)
@@ -0,0 +1,24 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2007 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include "stones/ConnectiveStone.hh"
+
+namespace enigma {
+} // namespace enigma


Property changes on: trunk/src/stones/ConnectiveStone.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/stones/ConnectiveStone.hh
===================================================================
--- trunk/src/stones/ConnectiveStone.hh	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/stones/ConnectiveStone.hh	2007-10-30 23:56:30 UTC (rev 913)
@@ -0,0 +1,60 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2007 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef CONNECTIVESTONE_HH_INCLUDED
+#define CONNECTIVESTONE_HH_INCLUDED
+
+#include "stones.hh"
+
+/* -------------------- ConnectiveStone -------------------- */
+
+// base class for PuzzleStone and BigBrick
+
+namespace enigma {
+    
+    class ConnectiveStone : public Stone {
+    public:
+        ConnectiveStone(const char *kind, int connections): Stone(kind) {
+            set_attrib("connections", connections);
+        }
+        ConnectiveStone(int connections) {
+            set_attrib("connections", connections);
+        }
+
+        DirectionBits get_connections() const {
+            int conn = (int)getAttr("connections") - 1;
+            if (conn >=0 && conn <16)
+                return DirectionBits(conn);
+            else
+                return NODIRBIT;
+        }
+
+    protected:
+        virtual void init_model() {
+            set_model(get_kind()+ecl::strf("%d", get_modelno()));
+        }
+
+        virtual int get_modelno() const {
+            return getAttr("connections");
+        }
+    };
+
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/stones/ConnectiveStone.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/stones/OxydStone.cc
===================================================================
--- trunk/src/stones/OxydStone.cc	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/stones/OxydStone.cc	2007-10-30 23:56:30 UTC (rev 913)
@@ -0,0 +1,232 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2007 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include "stones/OxydStone.hh"
+#include "server.hh"
+#include "world.hh"
+
+namespace enigma {
+ 
+    OxydStone::InstanceList OxydStone::instances;
+    
+    OxydStone * OxydStone::clone() { 
+        OxydStone *o = new OxydStone(*this); 
+        instances.push_back(o);
+        if (server::EnigmaCompatibility >= 1.10) {
+            int color = ((instances.size() -1) / 2) % 8;
+            o->set_attrib("color", color);
+        }
+        return o;
+    }
+    
+    OxydStone::OxydStone()
+    : PhotoStone("st-oxyd"),
+      state(CLOSED)
+    {
+        set_attrib("flavor", "b");
+        set_attrib("color", 0);
+    }
+    
+    Value OxydStone::message(const string &m, const Value &val) 
+    {
+        if (m=="closeall") {
+            for (unsigned i=0; i<instances.size(); ++i)
+                instances[i]->change_state(CLOSING);
+        }
+        else if (m=="shuffle") {
+            shuffle_colors();
+        }
+        else if (m=="trigger" || m=="spitter") {
+            maybe_open_stone();
+        }
+        else if (m=="signal" && to_int(val) != 0) {
+            maybe_open_stone();
+        }
+        else if (m=="init") {
+            // odd number of oxyd stones in the level? no problem, turn a
+            // random one into a fake oxyd
+    
+            if (instances.size() % 2) {
+                // "odd number of oxyd stones";
+                // TODO
+            }
+        }
+        return Value();
+    }
+    
+    void OxydStone::shuffle_colors() 
+    {
+        std::vector<size_t> closed_oxyds;
+        size_t         isize = instances.size();
+        for (size_t i=0; i<isize; ++i) {
+            if (instances[i]->state == CLOSED) {
+                closed_oxyds.push_back(i);
+            }
+        }
+    
+        unsigned size = closed_oxyds.size();
+        if (size>1) {
+            for (unsigned i = 0; i<size; ++i) {
+                unsigned a = IntegerRand(0, static_cast<int> (size-2));
+                if (a >= i) ++a;        // make a always different from j
+    
+                OxydStone *o1 = instances[closed_oxyds[i]];
+                OxydStone *o2 = instances[closed_oxyds[a]];
+    
+                Value icolor = o1->getAttr("color"); 
+    
+                o1->set_attrib("color", o2->getAttr("color"));
+                o2->set_attrib("color", icolor);
+            }
+        }
+    }
+    
+    void OxydStone::change_state(State newstate) 
+    {
+        string flavor(getAttr("flavor","a"));
+        string color(getAttr("color", 0));
+    
+        string modelname = string("st-oxyd") + flavor + color;
+    
+        State oldstate = state;
+        state = newstate;
+    
+        switch (newstate) {
+        case CLOSED:
+            set_model(string("st-oxyd")+flavor);
+            break;
+    
+        case BLINKING:
+            set_model(modelname + "-blink");
+            break;
+    
+        case OPEN:
+            if (oldstate == CLOSED) {
+                sound_event("oxydopen");
+                sound_event("oxydopened");
+                set_anim(modelname+"-opening");
+            } else {
+                set_model(modelname + "-open");
+            }
+            /* If this was the last closed oxyd stone, finish the
+               level */
+            if (find_if(instances.begin(),instances.end(),not_open)
+                    == instances.end()) {
+                server::FinishLevel();
+            }
+            break;
+    
+        case OPENING:
+            sound_event("oxydopen");
+            if (oldstate == CLOSED)
+                set_anim(modelname + "-opening");
+            else if (oldstate == CLOSING)
+                get_model()->reverse();
+    
+            break;
+    
+        case CLOSING:
+            if (oldstate == CLOSED || oldstate==CLOSING) {
+                state = oldstate;
+                return;
+            }
+    
+            sound_event("oxydclose");
+            if (oldstate == OPENING)
+                get_model()->reverse();
+            else if (oldstate == BLINKING || oldstate == OPEN) {
+                set_anim(modelname + "-closing");
+            }
+            break;
+        }
+    }
+    
+    void OxydStone::animcb() {
+        if (state == CLOSING)
+            change_state(CLOSED);
+        else if (state == OPENING)
+            change_state(BLINKING);
+        else if (state == OPEN)
+            change_state(OPEN); // set the right model
+    }
+    
+    void OxydStone::maybe_open_stone() {
+        if (state == CLOSED || state == CLOSING) {
+            Value mycolor = getAttr("color");
+    
+            // Is another oxyd stone currently blinking?
+            InstanceList::iterator i;
+            i=find_if(instances.begin(), instances.end(), blinking_or_opening);
+    
+            if (i != instances.end()) {
+    
+                bool can_open;
+    
+                if (server::GameCompatibility != GAMET_ENIGMA) {
+                    // If colors match and stone (*i) is already blinking,
+                    // open both stones. Close one of them otherwise.
+                    // (This is the Oxyd behaviour; it doesn't work with
+                    // some Enigma levels.)
+                    can_open = (mycolor == (*i)->getAttr("color") && (*i)->state==BLINKING);
+                }
+                else 
+                    can_open = (mycolor == (*i)->getAttr("color"));
+    
+                if (can_open) {
+                    change_state(OPEN);
+                    (*i)->change_state(OPEN);
+                } else {
+                    (*i)->change_state(CLOSING);
+                    change_state(OPENING);
+                }
+            }
+            else {
+                // no blinking stone? -> make this one blink
+                change_state(OPENING);
+            }
+        }
+    }
+    
+    void OxydStone::actor_hit(const StoneContact &/*sc*/) {
+        maybe_open_stone();
+    }
+    
+    void OxydStone::on_creation (GridPos) 
+    {
+        string flavor(getAttr("flavor", "a"));
+        set_model(string("st-oxyd") + flavor);
+        photo_activate();
+    }
+    
+    bool OxydStone::is_removable() const {
+        return !getAttr("static").to_bool();
+    }
+    
+    void OxydStone::on_removal(GridPos p) 
+    {
+        photo_deactivate();
+        kill_model (p);
+    }
+
+    BOOT_REGISTER_START
+        BootRegister(new OxydStone);
+    BOOT_REGISTER_END
+
+} // namespace enigma


Property changes on: trunk/src/stones/OxydStone.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/stones/OxydStone.hh
===================================================================
--- trunk/src/stones/OxydStone.hh	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/stones/OxydStone.hh	2007-10-30 23:56:30 UTC (rev 913)
@@ -0,0 +1,111 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2007 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef OXYDSTONE_HH_INCLUDED
+#define OXYDSTONE_HH_INCLUDED
+
+#include "stones.hh"
+#include "laser.hh"
+
+/* -------------------- Oxyd stone -------------------- */
+
+/** \page st-oxyd Oxyd Stone
+
+Oxyd stones are characterized by two attributes: Their flavor and
+their color.  The flavor only affects the visual representation of
+the stone; it can be either 'a' (opening like a flower) or 'b'
+(displaying a fade-in animation).  The color attribute determines
+the shape on the oxyd stone.
+
+\b Note: You should usually not to create Oxyd stones manually
+with \c set_stone(). Use the predefined \c oxyd() function instead.
+
+\subsection oxyda Attributes
+
+- \b flavor      "a", "b", "c", or "d"
+- \b color       number between 0 and 7
+
+\subsection oxydm Messages
+
+- \b closeall    close all oxyd stones
+- \b shuffle     interchange the colors of the oxyd stones in the current landscape
+- \b trigger     open the stone
+
+<table><tr>
+<td>\image html st-oxyda.png "flavor A"
+<td>\image html st-oxydb.png "flavor B"
+<td>\image html st-oxydc.png "flavor C"
+<td>\image html st-oxydd.png "flavor D"
+</table>
+*/
+
+namespace enigma {
+
+    class OxydStone : public PhotoStone {
+        typedef std::vector<OxydStone *> InstanceList;
+        static InstanceList instances;
+        OxydStone * clone();
+        void dispose() {
+            instances.erase(find(instances.begin(), instances.end(), this));
+            delete this;
+        }
+
+    public:
+        OxydStone();
+
+        static void shuffle_colors();
+        virtual bool is_removable() const;
+    private:
+        enum State { CLOSED, OPEN, OPENING, CLOSING, BLINKING };
+        State state;
+
+        // Stone interface
+        void actor_hit(const StoneContact &sc);
+        void on_creation (GridPos p);
+        void on_removal (GridPos p);
+        const char *collision_sound() { return "stone"; }
+        virtual Value message(const string &m, const Value &);
+
+
+        // PhotoStone interface
+        void notify_laseron() { maybe_open_stone(); }
+        void notify_laseroff() {}
+
+        // Animation callback
+        void animcb();
+
+        // Private methods
+        void maybe_open_stone();
+        void change_state(State newstate);
+
+
+        static bool blinking(OxydStone *a) {
+            return (a->state==BLINKING);
+        }
+        static bool blinking_or_opening(OxydStone *a) {
+            return (a->state==BLINKING || a->state == OPENING);
+        }
+        static bool not_open(OxydStone *a) {
+            return !(a->state==OPEN || a->state==OPENING);
+        }
+
+    };
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/stones/OxydStone.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/stones/WindowStone.cc
===================================================================
--- trunk/src/stones/WindowStone.cc	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/stones/WindowStone.cc	2007-10-30 23:56:30 UTC (rev 913)
@@ -0,0 +1,127 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2007 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include "stones/WindowStone.hh"
+#include "server.hh"
+#include "world.hh"
+
+namespace enigma {
+    DEF_TRAITSM(WindowStone, "st-window", st_window, MOVABLE_BREAKABLE);
+
+    void WindowStone::actor_hit(const StoneContact &sc) {
+        Actor *a = sc.actor;
+        // TODO do we want to allow breaks while breaking?
+        if (state == IDLE) {
+            double impulse = -(a->get_vel() * sc.normal) * get_mass(a);
+            if (impulse > 35) {
+                SendMessage(a, "shatter");
+            }
+
+            else if (impulse > 25) {
+                breakingFaces = sc.faces;
+                set_attrib("connections", (get_connections() & ~breakingFaces) +1);
+                sound_event ("shatter");
+                state = BREAK;
+                set_anim("st-window-anim");  // TODO anim with remaining unbroken faces
+            }
+            
+            else if (player::WieldedItemIs (sc.actor, "it-wrench")) {
+                DirectionBits faces = get_connections();
+                if (sc.faces == WESTBIT && sc.normal[0] < 0){
+                    tryInnerPull(EAST);
+                } else if (sc.faces == EASTBIT && sc.normal[0] > 0) {
+                    tryInnerPull(WEST);
+                } else if (sc.faces == SOUTHBIT && sc.normal[1] > 0) {
+                    tryInnerPull(NORTH);
+                } else if (sc.faces == NORTHBIT && sc.normal[1] < 0) {
+                    tryInnerPull(SOUTH);
+                }
+            }
+        }
+    }
+    
+    void WindowStone::animcb() {
+        DirectionBits faces = get_connections();
+        DirectionBits newFaces = DirectionBits(faces & ~breakingFaces);
+        if (newFaces == NODIRBIT)
+            KillStone(get_pos());
+        else {
+            ReplaceStone(get_pos(), new WindowStone(newFaces+1));
+        }
+    }
+    
+    bool WindowStone::is_sticky(const Actor *a) const  {
+        return false;
+    }
+    
+    StoneResponse WindowStone::collision_response(const StoneContact &sc) {
+        const double face_width = 3.0/32.0; 
+        DirectionBits faces = get_connections();
+
+        if (((sc.contact_point[0] <= get_pos().x + face_width) && faces&WESTBIT) ||
+                ((sc.contact_point[0] >= get_pos().x + 1 - face_width) && faces&EASTBIT) ||
+                ((sc.contact_point[1] <= get_pos().y + face_width) && faces&NORTHBIT) ||
+                ((sc.contact_point[1] >= get_pos().y + 1 - face_width) && faces&SOUTHBIT)) {
+            return STONE_REBOUND;
+        } else {
+            return STONE_PASS;
+        }
+    }
+    
+    Value WindowStone::message(const string &msg, const Value &val) {
+        if (msg == "inner_pull" ) {
+            return Value(tryInnerPull(to_direction(val)));
+        }
+        return Value();
+    }
+    
+    bool WindowStone::tryInnerPull(Direction dir) {
+        DirectionBits faces = get_connections();
+        if (!has_dir(faces, dir) && has_dir(faces, reverse(dir))){
+            Stone *stone = GetStone(move(get_pos(), dir));
+            if (!stone || ((stone->get_traits().id == st_window) &&  
+                    !has_dir(dynamic_cast<ConnectiveStone *>(stone)->get_connections(), reverse(dir)))) {
+                ReplaceStone(get_pos(), new WindowStone((faces&(~to_bits(reverse(dir)))|to_bits(dir))+1));
+                return true;
+            }
+        }
+        return has_dir(faces, dir);
+    }
+
+    BOOT_REGISTER_START
+        BootRegister(new WindowStone(3), "st-window");    // compatibility window with south face only
+        BootRegister(new WindowStone(2), "st-window-w");
+        BootRegister(new WindowStone(3), "st-window-s");
+        BootRegister(new WindowStone(4), "st-window-sw");
+        BootRegister(new WindowStone(5), "st-window-e");
+        BootRegister(new WindowStone(6), "st-window-ew");
+        BootRegister(new WindowStone(7), "st-window-es");
+        BootRegister(new WindowStone(8), "st-window-esw");
+        BootRegister(new WindowStone(9), "st-window-n");
+        BootRegister(new WindowStone(10), "st-window-nw");
+        BootRegister(new WindowStone(11), "st-window-ns");
+        BootRegister(new WindowStone(12), "st-window-nsw");
+        BootRegister(new WindowStone(13), "st-window-ne");
+        BootRegister(new WindowStone(14), "st-window-new");
+        BootRegister(new WindowStone(15), "st-window-nes");
+        BootRegister(new WindowStone(16), "st-window-nesw");
+    BOOT_REGISTER_END
+
+} // namespace enigma


Property changes on: trunk/src/stones/WindowStone.cc
___________________________________________________________________
Name: svn:eol-style
   + native

Added: trunk/src/stones/WindowStone.hh
===================================================================
--- trunk/src/stones/WindowStone.hh	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/stones/WindowStone.hh	2007-10-30 23:56:30 UTC (rev 913)
@@ -0,0 +1,68 @@
+/*
+ * Copyright (C) 2002,2003,2004 Daniel Heck
+ * Copyright (C) 2007 Ronald Lamprecht
+ *
+ * This program is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU General Public License
+ * as published by the Free Software Foundation; either version 2
+ * of the License, or (at your option) any later version.
+ *  
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program; if not, write to the Free Software Foundation, Inc.,
+ * 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
+ *
+ */
+#ifndef WINDOWSTONE_HH_INCLUDED
+#define WINDOWSTONE_HH_INCLUDED
+
+#include "stones.hh"
+#include "stones/ConnectiveStone.hh"
+
+#include "actors.hh"
+#include "player.hh"
+#include "stones_internal.hh"
+#include "world.hh"
+
+/* -------------------- Window -------------------- */
+
+/** \page st-window Breakable Stone
+
+Hit this window heavily with your marble to blast it into smithereens.
+
+\image html st-window.png
+*/
+
+namespace enigma {
+    
+    class WindowStone : public ConnectiveStone {
+        CLONEOBJ(WindowStone);
+        DECL_TRAITS;
+        const char *collision_sound() {return "glass";}
+
+        bool is_transparent (Direction) const { return true; }
+        bool is_floating() const { return state != IDLE; }
+        enum State { IDLE, BREAK } state;
+
+        void actor_hit(const StoneContact &sc);
+        void animcb();
+
+    public:
+        WindowStone(int connections) : ConnectiveStone(connections),
+                state(IDLE), breakingFaces(NODIRBIT) {
+        }
+        virtual bool is_sticky(const Actor *a) const;
+        StoneResponse collision_response(const StoneContact &sc);
+        virtual Value message(const string &msg, const Value &val);
+    private:
+        DirectionBits breakingFaces;
+        bool tryInnerPull(Direction dir);
+    };
+
+} // namespace enigma
+
+#endif


Property changes on: trunk/src/stones/WindowStone.hh
___________________________________________________________________
Name: svn:eol-style
   + native

Modified: trunk/src/stones_complex.cc
===================================================================
--- trunk/src/stones_complex.cc	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/stones_complex.cc	2007-10-30 23:56:30 UTC (rev 913)
@@ -24,6 +24,7 @@
 #include "player.hh"
 #include "Inventory.hh"
 #include "stones_internal.hh"
+#include "stones/ConnectiveStone.hh"
 #include "actors.hh"
 #include "main.hh"
 
@@ -852,120 +853,8 @@
     };
 }
 
-/* -------------------- Window -------------------- */
 
-/** \page st-window Breakable Stone
 
-Hit this window heavily with your marble to blast it into smithereens.
-
-\image html st-window.png
-*/
-
-namespace
-{
-    class Window : public ConnectiveStone {
-        CLONEOBJ(Window);
-        DECL_TRAITS;
-        const char *collision_sound() {return "glass";}
-
-        bool is_transparent (Direction) const { return true; }
-        bool is_floating() const { return state != IDLE; }
-        enum State { IDLE, BREAK } state;
-
-        void actor_hit(const StoneContact &sc) {
-            Actor *a = sc.actor;
-            // TODO do we want to allow breaks while breaking?
-            if (state == IDLE) {
-                double impulse = -(a->get_vel() * sc.normal) * get_mass(a);
-                if (impulse > 35) {
-                    SendMessage(a, "shatter");
-                }
-    
-                else if (impulse > 25) {
-                    breakingFaces = sc.faces;
-                    set_attrib("connections", (get_connections() & ~breakingFaces) +1);
-                    sound_event ("shatter");
-                    state = BREAK;
-                    set_anim("st-window-anim");  // TODO anim with remaining unbroken faces
-                }
-                
-                else if (player::WieldedItemIs (sc.actor, "it-wrench")) {
-                    DirectionBits faces = get_connections();
-                    if (sc.faces == WESTBIT && sc.normal[0] < 0){
-                        tryInnerPull(EAST);
-                    } else if (sc.faces == EASTBIT && sc.normal[0] > 0) {
-                        tryInnerPull(WEST);
-                    } else if (sc.faces == SOUTHBIT && sc.normal[1] > 0) {
-                        tryInnerPull(NORTH);
-                    } else if (sc.faces == NORTHBIT && sc.normal[1] < 0) {
-                        tryInnerPull(SOUTH);
-                    }
-                }
-            }
-        }
-        void animcb() {
-            DirectionBits faces = get_connections();
-            DirectionBits newFaces = DirectionBits(faces & ~breakingFaces);
-            if (newFaces == NODIRBIT)
-                KillStone(get_pos());
-            else {
-                ReplaceStone(get_pos(), new Window(newFaces+1));
-            }
-        }
-
-    public:
-        Window(int connections) : ConnectiveStone(connections),
-                state(IDLE), breakingFaces(NODIRBIT) {
-        }
-        virtual bool is_sticky(const Actor *a) const;
-        StoneResponse collision_response(const StoneContact &sc);
-        virtual Value message(const string &msg, const Value &val);
-    private:
-        DirectionBits breakingFaces;
-        bool tryInnerPull(Direction dir);
-    };
-    DEF_TRAITSM(Window, "st-window", st_window, MOVABLE_BREAKABLE);
-
-    bool Window::is_sticky(const Actor *a) const  {
-        return false;
-    }
-    
-    StoneResponse Window::collision_response(const StoneContact &sc) {
-        const double face_width = 3.0/32.0; 
-        DirectionBits faces = get_connections();
-
-        if (((sc.contact_point[0] <= get_pos().x + face_width) && faces&WESTBIT) ||
-                ((sc.contact_point[0] >= get_pos().x + 1 - face_width) && faces&EASTBIT) ||
-                ((sc.contact_point[1] <= get_pos().y + face_width) && faces&NORTHBIT) ||
-                ((sc.contact_point[1] >= get_pos().y + 1 - face_width) && faces&SOUTHBIT)) {
-            return STONE_REBOUND;
-        } else {
-            return STONE_PASS;
-        }
-    }
-    
-    Value Window::message(const string &msg, const Value &val) {
-        if (msg == "inner_pull" ) {
-            return Value(tryInnerPull(to_direction(val)));
-        }
-        return Value();
-    }
-    
-    bool Window::tryInnerPull(Direction dir) {
-        DirectionBits faces = get_connections();
-        if (!has_dir(faces, dir) && has_dir(faces, reverse(dir))){
-            Stone *stone = GetStone(move(get_pos(), dir));
-            if (!stone || ((stone->get_traits().id == st_window) &&  
-                    !has_dir(dynamic_cast<ConnectiveStone *>(stone)->get_connections(), reverse(dir)))) {
-                ReplaceStone(get_pos(), new Window((faces&(~to_bits(reverse(dir)))|to_bits(dir))+1));
-                return true;
-            }
-        }
-        return has_dir(faces, dir);
-    }
-}
-
-
 /* -------------------- Puzzle stones -------------------- */ 
 
 /** \page st-puzzle Puzzle Stone
@@ -2243,293 +2132,6 @@
 }
 
 
-/* -------------------- Oxyd stone -------------------- */
-
-/** \page st-oxyd Oxyd Stone
-
-Oxyd stones are characterized by two attributes: Their flavor and
-their color.  The flavor only affects the visual representation of
-the stone; it can be either 'a' (opening like a flower) or 'b'
-(displaying a fade-in animation).  The color attribute determines
-the shape on the oxyd stone.
-
-\b Note: You should usually not to create Oxyd stones manually
-with \c set_stone(). Use the predefined \c oxyd() function instead.
-
-\subsection oxyda Attributes
-
-- \b flavor      "a", "b", "c", or "d"
-- \b color       number between 0 and 7
-
-\subsection oxydm Messages
-
-- \b closeall    close all oxyd stones
-- \b shuffle     interchange the colors of the oxyd stones in the current landscape
-- \b trigger     open the stone
-
-<table><tr>
-<td>\image html st-oxyda.png "flavor A"
-<td>\image html st-oxydb.png "flavor B"
-<td>\image html st-oxydc.png "flavor C"
-<td>\image html st-oxydd.png "flavor D"
-</table>
-*/
-
-namespace
-{
-    class OxydStone : public PhotoStone {
-        typedef std::vector<OxydStone *> InstanceList;
-        static InstanceList instances;
-        OxydStone * clone();
-        void dispose() {
-            instances.erase(find(instances.begin(), instances.end(), this));
-            delete this;
-        }
-
-    public:
-        OxydStone();
-
-        static void shuffle_colors();
-        virtual bool is_removable() const;
-    private:
-        enum State { CLOSED, OPEN, OPENING, CLOSING, BLINKING };
-        State state;
-
-        // Stone interface
-        void actor_hit(const StoneContact &sc);
-        void on_creation (GridPos p);
-        void on_removal (GridPos p);
-        const char *collision_sound() { return "stone"; }
-        virtual Value message(const string &m, const Value &);
-
-
-        // PhotoStone interface
-        void notify_laseron() { maybe_open_stone(); }
-        void notify_laseroff() {}
-
-        // Animation callback
-        void animcb();
-
-        // Private methods
-        void maybe_open_stone();
-        void change_state(State newstate);
-
-
-        static bool blinking(OxydStone *a) {
-            return (a->state==BLINKING);
-        }
-        static bool blinking_or_opening(OxydStone *a) {
-            return (a->state==BLINKING || a->state == OPENING);
-        }
-        static bool not_open(OxydStone *a) {
-            return !(a->state==OPEN || a->state==OPENING);
-        }
-
-    };
-}
-
-OxydStone::InstanceList OxydStone::instances;
-
-OxydStone * OxydStone::clone() { 
-    OxydStone *o = new OxydStone(*this); 
-    instances.push_back(o);
-    if (server::EnigmaCompatibility >= 1.10) {
-        int color = ((instances.size() -1) / 2) % 8;
-        o->set_attrib("color", color);
-    }
-    return o;
-}
-
-OxydStone::OxydStone()
-: PhotoStone("st-oxyd"),
-  state(CLOSED)
-{
-    set_attrib("flavor", "b");
-    set_attrib("color", 0);
-}
-
-Value OxydStone::message(const string &m, const Value &val) 
-{
-    if (m=="closeall") {
-        for (unsigned i=0; i<instances.size(); ++i)
-            instances[i]->change_state(CLOSING);
-    }
-    else if (m=="shuffle") {
-        shuffle_colors();
-    }
-    else if (m=="trigger" || m=="spitter") {
-        maybe_open_stone();
-    }
-    else if (m=="signal" && to_int(val) != 0) {
-        maybe_open_stone();
-    }
-    else if (m=="init") {
-        // odd number of oxyd stones in the level? no problem, turn a
-        // random one into a fake oxyd
-
-        if (instances.size() % 2) {
-            // "odd number of oxyd stones";
-            // TODO
-        }
-    }
-    return Value();
-}
-
-void OxydStone::shuffle_colors() 
-{
-    vector<size_t> closed_oxyds;
-    size_t         isize = instances.size();
-    for (size_t i=0; i<isize; ++i) {
-        if (instances[i]->state == CLOSED) {
-            closed_oxyds.push_back(i);
-        }
-    }
-
-    unsigned size = closed_oxyds.size();
-    if (size>1) {
-        for (unsigned i = 0; i<size; ++i) {
-            unsigned a = IntegerRand(0, static_cast<int> (size-2));
-            if (a >= i) ++a;        // make a always different from j
-
-            OxydStone *o1 = instances[closed_oxyds[i]];
-            OxydStone *o2 = instances[closed_oxyds[a]];
-
-            Value icolor = o1->getAttr("color"); 
-
-            o1->set_attrib("color", o2->getAttr("color"));
-            o2->set_attrib("color", icolor);
-        }
-    }
-}
-
-void OxydStone::change_state(State newstate) 
-{
-    string flavor(getAttr("flavor","a"));
-    string color(getAttr("color", 0));
-
-    string modelname = string("st-oxyd") + flavor + color;
-
-    State oldstate = state;
-    state = newstate;
-
-    switch (newstate) {
-    case CLOSED:
-        set_model(string("st-oxyd")+flavor);
-        break;
-
-    case BLINKING:
-        set_model(modelname + "-blink");
-        break;
-
-    case OPEN:
-    	if (oldstate == CLOSED) {
-            sound_event("oxydopen");
-            sound_event("oxydopened");
-            set_anim(modelname+"-opening");
-        } else {
-            set_model(modelname + "-open");
-        }
-        /* If this was the last closed oxyd stone, finish the
-           level */
-        if (find_if(instances.begin(),instances.end(),not_open)
-                == instances.end()) {
-            server::FinishLevel();
-        }
-        break;
-
-    case OPENING:
-        sound_event("oxydopen");
-        if (oldstate == CLOSED)
-            set_anim(modelname + "-opening");
-        else if (oldstate == CLOSING)
-            get_model()->reverse();
-
-        break;
-
-    case CLOSING:
-        if (oldstate == CLOSED || oldstate==CLOSING) {
-            state = oldstate;
-            return;
-        }
-
-        sound_event("oxydclose");
-        if (oldstate == OPENING)
-            get_model()->reverse();
-    	else if (oldstate == BLINKING || oldstate == OPEN) {
-            set_anim(modelname + "-closing");
-        }
-        break;
-    }
-}
-
-void OxydStone::animcb() {
-    if (state == CLOSING)
-        change_state(CLOSED);
-    else if (state == OPENING)
-        change_state(BLINKING);
-    else if (state == OPEN)
-        change_state(OPEN); // set the right model
-}
-
-void OxydStone::maybe_open_stone() {
-    if (state == CLOSED || state == CLOSING) {
-        Value mycolor = getAttr("color");
-
-        // Is another oxyd stone currently blinking?
-        InstanceList::iterator i;
-        i=find_if(instances.begin(), instances.end(), blinking_or_opening);
-
-        if (i != instances.end()) {
-
-            bool can_open;
-
-            if (server::GameCompatibility != GAMET_ENIGMA) {
-                // If colors match and stone (*i) is already blinking,
-                // open both stones. Close one of them otherwise.
-                // (This is the Oxyd behaviour; it doesn't work with
-                // some Enigma levels.)
-                can_open = (mycolor == (*i)->getAttr("color") && (*i)->state==BLINKING);
-            }
-            else 
-                can_open = (mycolor == (*i)->getAttr("color"));
-
-            if (can_open) {
-                change_state(OPEN);
-                (*i)->change_state(OPEN);
-            } else {
-                (*i)->change_state(CLOSING);
-                change_state(OPENING);
-            }
-        }
-        else {
-            // no blinking stone? -> make this one blink
-            change_state(OPENING);
-        }
-    }
-}
-
-void OxydStone::actor_hit(const StoneContact &/*sc*/) {
-    maybe_open_stone();
-}
-
-void OxydStone::on_creation (GridPos) 
-{
-    string flavor(getAttr("flavor", "a"));
-    set_model(string("st-oxyd") + flavor);
-    photo_activate();
-}
-
-bool OxydStone::is_removable() const {
-    return !getAttr("static").to_bool();
-}
-
-void OxydStone::on_removal(GridPos p) 
-{
-    photo_deactivate();
-    kill_model (p);
-}
-
-
 /* -------------------- Turnstiles -------------------- */
 namespace
 {
@@ -3599,7 +3201,7 @@
     Register("st-oneway_white-s", new OneWayStone_white(SOUTH));
     Register("st-oneway_white-w", new OneWayStone_white(WEST));
 
-    Register(new OxydStone);
+//    Register(new OxydStone);
 
     Register (new PullStone);
 
@@ -3700,23 +3302,6 @@
     Register ("st-rotator_move-right", new RotatorStone(true, true));
     Register ("st-rotator_move-left", new RotatorStone(false, true));
 
-    Register("st-window", new Window(3));    // compatibility window with south face only
-    Register("st-window-w", new Window(2));
-    Register("st-window-s", new Window(3));
-    Register("st-window-sw", new Window(4));
-    Register("st-window-e", new Window(5));
-    Register("st-window-ew", new Window(6));
-    Register("st-window-es", new Window(7));
-    Register("st-window-esw", new Window(8));
-    Register("st-window-n", new Window(9));
-    Register("st-window-nw", new Window(10));
-    Register("st-window-ns", new Window(11));
-    Register("st-window-nsw", new Window(12));
-    Register("st-window-ne", new Window(13));
-    Register("st-window-new", new Window(14));
-    Register("st-window-nes", new Window(15));
-    Register("st-window-nesw", new Window(16));
-    
     Register(new ShogunStone);
     Register("st-shogun-s", new ShogunStone(1));
     Register("st-shogun-m", new ShogunStone(2));
@@ -3744,4 +3329,3 @@
 
 } // namespace enigma
 
-

Modified: trunk/src/stones_internal.hh
===================================================================
--- trunk/src/stones_internal.hh	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/stones_internal.hh	2007-10-30 23:56:30 UTC (rev 913)
@@ -116,38 +116,7 @@
             return Value();
         }
     };
-/* -------------------- ConnectiveStone -------------------- */
 
-// base class for PuzzleStone and BigBrick
-
-
-    class ConnectiveStone : public Stone {
-    public:
-        ConnectiveStone(const char *kind, int connections): Stone(kind) {
-            set_attrib("connections", connections);
-        }
-        ConnectiveStone(int connections) {
-            set_attrib("connections", connections);
-        }
-
-        DirectionBits get_connections() const {
-            int conn = (int)getAttr("connections") - 1;
-            if (conn >=0 && conn <16)
-                return DirectionBits(conn);
-            else
-                return NODIRBIT;
-        }
-
-    protected:
-        virtual void init_model() {
-            set_model(get_kind()+ecl::strf("%d", get_modelno()));
-        }
-
-        virtual int get_modelno() const {
-            return getAttr("connections");
-        }
-    };
-
 } // namespace enigma
 
 #endif

Modified: trunk/src/world.cc
===================================================================
--- trunk/src/world.cc	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/world.cc	2007-10-30 23:56:30 UTC (rev 913)
@@ -27,6 +27,7 @@
 #include "client.hh"
 #include "main.hh"
 #include "stones_internal.hh"
+#include "stones/ConnectiveStone.hh"
 #include "WorldProxy.hh"
 
 #include <iostream>
@@ -2367,6 +2368,8 @@
 
 void InitWorld()
 {
+    Object::bootFinished();
+    BootRegister(NULL, NULL, false);
     InitActors();
     InitLasers();
     InitItems();
@@ -2474,6 +2477,34 @@
     vector<Item *> item_repos(it_COUNT);
 }
 
+
+struct BootKindObject {
+    std::string kind;
+    Object *object;
+    BootKindObject(std::string name, Object *o) : kind (name), object (o) {
+    }
+};
+
+void BootRegister(Object *obj, const char * name, bool isRegistration) {
+    static std::list<BootKindObject *> templates;
+    if (isRegistration) {
+        std::string kind = (name != NULL ? std::string(name) : std::string(""));
+        templates.push_back(new BootKindObject(kind, obj));
+    } else {
+        int count = 0;
+        for (std::list<BootKindObject *>::iterator itr = templates.begin(); itr != templates.end(); ++itr) {
+            if ((*itr)->kind.empty()) {
+                Register((*itr)->object);
+            } else {
+                Register((*itr)->kind.c_str(), (*itr)->object);                
+            }
+            delete (*itr);
+            count++;
+        }
+        Log << count << " boot registered object\n";
+    }
+}
+
 void Register (const string &kind, Object *obj) {
     if (!repos)
         repos = new ObjectRepos;

Modified: trunk/src/world.hh
===================================================================
--- trunk/src/world.hh	2007-10-29 23:30:45 UTC (rev 912)
+++ trunk/src/world.hh	2007-10-30 23:56:30 UTC (rev 913)
@@ -394,6 +394,7 @@
                            const string &firetransform);
 
     /* Register a new object. */
+    void BootRegister(Object *obj, const char * kind = NULL, bool isRegistration = true);
     void Register (Object *obj);
     void Register (const string &kind, Object *obj);
     void Register (const string &kind, Floor *obj);



